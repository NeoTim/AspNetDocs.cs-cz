---
title: Práce s SameSite soubory cookie v ASP.NET
author: rick-anderson
description: Naučte se používat k SameSite souborů cookie v ASP.NET.
ms.author: riande
ms.date: 1/22/2019
uid: samesite/system-web-samesite
ms.openlocfilehash: c81ca38648609aa5347d2a8cc11889fc85d81711
ms.sourcegitcommit: 4d439e01c82c7c95b19216fedaf5b1a11a1deb06
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/29/2020
ms.locfileid: "76826611"
---
# <a name="work-with-samesite-cookies-in-aspnet"></a><span data-ttu-id="0ae4e-103">Práce s SameSite soubory cookie v ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0ae4e-103">Work with SameSite cookies in ASP.NET</span></span>

<span data-ttu-id="0ae4e-104">Podle [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="0ae4e-104">By [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="0ae4e-105">SameSite je Konceptový standard [IETF](https://ietf.org/about/) navržený tak, aby poskytoval určitou ochranu proti útokům prostřednictvím CSRF (pro falšování požadavků mezi lokalitami).</span><span class="sxs-lookup"><span data-stu-id="0ae4e-105">SameSite is an [IETF](https://ietf.org/about/) draft standard designed to provide some protection against cross-site request forgery (CSRF) attacks.</span></span> <span data-ttu-id="0ae4e-106">Původně koncept v [2016](https://tools.ietf.org/html/draft-west-first-party-cookies-07)se aktualizoval koncept standardu v [2019](https://tools.ietf.org/html/draft-west-cookie-incrementalism-00).</span><span class="sxs-lookup"><span data-stu-id="0ae4e-106">Originally drafted in [2016](https://tools.ietf.org/html/draft-west-first-party-cookies-07), the draft standard was updated in [2019](https://tools.ietf.org/html/draft-west-cookie-incrementalism-00).</span></span> <span data-ttu-id="0ae4e-107">Aktualizovaný Standard není zpětně kompatibilní s předchozím standardem, přičemž následující je největší znatelné rozdíly:</span><span class="sxs-lookup"><span data-stu-id="0ae4e-107">The updated standard is not backward compatible with the previous standard, with the following being the most noticeable differences:</span></span>

* <span data-ttu-id="0ae4e-108">Soubory cookie bez hlavičky SameSite se ve výchozím nastavení považují za `SameSite=Lax`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-108">Cookies without SameSite header are treated as `SameSite=Lax` by default.</span></span>
* <span data-ttu-id="0ae4e-109">aby bylo možné používat soubory cookie pro více webů, je třeba použít `SameSite=None`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-109">`SameSite=None` must be used to allow cross-site cookie use.</span></span>
* <span data-ttu-id="0ae4e-110">Soubory cookie, které vyhodnotí `SameSite=None`, musí být také označeny jako `Secure`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-110">Cookies that assert `SameSite=None` must also be marked as `Secure`.</span></span>
* <span data-ttu-id="0ae4e-111">Hodnota SameSite = None není povolena [standardem 2016](https://tools.ietf.org/html/draft-west-first-party-cookies-07) a způsobí, že některé implementace považují takové soubory cookie za SameSite = Strict.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-111">The value SameSite=None is not allowed by the [2016 standard](https://tools.ietf.org/html/draft-west-first-party-cookies-07) and causes some implementations to treat such cookies as SameSite=Strict.</span></span> <span data-ttu-id="0ae4e-112">Viz [Podpora starších prohlížečů](#sob) v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-112">See [Supporting older browsers](#sob) in this document.</span></span>

<span data-ttu-id="0ae4e-113">Nastavení `SameSite=Lax` funguje pro většinu souborů cookie aplikace.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-113">The `SameSite=Lax` setting works for most application cookies.</span></span> <span data-ttu-id="0ae4e-114">Některé formy ověřování, jako je [OpenID Connect](https://openid.net/connect/) (OIDC) a [WS-Federation](https://auth0.com/docs/protocols/ws-fed) , jako výchozí vystavení přesměrování na základě.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-114">Some forms of authentication like [OpenID Connect](https://openid.net/connect/) (OIDC) and [WS-Federation](https://auth0.com/docs/protocols/ws-fed) default to POST based redirects.</span></span> <span data-ttu-id="0ae4e-115">Přesměrování na základě příspěvku spustí ochranu prohlížeče SameSite, takže pro tyto součásti je SameSite zakázaný.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-115">The POST based redirects trigger the SameSite browser protections, so SameSite is disabled for these components.</span></span> <span data-ttu-id="0ae4e-116">Většina přihlášení [OAuth](https://oauth.net/) není ovlivněná kvůli rozdílům ve způsobu, jakým jsou požadavky v toku.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-116">Most [OAuth](https://oauth.net/) logins are not affected due to differences in how the request flows.</span></span>

<span data-ttu-id="0ae4e-117">U aplikací, které používají `iframe`, může docházet k potížím s `SameSite=Lax` nebo `SameSite=Strict` soubory cookie, protože prvky IFrame jsou považovány za scénáře mezi weby.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-117">Applications that use `iframe` may experience issues with `SameSite=Lax` or `SameSite=Strict` cookies because iframes are treated as cross-site scenarios.</span></span>

<span data-ttu-id="0ae4e-118">Každá komponenta ASP.NET, která generuje soubory cookie, musí rozhodnout, zda je SameSite vhodná.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-118">Each ASP.NET component that emits cookies needs to decide if SameSite is appropriate.</span></span>

<span data-ttu-id="0ae4e-119">Informace o problémech s aplikacemi po instalaci aktualizací 2019 .NET SameSite najdete v tématu [známé problémy](#known) .</span><span class="sxs-lookup"><span data-stu-id="0ae4e-119">See [Known Issues](#known) for problems with applications after installing the 2019 .Net SameSite updates.</span></span>

## <a name="using-samesite-in-aspnet-472-and-48"></a><span data-ttu-id="0ae4e-120">Použití SameSite v ASP.NET 4.7.2 a 4,8</span><span class="sxs-lookup"><span data-stu-id="0ae4e-120">Using SameSite in ASP.NET 4.7.2 and 4.8</span></span>

<span data-ttu-id="0ae4e-121">.NET 4.7.2 a 4,8 podporují [koncept standard 2019](https://tools.ietf.org/html/draft-west-cookie-incrementalism-00) pro SameSite od vydání aktualizací v prosinci 2019.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-121">.Net 4.7.2 and 4.8 supports the [2019 draft standard](https://tools.ietf.org/html/draft-west-cookie-incrementalism-00) for SameSite since the release of updates in December 2019.</span></span> <span data-ttu-id="0ae4e-122">Vývojáři mohou programově řídit hodnotu hlavičky SameSite pomocí [vlastnosti HttpCookie. SameSite](/dotnet/api/system.web.httpcookie.samesite#System_Web_HttpCookie_SameSite).</span><span class="sxs-lookup"><span data-stu-id="0ae4e-122">Developers are able to programmatically control the value of the SameSite header using the [HttpCookie.SameSite property](/dotnet/api/system.web.httpcookie.samesite#System_Web_HttpCookie_SameSite).</span></span> <span data-ttu-id="0ae4e-123">Nastavení vlastnosti `SameSite` na `Strict`, `Lax`nebo `None` výsledky v těchto hodnotách, které jsou v síti zapisovány pomocí souboru cookie.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-123">Setting the `SameSite` property to `Strict`, `Lax`, or `None` results in those values being written on the network with the cookie.</span></span> <span data-ttu-id="0ae4e-124">Nastavení rovno `(SameSiteMode)(-1)` znamená, že v síti se souborem cookie by neměl být zahrnutá hlavička SameSite.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-124">Setting it equal to `(SameSiteMode)(-1)` indicates that no SameSite header should be included on the network with the cookie.</span></span> <span data-ttu-id="0ae4e-125">[Vlastnost HttpCookie. Secure](/dotnet/api/system.web.httpcookie.secure)nebo ' vlastnost requireSSL ' v konfiguračních souborech lze použít k označení souboru cookie jako `Secure` nebo ne.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-125">The [HttpCookie.Secure Property](/dotnet/api/system.web.httpcookie.secure), or 'requireSSL' in config files, can be used to mark the cookie as `Secure` or not.</span></span>

<span data-ttu-id="0ae4e-126">Nové instance `HttpCookie` budou ve výchozím nastavení `SameSite=(SameSiteMode)(-1)` a `Secure=false`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-126">New `HttpCookie` instances will default to `SameSite=(SameSiteMode)(-1)` and `Secure=false`.</span></span> <span data-ttu-id="0ae4e-127">Tato výchozí nastavení se dají přepsat v konfigurační sekci `system.web/httpCookies`, kde řetězec `"Unspecified"` je uživatelsky přívětivou syntaxí pro `(SameSiteMode)(-1)`, která je jenom pro konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-127">These defaults can be overridden in the `system.web/httpCookies` configuration section, where the string `"Unspecified"` is a friendly configuration-only syntax for `(SameSiteMode)(-1)`:</span></span>

```xml
<configuration>
 <system.web>
  <httpCookies sameSite="[Strict|Lax|None|Unspecified]" requireSSL="[true|false]" />
 <system.web>
<configuration>
```

<span data-ttu-id="0ae4e-128">ASP.Net také pro tyto funkce vydává čtyři konkrétní soubory cookie vlastní: anonymní ověřování, ověřování formulářů, stav relace a Správa rolí.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-128">ASP.Net also issues four specific cookies of its own for these features: Anonymous Authentication, Forms Authentication, Session State, and Role Management.</span></span> <span data-ttu-id="0ae4e-129">Instance těchto souborů cookie, které jsou získány v modulu runtime, mohou být manipulovány pomocí `SameSite` a `Secure` vlastností stejně jako jakékoli jiné instance HttpCookie.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-129">Instances of these cookies obtained in runtime can be manipulated using the `SameSite` and `Secure` properties just like any other HttpCookie instance.</span></span> <span data-ttu-id="0ae4e-130">V důsledku patchworkí SameSite Standard se ale možnosti konfigurace pro tyto čtyři soubory cookie neshodují.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-130">However, due to the patchwork emergence of the SameSite standard, configuration options for these four features cookies is inconsistent.</span></span> <span data-ttu-id="0ae4e-131">Příslušné konfigurační oddíly a atributy s výchozími hodnotami jsou uvedeny níže.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-131">The relevant configuration sections and attributes, with defaults, are shown below.</span></span> <span data-ttu-id="0ae4e-132">Pokud není k dispozici žádný `SameSite` nebo `Secure` v atributu pro funkci, pak se tato funkce přepne na výchozí hodnoty nakonfigurované v části `system.web/httpCookies` popsané výše.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-132">If there is no `SameSite` or `Secure` related attribute for a feature, then the feature will fall back on the defaults configured in the `system.web/httpCookies` section discussed above.</span></span>

```xml
<configuration>
 <system.web>
  <anonymousIdentification cookieRequireSSL="false" /> <!-- No config attribute for SameSite -->
  <authentication>
   <forms cookieSameSite="Lax" requireSSL="false" />
  </authentication>
  <sessionState cookieSameSite="Lax" /> <!-- No config attribute for Secure -->
  <roleManager cookieRequiresSSL="false" /> <!-- No config attribute for SameSite -->
 <system.web>
<configuration>
```  

<span data-ttu-id="0ae4e-133">**Poznámka**: možnost Neurčeno je k dispozici pouze pro `system.web/httpCookies@sameSite` v daném okamžiku.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-133">**Note**: 'Unspecified' is only available to `system.web/httpCookies@sameSite` at the moment.</span></span> <span data-ttu-id="0ae4e-134">Doufáme, že přidáte podobnou syntaxi k dříve zobrazeným atributům cookieSameSite v budoucích aktualizacích.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-134">We hope to add similar syntax to the previously shown cookieSameSite attributes in future updates.</span></span> <span data-ttu-id="0ae4e-135">Nastavení `(SameSiteMode)(-1)` v kódu pořád funguje na instancích těchto souborů cookie. \*</span><span class="sxs-lookup"><span data-stu-id="0ae4e-135">Setting `(SameSiteMode)(-1)` in code still works on instances of these cookies.\*</span></span>

## <a name="history-and-changes"></a><span data-ttu-id="0ae4e-136">Historie a změny</span><span class="sxs-lookup"><span data-stu-id="0ae4e-136">History and changes</span></span>

<span data-ttu-id="0ae4e-137">Podpora SameSite byla poprvé implementována v .NET 4.7.2 s využitím [konceptu standard 2016](https://tools.ietf.org/html/draft-west-first-party-cookies-07#section-4.1).</span><span class="sxs-lookup"><span data-stu-id="0ae4e-137">SameSite support was first implemented in .NET 4.7.2 using the [2016 draft standard](https://tools.ietf.org/html/draft-west-first-party-cookies-07#section-4.1).</span></span>

<span data-ttu-id="0ae4e-138">19. listopadu 2019 aktualizace pro Windows aktualizované .NET 4.7.2 + od standardu 2016 až do standardu 2019.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-138">The November 19, 2019 updates for Windows updated .NET 4.7.2+ from the 2016 standard to the 2019 standard.</span></span> <span data-ttu-id="0ae4e-139">Další aktualizace jsou k disdobu pro jiné verze systému Windows.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-139">Additional updates are forthcoming for other versions of Windows.</span></span> <span data-ttu-id="0ae4e-140">Další informace najdete v tématu <xref:samesite/kbs-samesite>.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-140">For more information, see <xref:samesite/kbs-samesite>.</span></span>

 <span data-ttu-id="0ae4e-141">Koncept 2019 specifikace SameSite:</span><span class="sxs-lookup"><span data-stu-id="0ae4e-141">The 2019 draft of the SameSite specification:</span></span>

* <span data-ttu-id="0ae4e-142">Není **zpětně** kompatibilní s konceptem 2016.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-142">Is **not** backwards compatible with the 2016 draft.</span></span> <span data-ttu-id="0ae4e-143">Další informace najdete v tématu [Podpora starších prohlížečů](#sob) v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-143">For more information, see [Supporting older browsers](#sob) in this document.</span></span>
* <span data-ttu-id="0ae4e-144">Určuje, že soubory cookie se ve výchozím nastavení považují za `SameSite=Lax`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-144">Specifies cookies are treated as `SameSite=Lax` by default.</span></span>
* <span data-ttu-id="0ae4e-145">Určuje soubory cookie, které explicitně vyhodnotí `SameSite=None`, aby bylo možné povolit doručování mezi weby, musí být označeno jako `Secure`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-145">Specifies cookies that explicitly assert `SameSite=None` in order to enable cross-site delivery should also be marked as `Secure`.</span></span>
* <span data-ttu-id="0ae4e-146">Je podporován opravami vydanými podle výše uvedených v článku znalostní báze.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-146">Is supported by patches issued as described in the KB's listed above.</span></span>
* <span data-ttu-id="0ae4e-147">Ve výchozím nastavení je naplánovaná podpora [Chrome](https://chromestatus.com/feature/5088147346030592) v [únoru 2020](https://blog.chromium.org/2019/10/developers-get-ready-for-new.html).</span><span class="sxs-lookup"><span data-stu-id="0ae4e-147">Is scheduled to be enabled by [Chrome](https://chromestatus.com/feature/5088147346030592) by default in [Feb 2020](https://blog.chromium.org/2019/10/developers-get-ready-for-new.html).</span></span> <span data-ttu-id="0ae4e-148">Prohlížeče začaly při přesunu do tohoto standardu v 2019.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-148">Browsers started moving to this standard in 2019.</span></span>

<a name="known"><a/>

## <a name="known-issues"></a><span data-ttu-id="0ae4e-149">Známé problémy</span><span class="sxs-lookup"><span data-stu-id="0ae4e-149">Known Issues</span></span>

<span data-ttu-id="0ae4e-150">Vzhledem k tomu, že specifikace konceptu 2016 a 2019 nejsou kompatibilní, aktualizace 2019 pro rozhraní .NET Framework zavádí některé změny, které mohou být přerušují.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-150">Because the 2016 and 2019 draft specifications are not compatible, the November 2019 .Net Framework update introduces some changes that may be breaking.</span></span>

* <span data-ttu-id="0ae4e-151">Soubory cookie pro ověření stavu relace a formulářů jsou nyní zapisovány do sítě, protože místo nespecifikovaného je `Lax`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-151">Session State and Forms Authentication cookies are now written to the network as `Lax` instead of unspecified.</span></span>
  * <span data-ttu-id="0ae4e-152">I když většina aplikací spolupracuje s `SameSite=Lax` soubory cookie, aplikace, které odesílají weby nebo aplikace, které využívají `iframe`, můžou zjistit, že se jejich stav relace nebo soubory cookie autorizace formulářů nepoužívají podle očekávání.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-152">While most apps work with `SameSite=Lax` cookies, apps that POST across sites or applications that make use of `iframe` may find that their session state or forms authorization cookies aren't being used as expected.</span></span> <span data-ttu-id="0ae4e-153">Pokud to chcete napravit, změňte hodnotu `cookieSameSite` v příslušném konfiguračním oddílu, jak je popsáno výše.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-153">To remedy this, change the `cookieSameSite` value in the appropriate configuration section as discussed previously.</span></span>
* <span data-ttu-id="0ae4e-154">HttpCookies, který explicitně nastaví `SameSite=None` v kódu nebo v konfiguraci, má nyní tuto hodnotu napsanou v souboru cookie, zatímco dříve byla vynechána.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-154">HttpCookies that explicitly set `SameSite=None` in code or configuration now have that value written with the cookie, whereas it was previously omitted.</span></span> <span data-ttu-id="0ae4e-155">To může způsobit problémy se staršími prohlížeči, které podporují jenom 2016 koncept Standard.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-155">This may cause issues with older browsers that only support the 2016 draft standard.</span></span>
  * <span data-ttu-id="0ae4e-156">Když cílíte na prohlížeče, které podporují pracovní Standard 2019 s `SameSite=None` soubory cookie, nezapomeňte je také označit `Secure` nebo nemusejí být rozpoznány.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-156">When targeting browsers supporting the 2019 draft standard with `SameSite=None` cookies, remember to also mark them `Secure` or they may not be recognized.</span></span>
  * <span data-ttu-id="0ae4e-157">Pokud se chcete vrátit k 2016 chování, které nepíše `SameSite=None`, použijte nastavení aplikace `aspnet:SupressSameSiteNone=true`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-157">To revert to the 2016 behavior of not writing `SameSite=None`, use the app setting `aspnet:SupressSameSiteNone=true`.</span></span> <span data-ttu-id="0ae4e-158">Všimněte si, že tato akce bude platit pro všechny HttpCookies v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-158">Note that this will apply to all HttpCookies in the app.</span></span>

### <a name="azure-app-servicesamesite-cookie-handling"></a><span data-ttu-id="0ae4e-159">Azure App Service – zpracování souborů cookie SameSite</span><span class="sxs-lookup"><span data-stu-id="0ae4e-159">Azure App Service—SameSite cookie handling</span></span>

<span data-ttu-id="0ae4e-160">Informace o tom, jak Azure App Service konfiguruje chování SameSite v aplikacích .NET 4.7.2, najdete v tématu [Azure App Service – zpracování souborů cookie SameSite a .NET Framework opravy 4.7.2](https://azure.microsoft.com/updates/app-service-samesite-cookie-update/) .</span><span class="sxs-lookup"><span data-stu-id="0ae4e-160">See [Azure App Service—SameSite cookie handling and .NET Framework 4.7.2 patch](https://azure.microsoft.com/updates/app-service-samesite-cookie-update/) for information about how Azure App Service is configuring SameSite behaviors in .Net 4.7.2 apps.</span></span>

<a name="sob"></a>

## <a name="supporting-older-browsers"></a><span data-ttu-id="0ae4e-161">Podpora starších prohlížečů</span><span class="sxs-lookup"><span data-stu-id="0ae4e-161">Supporting older browsers</span></span>

<span data-ttu-id="0ae4e-162">SameSite standardně vyhodnocuje, že neznámé hodnoty musí být považovány za `SameSite=Strict` hodnoty. 2016</span><span class="sxs-lookup"><span data-stu-id="0ae4e-162">The 2016 SameSite standard mandated that unknown values must be treated as `SameSite=Strict` values.</span></span> <span data-ttu-id="0ae4e-163">Aplikace, ke kterým se přistupoval ze starších prohlížečů, které podporují SameSite úrovně Standard 2016, se můžou přerušit, když získají vlastnost SameSite s hodnotou `None`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-163">Apps accessed from older browsers which support the 2016 SameSite standard may break when they get a SameSite property with a value of `None`.</span></span> <span data-ttu-id="0ae4e-164">Webové aplikace musí implementovat detekci prohlížeče, pokud chtějí podporovat starší prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-164">Web apps must implement browser detection if they intend to support older browsers.</span></span> <span data-ttu-id="0ae4e-165">ASP.NET neimplementuje zjišťování prohlížeče, protože hodnoty uživatelských agentů jsou vysoce těkavé a často se mění.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-165">ASP.NET doesn't implement browser detection because User-Agents values are highly volatile and change frequently.</span></span> <span data-ttu-id="0ae4e-166">Následující kód lze volat na webu <xref:HTTP.HttpCookie> volání:</span><span class="sxs-lookup"><span data-stu-id="0ae4e-166">The following code can be called at the <xref:HTTP.HttpCookie> call site:</span></span>

[!code-csharp[](sample/SameSiteCheck.cs?name=snippet)]

<span data-ttu-id="0ae4e-167">V předchozí ukázce `MyUserAgentDetectionLib.DisallowsSameSiteNone` je uživatelem zadaná knihovna, která detekuje, jestli Agent pro uživatele nepodporuje SameSite `None`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-167">In the preceding sample, `MyUserAgentDetectionLib.DisallowsSameSiteNone` is a user supplied library that detects if the user agent doesn't support SameSite `None`.</span></span> <span data-ttu-id="0ae4e-168">Následující kód ukazuje ukázkovou `DisallowsSameSiteNone` metodu:</span><span class="sxs-lookup"><span data-stu-id="0ae4e-168">The following code shows a sample `DisallowsSameSiteNone` method:</span></span>

> [!WARNING]
> <span data-ttu-id="0ae4e-169">Následující kód je určen pouze pro ukázku:</span><span class="sxs-lookup"><span data-stu-id="0ae4e-169">The following code is for demonstration only:</span></span>
> * <span data-ttu-id="0ae4e-170">Neměla by být považována za dokončenou.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-170">It should not be considered complete.</span></span>
> * <span data-ttu-id="0ae4e-171">Není udržována ani podporována.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-171">It is not maintained or supported.</span></span>

[!code-csharp[](sample/SameSiteCheck.cs?name=snippet2)]

## <a name="test-apps-for-samesite-problems"></a><span data-ttu-id="0ae4e-172">Testování aplikací pro problémy s SameSite</span><span class="sxs-lookup"><span data-stu-id="0ae4e-172">Test apps for SameSite problems</span></span>

<span data-ttu-id="0ae4e-173">Aplikace, které komunikují se vzdálenými lokalitami, jako je třeba přihlášení třetí strany, potřebují:</span><span class="sxs-lookup"><span data-stu-id="0ae4e-173">Apps that interact with remote sites such as through third-party login need to:</span></span>

* <span data-ttu-id="0ae4e-174">Otestujte interakci na více prohlížečích.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-174">Test the interaction on multiple browsers.</span></span>
* <span data-ttu-id="0ae4e-175">Použití [zjišťování a zmírnění](#sob) problémů v prohlížeči, které jsou popsány v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-175">Apply the [browser detection and mitigation](#sob) discussed in this document.</span></span>

<span data-ttu-id="0ae4e-176">Otestujte webové aplikace pomocí verze klienta, která se může přihlásit k novému chování SameSite.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-176">Test web apps using a client version that can opt-in to the new SameSite behavior.</span></span> <span data-ttu-id="0ae4e-177">Pro Chrome, Firefox a chrom Edge mají všechny nové příznaky funkcí pro výslovný souhlas, které lze použít k testování.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-177">Chrome, Firefox, and Chromium Edge all have new opt-in feature flags that can be used for testing.</span></span> <span data-ttu-id="0ae4e-178">Po použití oprav SameSite se aplikace testuje se staršími verzemi klientů, zejména Safari.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-178">After your app applies the SameSite patches, test it with older client versions, especially Safari.</span></span> <span data-ttu-id="0ae4e-179">Další informace najdete v tématu [Podpora starších prohlížečů](#sob) v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-179">For more information, see [Supporting older browsers](#sob) in this document.</span></span>

### <a name="test-with-chrome"></a><span data-ttu-id="0ae4e-180">Testování s použitím Chromu</span><span class="sxs-lookup"><span data-stu-id="0ae4e-180">Test with Chrome</span></span>

<span data-ttu-id="0ae4e-181">Chrome 78 + poskytuje zavádějící výsledky, protože má na zpracování dočasné omezení.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-181">Chrome 78+ gives misleading results because it has a temporary mitigation in place.</span></span> <span data-ttu-id="0ae4e-182">Chrome 78 + dočasné zmírnění umožňuje, aby soubory cookie byly starší než dvě minuty.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-182">The Chrome 78+ temporary mitigation allows cookies less than two minutes old.</span></span> <span data-ttu-id="0ae4e-183">Chrome 76 nebo 77 s povolenými vhodnými příznakem testu poskytuje přesnější výsledky.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-183">Chrome 76 or 77 with the appropriate test flags enabled provides more accurate results.</span></span> <span data-ttu-id="0ae4e-184">Chcete-li otestovat nové chování SameSite, přepněte `chrome://flags/#same-site-by-default-cookies` na **povoleno**.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-184">To test the new SameSite behavior toggle `chrome://flags/#same-site-by-default-cookies` to **Enabled**.</span></span> <span data-ttu-id="0ae4e-185">Starší verze Chrome (75 a novější) jsou hlášeny jako neúspěšné s novým nastavením `None`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-185">Older versions of Chrome (75 and below) are reported to fail with the new `None` setting.</span></span> <span data-ttu-id="0ae4e-186">Viz [Podpora starších prohlížečů](#sob) v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-186">See [Supporting older browsers](#sob) in this document.</span></span>

<span data-ttu-id="0ae4e-187">Google nezpřístupňuje starší verze Chrome.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-187">Google does not make older chrome versions available.</span></span> <span data-ttu-id="0ae4e-188">Postupujte podle pokynů v části [stažení Chromu](https://www.chromium.org/getting-involved/download-chromium) a otestujte starší verze Chrome.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-188">Follow the instructions at [Download Chromium](https://www.chromium.org/getting-involved/download-chromium) to test older versions of Chrome.</span></span> <span data-ttu-id="0ae4e-189">Nestahujte Chrome z odkazů **, které jsou** k dispozici, hledáním ve starších verzích Chrome.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-189">Do **not** download Chrome from links provided by searching for older versions of chrome.</span></span>

* [<span data-ttu-id="0ae4e-190">Chróm 76 Win64</span><span class="sxs-lookup"><span data-stu-id="0ae4e-190">Chromium 76 Win64</span></span>](https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win_x64/664998/)
* [<span data-ttu-id="0ae4e-191">Chróm 74 Win64</span><span class="sxs-lookup"><span data-stu-id="0ae4e-191">Chromium 74 Win64</span></span>](https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win_x64/638880/)

### <a name="test-with-safari"></a><span data-ttu-id="0ae4e-192">Testování pomocí Safari</span><span class="sxs-lookup"><span data-stu-id="0ae4e-192">Test with Safari</span></span>

<span data-ttu-id="0ae4e-193">Prohlížeč Safari 12 striktně implementuje předchozí koncept a v případě, že je nová hodnota `None` v souboru cookie, se nezdařila.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-193">Safari 12 strictly implemented the prior draft and fails when the new `None` value is in a cookie.</span></span> <span data-ttu-id="0ae4e-194">`None` se vyhnete prostřednictvím kódu detekce prohlížeče, který [podporuje starší prohlížeče](#sob) v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-194">`None` is avoided via the browser detection code [Supporting older browsers](#sob) in this document.</span></span> <span data-ttu-id="0ae4e-195">Pomocí MSAL, ADAL nebo libovolné knihovny, kterou používáte, otestujte přihlašovací údaje pro WebKit Safari 12, Safari 13 a na bázi.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-195">Test Safari 12, Safari 13, and WebKit based OS style logins using MSAL, ADAL or whatever library you are using.</span></span> <span data-ttu-id="0ae4e-196">Problém závisí na základní verzi operačního systému.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-196">The problem is dependent on the underlying OS version.</span></span> <span data-ttu-id="0ae4e-197">OSX Mojave (10,14) a iOS 12 se nazývají problémy s kompatibilitou s novým chováním SameSite.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-197">OSX Mojave (10.14) and iOS 12 are known to have compatibility problems with the new SameSite behavior.</span></span> <span data-ttu-id="0ae4e-198">Upgrade operačního systému na OSX Catalina (10,15) nebo iOS 13 opravuje problém.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-198">Upgrading the OS to OSX Catalina (10.15) or iOS 13 fixes the problem.</span></span> <span data-ttu-id="0ae4e-199">Prohlížeč Safari aktuálně nemá příznak výslovných přihlášení pro testování nového chování specifikace.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-199">Safari does not currently have an opt-in flag for testing the new spec behavior.</span></span>

### <a name="test-with-firefox"></a><span data-ttu-id="0ae4e-200">Testování pomocí Firefox</span><span class="sxs-lookup"><span data-stu-id="0ae4e-200">Test with Firefox</span></span>

<span data-ttu-id="0ae4e-201">Podporu aplikace Firefox pro nový standard lze testovat na verzi 68 + tím, že na stránce `about:config` `network.cookie.sameSite.laxByDefault`příznak funkce.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-201">Firefox support for the new standard can be tested on version 68+ by opting in on the `about:config` page with the feature flag `network.cookie.sameSite.laxByDefault`.</span></span> <span data-ttu-id="0ae4e-202">Nebyly zjištěny žádné zprávy o problémech s kompatibilitou se staršími verzemi aplikace Firefox.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-202">There haven't been reports of compatibility issues with older versions of Firefox.</span></span>

### <a name="test-with-edge-browser"></a><span data-ttu-id="0ae4e-203">Testování pomocí prohlížeče Edge</span><span class="sxs-lookup"><span data-stu-id="0ae4e-203">Test with Edge browser</span></span>

<span data-ttu-id="0ae4e-204">Edge podporuje starý SameSite Standard.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-204">Edge supports the old SameSite standard.</span></span> <span data-ttu-id="0ae4e-205">Edge verze 44 nemá žádné známé problémy s kompatibilitou s novým standardem.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-205">Edge version 44 doesn't have any known compatibility problems with the new standard.</span></span>

### <a name="test-with-edge-chromium"></a><span data-ttu-id="0ae4e-206">Test s hranou (chrom)</span><span class="sxs-lookup"><span data-stu-id="0ae4e-206">Test with Edge (Chromium)</span></span>

<span data-ttu-id="0ae4e-207">Příznaky SameSite jsou nastaveny na stránce `edge://flags/#same-site-by-default-cookies`.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-207">SameSite flags are set on the `edge://flags/#same-site-by-default-cookies` page.</span></span> <span data-ttu-id="0ae4e-208">U Edge Chromu se nezjistily žádné problémy s kompatibilitou.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-208">No compatibility issues were discovered with Edge Chromium.</span></span>

### <a name="test-with-electron"></a><span data-ttu-id="0ae4e-209">Testování s elektronem</span><span class="sxs-lookup"><span data-stu-id="0ae4e-209">Test with Electron</span></span>

<span data-ttu-id="0ae4e-210">K verzím elektronů patří starší verze Chromu.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-210">Versions of Electron include older versions of Chromium.</span></span> <span data-ttu-id="0ae4e-211">Například verze elektronicky používané týmy je chrom 66, který vykazuje starší chování.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-211">For example, the version of Electron used by Teams is Chromium 66, which exhibits the older behavior.</span></span> <span data-ttu-id="0ae4e-212">Je nutné provést vlastní testování kompatibility s verzí elektronů, kterou váš produkt používá.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-212">You must perform your own compatibility testing with the version of Electron your product uses.</span></span> <span data-ttu-id="0ae4e-213">Viz [Podpora starších prohlížečů](#sob) v následující části.</span><span class="sxs-lookup"><span data-stu-id="0ae4e-213">See [Supporting older browsers](#sob) in the following section.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="0ae4e-214">Další materiály a zdroje informací</span><span class="sxs-lookup"><span data-stu-id="0ae4e-214">Additional resources</span></span>

* [<span data-ttu-id="0ae4e-215">Nadcházející změny souborů cookie SameSite v ASP.NET a ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="0ae4e-215">Upcoming SameSite Cookie Changes in ASP.NET and ASP.NET Core</span></span>](https://devblogs.microsoft.com/aspnet/upcoming-samesite-cookie-changes-in-asp-net-and-asp-net-core/)
* [<span data-ttu-id="0ae4e-216">Chromový blog: vývojáři: Připravte se na nové SameSite = None; Nastavení zabezpečeného souboru cookie</span><span class="sxs-lookup"><span data-stu-id="0ae4e-216">Chromium Blog:Developers: Get Ready for New SameSite=None; Secure Cookie Settings</span></span>](https://blog.chromium.org/2019/10/developers-get-ready-for-new.html)
* [<span data-ttu-id="0ae4e-217">Vysvětlení souborů cookie SameSite</span><span class="sxs-lookup"><span data-stu-id="0ae4e-217">SameSite cookies explained</span></span>](https://web.dev/samesite-cookies-explained/)
