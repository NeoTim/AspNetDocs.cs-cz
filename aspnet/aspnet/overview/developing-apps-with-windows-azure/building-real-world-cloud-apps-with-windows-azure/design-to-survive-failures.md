---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/design-to-survive-failures
title: Návrh pro dosažení selhání (vytváření skutečných cloudových aplikací s Azure) | Microsoft Docs
author: MikeWasson
description: Vytváření reálných cloudových aplikací pomocí Azure je založené na prezentaci vyvinuté Scottem Guthrie. Vysvětluje 13 vzorů a postupů, které mohou...
ms.author: riande
ms.date: 06/12/2014
ms.assetid: 364ce84e-5af8-4e08-afc9-75a512b01f84
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/design-to-survive-failures
msc.type: authoredcontent
ms.openlocfilehash: 348232af531b5d53dc3cb46d6d2c7931d95a572d
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78617724"
---
# <a name="design-to-survive-failures-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="859e5-104">Návrh pro dosažení selhání (vytváření skutečných cloudových aplikací s Azure)</span><span class="sxs-lookup"><span data-stu-id="859e5-104">Design to Survive Failures (Building Real-World Cloud Apps with Azure)</span></span>

<span data-ttu-id="859e5-105">[Jan Wasson](https://github.com/MikeWasson), [Rick Anderson](https://twitter.com/RickAndMSFT), [Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="859e5-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson](https://twitter.com/RickAndMSFT), [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="859e5-106">[Stažení opravy projektu IT](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) nebo [stažení elektronické knihy](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span><span class="sxs-lookup"><span data-stu-id="859e5-106">[Download Fix It Project](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) or [Download E-book](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span></span>

> <span data-ttu-id="859e5-107">**Vytváření reálných cloudových aplikací pomocí Azure** je založené na prezentaci vyvinuté Scottem Guthrie.</span><span class="sxs-lookup"><span data-stu-id="859e5-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="859e5-108">Vysvětluje 13 vzorů a postupů, které vám pomůžou úspěšně vyvíjet webové aplikace pro Cloud.</span><span class="sxs-lookup"><span data-stu-id="859e5-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="859e5-109">Informace o elektronické příručce najdete v [první kapitole](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="859e5-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>

<span data-ttu-id="859e5-110">Jedna z věcí, které je třeba vzít v úvahu při sestavování libovolného typu aplikace, ale zvláště z nich, která bude běžet v cloudu, kde ji bude používat spousta lidí, je návrh aplikace, aby mohl řádně zpracovat selhání a dál doručovat hodnoty, a to co nejvíc. provést.</span><span class="sxs-lookup"><span data-stu-id="859e5-110">One of the things you have to think about when you build any type of application, but especially one that will run in the cloud where lots of people will be using it, is how to design the app so that it can gracefully handle failures and continue to deliver value as much as possible.</span></span> <span data-ttu-id="859e5-111">Vzhledem k dostatečnému času jsou věci v jakémkoli prostředí nebo jakémkoli softwarovém systému nesprávné.</span><span class="sxs-lookup"><span data-stu-id="859e5-111">Given enough time, things are going to go wrong in any environment or any software system.</span></span> <span data-ttu-id="859e5-112">Jak vaše aplikace zpracovává tyto situace, určuje, jak dlouho budou vaši zákazníci získávat a kolik času je potřeba věnovat analýze a opravám problémů.</span><span class="sxs-lookup"><span data-stu-id="859e5-112">How your app handles those situations determines how upset your customers will get and how much time you have to spend analyzing and fixing problems.</span></span>

## <a name="types-of-failures"></a><span data-ttu-id="859e5-113">Typy selhání</span><span class="sxs-lookup"><span data-stu-id="859e5-113">Types of failures</span></span>

<span data-ttu-id="859e5-114">Existují dvě základní kategorie selhání, které chcete zpracovat odlišně:</span><span class="sxs-lookup"><span data-stu-id="859e5-114">There are two basic categories of failures that you'll want to handle differently:</span></span>

- <span data-ttu-id="859e5-115">Přechodné, samočinné chyby, jako například občasné problémy s připojením k síti.</span><span class="sxs-lookup"><span data-stu-id="859e5-115">Transient, self-healing failures such as intermittent network connectivity issues.</span></span>
- <span data-ttu-id="859e5-116">Dlouhodobá selhání, která vyžadují zásah.</span><span class="sxs-lookup"><span data-stu-id="859e5-116">Enduring failures that require intervention.</span></span>

<span data-ttu-id="859e5-117">V případě přechodného selhání můžete implementovat zásady opakování, abyste zajistili, že většina času rychle a automaticky obnovuje aplikaci.</span><span class="sxs-lookup"><span data-stu-id="859e5-117">For transient failures, you can implement a retry policy to ensure that most of the time the app recovers quickly and automatically.</span></span> <span data-ttu-id="859e5-118">Vaši zákazníci si můžou všimnout trochu delší doby odezvy, jinak to neovlivní.</span><span class="sxs-lookup"><span data-stu-id="859e5-118">Your customers might notice slightly longer response time, but otherwise they won't be affected.</span></span> <span data-ttu-id="859e5-119">Ukážeme několik způsobů, jak tyto chyby zpracovat v [kapitole s přechodným zpracováním chyb](transient-fault-handling.md).</span><span class="sxs-lookup"><span data-stu-id="859e5-119">We'll show some ways to handle these errors in the [Transient Fault Handling chapter](transient-fault-handling.md).</span></span>

<span data-ttu-id="859e5-120">V případě neúspěchů můžete implementovat funkci monitorování a protokolování, která vás upozorní, když dojde k problémům a která usnadňuje analýzu původní příčiny.</span><span class="sxs-lookup"><span data-stu-id="859e5-120">For enduring failures, you can implement monitoring and logging functionality that notifies you promptly when issues arise and that facilitates root cause analysis.</span></span> <span data-ttu-id="859e5-121">Ukážeme několik způsobů, které vám pomůžou udržet si přehled o těchto druzích chyb v části [monitorování a telemetrie](monitoring-and-telemetry.md).</span><span class="sxs-lookup"><span data-stu-id="859e5-121">We'll show some ways to help you stay on top of these kinds of errors in the [Monitoring and Telemetry chapter](monitoring-and-telemetry.md).</span></span>

## <a name="failure-scope"></a><span data-ttu-id="859e5-122">Rozsah selhání</span><span class="sxs-lookup"><span data-stu-id="859e5-122">Failure scope</span></span>

<span data-ttu-id="859e5-123">Také je nutné se zamyslet na rozsah selhání – ať už je to ovlivněný jednotlivý počítač, celou službu, jako je například SQL Database nebo úložiště nebo celá oblast.</span><span class="sxs-lookup"><span data-stu-id="859e5-123">You also have to think about failure scope – whether a single machine is affected, a whole service such as SQL Database or Storage, or an entire region.</span></span>

![Rozsah selhání](design-to-survive-failures/_static/image1.png)

### <a name="machine-failures"></a><span data-ttu-id="859e5-125">Selhání počítačů</span><span class="sxs-lookup"><span data-stu-id="859e5-125">Machine failures</span></span>

<span data-ttu-id="859e5-126">V Azure se server, který selhal, automaticky nahrazuje novým a dobře navrženou cloudovou aplikací z tohoto typu selhání automaticky a rychle.</span><span class="sxs-lookup"><span data-stu-id="859e5-126">In Azure, a failed server is automatically replaced by a new one, and a well-designed cloud app recovers from this kind of failure automatically and quickly.</span></span> <span data-ttu-id="859e5-127">Dříve jsme zdůraznili výhody škálovatelnosti bezstavových webových vrstev a snadné obnovení z neúspěšného serveru je další výhodou Statelessness.</span><span class="sxs-lookup"><span data-stu-id="859e5-127">Earlier we stressed the scalability benefits of a stateless web tier, and ease of recovery from a failed server is another benefit of statelessness.</span></span> <span data-ttu-id="859e5-128">Snadné obnovení je také jednou z výhod funkcí PaaS (Platform-as-a-Service), jako jsou SQL Database a Azure App Service Web Apps.</span><span class="sxs-lookup"><span data-stu-id="859e5-128">Ease of recovery is also one of the benefits of platform-as-a-service (PaaS) features such as SQL Database and Azure App Service Web Apps.</span></span> <span data-ttu-id="859e5-129">Chyby hardwaru jsou zřídka, ale když k nim dojde, jsou automaticky zpracovány. dokonce nemusíte psát kód pro zpracování selhání počítače při použití některé z těchto služeb.</span><span class="sxs-lookup"><span data-stu-id="859e5-129">Hardware failures are rare, but when they occur these services handle them automatically; you don't even have to write code to handle machine failures when you're using one of these services.</span></span>

### <a name="service-failures"></a><span data-ttu-id="859e5-130">Selhání služby</span><span class="sxs-lookup"><span data-stu-id="859e5-130">Service failures</span></span>

<span data-ttu-id="859e5-131">Cloudové aplikace obvykle používají více služeb.</span><span class="sxs-lookup"><span data-stu-id="859e5-131">Cloud apps typically use multiple services.</span></span> <span data-ttu-id="859e5-132">Třeba aplikace pro opravu IT používá službu SQL Database, služba úložiště a webová aplikace se nasadí do Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="859e5-132">For example, the Fix It app uses the SQL Database service, the Storage service, and the web app is deployed to Azure App Service.</span></span> <span data-ttu-id="859e5-133">Co vaše aplikace udělá v případě, že jedna ze služeb, na které závisí, se nezdaří?</span><span class="sxs-lookup"><span data-stu-id="859e5-133">What will your app do if one of the services you depend on fails?</span></span> <span data-ttu-id="859e5-134">U některých chyb služby se může stát, že to bude nejlepší, ale zkuste to znovu později.</span><span class="sxs-lookup"><span data-stu-id="859e5-134">For some service failures a friendly "sorry, try again later" message might be the best you can do.</span></span> <span data-ttu-id="859e5-135">Ale v mnoha scénářích to můžete dělat lépe.</span><span class="sxs-lookup"><span data-stu-id="859e5-135">But in many scenarios you can do better.</span></span> <span data-ttu-id="859e5-136">Například když vaše back-endové úložiště dat nefunguje, můžete přijmout uživatelský vstup, zobrazit "vaši žádost byla přijata" a dočasně uložit vstup někde došlo jinak; až bude služba, kterou potřebujete, zase funkční, můžete načíst vstup a zpracovat ho.</span><span class="sxs-lookup"><span data-stu-id="859e5-136">For example, when your back-end data store is down, you can accept user input, display "your request has been received," and store the input someplace else temporarily; then when the service you need is operational again, you can retrieve the input and process it.</span></span>

<span data-ttu-id="859e5-137">V kapitole [pracovní vzor orientovaný na fronty](queue-centric-work-pattern.md) se zobrazuje jeden ze způsobů, jak tento scénář zpracovat.</span><span class="sxs-lookup"><span data-stu-id="859e5-137">The [Queue-centric Work Pattern](queue-centric-work-pattern.md) chapter shows one way to handle this scenario.</span></span> <span data-ttu-id="859e5-138">Aplikace opravit IT ukládá úkoly v SQL Database, ale není nutné, aby při SQL Database mimo provoz ukončili práci.</span><span class="sxs-lookup"><span data-stu-id="859e5-138">The Fix It app stores tasks in SQL Database, but it doesn't have to quit working when SQL Database is down.</span></span> <span data-ttu-id="859e5-139">V této kapitole se dozvíte, jak uložit vstup uživatele pro úkol ve frontě a použít pracovní proces ke čtení fronty a aktualizaci úlohy.</span><span class="sxs-lookup"><span data-stu-id="859e5-139">In that chapter we'll see how to store user input for a task in a queue, and use a worker process to read the queue and update the task.</span></span> <span data-ttu-id="859e5-140">Pokud je SQL mimo provoz, možnost vytvářet opravy IT úkoly není nijak ovlivněna; pracovní proces může čekat a zpracovat nové úlohy, když je SQL Database k dispozici.</span><span class="sxs-lookup"><span data-stu-id="859e5-140">If SQL is down, the ability to create Fix It tasks is unaffected; the worker process can wait and process new tasks when SQL Database is available.</span></span>

### <a name="region-failures"></a><span data-ttu-id="859e5-141">Selhání oblasti</span><span class="sxs-lookup"><span data-stu-id="859e5-141">Region failures</span></span>

<span data-ttu-id="859e5-142">Může dojít k selhání celé oblasti.</span><span class="sxs-lookup"><span data-stu-id="859e5-142">Entire regions may fail.</span></span> <span data-ttu-id="859e5-143">Přírodní katastrofa může zničit datové centrum, může se tak rozřezat meteorem, liniovou linii v datacentru může vyjmout zemědělec Burying za krávu backhoe atd. Pokud je vaše aplikace hostovaná v datacentru stricken?</span><span class="sxs-lookup"><span data-stu-id="859e5-143">A natural disaster might destroy a data center, it might get flattened by a meteor, the trunk line into the datacenter could be cut by a farmer burying a cow with a backhoe, etc. If your app is hosted in the stricken datacenter what do you do?</span></span> <span data-ttu-id="859e5-144">Je možné nastavit aplikaci v Azure tak, aby běžela v několika oblastech současně, takže pokud dojde k havárii v jednom, budete pokračovat v práci v jiné oblasti.</span><span class="sxs-lookup"><span data-stu-id="859e5-144">It's possible to set up your app in Azure to run in multiple regions simultaneously so that if there's a disaster in one, you continue running in another region.</span></span> <span data-ttu-id="859e5-145">Taková selhání představují extrémně vzácná opakování a většina aplikací neskočí přes jednodušší, který je nutný k zajištění nepřerušované služby prostřednictvím selhání tohoto řazení.</span><span class="sxs-lookup"><span data-stu-id="859e5-145">Such failures are extremely rare occurrences, and most apps don't jump through the hoops necessary to ensure uninterrupted service through failures of this sort.</span></span> <span data-ttu-id="859e5-146">Informace o tom, jak zajistit dostupnost aplikace i přes selhání oblasti, najdete v části Resources na konci kapitoly.</span><span class="sxs-lookup"><span data-stu-id="859e5-146">See the Resources section at the end of the chapter for information about how to keep your app available even through a region failure.</span></span>

<span data-ttu-id="859e5-147">Cílem Azure je zajistit, aby zpracování všech těchto druhů chyb bylo mnohem snazší, a v následujících kapitolách vidíte některé příklady, jak to máme.</span><span class="sxs-lookup"><span data-stu-id="859e5-147">A goal of Azure is to make handling all of these kinds of failures a lot easier, and you'll see some examples of how we're doing that in the following chapters.</span></span>

## <a name="slas"></a><span data-ttu-id="859e5-148">Smlouvy SLA</span><span class="sxs-lookup"><span data-stu-id="859e5-148">SLAs</span></span>

<span data-ttu-id="859e5-149">Lidé často uslyší smlouvy o úrovni služeb (SLA) v cloudovém prostředí.</span><span class="sxs-lookup"><span data-stu-id="859e5-149">People often hear about service-level agreements (SLAs) in the cloud environment.</span></span> <span data-ttu-id="859e5-150">V podstatě se příslibů, že společnosti pracují na tom, jak je jejich služba spolehlivá.</span><span class="sxs-lookup"><span data-stu-id="859e5-150">Basically these are promises that companies make about how reliable their service is.</span></span> <span data-ttu-id="859e5-151">99,9% smlouva SLA znamená, že byste měli očekávat, že služba bude správně fungovat 99,9% času.</span><span class="sxs-lookup"><span data-stu-id="859e5-151">A 99.9% SLA means you should expect the service to be working correctly 99.9% of the time.</span></span> <span data-ttu-id="859e5-152">To je poměrně obvyklá hodnota pro smlouvu SLA, která má jako velmi vysoké číslo, ale nemůžete zjistit, kolik času se ve skutečnosti nejvíce nezobrazuje.</span><span class="sxs-lookup"><span data-stu-id="859e5-152">That's a fairly typical value for an SLA and it sounds like a very high number, but you might not realize how much down time .1% actually amounts to.</span></span> <span data-ttu-id="859e5-153">Tady je tabulka, která ukazuje, jak velké množství výpadků v procentech v rámci smlouvy SLA v roce, v měsíci a v týdnu.</span><span class="sxs-lookup"><span data-stu-id="859e5-153">Here's a table that shows how much downtime various SLA percentages amount to over a year, a month, and a week.</span></span>

![Tabulka SLA](design-to-survive-failures/_static/image2.png)

<span data-ttu-id="859e5-155">Smlouva SLA 99,9% znamená, že vaše služba by mohla být mimo provoz 8,76 hodin v roce 43,2 nebo v minutách za měsíc.</span><span class="sxs-lookup"><span data-stu-id="859e5-155">So a 99.9% SLA means your service could be down 8.76 hours a year or 43.2 minutes a month.</span></span> <span data-ttu-id="859e5-156">To je mnohem více, než většina uživatelů uvědomuje.</span><span class="sxs-lookup"><span data-stu-id="859e5-156">That's more down time than most people realize.</span></span> <span data-ttu-id="859e5-157">Takže jako vývojář si přejete vědět, že je možné určit určitou dobu v čase, a zajistit tak bezproblémové zpracování.</span><span class="sxs-lookup"><span data-stu-id="859e5-157">So as a developer you want to be aware that a certain amount of down time is possible and handle it in a graceful way.</span></span> <span data-ttu-id="859e5-158">V určitém okamžiku bude aplikace používat vaši aplikaci a služba bude mimo provoz a vy chcete minimalizovat negativní dopad na zákazníka.</span><span class="sxs-lookup"><span data-stu-id="859e5-158">At some point someone is going to be using your app, and a service is going to be down, and you want to minimize the negative impact of that on the customer.</span></span>

<span data-ttu-id="859e5-159">Jedna z věcí, které byste měli znát o smlouvě SLA, je to, na který časový rámec odkazuje: znamená to, že se čas obnoví každý týden, každý měsíc nebo každý rok?</span><span class="sxs-lookup"><span data-stu-id="859e5-159">One thing you should know about an SLA is what time-frame it refers to: does the clock get reset every week, every month, or every year?</span></span> <span data-ttu-id="859e5-160">V Azure se hodiny resetují každý měsíc, což je pro vás lepší než roční smlouva SLA, protože roční smlouva SLA by mohla skrýt špatné měsíce tím, že je odkompenzuje s řadou dobrých měsíců.</span><span class="sxs-lookup"><span data-stu-id="859e5-160">In Azure we reset the clock every month, which is better for you than a yearly SLA, since a yearly SLA could hide bad months by offsetting them with a series of good months.</span></span>

<span data-ttu-id="859e5-161">Samozřejmě vždycky snažímei lepší, než je smlouva SLA; obvykle je to mnohem méně.</span><span class="sxs-lookup"><span data-stu-id="859e5-161">Of course we always aspire to do better than the SLA; usually you'll be down much less than that.</span></span> <span data-ttu-id="859e5-162">Slibem je to, že pokud budeme v provozu déle, než je maximální doba mimo provoz, můžete požádat o peníze zpátky.</span><span class="sxs-lookup"><span data-stu-id="859e5-162">The promise is that if we're ever down for longer than the maximum down time you can ask for money back.</span></span> <span data-ttu-id="859e5-163">Množství peněz, které vrátíte, by pravděpodobně zcela neplatilo, ale tento aspekt smlouvy SLA funguje jako zásada vynucení a umožňuje vám, abyste měli jistotu, že to máme hodně vážně.</span><span class="sxs-lookup"><span data-stu-id="859e5-163">The amount of money you get back probably wouldn't fully compensate you for the business impact of the excess down time, but that aspect of the SLA acts as an enforcement policy and lets you know that we do take it very seriously.</span></span>

### <a name="composite-slas"></a><span data-ttu-id="859e5-164">Složené smlouvy SLA</span><span class="sxs-lookup"><span data-stu-id="859e5-164">Composite SLAs</span></span>

<span data-ttu-id="859e5-165">Důležitou věcí, kterou je třeba vzít v úvahu, když se díváte na SLA, je dopad použití několika služeb v aplikaci, přičemž každá služba má samostatnou smlouvu SLA.</span><span class="sxs-lookup"><span data-stu-id="859e5-165">An important thing to think about when you're looking at SLAs is the impact of using multiple services in an app, with each service having a separate SLA.</span></span> <span data-ttu-id="859e5-166">Například aplikace pro opravu IT používá Azure App Service Web Apps, Azure Storage a SQL Database.</span><span class="sxs-lookup"><span data-stu-id="859e5-166">For example, the Fix It app uses Azure App Service Web Apps, Azure Storage, and SQL Database.</span></span> <span data-ttu-id="859e5-167">Tady jsou čísla smluv SLA pro datum, kdy je tato elektronická příručka zapisována v prosinci, 2013:</span><span class="sxs-lookup"><span data-stu-id="859e5-167">Here are their SLA numbers as of the date this e-book is being written in December, 2013:</span></span>

![Web SLA, úložiště, SQL Database](design-to-survive-failures/_static/image3.png)

<span data-ttu-id="859e5-169">Jaká je maximální doba mimo provoz, kterou byste měli očekávat pro aplikaci na základě těchto služeb SLA?</span><span class="sxs-lookup"><span data-stu-id="859e5-169">What is the maximum down time you would expect for the app based on these service SLAs?</span></span> <span data-ttu-id="859e5-170">Můžete si všimnout, že čas v čase v tomto případě bude stejný jako nejhorší procento smlouvy SLA, nebo v tomto případě 99,9%.</span><span class="sxs-lookup"><span data-stu-id="859e5-170">You might think that your down time would be equal to the worst SLA percentage, or 99.9% in this case.</span></span> <span data-ttu-id="859e5-171">To by mělo být pravdivé, pokud se všechny tři služby vždy nezdařily ve stejnou dobu, ale nemusí nutně to, co se skutečně stane.</span><span class="sxs-lookup"><span data-stu-id="859e5-171">That would be true if all three services always failed at the same time, but that isn't necessarily what actually happens.</span></span> <span data-ttu-id="859e5-172">Každá služba může selhat nezávisle v různých časech, takže je nutné vypočítat složenou smlouvu SLA vynásobením jednotlivých čísel SLA.</span><span class="sxs-lookup"><span data-stu-id="859e5-172">Each service may fail independently at different times, so you have to calculate the composite SLA by multiplying the individual SLA numbers.</span></span>

![Složené smlouvy SLA](design-to-survive-failures/_static/image4.png)

<span data-ttu-id="859e5-174">Takže vaše aplikace by nemohla být nejenom 43,2 minut v měsíci, ale 3 časy, 108 minut v měsíci a pořád i v rámci omezení smlouvy SLA pro Azure.</span><span class="sxs-lookup"><span data-stu-id="859e5-174">So your app could be down not just 43.2 minutes a month but 3 times that amount, 108 minutes a month – and still be within the Azure SLA limits.</span></span>

<span data-ttu-id="859e5-175">Tento problém není jedinečný pro Azure.</span><span class="sxs-lookup"><span data-stu-id="859e5-175">This issue is not unique to Azure.</span></span> <span data-ttu-id="859e5-176">Ve skutečnosti poskytujeme nejlepší cloudové SLA jakékoli dostupné cloudové služby a budete mít podobné problémy, se kterými se můžete zabývat, pokud použijete cloudové služby od libovolného dodavatele.</span><span class="sxs-lookup"><span data-stu-id="859e5-176">We actually provide the best cloud SLAs of any cloud service available, and you'll have similar issues to deal with if you use any vendor's cloud services.</span></span> <span data-ttu-id="859e5-177">Z toho důvodu je důležité se zamyslet nad tím, jak můžete aplikaci navrhnout, aby nedocházelo k bezproblémovému selhání služby, protože by mohla být často dostatečná, aby ovlivnila vaše zákazníky nebo uživatele.</span><span class="sxs-lookup"><span data-stu-id="859e5-177">What this highlights is the importance of thinking about how you can design your app to handle the inevitable service failures gracefully, because they might happen often enough to impact your customers or users.</span></span>

### <a name="cloud-slas-compared-to-enterprise-down-time-experience"></a><span data-ttu-id="859e5-178">Cloudový SLA ve srovnání s prostředím Enterprise v čase</span><span class="sxs-lookup"><span data-stu-id="859e5-178">Cloud SLAs compared to enterprise down-time experience</span></span>

<span data-ttu-id="859e5-179">Lidé někdy říkají, že v mé podnikové aplikaci tyto problémy nemají.</span><span class="sxs-lookup"><span data-stu-id="859e5-179">People sometimes say, "In my enterprise app I never have these problems."</span></span> <span data-ttu-id="859e5-180">Pokud si vyžádáte, jak dlouhou dobu využije měsíc ve skutečnosti, obvykle se jedná o "dobře se děje".</span><span class="sxs-lookup"><span data-stu-id="859e5-180">If you ask how much down time a month they actually have, they usually say, "Well, it happens occasionally."</span></span> <span data-ttu-id="859e5-181">A pokud si vyžádáte, jak často se to bude připustit k tomu, že je někdy potřeba zálohovat nebo nainstalovat nový server nebo aktualizovat software.</span><span class="sxs-lookup"><span data-stu-id="859e5-181">And if you ask how often, they admit that "Sometimes we do need to back up or install a new server or update software."</span></span> <span data-ttu-id="859e5-182">Samozřejmě se počítá jako doba mimo provoz.</span><span class="sxs-lookup"><span data-stu-id="859e5-182">Of course, that counts as down time.</span></span> <span data-ttu-id="859e5-183">Většina podnikových aplikací, pokud nejsou obzvláště důležité, jsou ve skutečnosti po dobu delší, než je doba povolená SLA naší služby.</span><span class="sxs-lookup"><span data-stu-id="859e5-183">Most enterprise apps unless they are especially mission-critical are actually down for more than the amount of time allowed by our service SLAs.</span></span> <span data-ttu-id="859e5-184">Ale když je váš server a vaše infrastruktura a zodpovídáte za něj a jejich kontrolu, myslíte o tom, že Angst méně času.</span><span class="sxs-lookup"><span data-stu-id="859e5-184">But when it's your server and your infrastructure and you're responsible for it and in control of it, you tend to feel less angst about down times.</span></span> <span data-ttu-id="859e5-185">V cloudovém prostředí závisíte na někoho jiného a nevíte, co se chystá, takže se o něm budete moct lépe zajímat.</span><span class="sxs-lookup"><span data-stu-id="859e5-185">In a cloud environment you're dependent on someone else and you don't know what's going on, so you might tend to get more worried about it.</span></span>

<span data-ttu-id="859e5-186">Když podnik dosáhne většího množství v čase, než se dostanete od smlouvy SLA pro Cloud, vytráví spoustu dalších peněz na hardwaru.</span><span class="sxs-lookup"><span data-stu-id="859e5-186">When an enterprise achieves a greater up-time percentage than you get from a cloud SLA, they do it by spending a lot more money on hardware.</span></span> <span data-ttu-id="859e5-187">Cloudová služba by mohla to udělat, ale musela by pro své služby účtovat mnohem více.</span><span class="sxs-lookup"><span data-stu-id="859e5-187">A cloud service could do that but would have to charge much more for its services.</span></span> <span data-ttu-id="859e5-188">Místo toho můžete využít cenově výhodné službu a navrhnout software tak, aby nevyhnutelné chyby způsobily minimální přerušení pro vaše zákazníky.</span><span class="sxs-lookup"><span data-stu-id="859e5-188">Instead, you take advantage of a cost-effective service and design your software so that the inevitable failures cause minimum disruption to your customers.</span></span> <span data-ttu-id="859e5-189">Vaše úloha jako Cloud App Designer není natolik velká, aby nedocházelo k selhání, protože se tak vyhnete pohromě a uděláte to tak, že se zaměříte na software, ne na hardware.</span><span class="sxs-lookup"><span data-stu-id="859e5-189">Your job as a cloud app designer is not so much to avoid failure as to avoid catastrophe, and you do that by focusing on software, not on hardware.</span></span> <span data-ttu-id="859e5-190">Vzhledem k tomu, že podnikové aplikace se snaží maximalizovat střední dobu mezi selháními, cloudové aplikace se snaží minimalizovat střední dobu obnovení.</span><span class="sxs-lookup"><span data-stu-id="859e5-190">Whereas enterprise apps strive to maximize mean time between failures, cloud apps strive to minimize mean time to recover.</span></span>

### <a name="not-all-cloud-services-have-slas"></a><span data-ttu-id="859e5-191">Ne všechny cloudové služby mají SLA</span><span class="sxs-lookup"><span data-stu-id="859e5-191">Not all cloud services have SLAs</span></span>

<span data-ttu-id="859e5-192">Nezapomeňte také, že ne každá cloudová služba má ještě smlouvu SLA.</span><span class="sxs-lookup"><span data-stu-id="859e5-192">Be aware also that not every cloud service even has an SLA.</span></span> <span data-ttu-id="859e5-193">Pokud je vaše aplikace závislá na službě, která nemá žádnou záruku, možná se vám může stát mnohem déle, než můžete představit.</span><span class="sxs-lookup"><span data-stu-id="859e5-193">If your app is dependent on a service with no up-time guarantee, you could be down far longer than you might imagine.</span></span> <span data-ttu-id="859e5-194">Pokud například povolíte přihlášení k webu pomocí poskytovatele sociálních sítí, jako je Facebook nebo Twitter, poraďte se s poskytovatelem služeb a zjistěte, jestli se jedná o smlouvu SLA, a nemůžete tu najít.</span><span class="sxs-lookup"><span data-stu-id="859e5-194">For example, if you enable log-in to your site using a social provider such as Facebook or Twitter, check with the service provider to find out if there is an SLA, and you might find out there isn't one.</span></span> <span data-ttu-id="859e5-195">Pokud ale ověřovací služba přestane být v provozu nebo není schopna podporovat objem požadavků, které jste v něm vyvolali, budou vaši zákazníci z vaší aplikace uzamčeni.</span><span class="sxs-lookup"><span data-stu-id="859e5-195">But if the authentication service goes down or is unable to support the volume of requests you throw at it, your customers are locked out of your app.</span></span> <span data-ttu-id="859e5-196">Můžete být vypnuté po dobu více dní.</span><span class="sxs-lookup"><span data-stu-id="859e5-196">You could be down for days or longer.</span></span> <span data-ttu-id="859e5-197">Tvůrci jedné nové aplikace očekávali stovky milionů souborů ke stažení a využili se na Facebooku ověřování – ale nemuseli se mluvit na Facebook, než se zabývali a zjistili, že pro tuto službu neexistovala žádná smlouva SLA.</span><span class="sxs-lookup"><span data-stu-id="859e5-197">The creators of one new app expected hundreds of millions of downloads and took a dependency on Facebook authentication – but didn't talk to Facebook before going live and discovered too late that there was no SLA for that service.</span></span>

### <a name="not-all-downtime-counts-toward-slas"></a><span data-ttu-id="859e5-198">Ne všechna výpadky se započítává k SLA</span><span class="sxs-lookup"><span data-stu-id="859e5-198">Not all downtime counts toward SLAs</span></span>

<span data-ttu-id="859e5-199">Některé cloudové služby můžou službu odepřít, pokud je vaše aplikace používá.</span><span class="sxs-lookup"><span data-stu-id="859e5-199">Some cloud services may deliberately deny service if your app over-uses them.</span></span> <span data-ttu-id="859e5-200">To se označuje jako *omezování*.</span><span class="sxs-lookup"><span data-stu-id="859e5-200">This is called *throttling*.</span></span> <span data-ttu-id="859e5-201">Pokud má služba smlouvu SLA, měla by stanovit podmínky, za kterých se může omezit, a váš návrh aplikace by se měl vyhnout těmto podmínkám a reagovat odpovídajícím způsobem na omezení, pokud k nim dojde.</span><span class="sxs-lookup"><span data-stu-id="859e5-201">If a service has an SLA, it should state the conditions under which you might be throttled, and your app design should avoid those conditions and react appropriately to the throttling if it happens.</span></span> <span data-ttu-id="859e5-202">Například pokud se požadavky na službu nedaří spustit, když překročíte určitý počet za sekundu, chcete zajistit, aby automatické opakování neprobíhalo tak rychle, aby toto omezení mohlo pokračovat.</span><span class="sxs-lookup"><span data-stu-id="859e5-202">For example, if requests to a service start to fail when you exceed a certain number per second, you want to make sure automatic retries don't happen so fast that they cause the throttling to continue.</span></span> <span data-ttu-id="859e5-203">Další informace o omezování najdete v [kapitole zpracování přechodných chyb](transient-fault-handling.md).</span><span class="sxs-lookup"><span data-stu-id="859e5-203">We'll have more to say about throttling in the [Transient Fault Handling chapter](transient-fault-handling.md).</span></span>

## <a name="summary"></a><span data-ttu-id="859e5-204">Souhrn</span><span class="sxs-lookup"><span data-stu-id="859e5-204">Summary</span></span>

<span data-ttu-id="859e5-205">Tato kapitola se pokusila získat informace o tom, proč je reálné cloudové aplikace navržená tak, aby se neúspěšně zadržely chyby.</span><span class="sxs-lookup"><span data-stu-id="859e5-205">This chapter has tried to help you realize why a real world cloud app has to be designed to survive failures gracefully.</span></span> <span data-ttu-id="859e5-206">Od [Další kapitoly](monitoring-and-telemetry.md)se zbývající vzory v této sérii přejdou podrobněji o některých strategiích, které můžete použít k těmto akcím:</span><span class="sxs-lookup"><span data-stu-id="859e5-206">Starting with the [next chapter](monitoring-and-telemetry.md), the remaining patterns in this series go into more detail about some strategies you can use to do that:</span></span>

- <span data-ttu-id="859e5-207">Dobře se [monitoruje a telemetrie](monitoring-and-telemetry.md), takže můžete rychle zjistit chyby, které vyžadují zásah, a máte dostatečné informace, jak je vyřešit.</span><span class="sxs-lookup"><span data-stu-id="859e5-207">Have good [monitoring and telemetry](monitoring-and-telemetry.md), so that you find out quickly about failures that require intervention, and you have sufficient information to resolve them.</span></span>
- <span data-ttu-id="859e5-208">[Zpracování přechodných chyb](transient-fault-handling.md) implementací inteligentní logiky opakování, aby se vaše aplikace automaticky obnovila v případě, že se může a vrátí k logice pro [přerušení okruhu](transient-fault-handling.md#circuitbreakers) , když to nemůže.</span><span class="sxs-lookup"><span data-stu-id="859e5-208">[Handle transient faults](transient-fault-handling.md) by implementing intelligent retry logic, so that your app recovers automatically when it can and falls back to [circuit breaker](transient-fault-handling.md#circuitbreakers) logic when it can't.</span></span>
- <span data-ttu-id="859e5-209">Použijte [distribuované ukládání do mezipaměti](distributed-caching.md) , abyste minimalizovali problémy s propustností, latencí a připojením s přístupem k databázi.</span><span class="sxs-lookup"><span data-stu-id="859e5-209">Use [distributed caching](distributed-caching.md) in order to minimize throughput, latency, and connection problems with database access.</span></span>
- <span data-ttu-id="859e5-210">Implementujte volné spojení pomocí [vzoru práce orientovaného na fronty](queue-centric-work-pattern.md), aby mohl front-end aplikace i nadále fungovat, když je back-end mimo provoz.</span><span class="sxs-lookup"><span data-stu-id="859e5-210">Implement loose coupling via the [queue-centric work pattern](queue-centric-work-pattern.md), so that your app front end can continue to work when the back end is down.</span></span>

## <a name="resources"></a><span data-ttu-id="859e5-211">Zdroje</span><span class="sxs-lookup"><span data-stu-id="859e5-211">Resources</span></span>

<span data-ttu-id="859e5-212">Další informace najdete v těchto e-knihách v pozdějších kapitolách a na následujících zdrojích.</span><span class="sxs-lookup"><span data-stu-id="859e5-212">For more information, see later chapters in this e-book and the following resources.</span></span>

<span data-ttu-id="859e5-213">Nápovědě</span><span class="sxs-lookup"><span data-stu-id="859e5-213">Documentation:</span></span>

- <span data-ttu-id="859e5-214">[Failsafe: pokyny pro odolné cloudové architektury](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx).</span><span class="sxs-lookup"><span data-stu-id="859e5-214">[Failsafe: Guidance for Resilient Cloud Architectures](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx).</span></span> <span data-ttu-id="859e5-215">Dokument white paper o matolin Mercuri, Ulrich Homann a Andrew Townhill.</span><span class="sxs-lookup"><span data-stu-id="859e5-215">White paper by Marc Mercuri, Ulrich Homann, and Andrew Townhill.</span></span> <span data-ttu-id="859e5-216">Verze webové stránky pro video řady FailSafe</span><span class="sxs-lookup"><span data-stu-id="859e5-216">Web page version of the FailSafe video series.</span></span>
- <span data-ttu-id="859e5-217">[Osvědčené postupy pro návrh rozsáhlých služeb v Azure Cloud Services](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx).</span><span class="sxs-lookup"><span data-stu-id="859e5-217">[Best Practices for the Design of Large-Scale Services on Azure Cloud Services](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx).</span></span> <span data-ttu-id="859e5-218">Dokument White Paper, který označuje Simms a Michael Thomassy.</span><span class="sxs-lookup"><span data-stu-id="859e5-218">White paper by Mark Simms and Michael Thomassy.</span></span>
- <span data-ttu-id="859e5-219">[Technické pokyny pro provozní kontinuitu Azure](https://msdn.microsoft.com/library/windowsazure/hh873027.aspx).</span><span class="sxs-lookup"><span data-stu-id="859e5-219">[Azure Business Continuity Technical Guidance](https://msdn.microsoft.com/library/windowsazure/hh873027.aspx).</span></span> <span data-ttu-id="859e5-220">Dokument White Paper od nadWicklineho a Jason Skořepa.</span><span class="sxs-lookup"><span data-stu-id="859e5-220">White paper by Patrick Wickline and Jason Roth.</span></span>
- <span data-ttu-id="859e5-221">[Zotavení po havárii a vysoká dostupnost pro aplikace Azure](https://msdn.microsoft.com/library/windowsazure/dn251004.aspx)</span><span class="sxs-lookup"><span data-stu-id="859e5-221">[Disaster Recovery and High Availability for Azure Applications](https://msdn.microsoft.com/library/windowsazure/dn251004.aspx).</span></span> <span data-ttu-id="859e5-222">Dokument White Paper od Michaela McKeown, Hanu Kommalapati a Jason Skořepa.</span><span class="sxs-lookup"><span data-stu-id="859e5-222">White paper by Michael McKeown, Hanu Kommalapati, and Jason Roth.</span></span>
- <span data-ttu-id="859e5-223">[Vzory a postupy Microsoftu – doprovodné materiály pro Azure](https://msdn.microsoft.com/library/dn568099.aspx)</span><span class="sxs-lookup"><span data-stu-id="859e5-223">[Microsoft Patterns and Practices - Azure Guidance](https://msdn.microsoft.com/library/dn568099.aspx).</span></span> <span data-ttu-id="859e5-224">Viz pokyny pro nasazení ve více datových centrech, vzorek přerušení okruhu.</span><span class="sxs-lookup"><span data-stu-id="859e5-224">See Multi Data Center Deployment guidance, Circuit breaker pattern.</span></span>
- <span data-ttu-id="859e5-225">[Podpora Azure – smlouvy o úrovni služeb](https://azure.microsoft.com/support/legal/sla/).</span><span class="sxs-lookup"><span data-stu-id="859e5-225">[Azure Support - Service Level Agreements](https://azure.microsoft.com/support/legal/sla/).</span></span>
- <span data-ttu-id="859e5-226">[Provozní kontinuita v Azure SQL Database](https://msdn.microsoft.com/library/windowsazure/hh852669.aspx).</span><span class="sxs-lookup"><span data-stu-id="859e5-226">[Business Continuity in Azure SQL Database](https://msdn.microsoft.com/library/windowsazure/hh852669.aspx).</span></span> <span data-ttu-id="859e5-227">Dokumentace k SQL Database funkcím vysoké dostupnosti a zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="859e5-227">Documentation about SQL Database high availability and disaster recovery features.</span></span>
- <span data-ttu-id="859e5-228">[Vysoká dostupnost a zotavení po havárii pro SQL Server v Azure Virtual Machines](https://msdn.microsoft.com/library/windowsazure/jj870962.aspx).</span><span class="sxs-lookup"><span data-stu-id="859e5-228">[High Availability and Disaster Recovery for SQL Server in Azure Virtual Machines](https://msdn.microsoft.com/library/windowsazure/jj870962.aspx).</span></span>

<span data-ttu-id="859e5-229">Videa:</span><span class="sxs-lookup"><span data-stu-id="859e5-229">Videos:</span></span>

- <span data-ttu-id="859e5-230">[Failsafe: vytváření škálovatelných, odolných Cloud Services](https://channel9.msdn.com/Series/FailSafe).</span><span class="sxs-lookup"><span data-stu-id="859e5-230">[FailSafe: Building Scalable, Resilient Cloud Services](https://channel9.msdn.com/Series/FailSafe).</span></span> <span data-ttu-id="859e5-231">Devět částí podle Ulrich Homann, matolin Mercuri a označit Simms.</span><span class="sxs-lookup"><span data-stu-id="859e5-231">Nine-part series by Ulrich Homann, Marc Mercuri, and Mark Simms.</span></span> <span data-ttu-id="859e5-232">Prezentuje základní koncepty a principy architektury v rámci velmi přístupného a zajímavého způsobu, který vychází ze zkušeností zákazníků Microsoftu pro poradenské zákazníky (CAT) se skutečnými zákazníky.</span><span class="sxs-lookup"><span data-stu-id="859e5-232">Presents high-level concepts and architectural principles in a very accessible and interesting way, with stories drawn from Microsoft Customer Advisory Team (CAT) experience with actual customers.</span></span> <span data-ttu-id="859e5-233">Díly 1 a 8 se podrobněji dostanou do předdefinovaných důvodů selhání při navrhování cloudových aplikací.</span><span class="sxs-lookup"><span data-stu-id="859e5-233">Episodes 1 and 8 go in depth into the reasons for designing cloud apps to survive failures.</span></span> <span data-ttu-id="859e5-234">Viz také následná diskuze o omezování v epizody 2 od 49:57, diskuzi o bodech selhání a režimech selhání ve epizody 2 počínaje 56:05 a diskuzi o přepínacích modulech okruhu ve epizodě 3 od 40:55.</span><span class="sxs-lookup"><span data-stu-id="859e5-234">See also the follow-up discussion of throttling in episode 2 starting at 49:57, the discussion of failure points and failure modes in episode 2 starting at 56:05, and the discussion of circuit breakers in episode 3 starting at 40:55.</span></span>
- <span data-ttu-id="859e5-235">[Sestavování velkých: lekcí získaných od zákazníků Azure – část II](https://channel9.msdn.com/Events/Build/2012/3-030).</span><span class="sxs-lookup"><span data-stu-id="859e5-235">[Building Big: Lessons learned from Azure customers - Part II](https://channel9.msdn.com/Events/Build/2012/3-030).</span></span> <span data-ttu-id="859e5-236">Označte Simms rozhovory o návrhu pro selhání a instrumentaci všeho.</span><span class="sxs-lookup"><span data-stu-id="859e5-236">Mark Simms talks about designing for failure and instrumenting everything.</span></span> <span data-ttu-id="859e5-237">Podobně jako u řady Failsafe, ale odkazuje na další podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="859e5-237">Similar to the Failsafe series but goes into more how-to details.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="859e5-238">[Předchozí](unstructured-blob-storage.md)
> [Další](monitoring-and-telemetry.md)</span><span class="sxs-lookup"><span data-stu-id="859e5-238">[Previous](unstructured-blob-storage.md)
[Next](monitoring-and-telemetry.md)</span></span>
