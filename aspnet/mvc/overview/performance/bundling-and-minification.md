---
uid: mvc/overview/performance/bundling-and-minification
title: Sdružování a minifikace | Microsoft Docs
author: Rick-Anderson
description: Sdružování a minifikace jsou dva postupy, které můžete použít v ASP.NET 4,5 ke zlepšení doby načítání požadavků. Sdružování a minifikace vylepšuje dobu načítání prostřednictvím reducin...
ms.author: riande
ms.date: 08/23/2012
ms.assetid: 5894dc13-5d45-4dad-8096-136499120f1d
msc.legacyurl: /mvc/overview/performance/bundling-and-minification
msc.type: authoredcontent
ms.openlocfilehash: 239980d747c6e0d6be1e9b4fe0371e276e37cf21
ms.sourcegitcommit: 88fc80e3f65aebdf61ec9414810ddbc31c543f04
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/22/2020
ms.locfileid: "76519281"
---
# <a name="bundling-and-minification"></a><span data-ttu-id="f4cb3-104">Sdružování a minifikace</span><span class="sxs-lookup"><span data-stu-id="f4cb3-104">Bundling and Minification</span></span>

<span data-ttu-id="f4cb3-105">od [Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="f4cb3-105">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

> <span data-ttu-id="f4cb3-106">Sdružování a minifikace jsou dva postupy, které můžete použít v ASP.NET 4,5 ke zlepšení doby načítání požadavků.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-106">Bundling and minification are two techniques you can use in ASP.NET 4.5 to improve request load time.</span></span> <span data-ttu-id="f4cb3-107">Sdružování a minifikace vylepšuje dobu načítání tím, že snižuje počet požadavků na server a snižuje velikost požadovaných prostředků (například CSS a JavaScript).</span><span class="sxs-lookup"><span data-stu-id="f4cb3-107">Bundling and minification improves load time by reducing the number of requests to the server and reducing the size of requested assets (such as CSS and JavaScript.)</span></span>

<span data-ttu-id="f4cb3-108">Většina aktuálních hlavních prohlížečů omezuje počet [souběžných připojení](http://www.browserscope.org/?category=network) na každý název hostitele na šest.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-108">Most of the current major browsers limit the number of [simultaneous connections](http://www.browserscope.org/?category=network) per each hostname to six.</span></span> <span data-ttu-id="f4cb3-109">To znamená, že až se šest požadavků zpracovává, v prohlížeči se zařadí další požadavky na prostředky na hostitele.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-109">That means that while six requests are being processed, additional requests for assets on a host will be queued by the browser.</span></span> <span data-ttu-id="f4cb3-110">Na následujícím obrázku se na kartách sítě IE F12 Developer Tools zobrazuje časování prostředků vyžadovaných zobrazením ukázkové aplikace.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-110">In the image below, the IE F12 developer tools network tabs shows the timing for assets required by the About view of a sample application.</span></span>

![B/M](bundling-and-minification/_static/image1.png)

<span data-ttu-id="f4cb3-112">Šedé pruhy zobrazují čas, který prohlížeč vyřadí do fronty čekáním na šest limitů připojení.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-112">The gray bars show the time the request is queued by the browser waiting on the six connection limit.</span></span> <span data-ttu-id="f4cb3-113">Žlutým pruhem je požadavek na první bajt, tedy čas potřebný k odeslání požadavku a přijetí první odpovědi ze serveru.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-113">The yellow bar is the request time to first byte, that is, the time taken to send the request and receive the first response from the server.</span></span> <span data-ttu-id="f4cb3-114">Modré pruhy znázorňují čas potřebný k přijetí dat odpovědi ze serveru.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-114">The blue bars show the time taken to receive the response data from the server.</span></span> <span data-ttu-id="f4cb3-115">Poklikáním na prostředek můžete získat podrobné informace o časování.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-115">You can double-click on an asset to get detailed timing information.</span></span> <span data-ttu-id="f4cb3-116">Například následující obrázek ukazuje podrobnosti časování pro načtení souboru */Scripts/MyScripts/JavaScript6.js* .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-116">For example, the following image shows the timing details for loading the */Scripts/MyScripts/JavaScript6.js* file.</span></span>

![](bundling-and-minification/_static/image2.png)

<span data-ttu-id="f4cb3-117">Předchozí obrázek znázorňuje **počáteční** událost, která udává čas, kdy se požadavek zařadil do fronty, protože prohlížeč omezuje počet současných připojení.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-117">The preceding image shows the **Start** event, which gives the time the request was queued because of the browser limit the number of simultaneous connections.</span></span> <span data-ttu-id="f4cb3-118">V takovém případě se žádost zařadila do fronty po 46 milisekund čekání na dokončení jiné žádosti.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-118">In this case, the request was queued for 46 milliseconds waiting for another request to complete.</span></span>

## <a name="bundling"></a><span data-ttu-id="f4cb3-119">Sdružování</span><span class="sxs-lookup"><span data-stu-id="f4cb3-119">Bundling</span></span>

<span data-ttu-id="f4cb3-120">Sdružování je nová funkce v ASP.NET 4,5, která usnadňuje kombinování nebo rozčlenění více souborů do jednoho souboru.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-120">Bundling is a new feature in ASP.NET 4.5 that makes it easy to combine or bundle multiple files into a single file.</span></span> <span data-ttu-id="f4cb3-121">Můžete vytvářet šablony stylů CSS, JavaScript a další sady.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-121">You can create CSS, JavaScript and other bundles.</span></span> <span data-ttu-id="f4cb3-122">Méně souborů znamená méně požadavků HTTP a může zlepšit výkon při prvním načtení stránky.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-122">Fewer files means fewer HTTP requests and that can improve first page load performance.</span></span>

<span data-ttu-id="f4cb3-123">Následující obrázek znázorňuje stejné zobrazení časování zobrazení o aplikaci, které se zobrazilo dříve, ale tentokrát s povoleným sdružováním a minifikace.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-123">The following image shows the same timing view of the About view shown previously, but this time with bundling and minification enabled.</span></span>

![](bundling-and-minification/_static/image3.png)

## <a name="minification"></a><span data-ttu-id="f4cb3-124">Minifikace</span><span class="sxs-lookup"><span data-stu-id="f4cb3-124">Minification</span></span>

<span data-ttu-id="f4cb3-125">Minifikace provádí různé optimalizace kódu pro skripty nebo šablony stylů CSS, jako je například odebrání nepotřebných prázdných znaků a komentářů a zkrácení názvů proměnných na jeden znak.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-125">Minification performs a variety of different code optimizations to scripts or css, such as removing unnecessary white space and comments and shortening variable names to one character.</span></span> <span data-ttu-id="f4cb3-126">Vezměte v úvahu následující funkce JavaScriptu.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-126">Consider the following JavaScript function.</span></span>

[!code-javascript[Main](bundling-and-minification/samples/sample1.js)]

<span data-ttu-id="f4cb3-127">Po minifikace je funkce snížena na následující:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-127">After minification, the function is reduced to the following:</span></span>

[!code-javascript[Main](bundling-and-minification/samples/sample2.js)]

<span data-ttu-id="f4cb3-128">Kromě odebrání komentářů a nepotřebných prázdných znaků byly následující parametry a názvy proměnných přejmenovány (zkráceny) následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-128">In addition to removing the comments and unnecessary whitespace, the following parameters and variable names were renamed (shortened) as follows:</span></span>

| <span data-ttu-id="f4cb3-129">**Původně**</span><span class="sxs-lookup"><span data-stu-id="f4cb3-129">**Original**</span></span> | <span data-ttu-id="f4cb3-130">**Jmenovanou**</span><span class="sxs-lookup"><span data-stu-id="f4cb3-130">**Renamed**</span></span> |
| --- | --- |
| <span data-ttu-id="f4cb3-131">imageTagAndImageID</span><span class="sxs-lookup"><span data-stu-id="f4cb3-131">imageTagAndImageID</span></span> | <span data-ttu-id="f4cb3-132">n</span><span class="sxs-lookup"><span data-stu-id="f4cb3-132">n</span></span> |
| <span data-ttu-id="f4cb3-133">imageContext</span><span class="sxs-lookup"><span data-stu-id="f4cb3-133">imageContext</span></span> | <span data-ttu-id="f4cb3-134">t</span><span class="sxs-lookup"><span data-stu-id="f4cb3-134">t</span></span> |
| <span data-ttu-id="f4cb3-135">imageElement</span><span class="sxs-lookup"><span data-stu-id="f4cb3-135">imageElement</span></span> | <span data-ttu-id="f4cb3-136">i</span><span class="sxs-lookup"><span data-stu-id="f4cb3-136">i</span></span> |

## <a name="impact-of-bundling-and-minification"></a><span data-ttu-id="f4cb3-137">Dopad sdružování a minifikace</span><span class="sxs-lookup"><span data-stu-id="f4cb3-137">Impact of Bundling and Minification</span></span>

<span data-ttu-id="f4cb3-138">V následující tabulce je uvedeno několik důležitých rozdílů mezi seznamem všech prostředků jednotlivě a pomocí sdružování a minifikace (B/M) v ukázkovém programu.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-138">The following table shows several important differences between listing all the assets individually and using bundling and minification (B/M) in the sample program.</span></span>

|  | <span data-ttu-id="f4cb3-139">**Použití B/M**</span><span class="sxs-lookup"><span data-stu-id="f4cb3-139">**Using B/M**</span></span> | <span data-ttu-id="f4cb3-140">**Bez B/M**</span><span class="sxs-lookup"><span data-stu-id="f4cb3-140">**Without B/M**</span></span> | <span data-ttu-id="f4cb3-141">**Mění**</span><span class="sxs-lookup"><span data-stu-id="f4cb3-141">**Change**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="f4cb3-142">**Požadavky na soubory**</span><span class="sxs-lookup"><span data-stu-id="f4cb3-142">**File Requests**</span></span> | <span data-ttu-id="f4cb3-143">9</span><span class="sxs-lookup"><span data-stu-id="f4cb3-143">9</span></span> | <span data-ttu-id="f4cb3-144">34</span><span class="sxs-lookup"><span data-stu-id="f4cb3-144">34</span></span> | <span data-ttu-id="f4cb3-145">256%</span><span class="sxs-lookup"><span data-stu-id="f4cb3-145">256%</span></span> |
| <span data-ttu-id="f4cb3-146">**Odesláno KB**</span><span class="sxs-lookup"><span data-stu-id="f4cb3-146">**KB Sent**</span></span> | <span data-ttu-id="f4cb3-147">3.26</span><span class="sxs-lookup"><span data-stu-id="f4cb3-147">3.26</span></span> | <span data-ttu-id="f4cb3-148">11.92</span><span class="sxs-lookup"><span data-stu-id="f4cb3-148">11.92</span></span> | <span data-ttu-id="f4cb3-149">266%</span><span class="sxs-lookup"><span data-stu-id="f4cb3-149">266%</span></span> |
| <span data-ttu-id="f4cb3-150">**Přijato KB**</span><span class="sxs-lookup"><span data-stu-id="f4cb3-150">**KB Received**</span></span> | <span data-ttu-id="f4cb3-151">388.51</span><span class="sxs-lookup"><span data-stu-id="f4cb3-151">388.51</span></span> | <span data-ttu-id="f4cb3-152">530</span><span class="sxs-lookup"><span data-stu-id="f4cb3-152">530</span></span> | <span data-ttu-id="f4cb3-153">36 %</span><span class="sxs-lookup"><span data-stu-id="f4cb3-153">36%</span></span> |
| <span data-ttu-id="f4cb3-154">**Čas načtení**</span><span class="sxs-lookup"><span data-stu-id="f4cb3-154">**Load Time**</span></span> | <span data-ttu-id="f4cb3-155">510 MS</span><span class="sxs-lookup"><span data-stu-id="f4cb3-155">510 MS</span></span> | <span data-ttu-id="f4cb3-156">780 MS</span><span class="sxs-lookup"><span data-stu-id="f4cb3-156">780 MS</span></span> | <span data-ttu-id="f4cb3-157">53%</span><span class="sxs-lookup"><span data-stu-id="f4cb3-157">53%</span></span> |

<span data-ttu-id="f4cb3-158">Odeslané bajty měly výrazné snížení se sdružováním, protože prohlížeče jsou poměrně podrobné s použitím hlaviček protokolu HTTP, které se vztahují na požadavky.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-158">The bytes sent had a significant reduction with bundling as browsers are fairly verbose with the HTTP headers they apply on requests.</span></span> <span data-ttu-id="f4cb3-159">Snížení počtu přijatých bajtů není tak velké, protože největší soubory (*skripty\\jQuery-UI-1.8.11. min. js* a *skripty\\jQuery 1.7.1. min. js*) již minifikovaného.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-159">The received bytes reduction is not as large because the largest files (*Scripts\\jquery-ui-1.8.11.min.js* and *Scripts\\jquery-1.7.1.min.js*) are already minified.</span></span> <span data-ttu-id="f4cb3-160">Poznámka: časování ukázkového programu používalo nástroj [Fiddler](http://www.fiddler2.com/fiddler2/) k simulaci pomalé sítě.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-160">Note: The timings on the sample program used the [Fiddler](http://www.fiddler2.com/fiddler2/) tool to simulate a slow network.</span></span> <span data-ttu-id="f4cb3-161">(V nabídce **pravidla** Fiddler vyberte možnost **výkon** a nastavte **simulaci rychlosti modemu**.)</span><span class="sxs-lookup"><span data-stu-id="f4cb3-161">(From the Fiddler **Rules** menu, select **Performance** then **Simulate Modem Speeds**.)</span></span>

## <a name="debugging-bundled-and-minified-javascript"></a><span data-ttu-id="f4cb3-162">Ladění a minifikovaného JavaScriptu pro balíčky</span><span class="sxs-lookup"><span data-stu-id="f4cb3-162">Debugging Bundled and Minified JavaScript</span></span>

<span data-ttu-id="f4cb3-163">Je snadné ladit JavaScript ve vývojovém prostředí (kde je [element Compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) v souboru *Web. config* nastaven na `debug="true"`), protože soubory JavaScriptu nejsou v balíčku nebo minifikovaného.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-163">It's easy to debug your JavaScript in a development environment (where the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx) in the *Web.config* file is set to `debug="true"` ) because the JavaScript files are not bundled or minified.</span></span> <span data-ttu-id="f4cb3-164">Můžete také ladit sestavení pro vydání, kde jsou soubory JavaScriptu seskupené a minifikovaného.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-164">You can also debug a release build where your JavaScript files are bundled and minified.</span></span> <span data-ttu-id="f4cb3-165">Pomocí vývojářských nástrojů IE F12 můžete ladit funkci JavaScriptu, která je součástí minifikovaného sady, pomocí následujícího postupu:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-165">Using the IE F12 developer tools, you debug a JavaScript function included in a minified bundle using the following approach:</span></span>

1. <span data-ttu-id="f4cb3-166">Vyberte kartu **skript** a potom vyberte tlačítko **Spustit ladění** .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-166">Select the **Script** tab and then select the **Start debugging** button.</span></span>
2. <span data-ttu-id="f4cb3-167">Vyberte sadu prostředků obsahující funkci JavaScriptu, kterou chcete ladit, pomocí tlačítka assety.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-167">Select the bundle containing the JavaScript function you want to debug using the assets button.</span></span>  
    ![](bundling-and-minification/_static/image4.png)
3. <span data-ttu-id="f4cb3-168">Minifikovaného JavaScript naformátujte tak, že vyberete **tlačítko konfigurace** ![](bundling-and-minification/_static/image5.png)a pak vyberete **formát JavaScript**.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-168">Format the minified JavaScript by selecting the **Configuration button** ![](bundling-and-minification/_static/image5.png), and then selecting **Format JavaScript**.</span></span>
4. <span data-ttu-id="f4cb3-169">Ve vstupním poli **vyhledávacího skriptu** vyberte název funkce, kterou chcete ladit.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-169">In the **Search Script** input box, select the name of the function you want to debug.</span></span> <span data-ttu-id="f4cb3-170">Na následujícím obrázku byl do vstupního pole **vyhledávacího skriptu** zadán **AddAltToImg** .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-170">In the following image, **AddAltToImg** was entered in the **Search Script** input box.</span></span>  
    ![](bundling-and-minification/_static/image6.png)

<span data-ttu-id="f4cb3-171">Další informace o ladění pomocí vývojářských nástrojů F12 najdete v článku na webu MSDN, který [používá vývojářské nástroje F12 k ladění chyb JavaScriptu](https://msdn.microsoft.com/library/ie/gg699336(v=vs.85).aspx).</span><span class="sxs-lookup"><span data-stu-id="f4cb3-171">For more information on debugging with the F12 developer tools, see the MSDN article [Using the F12 Developer Tools to Debug JavaScript Errors](https://msdn.microsoft.com/library/ie/gg699336(v=vs.85).aspx).</span></span>

## <a name="controlling-bundling-and-minification"></a><span data-ttu-id="f4cb3-172">Řízení sdružování a minifikace</span><span class="sxs-lookup"><span data-stu-id="f4cb3-172">Controlling Bundling and Minification</span></span>

<span data-ttu-id="f4cb3-173">Sdružování a minifikace jsou povoleny nebo zakázány nastavením hodnoty atributu Debug v [elementu compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) v souboru *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-173">Bundling and minification is enabled or disabled by setting the value of the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file.</span></span> <span data-ttu-id="f4cb3-174">V následujícím kódu XML je `debug` nastavené na hodnotu true, takže sdružování a minifikace jsou zakázané.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-174">In the following XML, `debug` is set to true so bundling and minification is disabled.</span></span>

[!code-xml[Main](bundling-and-minification/samples/sample3.xml?highlight=2)]

<span data-ttu-id="f4cb3-175">Pokud chcete povolit sdružování a minifikace, nastavte hodnotu `debug` na false (NEPRAVDA).</span><span class="sxs-lookup"><span data-stu-id="f4cb3-175">To enable bundling and minification, set the `debug` value to "false".</span></span> <span data-ttu-id="f4cb3-176">Nastavení *Web. config* můžete přepsat vlastností `EnableOptimizations` třídy `BundleTable`.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-176">You can override the *Web.config* setting with the `EnableOptimizations` property on the `BundleTable` class.</span></span> <span data-ttu-id="f4cb3-177">Následující kód umožňuje sdružování a minifikace a Přepisuje jakékoli nastavení v souboru *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-177">The following code enables bundling and minification and overrides any setting in the *Web.config* file.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample4.cs?highlight=7)]

> [!NOTE]
> <span data-ttu-id="f4cb3-178">Pokud `EnableOptimizations` není `true` nebo atribut debug v [prvku Compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) v souboru *Web. config* je nastaven na `false`, soubory nebudou seskupeny ani minifikovaného.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-178">Unless `EnableOptimizations` is `true` or the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file is set to `false`, files will not be bundled or minified.</span></span> <span data-ttu-id="f4cb3-179">Kromě toho se nepoužijí soubory. min, přičemž budou vybrány úplné verze ladění.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-179">Additionally, the .min version of files will not be used, the full debug versions will be selected.</span></span> <span data-ttu-id="f4cb3-180">`EnableOptimizations` Přepisuje atribut debug v [elementu compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) v souboru *Web. config.*</span><span class="sxs-lookup"><span data-stu-id="f4cb3-180">`EnableOptimizations` overrides the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file</span></span>

## <a name="using-bundling-and-minification-with-aspnet-web-forms-and-web-pages"></a><span data-ttu-id="f4cb3-181">Použití sdružování a minifikace s webovými formuláři ASP.NET a webovými stránkami</span><span class="sxs-lookup"><span data-stu-id="f4cb3-181">Using Bundling and Minification with ASP.NET Web Forms and Web Pages</span></span>

- <span data-ttu-id="f4cb3-182">Informace o webových stránkách naleznete v položce blogu [Přidání webové optimalizace na web webové stránky](https://docs.microsoft.com/archive/blogs/rickandy/adding-web-optimization-to-a-web-pages-site).</span><span class="sxs-lookup"><span data-stu-id="f4cb3-182">For Web Pages, see the blog entry [Adding Web Optimization to a Web Pages Site](https://docs.microsoft.com/archive/blogs/rickandy/adding-web-optimization-to-a-web-pages-site).</span></span>
- <span data-ttu-id="f4cb3-183">Webové formuláře najdete v tématu [Přidání zařazení a minifikace do webových formulářů](https://docs.microsoft.com/archive/blogs/rickandy/adding-bundling-and-minification-to-web-forms)na blogu.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-183">For Web Forms, see the blog entry [Adding Bundling and Minification to Web Forms](https://docs.microsoft.com/archive/blogs/rickandy/adding-bundling-and-minification-to-web-forms).</span></span>

## <a name="using-bundling-and-minification-with-aspnet-mvc"></a><span data-ttu-id="f4cb3-184">Použití sdružování a minifikace s ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="f4cb3-184">Using Bundling and Minification with ASP.NET MVC</span></span>

<span data-ttu-id="f4cb3-185">V této části vytvoříme projekt ASP.NET MVC, který bude kontrolovat sdružování a minifikace.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-185">In this section we will create an ASP.NET MVC project to examine bundling and minification.</span></span> <span data-ttu-id="f4cb3-186">Nejprve vytvořte nový internetový projekt ASP.NET MVC s názvem **MvcBM** , aniž by došlo ke změně výchozího nastavení.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-186">First, create a new ASP.NET MVC internet project named **MvcBM** without changing any of the defaults.</span></span>

<span data-ttu-id="f4cb3-187">Otevřete *aplikaci\\\_spusťte soubor\\BundleConfig.cs* a Projděte si `RegisterBundles` metodu, která se používá k vytváření, registraci a konfiguraci sad.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-187">Open the *App\\\_Start\\BundleConfig.cs* file and examine the `RegisterBundles` method which is used to create, register and configure bundles.</span></span> <span data-ttu-id="f4cb3-188">Následující kód ukazuje část metody `RegisterBundles`.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-188">The following code shows a portion of the `RegisterBundles` method.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample5.cs)]

<span data-ttu-id="f4cb3-189">Předchozí kód vytvoří novou sadu JavaScriptu s názvem *~/Bundles/jQuery* , která obsahuje všechny příslušné (tj. Debug nebo minifikovaného, ale ne. *vsdoc*) soubory ve složce *Scripts* , které odpovídají řetězci zástupné karty "~/Scripts/jQuery-{Version}.js".</span><span class="sxs-lookup"><span data-stu-id="f4cb3-189">The  preceding code creates a new JavaScript bundle named *~/bundles/jquery* that includes all the appropriate (that is debug or minified but not .*vsdoc*) files in the *Scripts* folder that match the wild card string "~/Scripts/jquery-{version}.js".</span></span> <span data-ttu-id="f4cb3-190">Pro ASP.NET MVC 4 to znamená s konfigurací ladění, soubor *jQuery 1.7.1. js* se přidá do sady prostředků.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-190">For ASP.NET MVC 4, this means with a debug configuration, the file *jquery-1.7.1.js* will be added to the bundle.</span></span> <span data-ttu-id="f4cb3-191">V konfiguraci vydané verze se přidá *jQuery 1.7.1. min. js* .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-191">In a release configuration, *jquery-1.7.1.min.js* will be added.</span></span> <span data-ttu-id="f4cb3-192">Rozhraní sdružování se skládá z několika běžných konvencí, jako například:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-192">The bundling framework follows several common conventions such as:</span></span>

- <span data-ttu-id="f4cb3-193">Výběr souboru ". min" pro vydání, pokud existují *FileX. min. js* a *FileX. js* .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-193">Selecting ".min" file for release when *FileX.min.js* and *FileX.js* exist.</span></span>
- <span data-ttu-id="f4cb3-194">Výběr verze, která není ". min" pro ladění.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-194">Selecting the non ".min" version for debug.</span></span>
- <span data-ttu-id="f4cb3-195">Ignorují se soubory "-vsdoc" (například *jQuery 1.7.1-vsdoc. js*), které jsou používány pouze pomocí technologie IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-195">Ignoring "-vsdoc" files (such as *jquery-1.7.1-vsdoc.js*), which are used only by IntelliSense.</span></span>

<span data-ttu-id="f4cb3-196">`{version}` zástupné znaky, které jsou uvedené výše, slouží k automatickému vytvoření sady jQuery s příslušnou verzí jQuery ve složce *Scripts* .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-196">The `{version}` wild card matching shown above is used to automatically create a jQuery bundle with the appropriate version of jQuery in your *Scripts* folder.</span></span> <span data-ttu-id="f4cb3-197">V tomto příkladu použití zástupné karty přináší následující výhody:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-197">In this example, using a wild card provides the following benefits:</span></span>

- <span data-ttu-id="f4cb3-198">Umožňuje použít NuGet pro aktualizaci na novější verzi jQuery beze změny předcházejícího kódu služby sdružování nebo odkazů jQuery na stránkách zobrazení.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-198">Allows you to use NuGet to update to a newer jQuery version without changing the preceding bundling code or jQuery references in your view pages.</span></span>
- <span data-ttu-id="f4cb3-199">Automaticky vybere úplnou verzi pro konfigurace ladění a verzi ". min" pro sestavení vydaných verzí.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-199">Automatically selects the full version for debug configurations and the ".min" version for release builds.</span></span>

## <a name="using-a-cdn"></a><span data-ttu-id="f4cb3-200">Používání sítě CDN</span><span class="sxs-lookup"><span data-stu-id="f4cb3-200">Using a CDN</span></span>

 <span data-ttu-id="f4cb3-201">Následující kód nahrazuje místní sadu jQuery pomocí sady CDN jQuery.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-201">The follow code replaces the local jQuery bundle with a CDN jQuery bundle.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample6.cs)]

<span data-ttu-id="f4cb3-202">Ve výše uvedeném kódu bude z CDN v režimu vydání požadován příkaz jQuery a ladicí verze jQuery bude v režimu ladění načtena místně.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-202">In the code above, jQuery will be requested from the CDN while in release mode and the debug version of jQuery will be fetched locally in debug mode.</span></span> <span data-ttu-id="f4cb3-203">Při používání sítě CDN byste měli mít záložní mechanismus pro případ, že žádost CDN není úspěšná.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-203">When using a CDN, you should have a fallback mechanism in case the CDN request fails.</span></span> <span data-ttu-id="f4cb3-204">Následující fragment kódu z konce souboru rozložení zobrazuje skript přidaný do požadavku jQuery, aby síť CDN nebyla úspěšná.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-204">The following markup fragment from the end of the layout file shows script added to request jQuery should the CDN fail.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample7.cshtml?highlight=5-13)]

## <a name="creating-a-bundle"></a><span data-ttu-id="f4cb3-205">Vytvoření sady prostředků</span><span class="sxs-lookup"><span data-stu-id="f4cb3-205">Creating a Bundle</span></span>

<span data-ttu-id="f4cb3-206">Třída [sady prostředků](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) `Include` metoda přebírá pole řetězců, kde každý řetězec je virtuální cesta k prostředku.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-206">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `Include` method takes an array of strings, where each string is a virtual path to resource.</span></span> <span data-ttu-id="f4cb3-207">Následující kód z metody `RegisterBundles` v *App\\\_Start\\BundleConfig.cs* ukazuje, jakým způsobem se do sady přidaly různé soubory:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-207">The following code from the `RegisterBundles` method in the *App\\\_Start\\BundleConfig.cs* file shows how multiple files are added to a bundle:</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample8.cs)]

<span data-ttu-id="f4cb3-208">K přidání všech souborů v adresáři (a volitelně všech podadresářích), které odpovídají vzoru hledání, je k dispozici `IncludeDirectory` třídy [sady prostředků](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-208">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `IncludeDirectory` method is provided to add all the files in a directory (and optionally all subdirectories) which match a search pattern.</span></span> <span data-ttu-id="f4cb3-209">`IncludeDirectory` rozhraní API třídy [sady prostředků](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) se zobrazuje níže:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-209">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `IncludeDirectory` API is shown below:</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample9.cs)]

<span data-ttu-id="f4cb3-210">Na sady jsou odkazovány v zobrazeních pomocí metody Render (`Styles.Render` pro CSS a `Scripts.Render` pro JavaScript).</span><span class="sxs-lookup"><span data-stu-id="f4cb3-210">Bundles are referenced in views using the Render method, (`Styles.Render` for CSS and `Scripts.Render` for JavaScript).</span></span> <span data-ttu-id="f4cb3-211">Následující kód z *zobrazení\\sdílené\\\_layout. cshtml* ukazuje, jak výchozí ASP.NET zobrazení internetového projektu odkazuje na sady CSS a JavaScript.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-211">The following markup from the *Views\\Shared\\\_Layout.cshtml* file shows how the default ASP.NET internet project views reference CSS and JavaScript bundles.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample10.cshtml?highlight=5-6,11)]

<span data-ttu-id="f4cb3-212">Všimněte si, že metody vykreslování přebírají pole řetězců, takže můžete přidat více sad v jednom řádku kódu.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-212">Notice the Render methods takes an array of strings, so you can add multiple bundles in one line of code.</span></span> <span data-ttu-id="f4cb3-213">Obecně budete chtít použít metody vykreslení, které vytvoří nezbytný kód HTML pro odkaz na prostředek.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-213">You will generally want to use the Render methods which create the necessary HTML to reference the asset.</span></span> <span data-ttu-id="f4cb3-214">Můžete použít metodu `Url` pro vygenerování adresy URL assetu bez označení potřebného k odkazování na prostředek.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-214">You can use the `Url` method to generate the URL to the asset without the markup needed to reference the asset.</span></span> <span data-ttu-id="f4cb3-215">Předpokládejme, že jste chtěli použít nový [asynchronní](http://www.whatwg.org/specs/web-apps/current-work/#attr-script-async) atribut HTML5.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-215">Suppose you wanted to use the new HTML5 [async](http://www.whatwg.org/specs/web-apps/current-work/#attr-script-async) attribute.</span></span> <span data-ttu-id="f4cb3-216">Následující kód ukazuje, jak odkazovat na modernizr pomocí metody `Url`.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-216">The following code shows how to reference modernizr using the `Url` method.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample11.cshtml?highlight=11)]

## <a name="using-the--wildcard-character-to-select-files"></a><span data-ttu-id="f4cb3-217">Použití zástupného znaku "\*" pro výběr souborů</span><span class="sxs-lookup"><span data-stu-id="f4cb3-217">Using the "\*" Wildcard Character to Select Files</span></span>

<span data-ttu-id="f4cb3-218">Virtuální cesta zadaná v metodě `Include` a ve vzorci hledání v metodě `IncludeDirectory` může přijmout jeden zástupný znak "\*" jako předponu nebo příponu do posledního segmentu cesty.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-218">The virtual path specified in the `Include` method and the search pattern in the `IncludeDirectory` method can accept one "\*" wildcard character as a prefix or suffix to in the last path segment.</span></span> <span data-ttu-id="f4cb3-219">V řetězci hledání se nerozlišují malá a velká písmena.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-219">The search string is case insensitive.</span></span> <span data-ttu-id="f4cb3-220">Metoda `IncludeDirectory` má možnost Hledat podadresáře.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-220">The `IncludeDirectory` method has the option of searching subdirectories.</span></span>

<span data-ttu-id="f4cb3-221">Vezměte v úvahu projekt s následujícími soubory JavaScriptu:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-221">Consider a project with the following JavaScript files:</span></span>

- <span data-ttu-id="f4cb3-222">*Scripts\\Common\\AddAltToImg.js*</span><span class="sxs-lookup"><span data-stu-id="f4cb3-222">*Scripts\\Common\\AddAltToImg.js*</span></span>
- <span data-ttu-id="f4cb3-223">*Scripts\\Common\\ToggleDiv.js*</span><span class="sxs-lookup"><span data-stu-id="f4cb3-223">*Scripts\\Common\\ToggleDiv.js*</span></span>
- <span data-ttu-id="f4cb3-224">*Scripts\\Common\\ToggleImg.js*</span><span class="sxs-lookup"><span data-stu-id="f4cb3-224">*Scripts\\Common\\ToggleImg.js*</span></span>
- <span data-ttu-id="f4cb3-225">*Skripty\\Common\\sub1\\ToggleLinks. js*</span><span class="sxs-lookup"><span data-stu-id="f4cb3-225">*Scripts\\Common\\Sub1\\ToggleLinks.js*</span></span>

![DIR imag](bundling-and-minification/_static/image7.png)

<span data-ttu-id="f4cb3-227">Následující tabulka ukazuje soubory přidané do sady prostředků pomocí zástupného znaku, jak je znázorněno níže:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-227">The following table shows the files added to a bundle using the wildcard as shown:</span></span>

| <span data-ttu-id="f4cb3-228">**Volání**</span><span class="sxs-lookup"><span data-stu-id="f4cb3-228">**Call**</span></span> | <span data-ttu-id="f4cb3-229">**Přidané soubory nebo vyvolání výjimky**</span><span class="sxs-lookup"><span data-stu-id="f4cb3-229">**Files Added or Exception Raised**</span></span> |
| --- | --- |
| <span data-ttu-id="f4cb3-230">Include ("~/Scripts/Common/\*. js")</span><span class="sxs-lookup"><span data-stu-id="f4cb3-230">Include("~/Scripts/Common/\*.js")</span></span> | <span data-ttu-id="f4cb3-231">*AddAltToImg.js*, *ToggleDiv.js*, *ToggleImg.js*</span><span class="sxs-lookup"><span data-stu-id="f4cb3-231">*AddAltToImg.js*, *ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="f4cb3-232">Include ("~/Scripts/Common/T\*. js")</span><span class="sxs-lookup"><span data-stu-id="f4cb3-232">Include("~/Scripts/Common/T\*.js")</span></span> | <span data-ttu-id="f4cb3-233">Neplatná výjimka vzoru.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-233">Invalid pattern exception.</span></span> <span data-ttu-id="f4cb3-234">Zástupný znak je povolen pouze pro předponu nebo příponu.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-234">The wildcard character is only allowed on the prefix or suffix.</span></span> |
| <span data-ttu-id="f4cb3-235">Include ("~/Scripts/Common/\*og.\*")</span><span class="sxs-lookup"><span data-stu-id="f4cb3-235">Include("~/Scripts/Common/\*og.\*")</span></span> | <span data-ttu-id="f4cb3-236">Neplatná výjimka vzoru.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-236">Invalid pattern exception.</span></span> <span data-ttu-id="f4cb3-237">Je povolen pouze jeden zástupný znak.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-237">Only one wildcard character is allowed.</span></span> |
| <span data-ttu-id="f4cb3-238">Include ("~/Scripts/Common/T\*")</span><span class="sxs-lookup"><span data-stu-id="f4cb3-238">Include("~/Scripts/Common/T\*")</span></span> | <span data-ttu-id="f4cb3-239">*ToggleDiv.js*, *ToggleImg.js*</span><span class="sxs-lookup"><span data-stu-id="f4cb3-239">*ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="f4cb3-240">Include ("~/Scripts/Common/\*")</span><span class="sxs-lookup"><span data-stu-id="f4cb3-240">Include("~/Scripts/Common/\*")</span></span> | <span data-ttu-id="f4cb3-241">Neplatná výjimka vzoru.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-241">Invalid pattern exception.</span></span> <span data-ttu-id="f4cb3-242">Čistý zástupný segment není platný.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-242">A pure wildcard segment is not valid.</span></span> |
| <span data-ttu-id="f4cb3-243">IncludeDirectory ("~/Scripts/Common"; "T\*")</span><span class="sxs-lookup"><span data-stu-id="f4cb3-243">IncludeDirectory("~/Scripts/Common", "T\*")</span></span> | <span data-ttu-id="f4cb3-244">*ToggleDiv.js*, *ToggleImg.js*</span><span class="sxs-lookup"><span data-stu-id="f4cb3-244">*ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="f4cb3-245">IncludeDirectory ("~/Scripts/Common"; "T\*"; true)</span><span class="sxs-lookup"><span data-stu-id="f4cb3-245">IncludeDirectory("~/Scripts/Common", "T\*", true)</span></span> | <span data-ttu-id="f4cb3-246">*ToggleDiv.js*, *ToggleImg.js*, *ToggleLinks.js*</span><span class="sxs-lookup"><span data-stu-id="f4cb3-246">*ToggleDiv.js*, *ToggleImg.js*, *ToggleLinks.js*</span></span> |

<span data-ttu-id="f4cb3-247">Explicitní přidání každého souboru do sady se obvykle upřednostňuje pro načítání souborů se zástupnými znaky z následujících důvodů:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-247">Explicitly adding each file to a bundle is generally the preferred over wildcard loading of files for the following reasons:</span></span>

- <span data-ttu-id="f4cb3-248">Přidávání skriptů podle zástupných znaků, aby je bylo možné načíst v abecedním pořadí, což obvykle není to, co chcete.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-248">Adding scripts by wildcard defaults to loading them in alphabetical order, which is typically not what you want.</span></span> <span data-ttu-id="f4cb3-249">Soubory CSS a JavaScript často musí být přidány do konkrétní (neabecední) objednávky.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-249">CSS and JavaScript files frequently need to be added in a specific (non-alphabetic) order.</span></span> <span data-ttu-id="f4cb3-250">Toto riziko můžete zmírnit přidáním vlastní implementace [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) , ale explicitní přidání každého souboru je méně náchylné k chybám.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-250">You can mitigate this risk by adding a custom [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) implementation, but explicitly adding each file is less error prone.</span></span> <span data-ttu-id="f4cb3-251">Například můžete do složky v budoucnu přidat nové prostředky, které mohou vyžadovat úpravu [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) implementace.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-251">For example, you might add new assets to a folder in the future which might require you to modify your [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) implementation.</span></span>
- <span data-ttu-id="f4cb3-252">Zobrazení konkrétních souborů přidaných do adresáře pomocí zástupných znaků můžete zahrnout do všech zobrazení odkazujících na daný svazek.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-252">View specific files added to a directory using wild card loading can be included in all views referencing that bundle.</span></span> <span data-ttu-id="f4cb3-253">Pokud je do sady prostředků přidán konkrétní skript, může se v jiných zobrazeních, která odkazují na daný svazek, zobrazit chyba JavaScriptu.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-253">If the view specific script is added to a bundle, you may get a JavaScript error on other views that reference the bundle.</span></span>
- <span data-ttu-id="f4cb3-254">Soubory CSS, které importují jiné soubory, mají za následek dvojí načtení importovaných souborů.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-254">CSS files that import other files result in the imported files loaded twice.</span></span> <span data-ttu-id="f4cb3-255">Například následující kód vytvoří sadu prostředků s největším počtem souborů CSS motivu uživatelského rozhraní jQuery, které jsou načteny dvakrát.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-255">For example, the following code creates a bundle with most of the jQuery UI theme CSS files loaded twice.</span></span> 

    [!code-csharp[Main](bundling-and-minification/samples/sample12.cs)]

  <span data-ttu-id="f4cb3-256">Selektor zástupných znaků "\*. css" přiřadí všechny soubory CSS ve složce, včetně *obsahu\\themes\\base\\jQuery. UI. All. CSS* .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-256">The wild card selector "\*.css" brings in each CSS file in the folder, including the *Content\\themes\\base\\jquery.ui.all.css* file.</span></span> <span data-ttu-id="f4cb3-257">Soubor *jQuery. UI. All. CSS* importuje další soubory CSS.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-257">The *jquery.ui.all.css* file imports other CSS files.</span></span>

## <a name="bundle-caching"></a><span data-ttu-id="f4cb3-258">Ukládání sady prostředků do mezipaměti</span><span class="sxs-lookup"><span data-stu-id="f4cb3-258">Bundle Caching</span></span>

<span data-ttu-id="f4cb3-259">Sady svazků nastavují hlavičku Expires protokolu HTTP jeden rok od okamžiku vytvoření sady.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-259">Bundles set the HTTP Expires Header one year from when the bundle is created.</span></span> <span data-ttu-id="f4cb3-260">Pokud přejdete na dříve zobrazenou stránku, Fiddler ukazuje, že IE nevytváří podmíněný požadavek na sadu, tedy neexistují žádné požadavky HTTP GET z IE na sady a žádné odpovědi HTTP 304 ze serveru.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-260">If you navigate to a previously viewed page, Fiddler shows IE does not make a conditional request for the bundle, that is, there are no HTTP GET requests from IE for the bundles and no HTTP 304 responses from the server.</span></span> <span data-ttu-id="f4cb3-261">Můžete vynutit, aby aplikace IE nastala podmíněný požadavek pro jednotlivé sady pomocí klávesy F5 (výsledkem je odpověď HTTP 304 pro jednotlivé sady).</span><span class="sxs-lookup"><span data-stu-id="f4cb3-261">You can force IE to make a conditional request for each bundle with the F5 key (resulting in a HTTP 304 response for each bundle).</span></span> <span data-ttu-id="f4cb3-262">Úplnou aktualizaci můžete vynutit pomocí ^ F5 (výsledkem bude odpověď HTTP 200 pro jednotlivé sady.)</span><span class="sxs-lookup"><span data-stu-id="f4cb3-262">You can force a full refresh by using ^F5 (resulting in a HTTP 200 response for each bundle.)</span></span>

<span data-ttu-id="f4cb3-263">Na následujícím obrázku je vidět karta **ukládání do mezipaměti** v podokně odpověď Fiddler:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-263">The following image shows the **Caching** tab of the Fiddler response pane:</span></span>

![Obrázek ukládání do mezipaměti Fiddler](bundling-and-minification/_static/image8.png)

<span data-ttu-id="f4cb3-265">Požadavek</span><span class="sxs-lookup"><span data-stu-id="f4cb3-265">The request</span></span>   
`http://localhost/MvcBM_time/bundles/AllMyScripts?v=r0sLDicvP58AIXN_mc3QdyVvVj5euZNzdsa2N1PKvb81`  
 <span data-ttu-id="f4cb3-266">je pro sadu prostředků **AllMyScripts** a obsahuje dvojici řetězců dotazu **v = R0sLDicvP58AIXN\\\_mc3QdyVvVj5euZNzdsa2N1PKvb81**.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-266">is for the bundle **AllMyScripts** and contains a query string pair **v=r0sLDicvP58AIXN\\\_mc3QdyVvVj5euZNzdsa2N1PKvb81**.</span></span> <span data-ttu-id="f4cb3-267">Řetězec dotazu **v** má token hodnoty, který je jedinečný identifikátor používaný pro ukládání do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-267">The query string **v** has a value token that is a unique identifier used for caching.</span></span> <span data-ttu-id="f4cb3-268">Pokud se svazek nemění, aplikace ASP.NET požádá o sadu prostředků **AllMyScripts** pomocí tohoto tokenu.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-268">As long as the bundle doesn't change, the ASP.NET application will request the **AllMyScripts** bundle using this token.</span></span> <span data-ttu-id="f4cb3-269">Pokud se kterýkoli soubor ve svazku změní, rozhraní optimalizace ASP.NET vygeneruje nový token, který zaručuje, že požadavky prohlížeče na tento svazek získají nejnovější sadu.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-269">If any file in the bundle changes, the ASP.NET optimization framework will generate a new token, guaranteeing that browser requests for the bundle will get the latest bundle.</span></span>

<span data-ttu-id="f4cb3-270">Pokud spustíte vývojářské nástroje IE9 F12 a přejdete na dříve načtenou stránku, IE nesprávně zobrazuje podmíněné požadavky GET na jednotlivé sady a server, který vrací HTTP 304.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-270">If you run the IE9 F12 developer tools and navigate to a previously loaded page, IE incorrectly shows conditional GET requests made to each bundle and the server returning HTTP 304.</span></span> <span data-ttu-id="f4cb3-271">Můžete si přečíst, proč má IE9 problémy s určením, jestli se podmíněný požadavek provedl v položce blogu [pomocí sítě CDN a vyprší za účelem vylepšení výkonu webu](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span><span class="sxs-lookup"><span data-stu-id="f4cb3-271">You can read why IE9 has problems determining if a conditional request was made in the blog entry [Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span>

## <a name="less-coffeescript-scss-sass-bundling"></a><span data-ttu-id="f4cb3-272">LESS, CoffeeScript, SCSS, Sass sdružování.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-272">LESS, CoffeeScript, SCSS, Sass Bundling.</span></span>

<span data-ttu-id="f4cb3-273">Rozhraní sdružování a minifikace poskytuje mechanismus pro zpracování zprostředkujících jazyků, jako je [scss](http://sass-lang.com/), [Sass](http://sass-lang.com/), [menší](http://www.dotlesscss.org/) nebo [Coffeescript](http://coffeescript.org/), a použití transformací, jako je minifikace, do výsledné sady.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-273">The bundling and minification framework provides a mechanism to process intermediate languages such as [SCSS](http://sass-lang.com/), [Sass](http://sass-lang.com/), [LESS](http://www.dotlesscss.org/) or [Coffeescript](http://coffeescript.org/), and apply transforms such as minification to the resulting bundle.</span></span> <span data-ttu-id="f4cb3-274">Například pro přidání souborů [. less](http://www.dotlesscss.org/) do projektu MVC 4:</span><span class="sxs-lookup"><span data-stu-id="f4cb3-274">For example, to add [.less](http://www.dotlesscss.org/) files to your MVC 4 project:</span></span>

1. <span data-ttu-id="f4cb3-275">Vytvořte složku pro méně obsahu.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-275">Create a folder for your LESS content.</span></span> <span data-ttu-id="f4cb3-276">Následující příklad používá složku *Content\\MyLess* .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-276">The following example uses the *Content\\MyLess* folder.</span></span>
2. <span data-ttu-id="f4cb3-277">Přidejte do projektu [necelou](http://www.dotlesscss.org/) plochu **balíčku NuGet** .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-277">Add the [.less](http://www.dotlesscss.org/) NuGet package **dotless** to your project.</span></span>  
    <span data-ttu-id="f4cb3-278">![instalace nech NuGet](bundling-and-minification/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="f4cb3-278">![NuGet dotless install](bundling-and-minification/_static/image9.png)</span></span>
3. <span data-ttu-id="f4cb3-279">Přidejte třídu, která implementuje rozhraní [IBundleTransform](https://msdn.microsoft.com/library/system.web.optimization.ibundletransform(VS.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="f4cb3-279">Add a class that implements the [IBundleTransform](https://msdn.microsoft.com/library/system.web.optimization.ibundletransform(VS.110).aspx) interface.</span></span> <span data-ttu-id="f4cb3-280">Pro transformaci. less přidejte do projektu následující kód.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-280">For the .less transform, add the following code to your project.</span></span>

    [!code-csharp[Main](bundling-and-minification/samples/sample13.cs)]
4. <span data-ttu-id="f4cb3-281">Pomocí `LessTransform` a transformace [CssMinify](https://msdn.microsoft.com/library/system.web.optimization.cssminify(VS.110).aspx) vytvořte sadu méně souborů.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-281">Create a bundle of LESS files with the `LessTransform` and the [CssMinify](https://msdn.microsoft.com/library/system.web.optimization.cssminify(VS.110).aspx) transform.</span></span> <span data-ttu-id="f4cb3-282">Do metody `RegisterBundles` v souboru *App\\_Start\\souboru BundleConfig.cs* přidejte následující kód.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-282">Add the following code to the `RegisterBundles` method in the *App\\_Start\\BundleConfig.cs* file.</span></span>

    [!code-csharp[Main](bundling-and-minification/samples/sample14.cs)]
5. <span data-ttu-id="f4cb3-283">Přidejte následující kód do všech zobrazení, která odkazují na méně sady.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-283">Add the following code to any views which references the LESS bundle.</span></span>

    [!code-cshtml[Main](bundling-and-minification/samples/sample15.cshtml)]

## <a name="bundle-considerations"></a><span data-ttu-id="f4cb3-284">Požadavky sady prostředků</span><span class="sxs-lookup"><span data-stu-id="f4cb3-284">Bundle Considerations</span></span>

<span data-ttu-id="f4cb3-285">Dobrým postupem při vytváření svazků je zahrnutí "sady" jako předpony do názvu sady prostředků.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-285">A good convention to follow when creating bundles is to include "bundle" as a prefix in the bundle name.</span></span> <span data-ttu-id="f4cb3-286">Tím se zabrání možnému [konfliktu směrování](https://forums.asp.net/post/5012037.aspx).</span><span class="sxs-lookup"><span data-stu-id="f4cb3-286">This will prevent a possible [routing conflict](https://forums.asp.net/post/5012037.aspx).</span></span>

<span data-ttu-id="f4cb3-287">Po aktualizaci jednoho souboru v sadě se pro parametr řetězce dotazu sady prostředků vygeneruje nový token a při příštím požadavku na stránku obsahující sadu se musí stáhnout úplná sada prostředků.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-287">Once you update one file in a bundle, a new token is generated for the bundle query string parameter and the full bundle must be downloaded the next time a client requests a page containing the bundle.</span></span> <span data-ttu-id="f4cb3-288">V tradičním označení, kde je každý Asset uveden samostatně, bude stažen pouze změněný soubor.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-288">In traditional markup where each asset is listed individually, only the changed file would be downloaded.</span></span> <span data-ttu-id="f4cb3-289">Prostředky, které se často mění, nemusí být vhodnými kandidáty pro sdružování.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-289">Assets that change frequently may not be good candidates for bundling.</span></span>

<span data-ttu-id="f4cb3-290">Seřízení a minifikace primárně zlepšují dobu načtení první stránky.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-290">Bundling and minification primarily improve the first page request load time.</span></span> <span data-ttu-id="f4cb3-291">Po vyžádání webové stránky prohlížeč ukládá do mezipaměti prostředky (JavaScript, CSS a image), takže sdružování a minifikace nebude poskytovat žádné zvýšení výkonu při požadavku na stejnou stránku nebo stránky na stejném webu, který požaduje stejné prostředky.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-291">Once a webpage has been requested, the browser caches the assets (JavaScript, CSS and images) so bundling and minification won't provide any performance boost when requesting the same page, or pages on the same site requesting the same assets.</span></span> <span data-ttu-id="f4cb3-292">Pokud ve svých prostředcích nenastavíte hlavičku Expires správně a nepoužijete sdružování a minifikace, heuristika aktuálnosti prohlížečů označí prostředky jako zastaralé po několika dnech a prohlížeč bude pro každý Asset vyžadovat požadavek na ověření.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-292">If you don't set the expires header correctly on your assets, and you don't use bundling and minification, the browsers freshness heuristics will mark the assets stale after a few days and the browser will require a validation request for each asset.</span></span> <span data-ttu-id="f4cb3-293">V tomto případě sdružování a minifikace poskytují zvýšení výkonu po žádosti o první stránku.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-293">In this case, bundling and minification provide a performance increase after the first page request.</span></span> <span data-ttu-id="f4cb3-294">Podrobnosti najdete v blogu [použití sítě CDN a vyprší pro zlepšení výkonu](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx)webu.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-294">For details, see the blog [Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span>

<span data-ttu-id="f4cb3-295">Omezení prohlížeče šesti současných připojení na každý název hostitele je možné zmírnit pomocí sítě [CDN](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span><span class="sxs-lookup"><span data-stu-id="f4cb3-295">The browser limitation of six simultaneous connections per each hostname can be mitigated by using a [CDN](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span> <span data-ttu-id="f4cb3-296">Vzhledem k tomu, že CDN bude mít jiný název hostitele než váš hostující web, požadavky na prostředky z CDN se nebudou počítat s omezením šesti současných připojení k vašemu hostitelskému prostředí.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-296">Because the CDN will have a different hostname than your hosting site, asset requests from the CDN will not count against the six simultaneous connections limit to your hosting environment.</span></span> <span data-ttu-id="f4cb3-297">CDN může také poskytovat společné ukládání balíčků do mezipaměti a výhody ukládání do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-297">A CDN can also provide common package caching and edge caching advantages.</span></span>

<span data-ttu-id="f4cb3-298">Balíčky by měly být rozdělené podle stránek, které je potřebují.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-298">Bundles should be partitioned by pages that need them.</span></span> <span data-ttu-id="f4cb3-299">Například výchozí šablona ASP.NET MVC pro internetovou aplikaci vytvoří sadu prostředků jQuery oddělenou od jQuery.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-299">For example, the default ASP.NET MVC template for an internet application creates a jQuery Validation bundle separate from jQuery.</span></span> <span data-ttu-id="f4cb3-300">Vzhledem k tomu, že výchozí zobrazení nejsou k dispozici a neúčtují hodnoty, neobsahují sadu ověření.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-300">Because the default views created have no input and do not post values, they don't include the validation bundle.</span></span>

<span data-ttu-id="f4cb3-301">Obor názvů `System.Web.Optimization` je implementován v *knihovně System. Web. Optimization. dll*.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-301">The `System.Web.Optimization` namespace is implemented in *System.Web.Optimization.dll*.</span></span> <span data-ttu-id="f4cb3-302">Využívá knihovnu webodmašťování (*webodmašťování. dll*) pro funkce minifikace, které zase používá *Antlr3. Runtime. dll*.</span><span class="sxs-lookup"><span data-stu-id="f4cb3-302">It leverages the WebGrease library (*WebGrease.dll*) for minification capabilities, which in turn uses *Antlr3.Runtime.dll*.</span></span>

<span data-ttu-id="f4cb3-303">*Používám Twitter k vytváření rychlých příspěvků a sdílení odkazů. Moje obslužná rutina Twitteru je*: [@RickAndMSFT](http://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="f4cb3-303">*I use Twitter to make quick posts and share links. My Twitter handle is*: [@RickAndMSFT](http://twitter.com/RickAndMSFT)</span></span>

## <a name="additional-resources"></a><span data-ttu-id="f4cb3-304">Další materiály a zdroje informací</span><span class="sxs-lookup"><span data-stu-id="f4cb3-304">Additional resources</span></span>

- <span data-ttu-id="f4cb3-305">Video:[sdružování a optimalizace](https://channel9.msdn.com/Events/aspConf/aspConf/Bundling-and-Optimizing) podle [Howard Dierking](https://twitter.com/#!/howard_dierking)</span><span class="sxs-lookup"><span data-stu-id="f4cb3-305">Video:[Bundling and Optimizing](https://channel9.msdn.com/Events/aspConf/aspConf/Bundling-and-Optimizing) by [Howard Dierking](https://twitter.com/#!/howard_dierking)</span></span>
- <span data-ttu-id="f4cb3-306">[Přidání webové optimalizace do webu webových stránek](https://blogs.msdn.com/b/rickandy/archive/2012/08/15/adding-web-optimization-to-a-web-pages-site.aspx).</span><span class="sxs-lookup"><span data-stu-id="f4cb3-306">[Adding Web Optimization to a Web Pages Site](https://blogs.msdn.com/b/rickandy/archive/2012/08/15/adding-web-optimization-to-a-web-pages-site.aspx).</span></span>
- <span data-ttu-id="f4cb3-307">[Přidání sdružování a minifikace do webových formulářů](https://blogs.msdn.com/b/rickandy/archive/2012/08/14/adding-bundling-and-minification-to-web-forms.aspx).</span><span class="sxs-lookup"><span data-stu-id="f4cb3-307">[Adding Bundling and Minification to Web Forms](https://blogs.msdn.com/b/rickandy/archive/2012/08/14/adding-bundling-and-minification-to-web-forms.aspx).</span></span>
- <span data-ttu-id="f4cb3-308">[Dopad na výkon sdružování a minifikace na procházení webu pomocí aplikace](https://blogs.msdn.com/b/henrikn/archive/2012/06/17/performance-implications-of-bundling-and-minification-on-http.aspx) [petr F Nielsen](http://en.wikipedia.org/wiki/Henrik_Frystyk_Nielsen) [@frystyk](https://twitter.com/frystyk)</span><span class="sxs-lookup"><span data-stu-id="f4cb3-308">[Performance Implications of Bundling and Minification on Web Browsing](https://blogs.msdn.com/b/henrikn/archive/2012/06/17/performance-implications-of-bundling-and-minification-on-http.aspx) by [Henrik F Nielsen](http://en.wikipedia.org/wiki/Henrik_Frystyk_Nielsen) [@frystyk](https://twitter.com/frystyk)</span></span>
- <span data-ttu-id="f4cb3-309">[Použití sítě CDN a vyprší za účelem vylepšení výkonu](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx) webu Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="f4cb3-309">[Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx) by Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span></span>
- [<span data-ttu-id="f4cb3-310">Minimalizovat čas RTT (doba odezvy)</span><span class="sxs-lookup"><span data-stu-id="f4cb3-310">Minimize RTT (round-trip times)</span></span>](https://developers.google.com/speed/docs/best-practices/rtt)

## <a name="contributors"></a><span data-ttu-id="f4cb3-311">Spoluautoři</span><span class="sxs-lookup"><span data-stu-id="f4cb3-311">Contributors</span></span>

- <span data-ttu-id="f4cb3-312">Hao Kung</span><span class="sxs-lookup"><span data-stu-id="f4cb3-312">Hao Kung</span></span>
- [<span data-ttu-id="f4cb3-313">Howard Dierking</span><span class="sxs-lookup"><span data-stu-id="f4cb3-313">Howard Dierking</span></span>](https://twitter.com/#!/howard_dierking)
- <span data-ttu-id="f4cb3-314">Diana LaRose</span><span class="sxs-lookup"><span data-stu-id="f4cb3-314">Diana LaRose</span></span>
