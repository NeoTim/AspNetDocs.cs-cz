---
uid: mvc/overview/performance/using-asynchronous-methods-in-aspnet-mvc-4
title: Použití asynchronních metod v architektuře ASP.NET MVC 4 | Dokumentace Microsoftu
author: Rick-Anderson
description: V tomto kurzu se seznámíte se základy vytváření asynchronní aplikace ASP.NET MVC Web pomocí Visual Studio Express 2012 pro Web, který je zdarma ve...
ms.author: riande
ms.date: 06/06/2012
ms.assetid: a56572ba-81c3-47af-826d-941e9c4775ec
msc.legacyurl: /mvc/overview/performance/using-asynchronous-methods-in-aspnet-mvc-4
msc.type: authoredcontent
ms.openlocfilehash: 8d42ebf770e1b75e2867cca36e71423ba9467ee2
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/06/2019
ms.locfileid: "65112439"
---
# <a name="using-asynchronous-methods-in-aspnet-mvc-4"></a><span data-ttu-id="d830d-103">Použití asynchronních metod v ASP.NET MVC 4</span><span class="sxs-lookup"><span data-stu-id="d830d-103">Using Asynchronous Methods in ASP.NET MVC 4</span></span>

<span data-ttu-id="d830d-104">Podle [Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="d830d-104">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

> <span data-ttu-id="d830d-105">V tomto kurzu se seznámíte se základy vytváření asynchronní aplikace v prostředí ASP.NET MVC pomocí [Visual Studio Express 2012 pro Web](https://www.microsoft.com/visualstudio/11), což je bezplatná verze sady Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d830d-105">This tutorial will teach you the basics of building an asynchronous ASP.NET MVC Web application using [Visual Studio Express 2012 for Web](https://www.microsoft.com/visualstudio/11), which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="d830d-106">Můžete také použít [Visual Studio 2012](https://www.microsoft.com/visualstudio/11).</span><span class="sxs-lookup"><span data-stu-id="d830d-106">You can also use [Visual Studio 2012](https://www.microsoft.com/visualstudio/11).</span></span>
> 
> <span data-ttu-id="d830d-107">Úplnou ukázku je k dispozici pro účely tohoto kurzu na githubu [https://github.com/RickAndMSFT/Async-ASP.NET/](https://github.com/RickAndMSFT/Async-ASP.NET/)</span><span class="sxs-lookup"><span data-stu-id="d830d-107">A complete sample is provided for this tutorial on github [https://github.com/RickAndMSFT/Async-ASP.NET/](https://github.com/RickAndMSFT/Async-ASP.NET/)</span></span>

<span data-ttu-id="d830d-108">ASP.NET MVC 4 [řadič](https://msdn.microsoft.com/library/system.web.mvc.controller(VS.108).aspx) třídy v kombinaci [.NET 4.5](https://msdn.microsoft.com/library/w0x726c2(VS.110).aspx) umožňuje psát asynchronní akce metody, které vracejí objekt typu [úloh&lt;ActionResult&gt; ](https://msdn.microsoft.com/library/dd321424(VS.110).aspx).</span><span class="sxs-lookup"><span data-stu-id="d830d-108">The ASP.NET MVC 4 [Controller](https://msdn.microsoft.com/library/system.web.mvc.controller(VS.108).aspx) class in combination [.NET 4.5](https://msdn.microsoft.com/library/w0x726c2(VS.110).aspx) enables you to write asynchronous action methods that return an object of type [Task&lt;ActionResult&gt;](https://msdn.microsoft.com/library/dd321424(VS.110).aspx).</span></span> <span data-ttu-id="d830d-109">Rozhraní .NET Framework 4 zavedena asynchronní programovací koncept se označuje jako [úloh](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) a podporuje ASP.NET MVC 4 [úloh](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx).</span><span class="sxs-lookup"><span data-stu-id="d830d-109">The .NET Framework 4 introduced an asynchronous programming concept referred to as a [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) and ASP.NET MVC 4 supports [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx).</span></span> <span data-ttu-id="d830d-110">Úkoly jsou reprezentovány **úloh** typu a souvisejících typů v [System.Threading.Tasks](https://msdn.microsoft.com/library/system.threading.tasks.aspx) oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="d830d-110">Tasks are represented by the **Task** type and related types in the [System.Threading.Tasks](https://msdn.microsoft.com/library/system.threading.tasks.aspx) namespace.</span></span> <span data-ttu-id="d830d-111">Rozhraní .NET Framework 4.5 je založena na této asynchronní podporu [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) a [asynchronní](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) klíčová slova, která usnadňuje práci s [úloh](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) objekty mnohem méně složitý než předchozí asynchronní přístupy.</span><span class="sxs-lookup"><span data-stu-id="d830d-111">The .NET Framework 4.5 builds on this asynchronous support with the [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keywords that make working with [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) objects much less complex than previous asynchronous approaches.</span></span> <span data-ttu-id="d830d-112">[Await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) – klíčové slovo je syntaktické sdružená hodnota určující, které jsou části kódu by měla asynchronně čekat na další část kódu.</span><span class="sxs-lookup"><span data-stu-id="d830d-112">The [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) keyword is syntactical shorthand for indicating that a piece of code should asynchronously wait on some other piece of code.</span></span> <span data-ttu-id="d830d-113">[Asynchronní](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) – klíčové slovo představuje pomocného parametru, který můžete použít k označení metod jako úkolově orientovanou asynchronní metody.</span><span class="sxs-lookup"><span data-stu-id="d830d-113">The [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keyword represents a hint that you can use to mark methods as task-based asynchronous methods.</span></span> <span data-ttu-id="d830d-114">Kombinace **await**, **asynchronní**a **úloh** objektu je snazší pro vás bude psaní asynchronního kódu v rozhraní .NET 4.5.</span><span class="sxs-lookup"><span data-stu-id="d830d-114">The combination of **await**, **async**, and the **Task** object makes it much easier for you to write asynchronous code in .NET 4.5.</span></span> <span data-ttu-id="d830d-115">Nový model pro asynchronní metody je volána *Task-based Asynchronous Pattern* (**klepněte**).</span><span class="sxs-lookup"><span data-stu-id="d830d-115">The new model for asynchronous methods is called the *Task-based Asynchronous Pattern* (**TAP**).</span></span> <span data-ttu-id="d830d-116">Tento kurz předpokládá, že máte některé znalost asynchronní programování pomocí [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) a [asynchronní](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) klíčová slova a [úloh](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="d830d-116">This tutorial assumes you have some familiarity with asynchronous programing using [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keywords and the [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) namespace.</span></span>

<span data-ttu-id="d830d-117">Další informace na pomocí [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) a [asynchronní](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) klíčová slova a [úloh](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) obor názvů, naleznete v následujících odkazech.</span><span class="sxs-lookup"><span data-stu-id="d830d-117">For more information on the using [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keywords and the [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) namespace, see the following references.</span></span>

- [<span data-ttu-id="d830d-118">Dokument White Paper: Asynchronii v rozhraní .NET</span><span class="sxs-lookup"><span data-stu-id="d830d-118">Whitepaper: Asynchrony in .NET</span></span>](https://go.microsoft.com/fwlink/?LinkId=204844)
- [<span data-ttu-id="d830d-119">Async/Await – nejčastější dotazy</span><span class="sxs-lookup"><span data-stu-id="d830d-119">Async/Await FAQ</span></span>](https://blogs.msdn.com/b/pfxteam/archive/2012/04/12/10293335.aspx)
- [<span data-ttu-id="d830d-120">Visual Studio Asynchronous Programming</span><span class="sxs-lookup"><span data-stu-id="d830d-120">Visual Studio Asynchronous Programming</span></span>](https://msdn.microsoft.com/vstudio/gg316360)

## <a id="HowRequestsProcessedByTP"></a>  <span data-ttu-id="d830d-121">Zpracování požadavků ve fondu vláken</span><span class="sxs-lookup"><span data-stu-id="d830d-121">How Requests Are Processed by the Thread Pool</span></span>

<span data-ttu-id="d830d-122">Rozhraní .NET Framework na webový server udržuje fondu vláken, které se používají ke zpracování požadavků ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d830d-122">On the web server, the .NET Framework maintains a pool of threads that are used to service ASP.NET requests.</span></span> <span data-ttu-id="d830d-123">Když přijde požadavek, vlákno z fondu odesílá ke zpracování této žádosti.</span><span class="sxs-lookup"><span data-stu-id="d830d-123">When a request arrives, a thread from the pool is dispatched to process that request.</span></span> <span data-ttu-id="d830d-124">Pokud je požadavek zpracován synchronně, vlákna, která zpracuje požadavek je zaneprázdněn při žádost se zpracovává, a že vlákno nemůže jiná žádost.</span><span class="sxs-lookup"><span data-stu-id="d830d-124">If the request is processed synchronously, the thread that processes the request is busy while the request is being processed, and that thread cannot service another request.</span></span>   
  
<span data-ttu-id="d830d-125">To nemusí být problém, protože fond vláken můžete převést na dostatečně velký, aby mnoho zaneprázdněná vlákna.</span><span class="sxs-lookup"><span data-stu-id="d830d-125">This might not be a problem, because the thread pool can be made large enough to accommodate many busy threads.</span></span> <span data-ttu-id="d830d-126">Ale je omezený počet vláken ve fondu vláken (výchozí maximum pro rozhraní .NET 4.5 je 5 000).</span><span class="sxs-lookup"><span data-stu-id="d830d-126">However, the number of threads in the thread pool is limited (the default maximum for .NET 4.5 is 5,000).</span></span> <span data-ttu-id="d830d-127">Ve velkých aplikací s vysokou souběžnosti dlouhodobé požadavky může být k dispozici všechna vlákna zaneprázdněn.</span><span class="sxs-lookup"><span data-stu-id="d830d-127">In large applications with high concurrency of long-running requests, all available threads might be busy.</span></span> <span data-ttu-id="d830d-128">Tento stav se označuje jako vyčerpání vlákna.</span><span class="sxs-lookup"><span data-stu-id="d830d-128">This condition is known as thread starvation.</span></span> <span data-ttu-id="d830d-129">Když je dosaženo této podmínce, webový server zařadí do fronty požadavků.</span><span class="sxs-lookup"><span data-stu-id="d830d-129">When this condition is reached, the web server queues requests.</span></span> <span data-ttu-id="d830d-130">Pokud zaplnění fronty požadavků, webový server odmítá požadavky se stavem HTTP 503 (příliš zaneprázdněný Server).</span><span class="sxs-lookup"><span data-stu-id="d830d-130">If the request queue becomes full, the web server rejects requests with an HTTP 503 status (Server Too Busy).</span></span> <span data-ttu-id="d830d-131">Fondu vláken CLR má omezení na nové vlákno injektáže.</span><span class="sxs-lookup"><span data-stu-id="d830d-131">The CLR thread pool has limitations on new thread injections.</span></span> <span data-ttu-id="d830d-132">Pokud je souběžnost vzorcům (to znamená, vaše webová stránka náhle získáte velký počet požadavků) a všechna vlákna k dispozici žádosti je zaneprázdněná kvůli volání back-end s vysokou latencí, míra vkládání omezené vlákna můžete provádět reagovat velmi špatný.</span><span class="sxs-lookup"><span data-stu-id="d830d-132">If concurrency is bursty (that is, your web site can suddenly get a large number of requests) and all available request threads are busy because of backend calls with high latency, the limited thread injection rate can make your application respond very poorly.</span></span> <span data-ttu-id="d830d-133">Kromě toho má každém novém vláknu přidán do fondu vláken režijní náklady (jako je například 1 MB paměti zásobníku).</span><span class="sxs-lookup"><span data-stu-id="d830d-133">Additionally, each new thread added to the thread pool has overhead (such as 1 MB of stack memory).</span></span> <span data-ttu-id="d830d-134">V případě webové aplikace pomocí synchronní metody volání mezi službami vysokou latencí, kde fondu vláken se zvětšuje výchozí rozhraní .NET 4.5 maximálně 5 000 vlákna by využívat přibližně 5 GB více paměti, než je možné aplikaci na stejné žádosti o službu pomocí asynchronní metody a pouze 50 vláken.</span><span class="sxs-lookup"><span data-stu-id="d830d-134">A web application using synchronous methods to service high latency calls where the thread pool grows to the .NET 4.5 default maximum of 5, 000 threads would consume approximately 5 GB more memory than an application able the service the same requests using asynchronous methods and only 50 threads.</span></span> <span data-ttu-id="d830d-135">Když provádíte asynchronní práce, ne vždy používáte vlákno.</span><span class="sxs-lookup"><span data-stu-id="d830d-135">When you're doing asynchronous work, you're not always using a thread.</span></span> <span data-ttu-id="d830d-136">Například pokud provedete požadavek asynchronní webové služby, ASP.NET nebudete používat žádného vlákna mezi **asynchronní** volání metody a **await**.</span><span class="sxs-lookup"><span data-stu-id="d830d-136">For example, when you make an asynchronous web service request, ASP.NET will not be using any threads between the **async** method call and the **await**.</span></span> <span data-ttu-id="d830d-137">Použití fondu vláken k žádosti o služby s vysokou latencí může vést k velké paměťové nároky a nízké využití hardwaru serveru.</span><span class="sxs-lookup"><span data-stu-id="d830d-137">Using the thread pool to service requests with high latency can lead to a large memory footprint and poor utilization of the server hardware.</span></span>

## <a name="processing-asynchronous-requests"></a><span data-ttu-id="d830d-138">Asynchronní zpracování požadavků</span><span class="sxs-lookup"><span data-stu-id="d830d-138">Processing Asynchronous Requests</span></span>

<span data-ttu-id="d830d-139">Ve webové aplikaci, která se zobrazí velký počet souběžných požadavků na objem požadovaný při spuštění nebo má vzorcům zatížení (kde souběžnosti prudce zvyšuje) provádění asynchronní volání webové služby zvyšuje rychlost odezvy aplikace.</span><span class="sxs-lookup"><span data-stu-id="d830d-139">In a web app that sees a large number of concurrent requests at start-up or has a bursty load (where concurrency increases suddenly), making web service calls asynchronous increases the responsiveness of the app.</span></span> <span data-ttu-id="d830d-140">Asynchronní požadavek trvá stejně jako požadavek na synchronní zpracování.</span><span class="sxs-lookup"><span data-stu-id="d830d-140">An asynchronous request takes the same amount of time to process as a synchronous request.</span></span> <span data-ttu-id="d830d-141">Pokud požadavek webové služby volání, které vyžaduje dva sekund na dokončení, požadavek trvá 2 sekundy, zda je provedena synchronně nebo asynchronně.</span><span class="sxs-lookup"><span data-stu-id="d830d-141">If a request makes a web service call that requires two seconds to complete, the request takes two seconds whether it's performed synchronously or asynchronously.</span></span> <span data-ttu-id="d830d-142">Ale při asynchronním volání není vlákno blokováno reagovat na další požadavky a bude čekat na dokončení první žádosti.</span><span class="sxs-lookup"><span data-stu-id="d830d-142">However during an asynchronous call, a thread isn't blocked from responding to other requests while it waits for the first request to complete.</span></span> <span data-ttu-id="d830d-143">Proto asynchronních žádostí zabránit růstu žádosti o služby Řízení front a vlákna fondu pokud existuje velký počet souběžných požadavků, které vyvolají dlouho běžící operace.</span><span class="sxs-lookup"><span data-stu-id="d830d-143">Therefore, asynchronous requests prevent request queuing and thread pool growth when there are many concurrent requests that invoke long-running operations.</span></span>

## <a id="ChoosingSyncVasync"></a>  <span data-ttu-id="d830d-144">Volba metody synchronní nebo asynchronní akce</span><span class="sxs-lookup"><span data-stu-id="d830d-144">Choosing Synchronous or Asynchronous Action Methods</span></span>

<span data-ttu-id="d830d-145">Tato část uvádí pokyny pro použití metody synchronní nebo asynchronní akce.</span><span class="sxs-lookup"><span data-stu-id="d830d-145">This section lists guidelines for when to use synchronous or asynchronous action methods.</span></span> <span data-ttu-id="d830d-146">Toto jsou jen pokyny; Prozkoumejte každou aplikaci zvlášť pro určení, zda asynchronní metody pomoci s výkonem.</span><span class="sxs-lookup"><span data-stu-id="d830d-146">These are just guidelines; examine each application individually to determine whether asynchronous methods help with performance.</span></span>

<span data-ttu-id="d830d-147">Obecně platí používejte synchronní metody byly splněny následující podmínky:</span><span class="sxs-lookup"><span data-stu-id="d830d-147">In general, use synchronous methods for the following conditions:</span></span>

- <span data-ttu-id="d830d-148">Operace jsou jednoduché nebo krátce běžící.</span><span class="sxs-lookup"><span data-stu-id="d830d-148">The operations are simple or short-running.</span></span>
- <span data-ttu-id="d830d-149">Zjednodušení je mnohem důležitější než efektivitu.</span><span class="sxs-lookup"><span data-stu-id="d830d-149">Simplicity is more important than efficiency.</span></span>
- <span data-ttu-id="d830d-150">Operace jsou primárně procesoru operace místo operace, které zahrnují rozsáhlou disku nebo nároky na síť.</span><span class="sxs-lookup"><span data-stu-id="d830d-150">The operations are primarily CPU operations instead of operations that involve extensive disk or network overhead.</span></span> <span data-ttu-id="d830d-151">Pomocí metod asynchronní akce pro operace vázané na procesor žádné výhody a má za následek další režie.</span><span class="sxs-lookup"><span data-stu-id="d830d-151">Using asynchronous action methods on CPU-bound operations provides no benefits and results in more overhead.</span></span>

  <span data-ttu-id="d830d-152">Obecně platí použijte asynchronní metody byly splněny následující podmínky:</span><span class="sxs-lookup"><span data-stu-id="d830d-152">In general, use asynchronous methods for the following conditions:</span></span>

- <span data-ttu-id="d830d-153">Volání služby, které lze využívat pomocí asynchronní metody a používáte .NET 4.5 nebo vyšší.</span><span class="sxs-lookup"><span data-stu-id="d830d-153">You're calling services that can be consumed through asynchronous methods, and you're using .NET 4.5 or higher.</span></span>
- <span data-ttu-id="d830d-154">Operace jsou vázané na síť nebo vstupně-výstupní místo vázané na procesor.</span><span class="sxs-lookup"><span data-stu-id="d830d-154">The operations are network-bound or I/O-bound instead of CPU-bound.</span></span>
- <span data-ttu-id="d830d-155">Paralelismu je důležitější než zjednodušení kódu.</span><span class="sxs-lookup"><span data-stu-id="d830d-155">Parallelism is more important than simplicity of code.</span></span>
- <span data-ttu-id="d830d-156">Chcete poskytovat mechanismus, který umožňuje uživatelům zrušit dlouho probíhající požadavek.</span><span class="sxs-lookup"><span data-stu-id="d830d-156">You want to provide a mechanism that lets users cancel a long-running request.</span></span>
- <span data-ttu-id="d830d-157">Když výhodu, že přepínání vlákna větší váhu než náklady na přepnutí kontextu.</span><span class="sxs-lookup"><span data-stu-id="d830d-157">When the benefit of switching threads outweighs the cost of the context switch.</span></span> <span data-ttu-id="d830d-158">Obecně platí měli byste zajistit metodu asynchronní Pokud se synchronní metoda čeká na vlákno požadavku ASP.NET v průběhu zpracování operace žádná práce.</span><span class="sxs-lookup"><span data-stu-id="d830d-158">In general, you should make a method asynchronous if the synchronous method waits on the ASP.NET request thread while doing no work.</span></span> <span data-ttu-id="d830d-159">Tím, že volání asynchronní, vlákno požadavku ASP.NET není zastaven, přičemž to nic a bude čekat na dokončení žádosti webové služby.</span><span class="sxs-lookup"><span data-stu-id="d830d-159">By making the call asynchronous, the ASP.NET request thread is not stalled doing no work while it waits for the web service request to complete.</span></span>
- <span data-ttu-id="d830d-160">Testování ukazuje, že jsou blokující operace problémové místo výkonu webu a, že služba IIS můžete další žádosti o služby s použitím těchto blokujících volání asynchronní metody.</span><span class="sxs-lookup"><span data-stu-id="d830d-160">Testing shows that the blocking operations are a bottleneck in site performance and that IIS can service more requests by using asynchronous methods for these blocking calls.</span></span>

  <span data-ttu-id="d830d-161">Ukázky ke stažení ukazuje, jak efektivně používat metody asynchronní akce.</span><span class="sxs-lookup"><span data-stu-id="d830d-161">The downloadable sample shows how to use asynchronous action methods effectively.</span></span> <span data-ttu-id="d830d-162">Poskytnutou ukázkou, je navržená k poskytování jednoduchého ukázka asynchronního programování v architektuře ASP.NET MVC 4 pomocí rozhraní .NET 4.5.</span><span class="sxs-lookup"><span data-stu-id="d830d-162">The sample provided was designed to provide a simple demonstration of asynchronous programming in ASP.NET MVC 4 using .NET 4.5.</span></span> <span data-ttu-id="d830d-163">Ukázka nemá představovat referenční architekturu pro asynchronní programování v architektuře ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="d830d-163">The sample is not intended to be a reference architecture for asynchronous programming in ASP.NET MVC.</span></span> <span data-ttu-id="d830d-164">Ukázkový program volání [rozhraní ASP.NET Web API](../../../web-api/index.md) metody, které pak volat [Task.Delay](https://msdn.microsoft.com/library/hh139096(VS.110).aspx) pro simulaci volání dlouhotrvající webové služby.</span><span class="sxs-lookup"><span data-stu-id="d830d-164">The sample program calls [ASP.NET Web API](../../../web-api/index.md) methods which in turn call [Task.Delay](https://msdn.microsoft.com/library/hh139096(VS.110).aspx) to simulate long-running web service calls.</span></span> <span data-ttu-id="d830d-165">Většinu provozních aplikací nezobrazí takové zřejmé výhody použití metody asynchronní akce.</span><span class="sxs-lookup"><span data-stu-id="d830d-165">Most production applications will not show such obvious benefits to using asynchronous action methods.</span></span>   
  
<span data-ttu-id="d830d-166">Několik aplikace vyžadují všechny metody akce byla asynchronní.</span><span class="sxs-lookup"><span data-stu-id="d830d-166">Few applications require all action methods to be asynchronous.</span></span> <span data-ttu-id="d830d-167">Převod několik akcí synchronní metody na asynchronní metody často, poskytuje nejlepší účinnosti zvýšení množství práce potřebné.</span><span class="sxs-lookup"><span data-stu-id="d830d-167">Often, converting a few synchronous action methods to asynchronous methods provides the best efficiency increase for the amount of work required.</span></span>

## <a id="SampleApp"></a>  <span data-ttu-id="d830d-168">Ukázkové aplikace</span><span class="sxs-lookup"><span data-stu-id="d830d-168">The Sample Application</span></span>

<span data-ttu-id="d830d-169">Můžete stáhnout ukázkovou aplikaci z [ https://github.com/RickAndMSFT/Async-ASP.NET/ ](https://github.com/RickAndMSFT/Async-ASP.NET) na [Githubu](https://github.com/) lokality.</span><span class="sxs-lookup"><span data-stu-id="d830d-169">You can download the sample application from [https://github.com/RickAndMSFT/Async-ASP.NET/](https://github.com/RickAndMSFT/Async-ASP.NET) on the [GitHub](https://github.com/) site.</span></span> <span data-ttu-id="d830d-170">Úložiště se skládá ze tří projektů:</span><span class="sxs-lookup"><span data-stu-id="d830d-170">The repository consists of three projects:</span></span>

- <span data-ttu-id="d830d-171">*Mvc4Async*: Projekt ASP.NET MVC 4, který obsahuje kód použitý v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="d830d-171">*Mvc4Async*: The ASP.NET MVC 4 project that contains the code used in this tutorial.</span></span> <span data-ttu-id="d830d-172">Provede volání webového rozhraní API **WebAPIpgw** služby.</span><span class="sxs-lookup"><span data-stu-id="d830d-172">It makes Web API calls to the **WebAPIpgw** service.</span></span>
- <span data-ttu-id="d830d-173">*WebAPIpgw*: Projekt ASP.NET MVC 4 webového rozhraní API, který implementuje `Products, Gizmos and Widgets` řadiče.</span><span class="sxs-lookup"><span data-stu-id="d830d-173">*WebAPIpgw*: The ASP.NET MVC 4 Web API project that implements the `Products, Gizmos and Widgets` controllers.</span></span> <span data-ttu-id="d830d-174">Poskytuje data pro *WebAppAsync* projektu a *Mvc4Async* projektu.</span><span class="sxs-lookup"><span data-stu-id="d830d-174">It provides the data for the *WebAppAsync* project and the *Mvc4Async* project.</span></span>
- <span data-ttu-id="d830d-175">*WebAppAsync*: Projekt webových formulářů ASP.NET používá v jiném kurzu.</span><span class="sxs-lookup"><span data-stu-id="d830d-175">*WebAppAsync*: The ASP.NET Web Forms project used in another tutorial.</span></span>

## <a id="GizmosSynch"></a>  <span data-ttu-id="d830d-176">Metoda Gizma synchronní akce</span><span class="sxs-lookup"><span data-stu-id="d830d-176">The Gizmos Synchronous Action Method</span></span>

 <span data-ttu-id="d830d-177">Následující kód ukazuje `Gizmos` metody synchronní akce, která se používá k zobrazení seznamu gizma.</span><span class="sxs-lookup"><span data-stu-id="d830d-177">The following code shows the `Gizmos` synchronous action method that is used to display a list of gizmos.</span></span> <span data-ttu-id="d830d-178">(Pro účely tohoto článku gizmo je fiktivní mechanickým zařízení.)</span><span class="sxs-lookup"><span data-stu-id="d830d-178">(For this article, a gizmo is a fictional mechanical device.)</span></span> 

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample1.cs)]

<span data-ttu-id="d830d-179">Následující kód ukazuje `GetGizmos` metody gizmo služby.</span><span class="sxs-lookup"><span data-stu-id="d830d-179">The following code shows the `GetGizmos` method of the gizmo service.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample2.cs)]

<span data-ttu-id="d830d-180">`GizmoService GetGizmos` Metoda předává identifikátor URI služby technologie ASP.NET webové rozhraní API HTTP, který vrátí seznam hodnot gizma data.</span><span class="sxs-lookup"><span data-stu-id="d830d-180">The `GizmoService GetGizmos` method passes a URI to an ASP.NET Web API HTTP service which returns a list of gizmos data.</span></span> <span data-ttu-id="d830d-181">*WebAPIpgw* projekt obsahuje implementaci webového rozhraní API `gizmos, widget` a `product` řadiče.</span><span class="sxs-lookup"><span data-stu-id="d830d-181">The *WebAPIpgw* project contains the implementation of the Web API `gizmos, widget` and `product` controllers.</span></span>  
<span data-ttu-id="d830d-182">Následující obrázek zobrazuje gizma z ukázkového projektu.</span><span class="sxs-lookup"><span data-stu-id="d830d-182">The following image shows the gizmos view from the sample project.</span></span>

![Gizmos](using-asynchronous-methods-in-aspnet-mvc-4/_static/image1.png)

## <a id="CreatingAsynchGizmos"></a>  <span data-ttu-id="d830d-184">Vytváření Gizma asynchronní metody akce</span><span class="sxs-lookup"><span data-stu-id="d830d-184">Creating an Asynchronous Gizmos Action Method</span></span>

<span data-ttu-id="d830d-185">Ukázka používá nový [asynchronní](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) a [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) klíčová slova (k dispozici v rozhraní .NET 4.5 a Visual Studio 2012) nechat kompilátor, zodpovídá za údržbu složitější transformace nezbytné pro asynchronní programování.</span><span class="sxs-lookup"><span data-stu-id="d830d-185">The sample uses the new [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) and [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) keywords (available in .NET 4.5 and Visual Studio 2012) to let the compiler be responsible for maintaining the complicated transformations necessary for asynchronous programming.</span></span> <span data-ttu-id="d830d-186">Kompilátor umožňuje psát kód pomocí konstrukce jazyka C# pro synchronní řízení toku a kompilátor automaticky použije transformace, která je potřeba použít zpětná volání k zabránění blokování vlákna.</span><span class="sxs-lookup"><span data-stu-id="d830d-186">The compiler lets you write code using the C#'s synchronous control flow constructs and the compiler automatically applies the transformations necessary to use callbacks in order to avoid blocking threads.</span></span>

<span data-ttu-id="d830d-187">Následující kód ukazuje `Gizmos` synchronní metoda a `GizmosAsync` asynchronní metody.</span><span class="sxs-lookup"><span data-stu-id="d830d-187">The following code shows the `Gizmos` synchronous method and the `GizmosAsync` asynchronous method.</span></span> <span data-ttu-id="d830d-188">Pokud váš prohlížeč podporuje [HTML 5 `<mark>` element](http://www.w3.org/wiki/HTML/Elements/mark), uvidíte změny v `GizmosAsync` v žlutý zvýraznění.</span><span class="sxs-lookup"><span data-stu-id="d830d-188">If your browser supports the [HTML 5 `<mark>` element](http://www.w3.org/wiki/HTML/Elements/mark), you'll see the changes in `GizmosAsync` in yellow highlight.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample3.cs)]

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample4.cs?highlight=1,3,5)]

 <span data-ttu-id="d830d-189">Následující změny byly použity na Povolit `GizmosAsync` byla asynchronní.</span><span class="sxs-lookup"><span data-stu-id="d830d-189">The following changes were applied to allow the `GizmosAsync` to be asynchronous.</span></span>

- <span data-ttu-id="d830d-190">Metoda je označena třídou [asynchronní](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) – klíčové slovo, které instruuje kompilátor generovat zpětná volání pro část textu a automaticky vytvářet `Task<ActionResult>` , která je vrácena.</span><span class="sxs-lookup"><span data-stu-id="d830d-190">The method is marked with the [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keyword, which tells the compiler to generate callbacks for parts of the body and to automatically create a `Task<ActionResult>` that is returned.</span></span>
- <span data-ttu-id="d830d-191">&quot;Asynchronní&quot; byl připojeným k názvu metody.</span><span class="sxs-lookup"><span data-stu-id="d830d-191">&quot;Async&quot; was appended to the method name.</span></span> <span data-ttu-id="d830d-192">Připojení "Async" se nevyžadují, ale je konvence při psaní asynchronních metod.</span><span class="sxs-lookup"><span data-stu-id="d830d-192">Appending "Async" is not required but is the convention when writing asynchronous methods.</span></span>
- <span data-ttu-id="d830d-193">Návratový typ se změnil z `ActionResult` k `Task<ActionResult>`.</span><span class="sxs-lookup"><span data-stu-id="d830d-193">The return type was changed from `ActionResult` to `Task<ActionResult>`.</span></span> <span data-ttu-id="d830d-194">Návratový typ `Task<ActionResult>` představuje probíhající práci a poskytuje volající metody s popisovačem, prostřednictvím které se má počkat na dokončení asynchronní operace.</span><span class="sxs-lookup"><span data-stu-id="d830d-194">The return type of `Task<ActionResult>` represents ongoing work and provides callers of the method with a handle through which to wait for the asynchronous operation's completion.</span></span> <span data-ttu-id="d830d-195">V tomto případě se volající webové služby.</span><span class="sxs-lookup"><span data-stu-id="d830d-195">In this case, the caller is the web service.</span></span> <span data-ttu-id="d830d-196">`Task<ActionResult>` představuje probíhající práci s jako výsledek `ActionResult.`</span><span class="sxs-lookup"><span data-stu-id="d830d-196">`Task<ActionResult>` represents ongoing work with a result of `ActionResult.`</span></span>
- <span data-ttu-id="d830d-197">[Await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) – klíčové slovo byla použita k volání webové služby.</span><span class="sxs-lookup"><span data-stu-id="d830d-197">The [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) keyword was applied to the web service call.</span></span>
- <span data-ttu-id="d830d-198">Volala se asynchronní webového rozhraní API služby (`GetGizmosAsync`).</span><span class="sxs-lookup"><span data-stu-id="d830d-198">The asynchronous web service API was called (`GetGizmosAsync`).</span></span>

<span data-ttu-id="d830d-199">Uvnitř `GetGizmosAsync` body jiné asynchronní metody, metoda `GetGizmosAsync` je volána.</span><span class="sxs-lookup"><span data-stu-id="d830d-199">Inside of the `GetGizmosAsync` method body another asynchronous method, `GetGizmosAsync` is called.</span></span> <span data-ttu-id="d830d-200">`GetGizmosAsync` okamžitě se vrátí `Task<List<Gizmo>>` , který se nakonec dokončí když jsou data dostupná.</span><span class="sxs-lookup"><span data-stu-id="d830d-200">`GetGizmosAsync` immediately returns a `Task<List<Gizmo>>` that will eventually complete when the data is available.</span></span> <span data-ttu-id="d830d-201">Vzhledem k tomu, že nechcete dělat nic dalšího, dokud nebudete mít gizmo data, kód očekává úkol (pomocí **await** – klíčové slovo).</span><span class="sxs-lookup"><span data-stu-id="d830d-201">Because you don't want to do anything else until you have the gizmo data, the code awaits the task (using the **await** keyword).</span></span> <span data-ttu-id="d830d-202">Můžete použít **await** – klíčové slovo pouze v metodách opatřen poznámkou **asynchronní** – klíčové slovo.</span><span class="sxs-lookup"><span data-stu-id="d830d-202">You can use the **await** keyword only in methods annotated with the **async** keyword.</span></span>

<span data-ttu-id="d830d-203">**Await** – klíčové slovo neblokuje vlákno, dokud je úloha dokončena.</span><span class="sxs-lookup"><span data-stu-id="d830d-203">The **await** keyword does not block the thread until the task is complete.</span></span> <span data-ttu-id="d830d-204">Zaregistruje pro zbývající metody jako zpětné volání na úkolu a okamžitě se vrátí.</span><span class="sxs-lookup"><span data-stu-id="d830d-204">It signs up the rest of the method as a callback on the task, and immediately returns.</span></span> <span data-ttu-id="d830d-205">Když nakonec dokončení očekávaného úkolu, bude vyvolání tohoto zpětného volání a tak pokračuje v provádění metody vpravo tam, kde skončila.</span><span class="sxs-lookup"><span data-stu-id="d830d-205">When the awaited task eventually completes, it will invoke that callback and thus resume the execution of the method right where it left off.</span></span> <span data-ttu-id="d830d-206">Další informace o použití [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) a [asynchronní](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) klíčová slova a [úloh](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) obor názvů, najdete v článku [asynchronní odkazy](https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/async).</span><span class="sxs-lookup"><span data-stu-id="d830d-206">For more information on using the [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keywords and the [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) namespace, see the [async references](https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/async).</span></span>

<span data-ttu-id="d830d-207">Následující kód ukazuje `GetGizmos` a `GetGizmosAsync` metody.</span><span class="sxs-lookup"><span data-stu-id="d830d-207">The following code shows the `GetGizmos` and `GetGizmosAsync` methods.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample5.cs)]

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample6.cs?highlight=1,4-8)]

 <span data-ttu-id="d830d-208">Asynchronní změny jsou podobné těm, které jsou provedeny **GizmosAsync** výše.</span><span class="sxs-lookup"><span data-stu-id="d830d-208">The asynchronous changes are similar to those made to the **GizmosAsync** above.</span></span> 

- <span data-ttu-id="d830d-209">Podpis metody je opatřen poznámkou [asynchronní](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) – klíčové slovo, návratový typ se změnil na `Task<List<Gizmo>>`, a *asynchronní* byl připojeným k názvu metody.</span><span class="sxs-lookup"><span data-stu-id="d830d-209">The method signature was annotated with the [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keyword, the return type was changed to `Task<List<Gizmo>>`, and *Async* was appended to the method name.</span></span>
- <span data-ttu-id="d830d-210">Asynchronní [HttpClient](https://msdn.microsoft.com/library/system.net.http.httpclient(VS.110).aspx) třída se používá namísto [WebClient](https://msdn.microsoft.com/library/system.net.webclient.aspx) třídy.</span><span class="sxs-lookup"><span data-stu-id="d830d-210">The asynchronous [HttpClient](https://msdn.microsoft.com/library/system.net.http.httpclient(VS.110).aspx) class is used instead of the [WebClient](https://msdn.microsoft.com/library/system.net.webclient.aspx) class.</span></span>
- <span data-ttu-id="d830d-211">[Await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) – klíčové slovo aplikováno [HttpClient](https://msdn.microsoft.com/library/system.net.http.httpclient(VS.110).aspx) asynchronní metody.</span><span class="sxs-lookup"><span data-stu-id="d830d-211">The [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) keyword was applied to the [HttpClient](https://msdn.microsoft.com/library/system.net.http.httpclient(VS.110).aspx) asynchronous methods.</span></span>

<span data-ttu-id="d830d-212">Následující obrázek ukazuje asynchronní gizmo zobrazení.</span><span class="sxs-lookup"><span data-stu-id="d830d-212">The following image shows the asynchronous gizmo view.</span></span>

![async](using-asynchronous-methods-in-aspnet-mvc-4/_static/image2.png)

<span data-ttu-id="d830d-214">Prezentace prohlížeče gizma dat je stejný jako zobrazení vytvořené pomocí synchronní volání.</span><span class="sxs-lookup"><span data-stu-id="d830d-214">The browsers presentation of the gizmos data is identical to the view created by the synchronous call.</span></span> <span data-ttu-id="d830d-215">Jediným rozdílem je, že asynchronní verze může být výkonnější pod velkým zatížením.</span><span class="sxs-lookup"><span data-stu-id="d830d-215">The only difference is the asynchronous version may be more performant under heavy loads.</span></span>

## <a id="Parallel"></a>  <span data-ttu-id="d830d-216">Paralelní provádění více operací</span><span class="sxs-lookup"><span data-stu-id="d830d-216">Performing Multiple Operations in Parallel</span></span>

<span data-ttu-id="d830d-217">Asynchronní akce metody mají výraznou výhodu nad synchronních metod při akci musíte provést několik nezávislých operací.</span><span class="sxs-lookup"><span data-stu-id="d830d-217">Asynchronous action methods have a significant advantage over synchronous methods when an action must perform several independent operations.</span></span> <span data-ttu-id="d830d-218">V ukázce k dispozici, synchronní metoda `PWG`(pro produkty, Widgetů a Gizma) zobrazuje výsledky zobrazíte seznam produktů, widgetů a gizma tři volání webové služby.</span><span class="sxs-lookup"><span data-stu-id="d830d-218">In the sample provided, the synchronous method `PWG`(for Products, Widgets and Gizmos) displays the results of three web service calls to get a list of products, widgets, and gizmos.</span></span> <span data-ttu-id="d830d-219">[Rozhraní ASP.NET Web API](../../../web-api/index.md) projekt, který poskytuje tyto služby používá [Task.Delay](https://msdn.microsoft.com/library/hh139096(VS.110).aspx) k simulaci latence pomalého volání.</span><span class="sxs-lookup"><span data-stu-id="d830d-219">The [ASP.NET Web API](../../../web-api/index.md) project that provides these services uses [Task.Delay](https://msdn.microsoft.com/library/hh139096(VS.110).aspx) to simulate latency or slow network calls.</span></span> <span data-ttu-id="d830d-220">Pokud zpoždění nastavená na 500 milisekund, asynchronní `PWGasync` metoda trvá o něco více než 500 milisekund do dokončení při synchronní `PWG` verze převezme 1 500 milisekund.</span><span class="sxs-lookup"><span data-stu-id="d830d-220">When the delay is set to 500 milliseconds, the asynchronous `PWGasync` method takes a little over 500 milliseconds to complete while the synchronous `PWG` version takes over 1,500 milliseconds.</span></span> <span data-ttu-id="d830d-221">Synchronní `PWG` je znázorněna v následujícím kódu.</span><span class="sxs-lookup"><span data-stu-id="d830d-221">The synchronous `PWG` method is shown in the following code.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample7.cs)]

<span data-ttu-id="d830d-222">Asynchronní `PWGasync` je znázorněna v následujícím kódu.</span><span class="sxs-lookup"><span data-stu-id="d830d-222">The asynchronous `PWGasync` method is shown in the following code.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample8.cs?highlight=1,3,12)]

<span data-ttu-id="d830d-223">Následující obrázek ukazuje zobrazení vrácených **PWGasync** metody.</span><span class="sxs-lookup"><span data-stu-id="d830d-223">The following image shows the view returned from the **PWGasync** method.</span></span>

![pwgAsync](using-asynchronous-methods-in-aspnet-mvc-4/_static/image3.png)

## <a id="CancelToken"></a>  <span data-ttu-id="d830d-225">Pomocí tokenu zrušení</span><span class="sxs-lookup"><span data-stu-id="d830d-225">Using a Cancellation Token</span></span>

<span data-ttu-id="d830d-226">Asynchronní akce metody vracející `Task<ActionResult>`jsou možné zrušit, které se přijaly [CancellationToken](https://msdn.microsoft.com/library/system.threading.cancellationtoken(VS.110).aspx) parametr, pokud je k dispozici s [hodnota vlastnosti AsyncTimeout](https://msdn.microsoft.com/library/system.web.mvc.asynctimeoutattribute(VS.108).aspx) atribut.</span><span class="sxs-lookup"><span data-stu-id="d830d-226">Asynchronous action methods returning `Task<ActionResult>`are cancelable, that is they take a [CancellationToken](https://msdn.microsoft.com/library/system.threading.cancellationtoken(VS.110).aspx) parameter when one is provided with the [AsyncTimeout](https://msdn.microsoft.com/library/system.web.mvc.asynctimeoutattribute(VS.108).aspx) attribute.</span></span> <span data-ttu-id="d830d-227">Následující kód ukazuje `GizmosCancelAsync` metoda s časovým limitem 150 milisekund.</span><span class="sxs-lookup"><span data-stu-id="d830d-227">The following code shows the `GizmosCancelAsync` method with a timeout of 150 milliseconds.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample9.cs?highlight=1-3,5,10)]

<span data-ttu-id="d830d-228">Následující kód ukazuje GetGizmosAsync přetížení, která přijímá [CancellationToken](https://msdn.microsoft.com/library/system.threading.cancellationtoken(VS.110).aspx) parametru.</span><span class="sxs-lookup"><span data-stu-id="d830d-228">The following code shows the GetGizmosAsync overload, which takes a [CancellationToken](https://msdn.microsoft.com/library/system.threading.cancellationtoken(VS.110).aspx) parameter.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample10.cs)]

<span data-ttu-id="d830d-229">V ukázkové aplikaci k dispozici, vyberete *ukázku Token zrušení* propojit volání `GizmosCancelAsync` metoda a ukazuje zrušení asynchronní volání.</span><span class="sxs-lookup"><span data-stu-id="d830d-229">In the sample application provided, selecting the *Cancellation Token Demo* link calls the `GizmosCancelAsync` method and demonstrates the cancellation of the asynchronous call.</span></span>

## <a id="ServerConfig"></a>  <span data-ttu-id="d830d-230">Konfigurace serveru pro volání webové služby vysokou souběžnosti/vysoká latence</span><span class="sxs-lookup"><span data-stu-id="d830d-230">Server Configuration for High Concurrency/High Latency Web Service Calls</span></span>

<span data-ttu-id="d830d-231">Jak začít využívat výhod asynchronní webovou aplikaci, můžete potřebovat udělat nějaké změny ve výchozí konfiguraci serveru.</span><span class="sxs-lookup"><span data-stu-id="d830d-231">To realize the benefits of an asynchronous web application, you might need to make some changes to the default server configuration.</span></span> <span data-ttu-id="d830d-232">Zachovat následující v úvahu při konfiguraci a zátěžové testování asynchronní webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="d830d-232">Keep the following in mind when configuring and stress testing your asynchronous web application.</span></span>

- <span data-ttu-id="d830d-233">Windows klient operačních systémů Windows 7, Windows Vista a mít maximálně 10 souběžných požadavků.</span><span class="sxs-lookup"><span data-stu-id="d830d-233">Windows 7, Windows Vista and all Windows client operating systems have a maximum of 10 concurrent requests.</span></span> <span data-ttu-id="d830d-234">Je třeba operační systém Windows Server na jeho výhody asynchronních metod v případě velkého zatížení.</span><span class="sxs-lookup"><span data-stu-id="d830d-234">You'll need a Windows Server operating system to see the benefits of asynchronous methods under high load.</span></span>
- <span data-ttu-id="d830d-235">Registrace rozhraní .NET 4.5 se službou IIS z příkazového řádku se zvýšenými oprávněními:</span><span class="sxs-lookup"><span data-stu-id="d830d-235">Register .NET 4.5 with IIS from an elevated command prompt:</span></span>  
  <span data-ttu-id="d830d-236">%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet\_regiis -i</span><span class="sxs-lookup"><span data-stu-id="d830d-236">%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet\_regiis -i</span></span>  
  <span data-ttu-id="d830d-237">Zobrazit [ASP.NET IIS Registrační nástroj (Aspnet\_regiis.exe)](https://msdn.microsoft.com/library/k6h9cz8h.aspx)</span><span class="sxs-lookup"><span data-stu-id="d830d-237">See    [ASP.NET IIS Registration Tool (Aspnet\_regiis.exe)](https://msdn.microsoft.com/library/k6h9cz8h.aspx)</span></span>
- <span data-ttu-id="d830d-238">Možná budete muset zvýšit [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) limit fronty z výchozí hodnoty 1 000 až 5 000.</span><span class="sxs-lookup"><span data-stu-id="d830d-238">You might need to increase the [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) queue limit from the default value of 1,000 to 5,000.</span></span> <span data-ttu-id="d830d-239">Pokud je nastavení příliš nízké, může se zobrazit [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) zamítnout žádosti se stavem HTTP 503.</span><span class="sxs-lookup"><span data-stu-id="d830d-239">If the setting is too low, you may see [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) reject requests with a HTTP 503 status.</span></span> <span data-ttu-id="d830d-240">Chcete-li změnit HTTP.sys limit fronty:</span><span class="sxs-lookup"><span data-stu-id="d830d-240">To change the HTTP.sys queue limit:</span></span>

    - <span data-ttu-id="d830d-241">Otevřete Správce služby IIS a přejděte do podokna fondy aplikací.</span><span class="sxs-lookup"><span data-stu-id="d830d-241">Open IIS manager and navigate to the Application Pools pane.</span></span>
    - <span data-ttu-id="d830d-242">Klikněte pravým tlačítkem myši na cílový fond aplikací a vyberte **Upřesnit nastavení**.</span><span class="sxs-lookup"><span data-stu-id="d830d-242">Right click on the target application pool and select **Advanced Settings**.</span></span>  
        <span data-ttu-id="d830d-243">![advanced](using-asynchronous-methods-in-aspnet-mvc-4/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d830d-243">![advanced](using-asynchronous-methods-in-aspnet-mvc-4/_static/image4.png)</span></span>
    - <span data-ttu-id="d830d-244">V **Upřesnit nastavení** dialogovém okně Změnit *délka fronty* od 1 do 5 000 000.</span><span class="sxs-lookup"><span data-stu-id="d830d-244">In the **Advanced Settings** dialog box, change *Queue Length* from 1,000 to 5,000.</span></span>  
        <span data-ttu-id="d830d-245">![Délka fronty](using-asynchronous-methods-in-aspnet-mvc-4/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d830d-245">![Queue length](using-asynchronous-methods-in-aspnet-mvc-4/_static/image5.png)</span></span>  
  
  <span data-ttu-id="d830d-246">Poznámka: výše uvedené, Image rozhraní .NET framework je uveden jako verzi 4.0, i když se fond aplikací používá rozhraní .NET 4.5.</span><span class="sxs-lookup"><span data-stu-id="d830d-246">Note in the images above, the .NET framework is listed as v4.0, even though the application pool is using .NET 4.5.</span></span> <span data-ttu-id="d830d-247">Informace o tom této nesrovnalosti, naleznete v následujících tématech:</span><span class="sxs-lookup"><span data-stu-id="d830d-247">To understand this discrepancy, see the following:</span></span>

    - [<span data-ttu-id="d830d-248">Správa verzí rozhraní .NET a cílení na více platforem - .NET 4.5 je místní upgrade na rozhraní .NET 4.0</span><span class="sxs-lookup"><span data-stu-id="d830d-248">.NET Versioning and Multi-Targeting - .NET 4.5 is an in-place upgrade to .NET 4.0</span></span>](http://www.hanselman.com/blog/NETVersioningAndMultiTargetingNET45IsAnInplaceUpgradeToNET40.aspx)
    - [<span data-ttu-id="d830d-249">Nastavení aplikace služby IIS nebo fondu aplikací, používat technologii ASP.NET 3.5 spíše než 2.0</span><span class="sxs-lookup"><span data-stu-id="d830d-249">How to set an IIS Application or AppPool to use ASP.NET 3.5 rather than 2.0</span></span>](http://www.hanselman.com/blog/HowToSetAnIISApplicationOrAppPoolToUseASPNET35RatherThan20.aspx)
    - <span data-ttu-id="d830d-250">[Verze rozhraní .NET framework a závislosti](https://msdn.microsoft.com/library/bb822049(VS.110).aspx)</span><span class="sxs-lookup"><span data-stu-id="d830d-250">[.NET Framework Versions and Dependencies](https://msdn.microsoft.com/library/bb822049(VS.110).aspx)</span></span>
- <span data-ttu-id="d830d-251">Pokud vaše aplikace používá webové služby nebo System.NET ke komunikaci s back-end pomocí protokolu HTTP budete možná muset zvýšit [connectionManagement/maxconnection](https://msdn.microsoft.com/library/fb6y0fyc(VS.110).aspx) elementu.</span><span class="sxs-lookup"><span data-stu-id="d830d-251">If your application is using web services or System.NET to communicate with a backend over HTTP you may need to increase the [connectionManagement/maxconnection](https://msdn.microsoft.com/library/fb6y0fyc(VS.110).aspx) element.</span></span> <span data-ttu-id="d830d-252">Pro aplikace ASP.NET je omezen pomocí funkce automatické konfigurace 12krát větší počet procesorů.</span><span class="sxs-lookup"><span data-stu-id="d830d-252">For ASP.NET applications, this is limited by the autoConfig feature to 12 times the number of CPUs.</span></span> <span data-ttu-id="d830d-253">To znamená, že na quad-proc, můžete mít nejvýše 12 \* 4 = 48 souběžných připojení na koncový bod IP.</span><span class="sxs-lookup"><span data-stu-id="d830d-253">That means that on a quad-proc, you can have at most 12 \* 4 = 48 concurrent connections to an IP end point.</span></span> <span data-ttu-id="d830d-254">Protože to je vázán na [autoConfig](https://msdn.microsoft.com/library/7w2sway1(VS.110).aspx), nejjednodušší způsob, jak zvýšit `maxconnection` v ASP.NET, aplikace je nastavit [System.Net.ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit(VS.110).aspx) programově v z `Application_Start` metodu *global.asax* souboru.</span><span class="sxs-lookup"><span data-stu-id="d830d-254">Because this is tied to [autoConfig](https://msdn.microsoft.com/library/7w2sway1(VS.110).aspx), the easiest way to increase `maxconnection` in an ASP.NET application is to set [System.Net.ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit(VS.110).aspx) programmatically in the from `Application_Start` method in the *global.asax* file.</span></span> <span data-ttu-id="d830d-255">Najdete v ukázce stahovat pro příklad.</span><span class="sxs-lookup"><span data-stu-id="d830d-255">See the sample download for an example.</span></span>
- <span data-ttu-id="d830d-256">V rozhraní .NET 4.5, výchozí 5000 pro [maxconcurrentrequestspercpu technologie](https://blogs.msdn.com/tmarq/archive/2007/07/21/asp-net-thread-usage-on-iis-7-0-and-6-0.aspx) by měla být v pořádku.</span><span class="sxs-lookup"><span data-stu-id="d830d-256">In .NET 4.5, the default of 5000 for [MaxConcurrentRequestsPerCPU](https://blogs.msdn.com/tmarq/archive/2007/07/21/asp-net-thread-usage-on-iis-7-0-and-6-0.aspx) should be fine.</span></span>
