---
uid: mvc/overview/security/preventing-open-redirection-attacks
title: Prevence útoků na otevřeném přesměrování (C#) | Dokumentace Microsoftu
author: jongalloway
description: Tento kurz vysvětluje, jak lze zabránit útokům otevřené přesměrování ve svých aplikacích ASP.NET MVC. Tento kurz popisuje změny, které mají za cíl...
ms.author: riande
ms.date: 02/27/2014
ms.assetid: 69fb02e0-f5b7-4c35-878c-fa87164fc785
msc.legacyurl: /mvc/overview/security/preventing-open-redirection-attacks
msc.type: authoredcontent
ms.openlocfilehash: 767f9c85527fbcdf34e700eb32fe0c6cad30bf0c
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/01/2019
ms.locfileid: "57066832"
---
<a name="preventing-open-redirection-attacks-c"></a><span data-ttu-id="c0625-104">Prevence útoků založených na otevřeném přesměrování (C#)</span><span class="sxs-lookup"><span data-stu-id="c0625-104">Preventing Open Redirection Attacks (C#)</span></span>
====================
<span data-ttu-id="c0625-105">podle [Jon Galloway](https://github.com/jongalloway)</span><span class="sxs-lookup"><span data-stu-id="c0625-105">by [Jon Galloway](https://github.com/jongalloway)</span></span>

> <span data-ttu-id="c0625-106">Tento kurz vysvětluje, jak lze zabránit útokům otevřené přesměrování ve svých aplikacích ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="c0625-106">This tutorial explains how you can prevent open redirection attacks in your ASP.NET MVC applications.</span></span> <span data-ttu-id="c0625-107">Tento kurz popisuje změny, které byly provedeny v AccountController v architektuře ASP.NET MVC 3 a ukazuje, jak je možné použít tyto změny v existujících ASP.NET MVC 1.0 a 2 aplikacemi.</span><span class="sxs-lookup"><span data-stu-id="c0625-107">This tutorial discusses the changes that have been made in the AccountController in ASP.NET MVC 3 and demonstrates how you can apply these changes in your existing ASP.NET MVC 1.0 and 2 applications.</span></span>


## <a name="what-is-an-open-redirection-attack"></a><span data-ttu-id="c0625-108">Co je útok otevřené přesměrování?</span><span class="sxs-lookup"><span data-stu-id="c0625-108">What is an Open Redirection Attack?</span></span>

<span data-ttu-id="c0625-109">Libovolné webové aplikace, který přesměruje na adresu URL, která je zadáno pomocí požadavku, například data řetězce dotazu nebo formuláře může být potenciálně úmyslně přesměrovat uživatele na škodlivé, externí adresu URL.</span><span class="sxs-lookup"><span data-stu-id="c0625-109">Any web application that redirects to a URL that is specified via the request such as the querystring or form data can potentially be tampered with to redirect users to an external, malicious URL.</span></span> <span data-ttu-id="c0625-110">Toto úmyslné poškozování, se nazývá otevřené přesměrování útoku.</span><span class="sxs-lookup"><span data-stu-id="c0625-110">This tampering is called an open redirection attack.</span></span>

<span data-ttu-id="c0625-111">Pokaždé, když se vaše aplikace logiky se přesměruje na zadané adresy URL, je nutné ověřit, že adresa URL pro přesměrování bylo neoprávněně manipulováno.</span><span class="sxs-lookup"><span data-stu-id="c0625-111">Whenever your application logic redirects to a specified URL, you must verify that the redirection URL hasn't been tampered with.</span></span> <span data-ttu-id="c0625-112">Přihlašovací údaje používané pro ASP.NET MVC 1.0 a ASP.NET MVC 2 ve výchozím nastavení AccountController je ohrožen útoky přesměrování otevřete.</span><span class="sxs-lookup"><span data-stu-id="c0625-112">The login used in the default AccountController for both ASP.NET MVC 1.0 and ASP.NET MVC 2 is vulnerable to open redirection attacks.</span></span> <span data-ttu-id="c0625-113">Je naštěstí snadné k aktualizaci existující aplikace pomocí opravy z technologie ASP.NET MVC 3 ve verzi Preview.</span><span class="sxs-lookup"><span data-stu-id="c0625-113">Fortunately, it is easy to update your existing applications to use the corrections from the ASP.NET MVC 3 Preview.</span></span>

<span data-ttu-id="c0625-114">Informace o tom ohrožení zabezpečení, Podívejme se na fungování přesměrování přihlášení v projektu webové aplikace ASP.NET MVC 2 výchozí.</span><span class="sxs-lookup"><span data-stu-id="c0625-114">To understand the vulnerability, let's look at how the login redirection works in a default ASP.NET MVC 2 Web Application project.</span></span> <span data-ttu-id="c0625-115">V této aplikaci pokus o navštivte akce kontroleru, který má atribut [Authorize] přesměruje neoprávněným uživatelům /Account/LogOn zobrazení.</span><span class="sxs-lookup"><span data-stu-id="c0625-115">In this application, attempting to visit a controller action that has the [Authorize] attribute will redirect unauthorized users to the /Account/LogOn view.</span></span> <span data-ttu-id="c0625-116">Toto přesměrování, které /Account/LogOn bude obsahovat řetězec dotazu parametr returnUrl tak, aby uživatel může být vrácen na původně požadovanou URL adresu po jejich úspěšném přihlášení.</span><span class="sxs-lookup"><span data-stu-id="c0625-116">This redirect to /Account/LogOn will include a returnUrl querystring parameter so that the user can be returned to the originally requested URL after they have successfully logged in.</span></span>

<span data-ttu-id="c0625-117">Na snímku obrazovky níže můžeme vidět, že pokus o přístup k zobrazení /Account/ChangePassword, když není přihlášený výsledkem přesměrování /Account/LogOn? ReturnUrl = % 2fAccount % 2fChangePassword % 2f.</span><span class="sxs-lookup"><span data-stu-id="c0625-117">In the screenshot below, we can see that an attempt to access the /Account/ChangePassword view when not logged in results in a redirect to /Account/LogOn?ReturnUrl=%2fAccount%2fChangePassword%2f.</span></span>

[![](preventing-open-redirection-attacks/_static/image2.png)](preventing-open-redirection-attacks/_static/image1.png)

<span data-ttu-id="c0625-118">**Obrázek 01**: Přihlašovací stránka s otevřené přesměrování</span><span class="sxs-lookup"><span data-stu-id="c0625-118">**Figure 01**: Login page with an open redirection</span></span>

<span data-ttu-id="c0625-119">Protože parametr querystring ReturnUrl neověří, útočník ho upravit, abyste vložit libovolnou adresu URL do parametru provádět útok otevřené přesměrování.</span><span class="sxs-lookup"><span data-stu-id="c0625-119">Since the ReturnUrl querystring parameter is not validated, an attacker can modify it to inject any URL address into the parameter to conduct an open redirection attack.</span></span> <span data-ttu-id="c0625-120">Chcete-li to ukazuje, můžeme upravit parametr ReturnUrl [ http://bing.com ](http://bing.com), takže bude Výsledná adresa URL pro přihlášení/účet/přihlášení? ReturnUrl =<http://www.bing.com/>.</span><span class="sxs-lookup"><span data-stu-id="c0625-120">To demonstrate this, we can modify the ReturnUrl parameter to [http://bing.com](http://bing.com), so the resulting login URL will be /Account/LogOn?ReturnUrl=<http://www.bing.com/>.</span></span> <span data-ttu-id="c0625-121">Po úspěšném přihlášení k webu jsme se přesměrují na [ http://bing.com ](http://bing.com).</span><span class="sxs-lookup"><span data-stu-id="c0625-121">Upon successfully logging in to the site, we are redirected to [http://bing.com](http://bing.com).</span></span> <span data-ttu-id="c0625-122">Protože toto přesměrování neověří, může místo toho přejděte na škodlivým webům, která se pokusí přimět uživatele.</span><span class="sxs-lookup"><span data-stu-id="c0625-122">Since this redirection is not validated, it could instead point to a malicious site that attempts to trick the user.</span></span>

### <a name="a-more-complex-open-redirection-attack"></a><span data-ttu-id="c0625-123">Složitější otevřené přesměrování útoku</span><span class="sxs-lookup"><span data-stu-id="c0625-123">A more complex Open Redirection Attack</span></span>

<span data-ttu-id="c0625-124">Protože útočník ví, že jsme se snažíte přihlásit konkrétní web, který nám zranitelný jsou zvlášť nebezpečné útoky otevřené přesměrování [útoku](https://www.microsoft.com/protect/fraud/phishing/symptoms.aspx).</span><span class="sxs-lookup"><span data-stu-id="c0625-124">Open redirection attacks are especially dangerous because an attacker knows that we're trying to log into a specific website, which makes us vulnerable to a [phishing attack](https://www.microsoft.com/protect/fraud/phishing/symptoms.aspx).</span></span> <span data-ttu-id="c0625-125">Například útočník může odeslat škodlivý e-mailů uživatelům webu za účelem zachycení jejich hesla.</span><span class="sxs-lookup"><span data-stu-id="c0625-125">For example, an attacker could send malicious emails to website users in an attempt to capture their passwords.</span></span> <span data-ttu-id="c0625-126">Podívejme se na tom, jak by to fungovalo v lokalitě NerdDinner.</span><span class="sxs-lookup"><span data-stu-id="c0625-126">Let's look at how this would work on the NerdDinner site.</span></span> <span data-ttu-id="c0625-127">(Mějte na paměti, živého webu NerdDinner je aktualizovaná pro ochranu před útoky otevřené přesměrování.)</span><span class="sxs-lookup"><span data-stu-id="c0625-127">(Note that the live NerdDinner site has been updated to protect against open redirection attacks.)</span></span>

<span data-ttu-id="c0625-128">Nejprve útočník odešle nám odkaz na stránku pro přihlášení na NerdDinner, která zahrnuje přesměrování na stránku falešných:</span><span class="sxs-lookup"><span data-stu-id="c0625-128">First, an attacker sends us a link to the login page on NerdDinner that includes a redirect to their forged page:</span></span>

[http://nerddinner.com/Account/LogOn?returnUrl=http://nerddiner.com/Account/LogOn](http://nerddinner.com/Account/LogOn?returnUrl=http://nerddiner.com/Account/LogOn)

<span data-ttu-id="c0625-129">Všimněte si, že návratová adresa URL odkazuje na nerddiner.com, které chybí "n" z dinner aplikace word.</span><span class="sxs-lookup"><span data-stu-id="c0625-129">Note that the return URL points to nerddiner.com, which is missing an "n" from the word dinner.</span></span> <span data-ttu-id="c0625-130">V tomto příkladu to je doména, která určuje, že útočník.</span><span class="sxs-lookup"><span data-stu-id="c0625-130">In this example, this is a domain that the attacker controls.</span></span> <span data-ttu-id="c0625-131">Když jsme na výše uvedeném odkazu, jsme přejdete na oprávněné aplikace NerdDinner.com přihlašovací stránku.</span><span class="sxs-lookup"><span data-stu-id="c0625-131">When we access the above link, we're taken to the legitimate NerdDinner.com login page.</span></span>

[![](preventing-open-redirection-attacks/_static/image4.png)](preventing-open-redirection-attacks/_static/image3.png)

<span data-ttu-id="c0625-132">**Obrázek 02**: NerdDinner přihlašovací stránku s otevřené přesměrování</span><span class="sxs-lookup"><span data-stu-id="c0625-132">**Figure 02**: NerdDinner login page with an open redirection</span></span>

<span data-ttu-id="c0625-133">Jsme správně přihlásit, přihlášení akce ASP.NET MVC AccountController nám přesměruje na adresu URL zadanou v parametru querystring returnUrl.</span><span class="sxs-lookup"><span data-stu-id="c0625-133">When we correctly log in, the ASP.NET MVC AccountController's LogOn action redirects us to the URL specified in the returnUrl querystring parameter.</span></span> <span data-ttu-id="c0625-134">V takovém případě je adresu URL, který útočník přešel, což je [ http://nerddiner.com/Account/LogOn ](http://nerddiner.com/Account/LogOn).</span><span class="sxs-lookup"><span data-stu-id="c0625-134">In this case, it's the URL that the attacker has entered, which is [http://nerddiner.com/Account/LogOn](http://nerddiner.com/Account/LogOn).</span></span> <span data-ttu-id="c0625-135">Pokud jsme velmi watchful, že je velmi pravděpodobné že nebude, zjistíme zvlášť, protože byl pozor, abyste měli jistotu, že útočník jejich falešných stránka vypadá stejně jako legitimní přihlašovací stránky.</span><span class="sxs-lookup"><span data-stu-id="c0625-135">Unless we're extremely watchful, it's very likely we won't notice this, especially because the attacker has been careful to make sure that their forged page looks exactly like the legitimate login page.</span></span> <span data-ttu-id="c0625-136">Tato přihlašovací stránku obsahuje, chybová zpráva požaduje, můžeme přihlásit znovu.</span><span class="sxs-lookup"><span data-stu-id="c0625-136">This login page includes an error message requesting that we login again.</span></span> <span data-ttu-id="c0625-137">Clumsy nám, jsme musí zadali heslo.</span><span class="sxs-lookup"><span data-stu-id="c0625-137">Clumsy us, we must have mistyped our password.</span></span>

[![](preventing-open-redirection-attacks/_static/image6.png)](preventing-open-redirection-attacks/_static/image5.png)

<span data-ttu-id="c0625-138">**Obrázek 03**: Falešných NerdDinner přihlašovací obrazovky</span><span class="sxs-lookup"><span data-stu-id="c0625-138">**Figure 03**: Forged NerdDinner Login screen</span></span>

<span data-ttu-id="c0625-139">Když znovu jsme naše uživatelské jméno a heslo, falešných přihlašovací stránku uloží informace a nám odešle zpět na oprávněné aplikace NerdDinner.com lokality.</span><span class="sxs-lookup"><span data-stu-id="c0625-139">When we retype our user name and password, the forged login page saves the information and sends us back to the legitimate NerdDinner.com site.</span></span> <span data-ttu-id="c0625-140">V tomto okamžiku lokality aplikace NerdDinner.com již ověřen nám, takže falešných přihlašovací stránku lze přesměrovat přímo na tuto stránku.</span><span class="sxs-lookup"><span data-stu-id="c0625-140">At this point, the NerdDinner.com site has already authenticated us, so the forged login page can redirect directly to that page.</span></span> <span data-ttu-id="c0625-141">Konečným výsledkem je, že útočník má naše uživatelské jméno a heslo a jsme neberou v úvahu, že jsme jste poskytli k nim.</span><span class="sxs-lookup"><span data-stu-id="c0625-141">The end result is that the attacker has our user name and password, and we are unaware that we've provided it to them.</span></span>

## <a name="looking-at-the-vulnerable-code-in-the-accountcontroller-logon-action"></a><span data-ttu-id="c0625-142">Prohlížení zranitelné kód v přihlášení akce AccountController</span><span class="sxs-lookup"><span data-stu-id="c0625-142">Looking at the vulnerable code in the AccountController LogOn Action</span></span>

<span data-ttu-id="c0625-143">Kód pro proces přihlášení v aplikaci ASP.NET MVC 2 je uveden níže.</span><span class="sxs-lookup"><span data-stu-id="c0625-143">The code for the LogOn action in an ASP.NET MVC 2 application is shown below.</span></span> <span data-ttu-id="c0625-144">Všimněte si, že po úspěšném přihlášení kontroleru vrátí přesměrování adresa returnUrl.</span><span class="sxs-lookup"><span data-stu-id="c0625-144">Note that upon a successful login, the controller returns a redirect to the returnUrl.</span></span> <span data-ttu-id="c0625-145">Uvidíte, že žádné ověření se provádí proti parametr returnUrl.</span><span class="sxs-lookup"><span data-stu-id="c0625-145">You can see that no validation is being performed against the returnUrl parameter.</span></span>

<span data-ttu-id="c0625-146">**Výpis 1 – ASP.NET MVC 2 přihlášení v akci `AccountController.cs`**</span><span class="sxs-lookup"><span data-stu-id="c0625-146">**Listing 1 – ASP.NET MVC 2 LogOn action in `AccountController.cs`**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample1.cs)]

<span data-ttu-id="c0625-147">Nyní Pojďme se podívat na změny na ASP.NET MVC 3 přihlášení akci.</span><span class="sxs-lookup"><span data-stu-id="c0625-147">Now let's look at the changes to the ASP.NET MVC 3 LogOn action.</span></span> <span data-ttu-id="c0625-148">Tento kód byl změněn na parametr returnUrl ověřit pomocí volání nové metody System.Web.Mvc.Url pomocná třída s názvem `IsLocalUrl()`.</span><span class="sxs-lookup"><span data-stu-id="c0625-148">This code has been changed to validate the returnUrl parameter by calling a new method in the System.Web.Mvc.Url helper class named `IsLocalUrl()`.</span></span>

<span data-ttu-id="c0625-149">**Výpis 2 – ASP.NET MVC 3 přihlášení v akci `AccountController.cs`**</span><span class="sxs-lookup"><span data-stu-id="c0625-149">**Listing 2 – ASP.NET MVC 3 LogOn action in `AccountController.cs`**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample2.cs)]

<span data-ttu-id="c0625-150">To byl změněn na ověřte parametr návratové adresy URL tak, že volání nové metody ve třídě pomocné rutiny System.Web.Mvc.Url `IsLocalUrl()`.</span><span class="sxs-lookup"><span data-stu-id="c0625-150">This has been changed to validate the return URL parameter by calling a new method in the System.Web.Mvc.Url helper class, `IsLocalUrl()`.</span></span>

## <a name="protecting-your-aspnet-mvc-10-and-mvc-2-applications"></a><span data-ttu-id="c0625-151">Ochrana ASP.NET MVC 1,0 a MVC 2 aplikace</span><span class="sxs-lookup"><span data-stu-id="c0625-151">Protecting Your ASP.NET MVC 1.0 and MVC 2 Applications</span></span>

<span data-ttu-id="c0625-152">Přidáním Pomocná metoda IsLocalUrl() a aktualizuje se přihlášení akce, která má parametr returnUrl ověřit jsme mohou využít výhod změny architektuře ASP.NET MVC 3 naší stávající ASP.NET MVC 1.0 a 2 aplikacemi.</span><span class="sxs-lookup"><span data-stu-id="c0625-152">We can take advantage of the ASP.NET MVC 3 changes in our existing ASP.NET MVC 1.0 and 2 applications by adding the IsLocalUrl() helper method and updating the LogOn action to validate the returnUrl parameter.</span></span>

<span data-ttu-id="c0625-153">Metoda UrlHelper IsLocalUrl() ve skutečnosti pouze volání do metody v System.Web.WebPages jako toto ověření slouží také v aplikacích ASP.NET Web Pages.</span><span class="sxs-lookup"><span data-stu-id="c0625-153">The UrlHelper IsLocalUrl() method actually just calling into a method in System.Web.WebPages, as this validation is also used by ASP.NET Web Pages applications.</span></span>

<span data-ttu-id="c0625-154">**Výpis 3 – metoda IsLocalUrl() z ASP.NET MVC 3 UrlHelper `class`**</span><span class="sxs-lookup"><span data-stu-id="c0625-154">**Listing 3 – The IsLocalUrl() method from the ASP.NET MVC 3 UrlHelper `class`**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample3.cs)]

<span data-ttu-id="c0625-155">Metoda IsUrlLocalToHost obsahuje logiku skutečné ověřování, jak je uvedeno v informacích 4.</span><span class="sxs-lookup"><span data-stu-id="c0625-155">The IsUrlLocalToHost method contains the actual validation logic, as shown in Listing 4.</span></span>

<span data-ttu-id="c0625-156">**Část 4 – metoda IsUrlLocalToHost() ze třídy System.Web.WebPages RequestExtensions**</span><span class="sxs-lookup"><span data-stu-id="c0625-156">**Listing 4 – IsUrlLocalToHost() method from the System.Web.WebPages RequestExtensions class**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample4.cs)]

<span data-ttu-id="c0625-157">V naše technologie ASP.NET MVC 1,0 nebo 2 aplikace přidáme IsLocalUrl() metodu AccountController, ale můžete dohlédněte na to, pokud je to možné ho přidat do samostatné pomocné třídě.</span><span class="sxs-lookup"><span data-stu-id="c0625-157">In our ASP.NET MVC 1.0 or 2 application, we'll add a IsLocalUrl() method to the AccountController, but you're encouraged to add it to a separate helper class if possible.</span></span> <span data-ttu-id="c0625-158">Verze technologie ASP.NET MVC 3 IsLocalUrl() učiníme dvě malých změn, tak, že bude fungovat uvnitř AccountController.</span><span class="sxs-lookup"><span data-stu-id="c0625-158">We will make two small changes to the ASP.NET MVC 3 version of IsLocalUrl() so that it will work inside the AccountController.</span></span> <span data-ttu-id="c0625-159">Nejprve Změníme ji z veřejné metody privátní metodu, protože veřejné metody v zařízení můžou mít přístup akce kontroleru.</span><span class="sxs-lookup"><span data-stu-id="c0625-159">First, we'll change it from a public method to a private method, since public methods in controllers can be accessed as controller actions.</span></span> <span data-ttu-id="c0625-160">Za druhé upravíme volání, která kontroluje hostitel adresy URL vůči hostitele aplikací.</span><span class="sxs-lookup"><span data-stu-id="c0625-160">Second, we'll modify the call that checks the URL host against the application host.</span></span> <span data-ttu-id="c0625-161">Že volání využívá místní kontext požadavku v třída UrlHelper.</span><span class="sxs-lookup"><span data-stu-id="c0625-161">That call makes use of a local RequestContext field in the UrlHelper class.</span></span> <span data-ttu-id="c0625-162">Namísto použití této funkce. RequestContext.HttpContext.Request.Url.Host, budeme používat toto. Request.Url.Host.</span><span class="sxs-lookup"><span data-stu-id="c0625-162">Instead of using this.RequestContext.HttpContext.Request.Url.Host, we will use this.Request.Url.Host.</span></span> <span data-ttu-id="c0625-163">Následující kód ukazuje upravená metoda IsLocalUrl() pro použití s třídou kontroler ASP.NET MVC 1,0 a 2 aplikacemi.</span><span class="sxs-lookup"><span data-stu-id="c0625-163">The following code shows the modified IsLocalUrl() method for use with a controller class in ASP.NET MVC 1.0 and 2 applications.</span></span>

<span data-ttu-id="c0625-164">**Výpis 5 – IsLocalUrl() metoda, která je upravit pro použití s třídu Kontroleru MVC**</span><span class="sxs-lookup"><span data-stu-id="c0625-164">**Listing 5 – IsLocalUrl() method, which is modified for use with an MVC Controller class**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample5.cs)]

<span data-ttu-id="c0625-165">Teď, když metoda IsLocalUrl() je na místě, můžeme ji volat z našich akce přihlášení k ověření parametr returnUrl jak je znázorněno v následujícím kódu.</span><span class="sxs-lookup"><span data-stu-id="c0625-165">Now that the IsLocalUrl() method is in place, we can call it from our LogOn action to validate the returnUrl parameter, as shown in the following code.</span></span>

<span data-ttu-id="c0625-166">**Výpis 6 – aktualizované přihlašovací metodu, která ověřuje parametr returnUrl**</span><span class="sxs-lookup"><span data-stu-id="c0625-166">**Listing 6 – Updated LogOn method which validates the returnUrl parameter**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample6.cs)]

<span data-ttu-id="c0625-167">Teď můžeme otestovat útok otevřené přesměrování pokusem o přihlášení pomocí externí návratová adresa URL.</span><span class="sxs-lookup"><span data-stu-id="c0625-167">Now we can test an open redirection attack by attempting to log in using an external return URL.</span></span> <span data-ttu-id="c0625-168">Použijeme /Account/LogOn? ReturnUrl =<http://www.bing.com/> znovu.</span><span class="sxs-lookup"><span data-stu-id="c0625-168">Let's use /Account/LogOn?ReturnUrl=<http://www.bing.com/> again.</span></span>

[![](preventing-open-redirection-attacks/_static/image8.png)](preventing-open-redirection-attacks/_static/image7.png)

<span data-ttu-id="c0625-169">**Obrázek 04**: Testování aktualizované akce přihlášení</span><span class="sxs-lookup"><span data-stu-id="c0625-169">**Figure 04**: Testing the updated LogOn Action</span></span>

<span data-ttu-id="c0625-170">Po úspěšném přihlášení, jsme se přesměrují na akce Kontroleru Home/Index spíše než externí adresu URL.</span><span class="sxs-lookup"><span data-stu-id="c0625-170">After successfully logging in, we are redirected to the Home/Index Controller action rather than the external URL.</span></span>

[![](preventing-open-redirection-attacks/_static/image10.png)](preventing-open-redirection-attacks/_static/image9.png)

<span data-ttu-id="c0625-171">**Obrázek 05**: Otevřené přesměrování útoku potlačována</span><span class="sxs-lookup"><span data-stu-id="c0625-171">**Figure 05**: Open Redirection attack defeated</span></span>

## <a name="summary"></a><span data-ttu-id="c0625-172">Souhrn</span><span class="sxs-lookup"><span data-stu-id="c0625-172">Summary</span></span>

<span data-ttu-id="c0625-173">Útoky otevřené přesměrování může dojít při přesměrování adresy URL jsou předány jako parametry v adrese URL pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c0625-173">Open redirection attacks can occur when redirection URLs are passed as parameters in the URL for an application.</span></span> <span data-ttu-id="c0625-174">Otevřete ASP.NET MVC 3, šablona obsahuje kód pro ochranu před útoky přesměrování.</span><span class="sxs-lookup"><span data-stu-id="c0625-174">The ASP.NET MVC 3 template includes code to protect against open redirection attacks.</span></span> <span data-ttu-id="c0625-175">Můžete přidat tento kód s určitými úpravami a 2 aplikace ASP.NET MVC 1,0.</span><span class="sxs-lookup"><span data-stu-id="c0625-175">You can add this code with some modification to ASP.NET MVC 1.0 and 2 applications.</span></span> <span data-ttu-id="c0625-176">K ochraně před útoky na otevřeném přesměrování při přihlašování do 1.0 technologie ASP.NET a 2 aplikací, přidejte metodu IsLocalUrl() a ověřte parametr returnUrl v akci přihlášení.</span><span class="sxs-lookup"><span data-stu-id="c0625-176">To protect against open redirection attacks when logging into ASP.NET 1.0 and 2 applications, add a IsLocalUrl() method and validate the returnUrl parameter in the LogOn action.</span></span>
