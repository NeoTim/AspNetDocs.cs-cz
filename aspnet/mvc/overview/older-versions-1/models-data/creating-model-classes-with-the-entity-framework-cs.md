---
uid: mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
title: Vytváření tříd modelu pomocí Entity Framework (C#) | Microsoft Docs
author: microsoft
description: V tomto kurzu se naučíte používat ASP.NET MVC s Microsoft Entity Framework. Naučíte se, jak pomocí Průvodce entitou vytvořit ADO.NET entitu da...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 61644169-e8b1-45dd-bf96-9c2301b69879
msc.legacyurl: /mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
msc.type: authoredcontent
ms.openlocfilehash: 2e0e365c287fc455015d237ea466301335805d14
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78581163"
---
# <a name="creating-model-classes-with-the-entity-framework-c"></a><span data-ttu-id="acbf0-104">Vytvoření tříd modelu v sadě Entity Framework (C#)</span><span class="sxs-lookup"><span data-stu-id="acbf0-104">Creating Model Classes with the Entity Framework (C#)</span></span>

<span data-ttu-id="acbf0-105">od [Microsoftu](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="acbf0-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="acbf0-106">V tomto kurzu se naučíte používat ASP.NET MVC s Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="acbf0-106">In this tutorial, you learn how to use ASP.NET MVC with the Microsoft Entity Framework.</span></span> <span data-ttu-id="acbf0-107">Naučíte se, jak pomocí Průvodce entitou vytvořit model EDM (Entity Data Model) ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="acbf0-107">You learn how to use the Entity Wizard to create an ADO.NET Entity Data Model.</span></span> <span data-ttu-id="acbf0-108">V průběhu tohoto kurzu sestavíme webovou aplikaci, která ukazuje, jak vybírat, vkládat, aktualizovat a odstraňovat databázová data pomocí Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="acbf0-108">Over the course of this tutorial, we build a web application that illustrates how to select, insert, update, and delete database data by using the Entity Framework.</span></span>

<span data-ttu-id="acbf0-109">Cílem tohoto kurzu je vysvětlit, jak můžete při sestavování aplikace ASP.NET MVC vytvořit třídy přístupu k datům pomocí Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="acbf0-109">The goal of this tutorial is to explain how you can create data access classes using the Microsoft Entity Framework when building an ASP.NET MVC application.</span></span> <span data-ttu-id="acbf0-110">V tomto kurzu se nepředpokládá žádné předchozí znalosti služby Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="acbf0-110">This tutorial assumes no previous knowledge of the Microsoft Entity Framework.</span></span> <span data-ttu-id="acbf0-111">Na konci tohoto kurzu budete rozumět tomu, jak použít Entity Framework k výběru, vkládání, aktualizaci a odstraňování záznamů databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-111">By the end of this tutorial, you'll understand how to use the Entity Framework to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="acbf0-112">Microsoft Entity Framework je nástroj pro mapování relačních objektů (O/RM), který umožňuje vygenerovat vrstvu přístupu k datům automaticky z databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-112">The Microsoft Entity Framework is an Object Relational Mapping (O/RM) tool that enables you to generate a data access layer from a database automatically.</span></span> <span data-ttu-id="acbf0-113">Entity Framework vám umožní vyhnout se zdlouhavé práci na vytváření tříd přístupu k datům ručně.</span><span class="sxs-lookup"><span data-stu-id="acbf0-113">The Entity Framework enables you to avoid the tedious work of building your data access classes by hand.</span></span>

<span data-ttu-id="acbf0-114">Pro ilustraci, jak můžete používat Microsoft Entity Framework s ASP.NET MVC, vytvoříme jednoduchou ukázkovou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="acbf0-114">In order to illustrate how you can use the Microsoft Entity Framework with ASP.NET MVC, we'll build a simple sample application.</span></span> <span data-ttu-id="acbf0-115">Vytvoříme aplikaci filmové databáze, která vám umožní zobrazit a upravit záznamy filmové databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-115">We'll create a Movie Database application that enables you to display and edit movie database records.</span></span>

<span data-ttu-id="acbf0-116">V tomto kurzu se předpokládá, že máte Visual Studio 2008 nebo Visual Web Developer 2008 s aktualizací Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="acbf0-116">This tutorial assumes that you have Visual Studio 2008 or Visual Web Developer 2008 with Service Pack 1.</span></span> <span data-ttu-id="acbf0-117">Aby bylo možné použít Entity Framework, potřebujete aktualizaci Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="acbf0-117">You need Service Pack 1 in order to use the Entity Framework.</span></span> <span data-ttu-id="acbf0-118">Aktualizaci Visual Studio 2008 Service Pack 1 nebo Visual Web Developer s aktualizací Service Pack 1 si můžete stáhnout z následující adresy:</span><span class="sxs-lookup"><span data-stu-id="acbf0-118">You can download Visual Studio 2008 Service Pack 1 or Visual Web Developer with Service Pack 1 from the following address:</span></span>

> [https://www.asp.net/downloads/](https://www.asp.net/downloads)

> [!NOTE] 
> 
> <span data-ttu-id="acbf0-119">Mezi ASP.NET MVC a Microsoft Entity Framework neexistuje žádné nezbytné připojení.</span><span class="sxs-lookup"><span data-stu-id="acbf0-119">There is no essential connection between ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="acbf0-120">Existuje několik alternativ Entity Framework, které můžete použít s ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="acbf0-120">There are several alternatives to the Entity Framework that you can use with ASP.NET MVC.</span></span> <span data-ttu-id="acbf0-121">Můžete například sestavit třídy MVC modelu pomocí jiných nástrojů pro/RM, jako je například Microsoft LINQ to SQL, NHibernate nebo Subsonic.</span><span class="sxs-lookup"><span data-stu-id="acbf0-121">For example, you can build your MVC Model classes using other O/RM tools such as Microsoft LINQ to SQL, NHibernate, or SubSonic.</span></span>

## <a name="creating-the-movie-sample-database"></a><span data-ttu-id="acbf0-122">Vytvoření ukázkové databáze filmů</span><span class="sxs-lookup"><span data-stu-id="acbf0-122">Creating the Movie Sample Database</span></span>

<span data-ttu-id="acbf0-123">Aplikace filmové databáze používá databázovou tabulku s názvem filmy, která obsahuje následující sloupce:</span><span class="sxs-lookup"><span data-stu-id="acbf0-123">The Movie Database application uses a database table named Movies that contains the following columns:</span></span>

| <span data-ttu-id="acbf0-124">Název sloupce</span><span class="sxs-lookup"><span data-stu-id="acbf0-124">Column Name</span></span> | <span data-ttu-id="acbf0-125">Typ dat</span><span class="sxs-lookup"><span data-stu-id="acbf0-125">Data Type</span></span> | <span data-ttu-id="acbf0-126">Chcete povoluje hodnoty null?</span><span class="sxs-lookup"><span data-stu-id="acbf0-126">Allow Nulls?</span></span> | <span data-ttu-id="acbf0-127">Je primární klíč?</span><span class="sxs-lookup"><span data-stu-id="acbf0-127">Is Primary Key?</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="acbf0-128">ID</span><span class="sxs-lookup"><span data-stu-id="acbf0-128">Id</span></span> | <span data-ttu-id="acbf0-129">int</span><span class="sxs-lookup"><span data-stu-id="acbf0-129">int</span></span> | <span data-ttu-id="acbf0-130">False</span><span class="sxs-lookup"><span data-stu-id="acbf0-130">False</span></span> | <span data-ttu-id="acbf0-131">True</span><span class="sxs-lookup"><span data-stu-id="acbf0-131">True</span></span> |
| <span data-ttu-id="acbf0-132">Název</span><span class="sxs-lookup"><span data-stu-id="acbf0-132">Title</span></span> | <span data-ttu-id="acbf0-133">nvarchar (100)</span><span class="sxs-lookup"><span data-stu-id="acbf0-133">nvarchar(100)</span></span> | <span data-ttu-id="acbf0-134">False</span><span class="sxs-lookup"><span data-stu-id="acbf0-134">False</span></span> | <span data-ttu-id="acbf0-135">False</span><span class="sxs-lookup"><span data-stu-id="acbf0-135">False</span></span> |
| <span data-ttu-id="acbf0-136">Ředitel</span><span class="sxs-lookup"><span data-stu-id="acbf0-136">Director</span></span> | <span data-ttu-id="acbf0-137">nvarchar (100)</span><span class="sxs-lookup"><span data-stu-id="acbf0-137">nvarchar(100)</span></span> | <span data-ttu-id="acbf0-138">False</span><span class="sxs-lookup"><span data-stu-id="acbf0-138">False</span></span> | <span data-ttu-id="acbf0-139">False</span><span class="sxs-lookup"><span data-stu-id="acbf0-139">False</span></span> |

<span data-ttu-id="acbf0-140">Tuto tabulku můžete přidat do projektu ASP.NET MVC pomocí následujících kroků:</span><span class="sxs-lookup"><span data-stu-id="acbf0-140">You can add this table to an ASP.NET MVC project by following these steps:</span></span>

1. <span data-ttu-id="acbf0-141">V okně Průzkumník řešení klikněte pravým tlačítkem na složku data\_aplikace a vyberte možnost nabídky **Přidat, nová položka.**</span><span class="sxs-lookup"><span data-stu-id="acbf0-141">Right-click the App\_Data folder in the Solution Explorer window and select the menu option **Add, New Item.**</span></span>
2. <span data-ttu-id="acbf0-142">V dialogovém okně **Přidat novou položku** vyberte **SQL Server databáze**, pojmenujte databázi MoviesDB. mdf a klikněte na tlačítko **Přidat** .</span><span class="sxs-lookup"><span data-stu-id="acbf0-142">From the **Add New Item** dialog box, select **SQL Server Database**, give the database the name MoviesDB.mdf, and click the **Add** button.</span></span>
3. <span data-ttu-id="acbf0-143">Dvojím kliknutím na soubor MoviesDB. mdf otevřete okno Průzkumník serveru/Průzkumník databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-143">Double-click the MoviesDB.mdf file to open the Server Explorer/Database Explorer window.</span></span>
4. <span data-ttu-id="acbf0-144">Rozbalte připojení k databázi MoviesDB. mdf, klikněte pravým tlačítkem myši na složku tabulky a vyberte možnost nabídky **Přidat novou tabulku**.</span><span class="sxs-lookup"><span data-stu-id="acbf0-144">Expand the MoviesDB.mdf database connection, right-click the Tables folder, and select the menu option **Add New Table**.</span></span>
5. <span data-ttu-id="acbf0-145">V Návrháři tabulky přidejte sloupce ID, název a režisér.</span><span class="sxs-lookup"><span data-stu-id="acbf0-145">In the Table Designer, add the Id, Title, and Director columns.</span></span>
6. <span data-ttu-id="acbf0-146">Klikněte na tlačítko **Uložit** (má ikonu na disketě) a uložte novou tabulku s názvem filmy.</span><span class="sxs-lookup"><span data-stu-id="acbf0-146">Click the **Save** button (it has the icon of the floppy) to save the new table with the name Movies.</span></span>

<span data-ttu-id="acbf0-147">Po vytvoření databázové tabulky filmů byste měli do tabulky přidat ukázková data.</span><span class="sxs-lookup"><span data-stu-id="acbf0-147">After you create the Movies database table, you should add some sample data to the table.</span></span> <span data-ttu-id="acbf0-148">Klikněte pravým tlačítkem myši na tabulku filmy a vyberte možnost nabídky **Zobrazit data tabulky**.</span><span class="sxs-lookup"><span data-stu-id="acbf0-148">Right-click the Movies table and select the menu option **Show Table Data**.</span></span> <span data-ttu-id="acbf0-149">Do mřížky, která se zobrazí, můžete zadat falešné filmové údaje.</span><span class="sxs-lookup"><span data-stu-id="acbf0-149">You can enter fake movie data into the grid that appears.</span></span>

## <a name="creating-the-adonet-entity-data-model"></a><span data-ttu-id="acbf0-150">Vytváření model EDM (Entity Data Model) ADO.NET</span><span class="sxs-lookup"><span data-stu-id="acbf0-150">Creating the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="acbf0-151">Aby bylo možné použít Entity Framework, je nutné vytvořit model EDM (Entity Data Model).</span><span class="sxs-lookup"><span data-stu-id="acbf0-151">In order to use the Entity Framework, you need to create an Entity Data Model.</span></span> <span data-ttu-id="acbf0-152">Můžete využít výhod *průvodce model EDM (Entity Data Model)* sady Visual Studio k automatickému vygenerování model EDM (Entity Data Model) z databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-152">You can take advantage of the Visual Studio *Entity Data Model Wizard* to generate an Entity Data Model from a database automatically.</span></span>

<span data-ttu-id="acbf0-153">Postupujte následovně:</span><span class="sxs-lookup"><span data-stu-id="acbf0-153">Follow these steps:</span></span>

1. <span data-ttu-id="acbf0-154">V okně Průzkumník řešení klikněte pravým tlačítkem na složku modely a vyberte možnost nabídky **Přidat, nová položka**.</span><span class="sxs-lookup"><span data-stu-id="acbf0-154">Right-click the Models folder in the Solution Explorer window and select the menu option **Add, New Item**.</span></span>
2. <span data-ttu-id="acbf0-155">V dialogovém okně **Přidat novou položku** vyberte kategorii dat (viz obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="acbf0-155">In the **Add New Item** dialog, select the Data category (see Figure 1).</span></span>
3. <span data-ttu-id="acbf0-156">Vyberte šablonu **model EDM (Entity Data Model) ADO.NET** , zadejte model EDM (Entity Data Model) název MoviesDBModel. edmx a klikněte na tlačítko **Přidat** .</span><span class="sxs-lookup"><span data-stu-id="acbf0-156">Select the **ADO.NET Entity Data Model** template, give the Entity Data Model the name MoviesDBModel.edmx, and click the **Add** button.</span></span> <span data-ttu-id="acbf0-157">Kliknutím na tlačítko **Přidat** spustíte Průvodce datovým modelem.</span><span class="sxs-lookup"><span data-stu-id="acbf0-157">Clicking the **Add** button launches the Data Model Wizard.</span></span>
4. <span data-ttu-id="acbf0-158">V kroku **zvolit obsah modelu** vyberte možnost **Generovat z databáze** a klikněte na tlačítko **Další** (viz obrázek 2).</span><span class="sxs-lookup"><span data-stu-id="acbf0-158">In the **Choose Model Contents** step, choose the **Generate from a database** option and click the **Next** button (see Figure 2).</span></span>
5. <span data-ttu-id="acbf0-159">V kroku **Zvolte datové připojení** vyberte připojení k databázi MoviesDB. mdf, zadejte název nastavení připojení entity MoviesDBEntities a klikněte na tlačítko **Další** (viz obrázek 3).</span><span class="sxs-lookup"><span data-stu-id="acbf0-159">In the **Choose Your Data Connection** step, select the MoviesDB.mdf database connection, enter the entities connection settings name MoviesDBEntities, and click the **Next** button (see Figure 3).</span></span>
6. <span data-ttu-id="acbf0-160">V kroku **Zvolte databázové objekty** vyberte tabulku video databáze a klikněte na tlačítko **Dokončit** (viz obrázek 4).</span><span class="sxs-lookup"><span data-stu-id="acbf0-160">In the **Choose Your Database Objects** step, select the Movie database table and click the **Finish** button (see Figure 4).</span></span>

<span data-ttu-id="acbf0-161">Po dokončení tohoto postupu se otevře Návrhář ADO.NET model EDM (Entity Data Model) (Entity Designer).</span><span class="sxs-lookup"><span data-stu-id="acbf0-161">After you complete these steps, the ADO.NET Entity Data Model Designer (Entity Designer) opens.</span></span>

<span data-ttu-id="acbf0-162">**Obrázek 1 – Vytvoření nového model EDM (Entity Data Model)**</span><span class="sxs-lookup"><span data-stu-id="acbf0-162">**Figure 1 – Creating a new Entity Data Model**</span></span>

![clip_image002](creating-model-classes-with-the-entity-framework-cs/_static/image1.jpg)

<span data-ttu-id="acbf0-164">**Obrázek 2 – krok výběr obsahu modelu**</span><span class="sxs-lookup"><span data-stu-id="acbf0-164">**Figure 2 – Choose Model Contents Step**</span></span>

![clip_image004](creating-model-classes-with-the-entity-framework-cs/_static/image2.jpg)

<span data-ttu-id="acbf0-166">**Obrázek 3 – Výběr datového připojení**</span><span class="sxs-lookup"><span data-stu-id="acbf0-166">**Figure 3 – Choose Your Data Connection**</span></span>

![clip_image006](creating-model-classes-with-the-entity-framework-cs/_static/image3.jpg)

<span data-ttu-id="acbf0-168">**Obrázek 4 – Výběr databázových objektů**</span><span class="sxs-lookup"><span data-stu-id="acbf0-168">**Figure 4 – Choose Your Database Objects**</span></span>

![clip_image008](creating-model-classes-with-the-entity-framework-cs/_static/image4.jpg)

#### <a name="modifying-the-adonet-entity-data-model"></a><span data-ttu-id="acbf0-170">Úprava model EDM (Entity Data Model) ADO.NET</span><span class="sxs-lookup"><span data-stu-id="acbf0-170">Modifying the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="acbf0-171">Po vytvoření model EDM (Entity Data Model) můžete model upravit tím, že využijete výhod Entity Designer (viz obrázek 5).</span><span class="sxs-lookup"><span data-stu-id="acbf0-171">After you create an Entity Data Model, you can modify the model by taking advantage of the Entity Designer (see Figure 5).</span></span> <span data-ttu-id="acbf0-172">Entity Designer můžete kdykoli otevřít tak, že dvakrát kliknete na soubor MoviesDBModel. edmx obsažený ve složce modely v Průzkumník řešení okně.</span><span class="sxs-lookup"><span data-stu-id="acbf0-172">You can open the Entity Designer at any time by double-clicking the MoviesDBModel.edmx file contained in the Models folder within the Solution Explorer window.</span></span>

<span data-ttu-id="acbf0-173">**Obrázek 5 – Návrhář model EDM (Entity Data Model) ADO.NET**</span><span class="sxs-lookup"><span data-stu-id="acbf0-173">**Figure 5 – The ADO.NET Entity Data Model Designer**</span></span>

![clip_image010](creating-model-classes-with-the-entity-framework-cs/_static/image5.jpg)

<span data-ttu-id="acbf0-175">Můžete například použít Entity Designer ke změně názvů tříd, které generuje Průvodce daty modelu entity.</span><span class="sxs-lookup"><span data-stu-id="acbf0-175">For example, you can use the Entity Designer to change the names of the classes that the Entity Model Data Wizard generates.</span></span> <span data-ttu-id="acbf0-176">Průvodce vytvořil novou třídu pro přístup k datům s názvem filmy.</span><span class="sxs-lookup"><span data-stu-id="acbf0-176">The Wizard created a new data access class named Movies.</span></span> <span data-ttu-id="acbf0-177">Jinými slovy, průvodce přiřadil třídu stejný název jako databázová tabulka.</span><span class="sxs-lookup"><span data-stu-id="acbf0-177">In other words, the Wizard gave the class the very same name as the database table.</span></span> <span data-ttu-id="acbf0-178">Vzhledem k tomu, že tuto třídu použijeme k reprezentování konkrétní instance videa, doporučujeme přejmenovat třídu z filmů na video.</span><span class="sxs-lookup"><span data-stu-id="acbf0-178">Because we will use this class to represent a particular Movie instance, we should rename the class from Movies to Movie.</span></span>

<span data-ttu-id="acbf0-179">Pokud chcete přejmenovat třídu entity, můžete dvakrát kliknout na název třídy v Entity Designer a zadat nový název (viz obrázek 6).</span><span class="sxs-lookup"><span data-stu-id="acbf0-179">If you want to rename an entity class, you can double-click on the class name in the Entity Designer and enter a new name (see Figure 6).</span></span> <span data-ttu-id="acbf0-180">Případně můžete název entity v okno Vlastnosti změnit po výběru entity v Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="acbf0-180">Alternatively, you can change the name of an entity in the Properties window after selecting an entity in the Entity Designer.</span></span>

<span data-ttu-id="acbf0-181">**Obrázek 6 – Změna názvu entity**</span><span class="sxs-lookup"><span data-stu-id="acbf0-181">**Figure 6 – Changing an entity name**</span></span>

![clip_image012](creating-model-classes-with-the-entity-framework-cs/_static/image6.jpg)

<span data-ttu-id="acbf0-183">Po provedení úprav nezapomeňte uložit model EDM (Entity Data Model) kliknutím na tlačítko Uložit (ikona na disketě).</span><span class="sxs-lookup"><span data-stu-id="acbf0-183">Remember to save your Entity Data Model after making a modification by clicking the Save button (the icon of the floppy disk).</span></span> <span data-ttu-id="acbf0-184">Na pozadí Entity Designer generuje sadu C# tříd.</span><span class="sxs-lookup"><span data-stu-id="acbf0-184">Behind the scenes, the Entity Designer generates a set of C# classes.</span></span> <span data-ttu-id="acbf0-185">Tyto třídy můžete zobrazit otevřením souboru MoviesDBModel.Designer.cs z okna Průzkumník řešení.</span><span class="sxs-lookup"><span data-stu-id="acbf0-185">You can view these classes by opening the MoviesDBModel.Designer.cs file from the Solution Explorer window.</span></span>

<span data-ttu-id="acbf0-186">Neměňte kód v souboru Designer.cs, protože změny budou při příštím použití Entity Designer přepsány.</span><span class="sxs-lookup"><span data-stu-id="acbf0-186">Don't modify the code in the Designer.cs file since your changes will be overwritten the next time you use the Entity Designer.</span></span> <span data-ttu-id="acbf0-187">Pokud chcete roztáhnout funkce tříd entit definovaných v souboru Designer.cs, můžete vytvořit *částečné třídy* v samostatných souborech.</span><span class="sxs-lookup"><span data-stu-id="acbf0-187">If you want to extend the functionality of the entity classes defined in the Designer.cs file then you can create *partial classes* in separate files.</span></span>

#### <a name="selecting-database-records-with-the-entity-framework"></a><span data-ttu-id="acbf0-188">Výběr záznamů databáze pomocí Entity Framework</span><span class="sxs-lookup"><span data-stu-id="acbf0-188">Selecting Database Records with the Entity Framework</span></span>

<span data-ttu-id="acbf0-189">Pojďme začít sestavovat naši aplikaci pro filmové databáze vytvořením stránky, která zobrazuje seznam filmových záznamů.</span><span class="sxs-lookup"><span data-stu-id="acbf0-189">Let's start building our Movie Database application by creating a page that displays a list of movie records.</span></span> <span data-ttu-id="acbf0-190">U domovského kontroleru v výpisu 1 se zveřejňuje akce s názvem index ().</span><span class="sxs-lookup"><span data-stu-id="acbf0-190">The Home controller in Listing 1 exposes an action named Index().</span></span> <span data-ttu-id="acbf0-191">Akce index () vrátí všechny záznamy filmů z tabulky filmové databáze tím, že využije Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="acbf0-191">The Index() action returns all of the movie records from the Movie database table by taking advantage of the Entity Framework.</span></span>

<span data-ttu-id="acbf0-192">**Výpis 1 – souboru controllers\homecontroller.cs**</span><span class="sxs-lookup"><span data-stu-id="acbf0-192">**Listing 1 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample1.cs)]

<span data-ttu-id="acbf0-193">Všimněte si, že kontroler v seznamu 1 obsahuje konstruktor.</span><span class="sxs-lookup"><span data-stu-id="acbf0-193">Notice that the controller in Listing 1 includes a constructor.</span></span> <span data-ttu-id="acbf0-194">Konstruktor inicializuje pole na úrovni třídy s názvem \_DB.</span><span class="sxs-lookup"><span data-stu-id="acbf0-194">The constructor initializes a class-level field named \_db.</span></span> <span data-ttu-id="acbf0-195">Pole \_dB představuje databázové entity vygenerované Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="acbf0-195">The \_db field represents the database entities generated by the Microsoft Entity Framework.</span></span> <span data-ttu-id="acbf0-196">Pole \_DB je instancí třídy MoviesDBEntities, která byla vygenerována Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="acbf0-196">The \_db field is an instance of the MoviesDBEntities class that was generated by the Entity Designer.</span></span>

<span data-ttu-id="acbf0-197">Aby bylo možné použít třídu theMoviesDBEntities v rámci domovského kontroleru, je nutné importovat obor názvů MovieEntityApp. Models (*MVCProjectName*. Modely).</span><span class="sxs-lookup"><span data-stu-id="acbf0-197">In order to use theMoviesDBEntities class in the Home controller, you must import the MovieEntityApp.Models namespace (*MVCProjectName*.Models).</span></span>

<span data-ttu-id="acbf0-198">Pole \_DB se používá v rámci akce index () k načtení záznamů z tabulky databáze filmů.</span><span class="sxs-lookup"><span data-stu-id="acbf0-198">The \_db field is used within the Index() action to retrieve the records from the Movies database table.</span></span> <span data-ttu-id="acbf0-199">Výraz \_DB. MovieSet představuje všechny záznamy z databázové tabulky filmů.</span><span class="sxs-lookup"><span data-stu-id="acbf0-199">The expression \_db.MovieSet represents all of the records from the Movies database table.</span></span> <span data-ttu-id="acbf0-200">Metoda ToList – () slouží k převodu sady filmů do obecné kolekce objektů Movie (list&lt;Movie&gt;).</span><span class="sxs-lookup"><span data-stu-id="acbf0-200">The ToList() method is used to convert the set of movies into a generic collection of Movie objects (List&lt;Movie&gt;).</span></span>

<span data-ttu-id="acbf0-201">Filmové záznamy se načítají pomocí LINQ to Entities.</span><span class="sxs-lookup"><span data-stu-id="acbf0-201">The movie records are retrieved with the help of LINQ to Entities.</span></span> <span data-ttu-id="acbf0-202">Akce index () v seznamu 1 používá *syntaxi metody* LINQ k načtení sady záznamů databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-202">The Index() action in Listing 1 uses LINQ *method syntax* to retrieve the set of database records.</span></span> <span data-ttu-id="acbf0-203">Pokud dáváte přednost, můžete místo toho použít *syntaxi dotazu* LINQ.</span><span class="sxs-lookup"><span data-stu-id="acbf0-203">If you prefer, you can use LINQ *query syntax* instead.</span></span> <span data-ttu-id="acbf0-204">Následující dva příkazy dělají stejnou věc:</span><span class="sxs-lookup"><span data-stu-id="acbf0-204">The following two statements do the very same thing:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample2.cs)]

<span data-ttu-id="acbf0-205">Použijte jakoukoli syntaxi syntaxe LINQ – syntaxi metody nebo syntaxi dotazů, které najdete nejvíc intuitivní.</span><span class="sxs-lookup"><span data-stu-id="acbf0-205">Use whichever LINQ syntax – method syntax or query syntax – that you find most intuitive.</span></span> <span data-ttu-id="acbf0-206">Mezi oběma přístupy nedochází k žádnému rozdílu ve výkonu – jediným rozdílem je styl.</span><span class="sxs-lookup"><span data-stu-id="acbf0-206">There is no difference in performance between the two approaches – the only difference is style.</span></span>

<span data-ttu-id="acbf0-207">Zobrazení v seznamu 2 slouží k zobrazení záznamů filmů.</span><span class="sxs-lookup"><span data-stu-id="acbf0-207">The view in Listing 2 is used to display the movie records.</span></span>

<span data-ttu-id="acbf0-208">**Výpis 2 – Views\Home\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="acbf0-208">**Listing 2 – Views\Home\Index.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample3.aspx)]

<span data-ttu-id="acbf0-209">Zobrazení v seznamu 2 obsahuje smyčku **foreach** , která projde každým záznamem videa a zobrazí hodnoty vlastností název a režisér záznamu videa.</span><span class="sxs-lookup"><span data-stu-id="acbf0-209">The view in Listing 2 contains a **foreach** loop that iterates through each movie record and displays the values of the movie record's Title and Director properties.</span></span> <span data-ttu-id="acbf0-210">Všimněte si, že se vedle každého záznamu zobrazuje odkaz upravit a odstranit.</span><span class="sxs-lookup"><span data-stu-id="acbf0-210">Notice that an Edit and Delete link is displayed next to each record.</span></span> <span data-ttu-id="acbf0-211">Kromě toho se v dolní části zobrazení zobrazí odkaz Přidat film (viz obrázek 7).</span><span class="sxs-lookup"><span data-stu-id="acbf0-211">Furthermore, an Add Movie link appears at the bottom of the view (see Figure 7).</span></span>

<span data-ttu-id="acbf0-212">**Obrázek 7 – zobrazení indexu**</span><span class="sxs-lookup"><span data-stu-id="acbf0-212">**Figure 7 – The Index view**</span></span>

![clip_image014](creating-model-classes-with-the-entity-framework-cs/_static/image7.jpg)

<span data-ttu-id="acbf0-214">Zobrazení index je typu *zobrazení*.</span><span class="sxs-lookup"><span data-stu-id="acbf0-214">The Index view is a *typed view*.</span></span> <span data-ttu-id="acbf0-215">Zobrazení indexů obsahuje direktivu &lt;% @ Page%&gt; s atributem *Inherits* , který předává vlastnost model na seznam obecných seznamů objektů videa typu "silně typované" (seznam&lt;film).</span><span class="sxs-lookup"><span data-stu-id="acbf0-215">The Index view includes a &lt;%@ Page %&gt; directive with an *Inherits* attribute that casts the Model property to a strongly typed generic List collection of Movie objects (List&lt;Movie).</span></span>

## <a name="inserting-database-records-with-the-entity-framework"></a><span data-ttu-id="acbf0-216">Vkládání záznamů databáze pomocí Entity Framework</span><span class="sxs-lookup"><span data-stu-id="acbf0-216">Inserting Database Records with the Entity Framework</span></span>

<span data-ttu-id="acbf0-217">Entity Framework můžete použít k usnadnění vkládání nových záznamů do databázové tabulky.</span><span class="sxs-lookup"><span data-stu-id="acbf0-217">You can use the Entity Framework to make it easy to insert new records into a database table.</span></span> <span data-ttu-id="acbf0-218">Výpis 3 obsahuje dvě nové akce přidané do třídy domovského kontroleru, které můžete použít k vložení nových záznamů do tabulky filmové databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-218">Listing 3 contains two new actions added to the Home controller class that you can use to insert new records into the Movie database table.</span></span>

<span data-ttu-id="acbf0-219">**Výpis 3 – souboru controllers\homecontroller.cs (Přidání metod)**</span><span class="sxs-lookup"><span data-stu-id="acbf0-219">**Listing 3 – Controllers\HomeController.cs (Add methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample4.cs)]

<span data-ttu-id="acbf0-220">První akce Přidat () jednoduše vrátí zobrazení.</span><span class="sxs-lookup"><span data-stu-id="acbf0-220">The first Add() action simply returns a view.</span></span> <span data-ttu-id="acbf0-221">Zobrazení obsahuje formulář pro přidání nového záznamu filmové databáze (viz obrázek 8).</span><span class="sxs-lookup"><span data-stu-id="acbf0-221">The view contains a form for adding a new movie database record (see Figure 8).</span></span> <span data-ttu-id="acbf0-222">Při odeslání formuláře je vyvolána druhá akce Přidat ().</span><span class="sxs-lookup"><span data-stu-id="acbf0-222">When you submit the form, the second Add() action is invoked.</span></span>

<span data-ttu-id="acbf0-223">Všimněte si, že druhá akce Přidat () je upravena pomocí atributu AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="acbf0-223">Notice that the second Add() action is decorated with the AcceptVerbs attribute.</span></span> <span data-ttu-id="acbf0-224">Tuto akci lze vyvolat pouze při provádění operace HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="acbf0-224">This action can be invoked only when performing an HTTP POST operation.</span></span> <span data-ttu-id="acbf0-225">Jinými slovy, tuto akci lze vyvolat pouze při publikování formuláře HTML.</span><span class="sxs-lookup"><span data-stu-id="acbf0-225">In other words, this action can only be invoked when posting an HTML form.</span></span>

<span data-ttu-id="acbf0-226">Druhá akce Přidat () vytvoří novou instanci třídy Entity Framework Movie s použitím metody ASP.NET MVC TryUpdateModel ().</span><span class="sxs-lookup"><span data-stu-id="acbf0-226">The second Add() action creates a new instance of the Entity Framework Movie class with the help of the ASP.NET MVC TryUpdateModel() method.</span></span> <span data-ttu-id="acbf0-227">Metoda TryUpdateModel () převezme pole v Podoběcollection předané do metody Add () a přiřadí hodnoty těchto polí formuláře HTML do třídy video.</span><span class="sxs-lookup"><span data-stu-id="acbf0-227">The TryUpdateModel() method takes the fields in the FormCollection passed to the Add() method and assigns the values of these HTML form fields to the Movie class.</span></span>

<span data-ttu-id="acbf0-228">Při použití Entity Framework je nutné při použití metod TryUpdateModel nebo UpdateModel pro aktualizaci vlastností třídy entity uvést "bílý seznam vlastností".</span><span class="sxs-lookup"><span data-stu-id="acbf0-228">When using the Entity Framework, you must supply a "white list" of properties when using the TryUpdateModel or UpdateModel methods to update the properties of an entity class.</span></span>

<span data-ttu-id="acbf0-229">V dalším kroku akce Přidat () provede určité jednoduché ověření formuláře.</span><span class="sxs-lookup"><span data-stu-id="acbf0-229">Next, the Add() action performs some simple form validation.</span></span> <span data-ttu-id="acbf0-230">Akce ověří, že vlastnosti title a Director mají hodnoty.</span><span class="sxs-lookup"><span data-stu-id="acbf0-230">The action verifies that both the Title and Director properties have values.</span></span> <span data-ttu-id="acbf0-231">Pokud dojde k chybě ověřování, do ModelState se přidá chybová zpráva o ověření.</span><span class="sxs-lookup"><span data-stu-id="acbf0-231">If there is a validation error, then a validation error message is added to ModelState.</span></span>

<span data-ttu-id="acbf0-232">Pokud nedošlo k chybám ověření, přidá se do tabulky video Database nový záznam filmu s použitím Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="acbf0-232">If there are no validation errors then a new movie record is added to the Movies database table with the help of the Entity Framework.</span></span> <span data-ttu-id="acbf0-233">Nový záznam se přidá do databáze s následujícími dvěma řádky kódu:</span><span class="sxs-lookup"><span data-stu-id="acbf0-233">The new record is added to the database with the following two lines of code:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample5.cs)]

<span data-ttu-id="acbf0-234">První řádek kódu přidá novou entitu video do sady filmů sledovaných pomocí Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="acbf0-234">The first line of code adds the new Movie entity to the set of movies being tracked by the Entity Framework.</span></span> <span data-ttu-id="acbf0-235">Druhý řádek kódu uloží veškeré změny, které byly provedeny u filmů sledovaných zpět do podkladové databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-235">The second line of code saves whatever changes have been made to the Movies being tracked back to the underlying database.</span></span>

<span data-ttu-id="acbf0-236">**Obrázek 8 – zobrazení přidat**</span><span class="sxs-lookup"><span data-stu-id="acbf0-236">**Figure 8 – The Add view**</span></span>

![clip_image016](creating-model-classes-with-the-entity-framework-cs/_static/image8.jpg)

#### <a name="updating-database-records-with-the-entity-framework"></a><span data-ttu-id="acbf0-238">Aktualizace databázových záznamů pomocí Entity Framework</span><span class="sxs-lookup"><span data-stu-id="acbf0-238">Updating Database Records with the Entity Framework</span></span>

<span data-ttu-id="acbf0-239">Můžete použít skoro stejný přístup pro úpravu záznamu databáze s Entity Framework jako metodu, kterou jsme právě následovali za účelem vložení nového záznamu databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-239">You can follow almost the same approach to edit a database record with the Entity Framework as the approach that we just followed to insert a new database record.</span></span> <span data-ttu-id="acbf0-240">Výpis 4 obsahuje dvě nové akce kontroleru s názvem Edit ().</span><span class="sxs-lookup"><span data-stu-id="acbf0-240">Listing 4 contains two new controller actions named Edit().</span></span> <span data-ttu-id="acbf0-241">První akce upravit () vrátí formulář HTML pro úpravu záznamu filmu.</span><span class="sxs-lookup"><span data-stu-id="acbf0-241">The first Edit() action returns an HTML form for editing a movie record.</span></span> <span data-ttu-id="acbf0-242">Druhá akce Edit () se pokusí aktualizovat databázi.</span><span class="sxs-lookup"><span data-stu-id="acbf0-242">The second Edit() action attempts to update the database.</span></span>

<span data-ttu-id="acbf0-243">**Výpis 4 – souboru controllers\homecontroller.cs (upravit metody)**</span><span class="sxs-lookup"><span data-stu-id="acbf0-243">**Listing 4 – Controllers\HomeController.cs (Edit methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample6.cs)]

<span data-ttu-id="acbf0-244">Druhá akce Edit () začíná načtením záznamu filmu z databáze, která odpovídá ID upravovaného filmu.</span><span class="sxs-lookup"><span data-stu-id="acbf0-244">The second Edit() action starts by retrieving the Movie record from the database that matches the Id of the movie being edited.</span></span> <span data-ttu-id="acbf0-245">Následující příkaz LINQ to Entities přiřadí první záznam v databázi, který odpovídá konkrétnímu ID:</span><span class="sxs-lookup"><span data-stu-id="acbf0-245">The following LINQ to Entities statement grabs the first database record that matches a particular Id:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample7.cs)]

<span data-ttu-id="acbf0-246">Dále metoda TryUpdateModel () slouží k přiřazení hodnot polí formuláře HTML k vlastnostem entity video.</span><span class="sxs-lookup"><span data-stu-id="acbf0-246">Next, the TryUpdateModel() method is used to assign the values of the HTML form fields to the properties of the movie entity.</span></span> <span data-ttu-id="acbf0-247">Všimněte si, že je k dispozici prázdný seznam pro určení přesných vlastností, které se mají aktualizovat.</span><span class="sxs-lookup"><span data-stu-id="acbf0-247">Notice that a white list is supplied to specify the exact properties to update.</span></span>

<span data-ttu-id="acbf0-248">V dalším kroku se provede nějaké jednoduché ověření, které ověří, že vlastnosti názvu a režiséra filmu mají hodnoty.</span><span class="sxs-lookup"><span data-stu-id="acbf0-248">Next, some simple validation is performed to verify that both the Movie Title and Director properties have values.</span></span> <span data-ttu-id="acbf0-249">Pokud chybí hodnota vlastnosti, je přidána chybová zpráva ověření do ModelState a ModelState. IsValid vrátí hodnotu false.</span><span class="sxs-lookup"><span data-stu-id="acbf0-249">If either property is missing a value, then a validation error message is added to ModelState and ModelState.IsValid returns the value false.</span></span>

<span data-ttu-id="acbf0-250">Nakonec, pokud nejsou k dispozici žádné chyby ověřování, je podkladová tabulka databáze filmů aktualizována o všechny změny voláním metody SaveChanges ().</span><span class="sxs-lookup"><span data-stu-id="acbf0-250">Finally, if there are no validation errors, then the underlying Movies database table is updated with any changes by calling the SaveChanges() method.</span></span>

<span data-ttu-id="acbf0-251">Při úpravách záznamů databáze je třeba předat ID upravovaného záznamu do akce kontroleru, která provádí aktualizaci databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-251">When editing database records, you need to pass the Id of the record being edited to the controller action that performs the database update.</span></span> <span data-ttu-id="acbf0-252">V opačném případě akce kontroleru nebude informovat o tom, který záznam má být aktualizován v podkladové databázi.</span><span class="sxs-lookup"><span data-stu-id="acbf0-252">Otherwise, the controller action will not know which record to update in the underlying database.</span></span> <span data-ttu-id="acbf0-253">Zobrazení pro úpravy obsažené v seznamu 5 obsahuje skryté pole formuláře, které představuje ID upravovaného záznamu databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-253">The Edit view, contained in Listing 5, includes a hidden form field that represents the Id of the database record being edited.</span></span>

<span data-ttu-id="acbf0-254">**Výpis 5 – Views\Home\Edit.aspx**</span><span class="sxs-lookup"><span data-stu-id="acbf0-254">**Listing 5 – Views\Home\Edit.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample8.aspx)]

## <a name="deleting-database-records-with-the-entity-framework"></a><span data-ttu-id="acbf0-255">Odstranění záznamů databáze pomocí Entity Framework</span><span class="sxs-lookup"><span data-stu-id="acbf0-255">Deleting Database Records with the Entity Framework</span></span>

<span data-ttu-id="acbf0-256">Poslední databázová operace, kterou potřebujeme v tomto kurzu řešit, je odstraňování záznamů databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-256">The final database operation, which we need to tackle in this tutorial, is deleting database records.</span></span> <span data-ttu-id="acbf0-257">K odstranění konkrétního záznamu databáze můžete použít akci kontroleru v výpisu 6.</span><span class="sxs-lookup"><span data-stu-id="acbf0-257">You can use the controller action in Listing 6 to delete a particular database record.</span></span>

<span data-ttu-id="acbf0-258">**Výpis 6--\Controllers\HomeController.cs (akce Odstranit)**</span><span class="sxs-lookup"><span data-stu-id="acbf0-258">**Listing 6 -- \Controllers\HomeController.cs (Delete action)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample9.cs)]

<span data-ttu-id="acbf0-259">Akce Odstranit () nejprve načte entitu videa, která odpovídá ID předané akci.</span><span class="sxs-lookup"><span data-stu-id="acbf0-259">The Delete() action first retrieves the Movie entity that matches the Id passed to the action.</span></span> <span data-ttu-id="acbf0-260">Dále je film odstraněn z databáze voláním metody OdstranitObjekt () následovaný metodou SaveChanges ().</span><span class="sxs-lookup"><span data-stu-id="acbf0-260">Next, the movie is deleted from the database by calling the DeleteObject() method followed by the SaveChanges() method.</span></span> <span data-ttu-id="acbf0-261">Nakonec se uživatel přesměruje zpět do zobrazení indexu.</span><span class="sxs-lookup"><span data-stu-id="acbf0-261">Finally, the user is redirected back to the Index view.</span></span>

## <a name="summary"></a><span data-ttu-id="acbf0-262">Souhrn</span><span class="sxs-lookup"><span data-stu-id="acbf0-262">Summary</span></span>

<span data-ttu-id="acbf0-263">Účelem tohoto kurzu je předvést, jak můžete vytvářet databázové webové aplikace s využitím ASP.NET MVC a Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="acbf0-263">The purpose of this tutorial was to demonstrate how you can build database-driven web applications by taking advantage of ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="acbf0-264">Zjistili jste, jak vytvořit aplikaci, která umožňuje výběr, vložení, aktualizaci a odstranění záznamů databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-264">You learned how to build an application that enables you to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="acbf0-265">Nejprve jsme probrali, jak můžete pomocí Průvodce model EDM (Entity Data Model) vygenerovat model EDM (Entity Data Model) z aplikace Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="acbf0-265">First, we discussed how you can use the Entity Data Model Wizard to generate an Entity Data Model from within Visual Studio.</span></span> <span data-ttu-id="acbf0-266">Dále se naučíte, jak pomocí LINQ to Entities načíst sadu databázových záznamů z databázové tabulky.</span><span class="sxs-lookup"><span data-stu-id="acbf0-266">Next, you learn how to use LINQ to Entities to retrieve a set of database records from a database table.</span></span> <span data-ttu-id="acbf0-267">Nakonec jsme použili Entity Framework k vkládání, aktualizaci a odstraňování záznamů databáze.</span><span class="sxs-lookup"><span data-stu-id="acbf0-267">Finally, we used the Entity Framework to insert, update, and delete database records.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="acbf0-268">Next</span><span class="sxs-lookup"><span data-stu-id="acbf0-268">Next</span></span>](creating-model-classes-with-linq-to-sql-cs.md)
