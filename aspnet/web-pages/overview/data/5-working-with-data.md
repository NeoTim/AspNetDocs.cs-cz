---
uid: web-pages/overview/data/5-working-with-data
title: Úvod k práci s databází na webech ASP.NET Web Pages (Razor) | Microsoft Docs
author: Rick-Anderson
description: Tato kapitola popisuje, jak získat přístup k datům z databáze a jak ji zobrazit pomocí webových stránek ASP.NET.
ms.author: riande
ms.date: 02/18/2014
ms.assetid: 673d502f-2c16-4a6f-bb63-dbfd9a77ef47
msc.legacyurl: /web-pages/overview/data/5-working-with-data
msc.type: authoredcontent
ms.openlocfilehash: 45e988d037465e59ad352bb9444af2c69fd3cd70
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78586532"
---
# <a name="introduction-to-working-with-a-database-in-aspnet-web-pages-razor-sites"></a><span data-ttu-id="17e0b-103">Úvod k práci s databází na webech ASP.NET Web Pages (Razor)</span><span class="sxs-lookup"><span data-stu-id="17e0b-103">Introduction to Working with a Database in ASP.NET Web Pages (Razor) Sites</span></span>

<span data-ttu-id="17e0b-104">tím, že [FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="17e0b-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="17e0b-105">Tento článek popisuje, jak pomocí nástrojů Microsoft WebMatrix vytvořit databázi na webu ASP.NET Web Pages (Razor) a jak vytvářet stránky, které vám umožní zobrazovat, přidávat, upravovat a odstraňovat data.</span><span class="sxs-lookup"><span data-stu-id="17e0b-105">This article describes how to use Microsoft WebMatrix tools to create a database in an ASP.NET Web Pages (Razor) website, and how to create pages that let you display, add, edit, and delete data.</span></span>
> 
> <span data-ttu-id="17e0b-106">**Co se naučíte:**</span><span class="sxs-lookup"><span data-stu-id="17e0b-106">**What you'll learn:**</span></span> 
> 
> - <span data-ttu-id="17e0b-107">Jak vytvořit databázi.</span><span class="sxs-lookup"><span data-stu-id="17e0b-107">How to create a database.</span></span>
> - <span data-ttu-id="17e0b-108">Jak se připojit k databázi.</span><span class="sxs-lookup"><span data-stu-id="17e0b-108">How to connect to a database.</span></span>
> - <span data-ttu-id="17e0b-109">Jak zobrazit data na webové stránce.</span><span class="sxs-lookup"><span data-stu-id="17e0b-109">How to display data in a web page.</span></span>
> - <span data-ttu-id="17e0b-110">Jak vkládat, aktualizovat a odstraňovat záznamy databáze.</span><span class="sxs-lookup"><span data-stu-id="17e0b-110">How to insert, update, and delete database records.</span></span>
> 
> <span data-ttu-id="17e0b-111">Tyto funkce jsou představené v článku:</span><span class="sxs-lookup"><span data-stu-id="17e0b-111">These are the features introduced in the article:</span></span>
> 
> - <span data-ttu-id="17e0b-112">Práce s databází edice Microsoft SQL Server Compact.</span><span class="sxs-lookup"><span data-stu-id="17e0b-112">Working with a Microsoft SQL Server Compact Edition database.</span></span>
> - <span data-ttu-id="17e0b-113">Práce s dotazy SQL.</span><span class="sxs-lookup"><span data-stu-id="17e0b-113">Working with SQL queries.</span></span>
> - <span data-ttu-id="17e0b-114">Třída `Database`.</span><span class="sxs-lookup"><span data-stu-id="17e0b-114">The `Database` class.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="17e0b-115">Verze softwaru použité v tomto kurzu</span><span class="sxs-lookup"><span data-stu-id="17e0b-115">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="17e0b-116">Webové stránky ASP.NET (Razor) 2</span><span class="sxs-lookup"><span data-stu-id="17e0b-116">ASP.NET Web Pages (Razor) 2</span></span>
> - <span data-ttu-id="17e0b-117">WebMatrix 2</span><span class="sxs-lookup"><span data-stu-id="17e0b-117">WebMatrix 2</span></span>
>   
> 
> <span data-ttu-id="17e0b-118">V tomto kurzu se používá také WebMatrix 3.</span><span class="sxs-lookup"><span data-stu-id="17e0b-118">This tutorial also works with WebMatrix 3.</span></span> <span data-ttu-id="17e0b-119">Můžete použít webové stránky ASP.NET 3 a Visual Studio 2013 (nebo Visual Studio Express 2013 pro web); uživatelské rozhraní se ale bude lišit.</span><span class="sxs-lookup"><span data-stu-id="17e0b-119">You can use ASP.NET Web Pages 3 and Visual Studio 2013 (or Visual Studio Express 2013 for Web); however, the user interface will be different.</span></span>

## <a name="introduction-to-databases"></a><span data-ttu-id="17e0b-120">Seznámení s databázemi</span><span class="sxs-lookup"><span data-stu-id="17e0b-120">Introduction to Databases</span></span>

<span data-ttu-id="17e0b-121">Představte si typický adresář.</span><span class="sxs-lookup"><span data-stu-id="17e0b-121">Imagine a typical address book.</span></span> <span data-ttu-id="17e0b-122">Pro každou položku v adresáři (tj. pro jednotlivé osoby) máte několik informací, jako je křestní jméno, příjmení, adresa, e-mailová adresa a telefonní číslo.</span><span class="sxs-lookup"><span data-stu-id="17e0b-122">For each entry in the address book (that is, for each person) you have several pieces of information such as first name, last name, address, email address, and phone number.</span></span>

<span data-ttu-id="17e0b-123">Typický způsob, jak obrázková data vypadat jako tabulka s řádky a sloupci.</span><span class="sxs-lookup"><span data-stu-id="17e0b-123">A typical way to picture data like this is as a table with rows and columns.</span></span> <span data-ttu-id="17e0b-124">V rámci databázových podmínek se každý řádek často označuje jako záznam.</span><span class="sxs-lookup"><span data-stu-id="17e0b-124">In database terms, each row is often referred to as a record.</span></span> <span data-ttu-id="17e0b-125">Každý sloupec (někdy označovaný jako pole) obsahuje hodnotu pro každý typ dat: jméno, příjmení a tak dále.</span><span class="sxs-lookup"><span data-stu-id="17e0b-125">Each column (sometimes referred to as fields) contains a value for each type of data: first name, last name, and so on.</span></span>

| <span data-ttu-id="17e0b-126">**ID**</span><span class="sxs-lookup"><span data-stu-id="17e0b-126">**ID**</span></span> | <span data-ttu-id="17e0b-127">**FirstName**</span><span class="sxs-lookup"><span data-stu-id="17e0b-127">**FirstName**</span></span> | <span data-ttu-id="17e0b-128">**Polím**</span><span class="sxs-lookup"><span data-stu-id="17e0b-128">**LastName**</span></span> | <span data-ttu-id="17e0b-129">**Adresáře**</span><span class="sxs-lookup"><span data-stu-id="17e0b-129">**Address**</span></span> | <span data-ttu-id="17e0b-130">**E-mail**</span><span class="sxs-lookup"><span data-stu-id="17e0b-130">**Email**</span></span> | <span data-ttu-id="17e0b-131">**Hovor**</span><span class="sxs-lookup"><span data-stu-id="17e0b-131">**Phone**</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="17e0b-132">1</span><span class="sxs-lookup"><span data-stu-id="17e0b-132">1</span></span> | <span data-ttu-id="17e0b-133">Jan</span><span class="sxs-lookup"><span data-stu-id="17e0b-133">Jim</span></span> | <span data-ttu-id="17e0b-134">Abrus</span><span class="sxs-lookup"><span data-stu-id="17e0b-134">Abrus</span></span> | <span data-ttu-id="17e0b-135">210 100th St SE Orcas WA 98031</span><span class="sxs-lookup"><span data-stu-id="17e0b-135">210 100th St SE Orcas WA 98031</span></span> | jim@contoso.com | <span data-ttu-id="17e0b-136">555 0100</span><span class="sxs-lookup"><span data-stu-id="17e0b-136">555 0100</span></span> |
| <span data-ttu-id="17e0b-137">2</span><span class="sxs-lookup"><span data-stu-id="17e0b-137">2</span></span> | <span data-ttu-id="17e0b-138">Terry</span><span class="sxs-lookup"><span data-stu-id="17e0b-138">Terry</span></span> | <span data-ttu-id="17e0b-139">Adams</span><span class="sxs-lookup"><span data-stu-id="17e0b-139">Adams</span></span> | <span data-ttu-id="17e0b-140">1234 Main St. Praha WA – 99011</span><span class="sxs-lookup"><span data-stu-id="17e0b-140">1234 Main St. Seattle WA 99011</span></span> | terry@cohowinery.com | <span data-ttu-id="17e0b-141">555 0101</span><span class="sxs-lookup"><span data-stu-id="17e0b-141">555 0101</span></span> |

<span data-ttu-id="17e0b-142">U většiny tabulek databáze musí mít tabulka sloupec, který obsahuje jedinečný identifikátor, jako je číslo zákazníka, číslo účtu atd. To se označuje jako *primární klíč*tabulky a používá se k identifikaci každého řádku v tabulce.</span><span class="sxs-lookup"><span data-stu-id="17e0b-142">For most database tables, the table has to have a column that contains a unique identifier, like a customer number, account number, etc. This is known as the table's *primary key*, and you use it to identify each row in the table.</span></span> <span data-ttu-id="17e0b-143">V tomto příkladu je sloupec ID primárním klíčem pro adresář.</span><span class="sxs-lookup"><span data-stu-id="17e0b-143">In the example, the ID column is the primary key for the address book.</span></span>

<span data-ttu-id="17e0b-144">Díky tomuto základnímu porozumění databázím jste připraveni zjistit, jak vytvořit jednoduchou databázi a provádět operace, jako je přidání, úpravy a odstranění dat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-144">With this basic understanding of databases, you're ready to learn how to create a simple database and perform operations such as adding, modifying, and deleting data.</span></span>

> [!TIP] 
> 
> <span data-ttu-id="17e0b-145">**Relační databáze**</span><span class="sxs-lookup"><span data-stu-id="17e0b-145">**Relational Databases**</span></span>
> 
> <span data-ttu-id="17e0b-146">Data můžete ukládat mnoha různými způsoby, včetně textových souborů a tabulek.</span><span class="sxs-lookup"><span data-stu-id="17e0b-146">You can store data in lots of ways, including text files and spreadsheets.</span></span> <span data-ttu-id="17e0b-147">U většiny podnikových použití se ale data ukládají do relační databáze.</span><span class="sxs-lookup"><span data-stu-id="17e0b-147">For most business uses, though, data is stored in a relational database.</span></span>
> 
> <span data-ttu-id="17e0b-148">Tento článek se nevejde do databází velmi hluboko.</span><span class="sxs-lookup"><span data-stu-id="17e0b-148">This article doesn't go very deeply into databases.</span></span> <span data-ttu-id="17e0b-149">Může se ale stát, že si ho budete potřebovat trochu porozumět.</span><span class="sxs-lookup"><span data-stu-id="17e0b-149">However, you might find it useful to understand a little about them.</span></span> <span data-ttu-id="17e0b-150">V relační databázi jsou informace logicky rozděleny do samostatných tabulek.</span><span class="sxs-lookup"><span data-stu-id="17e0b-150">In a relational database, information is logically divided into separate tables.</span></span> <span data-ttu-id="17e0b-151">Například databáze pro školu může obsahovat samostatné tabulky pro studenty a pro nabídky tříd.</span><span class="sxs-lookup"><span data-stu-id="17e0b-151">For example, a database for a school might contain separate tables for students and for class offerings.</span></span> <span data-ttu-id="17e0b-152">Databázový software (například SQL Server) podporuje výkonné příkazy, které umožňují dynamicky navazovat relace mezi tabulkami.</span><span class="sxs-lookup"><span data-stu-id="17e0b-152">The database software (such as SQL Server) supports powerful commands that let you dynamically establish relationships between the tables.</span></span> <span data-ttu-id="17e0b-153">Relační databázi můžete například použít k vytvoření logického vztahu mezi studenty a třídami, aby bylo možné vytvořit plán.</span><span class="sxs-lookup"><span data-stu-id="17e0b-153">For example, you can use the relational database to establish a logical relationship between students and classes in order to create a schedule.</span></span> <span data-ttu-id="17e0b-154">Ukládání dat v samostatných tabulkách zkracuje složitost struktury tabulky a snižuje nutnost uchovávat redundantní data v tabulkách.</span><span class="sxs-lookup"><span data-stu-id="17e0b-154">Storing data in separate tables reduces the complexity of the table structure and reduces the need to keep redundant data in tables.</span></span>

## <a name="creating-a-database"></a><span data-ttu-id="17e0b-155">Vytvoření databáze</span><span class="sxs-lookup"><span data-stu-id="17e0b-155">Creating a Database</span></span>

<span data-ttu-id="17e0b-156">Tento postup popisuje, jak vytvořit databázi s názvem SmallBakery pomocí nástroje pro návrh databáze SQL Server Compact, který je součástí WebMatrixu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-156">This procedure shows you how to create a database named SmallBakery by using the SQL Server Compact Database design tool that's included in WebMatrix.</span></span> <span data-ttu-id="17e0b-157">I když můžete vytvořit databázi pomocí kódu, je obvyklejší vytvořit databázi a tabulky databáze pomocí nástroje pro návrh, jako je WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="17e0b-157">Although you can create a database using code, it's more typical to create the database and database tables using a design tool like WebMatrix.</span></span>

1. <span data-ttu-id="17e0b-158">Spusťte WebMatrix a na stránce rychlé zprovoznění klikněte na možnost **lokalita ze šablony**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-158">Start WebMatrix, and on the Quick Start page, click **Site From Template**.</span></span>
2. <span data-ttu-id="17e0b-159">Vyberte možnost **prázdný web**a do pole **název webu** zadejte "SmallBakery" a klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-159">Select **Empty Site**, and in the **Site Name** box enter "SmallBakery" and then click **OK**.</span></span> <span data-ttu-id="17e0b-160">Web se vytvoří a zobrazí ve WebMatrixu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-160">The site is created and displayed in WebMatrix.</span></span>
3. <span data-ttu-id="17e0b-161">V levém podokně klikněte na pracovní prostor **databáze** .</span><span class="sxs-lookup"><span data-stu-id="17e0b-161">In the left pane, click the **Databases** workspace.</span></span>
4. <span data-ttu-id="17e0b-162">Na pásu karet klikněte na možnost **Nová databáze**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-162">In the ribbon, click **New Database**.</span></span> <span data-ttu-id="17e0b-163">Vytvoří se prázdná databáze se stejným názvem, jako má vaše lokalita.</span><span class="sxs-lookup"><span data-stu-id="17e0b-163">An empty database is created with the same name as your site.</span></span>
5. <span data-ttu-id="17e0b-164">V levém podokně rozbalte uzel **SmallBakery. sdf** a klikněte na možnost **tabulky**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-164">In the left pane, expand the **SmallBakery.sdf** node and then click **Tables**.</span></span>
6. <span data-ttu-id="17e0b-165">Na pásu karet klikněte na možnost **Nová tabulka**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-165">In the ribbon, click **New Table**.</span></span> <span data-ttu-id="17e0b-166">WebMatrix otevře Návrháře tabulky.</span><span class="sxs-lookup"><span data-stu-id="17e0b-166">WebMatrix opens the table designer.</span></span>

    ![obrazu](5-working-with-data/_static/image1.jpg)
7. <span data-ttu-id="17e0b-168">Klikněte do sloupce **název** a zadejte &quot;ID&quot;.</span><span class="sxs-lookup"><span data-stu-id="17e0b-168">Click in the **Name** column and enter &quot;Id&quot;.</span></span>
8. <span data-ttu-id="17e0b-169">Ve sloupci **datový typ** vyberte **int**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-169">In the **Data Type** column, select **int**.</span></span>
9. <span data-ttu-id="17e0b-170">Nastavit **je primární klíč?** a **identifikovat?** možnosti **Ano**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-170">Set the **Is Primary Key?** and **Is Identify?** options to **Yes**.</span></span>

    <span data-ttu-id="17e0b-171">Jak název navrhuje, **má primární klíč** databázi, která bude představovat primární klíč tabulky.</span><span class="sxs-lookup"><span data-stu-id="17e0b-171">As the name suggests, **Is Primary Key** tells the database that this will be the table's primary key.</span></span> <span data-ttu-id="17e0b-172">**Označuje identitu** databázi, aby automaticky vytvořila identifikační číslo pro každý nový záznam a přiřadila mu další pořadové číslo (od 1).</span><span class="sxs-lookup"><span data-stu-id="17e0b-172">**Is Identity** tells the database to automatically create an ID number for every new record and to assign it the next sequential number (starting at 1).</span></span>
10. <span data-ttu-id="17e0b-173">Klikněte na další řádek.</span><span class="sxs-lookup"><span data-stu-id="17e0b-173">Click in the next row.</span></span> <span data-ttu-id="17e0b-174">Editor spustí novou definici sloupce.</span><span class="sxs-lookup"><span data-stu-id="17e0b-174">The editor starts a new column definition.</span></span>
11. <span data-ttu-id="17e0b-175">Jako hodnotu název zadejte &quot;název&quot;.</span><span class="sxs-lookup"><span data-stu-id="17e0b-175">For the Name value, enter &quot;Name&quot;.</span></span>
12. <span data-ttu-id="17e0b-176">V poli **datový typ**vyberte &quot;nvarchar&quot; a nastavte délku na 50.</span><span class="sxs-lookup"><span data-stu-id="17e0b-176">For **Data Type**, choose &quot;nvarchar&quot; and set the length to 50.</span></span> <span data-ttu-id="17e0b-177">*Var* část `nvarchar` oznamuje databázi, že data pro tento sloupec budou řetězcem, jehož velikost se může lišit od záznamu k záznamu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-177">The *var* part of `nvarchar` tells the database that the data for this column will be a string whose size might vary from record to record.</span></span> <span data-ttu-id="17e0b-178">(Předpona *n* představuje *národní*, což znamená, že pole může obsahovat znaková data, která představují jakýkoli abecední &#8212; nebo systém zápisu, který je, že pole obsahuje data ve formátu Unicode.)</span><span class="sxs-lookup"><span data-stu-id="17e0b-178">(The *n* prefix represents *national*, indicating that the field can hold character data that represents any alphabet or writing system &#8212; that is, that the field holds Unicode data.)</span></span>
13. <span data-ttu-id="17e0b-179">Nastavte možnost **povoluje hodnoty null** na **ne**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-179">Set the **Allow Nulls** option to **No**.</span></span> <span data-ttu-id="17e0b-180">Tím se vyhodnotí, že sloupec *název* nebude ponechán prázdný.</span><span class="sxs-lookup"><span data-stu-id="17e0b-180">This will enforce that the *Name* column is not left blank.</span></span>
14. <span data-ttu-id="17e0b-181">Pomocí stejného postupu vytvořte sloupec s názvem *Description*.</span><span class="sxs-lookup"><span data-stu-id="17e0b-181">Using this same process, create a column named *Description*.</span></span> <span data-ttu-id="17e0b-182">Nastavte **datový typ** na "nvarchar" a 50 na délku a nastavte hodnotu **povoleno null** na false.</span><span class="sxs-lookup"><span data-stu-id="17e0b-182">Set **Data Type** to "nvarchar" and 50 for the length, and set **Allow Nulls** to false.</span></span>
15. <span data-ttu-id="17e0b-183">Vytvořte sloupec s názvem *Price*.</span><span class="sxs-lookup"><span data-stu-id="17e0b-183">Create a column named *Price*.</span></span> <span data-ttu-id="17e0b-184">Nastavte **datový typ na peníze** a nastavte možnost **povoluje hodnoty null** na hodnotu NEPRAVDA.</span><span class="sxs-lookup"><span data-stu-id="17e0b-184">Set **Data Type to "money"** and set **Allow Nulls** to false.</span></span>
16. <span data-ttu-id="17e0b-185">Do pole v horní části pojmenujte tabulku &quot;&quot;produktu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-185">In the box at the top, name the table &quot;Product&quot;.</span></span>

    <span data-ttu-id="17e0b-186">Až budete hotovi, definice bude vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="17e0b-186">When you're done, the definition will look like this:</span></span>

    ![obrazu](5-working-with-data/_static/image2.png)
17. <span data-ttu-id="17e0b-188">Tabulku uložte stisknutím kombinace kláves CTRL + S.</span><span class="sxs-lookup"><span data-stu-id="17e0b-188">Press Ctrl+S to save the table.</span></span>

## <a name="adding-data-to-the-database"></a><span data-ttu-id="17e0b-189">Přidání dat do databáze</span><span class="sxs-lookup"><span data-stu-id="17e0b-189">Adding Data to the Database</span></span>

<span data-ttu-id="17e0b-190">Teď můžete do své databáze přidat ukázková data, která budete používat později v článku.</span><span class="sxs-lookup"><span data-stu-id="17e0b-190">Now you can add some sample data to your database that you'll work with later in the article.</span></span>

1. <span data-ttu-id="17e0b-191">V levém podokně rozbalte uzel **SmallBakery. sdf** a klikněte na možnost **tabulky**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-191">In the left pane, expand the **SmallBakery.sdf** node and then click **Tables**.</span></span>
2. <span data-ttu-id="17e0b-192">Klikněte pravým tlačítkem na tabulku produktů a pak klikněte na **data**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-192">Right-click the Product table and then click **Data**.</span></span>
3. <span data-ttu-id="17e0b-193">V podokně úprav zadejte následující záznamy:</span><span class="sxs-lookup"><span data-stu-id="17e0b-193">In the edit pane, enter the following records:</span></span>

    | <span data-ttu-id="17e0b-194">**Název**</span><span class="sxs-lookup"><span data-stu-id="17e0b-194">**Name**</span></span> | <span data-ttu-id="17e0b-195">**Popis**</span><span class="sxs-lookup"><span data-stu-id="17e0b-195">**Description**</span></span> | <span data-ttu-id="17e0b-196">**Cenové**</span><span class="sxs-lookup"><span data-stu-id="17e0b-196">**Price**</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="17e0b-197">Chléb</span><span class="sxs-lookup"><span data-stu-id="17e0b-197">Bread</span></span> | <span data-ttu-id="17e0b-198">Vloženými čerstvě každý den.</span><span class="sxs-lookup"><span data-stu-id="17e0b-198">Baked fresh every day.</span></span> | <span data-ttu-id="17e0b-199">2.99</span><span class="sxs-lookup"><span data-stu-id="17e0b-199">2.99</span></span> |
    | <span data-ttu-id="17e0b-200">Strawberry Shortcake</span><span class="sxs-lookup"><span data-stu-id="17e0b-200">Strawberry Shortcake</span></span> | <span data-ttu-id="17e0b-201">Provedená organická Jahoda z naší zahrady.</span><span class="sxs-lookup"><span data-stu-id="17e0b-201">Made with organic strawberries from our garden.</span></span> | <span data-ttu-id="17e0b-202">9.99</span><span class="sxs-lookup"><span data-stu-id="17e0b-202">9.99</span></span> |
    | <span data-ttu-id="17e0b-203">Výseč Apple</span><span class="sxs-lookup"><span data-stu-id="17e0b-203">Apple Pie</span></span> | <span data-ttu-id="17e0b-204">Druhý jenom k výsečovému diagramu vašeho MOM.</span><span class="sxs-lookup"><span data-stu-id="17e0b-204">Second only to your mom's pie.</span></span> | <span data-ttu-id="17e0b-205">12.99</span><span class="sxs-lookup"><span data-stu-id="17e0b-205">12.99</span></span> |
    | <span data-ttu-id="17e0b-206">Výsečový Pecan</span><span class="sxs-lookup"><span data-stu-id="17e0b-206">Pecan Pie</span></span> | <span data-ttu-id="17e0b-207">Pokud jste jako pecans, je to pro vás.</span><span class="sxs-lookup"><span data-stu-id="17e0b-207">If you like pecans, this is for you.</span></span> | <span data-ttu-id="17e0b-208">10.99</span><span class="sxs-lookup"><span data-stu-id="17e0b-208">10.99</span></span> |
    | <span data-ttu-id="17e0b-209">Výseč citronu</span><span class="sxs-lookup"><span data-stu-id="17e0b-209">Lemon Pie</span></span> | <span data-ttu-id="17e0b-210">S nejlepšími citrony, které jsou na světě.</span><span class="sxs-lookup"><span data-stu-id="17e0b-210">Made with the best lemons in the world.</span></span> | <span data-ttu-id="17e0b-211">11.99</span><span class="sxs-lookup"><span data-stu-id="17e0b-211">11.99</span></span> |
    | <span data-ttu-id="17e0b-212">Dortíky</span><span class="sxs-lookup"><span data-stu-id="17e0b-212">Cupcakes</span></span> | <span data-ttu-id="17e0b-213">Vaše děti a dítě se vám budou líbit.</span><span class="sxs-lookup"><span data-stu-id="17e0b-213">Your kids and the kid in you will love these.</span></span> | <span data-ttu-id="17e0b-214">7.99</span><span class="sxs-lookup"><span data-stu-id="17e0b-214">7.99</span></span> |

    <span data-ttu-id="17e0b-215">Nezapomeňte, že pro sloupec *ID* nemusíte nic zadávat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-215">Remember that you don't have to enter anything for the *Id* column.</span></span> <span data-ttu-id="17e0b-216">Když jste vytvořili sloupec *ID* , nastavíte jeho vlastnost **identity** na hodnotu true, což způsobí, že se automaticky vyplní.</span><span class="sxs-lookup"><span data-stu-id="17e0b-216">When you created the *Id* column, you set its **Is Identity** property to true, which causes it to automatically be filled in.</span></span>

    <span data-ttu-id="17e0b-217">Až skončíte s zadáváním dat, Návrhář tabulky bude vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="17e0b-217">When you're finished entering the data, the table designer will look like this:</span></span>

    ![obrazu](5-working-with-data/_static/image3.jpg)
4. <span data-ttu-id="17e0b-219">Zavřete kartu obsahující data databáze.</span><span class="sxs-lookup"><span data-stu-id="17e0b-219">Close the tab that contains the database data.</span></span>

## <a name="displaying-data-from-a-database"></a><span data-ttu-id="17e0b-220">Zobrazení dat z databáze</span><span class="sxs-lookup"><span data-stu-id="17e0b-220">Displaying Data from a Database</span></span>

<span data-ttu-id="17e0b-221">Jakmile získáte databázi s daty, můžete zobrazit data na webové stránce ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="17e0b-221">Once you've got a database with data in it, you can display the data in an ASP.NET web page.</span></span> <span data-ttu-id="17e0b-222">Pokud chcete vybrat řádky tabulky, které se mají zobrazit, použijte příkaz SQL, který je příkaz, který předáte do databáze.</span><span class="sxs-lookup"><span data-stu-id="17e0b-222">To select the table rows to display, you use a SQL statement, which is a command that you pass to the database.</span></span>

1. <span data-ttu-id="17e0b-223">V levém podokně klikněte na pracovní prostor **soubory** .</span><span class="sxs-lookup"><span data-stu-id="17e0b-223">In the left pane, click the **Files** workspace.</span></span>
2. <span data-ttu-id="17e0b-224">V kořenovém adresáři webu vytvořte novou stránku CSHTML s názvem *ListProducts. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="17e0b-224">In the root of the website, create a new CSHTML page named *ListProducts.cshtml*.</span></span>
3. <span data-ttu-id="17e0b-225">Existující značku nahraďte následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="17e0b-225">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample1.cshtml)]

    <span data-ttu-id="17e0b-226">V prvním bloku kódu otevřete soubor *SmallBakery. sdf* (databáze), který jste vytvořili dříve.</span><span class="sxs-lookup"><span data-stu-id="17e0b-226">In the first code block, you open the *SmallBakery.sdf* file (database) that you created earlier.</span></span> <span data-ttu-id="17e0b-227">Metoda `Database.Open` předpokládá, že soubor *. sdf* je ve složce *\_data aplikace* vašeho webu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-227">The `Database.Open` method assumes that the *.sdf* file is in your website's *App\_Data* folder.</span></span> <span data-ttu-id="17e0b-228">(Všimněte si, že ve skutečnosti nemusíte zadávat příponu &#8212; *. sdf* , pokud tak učiníte, nebude metoda `Open` fungovat.)</span><span class="sxs-lookup"><span data-stu-id="17e0b-228">(Notice that you don't need to specify the *.sdf* extension &#8212; in fact, if you do, the `Open` method won't work.)</span></span>

    > [!NOTE]
    > <span data-ttu-id="17e0b-229">Složka *App\_data* je speciální složkou v ASP.NET, která se používá k ukládání datových souborů.</span><span class="sxs-lookup"><span data-stu-id="17e0b-229">The *App\_Data* folder is a special folder in ASP.NET that's used to store data files.</span></span> <span data-ttu-id="17e0b-230">Další informace najdete v části [připojení k databázi](#SB_ConnectingToADatabase) dále v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="17e0b-230">For more information, see [Connecting to a Database](#SB_ConnectingToADatabase) later in this article.</span></span>

    <span data-ttu-id="17e0b-231">Pak vytvoříte žádost o dotazování databáze pomocí následujícího příkazu SQL `Select`:</span><span class="sxs-lookup"><span data-stu-id="17e0b-231">You then make a request to query the database using the following SQL `Select` statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample2.sql)]

    <span data-ttu-id="17e0b-232">V příkazu `Product` identifikuje tabulku pro dotaz.</span><span class="sxs-lookup"><span data-stu-id="17e0b-232">In the statement, `Product` identifies the table to query.</span></span> <span data-ttu-id="17e0b-233">Znak `*` určuje, že dotaz by měl vracet všechny sloupce z tabulky.</span><span class="sxs-lookup"><span data-stu-id="17e0b-233">The `*` character specifies that the query should return all the columns from the table.</span></span> <span data-ttu-id="17e0b-234">(Můžete také vypsat sloupce jednotlivě a oddělit je čárkami, pokud jste chtěli zobrazit pouze některé sloupce.) Klauzule `Order By` určuje, jak mají být data v tomto &#8212; případě seřazena podle sloupce *název* .</span><span class="sxs-lookup"><span data-stu-id="17e0b-234">(You could also list columns individually, separated by commas, if you wanted to see only some of the columns.) The `Order By` clause indicates how the data should be sorted &#8212; in this case, by the *Name* column.</span></span> <span data-ttu-id="17e0b-235">To znamená, že data jsou seřazená podle abecedy na základě hodnoty sloupce *název* pro každý řádek.</span><span class="sxs-lookup"><span data-stu-id="17e0b-235">This means that the data is sorted alphabetically based on the value of the *Name* column for each row.</span></span>

    <span data-ttu-id="17e0b-236">V těle stránky kód vytvoří tabulku HTML, která bude použita k zobrazení dat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-236">In the body of the page, the markup creates an HTML table that will be used to display the data.</span></span> <span data-ttu-id="17e0b-237">Uvnitř prvku `<tbody>` použijete smyčku `foreach` k samostatnému získání každého řádku dat, který je vrácen dotazem.</span><span class="sxs-lookup"><span data-stu-id="17e0b-237">Inside the `<tbody>` element, you use a `foreach` loop to individually get each data row that's returned by the query.</span></span> <span data-ttu-id="17e0b-238">Pro každý řádek dat vytvoříte řádek tabulky HTML (`<tr>` element).</span><span class="sxs-lookup"><span data-stu-id="17e0b-238">For each data row, you create an HTML table row (`<tr>` element).</span></span> <span data-ttu-id="17e0b-239">Pak vytvoříte buňky tabulky HTML (`<td>` elementy) pro každý sloupec.</span><span class="sxs-lookup"><span data-stu-id="17e0b-239">Then you create HTML table cells (`<td>` elements) for each column.</span></span> <span data-ttu-id="17e0b-240">Pokaždé, když projdete smyčku, je další dostupný řádek z databáze v proměnné `row` (nastavíte tuto hodnotu v příkazu `foreach`).</span><span class="sxs-lookup"><span data-stu-id="17e0b-240">Each time you go through the loop, the next available row from the database is in the `row` variable (you set this up in the `foreach` statement).</span></span> <span data-ttu-id="17e0b-241">Chcete-li získat z řádku jednotlivý sloupec, můžete použít `row.Name` nebo `row.Description` nebo jakýkoli název sloupce, který chcete.</span><span class="sxs-lookup"><span data-stu-id="17e0b-241">To get an individual column from the row, you can use `row.Name` or `row.Description` or whatever the name is of the column you want.</span></span>
4. <span data-ttu-id="17e0b-242">Spusťte stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="17e0b-242">Run the page in a browser.</span></span> <span data-ttu-id="17e0b-243">(Před spuštěním se ujistěte, že je stránka vybraná v pracovním prostoru **soubory** .) Na stránce se zobrazí seznam podobný následujícímu:</span><span class="sxs-lookup"><span data-stu-id="17e0b-243">(Make sure the page is selected in the **Files** workspace before you run it.) The page displays a list like the following:</span></span>

    ![obrazu](5-working-with-data/_static/image4.jpg)

> [!TIP] 
> 
> <span data-ttu-id="17e0b-245">**Jazyk SQL (Structured Query Language) (SQL)**</span><span class="sxs-lookup"><span data-stu-id="17e0b-245">**Structured Query Language (SQL)**</span></span>
> 
> <span data-ttu-id="17e0b-246">SQL je jazyk, který se používá ve většině relačních databází pro správu dat v databázi.</span><span class="sxs-lookup"><span data-stu-id="17e0b-246">SQL is a language that's used in most relational databases for managing data in a database.</span></span> <span data-ttu-id="17e0b-247">Obsahuje příkazy, které umožňují načíst data a aktualizovat je a umožňují vytvářet, upravovat a spravovat databázové tabulky.</span><span class="sxs-lookup"><span data-stu-id="17e0b-247">It includes commands that let you retrieve data and update it, and that let you create, modify, and manage database tables.</span></span> <span data-ttu-id="17e0b-248">SQL se liší od programovacího jazyka (jako je ten, který používáte ve WebMatrixu), protože v jazyce SQL je to, že databázi říkáte, co potřebujete, a je to úloha databáze, která ukazuje, jak získat data nebo provést úlohu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-248">SQL is different than a programming language (like the one you're using in WebMatrix) because with SQL, the idea is that you tell the database what you want, and it's the database's job to figure out how to get the data or perform the task.</span></span> <span data-ttu-id="17e0b-249">Tady jsou příklady některých příkazů SQL a jejich možnosti:</span><span class="sxs-lookup"><span data-stu-id="17e0b-249">Here are examples of some SQL commands and what they do:</span></span>
> 
> `SELECT Id, Name, Price FROM Product WHERE Price > 10.00 ORDER BY Name`
> 
> <span data-ttu-id="17e0b-250">Načte sloupce *ID*, *název*a *ceny* ze záznamů v tabulce *produktů* , pokud je hodnota *Price* větší než 10, a výsledky vrátí v abecedním pořadí podle hodnot sloupce *název* .</span><span class="sxs-lookup"><span data-stu-id="17e0b-250">This fetches the *Id*, *Name*, and *Price* columns from records in the *Product* table if the value of *Price* is more than 10, and returns the results in alphabetical order based on the values of the *Name* column.</span></span> <span data-ttu-id="17e0b-251">Tento příkaz vrátí sadu výsledků dotazu obsahující záznamy, které splňují kritéria, nebo prázdnou sadu, pokud žádné záznamy neodpovídají.</span><span class="sxs-lookup"><span data-stu-id="17e0b-251">This command will return a result set that contains the records that meet the criteria, or an empty set if no records match.</span></span>
> 
> `INSERT INTO Product (Name, Description, Price) VALUES ("Croissant", "A flaky delight", 1.99)`
> 
> <span data-ttu-id="17e0b-252">Tím se do tabulky *produkt* vloží nový záznam, ve sloupci *název* se &quot;croissant&quot;, sloupec *Description* , který &quot;&quot;světla, a cenu na 1,99.</span><span class="sxs-lookup"><span data-stu-id="17e0b-252">This inserts a new record into the *Product* table, setting the *Name* column to &quot;Croissant&quot;, the *Description* column to &quot;A flaky delight&quot;, and the price to 1.99.</span></span>
> 
> `DELETE FROM Product WHERE ExpirationDate < "01/01/2008"`
> 
> <span data-ttu-id="17e0b-253">Tento příkaz odstraní záznamy v tabulce *produktů* , jejichž sloupec Datum vypršení platnosti je starší než 1. ledna 2008.</span><span class="sxs-lookup"><span data-stu-id="17e0b-253">This command deletes records in the *Product* table whose expiration date column is earlier than January 1, 2008.</span></span> <span data-ttu-id="17e0b-254">(To předpokládá, že tabulka *produktu* má takový sloupec kurzu.) Datum je zadáno ve formátu MM/DD/RRRR, ale mělo by být zadáno ve formátu používaném pro vaše národní prostředí.</span><span class="sxs-lookup"><span data-stu-id="17e0b-254">(This assumes that the *Product* table has such a column, of course.) The date is entered here in MM/DD/YYYY format, but it should be entered in the format that's used for your locale.</span></span>
> 
> <span data-ttu-id="17e0b-255">Příkazy `Insert Into` a `Delete` nevrací sady výsledků dotazu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-255">The `Insert Into` and `Delete` commands don't return result sets.</span></span> <span data-ttu-id="17e0b-256">Místo toho vrátí číslo, které oznamuje, kolik záznamů bylo ovlivněno příkazem.</span><span class="sxs-lookup"><span data-stu-id="17e0b-256">Instead, they return a number that tells you how many records were affected by the command.</span></span>
> 
> <span data-ttu-id="17e0b-257">Pro některé z těchto operací (jako je vkládání a odstraňování záznamů) musí mít proces, který vyžaduje operaci, příslušná oprávnění v databázi.</span><span class="sxs-lookup"><span data-stu-id="17e0b-257">For some of these operations (like inserting and deleting records), the process that's requesting the operation has to have appropriate permissions in the database.</span></span> <span data-ttu-id="17e0b-258">To je důvod, proč v produkčních databázích, které často potřebujete při připojování k databázi zadávat uživatelské jméno a heslo.</span><span class="sxs-lookup"><span data-stu-id="17e0b-258">This is why for production databases you often have to supply a username and password when you connect to the database.</span></span>
> 
> <span data-ttu-id="17e0b-259">Existují spousty příkazů SQL, ale všechny mají stejný vzor jako to.</span><span class="sxs-lookup"><span data-stu-id="17e0b-259">There are dozens of SQL commands, but they all follow a pattern like this.</span></span> <span data-ttu-id="17e0b-260">Pomocí příkazů SQL můžete vytvořit tabulky databáze, spočítat počet záznamů v tabulce, vypočítat ceny a provádět spoustu dalších operací.</span><span class="sxs-lookup"><span data-stu-id="17e0b-260">You can use SQL commands to create database tables, count the number of records in a table, calculate prices, and perform many more operations.</span></span>

## <a name="inserting-data-in-a-database"></a><span data-ttu-id="17e0b-261">Vkládání dat do databáze</span><span class="sxs-lookup"><span data-stu-id="17e0b-261">Inserting Data in a Database</span></span>

<span data-ttu-id="17e0b-262">V této části se dozvíte, jak vytvořit stránku, která uživatelům umožňuje přidat nový produkt do tabulky databáze *produktu* .</span><span class="sxs-lookup"><span data-stu-id="17e0b-262">This section shows how to create a page that lets users add a new product to the *Product* database table.</span></span> <span data-ttu-id="17e0b-263">Po vložení nového záznamu produktu se na stránce zobrazí aktualizovaná tabulka pomocí stránky *ListProducts. cshtml* , kterou jste vytvořili v předchozí části.</span><span class="sxs-lookup"><span data-stu-id="17e0b-263">After a new product record is inserted, the page displays the updated table using the *ListProducts.cshtml* page that you created in the previous section.</span></span>

<span data-ttu-id="17e0b-264">Stránka obsahuje ověření, aby se zajistilo, že data, která uživatel zadá, jsou pro databázi platná.</span><span class="sxs-lookup"><span data-stu-id="17e0b-264">The page includes validation to make sure that the data that the user enters is valid for the database.</span></span> <span data-ttu-id="17e0b-265">Například kód na stránce zajistí, že byla zadána hodnota pro všechny požadované sloupce.</span><span class="sxs-lookup"><span data-stu-id="17e0b-265">For example, code in the page makes sure that a value has been entered for all required columns.</span></span>

1. <span data-ttu-id="17e0b-266">Na webu vytvořte nový soubor CSHTML s názvem *InsertProducts. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="17e0b-266">In the website, create a new CSHTML file named *InsertProducts.cshtml*.</span></span>
2. <span data-ttu-id="17e0b-267">Existující značku nahraďte následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="17e0b-267">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample3.cshtml)]

    <span data-ttu-id="17e0b-268">Tělo stránky obsahuje formulář HTML se třemi textovými poli, která umožní uživatelům zadat název, popis a cenu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-268">The body of the page contains an HTML form with three text boxes that let users enter a name, description, and price.</span></span> <span data-ttu-id="17e0b-269">Když uživatel klikne na tlačítko **Vložit** , otevře se kód v horní části stránky s připojením k databázi *SmallBakery. sdf* .</span><span class="sxs-lookup"><span data-stu-id="17e0b-269">When users click the **Insert** button, the code at the top of the page opens a connection to the *SmallBakery.sdf* database.</span></span> <span data-ttu-id="17e0b-270">Potom získáte hodnoty, které uživatel odeslal pomocí objektu `Request` a přiřadit tyto hodnoty lokálním proměnným.</span><span class="sxs-lookup"><span data-stu-id="17e0b-270">You then get the values that the user has submitted by using the `Request` object and assign those values to local variables.</span></span>

    <span data-ttu-id="17e0b-271">Chcete-li ověřit, zda uživatel zadal hodnotu pro každý požadovaný sloupec, zaregistrujte každý `<input>` prvek, který chcete ověřit:</span><span class="sxs-lookup"><span data-stu-id="17e0b-271">To validate that the user entered a value for each required column, you register each `<input>` element that you want to validate:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample4.cs)]

    <span data-ttu-id="17e0b-272">Pomocník `Validation` kontroluje, zda existuje hodnota v každém z polí, která jste zaregistrovali.</span><span class="sxs-lookup"><span data-stu-id="17e0b-272">The `Validation` helper checks that there is a value in each of the fields that you've registered.</span></span> <span data-ttu-id="17e0b-273">Můžete otestovat, jestli všechna pole prošla ověřením, a to tak, že zkontrolujete `Validation.IsValid()`, které obvykle provedete předtím, než budete zpracovávat informace, které dostanete od uživatele:</span><span class="sxs-lookup"><span data-stu-id="17e0b-273">You can test whether all the fields passed validation by checking `Validation.IsValid()`, which you typically do before you process the information you get from the user:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample5.cs)]

    <span data-ttu-id="17e0b-274">(Operátor `&&` znamená a – tento test je, *Pokud se jedná o odeslání formuláře a všechna pole prošla ověřením*.)</span><span class="sxs-lookup"><span data-stu-id="17e0b-274">(The `&&` operator means AND — this test is *If this is a form submission AND all the fields have passed validation*.)</span></span>

    <span data-ttu-id="17e0b-275">Pokud jsou všechny sloupce ověřené (žádné byly prázdné), můžete pokračovat a vytvořit příkaz SQL, který vloží data a pak ji spustit, jak je uvedeno dále:</span><span class="sxs-lookup"><span data-stu-id="17e0b-275">If all the columns validated (none were empty), you go ahead and create a SQL statement to insert the data and then execute it as shown next:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample6.cs)]

    <span data-ttu-id="17e0b-276">Pro hodnoty, které mají být vloženy, zahrnete zástupné symboly parametrů (`@0`, `@1`, `@2`).</span><span class="sxs-lookup"><span data-stu-id="17e0b-276">For the values to insert, you include parameter placeholders (`@0`, `@1`, `@2`).</span></span>

    > [!NOTE]
    > <span data-ttu-id="17e0b-277">Z důvodu zabezpečení je vždy nutné předat hodnoty příkazu SQL pomocí parametrů, jak vidíte v předchozím příkladu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-277">As a security precaution, always pass values to a SQL statement using parameters, as you see in the preceding example.</span></span> <span data-ttu-id="17e0b-278">To vám dává možnost ověřit data uživatele a pomáhá chránit před pokusy o odeslání škodlivých příkazů do vaší databáze (někdy označované jako útoky prostřednictvím injektáže SQL).</span><span class="sxs-lookup"><span data-stu-id="17e0b-278">This gives you a chance to validate the user's data, plus it helps protect against attempts to send malicious commands to your database (sometimes referred to as SQL injection attacks).</span></span>

    <span data-ttu-id="17e0b-279">Chcete-li spustit dotaz, použijte tento příkaz a předejte mu proměnné obsahující hodnoty, které mají být nahrazeny zástupnými symboly:</span><span class="sxs-lookup"><span data-stu-id="17e0b-279">To execute the query, you use this statement, passing to it the variables that contain the values to substitute for the placeholders:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample7.cs)]

    <span data-ttu-id="17e0b-280">Po provedení příkazu `Insert Into` odešlete uživateli stránku se seznamem produktů, které používají tento řádek:</span><span class="sxs-lookup"><span data-stu-id="17e0b-280">After the `Insert Into` statement has executed, you send the user to the page that lists the products using this line:</span></span>

    [!code-javascript[Main](5-working-with-data/samples/sample8.js)]

    <span data-ttu-id="17e0b-281">Pokud ověření nebylo úspěšné, přeskočíte vložení.</span><span class="sxs-lookup"><span data-stu-id="17e0b-281">If validation didn't succeed, you skip the insert.</span></span> <span data-ttu-id="17e0b-282">Místo toho máte na stránce pomocníka, kde můžete zobrazit nahromaděné chybové zprávy (pokud existují):</span><span class="sxs-lookup"><span data-stu-id="17e0b-282">Instead, you have a helper in the page that can display the accumulated error messages (if any):</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample9.cshtml)]

    <span data-ttu-id="17e0b-283">Všimněte si, že blok stylu v kódu obsahuje definici třídy CSS s názvem `.validation-summary-errors`.</span><span class="sxs-lookup"><span data-stu-id="17e0b-283">Notice that the style block in the markup includes a CSS class definition named `.validation-summary-errors`.</span></span> <span data-ttu-id="17e0b-284">Toto je název třídy šablony stylů CSS, která se používá ve výchozím nastavení pro element `<div>`, který obsahuje chyby ověřování.</span><span class="sxs-lookup"><span data-stu-id="17e0b-284">This is the name of the CSS class that's used by default for the `<div>` element that contains any validation errors.</span></span> <span data-ttu-id="17e0b-285">V tomto případě Třída CSS určuje, že chyby souhrnu ověření jsou zobrazeny červeně a tučně, ale můžete definovat třídu `.validation-summary-errors` pro zobrazení libovolného formátování, které chcete.</span><span class="sxs-lookup"><span data-stu-id="17e0b-285">In this case, the CSS class specifies that validation summary errors are displayed in red and in bold, but you can define the `.validation-summary-errors` class to display any formatting you like.</span></span>

### <a name="testing-the-insert-page"></a><span data-ttu-id="17e0b-286">Testování stránky pro vložení</span><span class="sxs-lookup"><span data-stu-id="17e0b-286">Testing the Insert Page</span></span>

1. <span data-ttu-id="17e0b-287">Zobrazit stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="17e0b-287">View the page in a browser.</span></span> <span data-ttu-id="17e0b-288">Na stránce se zobrazí formulář podobný tomu, který je zobrazený na následujícím obrázku.</span><span class="sxs-lookup"><span data-stu-id="17e0b-288">The page displays a form that's similar to the one that's shown in the following illustration.</span></span>

    ![obrazu](5-working-with-data/_static/image5.jpg)
2. <span data-ttu-id="17e0b-290">Zadejte hodnoty pro všechny sloupce, ale ujistěte se, že sloupec *Price* ponecháte prázdný.</span><span class="sxs-lookup"><span data-stu-id="17e0b-290">Enter values for all the columns, but make sure that you leave the *Price* column blank.</span></span>
3. <span data-ttu-id="17e0b-291">Klikněte na tlačítko **Vložit**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-291">Click **Insert**.</span></span> <span data-ttu-id="17e0b-292">Na stránce se zobrazí chybová zpráva, jak je znázorněno na následujícím obrázku.</span><span class="sxs-lookup"><span data-stu-id="17e0b-292">The page displays an error message, as shown in the following illustration.</span></span> <span data-ttu-id="17e0b-293">(Žádný nový záznam není vytvořen.)</span><span class="sxs-lookup"><span data-stu-id="17e0b-293">(No new record is created.)</span></span>

    ![obrazu](5-working-with-data/_static/image6.jpg)
4. <span data-ttu-id="17e0b-295">Vyplňte formulář úplně a pak klikněte na **Vložit**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-295">Fill the form out completely, and then click **Insert**.</span></span> <span data-ttu-id="17e0b-296">Tentokrát se zobrazí stránka *ListProducts. cshtml* a zobrazí se nový záznam.</span><span class="sxs-lookup"><span data-stu-id="17e0b-296">This time, the *ListProducts.cshtml* page is displayed and shows the new record.</span></span>

## <a name="updating-data-in-a-database"></a><span data-ttu-id="17e0b-297">Aktualizace dat v databázi</span><span class="sxs-lookup"><span data-stu-id="17e0b-297">Updating Data in a Database</span></span>

<span data-ttu-id="17e0b-298">Po zadání dat do tabulky může být nutné ji aktualizovat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-298">After data has been entered into a table, you might need to update it.</span></span> <span data-ttu-id="17e0b-299">Tento postup vám ukáže, jak vytvořit dvě stránky, které jsou podobné těm, které jste vytvořili pro předchozí vložení dat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-299">This procedure shows you how to create two pages that are similar to the ones you created for data insertion earlier.</span></span> <span data-ttu-id="17e0b-300">Na první stránce se zobrazí produkty, které uživatelům umožní vybrat jednu ke změně.</span><span class="sxs-lookup"><span data-stu-id="17e0b-300">The first page displays products and lets users select one to change.</span></span> <span data-ttu-id="17e0b-301">Druhá stránka umožňuje uživatelům provádět úpravy a ukládat je.</span><span class="sxs-lookup"><span data-stu-id="17e0b-301">The second page lets the users actually make the edits and save them.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="17e0b-302">**Důležité** informace Na produkčním webu je obvykle možné omezit, kdo může provádět změny dat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-302">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="17e0b-303">Informace o tom, jak nastavit členství a způsoby, jak autorizovat uživatele k provádění úloh na webu, najdete v tématu věnovaném [Přidání zabezpečení a členství na web webových stránek ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="17e0b-303">For information about how to set up membership and about ways to authorize users to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>

1. <span data-ttu-id="17e0b-304">Na webu vytvořte nový soubor CSHTML s názvem *EditProducts. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="17e0b-304">In the website, create a new CSHTML file named *EditProducts.cshtml*.</span></span>
2. <span data-ttu-id="17e0b-305">Nahraďte existující kód v souboru následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="17e0b-305">Replace the existing markup in the file with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample10.cshtml)]

    <span data-ttu-id="17e0b-306">Jediným rozdílem mezi touto stránkou a stránkou *ListProducts. cshtml* z předchozích verzí je, že tabulka HTML na této stránce obsahuje sloupec navíc, který zobrazuje odkaz pro **Úpravy** .</span><span class="sxs-lookup"><span data-stu-id="17e0b-306">The only difference between this page and the *ListProducts.cshtml* page from earlier is that the HTML table in this page includes an extra column that displays an **Edit** link.</span></span> <span data-ttu-id="17e0b-307">Po kliknutí na tento odkaz přejdete na stránku *UpdateProducts. cshtml* (kterou vytvoříte dále), kde můžete vybraný záznam upravit.</span><span class="sxs-lookup"><span data-stu-id="17e0b-307">When you click this link, it takes you to the *UpdateProducts.cshtml* page (which you'll create next) where you can edit the selected record.</span></span>

    <span data-ttu-id="17e0b-308">Podívejte se na kód, který vytvoří odkaz pro **Úpravy** :</span><span class="sxs-lookup"><span data-stu-id="17e0b-308">Look at the code that creates the **Edit** link:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample11.cshtml)]

    <span data-ttu-id="17e0b-309">Tím se vytvoří element HTML `<a>`, jehož atribut `href` je nastaven dynamicky.</span><span class="sxs-lookup"><span data-stu-id="17e0b-309">This creates an HTML `<a>` element whose `href` attribute is set dynamically.</span></span> <span data-ttu-id="17e0b-310">Atribut `href` Určuje stránku, která se zobrazí, když uživatel klikne na odkaz.</span><span class="sxs-lookup"><span data-stu-id="17e0b-310">The `href` attribute specifies the page to display when the user clicks the link.</span></span> <span data-ttu-id="17e0b-311">Také předává `Id` hodnotu aktuálního řádku na odkaz.</span><span class="sxs-lookup"><span data-stu-id="17e0b-311">It also passes the `Id` value of the current row to the link.</span></span> <span data-ttu-id="17e0b-312">Po spuštění stránky může zdroj stránky obsahovat odkazy, jako jsou tyto:</span><span class="sxs-lookup"><span data-stu-id="17e0b-312">When the page runs, the page source might contain links like these:</span></span>

    [!code-html[Main](5-working-with-data/samples/sample12.html)]

    <span data-ttu-id="17e0b-313">Všimněte si, že atribut `href` je nastaven na hodnotu `UpdateProducts/n`, kde *n* je číslo produktu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-313">Notice that the `href` attribute is set to `UpdateProducts/n`, where *n* is a product number.</span></span> <span data-ttu-id="17e0b-314">Když uživatel klikne na jeden z těchto odkazů, Výsledná adresa URL bude vypadat přibližně takto:</span><span class="sxs-lookup"><span data-stu-id="17e0b-314">When a user clicks one of these links, the resulting URL will look something like this:</span></span>

    `http://localhost:18816/UpdateProducts/6`

    <span data-ttu-id="17e0b-315">Jinými slovy, číslo produktu, které se má upravit, se předává v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="17e0b-315">In other words, the product number to be edited will be passed in the URL.</span></span>
3. <span data-ttu-id="17e0b-316">Zobrazit stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="17e0b-316">View the page in a browser.</span></span> <span data-ttu-id="17e0b-317">Stránka zobrazuje data v následujícím formátu:</span><span class="sxs-lookup"><span data-stu-id="17e0b-317">The page displays the data in a format like this:</span></span>

    ![obrazu](5-working-with-data/_static/image7.jpg)

    <span data-ttu-id="17e0b-319">V dalším kroku vytvoříte stránku, která umožní uživatelům data skutečně aktualizovat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-319">Next, you'll create the page that lets users actually update the data.</span></span> <span data-ttu-id="17e0b-320">Stránka aktualizace obsahuje ověření pro ověření dat, která uživatel zadal.</span><span class="sxs-lookup"><span data-stu-id="17e0b-320">The update page includes validation to validate the data that the user enters.</span></span> <span data-ttu-id="17e0b-321">Například kód na stránce zajistí, že byla zadána hodnota pro všechny požadované sloupce.</span><span class="sxs-lookup"><span data-stu-id="17e0b-321">For example, code in the page makes sure that a value has been entered for all required columns.</span></span>
4. <span data-ttu-id="17e0b-322">Na webu vytvořte nový soubor CSHTML s názvem *UpdateProducts. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="17e0b-322">In the website, create a new CSHTML file named *UpdateProducts.cshtml*.</span></span>
5. <span data-ttu-id="17e0b-323">Nahraďte existující kód v souboru následujícím kódem.</span><span class="sxs-lookup"><span data-stu-id="17e0b-323">Replace the existing markup in the file with the following.</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample13.cshtml)]

    <span data-ttu-id="17e0b-324">Tělo stránky obsahuje formulář HTML, ve kterém je zobrazený produkt a kde ho můžou uživatelé upravovat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-324">The body of the page contains an HTML form where a product is displayed and where users can edit it.</span></span> <span data-ttu-id="17e0b-325">Chcete-li získat produkt, který chcete zobrazit, použijte tento příkaz SQL:</span><span class="sxs-lookup"><span data-stu-id="17e0b-325">To get the product to display, you use this SQL statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample14.sql)]

    <span data-ttu-id="17e0b-326">Tím se vybere produkt, jehož ID odpovídá hodnotě předané v parametru `@0`.</span><span class="sxs-lookup"><span data-stu-id="17e0b-326">This will select the product whose ID matches the value that's passed in the `@0` parameter.</span></span> <span data-ttu-id="17e0b-327">(Vzhledem k tomu, že *ID* je primární klíč, a proto musí být jedinečný, může být vždy vybrán pouze jeden záznam produktu.) Chcete-li získat hodnotu ID, která bude předána tomuto příkazu `Select`, můžete načíst hodnotu, která je předána stránce jako součást adresy URL, pomocí následující syntaxe:</span><span class="sxs-lookup"><span data-stu-id="17e0b-327">(Because *Id* is the primary key and therefore must be unique, only one product record can ever be selected this way.) To get the ID value to pass to this `Select` statement, you can read the value that's passed to the page as part of the URL, using the following syntax:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample15.cs)]

    <span data-ttu-id="17e0b-328">Chcete-li skutečně načíst záznam produktu, použijte metodu `QuerySingle`, která vrátí pouze jeden záznam:</span><span class="sxs-lookup"><span data-stu-id="17e0b-328">To actually fetch the product record, you use the `QuerySingle` method, which will return just one record:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample16.cs)]

    <span data-ttu-id="17e0b-329">Jeden řádek se vrátí do proměnné `row`.</span><span class="sxs-lookup"><span data-stu-id="17e0b-329">The single row is returned into the `row` variable.</span></span> <span data-ttu-id="17e0b-330">Data můžete získat z každého sloupce a přiřadit je k místním proměnným, jako je:</span><span class="sxs-lookup"><span data-stu-id="17e0b-330">You can get data out of each column and assign it to local variables like this:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample17.cs)]

    <span data-ttu-id="17e0b-331">Ve značkách pro formulář se tyto hodnoty zobrazují automaticky v jednotlivých textových polích pomocí vloženého kódu, jako je následující:</span><span class="sxs-lookup"><span data-stu-id="17e0b-331">In the markup for the form, these values are displayed automatically in individual text boxes by using embedded code like the following:</span></span>

    [!code-html[Main](5-working-with-data/samples/sample18.html)]

    <span data-ttu-id="17e0b-332">Tato část kódu zobrazuje záznam produktu, který se má aktualizovat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-332">That part of the code displays the product record to be updated.</span></span> <span data-ttu-id="17e0b-333">Po zobrazení záznamu může uživatel upravovat jednotlivé sloupce.</span><span class="sxs-lookup"><span data-stu-id="17e0b-333">Once the record has been displayed, the user can edit individual columns.</span></span>

    <span data-ttu-id="17e0b-334">Když uživatel formulář odešle kliknutím na tlačítko **aktualizovat** , spustí se kód v bloku `if(IsPost)`.</span><span class="sxs-lookup"><span data-stu-id="17e0b-334">When the user submits the form by clicking the **Update** button, the code in the `if(IsPost)` block runs.</span></span> <span data-ttu-id="17e0b-335">Tím se získá hodnoty uživatele z objektu `Request`, uloží hodnoty do proměnných a ověří, že každý sloupec byl vyplněn.</span><span class="sxs-lookup"><span data-stu-id="17e0b-335">This gets the user's values from the `Request` object, stores the values in variables, and validates that each column has been filled in.</span></span> <span data-ttu-id="17e0b-336">Pokud ověření projde, kód vytvoří následující příkaz SQL Update:</span><span class="sxs-lookup"><span data-stu-id="17e0b-336">If validation passes, the code creates the following SQL Update statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample19.sql)]

    <span data-ttu-id="17e0b-337">V příkazu SQL `Update` zadáte každý sloupec, který se má aktualizovat, a hodnotu, na kterou se má nastavit.</span><span class="sxs-lookup"><span data-stu-id="17e0b-337">In a SQL `Update` statement, you specify each column to update and the value to set it to.</span></span> <span data-ttu-id="17e0b-338">V tomto kódu jsou hodnoty zadány pomocí zástupných symbolů parametrů `@0`, `@1`, `@2`a tak dále.</span><span class="sxs-lookup"><span data-stu-id="17e0b-338">In this code, the values are specified using the parameter placeholders `@0`, `@1`, `@2`, and so on.</span></span> <span data-ttu-id="17e0b-339">(Jak bylo uvedeno dříve, z důvodu zabezpečení byste měli vždy předat hodnoty příkazu SQL pomocí parametrů.)</span><span class="sxs-lookup"><span data-stu-id="17e0b-339">(As noted earlier, for security, you should always pass values to a SQL statement by using parameters.)</span></span>

    <span data-ttu-id="17e0b-340">Při volání metody `db.Execute` předáte proměnné, které obsahují hodnoty v pořadí, které odpovídá parametrům v příkazu SQL:</span><span class="sxs-lookup"><span data-stu-id="17e0b-340">When you call the `db.Execute` method, you pass the variables that contain the values in the order that corresponds to the parameters in the SQL statement:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample20.cs)]

    <span data-ttu-id="17e0b-341">Po provedení příkazu `Update` zavoláte následující metodu, aby se uživatel přesměroval zpátky na stránku pro úpravy:</span><span class="sxs-lookup"><span data-stu-id="17e0b-341">After the `Update` statement has been executed, you call the following method in order to redirect the user back to the edit page:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample21.cshtml)]

    <span data-ttu-id="17e0b-342">Efekt je, že uživatel uvidí aktualizovaný výpis dat v databázi a může upravit jiný produkt.</span><span class="sxs-lookup"><span data-stu-id="17e0b-342">The effect is that the user sees an updated listing of the data in the database and can edit another product.</span></span>
6. <span data-ttu-id="17e0b-343">Uložte stránku.</span><span class="sxs-lookup"><span data-stu-id="17e0b-343">Save the page.</span></span>
7. <span data-ttu-id="17e0b-344">Spusťte stránku *EditProducts. cshtml* (ne stránku aktualizace) a pak klikněte na **Upravit** a vyberte produkt, který chcete upravit.</span><span class="sxs-lookup"><span data-stu-id="17e0b-344">Run the *EditProducts.cshtml* page (not the update page) and then click **Edit** to select a product to edit.</span></span> <span data-ttu-id="17e0b-345">Zobrazí se stránka *UpdateProducts. cshtml* , která zobrazuje vybraný záznam.</span><span class="sxs-lookup"><span data-stu-id="17e0b-345">The *UpdateProducts.cshtml* page is displayed, showing the record you selected.</span></span>

    ![obrazu](5-working-with-data/_static/image8.jpg)
8. <span data-ttu-id="17e0b-347">Proveďte změnu a klikněte na **aktualizovat**.</span><span class="sxs-lookup"><span data-stu-id="17e0b-347">Make a change and click **Update**.</span></span> <span data-ttu-id="17e0b-348">Seznam produktů se znovu zobrazuje s aktualizovanými daty.</span><span class="sxs-lookup"><span data-stu-id="17e0b-348">The products list is shown again with your updated data.</span></span>

## <a name="deleting-data-in-a-database"></a><span data-ttu-id="17e0b-349">Odstraňování dat v databázi</span><span class="sxs-lookup"><span data-stu-id="17e0b-349">Deleting Data in a Database</span></span>

<span data-ttu-id="17e0b-350">V této části se dozvíte, jak umožnit uživatelům odstranit produkt z tabulky databáze *produktu* .</span><span class="sxs-lookup"><span data-stu-id="17e0b-350">This section shows how to let users delete a product from the *Product* database table.</span></span> <span data-ttu-id="17e0b-351">Příklad se skládá ze dvou stránek.</span><span class="sxs-lookup"><span data-stu-id="17e0b-351">The example consists of two pages.</span></span> <span data-ttu-id="17e0b-352">Na první stránce Uživatelé vyberou záznam, který chcete odstranit.</span><span class="sxs-lookup"><span data-stu-id="17e0b-352">In the first page, users select a record to delete.</span></span> <span data-ttu-id="17e0b-353">Záznam, který se má odstranit, se pak zobrazí na druhé stránce, která jim umožní potvrdit, že chce záznam odstranit.</span><span class="sxs-lookup"><span data-stu-id="17e0b-353">The record to be deleted is then displayed in a second page that lets them confirm that they want to delete the record.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="17e0b-354">**Důležité** informace Na produkčním webu je obvykle možné omezit, kdo může provádět změny dat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-354">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="17e0b-355">Informace o tom, jak nastavit členství a způsoby, jak autorizovat uživatele k provádění úloh na webu, najdete v tématu věnovaném [Přidání zabezpečení a členství na web webových stránek ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="17e0b-355">For information about how to set up membership and about ways to authorize user to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>

1. <span data-ttu-id="17e0b-356">Na webu vytvořte nový soubor CSHTML s názvem *ListProductsForDelete. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="17e0b-356">In the website, create a new CSHTML file named *ListProductsForDelete.cshtml*.</span></span>
2. <span data-ttu-id="17e0b-357">Existující značku nahraďte následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="17e0b-357">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample22.cshtml)]

    <span data-ttu-id="17e0b-358">Tato stránka se podobá stránce *EditProducts. cshtml* ze starší verze.</span><span class="sxs-lookup"><span data-stu-id="17e0b-358">This page is similar to the *EditProducts.cshtml* page from earlier.</span></span> <span data-ttu-id="17e0b-359">Namísto zobrazení odkazu pro **Úpravy** každého produktu se ale zobrazí odkaz **Odstranit** .</span><span class="sxs-lookup"><span data-stu-id="17e0b-359">However, instead of displaying an **Edit** link for each product, it displays a **Delete** link.</span></span> <span data-ttu-id="17e0b-360">Odkaz **Delete** je vytvořen pomocí následujícího vloženého kódu v kódu:</span><span class="sxs-lookup"><span data-stu-id="17e0b-360">The **Delete** link is created using the following embedded code in the markup:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample23.cshtml)]

    <span data-ttu-id="17e0b-361">Tím se vytvoří adresa URL, která vypadá takto: když uživatel klikne na odkaz:</span><span class="sxs-lookup"><span data-stu-id="17e0b-361">This creates a URL that looks like this when users click the link:</span></span>

    `http://<server>/DeleteProduct/4`

    <span data-ttu-id="17e0b-362">Adresa URL volá stránku s názvem *DeleteProduct. cshtml* (kterou vytvoříte dále) a předá jí ID produktu, který chcete odstranit (zde 4).</span><span class="sxs-lookup"><span data-stu-id="17e0b-362">The URL calls a page named *DeleteProduct.cshtml* (which you'll create next) and passes it the ID of the product to delete (here, 4).</span></span>
3. <span data-ttu-id="17e0b-363">Uložte soubor, ale nechte ho otevřený.</span><span class="sxs-lookup"><span data-stu-id="17e0b-363">Save the file, but leave it open.</span></span>
4. <span data-ttu-id="17e0b-364">Vytvořte další soubor CHTML s názvem *DeleteProduct. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="17e0b-364">Create another CHTML file named *DeleteProduct.cshtml*.</span></span> <span data-ttu-id="17e0b-365">Existující obsah nahraďte následujícím:</span><span class="sxs-lookup"><span data-stu-id="17e0b-365">Replace the existing content with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample24.cshtml)]

    <span data-ttu-id="17e0b-366">Tuto stránku volá *ListProductsForDelete. cshtml* a umožňuje uživatelům potvrdit, že chtějí odstranit produkt.</span><span class="sxs-lookup"><span data-stu-id="17e0b-366">This page is called by *ListProductsForDelete.cshtml* and lets users confirm that they want to delete a product.</span></span> <span data-ttu-id="17e0b-367">Pokud chcete vypsat produkt, který se má odstranit, získáte ID produktu, který se má odstranit z adresy URL, a to pomocí následujícího kódu:</span><span class="sxs-lookup"><span data-stu-id="17e0b-367">To list the product to be deleted, you get the ID of the product to delete from the URL using the following code:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample25.cs)]

    <span data-ttu-id="17e0b-368">Stránka pak vyzve uživatele, aby kliknutím na tlačítko skutečně odstranil záznam.</span><span class="sxs-lookup"><span data-stu-id="17e0b-368">The page then asks the user to click a button to actually delete the record.</span></span> <span data-ttu-id="17e0b-369">Toto je důležité bezpečnostní opatření: když na webu provedete citlivé operace, jako je aktualizace nebo odstranění dat, měly by se tyto operace vždy provádět pomocí operace POST, nikoli operace GET.</span><span class="sxs-lookup"><span data-stu-id="17e0b-369">This is an important security measure: when you perform sensitive operations in your website like updating or deleting data, these operations should always be done using a POST operation, not a GET operation.</span></span> <span data-ttu-id="17e0b-370">Pokud je vaše lokalita nastavená tak, aby operace odstranění mohla probíhat pomocí operace GET, může kdokoli předat adresu URL, jako je `http://<server>/DeleteProduct/4`, a z databáze odstranit cokoli, co chtějí.</span><span class="sxs-lookup"><span data-stu-id="17e0b-370">If your site is set up so that a delete operation can be performed using a GET operation, anyone can pass a URL like `http://<server>/DeleteProduct/4` and delete anything they want from your database.</span></span> <span data-ttu-id="17e0b-371">Přidáním potvrzení a kódováním stránky, aby bylo možné provést odstranění pouze pomocí příspěvku, přidáte míru zabezpečení na web.</span><span class="sxs-lookup"><span data-stu-id="17e0b-371">By adding the confirmation and coding the page so that the deletion can be performed only by using a POST, you add a measure of security to your site.</span></span>

    <span data-ttu-id="17e0b-372">Skutečná operace odstranění se provádí pomocí následujícího kódu, který nejprve potvrdí, že se jedná o operaci post a že ID není prázdné:</span><span class="sxs-lookup"><span data-stu-id="17e0b-372">The actual delete operation is performed using the following code, which first confirms that this is a post operation and that the ID isn't empty:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample26.cs)]

    <span data-ttu-id="17e0b-373">Kód spustí příkaz SQL, který odstraní zadaný záznam a pak přesměruje uživatele zpět na stránku výpisu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-373">The code runs a SQL statement that deletes the specified record and then redirects the user back to the listing page.</span></span>
5. <span data-ttu-id="17e0b-374">Spusťte *ListProductsForDelete. cshtml* v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="17e0b-374">Run *ListProductsForDelete.cshtml* in a browser.</span></span>

    ![obrazu](5-working-with-data/_static/image9.jpg)
6. <span data-ttu-id="17e0b-376">Klikněte na odkaz **Odstranit** pro jeden z produktů.</span><span class="sxs-lookup"><span data-stu-id="17e0b-376">Click the **Delete** link for one of the products.</span></span> <span data-ttu-id="17e0b-377">Zobrazí se stránka *DeleteProduct. cshtml* , která potvrdí, že chcete záznam odstranit.</span><span class="sxs-lookup"><span data-stu-id="17e0b-377">The *DeleteProduct.cshtml* page is displayed to confirm that you want to delete that record.</span></span>
7. <span data-ttu-id="17e0b-378">Klikněte na tlačítko **Odstranit** .</span><span class="sxs-lookup"><span data-stu-id="17e0b-378">Click the **Delete** button.</span></span> <span data-ttu-id="17e0b-379">Záznam produktu je odstraněn a stránka je aktualizována aktualizovaným seznamem produktů.</span><span class="sxs-lookup"><span data-stu-id="17e0b-379">The product record is deleted and the page is refreshed with an updated product listing.</span></span>

> [!TIP]
> 
> <a id="SB_ConnectingToADatabase"></a>
> ### <a name="connecting-to-a-database"></a><span data-ttu-id="17e0b-380">Připojení k databázi</span><span class="sxs-lookup"><span data-stu-id="17e0b-380">Connecting to a Database</span></span>
> 
> <span data-ttu-id="17e0b-381">K databázi se můžete připojit dvěma způsoby.</span><span class="sxs-lookup"><span data-stu-id="17e0b-381">You can connect to a database in two ways.</span></span> <span data-ttu-id="17e0b-382">Nejprve je třeba použít metodu `Database.Open` a zadat název souboru databáze (menší přípona *. sdf* ):</span><span class="sxs-lookup"><span data-stu-id="17e0b-382">The first is to use the `Database.Open` method and to specify the name of the database file (less the *.sdf* extension):</span></span>
> 
> `var db = Database.Open("SmallBakery");`
> 
> <span data-ttu-id="17e0b-383">Metoda `Open` předpokládá, že. soubor *SDF* se nachází ve složce *dat\_App* webu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-383">The `Open` method assumes that the .*sdf* file is in the website's *App\_Data* folder.</span></span> <span data-ttu-id="17e0b-384">Tato složka je určená speciálně pro uchovávání dat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-384">This folder is designed specifically for holding data.</span></span> <span data-ttu-id="17e0b-385">Například má příslušná oprávnění, aby mohl web číst a zapisovat data a jako bezpečnostní opatření nepovoluje WebMatrix přístup k souborům z této složky.</span><span class="sxs-lookup"><span data-stu-id="17e0b-385">For example, it has appropriate permissions to allow the website to read and write data, and as a security measure, WebMatrix does not allow access to files from this folder.</span></span>
> 
> <span data-ttu-id="17e0b-386">Druhým způsobem je použití připojovacího řetězce.</span><span class="sxs-lookup"><span data-stu-id="17e0b-386">The second way is to use a connection string.</span></span> <span data-ttu-id="17e0b-387">Připojovací řetězec obsahuje informace o tom, jak se připojit k databázi.</span><span class="sxs-lookup"><span data-stu-id="17e0b-387">A connection string contains information about how to connect to a database.</span></span> <span data-ttu-id="17e0b-388">To může zahrnovat cestu k souboru nebo může obsahovat název SQL Server databáze na místním nebo vzdáleném serveru spolu s uživatelským jménem a heslem pro připojení k tomuto serveru.</span><span class="sxs-lookup"><span data-stu-id="17e0b-388">This can include a file path, or it can include the name of a SQL Server database on a local or remote server, along with a user name and password to connect to that server.</span></span> <span data-ttu-id="17e0b-389">(Pokud zachováte data v centrálně spravované verzi SQL Server, jako je například na webu poskytovatele hostingu, vždy pomocí připojovacího řetězce určete informace o připojení databáze.)</span><span class="sxs-lookup"><span data-stu-id="17e0b-389">(If you keep data in a centrally managed version of SQL Server, such as on a hosting provider's site, you always use a connection string to specify the database connection information.)</span></span>
> 
> <span data-ttu-id="17e0b-390">Ve WebMatrixu se připojovací řetězce obvykle ukládají do souboru XML s názvem *Web. config*. Jak název napovídá, můžete použít soubor *Web. config* v kořenovém adresáři webu k uložení informací o konfiguraci lokality včetně všech připojovacích řetězců, které může váš web vyžadovat.</span><span class="sxs-lookup"><span data-stu-id="17e0b-390">In WebMatrix, connection strings are usually stored in an XML file named *Web.config*. As the name implies, you can use a *Web.config* file in the root of your website to store the site's configuration information, including any connection strings that your site might require.</span></span> <span data-ttu-id="17e0b-391">Příklad připojovacího řetězce v souboru *Web. config* může vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="17e0b-391">An example of a connection string in a *Web.config* file might look like the following:</span></span>
> 
> [!code-xml[Main](5-working-with-data/samples/sample27.xml)]
> 
> <span data-ttu-id="17e0b-392">V tomto příkladu připojovací řetězec odkazuje na databázi v instanci SQL Server, která běží na serveru někam (na rozdíl od místního souboru *. sdf* ).</span><span class="sxs-lookup"><span data-stu-id="17e0b-392">In the example, the connection string points to a database in an instance of SQL Server that's running on a server somewhere (as opposed to a local *.sdf* file).</span></span> <span data-ttu-id="17e0b-393">Museli byste nahradit vhodné názvy `myServer` a `myDatabase`a zadat SQL Server přihlašovací hodnoty pro `username` a `password`.</span><span class="sxs-lookup"><span data-stu-id="17e0b-393">You would need to substitute the appropriate names for `myServer` and `myDatabase`, and specify SQL Server login values for `username` and `password`.</span></span> <span data-ttu-id="17e0b-394">(Uživatelské jméno a heslo nejsou nutně stejné jako vaše přihlašovací údaje systému Windows nebo jako hodnoty, které vám poskytovatel hostingu udělil pro přihlášení ke svým serverům.</span><span class="sxs-lookup"><span data-stu-id="17e0b-394">(The username and password values are not necessarily the same as your Windows credentials or as the values that your hosting provider has given you for logging in to their servers.</span></span> <span data-ttu-id="17e0b-395">Požádejte správce o přesné hodnoty, které potřebujete.)</span><span class="sxs-lookup"><span data-stu-id="17e0b-395">Check with the administrator for the exact values you need.)</span></span>
> 
> <span data-ttu-id="17e0b-396">Metoda `Database.Open` je flexibilní, protože umožňuje předat buď název souboru databáze *. sdf* , nebo název připojovacího řetězce, který je uložený v souboru *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="17e0b-396">The `Database.Open` method is flexible, because it lets you pass either the name of a database *.sdf* file or the name of a connection string that's stored in the *Web.config* file.</span></span> <span data-ttu-id="17e0b-397">Následující příklad ukazuje, jak se připojit k databázi pomocí připojovacího řetězce, který je znázorněn v předchozím příkladu:</span><span class="sxs-lookup"><span data-stu-id="17e0b-397">The following example shows how to connect to the database using the connection string illustrated in the previous example:</span></span>
> 
> [!code-cshtml[Main](5-working-with-data/samples/sample28.cshtml)]
> 
> <span data-ttu-id="17e0b-398">Jak je uvedeno, metoda `Database.Open` umožňuje předat buď název databáze, nebo připojovací řetězec a určí, která se má použít.</span><span class="sxs-lookup"><span data-stu-id="17e0b-398">As noted, the `Database.Open` method lets you pass either a database name or a connection string, and it'll figure out which to use.</span></span> <span data-ttu-id="17e0b-399">To je velmi užitečné při nasazení (publikování) webu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-399">This is very useful when you deploy (publish) your website.</span></span> <span data-ttu-id="17e0b-400">Při vývoji a testování webu můžete použít soubor *. sdf* ve složce *App\_data* .</span><span class="sxs-lookup"><span data-stu-id="17e0b-400">You can use an *.sdf* file in the *App\_Data* folder when you're developing and testing your site.</span></span> <span data-ttu-id="17e0b-401">Pak když přesunete lokalitu na provozní server, můžete použít připojovací řetězec v souboru *Web. config* , který má stejný název jako soubor *. sdf* , ale který odkazuje na databázi &#8212; poskytovatele hostingu bez nutnosti změny kódu.</span><span class="sxs-lookup"><span data-stu-id="17e0b-401">Then when you move your site to a production server, you can use a connection string in the *Web.config* file that has the same name as your *.sdf* file but that points to the hosting provider's database &#8212; all without having to change your code.</span></span>
> 
> <span data-ttu-id="17e0b-402">Nakonec, pokud chcete pracovat přímo s připojovacím řetězcem, můžete zavolat metodu `Database.OpenConnectionString` a předat jí skutečný připojovací řetězec místo pouze název jednoho v souboru *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="17e0b-402">Finally, if you want to work directly with a connection string, you can call the `Database.OpenConnectionString` method and pass it the actual connection string instead of just the name of one in the *Web.config* file.</span></span> <span data-ttu-id="17e0b-403">To může být užitečné v situacích, kdy z nějakého důvodu nemáte přístup k připojovacímu řetězci (nebo k hodnotám, jako je název souboru *. sdf* ), dokud nebude stránka spuštěna.</span><span class="sxs-lookup"><span data-stu-id="17e0b-403">This might be useful in situations where for some reason you don't have access to the connection string (or values in it, such as the *.sdf* file name) until the page is running.</span></span> <span data-ttu-id="17e0b-404">Ve většině scénářů ale můžete použít `Database.Open`, jak je popsáno v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="17e0b-404">However, for most scenarios, you can use `Database.Open` as described in this article.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="17e0b-405">Další prostředky</span><span class="sxs-lookup"><span data-stu-id="17e0b-405">Additional Resources</span></span>

- [<span data-ttu-id="17e0b-406">SQL Server Compact</span><span class="sxs-lookup"><span data-stu-id="17e0b-406">SQL Server Compact</span></span>](https://www.microsoft.com/sqlserver/2008/en/us/compact.aspx)
- [<span data-ttu-id="17e0b-407">Připojení k databázi SQL Server nebo MySQL ve WebMatrixu</span><span class="sxs-lookup"><span data-stu-id="17e0b-407">Connecting to a SQL Server or MySQL Database in WebMatrix</span></span>](https://go.microsoft.com/fwlink/?LinkId=208661)
- [<span data-ttu-id="17e0b-408">Ověřování uživatelských vstupů na webech s webovými stránkami ASP.NET</span><span class="sxs-lookup"><span data-stu-id="17e0b-408">Validating User Input in ASP.NET Web Pages Sites</span></span>](https://go.microsoft.com/fwlink/?LinkId=253002)
