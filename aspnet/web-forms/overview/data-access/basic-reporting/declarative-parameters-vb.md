---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: Deklarativní parametry (VB) | Microsoft Docs
author: rick-anderson
description: V tomto kurzu ukážeme, jak použít parametr nastavený na pevně zakódované hodnoty pro výběr dat, která se mají zobrazit v ovládacím prvku DetailsView.
ms.author: riande
ms.date: 03/31/2010
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: cdc42752fc78d18366af037a81fe4ebe5a1646ef
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/28/2019
ms.locfileid: "74612899"
---
# <a name="declarative-parameters-vb"></a><span data-ttu-id="6519f-103">Deklarované parametry (VB)</span><span class="sxs-lookup"><span data-stu-id="6519f-103">Declarative Parameters (VB)</span></span>

<span data-ttu-id="6519f-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6519f-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6519f-105">[Stáhnout ukázkovou aplikaci](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) nebo [Stáhnout PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="6519f-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="6519f-106">V tomto kurzu ukážeme, jak použít parametr nastavený na pevně zakódované hodnoty pro výběr dat, která se mají zobrazit v ovládacím prvku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="6519f-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>

## <a name="introduction"></a><span data-ttu-id="6519f-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="6519f-107">Introduction</span></span>

<span data-ttu-id="6519f-108">V [posledním kurzu](displaying-data-with-the-objectdatasource-vb.md) jsme se prohlédli při zobrazování dat pomocí ovládacích prvků GridView, DetailsView a FormView vázaných na ovládací prvek ObjectDataSource, který vyvolal metodu `GetProducts()` z `ProductsBLL` třídy.</span><span class="sxs-lookup"><span data-stu-id="6519f-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="6519f-109">Metoda `GetProducts()` vrátí DataTable se silným typem, který se naplní všemi záznamy z tabulky `Products` databáze Northwind.</span><span class="sxs-lookup"><span data-stu-id="6519f-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="6519f-110">Třída `ProductsBLL` obsahuje další metody pro vrácení pouze podmnožiny produktů – `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`a `GetProductsBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="6519f-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="6519f-111">Tyto tři metody očekávají vstupní parametr, který určuje, jak filtrovat vrácené informace o produktu.</span><span class="sxs-lookup"><span data-stu-id="6519f-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="6519f-112">Prvek ObjectDataSource lze použít k vyvolání metod, které očekávají vstupní parametry, ale v takovém případě je nutné specifikovat, kde hodnoty pro tyto parametry pocházejí.</span><span class="sxs-lookup"><span data-stu-id="6519f-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="6519f-113">Hodnoty parametrů mohou být pevně zakódované nebo mohou pocházet z nejrůznějších dynamických zdrojů, včetně hodnot QueryString, proměnných relací, hodnoty vlastnosti webového ovládacího prvku na stránce nebo jiné.</span><span class="sxs-lookup"><span data-stu-id="6519f-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="6519f-114">V tomto kurzu začneme tím, že ukážeme, jak použít parametr nastavený na pevně zakódované hodnoty.</span><span class="sxs-lookup"><span data-stu-id="6519f-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="6519f-115">Konkrétně se podíváme na přidání prvku DetailsView na stránku, která zobrazuje informace o konkrétním produktu, jmenovitě Antoni Gumbo, která má `ProductID` 5.</span><span class="sxs-lookup"><span data-stu-id="6519f-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="6519f-116">Dále se dozvíte, jak nastavit hodnotu parametru na základě webového ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="6519f-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="6519f-117">Konkrétně použijeme textové pole, které umožní uživateli psát v zemi, po které můžou kliknout na tlačítko a zobrazit seznam dodavatelů, kteří se nacházejí v dané zemi.</span><span class="sxs-lookup"><span data-stu-id="6519f-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="6519f-118">Použití pevně kódované hodnoty parametru</span><span class="sxs-lookup"><span data-stu-id="6519f-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="6519f-119">Pro první příklad Začněte přidáním ovládacího prvku DetailsView na stránku `DeclarativeParams.aspx` ve složce `BasicReporting`.</span><span class="sxs-lookup"><span data-stu-id="6519f-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="6519f-120">Z inteligentní značky DetailsView vyberte v rozevíracím seznamu &lt;nový zdroj dat&gt; a zvolte možnost Přidat prvek ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6519f-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>

<span data-ttu-id="6519f-121">[![přidat prvek ObjectDataSource na stránku](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="6519f-122">**Obrázek 1**: Přidání prvku ObjectDataSource na stránku ([kliknutím zobrazíte obrázek v plné velikosti](declarative-parameters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="6519f-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>

<span data-ttu-id="6519f-123">Tím se automaticky spustí Průvodce vybrat zdroj dat pro ovládací prvek ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6519f-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="6519f-124">Na první obrazovce průvodce vyberte třídu `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="6519f-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>

<span data-ttu-id="6519f-125">[![výběr třídy ProductsBLL](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="6519f-126">**Obrázek 2**: vyberte třídu `ProductsBLL` ([kliknutím zobrazíte obrázek v plné velikosti](declarative-parameters-vb/_static/image6.png)).</span><span class="sxs-lookup"><span data-stu-id="6519f-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>

<span data-ttu-id="6519f-127">Vzhledem k tomu, že chceme zobrazit informace o konkrétním produktu, chceme použít metodu `GetProductByProductID(productID)`.</span><span class="sxs-lookup"><span data-stu-id="6519f-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>

<span data-ttu-id="6519f-128">[![zvolit metodu GetProductByProductID (productID)](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="6519f-129">**Obrázek 3**: vyberte metodu `GetProductByProductID(productID)` ([kliknutím zobrazíte obrázek v plné velikosti](declarative-parameters-vb/_static/image9.png)).</span><span class="sxs-lookup"><span data-stu-id="6519f-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>

<span data-ttu-id="6519f-130">Vzhledem k tomu, že metoda, kterou jsme zvolili, obsahuje parametr, pro Průvodce je k dispozici další obrazovka, kde se zobrazí výzva k definování hodnoty, která se má použít pro parametr.</span><span class="sxs-lookup"><span data-stu-id="6519f-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="6519f-131">Seznam na levé straně zobrazuje všechny parametry pro vybranou metodu.</span><span class="sxs-lookup"><span data-stu-id="6519f-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="6519f-132">`GetProductByProductID(productID)` jenom jeden `productID`.</span><span class="sxs-lookup"><span data-stu-id="6519f-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="6519f-133">Na pravé straně můžeme zadat hodnotu pro vybraný parametr.</span><span class="sxs-lookup"><span data-stu-id="6519f-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="6519f-134">Rozevírací seznam zdroj parametrů vytvoří výčet různých možných zdrojů pro hodnotu parametru.</span><span class="sxs-lookup"><span data-stu-id="6519f-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="6519f-135">Vzhledem k tomu, že chceme zadat pevně zakódované hodnoty 5 pro parametr `productID`, ponechte zdroj parametru jako None a zadejte 5 do textového pole DefaultValue.</span><span class="sxs-lookup"><span data-stu-id="6519f-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>

<span data-ttu-id="6519f-136">[pro parametr productID se použije ![pevně zakódovaného parametru, který má hodnotu 5.](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="6519f-137">**Obrázek 4**: pro parametr `productID` bude použita pevně kódovaná hodnota parametru 5 ([kliknutím zobrazíte obrázek v plné velikosti).](declarative-parameters-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>

<span data-ttu-id="6519f-138">Po dokončení Průvodce konfigurací zdroje dat obsahuje deklarativní označení ovládacího prvku ObjectDataSource objekt `Parameter` v kolekci `SelectParameters` pro každý vstupní parametr očekávaný metodou definovanou ve vlastnosti `SelectMethod`.</span><span class="sxs-lookup"><span data-stu-id="6519f-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="6519f-139">Vzhledem k tomu, že metoda, kterou v tomto příkladu používáme, očekává jenom jeden vstupní parametr, `parameterID`, tady je jenom jedna položka.</span><span class="sxs-lookup"><span data-stu-id="6519f-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="6519f-140">Kolekce `SelectParameters` může obsahovat libovolnou třídu, která je odvozena od `Parameter` třídy v oboru názvů `System.Web.UI.WebControls`.</span><span class="sxs-lookup"><span data-stu-id="6519f-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="6519f-141">Pro pevně zakódované hodnoty parametrů je použita základní `Parameter` třída, ale pro ostatní možnosti zdrojového parametru je použita odvozená `Parameter` třída; v případě potřeby můžete také vytvořit vlastní [typy parametrů](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11).</span><span class="sxs-lookup"><span data-stu-id="6519f-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="6519f-142">Pokud sledujete na vlastním počítači, deklarativní označení, které vidíte v tomto okamžiku, může zahrnovat hodnoty vlastností `InsertMethod`, `UpdateMethod`a `DeleteMethod` a také `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="6519f-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="6519f-143">Průvodce zvolit zdroj dat v prvku ObjectDataSource automaticky určuje metody z `ProductBLL` pro vložení, aktualizaci a odstranění, takže pokud je výslovně nevymažete, budou zahrnuty do značky výše.</span><span class="sxs-lookup"><span data-stu-id="6519f-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>

<span data-ttu-id="6519f-144">Při návštěvě této stránky Webová ovládací prvek data vyvolá metodu `Select` ObjectDataSource, která zavolá metodu `GetProductByProductID(productID)` `ProductsBLL` třídy s použitím pevně zakódované hodnoty 5 pro `productID` vstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="6519f-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="6519f-145">Metoda vrátí objekt se silným typem `ProductDataTable`, který obsahuje jeden řádek s informacemi o Gumbo (produkt s `ProductID` 5) pro Anton.</span><span class="sxs-lookup"><span data-stu-id="6519f-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>

<span data-ttu-id="6519f-146">[Zobrazí se ![informace o Gumbo mix pro Anton](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="6519f-147">**Obrázek 5**: zobrazí se informace o Gumbo ([kliknutím zobrazíte obrázek v plné velikosti) pro](declarative-parameters-vb/_static/image15.png)Anton.</span><span class="sxs-lookup"><span data-stu-id="6519f-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>

## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="6519f-148">Nastavení hodnoty parametru na hodnotu vlastnosti webového ovládacího prvku</span><span class="sxs-lookup"><span data-stu-id="6519f-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="6519f-149">Hodnoty parametru ObjectDataSource lze také nastavit na základě hodnoty webového ovládacího prvku na stránce.</span><span class="sxs-lookup"><span data-stu-id="6519f-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="6519f-150">Aby to bylo možné, Podívejme se na prvek GridView, který obsahuje seznam všech dodavatelů nacházejících se v zemi určené uživatelem.</span><span class="sxs-lookup"><span data-stu-id="6519f-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="6519f-151">Pro dosažení tohoto začátku přidejte textové pole na stránku, do které může uživatel zadat název země.</span><span class="sxs-lookup"><span data-stu-id="6519f-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="6519f-152">Nastavte vlastnost `ID` ovládacího prvku TextBox na hodnotu `CountryName`.</span><span class="sxs-lookup"><span data-stu-id="6519f-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="6519f-153">Přidejte také webový ovládací prvek tlačítko.</span><span class="sxs-lookup"><span data-stu-id="6519f-153">Also add a Button Web control.</span></span>

<span data-ttu-id="6519f-154">[![přidat textové pole na stránku s ID země](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="6519f-155">**Obrázek 6**: Přidání textového pole na stránku pomocí `ID` `CountryName` ([kliknutím zobrazíte obrázek v plné velikosti](declarative-parameters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="6519f-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>

<span data-ttu-id="6519f-156">Dále přidejte prvek GridView na stránku a z inteligentní značky vyberte možnost Přidat nový prvek ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6519f-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="6519f-157">Vzhledem k tomu, že chceme zobrazit informace o dodavateli, vyberte na první obrazovce Průvodce třídu `SuppliersBLL`.</span><span class="sxs-lookup"><span data-stu-id="6519f-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="6519f-158">Na druhé obrazovce vyberte metodu `GetSuppliersByCountry(country)`.</span><span class="sxs-lookup"><span data-stu-id="6519f-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>

<span data-ttu-id="6519f-159">[![zvolit metodu GetSuppliersByCountry (země)](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="6519f-160">**Obrázek 7**: vyberte metodu `GetSuppliersByCountry(country)` ([kliknutím zobrazíte obrázek v plné velikosti](declarative-parameters-vb/_static/image21.png)).</span><span class="sxs-lookup"><span data-stu-id="6519f-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>

<span data-ttu-id="6519f-161">Vzhledem k tomu, že metoda `GetSuppliersByCountry(country)` má vstupní parametr, průvodce po opětovném spuštění obsahuje poslední obrazovku pro výběr hodnoty parametru.</span><span class="sxs-lookup"><span data-stu-id="6519f-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="6519f-162">Tentokrát nastavte zdroj parametru tak, aby byl ovládací prvek.</span><span class="sxs-lookup"><span data-stu-id="6519f-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="6519f-163">Tím se naplní rozevírací seznam ControlID názvy ovládacích prvků na stránce. v seznamu vyberte ovládací prvek `CountryName`.</span><span class="sxs-lookup"><span data-stu-id="6519f-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="6519f-164">Při prvním navštívení stránky bude pole `CountryName` prázdné, takže se nevrátí žádné výsledky a nic se nezobrazí.</span><span class="sxs-lookup"><span data-stu-id="6519f-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="6519f-165">Pokud chcete ve výchozím nastavení zobrazit některé výsledky, nastavte textové pole DefaultValue odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="6519f-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>

<span data-ttu-id="6519f-166">[![nastavte hodnotu parametru na hodnotu ovládacího prvku Country.](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="6519f-167">**Obrázek 8**: nastavte hodnotu parametru na hodnotu ovládacího prvku `CountryName` ([kliknutím zobrazíte obrázek v plné velikosti).](declarative-parameters-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>

<span data-ttu-id="6519f-168">Deklarativní označení ovládacího prvku ObjectDataSource se mírně liší od našeho prvního příkladu pomocí [třídě ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) namísto standardního objektu `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="6519f-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="6519f-169">`ControlParameter` má další vlastnosti pro určení `ID` webového ovládacího prvku a hodnotu vlastnosti, která se má použít pro parametr (`PropertyName`).</span><span class="sxs-lookup"><span data-stu-id="6519f-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="6519f-170">Průvodce konfigurací zdroje dat byl dostatečně inteligentní k určení toho, že pro textové pole budeme nejspíš chtít použít vlastnost `Text` pro hodnotu parametru.</span><span class="sxs-lookup"><span data-stu-id="6519f-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="6519f-171">Pokud však chcete použít jinou hodnotu vlastnosti z webového ovládacího prvku, můžete změnit `PropertyName` hodnotu nebo kliknutím na odkaz Zobrazit pokročilé vlastnosti v průvodci.</span><span class="sxs-lookup"><span data-stu-id="6519f-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="6519f-172">Při prvním návštěvě `CountryName` textového pole je prázdné.</span><span class="sxs-lookup"><span data-stu-id="6519f-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="6519f-173">Metoda `Select` ovládacího prvku ObjectDataSource je stále vyvolána prvkem GridView, ale hodnota `Nothing` je předána do metody `GetSuppliersByCountry(country)`.</span><span class="sxs-lookup"><span data-stu-id="6519f-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="6519f-174">TableAdapter převede `Nothing` na `NULL` hodnotu databáze (`DBNull.Value`), ale dotaz používaný metodou `GetSuppliersByCountry(country)` je napsán tak, aby nevrátil žádné hodnoty, pokud je pro parametr `NULL` zadána hodnota `@CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="6519f-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="6519f-175">V krátkém případě se nevrátí žádní dodavatelé.</span><span class="sxs-lookup"><span data-stu-id="6519f-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="6519f-176">Jakmile návštěvník vstoupí do země a klikne na tlačítko Zobrazit dodavatele, aby způsobil postback, je znovu dotazována metoda `Select` ovládacího prvku TextBox, která předá hodnotu ovládacího prvku TextBox `Text` jako parametr `country`.</span><span class="sxs-lookup"><span data-stu-id="6519f-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>

<span data-ttu-id="6519f-177">[![se zobrazí dodavatelé z Kanady.](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="6519f-178">**Obrázek 9**: zobrazí se dodavatelé z Kanady ([kliknutím zobrazíte obrázek v plné velikosti](declarative-parameters-vb/_static/image27.png)).</span><span class="sxs-lookup"><span data-stu-id="6519f-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>

## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="6519f-179">Zobrazení všech dodavatelů ve výchozím nastavení</span><span class="sxs-lookup"><span data-stu-id="6519f-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="6519f-180">Místo toho, abyste při prvním zobrazení stránky viděli žádné ze dodavatelů, můžeme nejdřív zobrazit *všechny* dodavatele a povolit tak uživateli, aby ho zredukovali v seznamu tak, že do textového pole zadáte název země.</span><span class="sxs-lookup"><span data-stu-id="6519f-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="6519f-181">Když je textové pole prázdné, metoda `GetSuppliersByCountry(country)` třídy `SuppliersBLL` je předána do `Nothing` pro příslušný vstupní parametr *`country`* .</span><span class="sxs-lookup"><span data-stu-id="6519f-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="6519f-182">Tato hodnota `Nothing` se pak předává do metody `GetSupplierByCountry(country)` DAL, kde je přeložena na hodnotu `NULL` databáze pro parametr `@Country` v následujícím dotazu:</span><span class="sxs-lookup"><span data-stu-id="6519f-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="6519f-183">Výraz `Country = NULL` vždy vrátí hodnotu false, a to i u záznamů, jejichž `Country` sloupec má `NULL` hodnotu; Proto nejsou vráceny žádné záznamy.</span><span class="sxs-lookup"><span data-stu-id="6519f-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="6519f-184">Chcete-li vrátit *všechny* dodavatele, když je textové pole země prázdné, můžeme rozšířit metodu `GetSuppliersByCountry(country)` v knihoven BLL k vyvolání metody `GetSuppliers()`, pokud je její parametr země `Nothing` a chcete-li volat metodu `GetSuppliersByCountry(country)` dal, jinak.</span><span class="sxs-lookup"><span data-stu-id="6519f-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="6519f-185">To bude mít vliv na vrácení všech dodavatelů, pokud není zadána žádná země a příslušné podmnožiny dodavatelů, pokud je zahrnut parametr země.</span><span class="sxs-lookup"><span data-stu-id="6519f-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="6519f-186">Změňte metodu `GetSuppliersByCountry(country)` třídy `SuppliersBLL` na následující:</span><span class="sxs-lookup"><span data-stu-id="6519f-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="6519f-187">Pomocí této změny se na stránce `DeclarativeParams.aspx` zobrazí při prvním navštívení všichni dodavatelé (nebo pokaždé, když je textové pole `CountryName` prázdné).</span><span class="sxs-lookup"><span data-stu-id="6519f-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>

<span data-ttu-id="6519f-188">[![se teď ve výchozím nastavení zobrazují všichni dodavatelé.](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="6519f-189">**Obrázek 10**: ve výchozím nastavení se teď zobrazují všichni dodavatelé ([kliknutím zobrazíte obrázek v plné velikosti).](declarative-parameters-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="6519f-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>

## <a name="summary"></a><span data-ttu-id="6519f-190">Přehled</span><span class="sxs-lookup"><span data-stu-id="6519f-190">Summary</span></span>

<span data-ttu-id="6519f-191">Aby bylo možné používat metody se vstupními parametry, musíme zadat hodnoty parametrů v kolekci `SelectParameters` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6519f-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="6519f-192">Různé typy parametrů umožňují získat hodnotu parametru z různých zdrojů.</span><span class="sxs-lookup"><span data-stu-id="6519f-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="6519f-193">Výchozí typ parametru používá pevně zakódované hodnoty, ale stejně jako snadno (a bez řádku kódu) lze získat hodnoty parametrů z řetězce dotazu, proměnných relace, souborů cookie a dokonce uživatelem zadaných hodnot z webových ovládacích prvků na stránce.</span><span class="sxs-lookup"><span data-stu-id="6519f-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="6519f-194">Příklady, které jsme vyhledali v tomto kurzu, ilustrují použití deklarativních hodnot parametrů.</span><span class="sxs-lookup"><span data-stu-id="6519f-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="6519f-195">Nicméně může nastat čas, kdy potřebujeme použít zdroj parametru, který není k dispozici, jako je aktuální datum a čas, nebo pokud náš web použil členství, ID uživatele návštěvníka.</span><span class="sxs-lookup"><span data-stu-id="6519f-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="6519f-196">V takových scénářích můžeme hodnoty parametrů nastavit programově před vyvoláním metody základního objektu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6519f-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="6519f-197">V [dalším kurzu](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)vám ukážeme, jak to provést.</span><span class="sxs-lookup"><span data-stu-id="6519f-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="6519f-198">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="6519f-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="6519f-199">O autorovi</span><span class="sxs-lookup"><span data-stu-id="6519f-199">About the Author</span></span>

<span data-ttu-id="6519f-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor 7 ASP/ASP. NET Books a zakladatel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="6519f-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6519f-201">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="6519f-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6519f-202">Nejnovější kniha je [*Sams naučit se ASP.NET 2,0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="6519f-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="6519f-203">Dá se získat na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6519f-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="6519f-204">nebo prostřednictvím svého blogu, který najdete na adrese [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="6519f-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="6519f-205">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="6519f-205">Special Thanks To</span></span>

<span data-ttu-id="6519f-206">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="6519f-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6519f-207">Kontrolor pro tento kurz byl Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="6519f-207">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="6519f-208">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="6519f-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6519f-209">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6519f-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6519f-210">[Předchozí](displaying-data-with-the-objectdatasource-vb.md)
> [Další](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6519f-210">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>
