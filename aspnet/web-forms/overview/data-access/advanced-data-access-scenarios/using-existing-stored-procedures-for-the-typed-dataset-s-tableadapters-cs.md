---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs
title: Použití stávajících uložených procedur komponentami TableAdapter typové datové sady (C#) | Dokumentace Microsoftu
author: rick-anderson
description: V předchozím kurzu jsme zjistili, jak použít Průvodce vytvořením objektu TableAdapter na nové úložné procedury. V tomto kurzu jsme dozvíte, jak stejný TableAdapter...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 440bef2a-1641-4238-99e3-8e2d44e7d94c
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs
msc.type: authoredcontent
ms.openlocfilehash: bac8be11682237fff1bda637ddf5a4cd8cbf7d9e
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/06/2019
ms.locfileid: "65108798"
---
# <a name="using-existing-stored-procedures-for-the-typed-datasets-tableadapters-c"></a><span data-ttu-id="e66a1-104">Použití stávajících uložených procedur komponentami TableAdapter typových sad dat (C#)</span><span class="sxs-lookup"><span data-stu-id="e66a1-104">Using Existing Stored Procedures for the Typed DataSet's TableAdapters (C#)</span></span>

<span data-ttu-id="e66a1-105">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e66a1-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e66a1-106">[Stáhněte si kód](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_CS.zip) nebo [stahovat PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/datatutorial68cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e66a1-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_CS.zip) or [Download PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/datatutorial68cs1.pdf)</span></span>

> <span data-ttu-id="e66a1-107">V předchozím kurzu jsme zjistili, jak použít Průvodce vytvořením objektu TableAdapter na nové úložné procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-107">In the previous tutorial we learned how to use the TableAdapter Wizard to generate new stored procedures.</span></span> <span data-ttu-id="e66a1-108">V tomto kurzu jsme dozvíte, jak pracovat stejným Průvodce TableAdapter s existující uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-108">In this tutorial we learn how the same TableAdapter Wizard can work with existing stored procedures.</span></span> <span data-ttu-id="e66a1-109">Můžeme také zjistěte, jak ručně přidat nové uložené procedury do databáze.</span><span class="sxs-lookup"><span data-stu-id="e66a1-109">We also learn how to manually add new stored procedures to our database.</span></span>

## <a name="introduction"></a><span data-ttu-id="e66a1-110">Úvod</span><span class="sxs-lookup"><span data-stu-id="e66a1-110">Introduction</span></span>

<span data-ttu-id="e66a1-111">V [předchozím kurzu](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) jsme viděli, jak typované datové sady s objekty TableAdapter je možné nakonfigurovat pouze pomocí uložených procedur na SQL příkazy dat než ad-hoc přístup.</span><span class="sxs-lookup"><span data-stu-id="e66a1-111">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) we saw how the Typed DataSet s TableAdapters could be configured to use stored procedures to access data rather than ad-hoc SQL statements.</span></span> <span data-ttu-id="e66a1-112">Konkrétně jsme se zaměřili na tom, jak má TableAdapter průvodce automaticky vytvoří těchto uložených procedurách.</span><span class="sxs-lookup"><span data-stu-id="e66a1-112">In particular, we examined how to have the TableAdapter wizard automatically create these stored procedures.</span></span> <span data-ttu-id="e66a1-113">Pokud přenášíte starší verze aplikace pro technologii ASP.NET 2.0 nebo při vytváření na webu technologie ASP.NET 2.0 kolem existující datový model, je pravděpodobné, že databáze již obsahuje uložené procedury, které potřebujeme.</span><span class="sxs-lookup"><span data-stu-id="e66a1-113">When porting a legacy application to ASP.NET 2.0 or when building an ASP.NET 2.0 website around an existing data model, chances are that the database already contains the stored procedures we need.</span></span> <span data-ttu-id="e66a1-114">Také budete chtít vytvořit uložené procedury, ručně nebo pomocí některé nástroje, než Průvodce TableAdapter, který automaticky vygeneruje uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-114">Alternatively, you may prefer to create your stored procedures by hand or through some tool other than the TableAdapter wizard that auto-generates your stored procedures.</span></span>

<span data-ttu-id="e66a1-115">V tomto kurzu se podíváme na tom, jak konfigurovat TableAdapter používat existující uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-115">In this tutorial we will look at how to configure the TableAdapter to use existing stored procedures.</span></span> <span data-ttu-id="e66a1-116">Vzhledem k tomu, že databáze Northwind obsahuje jenom malou sadu předdefinovaných uložené procedury, také podíváme na kroky potřebné pro ruční přidání nové uložené procedury do databáze pomocí prostředí Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e66a1-116">Since the Northwind database only has a small set of built-in stored procedures, we will also look at the steps needed to manually add new stored procedures to the database through the Visual Studio environment.</span></span> <span data-ttu-id="e66a1-117">Začínáme s let!</span><span class="sxs-lookup"><span data-stu-id="e66a1-117">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="e66a1-118">V [zabalení úprav databáze do transakce](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) kurzu jsme přidali metody do třídy TableAdapter pro podporu transakcí (`BeginTransaction`, `CommitTransaction`, a tak dále).</span><span class="sxs-lookup"><span data-stu-id="e66a1-118">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) tutorial we added methods to the TableAdapter to support transactions (`BeginTransaction`, `CommitTransaction`, and so on).</span></span> <span data-ttu-id="e66a1-119">Alternativně je možné spravovat transakce v rámci uložené procedury, která nevyžaduje žádné úpravy kódu vrstvy přístupu k datům.</span><span class="sxs-lookup"><span data-stu-id="e66a1-119">Alternatively, transactions can be managed entirely within a stored procedure, which requires no modifications to the Data Access Layer code.</span></span> <span data-ttu-id="e66a1-120">V tomto kurzu se podíváme příkazů T-SQL ke spuštění příkazů s uloženou proceduru v rámci oboru transakce.</span><span class="sxs-lookup"><span data-stu-id="e66a1-120">In this tutorial we'll explore the T-SQL commands used to execute a stored procedure s statements within the scope of a transaction.</span></span>

## <a name="step-1-adding-stored-procedures-to-the-northwind-database"></a><span data-ttu-id="e66a1-121">Krok 1: Přidání uložené procedury k databázi Northwind</span><span class="sxs-lookup"><span data-stu-id="e66a1-121">Step 1: Adding Stored Procedures to the Northwind Database</span></span>

<span data-ttu-id="e66a1-122">Visual Studio umožňuje snadno přidat nové uložené procedury do databáze.</span><span class="sxs-lookup"><span data-stu-id="e66a1-122">Visual Studio makes it easy to add new stored procedures to a database.</span></span> <span data-ttu-id="e66a1-123">Umožňují s přidat novou úložnou proceduru k databázi Northwind, která vrací všechny sloupce z `Products` tabulky pro ty, které mají určitý `CategoryID` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="e66a1-123">Let s add a new stored procedure to the Northwind database that returns all columns from the `Products` table for those that have a particular `CategoryID` value.</span></span> <span data-ttu-id="e66a1-124">Z okna Průzkumníka serveru rozbalte databázi Northwind, aby jeho složky - databázových diagramů, tabulek, zobrazení a tak dále - zobrazí.</span><span class="sxs-lookup"><span data-stu-id="e66a1-124">From the Server Explorer window, expand the Northwind database so that its folders - Database Diagrams, Tables, Views, and so forth - are displayed.</span></span> <span data-ttu-id="e66a1-125">Jak jsme viděli v předchozím kurzu, uložené procedury složka obsahuje databáze s existující uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-125">As we saw in the preceding tutorial, the Stored Procedures folder contains the database s existing stored procedures.</span></span> <span data-ttu-id="e66a1-126">Pokud chcete přidat novou úložnou proceduru, jednoduše klikněte pravým tlačítkem na složku uložené procedury a zvolte možnost Přidat novou uloženou proceduru v místní nabídce.</span><span class="sxs-lookup"><span data-stu-id="e66a1-126">To add a new stored procedure, simply right-click the Stored Procedures folder and choose the Add New Stored Procedure option from the context menu.</span></span>

<span data-ttu-id="e66a1-127">[![Klikněte pravým tlačítkem na složku uložené procedury a přidejte novou úložnou proceduru](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-127">[![Right-Click the Stored Procedures Folder and Add a New Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image1.png)</span></span>

<span data-ttu-id="e66a1-128">**Obrázek 1**: Klikněte pravým tlačítkem na složku uložené procedury a přidat novou uloženou proceduru ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-128">**Figure 1**: Right-Click the Stored Procedures Folder and Add a New Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image3.png))</span></span>

<span data-ttu-id="e66a1-129">Jak ukazuje obrázek 1, výběrem možnosti Přidat novou uloženou proceduru otevře okno skriptu v sadě Visual Studio s obrysem skriptu SQL, které jsou potřeba k vytvoření uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-129">As Figure 1 shows, selecting the Add New Stored Procedure option opens a script window in Visual Studio with the outline of the SQL script needed to create the stored procedure.</span></span> <span data-ttu-id="e66a1-130">To je náš úloh podpořili tento skript a spustit ho v tomto okamžiku uloženou proceduru se přidají do databáze.</span><span class="sxs-lookup"><span data-stu-id="e66a1-130">It is our job to flesh out this script and execute it, at which point the stored procedure will be added to the database.</span></span>

<span data-ttu-id="e66a1-131">Zadejte následující skript:</span><span class="sxs-lookup"><span data-stu-id="e66a1-131">Enter the following script:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample1.sql)]

<span data-ttu-id="e66a1-132">Tento skript při spuštění, přidá novou úložnou proceduru k databázi Northwind s názvem `Products_SelectByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="e66a1-132">This script, when executed, will add a new stored procedure to the Northwind database named `Products_SelectByCategoryID`.</span></span> <span data-ttu-id="e66a1-133">Tuto uloženou proceduru přijímá jeden vstupní parametr (`@CategoryID`, typu `int`) a vrátí všechna pole pro tyto produkty k odpovídajícímu `CategoryID` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="e66a1-133">This stored procedure accepts a single input parameter (`@CategoryID`, of type `int`) and it returns all of the fields for those products with a matching `CategoryID` value.</span></span>

<span data-ttu-id="e66a1-134">Chcete-li to provést `CREATE PROCEDURE` skriptu a přidat uložené procedury do databáze, klikněte na ikonu Uložit na panelu nástrojů nebo stiskněte kombinaci kláves Ctrl + S.</span><span class="sxs-lookup"><span data-stu-id="e66a1-134">To execute this `CREATE PROCEDURE` script and add the stored procedure to the database, click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="e66a1-135">Až to uděláte, aktualizuje složku uložené procedury, zobrazující nově vytvořený uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-135">After doing so, the Stored Procedures folder refreshes, showing the newly created stored procedure.</span></span> <span data-ttu-id="e66a1-136">Skript v okně se navíc změní subtlety z `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` k `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="e66a1-136">Also, the script in the window will change subtlety from `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` to `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span></span> <span data-ttu-id="e66a1-137">`CREATE PROCEDURE` Přidá novou úložnou proceduru do databáze, zatímco `ALTER PROCEDURE` aktualizuje nějakou existující.</span><span class="sxs-lookup"><span data-stu-id="e66a1-137">`CREATE PROCEDURE` adds a new stored procedure to the database, while `ALTER PROCEDURE` updates an existing one.</span></span> <span data-ttu-id="e66a1-138">Od začátku skriptu se změnila na `ALTER PROCEDURE`, změna uložených procedur vstupní parametry nebo příkazy SQL, a kliknutím na ikonu uložení se aktualizovat uložené procedury s těmito změnami.</span><span class="sxs-lookup"><span data-stu-id="e66a1-138">Since the start of the script has changed to `ALTER PROCEDURE`, changing the stored procedures input parameters or SQL statements and clicking the Save icon will update the stored procedure with these changes.</span></span>

<span data-ttu-id="e66a1-139">Obrázek 2 ukazuje Visual Studio po `Products_SelectByCategoryID` uložená procedura byla uložena.</span><span class="sxs-lookup"><span data-stu-id="e66a1-139">Figure 2 shows Visual Studio after the `Products_SelectByCategoryID` stored procedure has been saved.</span></span>

<span data-ttu-id="e66a1-140">[![Uložená procedura Products_SelectByCategoryID byla přidána do databáze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-140">[![The Stored Procedure Products_SelectByCategoryID Has Been Added to the Database](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image4.png)</span></span>

<span data-ttu-id="e66a1-141">**Obrázek 2**: Uložená procedura `Products_SelectByCategoryID` byla přidána do databáze ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-141">**Figure 2**: The Stored Procedure `Products_SelectByCategoryID` Has Been Added to the Database ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image6.png))</span></span>

## <a name="step-2-configuring-the-tableadapter-to-use-an-existing-stored-procedure"></a><span data-ttu-id="e66a1-142">Krok 2: Konfigurace TableAdapter používat stávající úložnou proceduru</span><span class="sxs-lookup"><span data-stu-id="e66a1-142">Step 2: Configuring the TableAdapter to Use an Existing Stored Procedure</span></span>

<span data-ttu-id="e66a1-143">Teď, když `Products_SelectByCategoryID` uložené procedury byla přidána do databáze, můžeme nakonfigurovat naše vrstvy přístupu k datům při jedné z jeho metod vyvolání používat tuto uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="e66a1-143">Now that the `Products_SelectByCategoryID` stored procedure has been added to the database, we can configure our Data Access Layer to use this stored procedure when one of its methods is invoked.</span></span> <span data-ttu-id="e66a1-144">Zejména, přidáme `GetProductsByCategoryID(categoryID)` metodu `ProductsTableAdapter` v `NorthwindWithSprocs` typová, která volá `Products_SelectByCategoryID` uložené procedury, které jsme právě vytvořili.</span><span class="sxs-lookup"><span data-stu-id="e66a1-144">In particular, we will add a `GetProductsByCategoryID(categoryID)` method to the `ProductsTableAdapter` in the `NorthwindWithSprocs` Typed DataSet that calls the `Products_SelectByCategoryID` stored procedure we just created.</span></span>

<span data-ttu-id="e66a1-145">Začněte otevřením `NorthwindWithSprocs` datové sady.</span><span class="sxs-lookup"><span data-stu-id="e66a1-145">Start by opening the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="e66a1-146">Klikněte pravým tlačítkem na `ProductsTableAdapter` a zvolte Přidat dotaz spustíte Průvodce konfigurací dotazu TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e66a1-146">Right-click on the `ProductsTableAdapter` and choose Add Query to launch the TableAdapter Query Configuration wizard.</span></span> <span data-ttu-id="e66a1-147">V [předchozím kurzu](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) jsme se rozhodli mají TableAdapter vytvořit novou úložnou proceduru pro nás.</span><span class="sxs-lookup"><span data-stu-id="e66a1-147">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) we opted to have the TableAdapter create a new stored procedure for us.</span></span> <span data-ttu-id="e66a1-148">Pro účely tohoto kurzu, ale chceme propojí nové metody třídy TableAdapter ke stávající `Products_SelectByCategoryID` uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-148">For this tutorial, however, we want to wire the new TableAdapter method to the existing `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="e66a1-149">Proto možnost použití existující uložené procedury z prvního kroku průvodce s a pak klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="e66a1-149">Therefore, choose the Use existing stored procedure option from the wizard s first step and then click Next.</span></span>

<span data-ttu-id="e66a1-150">[![Zvolte možnost použít existující uložené procedury možnost](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-150">[![Choose the Use existing stored procedure Option](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image7.png)</span></span>

<span data-ttu-id="e66a1-151">**Obrázek 3**: Zvolte možnost použít existující uložené procedury možnost ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-151">**Figure 3**: Choose the Use existing stored procedure Option ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image9.png))</span></span>

<span data-ttu-id="e66a1-152">Na tomto obrázku poskytuje že rozevíracího seznamu naplní databázi s uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-152">The following screen provides a drop-down list populated with the database s stored procedures.</span></span> <span data-ttu-id="e66a1-153">Výběr uložené procedury jsou uvedeny na levé straně a datová pole, která vrátí (pokud existuje) na pravé straně její vstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="e66a1-153">Selecting a stored procedure lists its input parameters on the left and the data fields returned (if any) on the right.</span></span> <span data-ttu-id="e66a1-154">Zvolte `Products_SelectByCategoryID` uloženou proceduru ze seznamu a klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="e66a1-154">Choose the `Products_SelectByCategoryID` stored procedure from the list and click Next.</span></span>

<span data-ttu-id="e66a1-155">[![Vyberte Products_SelectByCategoryID uložené procedury](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-155">[![Pick the Products_SelectByCategoryID Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image10.png)</span></span>

<span data-ttu-id="e66a1-156">**Obrázek 4**: Vyberte si `Products_SelectByCategoryID` uloženou proceduru ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-156">**Figure 4**: Pick the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image12.png))</span></span>

<span data-ttu-id="e66a1-157">Na další obrazovce zeptá nám jaký druh dat je vrácený uložené procedury a naše odpověď určí typ vrácený metodou s TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e66a1-157">The next screen asks us what kind of data is returned by the stored procedure and our answer here determines the type returned by the TableAdapter s method.</span></span> <span data-ttu-id="e66a1-158">Například pokud Udáváme, že se vrátí tabulková data, metoda vrátí `ProductsDataTable` instanci naplněnou záznamů vrácených uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-158">For example, if we indicate that tabular data is returned, the method will return a `ProductsDataTable` instance populated with the records returned by the stored procedure.</span></span> <span data-ttu-id="e66a1-159">Naopak pokud Udáváme, že tuto uloženou proceduru vrací jedinou hodnotu objektu TableAdapter se vrátí `object` , která je přiřazena hodnota v prvním sloupci první záznam, vrátí uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="e66a1-159">In contrast, if we indicate that this stored procedure returns a single value the TableAdapter will return an `object` that is assigned the value in the first column of the first record returned by the stored procedure.</span></span>

<span data-ttu-id="e66a1-160">Vzhledem k tomu, `Products_SelectByCategoryID` uložené procedury jsou vráceny všechny produkty, které patří do určité kategorie, zvolte první odpověď – tabulkových dat – a klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="e66a1-160">Since the `Products_SelectByCategoryID` stored procedure returns all products that belong to a particular category, choose the first answer - Tabular data - and click Next.</span></span>

<span data-ttu-id="e66a1-161">[![Označuje, že bude procedura vracet tabulková Data](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-161">[![Indicate that the Stored Procedure Returns Tabular Data](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image13.png)</span></span>

<span data-ttu-id="e66a1-162">**Obrázek 5**: Označuje, že uložené procedury vrátí tabulková Data ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-162">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image15.png))</span></span>

<span data-ttu-id="e66a1-163">Už jen zbývá k označení metody vzorů, které za nímž následuje názvy pro tyto metody.</span><span class="sxs-lookup"><span data-stu-id="e66a1-163">All that remains is to indicate what method patterns to use followed by the names for these methods.</span></span> <span data-ttu-id="e66a1-164">Ponechte obou výplně DataTable a vrátit DataTable možnosti zaškrtnuté, ale přejmenovat metody k `FillByCategoryID` a `GetProductsByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="e66a1-164">Leave both the Fill a DataTable and Return a DataTable options checked, but rename the methods to `FillByCategoryID` and `GetProductsByCategoryID`.</span></span> <span data-ttu-id="e66a1-165">Klikněte na další Zkontrolujte souhrn úlohy, které průvodce provede.</span><span class="sxs-lookup"><span data-stu-id="e66a1-165">Then click Next to review a summary of the tasks the wizard will perform.</span></span> <span data-ttu-id="e66a1-166">Pokud vše vypadá v pořádku, klikněte na tlačítko Dokončit.</span><span class="sxs-lookup"><span data-stu-id="e66a1-166">If everything looks correct, click Finish.</span></span>

<span data-ttu-id="e66a1-167">[![Název metody FillByCategoryID a GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-167">[![Name the Methods FillByCategoryID and GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image16.png)</span></span>

<span data-ttu-id="e66a1-168">**Obrázek 6**: Název metody `FillByCategoryID` a `GetProductsByCategoryID` ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-168">**Figure 6**: Name the Methods `FillByCategoryID` and `GetProductsByCategoryID` ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="e66a1-169">Metody TableAdapter, který jsme právě vytvořili, `FillByCategoryID` a `GetProductsByCategoryID`, očekávat vstupní parametr typu `int`.</span><span class="sxs-lookup"><span data-stu-id="e66a1-169">The TableAdapter methods we just created, `FillByCategoryID` and `GetProductsByCategoryID`, expect an input parameter of type `int`.</span></span> <span data-ttu-id="e66a1-170">Tato hodnota vstupního parametru je předán do uložené procedury prostřednictvím jeho `@CategoryID` parametru.</span><span class="sxs-lookup"><span data-stu-id="e66a1-170">This input parameter value is passed into the stored procedure via its `@CategoryID` parameter.</span></span> <span data-ttu-id="e66a1-171">Pokud změníte `Products_SelectByCategory` parametry uložené procedury s, bude nutné také aktualizovat parametry pro tyto metody třídy TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e66a1-171">If you modify the `Products_SelectByCategory` stored procedure s parameters, you'll need to also update the parameters for these TableAdapter methods.</span></span> <span data-ttu-id="e66a1-172">Jak je popsáno v [předchozí kurz o službě](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md), to můžete udělat v jednom ze dvou způsobů: ruční přidáním nebo odebráním parametrů z kolekce parametrů nebo opětovným spuštěním Průvodce TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e66a1-172">As discussed in the [previous tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md), this can be done in one of two ways: by manually adding or removing parameters from the parameters collection or by rerunning the TableAdapter wizard.</span></span>

## <a name="step-3-adding-agetproductsbycategoryidcategoryidmethod-to-the-bll"></a><span data-ttu-id="e66a1-173">Krok 3: Přidání`GetProductsByCategoryID(categoryID)`metodu BLL</span><span class="sxs-lookup"><span data-stu-id="e66a1-173">Step 3: Adding a`GetProductsByCategoryID(categoryID)`Method to the BLL</span></span>

<span data-ttu-id="e66a1-174">S `GetProductsByCategoryID` metoda DAL kompletní, dalším krokem je poskytnout přístup k této metodě v vrstvy obchodní logiky.</span><span class="sxs-lookup"><span data-stu-id="e66a1-174">With the `GetProductsByCategoryID` DAL method complete, the next step is to provide access to this method in the Business Logic Layer.</span></span> <span data-ttu-id="e66a1-175">Otevřít `ProductsBLLWithSprocs` třídy soubor a přidejte následující metodu:</span><span class="sxs-lookup"><span data-stu-id="e66a1-175">Open the `ProductsBLLWithSprocs` class file and add the following method:</span></span>

[!code-csharp[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample2.cs)]

<span data-ttu-id="e66a1-176">Tato metoda BLL jednoduše vrací `ProductsDataTable` vrácená z `ProductsTableAdapter` s `GetProductsByCategoryID` metody.</span><span class="sxs-lookup"><span data-stu-id="e66a1-176">This BLL method simply returns the `ProductsDataTable` returned from the `ProductsTableAdapter` s `GetProductsByCategoryID` method.</span></span> <span data-ttu-id="e66a1-177">`DataObjectMethodAttribute` Atribut poskytuje metadata používá Průvodce konfigurace zdroje dat s ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="e66a1-177">The `DataObjectMethodAttribute` attribute provides metadata used by the ObjectDataSource s Configure Data Source wizard.</span></span> <span data-ttu-id="e66a1-178">Konkrétně tato metoda se zobrazí v rozevíracím seznamu vyberte kartu s.</span><span class="sxs-lookup"><span data-stu-id="e66a1-178">In particular, this method will appear in the SELECT tab s drop-down list.</span></span>

## <a name="step-4-displaying-products-by-category"></a><span data-ttu-id="e66a1-179">Krok 4: Zobrazení produktů podle kategorie</span><span class="sxs-lookup"><span data-stu-id="e66a1-179">Step 4: Displaying Products by Category</span></span>

<span data-ttu-id="e66a1-180">K otestování nově přidaný `Products_SelectByCategoryID` uložené procedury a odpovídající vrstvy DAL a BLL metody, umožní vytvořit stránku ASP.NET, která obsahuje DropDownList a GridView s.</span><span class="sxs-lookup"><span data-stu-id="e66a1-180">To test the newly added `Products_SelectByCategoryID` stored procedure and the corresponding DAL and BLL methods, let s create an ASP.NET page that contains a DropDownList and a GridView.</span></span> <span data-ttu-id="e66a1-181">DropDownList zobrazí seznam všech kategorií v databázi, zatímco prvku GridView zobrazí produkty, které patří do vybrané kategorie.</span><span class="sxs-lookup"><span data-stu-id="e66a1-181">The DropDownList will list all of the categories in the database while the GridView will display the products belonging to the selected category.</span></span>

> [!NOTE]
> <span data-ttu-id="e66a1-182">Jsme vytvořili záznamů master/detail rozhraní pomocí DropDownLists v předchozích kurzech.</span><span class="sxs-lookup"><span data-stu-id="e66a1-182">We ve created master/detail interfaces using DropDownLists in previous tutorials.</span></span> <span data-ttu-id="e66a1-183">Podrobnější rozbor implementace záznamů master/detail sestavu, najdete [filtrování záznamů Master/Detail s DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) kurzu.</span><span class="sxs-lookup"><span data-stu-id="e66a1-183">For a more in-depth look at implementing such a master/detail report, refer to the [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) tutorial.</span></span>

<span data-ttu-id="e66a1-184">Otevřít `ExistingSprocs.aspx` stránku `AdvancedDAL` složky a DropDownList přetáhněte z panelu nástrojů do návrháře.</span><span class="sxs-lookup"><span data-stu-id="e66a1-184">Open the `ExistingSprocs.aspx` page in the `AdvancedDAL` folder and drag a DropDownList from the Toolbox onto the Designer.</span></span> <span data-ttu-id="e66a1-185">Nastavte DropDownList s `ID` vlastnost `Categories` a jeho `AutoPostBack` vlastnost `true`.</span><span class="sxs-lookup"><span data-stu-id="e66a1-185">Set the DropDownList s `ID` property to `Categories` and its `AutoPostBack` property to `true`.</span></span> <span data-ttu-id="e66a1-186">V dalším kroku z inteligentních značek, připojení k nové ObjectDataSource s názvem DropDownList `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="e66a1-186">Next, from its smart tag, bind the DropDownList to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="e66a1-187">Nakonfigurujte prvku ObjectDataSource tak, aby ho načte data z `CategoriesBLL` třída s `GetCategories` metody.</span><span class="sxs-lookup"><span data-stu-id="e66a1-187">Configure the ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories` method.</span></span> <span data-ttu-id="e66a1-188">Nastavte rozevírací seznamy v UPDATE, INSERT a odstranit karty na (žádný).</span><span class="sxs-lookup"><span data-stu-id="e66a1-188">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="e66a1-189">[![Načtení dat z metody GetCategories CategoriesBLL třída s](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-189">[![Retrieve Data from the CategoriesBLL Class s GetCategories Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image19.png)</span></span>

<span data-ttu-id="e66a1-190">**Obrázek 7**: Načtení dat z `CategoriesBLL` třída s `GetCategories` – metoda ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-190">**Figure 7**: Retrieve Data from the `CategoriesBLL` Class s `GetCategories` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image21.png))</span></span>

<span data-ttu-id="e66a1-191">[![Nastavte rozevírací seznamy v UPDATE, INSERT a odstranit karty na (žádný)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-191">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image22.png)</span></span>

<span data-ttu-id="e66a1-192">**Obrázek 8**: Nastavte rozevírací seznam obsahuje v UPDATE, INSERT a odstranit záložky (žádný) ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-192">**Figure 8**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image24.png))</span></span>

<span data-ttu-id="e66a1-193">Po dokončení Průvodce prvek ObjectDataSource, nakonfigurujte DropDownList zobrazíte `CategoryName` pole data a použít `CategoryID` pole jako `Value` pro každou `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="e66a1-193">After completing the ObjectDataSource wizard, configure the DropDownList to display the `CategoryName` data field and to use the `CategoryID` field as the `Value` for each `ListItem`.</span></span>

<span data-ttu-id="e66a1-194">V tomto okamžiku by DropDownList a prvku ObjectDataSource s deklarativní podobný následujícímu:</span><span class="sxs-lookup"><span data-stu-id="e66a1-194">At this point, the DropDownList and ObjectDataSource s declarative markup should similar to the following:</span></span>

[!code-aspx[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample3.aspx)]

<span data-ttu-id="e66a1-195">V dalším kroku přetáhněte GridView na Návrhář, že ho umístíte pod DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e66a1-195">Next, drag a GridView onto the Designer, placing it beneath the DropDownList.</span></span> <span data-ttu-id="e66a1-196">Nastavit prvek GridView s `ID` k `ProductsByCategory` a z inteligentních značek, jeho vazbu na nového prvku ObjectDataSource s názvem `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="e66a1-196">Set the GridView s `ID` to `ProductsByCategory` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="e66a1-197">Konfigurace `ProductsByCategoryDataSource` ObjectDataSource používat `ProductsBLLWithSprocs` načtení třídy, minimu měl svoje data pomocí `GetProductsByCategoryID(categoryID)` – metoda.</span><span class="sxs-lookup"><span data-stu-id="e66a1-197">Configure the `ProductsByCategoryDataSource` ObjectDataSource to use the `ProductsBLLWithSprocs` class, having it retrieve its data using the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="e66a1-198">Protože tato GridView budou použity pouze k zobrazení dat, nastavte rozevírací seznamy v UPDATE, INSERT a odstraňovat karty na (žádný) a klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="e66a1-198">Since this GridView will only be used to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and click Next.</span></span>

<span data-ttu-id="e66a1-199">[![Konfigurace ObjectDataSource pomocí třídy ProductsBLLWithSprocs](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-199">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image25.png)</span></span>

<span data-ttu-id="e66a1-200">**Obrázek 9**: Konfigurace ObjectDataSource k použití `ProductsBLLWithSprocs` třídy ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-200">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image27.png))</span></span>

<span data-ttu-id="e66a1-201">[![Načtení dat z GetProductsByCategoryID(categoryID) – metoda](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-201">[![Retrieve Data from the GetProductsByCategoryID(categoryID) Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image28.png)</span></span>

<span data-ttu-id="e66a1-202">**Obrázek 10**: Načtení dat z `GetProductsByCategoryID(categoryID)` – metoda ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-202">**Figure 10**: Retrieve Data from the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image30.png))</span></span>

<span data-ttu-id="e66a1-203">Metoda zvolit na kartě vyberte očekává parametr, takže poslední krok v průvodci zobrazí výzvu, nám pro zdroj s parametrem.</span><span class="sxs-lookup"><span data-stu-id="e66a1-203">The method chosen in the SELECT tab expects a parameter, so the final step of the wizard prompts us for the parameter s source.</span></span> <span data-ttu-id="e66a1-204">Nastavte parametr zdroj rozevíracího seznamu ovládacího prvku a zvolte `Categories` ovládacího prvku z rozevíracího seznamu ControlID.</span><span class="sxs-lookup"><span data-stu-id="e66a1-204">Set the Parameter source drop-down list to Control and choose the `Categories` control from the ControlID drop-down list.</span></span> <span data-ttu-id="e66a1-205">Kliknutím na Dokončit dokončíte průvodce.</span><span class="sxs-lookup"><span data-stu-id="e66a1-205">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="e66a1-206">[![Pomocí kategorií DropDownList jako zdroj categoryID parametr](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-206">[![Use the Categories DropDownList as the Source of the categoryID Parameter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image31.png)</span></span>

<span data-ttu-id="e66a1-207">**Obrázek 11**: Použití `Categories` DropDownList jako zdroj `categoryID` parametr ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-207">**Figure 11**: Use the `Categories` DropDownList as the Source of the `categoryID` Parameter ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image33.png))</span></span>

<span data-ttu-id="e66a1-208">Po dokončení průvodce bude prvek ObjectDataSource, Visual Studio přidá BoundFields a třídě CheckBoxField pro každé pole data produktu.</span><span class="sxs-lookup"><span data-stu-id="e66a1-208">Upon completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for each of the product data fields.</span></span> <span data-ttu-id="e66a1-209">Teď můžete k přizpůsobení těchto polí podle svých potřeb.</span><span class="sxs-lookup"><span data-stu-id="e66a1-209">Feel free to customize these fields as you see fit.</span></span>

<span data-ttu-id="e66a1-210">Na stránce prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="e66a1-210">Visit the page through a browser.</span></span> <span data-ttu-id="e66a1-211">Při návštěvě stránky vybrané kategorie Nápoje a odpovídající produkty uvedenými v mřížce.</span><span class="sxs-lookup"><span data-stu-id="e66a1-211">When visiting the page the Beverages category is selected and the corresponding products listed in the grid.</span></span> <span data-ttu-id="e66a1-212">Změny rozevíracího seznamu do alternativní kategorie, jako obrázek 12 znázorňuje, vyvolá zpětné volání a znovu načte mřížky s produkty nově vybranou kategorii.</span><span class="sxs-lookup"><span data-stu-id="e66a1-212">Changing the drop-down list to an alternative category, as Figure 12 shows, causes a postback and reloads the grid with the products of the newly selected category.</span></span>

<span data-ttu-id="e66a1-213">[![Produkty v kategorii vytvořit jsou zobrazeny.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-213">[![The Products in the Produce Category are Displayed](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image34.png)</span></span>

<span data-ttu-id="e66a1-214">**Obrázek 12**: Produkty v kategorii vytvoření se zobrazí ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-214">**Figure 12**: The Products in the Produce Category are Displayed ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image36.png))</span></span>

## <a name="step-5-wrapping-a-stored-procedure-s-statements-within-the-scope-of-a-transaction"></a><span data-ttu-id="e66a1-215">Krok 5: Zabalení uložené procedury s příkazy v rámci oboru transakcí</span><span class="sxs-lookup"><span data-stu-id="e66a1-215">Step 5: Wrapping a Stored Procedure s Statements Within the Scope of a Transaction</span></span>

<span data-ttu-id="e66a1-216">V [zabalení úprav databáze do transakce](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) kurzu jsme probírali techniky pro provádění řadu příkazů změny databáze v rámci oboru transakce.</span><span class="sxs-lookup"><span data-stu-id="e66a1-216">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) tutorial we discussed techniques for performing a series of database modification statements within the scope of a transaction.</span></span> <span data-ttu-id="e66a1-217">Vzpomínáte, změny v zastřešující transakce provést buď všechny úspěšné nebo převzetí služeb při všech, uzavřené atomicitu.</span><span class="sxs-lookup"><span data-stu-id="e66a1-217">Recall that the modifications performed under the umbrella of a transaction either all succeed or all fail, guaranteeing atomicity.</span></span> <span data-ttu-id="e66a1-218">Mezi dostupné techniky pro použití transakcí patří:</span><span class="sxs-lookup"><span data-stu-id="e66a1-218">Techniques for using transactions include:</span></span>

- <span data-ttu-id="e66a1-219">Použití tříd v `System.Transactions` oboru názvů</span><span class="sxs-lookup"><span data-stu-id="e66a1-219">Using the classes in the `System.Transactions` namespace,</span></span>
- <span data-ttu-id="e66a1-220">Vrstva přístupu k datům s pomocí ADO.NET třídy typu `SqlTransaction`, a</span><span class="sxs-lookup"><span data-stu-id="e66a1-220">Having the Data Access Layer use ADO.NET classes like `SqlTransaction`, and</span></span>
- <span data-ttu-id="e66a1-221">Přidání příkazů T-SQL transakce přímo v rámci uložené procedury</span><span class="sxs-lookup"><span data-stu-id="e66a1-221">Adding the T-SQL transaction commands directly within the stored procedure</span></span>

<span data-ttu-id="e66a1-222">*Zabalení úprav databáze do transakce* kurz v DAL použít třídy rozhraní ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="e66a1-222">The *Wrapping Database Modifications within a Transaction* tutorial used the ADO.NET classes in the DAL.</span></span> <span data-ttu-id="e66a1-223">Zbývající část tohoto kurzu zkoumá, jak spravovat transakci pomocí příkazů T-SQL z v rámci uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-223">The remainder of this tutorial examines how to manage a transaction using T-SQL commands from within a stored procedure.</span></span>

<span data-ttu-id="e66a1-224">Jsou tři příkazy SQL klíče pro ruční spuštění, potvrzení a vrácení zpět transakcí `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, a `ROLLBACK TRANSACTION`v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="e66a1-224">The three key SQL commands for manually starting, committing, and rolling back a transaction are `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, and `ROLLBACK TRANSACTION`, respectively.</span></span> <span data-ttu-id="e66a1-225">Jako s přístupem ADO.NET, při použití transakcí v rámci uložené procedury, musíme použít následujícímu vzoru:</span><span class="sxs-lookup"><span data-stu-id="e66a1-225">Like with the ADO.NET approach, when using transactions from within a stored procedure we need to apply the following pattern:</span></span>

1. <span data-ttu-id="e66a1-226">Označení začátku transakce.</span><span class="sxs-lookup"><span data-stu-id="e66a1-226">Indicate the start of a transaction.</span></span>
2. <span data-ttu-id="e66a1-227">Spouštění příkazů jazyka SQL, které tvoří příslušnou transakci.</span><span class="sxs-lookup"><span data-stu-id="e66a1-227">Execute the SQL statements that comprise the transaction.</span></span>
3. <span data-ttu-id="e66a1-228">Pokud dojde k chybě v některém z příkazů z kroku 2, odvolání transakce</span><span class="sxs-lookup"><span data-stu-id="e66a1-228">If there is an error in any one of the statements from Step 2, rollback the transaction</span></span>
4. <span data-ttu-id="e66a1-229">Pokud všechny příkazy z kroku 2 dokončena bez chyb, potvrzení transakce.</span><span class="sxs-lookup"><span data-stu-id="e66a1-229">If all of the statements from Step 2 complete without error, commit the transaction.</span></span>

<span data-ttu-id="e66a1-230">Tento model je implementovat v syntaxi T-SQL pomocí následující šablony:</span><span class="sxs-lookup"><span data-stu-id="e66a1-230">This pattern can be implemented in T-SQL syntax using the following template:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample4.sql)]

<span data-ttu-id="e66a1-231">Šablona spustí definováním `TRY...CATCH` zablokovat, použít konstrukce nový SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="e66a1-231">The template starts by defining a `TRY...CATCH` block, a construct new to SQL Server 2005.</span></span> <span data-ttu-id="e66a1-232">Jak je `try...catch` blokuje v jazyce C#, SQL `TRY...CATCH` spouští příkazy v bloku `TRY` bloku.</span><span class="sxs-lookup"><span data-stu-id="e66a1-232">Like with `try...catch` blocks in C#, the SQL `TRY...CATCH` block executes the statements in the `TRY` block.</span></span> <span data-ttu-id="e66a1-233">Pokud libovolný příkaz vyvolá chybu, ovládací prvek bude převeden okamžitě na `CATCH` bloku.</span><span class="sxs-lookup"><span data-stu-id="e66a1-233">If any statement raises an error, control is immediately transferred to the `CATCH` block.</span></span>

<span data-ttu-id="e66a1-234">Pokud zde nejsou žádné chyby provádění příkazů SQL tuto strukturu transakce, `COMMIT TRANSACTION` příkazu potvrdí změny a dokončení transakce.</span><span class="sxs-lookup"><span data-stu-id="e66a1-234">If there are no errors executing the SQL statements that makeup the transaction, the `COMMIT TRANSACTION` statement commits the changes and completes the transaction.</span></span> <span data-ttu-id="e66a1-235">Pokud jeden z příkazů však způsobí chybu, `ROLLBACK TRANSACTION` v `CATCH` bloku se vrátí do stavu před zahájením transakce databáze.</span><span class="sxs-lookup"><span data-stu-id="e66a1-235">If, however, one of the statements results in an error, the `ROLLBACK TRANSACTION` in the `CATCH` block returns the database to its state prior to the start of the transaction.</span></span> <span data-ttu-id="e66a1-236">Uložená procedura také vyvolává chybu pomocí [příkaz RAISERROR](https://msdn.microsoft.com/library/ms178592.aspx), které způsobí, že `SqlException` vyvolání v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e66a1-236">The stored procedure also raises an error using the [RAISERROR command](https://msdn.microsoft.com/library/ms178592.aspx), which causes a `SqlException` to be raised in the application.</span></span>

> [!NOTE]
> <span data-ttu-id="e66a1-237">Vzhledem k tomu, `TRY...CATCH` blok je nový SQL Server 2005, výše uvedené šablony nebude fungovat, pokud používáte starší verze systému Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e66a1-237">Since the `TRY...CATCH` block is new to SQL Server 2005, the above template will not work if you are using older versions of Microsoft SQL Server.</span></span> <span data-ttu-id="e66a1-238">Pokud nepoužíváte SQL Server 2005, projděte si [Správa transakcí v SQL serveru uložené procedury](http://www.4guysfromrolla.com/webtech/080305-1.shtml) šablony, která bude fungovat s jinými verzemi SQL serveru.</span><span class="sxs-lookup"><span data-stu-id="e66a1-238">If you are not using SQL Server 2005, consult [Managing Transactions in SQL Server Stored Procedures](http://www.4guysfromrolla.com/webtech/080305-1.shtml) for a template that will work with other versions of SQL Server.</span></span>

<span data-ttu-id="e66a1-239">Podívejte se na konkrétní příklad s let.</span><span class="sxs-lookup"><span data-stu-id="e66a1-239">Let s look at a concrete example.</span></span> <span data-ttu-id="e66a1-240">Existuje omezení cizího klíče mezi `Categories` a `Products` tabulek, což znamená, že každá `CategoryID` pole `Products` tabulky musí být namapovaný na `CategoryID` hodnota v `Categories` tabulky.</span><span class="sxs-lookup"><span data-stu-id="e66a1-240">A foreign key constraint exists between the `Categories` and `Products` tables, meaning that each `CategoryID` field in the `Products` table must map to a `CategoryID` value in the `Categories` table.</span></span> <span data-ttu-id="e66a1-241">Jakoukoli akci, která by mohla narušit omezení, jako je například pokus o odstranění kategorii, která má související produkty, výsledkem je porušení omezení pro cizí klíč.</span><span class="sxs-lookup"><span data-stu-id="e66a1-241">Any action that would violate this constraint, such as attempting to delete a category that has associated products, results in a foreign key constraint violation.</span></span> <span data-ttu-id="e66a1-242">Chcete-li to ověřit návštěvě příklad aktualizace a odstranění stávajících binárních dat ve spolupráci s oddílem binárních dat (`~/BinaryData/UpdatingAndDeleting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="e66a1-242">To verify this, revisit the Updating and Deleting Existing Binary Data example in the Working with Binary Data section (`~/BinaryData/UpdatingAndDeleting.aspx`).</span></span> <span data-ttu-id="e66a1-243">Tato stránka obsahuje seznam jednotlivých kategorií v systému spolu s tlačítka pro úpravy a odstranění (viz obrázek 13), ale pokud se pokusíte odstranit kategorii, která má související produkty – například nápoje - odstranění nezdaří z důvodu narušení omezení pro cizí klíč (viz obrázek 14).</span><span class="sxs-lookup"><span data-stu-id="e66a1-243">This page lists each category in the system along with Edit and Delete buttons (see Figure 13), but if you attempt to delete a category that has associated products - such as Beverages - the delete fails due to a foreign key constraint violation (see Figure 14).</span></span>

<span data-ttu-id="e66a1-244">[![Každá kategorie se zobrazí v prvku GridView s upravit a odstranit tlačítka](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-244">[![Each Category is Displayed in a GridView with Edit and Delete Buttons](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image37.png)</span></span>

<span data-ttu-id="e66a1-245">**Obrázek 13**: Každá kategorie se zobrazí v prvku GridView s upravit a odstranit tlačítka ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-245">**Figure 13**: Each Category is Displayed in a GridView with Edit and Delete Buttons ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image39.png))</span></span>

<span data-ttu-id="e66a1-246">[![Nelze odstranit kategorii, která má existující produkty](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="e66a1-246">[![You Cannot Delete a Category that has Existing Products](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image40.png)</span></span>

<span data-ttu-id="e66a1-247">**Obrázek 14**: Nelze odstranit kategorii, která má existující produkty ([kliknutím ji zobrazíte obrázek v plné velikosti](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="e66a1-247">**Figure 14**: You Cannot Delete a Category that has Existing Products ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image42.png))</span></span>

<span data-ttu-id="e66a1-248">Představte si však, že chceme povolit kategorie má být odstraněn bez ohledu na to, zda mají přiřazené produktů.</span><span class="sxs-lookup"><span data-stu-id="e66a1-248">Imagine, though, that we want to allow categories to be deleted regardless of whether they have associated products.</span></span> <span data-ttu-id="e66a1-249">Odstranit kategorii s produkty, představte si, že chceme také odstranit existující produkty (i když další možností je jednoduše nastavte své produkty `CategoryID` hodnoty `NULL`).</span><span class="sxs-lookup"><span data-stu-id="e66a1-249">Should a category with products be deleted, imagine that we want to also delete its existing products (although another option would be to simply set its products `CategoryID` values to `NULL`).</span></span> <span data-ttu-id="e66a1-250">Tato funkce může implementované pomocí pravidel cascade omezení cizího klíče.</span><span class="sxs-lookup"><span data-stu-id="e66a1-250">This functionality could be implemented through the cascade rules of the foreign key constraint.</span></span> <span data-ttu-id="e66a1-251">Můžeme také vytvořit uloženou proceduru, která přijímá `@CategoryID` vstupní parametr a při vyvolání, explicitně odstraní všechna související produkty a potom zadané kategorie.</span><span class="sxs-lookup"><span data-stu-id="e66a1-251">Alternatively, we could create a stored procedure that accepts a `@CategoryID` input parameter and, when invoked, explicitly deletes all of the associated products and then the specified category.</span></span>

<span data-ttu-id="e66a1-252">Naše první pokus o uloženou proceduru mohou vypadat nějak takto:</span><span class="sxs-lookup"><span data-stu-id="e66a1-252">Our first attempt at such a stored procedure might look like the following:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample5.sql)]

<span data-ttu-id="e66a1-253">Zatímco jednoznačně tato akce odstraní přidružené produktů a kategorii, neučiní tak v části zastřešující transakce.</span><span class="sxs-lookup"><span data-stu-id="e66a1-253">While this will definitely delete the associated products and category, it does not do so under the umbrella of a transaction.</span></span> <span data-ttu-id="e66a1-254">Představte si, že se na některé další omezení pro cizí klíč `Categories` nebude odstranění konkrétní `@CategoryID` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="e66a1-254">Imagine that there is some other foreign key constraint on `Categories` that would prohibit the deletion of a particular `@CategoryID` value.</span></span> <span data-ttu-id="e66a1-255">Problém je, že v takovém případě všech produktů, které se odstraní předtím, než jsme pokus o odstranění kategorii.</span><span class="sxs-lookup"><span data-stu-id="e66a1-255">The problem is that in such a case all of the products will be deleted before we attempt to delete the category.</span></span> <span data-ttu-id="e66a1-256">Net výsledkem je, že pro tyto kategorie tuto uloženou proceduru by odebrat všechny její produkty zatímco zůstala kategorie, protože s ním stále související záznamy v jiné tabulce.</span><span class="sxs-lookup"><span data-stu-id="e66a1-256">The net result is that for such a category, this stored procedure would remove all of its products while the category remained since it still has related records in some other table.</span></span>

<span data-ttu-id="e66a1-257">Pokud uložená procedura byly zabalené v rámci oboru transakce, ale při odstraní pro `Products` tabulka bude vrácena zpět i v případě se nepovedlo odstranit `Categories`.</span><span class="sxs-lookup"><span data-stu-id="e66a1-257">If the stored procedure were wrapped within the scope of a transaction, however, the deletes to the `Products` table would be rolled back in the face of a failed delete on `Categories`.</span></span> <span data-ttu-id="e66a1-258">Následující skript uložené procedury používá transakce, aby zajistil atomicitu mezi těmito dvěma `DELETE` příkazy:</span><span class="sxs-lookup"><span data-stu-id="e66a1-258">The following stored procedure script uses a transaction to assure atomicity between the two `DELETE` statements:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample6.sql)]

<span data-ttu-id="e66a1-259">Za chvíli přidat `Categories_Delete` uložené procedury k databázi Northwind.</span><span class="sxs-lookup"><span data-stu-id="e66a1-259">Take a moment to add the `Categories_Delete` stored procedure to the Northwind database.</span></span> <span data-ttu-id="e66a1-260">Vraťte se ke kroku 1 pokyny k přidání uložených procedur do databáze.</span><span class="sxs-lookup"><span data-stu-id="e66a1-260">Refer back to Step 1 for instructions on adding stored procedures to a database.</span></span>

## <a name="step-6-updating-thecategoriestableadapter"></a><span data-ttu-id="e66a1-261">Krok 6: Aktualizuje se`CategoriesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="e66a1-261">Step 6: Updating the`CategoriesTableAdapter`</span></span>

<span data-ttu-id="e66a1-262">Při jsme přidali `Categories_Delete` uložené procedury do databáze, DAL je aktuálně nakonfigurován pro použití ad-hoc SQL k provedení odstranit.</span><span class="sxs-lookup"><span data-stu-id="e66a1-262">While we ve added the `Categories_Delete` stored procedure to the database, the DAL is currently configured to use ad-hoc SQL statements to perform the delete.</span></span> <span data-ttu-id="e66a1-263">Potřebujeme aktualizovat `CategoriesTableAdapter` a dostane pokyn, aby používat `Categories_Delete` místo toho uložená procedura.</span><span class="sxs-lookup"><span data-stu-id="e66a1-263">We need to update the `CategoriesTableAdapter` and instruct it to use the `Categories_Delete` stored procedure instead.</span></span>

> [!NOTE]
> <span data-ttu-id="e66a1-264">Dříve v tomto kurzu jsme pracovali `NorthwindWithSprocs` datové sady.</span><span class="sxs-lookup"><span data-stu-id="e66a1-264">Earlier in this tutorial we were working with the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="e66a1-265">Ale, že datová sada obsahuje pouze jednu entitu, `ProductsDataTable`, a My potřebujeme práce s kategoriemi.</span><span class="sxs-lookup"><span data-stu-id="e66a1-265">But that DataSet only has a single entity, `ProductsDataTable`, and we need to work with categories.</span></span> <span data-ttu-id="e66a1-266">Proto pro zbývající část tohoto kurzu, když mám mluvit o m Data Access Layer I, který se odkazuje na `Northwind` datové sady, který jsme vytvořili první v [vytvoření vrstvy přístupu k datům](../introduction/creating-a-data-access-layer-cs.md) kurzu.</span><span class="sxs-lookup"><span data-stu-id="e66a1-266">Therefore, for the remainder of this tutorial when I talk about the Data Access Layer I m referring to the `Northwind` DataSet, the one that we first created in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial.</span></span>

<span data-ttu-id="e66a1-267">Otevřete datovou sadu Northwind, vyberte `CategoriesTableAdapter`a přejděte do okna Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="e66a1-267">Open the Northwind DataSet, select the `CategoriesTableAdapter`, and go to the Properties window.</span></span> <span data-ttu-id="e66a1-268">Seznamy vlastností okna `InsertCommand`, `UpdateCommand`, `DeleteCommand`, a `SelectCommand` používané TableAdapter, jakož i její název a informace o připojení.</span><span class="sxs-lookup"><span data-stu-id="e66a1-268">The Properties window lists the `InsertCommand`, `UpdateCommand`, `DeleteCommand`, and `SelectCommand` used by the TableAdapter, as well as its name and connection information.</span></span> <span data-ttu-id="e66a1-269">Rozbalte `DeleteCommand` vlastnost zobrazíte její podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="e66a1-269">Expand the `DeleteCommand` property to see its details.</span></span> <span data-ttu-id="e66a1-270">Jak ukazuje obrázek 15 `DeleteCommand` s `CommandType` je nastavena na Text, který se má poslat v textu nastaví `CommandText` vlastnosti jako datový typ dotazu SQL ad-hoc.</span><span class="sxs-lookup"><span data-stu-id="e66a1-270">As Figure 15 shows, the `DeleteCommand` s `CommandType` property is set to Text, which instructs it to send the text in the `CommandText` property as an ad-hoc SQL query.</span></span>

![V návrháři a zobrazte její vlastnosti v okně Vlastnosti vyberte CategoriesTableAdapter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image43.png)

<span data-ttu-id="e66a1-272">**Obrázek 15**: Vyberte `CategoriesTableAdapter` v návrháři a zobrazte její vlastnosti v okně Vlastnosti</span><span class="sxs-lookup"><span data-stu-id="e66a1-272">**Figure 15**: Select the `CategoriesTableAdapter` in the Designer to View Its Properties in the Properties Window</span></span>

<span data-ttu-id="e66a1-273">Chcete-li změnit tato nastavení, v okně Vlastnosti vyberte text (událost DeleteCommand) a z rozevíracího seznamu zvolte (nové).</span><span class="sxs-lookup"><span data-stu-id="e66a1-273">To change these settings, select the (DeleteCommand) text in the Properties window and choose (New) from the drop-down list.</span></span> <span data-ttu-id="e66a1-274">Touto akcí vymažete si nastavení `CommandText`, `CommandType`, a `Parameters` vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="e66a1-274">This will clear out the settings for the `CommandText`, `CommandType`, and `Parameters` properties.</span></span> <span data-ttu-id="e66a1-275">Dále nastavte `CommandType` vlastnost `StoredProcedure` a pak zadejte název uložené procedury pro `CommandText` (`dbo.Categories_Delete`).</span><span class="sxs-lookup"><span data-stu-id="e66a1-275">Next, set the `CommandType` property to `StoredProcedure` and then type in the name of the stored procedure for the `CommandText` (`dbo.Categories_Delete`).</span></span> <span data-ttu-id="e66a1-276">Pokud jste nezapomeňte napřed zadejte vlastnosti v uvedeném pořadí – `CommandType` a pak `CommandText` – Visual Studio automaticky naplní kolekci parametrů.</span><span class="sxs-lookup"><span data-stu-id="e66a1-276">If you make sure to enter the properties in this order - first the `CommandType` and then the `CommandText` - Visual Studio will automatically populate the Parameters collection.</span></span> <span data-ttu-id="e66a1-277">Pokud nezadáte tyto vlastnosti v tomto pořadí, budete muset ručně přidat parametry prostřednictvím Editor kolekce parametrů.</span><span class="sxs-lookup"><span data-stu-id="e66a1-277">If you do not enter these properties in this order, you will have to manually add the parameters through the Parameters Collection Editor.</span></span> <span data-ttu-id="e66a1-278">V obou případech je třeba ji zkontrolovat kliknout na symbol tří teček v vlastnost Parameters zpřístupnit nahoru Editor kolekce parametrů pro ověření, že správný parametr nastavení byly provedeny změny (viz obrázek 16) s.</span><span class="sxs-lookup"><span data-stu-id="e66a1-278">In either case, it s prudent to click on the ellipses in the Parameters property to bring up the Parameters Collection Editor to verify that the correct parameter settings changes have been made (see Figure 16).</span></span> <span data-ttu-id="e66a1-279">Pokud se nezobrazí žádné parametry v dialogovém okně, přidejte `@CategoryID` parametr ručně (není potřeba přidat `@RETURN_VALUE` parametr).</span><span class="sxs-lookup"><span data-stu-id="e66a1-279">If you do not see any parameters in the dialog box, add the `@CategoryID` parameter manually (you do not need to add the `@RETURN_VALUE` parameter).</span></span>

![Ujistěte se, že parametry nastavení jsou správně](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image44.png)

<span data-ttu-id="e66a1-281">**Obrázek 16**: Ujistěte se, že parametry nastavení jsou správně</span><span class="sxs-lookup"><span data-stu-id="e66a1-281">**Figure 16**: Ensure That the Parameters Settings are Correct</span></span>

<span data-ttu-id="e66a1-282">Po DAL se aktualizovala, odstraňuje se kategorie bude automaticky odstraní všechny jeho související produkty a učinit v rámci zastřešující transakce.</span><span class="sxs-lookup"><span data-stu-id="e66a1-282">Once the DAL has been updated, deleting a category will automatically delete all of its associated products and do so under the umbrella of a transaction.</span></span> <span data-ttu-id="e66a1-283">Chcete-li to ověřit, vraťte se na stránku aktualizace a odstranění stávajících binárních dat a klikněte na tlačítko Odstranit pro některou z kategorií.</span><span class="sxs-lookup"><span data-stu-id="e66a1-283">To verify this, return to the Updating and Deleting Existing Binary Data page and click the Delete button for one of the categories.</span></span> <span data-ttu-id="e66a1-284">Jeden jediným kliknutím myší kategorie a všechny jeho přidružené produkty se odstraní.</span><span class="sxs-lookup"><span data-stu-id="e66a1-284">With one single click of the mouse, the category and all of its associated products will be deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="e66a1-285">Před testováním `Categories_Delete` uložené procedury, které se odstraní celou řadou produkty spolu s vybranou kategorii, může být vhodné vytvořit záložní kopii databáze.</span><span class="sxs-lookup"><span data-stu-id="e66a1-285">Before testing the `Categories_Delete` stored procedure, which will delete a number of products along with the selected category, it might be prudent to make a backup copy of your database.</span></span> <span data-ttu-id="e66a1-286">Pokud používáte `NORTHWND.MDF` databáze v `App_Data`, jednoduše zavřete sadu Visual Studio a zkopírujte soubory MDF a LDF v `App_Data` do nějaké složky.</span><span class="sxs-lookup"><span data-stu-id="e66a1-286">If you are using the `NORTHWND.MDF` database in `App_Data`, simply close Visual Studio and copy the MDF and LDF files in `App_Data` to some other folder.</span></span> <span data-ttu-id="e66a1-287">Po otestování funkce, můžete obnovit databázi zavření sady Visual Studio a nahradí aktuální MDF a LDF soubory `App_Data` pomocí záložní kopie.</span><span class="sxs-lookup"><span data-stu-id="e66a1-287">After testing the functionality, you can restore the database by closing Visual Studio and replacing the current MDF and LDF files in `App_Data` with the backup copies.</span></span>

## <a name="summary"></a><span data-ttu-id="e66a1-288">Souhrn</span><span class="sxs-lookup"><span data-stu-id="e66a1-288">Summary</span></span>

<span data-ttu-id="e66a1-289">Průvodci vytvořením objektu TableAdapter s budou automaticky generovat uložené procedury pro nás, existují situace, kdy jsme může již takové vytvářet úložné procedury nebo chcete je vytvořit ručně nebo pomocí jiných nástrojů místo.</span><span class="sxs-lookup"><span data-stu-id="e66a1-289">While the TableAdapter s wizard will automatically generate stored procedures for us, there are times when we might already have such stored procedures created or want to create them manually or with other tools instead.</span></span> <span data-ttu-id="e66a1-290">Takových scénářů TableAdapter lze také nastavit tak, aby odkazoval na stávající úložnou proceduru.</span><span class="sxs-lookup"><span data-stu-id="e66a1-290">To accommodate such scenarios, the TableAdapter can also be configured to point to an existing stored procedure.</span></span> <span data-ttu-id="e66a1-291">V tomto kurzu jsme se podívali na tom, jak ručně přidat uložené procedury do databáze prostřednictvím prostředí sady Visual Studio a jak propojí metod TableAdapter s těchto uložených procedurách.</span><span class="sxs-lookup"><span data-stu-id="e66a1-291">In this tutorial we looked at how to manually add stored procedures to a database through the Visual Studio environment and how to wire the TableAdapter s methods to these stored procedures.</span></span> <span data-ttu-id="e66a1-292">Můžeme také prozkoumat příkazů T-SQL a skript používaným pro počáteční potvrzení a vrácení zpět transakcí z v rámci uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e66a1-292">We also examined the T-SQL commands and script pattern used for starting, committing, and rolling back transactions from within a stored procedure.</span></span>

<span data-ttu-id="e66a1-293">Všechno nejlepší programování!</span><span class="sxs-lookup"><span data-stu-id="e66a1-293">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="e66a1-294">O autorovi</span><span class="sxs-lookup"><span data-stu-id="e66a1-294">About the Author</span></span>

<span data-ttu-id="e66a1-295">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a Zakladatel [4GuysFromRolla.com](http://www.4guysfromrolla.com), má práce s Microsoft webových technologiích od roku 1998.</span><span class="sxs-lookup"><span data-stu-id="e66a1-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e66a1-296">Scott funguje jako nezávislý konzultant, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="e66a1-296">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e66a1-297">Jeho nejnovější knihy [ *Edice nakladatelství Sams naučit sami ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e66a1-297">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e66a1-298">Může být dosáhl v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e66a1-298">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="e66a1-299">nebo prostřednictvím jeho blogu, který lze nalézt v [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="e66a1-299">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="e66a1-300">Speciální k</span><span class="sxs-lookup"><span data-stu-id="e66a1-300">Special Thanks To</span></span>

<span data-ttu-id="e66a1-301">V této sérii kurzů byl recenzován uživatelem mnoho užitečných revidující.</span><span class="sxs-lookup"><span data-stu-id="e66a1-301">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e66a1-302">Vedoucí revidující pro účely tohoto kurzu byly Hilton Geisenow, S ren Jakub Lauritsen a Teresy Murphy.</span><span class="sxs-lookup"><span data-stu-id="e66a1-302">Lead reviewers for this tutorial were Hilton Geisenow, S ren Jacob Lauritsen, and Teresa Murphy.</span></span> <span data-ttu-id="e66a1-303">Zajímat téma Moje nadcházejících článcích MSDN?</span><span class="sxs-lookup"><span data-stu-id="e66a1-303">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e66a1-304">Pokud ano, vyřaďte mě řádek na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e66a1-304">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e66a1-305">[Předchozí](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
> [další](updating-the-tableadapter-to-use-joins-cs.md)</span><span class="sxs-lookup"><span data-stu-id="e66a1-305">[Previous](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
[Next](updating-the-tableadapter-to-use-joins-cs.md)</span></span>
