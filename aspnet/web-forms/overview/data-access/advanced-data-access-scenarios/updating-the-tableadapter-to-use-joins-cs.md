---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
title: Aktualizace TableAdapter pro použití spojení (C#) | Microsoft Docs
author: rick-anderson
description: Při práci s databází je běžné požadovat data, která jsou rozdělená mezi několik tabulek. Pro načtení dat ze dvou různých tabulek můžeme použít buď...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 675531a7-cb54-4dd6-89ac-2636e4c285a5
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
msc.type: authoredcontent
ms.openlocfilehash: 24ff3645783dabfcdef5ac313a2d4833e4998efc
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78532555"
---
# <a name="updating-the-tableadapter-to-use-joins-c"></a><span data-ttu-id="3f1b1-104">Aktualizace komponenty TableAdapter kvůli použití příkazů JOIN (C#)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-104">Updating the TableAdapter to Use JOINs (C#)</span></span>

<span data-ttu-id="3f1b1-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3f1b1-106">[Stažení kódu](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) nebo [stažení PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span></span>

> <span data-ttu-id="3f1b1-107">Při práci s databází je běžné požadovat data, která jsou rozdělená mezi několik tabulek.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="3f1b1-108">K načtení dat ze dvou různých tabulek můžeme použít buď korelační poddotaz, nebo operaci JOIN.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="3f1b1-109">V tomto kurzu porovnáváme korelační poddotazy a syntaxi spojení před zobrazením postupu vytvoření TableAdapter, který obsahuje spojení v jeho hlavním dotazu.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>

## <a name="introduction"></a><span data-ttu-id="3f1b1-110">Úvod</span><span class="sxs-lookup"><span data-stu-id="3f1b1-110">Introduction</span></span>

<span data-ttu-id="3f1b1-111">V případě relačních databází se data, se kterými se snažíme pracovat, často rozcházejí mezi několik tabulek.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="3f1b1-112">Pokud například zobrazíte informace o produktu, Seznamte se s informacemi o odpovídajících kategoriích a dodavatelích v jednotlivých produktech.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="3f1b1-113">Tabulka `Products` obsahuje hodnoty `CategoryID` a `SupplierID`, ale skutečná kategorie a názvy dodavatelů jsou v `Categories` a `Suppliers`ch tabulkách v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="3f1b1-114">Pokud chcete načíst informace z jiné související tabulky, můžeme použít *korelační poddotazy* nebo `JOIN`*s*.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="3f1b1-115">Korelační poddotaz je vnořený `SELECT` dotaz, který odkazuje na sloupce ve vnějším dotazu.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="3f1b1-116">Například v kurzu [Vytvoření vrstvy přístupu k datům](../introduction/creating-a-data-access-layer-cs.md) jsme použili dva korelační poddotazy v hlavním dotazu `ProductsTableAdapter` s k vrácení názvů kategorií a dodavatelů pro každý produkt.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="3f1b1-117">`JOIN` je konstrukce SQL, která slučuje související řádky ze dvou různých tabulek.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="3f1b1-118">Při [dotazování dat pomocí ovládacího prvku SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) jsme použili `JOIN` k zobrazení informací o kategorii společně s každým produktem.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="3f1b1-119">Důvodem, proč jsme abstainedi použití `JOIN` s s objekty TableAdapter, je z důvodu omezení v průvodci TableAdapterou pro automatické generování odpovídajících příkazů `INSERT`, `UPDATE`a `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="3f1b1-120">Pokud hlavní dotaz TableAdapter s obsahuje nějaké `JOIN` s, TableAdapter nemůže automaticky vytvořit ad-hoc příkazy SQL nebo uložené procedury pro své `InsertCommand`, `UpdateCommand`a `DeleteCommand` vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="3f1b1-121">V tomto kurzu stručně porovnáme a narovnejte korelační poddotazy a `JOIN` s a teprve potom Prozkoumejte, jak vytvořit TableAdapter, který zahrnuje `JOIN` s v hlavním dotazu.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="3f1b1-122">Porovnávání a kontrast u korelačních poddotazů a`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="3f1b1-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="3f1b1-123">Odvolat, že `ProductsTableAdapter` vytvořená v prvním kurzu v datové sadě `Northwind` používá korelační poddotazy k vrácení všech odpovídajících kategorií produktů a názvu dodavatele v souvislosti s nimi.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="3f1b1-124">Hlavní dotaz `ProductsTableAdapter` s je uveden níže.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-124">The `ProductsTableAdapter` s main query is shown below.</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample1.sql)]

<span data-ttu-id="3f1b1-125">Dva korelační poddotazy – `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` a `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` – jsou `SELECT` dotazy, které vracejí jednu hodnotu na produkt jako další sloupec v seznamu vnějších `SELECT` příkazů s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="3f1b1-126">Alternativně můžete `JOIN` použít k vrácení každého dodavatele produktu a názvu kategorie.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="3f1b1-127">Následující dotaz vrátí stejný výstup jako ten, ale používá `JOIN` s místo poddotazů:</span><span class="sxs-lookup"><span data-stu-id="3f1b1-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample2.sql)]

<span data-ttu-id="3f1b1-128">`JOIN` sloučí záznamy z jedné tabulky s záznamy z jiné tabulky na základě některých kritérií.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="3f1b1-129">Ve výše uvedeném dotazu například `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instruuje SQL Server ke sloučení každého záznamu produktu s záznamem kategorie, jehož `CategoryID` hodnota odpovídá hodnotě `CategoryID` produktu s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="3f1b1-130">Sloučený výsledek umožňuje pracovat s odpovídajícími poli kategorií pro každý produkt (například `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="3f1b1-131">`JOIN` s se běžně používají při dotazování dat z relačních databází.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="3f1b1-132">Pokud se syntaxí `JOIN` nepoužíváte nebo potřebujete na svém využití štětce, doporučujeme vám I v [kurzu spojení SQL](http://www.w3schools.com/sql/sql_join.asp) na [w3 školách](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="3f1b1-133">Pro čtení jsou také [`JOIN` základy](https://msdn.microsoft.com/library/ms191517.aspx) a [poddotazování](https://msdn.microsoft.com/library/ms189575.aspx) v sekcích [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>

<span data-ttu-id="3f1b1-134">Vzhledem k tomu, že `JOIN` s a korelační poddotazy lze použít k načtení souvisejících dat z jiných tabulek, mnoho vývojářů si ponechá své hlavy a zajímá, jaký přístup k použití.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="3f1b1-135">Všechny SQL Gurus I v mluvili mají zhruba stejnou věc, že nestačí pro výkon, protože SQL Server vytvoří zhruba totožné plány provádění.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="3f1b1-136">Jejich doporučení a pak je použít techniku, se kterou jste vy a váš tým nejvíc cítí.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="3f1b1-137">Znamená to, že po zaznamenání těchto rad ihned tyto odborníky vyjádří své preference `JOIN` s prostřednictvím korelačních poddotazů.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="3f1b1-138">Při sestavování vrstvy přístupu k datům pomocí zadaných datových sad nástroje fungují lépe při použití poddotazů.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="3f1b1-139">Konkrétně Průvodce TableAdapterem nebude automaticky generovat odpovídající příkazy `INSERT`, `UPDATE`a `DELETE`, pokud hlavní dotaz obsahuje jakékoli `JOIN`, ale tyto příkazy automaticky vygeneruje při použití korelačních poddotazů.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="3f1b1-140">Chcete-li tyto nedostatky prozkoumat, vytvořte v `~/App_Code/DAL` složce dočasnou typovou datovou sadu.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="3f1b1-141">V Průvodci konfigurací TableAdapter se vyberte použít ad hoc příkazy SQL a zadejte následující dotaz `SELECT` (viz obrázek 1):</span><span class="sxs-lookup"><span data-stu-id="3f1b1-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample3.sql)]

<span data-ttu-id="3f1b1-142">[![zadejte hlavní dotaz, který obsahuje spojení.](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span></span>

<span data-ttu-id="3f1b1-143">**Obrázek 1**: Zadejte hlavní dotaz, který obsahuje `JOIN` s ([kliknutím zobrazíte obrázek v plné velikosti).](updating-the-tableadapter-to-use-joins-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span></span>

<span data-ttu-id="3f1b1-144">Ve výchozím nastavení bude TableAdapter automaticky vytvářet `INSERT`, `UPDATE`a `DELETE` příkazy založené na hlavním dotazu.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="3f1b1-145">Pokud kliknete na tlačítko Upřesnit, uvidíte, že je tato funkce povolená.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="3f1b1-146">Bez ohledu na toto nastavení TableAdapter nebude moci vytvořit příkazy `INSERT`, `UPDATE`a `DELETE`, protože hlavní dotaz obsahuje `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>

![Zadejte hlavní dotaz, který obsahuje spojení.](updating-the-tableadapter-to-use-joins-cs/_static/image4.png)

<span data-ttu-id="3f1b1-148">**Obrázek 2**: Zadejte hlavní dotaz, který obsahuje `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>

<span data-ttu-id="3f1b1-149">Kliknutím na Dokončit dokončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="3f1b1-150">V tomto okamžiku Návrhář DataSet obsahuje jeden TableAdapter s DataTable se sloupci pro každé pole vrácené v seznamu sloupců `SELECT` dotazů s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="3f1b1-151">To zahrnuje `CategoryName` a `SupplierName`, jak ukazuje obrázek 3.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>

![Objekt DataTable obsahuje sloupec pro každé pole vrácené v seznamu sloupců.](updating-the-tableadapter-to-use-joins-cs/_static/image5.png)

<span data-ttu-id="3f1b1-153">**Obrázek 3**: objekt DataTable obsahuje sloupec pro každé pole vrácené v seznamu sloupců.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>

<span data-ttu-id="3f1b1-154">I když má objekt DataTable příslušné sloupce, nemá TableAdapter hodnoty pro jeho `InsertCommand`, `UpdateCommand`a vlastnosti `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="3f1b1-155">Potvrďte to tak, že kliknete na TableAdapter v návrháři a pak přejdete na okno Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="3f1b1-156">Uvidíte, že vlastnosti `InsertCommand`, `UpdateCommand`a `DeleteCommand` jsou nastavené na hodnotu (žádné).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>

<span data-ttu-id="3f1b1-157">[![vlastností InsertCommand, UpdateCommand a DeleteCommand jsou nastavené na (žádné).](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span></span>

<span data-ttu-id="3f1b1-158">**Obrázek 4**: vlastnosti `InsertCommand`, `UpdateCommand`a `DeleteCommand` jsou nastaveny na (žádné) ([kliknutím zobrazíte obrázek v plné velikosti).](updating-the-tableadapter-to-use-joins-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span></span>

<span data-ttu-id="3f1b1-159">Pokud chcete tento problém obejít, můžeme ručně zadat příkazy a parametry SQL pro vlastnosti `InsertCommand`, `UpdateCommand`a `DeleteCommand` prostřednictvím okno Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="3f1b1-160">Alternativně můžeme začít konfigurací hlavního dotazu *TableAdapter s, aby* neobsahoval žádné `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="3f1b1-161">Tím umožníte, aby se příkazy `INSERT`, `UPDATE`a `DELETE` automaticky vygenerovaly pro nás.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="3f1b1-162">Po dokončení průvodce můžeme ručně aktualizovat `SelectCommand` TableAdapter s z okno Vlastnosti tak, aby obsahovaly syntaxi `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="3f1b1-163">I když tento přístup funguje, je velmi poměrně křehký při použití ad-hoc dotazů SQL, protože pokaždé, když je hlavní dotaz TableAdapter. znovu nakonfigurován prostřednictvím průvodce, jsou znovu vytvořeny automaticky generované `INSERT`, `UPDATE`a `DELETE` příkazy.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="3f1b1-164">To znamená, že při kliknutí pravým tlačítkem na TableAdapter, zvolením možnosti konfigurovat z místní nabídky by došlo ke ztrátě všech úprav, které jsme později udělali, a pak průvodce znovu dokončil.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="3f1b1-165">Brittleness automaticky generovaných příkazů `INSERT`, `UPDATE`a `DELETE` jsou naštěstí omezené na příkazy SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="3f1b1-166">Pokud vaše TableAdapter používá uložené procedury, můžete přizpůsobit uložené procedury `SelectCommand`, `InsertCommand`, `UpdateCommand`nebo `DeleteCommand` a znovu spustit Průvodce konfigurací TableAdapter bez obav, že uložené procedury budou upraveny.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="3f1b1-167">V několika dalších krocích vytvoříme TableAdapter, který zpočátku používá hlavní dotaz, který vynechává jakékoli `JOIN` s, aby se automaticky vygenerovaly odpovídající uložené procedury INSERT, Update a DELETE.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="3f1b1-168">Pak aktualizujeme `SelectCommand` tak, aby používala `JOIN`, která vrací další sloupce ze souvisejících tabulek.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="3f1b1-169">Nakonec vytvoříme odpovídající třídu vrstvy obchodní logiky a ukážeme použití TableAdapter na webové stránce ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="3f1b1-170">Krok 1: vytvoření TableAdapter pomocí zjednodušeného hlavního dotazu</span><span class="sxs-lookup"><span data-stu-id="3f1b1-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="3f1b1-171">Pro tento kurz přidáme TableAdapter a silně typované DataTable pro tabulku `Employees` v datové sadě `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="3f1b1-172">Tabulka `Employees` obsahuje pole `ReportsTo`, které zadal `EmployeeID` manažera pro zaměstnance.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="3f1b1-173">Například zaměstnanec Anne veselé má `ReportTo` hodnotu 5, což je `EmployeeID` Steven Novák.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="3f1b1-174">V důsledku toho Anne sestavy do Steven, jejího manažera.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="3f1b1-175">Společně s vytvářením sestav o `ReportsTo` hodnotě v jednotlivých zaměstnancích můžete také chtít načíst název svého nadřízeného.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="3f1b1-176">To lze provést pomocí `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="3f1b1-177">Při počátečním vytváření TableAdapter ale pomocí `JOIN` nevylučuje Průvodce automatické generování odpovídajících možností vložení, aktualizace a odstranění.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="3f1b1-178">Proto začneme vytvořením TableAdapter, jehož hlavní dotaz neobsahuje žádné `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="3f1b1-179">Potom v kroku 2 aktualizujeme hlavní uloženou proceduru dotazu, aby se načetl název správce s pomocí `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="3f1b1-180">Začněte tím, že otevřete `NorthwindWithSprocs` datovou sadu ve složce `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="3f1b1-181">Klikněte pravým tlačítkem myši na návrháře, v místní nabídce vyberte možnost Přidat a vyberte položku nabídky TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="3f1b1-182">Tím se spustí Průvodce konfigurací TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="3f1b1-183">Obrázek 5 znázorňuje, že Průvodce vytvoří nové uložené procedury a klikne na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="3f1b1-184">Chcete-li aktualizovat informace o vytváření nových uložených procedur pomocí Průvodce TableAdapterem, Projděte si kurz [vytváření nových uložených procedur pro objekty TableAdapter typované sady dat](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="3f1b1-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="3f1b1-185">[![vyberte možnost vytvořit nové uložené procedury.](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span></span>

<span data-ttu-id="3f1b1-186">**Obrázek 5**: vyberte možnost vytvořit nové uložené procedury ([kliknutím zobrazíte obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-cs/_static/image11.png)).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span></span>

<span data-ttu-id="3f1b1-187">Pro hlavní dotaz TableAdapter s použijte následující příkaz `SELECT`:</span><span class="sxs-lookup"><span data-stu-id="3f1b1-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample4.sql)]

<span data-ttu-id="3f1b1-188">Vzhledem k tomu, že tento dotaz neobsahuje žádné `JOIN` s, Průvodce TableAdapter automaticky vytvoří uložené procedury s odpovídajícími příkazy `INSERT`, `UPDATE`a `DELETE`, jakož i uloženou proceduru pro spuštění hlavního dotazu.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="3f1b1-189">Následující krok umožňuje pojmenovat uložené procedury TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="3f1b1-190">Použijte názvy `Employees_Select`, `Employees_Insert`, `Employees_Update`a `Employees_Delete`, jak je znázorněno na obrázku 6.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>

<span data-ttu-id="3f1b1-191">[![TableAdapter s uloženými procedurami](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span></span>

<span data-ttu-id="3f1b1-192">**Obrázek 6**: pojmenujte uložené procedury TableAdapter s ([kliknutím zobrazíte obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-cs/_static/image14.png)).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span></span>

<span data-ttu-id="3f1b1-193">Poslední krok vás vyzve k pojmenování metod TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="3f1b1-194">Jako názvy metod použijte `Fill` a `GetEmployees`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="3f1b1-195">Nezapomeňte také nechat zaškrtávací políčko vytvořit metody pro odeslání aktualizací přímo do databáze (GenerateDBDirectMethods).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>

<span data-ttu-id="3f1b1-196">[![pojmenovat metody TableAdapter s a GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span></span>

<span data-ttu-id="3f1b1-197">**Obrázek 7**: pojmenování metod TableAdapter s `Fill` a `GetEmployees` ([kliknutím zobrazíte obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="3f1b1-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span></span>

<span data-ttu-id="3f1b1-198">Po dokončení průvodce chvíli počkejte, než se prohledá uložené procedury v databázi.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="3f1b1-199">Měli byste vidět čtyři nové: `Employees_Select`, `Employees_Insert`, `Employees_Update`a `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="3f1b1-200">Potom zkontrolujte `EmployeesDataTable` a `EmployeesTableAdapter` právě vytvořené.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="3f1b1-201">Objekt DataTable obsahuje sloupec pro každé pole vrácené hlavním dotazem.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="3f1b1-202">Klikněte na TableAdapter a potom přejděte na okno Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="3f1b1-203">Uvidíte, že vlastnosti `InsertCommand`, `UpdateCommand`a `DeleteCommand` jsou správně nakonfigurované pro volání odpovídajících uložených procedur.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>

<span data-ttu-id="3f1b1-204">[![TableAdapter zahrnuje možnosti vložení, aktualizace a odstranění.](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span></span>

<span data-ttu-id="3f1b1-205">**Obrázek 8**: TableAdapter zahrnuje možnosti vložení, aktualizace a odstranění ([kliknutím zobrazíte obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-cs/_static/image20.png)).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span></span>

<span data-ttu-id="3f1b1-206">Když se automaticky vytvoří uložené, aktualizovat a odstranit uložené procedury a správně nakonfigurované vlastnosti `InsertCommand`, `UpdateCommand`a `DeleteCommand`, je připraveno přizpůsobit uloženou proceduru `SelectCommand` s, aby vracela Další informace o manažerovi s pracovníkem.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="3f1b1-207">Konkrétně je potřeba aktualizovat uloženou proceduru `Employees_Select` tak, aby používala `JOIN`, a vracet `FirstName` a `LastName` hodnoty Manageru.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="3f1b1-208">Po aktualizaci uložené procedury bude nutné aktualizovat DataTable tak, aby obsahovala tyto další sloupce.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="3f1b1-209">Tyto dvě úlohy budeme řešit v krocích 2 a 3.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="3f1b1-210">Krok 2: přizpůsobení uložené procedury tak, aby zahrnovala`JOIN`</span><span class="sxs-lookup"><span data-stu-id="3f1b1-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="3f1b1-211">Začněte tím, že na Průzkumník serveru zahájíte přechod do složky uložené procedury databáze Northwind a otevřete `Employees_Select` uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="3f1b1-212">Pokud tuto uloženou proceduru nevidíte, klikněte pravým tlačítkem na složku uložené procedury a vyberte aktualizovat.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="3f1b1-213">Aktualizujte uloženou proceduru tak, aby používala `LEFT JOIN` k vrácení jména a příjmení manažera:</span><span class="sxs-lookup"><span data-stu-id="3f1b1-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample5.sql)]

<span data-ttu-id="3f1b1-214">Po aktualizaci příkazu `SELECT` uložte změny tak, že v nabídce soubor kliknete na možnost Uložit `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="3f1b1-215">Případně můžete kliknout na ikonu Uložit na panelu nástrojů nebo stisknout CTRL + S.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="3f1b1-216">Po uložení změn klikněte pravým tlačítkem na `Employees_Select` uloženou proceduru v Průzkumník serveru a vyberte spustit.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="3f1b1-217">Tato akce spustí uloženou proceduru a zobrazí její výsledky v okně výstup (viz obrázek 9).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>

<span data-ttu-id="3f1b1-218">[![výsledky uložených procedur se zobrazí v okno Výstup](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span></span>

<span data-ttu-id="3f1b1-219">**Obrázek 9**: výsledky uložených procedur se zobrazí v okno výstup ([kliknutím zobrazíte obrázek v plné velikosti).](updating-the-tableadapter-to-use-joins-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span></span>

## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="3f1b1-220">Krok 3: aktualizace sloupců DataTable s</span><span class="sxs-lookup"><span data-stu-id="3f1b1-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="3f1b1-221">V tomto okamžiku `Employees_Select` uložená procedura vrací `ManagerFirstName` a `ManagerLastName` hodnoty, ale v `EmployeesDataTable` chybí tyto sloupce.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="3f1b1-222">Tyto chybějící sloupce lze přidat do objektu DataTable jedním ze dvou způsobů:</span><span class="sxs-lookup"><span data-stu-id="3f1b1-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="3f1b1-223">**Ručně** klikněte pravým tlačítkem na DataTable v Návrháři DataSet a v nabídce Přidat vyberte sloupec.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="3f1b1-224">Potom můžete sloupec pojmenovat a nastavit jeho vlastnosti odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="3f1b1-225">**Automaticky** – Průvodce konfigurací TableAdapter aktualizuje sloupce DataTable s tak, aby odrážely pole vrácená `SelectCommand` uloženou procedurou.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="3f1b1-226">Při použití příkazů SQL ad hoc Průvodce odebere taky `InsertCommand`, `UpdateCommand`a `DeleteCommand` vlastnosti, protože `SelectCommand` teď obsahuje `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="3f1b1-227">Při použití uložených procedur ale tyto vlastnosti příkazu zůstanou beze změn.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="3f1b1-228">V předchozích kurzech jsme prozkoumali Ruční přidávání sloupců DataTable, včetně [hlavní položky a podrobností pomocí seznamu hlavních záznamů s odrážkami s podrobnostmi](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) a [nahráním souborů](../working-with-binary-files/uploading-files-cs.md). v našem dalším kurzu se tento proces znovu podíváme podrobněji.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) and [Uploading Files](../working-with-binary-files/uploading-files-cs.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="3f1b1-229">Pro tento kurz ale použijte automatický přístup prostřednictvím Průvodce konfigurací TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="3f1b1-230">Začněte tím, že kliknete pravým tlačítkem na `EmployeesTableAdapter` a v místní nabídce vyberete konfigurovat.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="3f1b1-231">Tím se zobrazí Průvodce konfigurací TableAdapter, který obsahuje uložené procedury používané pro výběr, vložení, aktualizaci a odstranění, spolu s jejich návratovými hodnotami a parametry (pokud existují).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="3f1b1-232">Obrázek 10 ukazuje tohoto průvodce.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="3f1b1-233">Tady vidíte, že `Employees_Select` uložená procedura teď vrací pole `ManagerFirstName` a `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>

<span data-ttu-id="3f1b1-234">[![Průvodce zobrazí aktualizovaný seznam sloupců pro uloženou proceduru Employees_Select](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span></span>

<span data-ttu-id="3f1b1-235">**Obrázek 10**: Průvodce zobrazí aktualizovaný seznam sloupců pro uloženou proceduru `Employees_Select` ([kliknutím zobrazíte obrázek v plné velikosti).](updating-the-tableadapter-to-use-joins-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span></span>

<span data-ttu-id="3f1b1-236">Dokončete průvodce kliknutím na tlačítko Dokončit.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="3f1b1-237">Po návratu do návrháře DataSet `EmployeesDataTable` obsahuje dva další sloupce: `ManagerFirstName` a `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>

<span data-ttu-id="3f1b1-238">[![EmployeesDataTable obsahuje dva nové sloupce.](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span></span>

<span data-ttu-id="3f1b1-239">**Obrázek 11**: `EmployeesDataTable` obsahuje dva nové sloupce ([kliknutím zobrazíte obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-cs/_static/image29.png)).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span></span>

<span data-ttu-id="3f1b1-240">K ilustraci, že je v platnosti aktualizovaný `Employees_Select` uložená procedura a že funkce INSERT, Update a DELETE TableAdapter jsou pořád funkční, umožňuje vytvořit webovou stránku, která uživatelům umožní zobrazit a odstranit zaměstnance.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="3f1b1-241">Předtím, než vytvoříme takovou stránku, musíme nejdřív vytvořit novou třídu v rámci vrstvy obchodní logiky pro práci s zaměstnanci z `NorthwindWithSprocs` datové sady.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="3f1b1-242">V kroku 4 vytvoříme třídu `EmployeesBLLWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="3f1b1-243">V kroku 5 budeme tuto třídu používat ze stránky ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="3f1b1-244">Krok 4: implementace vrstvy obchodní logiky</span><span class="sxs-lookup"><span data-stu-id="3f1b1-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="3f1b1-245">Vytvořte nový soubor třídy ve složce `~/App_Code/BLL` s názvem `EmployeesBLLWithSprocs.cs`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.cs`.</span></span> <span data-ttu-id="3f1b1-246">Tato třída napodobuje sémantiku existující třídy `EmployeesBLL`, pouze tento nový poskytuje méně metod a používá `NorthwindWithSprocs` datovou sadu (místo datové sady `Northwind`).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="3f1b1-247">Do třídy `EmployeesBLLWithSprocs` přidejte následující kód.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>

[!code-csharp[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample6.cs)]

<span data-ttu-id="3f1b1-248">Vlastnost `EmployeesBLLWithSprocs` třídy s `Adapter` vrací instanci `EmployeesTableAdapter``NorthwindWithSprocs` DataSet s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="3f1b1-249">Používá se pro `GetEmployees` třídy a metody `DeleteEmployee`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="3f1b1-250">Metoda `GetEmployees` volá `EmployeesTableAdapter` odpovídající metodu `GetEmployees`, která vyvolá uloženou proceduru `Employees_Select` a naplní její výsledky v `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="3f1b1-251">Metoda `DeleteEmployee` podobně volá metodu `Delete` `EmployeesTableAdapter` s, která vyvolá `Employees_Delete` uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="3f1b1-252">Krok 5: práce s daty v prezentační vrstvě</span><span class="sxs-lookup"><span data-stu-id="3f1b1-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="3f1b1-253">Po dokončení `EmployeesBLLWithSprocs` třídy jsme znovu připraveni pracovat s daty zaměstnanců prostřednictvím stránky ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="3f1b1-254">Otevřete stránku `JOINs.aspx` ve složce `AdvancedDAL` a přetáhněte prvek GridView z panelu nástrojů do návrháře a nastavte jeho vlastnost `ID` na `Employees`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="3f1b1-255">Potom z inteligentní značky GridView s navažte mřížku k novému ovládacímu prvku ObjectDataSource s názvem `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="3f1b1-256">Nakonfigurujte prvek ObjectDataSource tak, aby používal třídu `EmployeesBLLWithSprocs` a na kartách SELECT a DELETE se ujistěte, že jsou v rozevíracích seznamech vybrány metody `GetEmployees` a `DeleteEmployee`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="3f1b1-257">Kliknutím na Dokončit dokončete konfiguraci ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>

<span data-ttu-id="3f1b1-258">[![nakonfigurovat prvek ObjectDataSource tak, aby používal třídu EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span></span>

<span data-ttu-id="3f1b1-259">**Obrázek 12**: Konfigurace prvku ObjectDataSource, aby používal třídu `EmployeesBLLWithSprocs` ([kliknutím zobrazíte obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="3f1b1-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span></span>

<span data-ttu-id="3f1b1-260">[![mají ObjectDataSource použít metody GetEmployees a DeleteEmployee](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span></span>

<span data-ttu-id="3f1b1-261">**Obrázek 13**: v prvku ObjectDataSource použijte metody `GetEmployees` a `DeleteEmployee` ([kliknutím zobrazíte obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-cs/_static/image35.png)).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span></span>

<span data-ttu-id="3f1b1-262">Visual Studio přidá do prvku GridView vlastnost BoundField pro každý sloupec `EmployeesDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="3f1b1-263">Odeberte všechny tyto BoundFields s výjimkou `Title`, `LastName`, `FirstName`, `ManagerFirstName`a `ManagerLastName` a přejmenujte `HeaderText` vlastnosti pro poslední čtyři BoundFields na příjmení, jméno, správce s křestní jméno a správce s příjmení, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="3f1b1-264">Pokud chcete uživatelům povolit odstranění zaměstnanců z této stránky, musíme udělat dvě věci.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="3f1b1-265">Nejdřív dejte pokyn prvku GridView, aby poskytoval možnosti odstranění, a to zaškrtnutím možnosti Povolit odstranění z inteligentní značky.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="3f1b1-266">Potom změňte vlastnost ObjectDataSource s `OldValuesParameterFormatString` z hodnoty nastavené průvodcem ObjectDataSource (`original_{0}`) na jeho výchozí hodnotu (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="3f1b1-267">Po provedení těchto změn by deklarativní značky GridView a ObjectDataSource s měly vypadat podobně jako následující:</span><span class="sxs-lookup"><span data-stu-id="3f1b1-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample7.aspx)]

<span data-ttu-id="3f1b1-268">Otestujte stránku tím, že na ni navštívíte přes prohlížeč.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="3f1b1-269">Jak ukazuje obrázek 14, na stránce se zobrazí seznam všech zaměstnanců a jejich název manažera (za předpokladu, že mají jednu).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>

<span data-ttu-id="3f1b1-270">[![spojení v uložené proceduře Employees_Select vrátí název správce.](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span></span>

<span data-ttu-id="3f1b1-271">**Obrázek 14**: `JOIN` v uložené proceduře `Employees_Select` vrátí název správce s ([kliknutím zobrazíte obrázek v plné velikosti).](updating-the-tableadapter-to-use-joins-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span></span>

<span data-ttu-id="3f1b1-272">Kliknutím na tlačítko Odstranit spustíte pracovní postup odstranění, který má za následek provedení `Employees_Delete` uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="3f1b1-273">Pokus o `DELETE` příkaz v uložené proceduře se ale nezdařil z důvodu porušení omezení cizího klíče (viz obrázek 15).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="3f1b1-274">Konkrétně každý zaměstnanec má jeden nebo více záznamů v tabulce `Orders`, což způsobí selhání odstranění.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>

<span data-ttu-id="3f1b1-275">[![odstranění zaměstnance, který má odpovídající objednávky, má za následek porušení omezení cizího klíče.](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span></span>

<span data-ttu-id="3f1b1-276">**Obrázek 15**: odstranění zaměstnance, který má odpovídající objednávky, má za následek porušení omezení cizího klíče ([kliknutím zobrazíte obrázek v plné velikosti).](updating-the-tableadapter-to-use-joins-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span></span>

<span data-ttu-id="3f1b1-277">Aby bylo možné zaměstnance odstranit, můžete:</span><span class="sxs-lookup"><span data-stu-id="3f1b1-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="3f1b1-278">Aktualizace omezení cizího klíče pro kaskádové odstranění</span><span class="sxs-lookup"><span data-stu-id="3f1b1-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="3f1b1-279">Ručně odstraňte záznamy z `Orders` tabulky pro zaměstnance, které chcete odstranit, nebo</span><span class="sxs-lookup"><span data-stu-id="3f1b1-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="3f1b1-280">Aktualizujte `Employees_Delete` uloženou proceduru tak, aby nejdřív před odstraněním záznamu `Employees` odstranila související záznamy z tabulky `Orders`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="3f1b1-281">Tuto techniku jsme probrali v kurzu [použití existujících uložených procedur pro objekty TableAdapter typované datové sady](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="3f1b1-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="3f1b1-282">Tuto funkci mám jako cvičení pro čtenáře.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="3f1b1-283">Souhrn</span><span class="sxs-lookup"><span data-stu-id="3f1b1-283">Summary</span></span>

<span data-ttu-id="3f1b1-284">Při práci s relačními databázemi je běžné, že dotazy budou přijímat data z více souvisejících tabulek.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="3f1b1-285">Korelační poddotazy a `JOIN` s poskytují dvě různé techniky pro přístup k datům ze souvisejících tabulek v dotazu.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="3f1b1-286">V předchozích kurzech jsme nejčastěji používali korelační poddotazy, protože TableAdapter nemůže automaticky generovat příkazy `INSERT`, `UPDATE`a `DELETE` pro dotazy zahrnující `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="3f1b1-287">I když je možné tyto hodnoty zadat ručně, při použití ad-hoc příkazů SQL budou po dokončení Průvodce konfigurací TableAdapter přepsány jakékoli vlastní nastavení.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="3f1b1-288">Naštěstí objekty TableAdapter vytvořené pomocí uložených procedur netrpí stejnými brittleness, jako ty, které se vytvořily pomocí ad-hoc příkazů SQL.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="3f1b1-289">Proto je vhodné vytvořit TableAdapter, jehož hlavní dotaz používá při použití uložených procedur `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="3f1b1-290">V tomto kurzu jsme viděli, jak TableAdapter vytvořit.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="3f1b1-291">Zahájili jsme použití `SELECT`ho dotazu `JOIN`pro hlavní dotaz TableAdapter s, aby byly automaticky vytvořeny odpovídající uložené procedury INSERT, Update a DELETE.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="3f1b1-292">Po dokončení počáteční konfigurace TableAdapter jsme naplnili `SelectCommand` uloženou proceduru k použití `JOIN` a znovu spustili Průvodce konfigurací TableAdapter a aktualizovali sloupce `EmployeesDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="3f1b1-293">Po opětovném spuštění Průvodce konfigurací TableAdapter se automaticky aktualizují `EmployeesDataTable` sloupce tak, aby odrážely datová pole vrácená `Employees_Select` uloženou procedurou.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="3f1b1-294">Alternativně jsme mohli tyto sloupce do objektu DataTable přidat ručně.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="3f1b1-295">V dalším kurzu budeme prozkoumat ručním přidáním sloupců do objektu DataTable.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="3f1b1-296">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="3f1b1-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="3f1b1-297">O autorovi</span><span class="sxs-lookup"><span data-stu-id="3f1b1-297">About the Author</span></span>

<span data-ttu-id="3f1b1-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor 7 ASP/ASP. NET Books a zakladatel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3f1b1-299">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3f1b1-300">Nejnovější kniha je [*Sams naučit se ASP.NET 2,0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="3f1b1-301">Dá se získat na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="3f1b1-302">nebo prostřednictvím svého blogu, který najdete na adrese [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="3f1b1-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="3f1b1-303">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="3f1b1-303">Special Thanks To</span></span>

<span data-ttu-id="3f1b1-304">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3f1b1-305">Kontroloři vedoucích k tomuto kurzu byli Hilton Geisenow, David Suru a Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="3f1b1-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="3f1b1-306">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="3f1b1-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3f1b1-307">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="3f1b1-308">[Předchozí](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
> [Další](adding-additional-datatable-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="3f1b1-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
[Next](adding-additional-datatable-columns-cs.md)</span></span>
