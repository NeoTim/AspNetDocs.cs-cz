---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-cs
title: Práce s počítanými sloupciC#() | Microsoft Docs
author: rick-anderson
description: Při vytváření tabulky databáze Microsoft SQL Server umožňuje definovat počítaný sloupec, jehož hodnota je vypočítána z výrazu, který je obvykle referen...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 57459065-ed7c-4dfe-ac9c-54c093abc261
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-cs
msc.type: authoredcontent
ms.openlocfilehash: ad6a96f2721510c2478f707c8eed018ae797f27a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78531792"
---
# <a name="working-with-computed-columns-c"></a><span data-ttu-id="eaad5-103">Práce s vypočítanými sloupci (C#)</span><span class="sxs-lookup"><span data-stu-id="eaad5-103">Working with Computed Columns (C#)</span></span>

<span data-ttu-id="eaad5-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="eaad5-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="eaad5-105">[Stažení kódu](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_CS.zip) nebo [stažení PDF](working-with-computed-columns-cs/_static/datatutorial71cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="eaad5-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_CS.zip) or [Download PDF](working-with-computed-columns-cs/_static/datatutorial71cs1.pdf)</span></span>

> <span data-ttu-id="eaad5-106">Při vytváření tabulky databáze Microsoft SQL Server umožňuje definovat počítaný sloupec, jehož hodnota je vypočítána z výrazu, který obvykle odkazuje na jiné hodnoty ve stejném záznamu databáze.</span><span class="sxs-lookup"><span data-stu-id="eaad5-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="eaad5-107">Tyto hodnoty jsou v databázi jen pro čtení, což vyžaduje zvláštní požadavky při práci s objekty TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="eaad5-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="eaad5-108">V tomto kurzu se dozvíte, jak splnit problémy, které představují vypočítané sloupce.</span><span class="sxs-lookup"><span data-stu-id="eaad5-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="eaad5-109">Úvod</span><span class="sxs-lookup"><span data-stu-id="eaad5-109">Introduction</span></span>

<span data-ttu-id="eaad5-110">Microsoft SQL Server umožňuje *[vypočítané sloupce](https://msdn.microsoft.com/library/ms191250.aspx)* , které jsou sloupce, jejichž hodnoty jsou vypočítány z výrazu, který obvykle odkazuje na hodnoty z jiných sloupců ve stejné tabulce.</span><span class="sxs-lookup"><span data-stu-id="eaad5-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="eaad5-111">Například datový model sledování času může mít tabulku s názvem `ServiceLog` se sloupci, včetně `ServicePerformed`, `EmployeeID`, `Rate`a `Duration`, mimo jiné.</span><span class="sxs-lookup"><span data-stu-id="eaad5-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="eaad5-112">I když může být částka splatná na jednu z položek služby (sazba vynásobená dobou trvání) pomocí webové stránky nebo jiného programového rozhraní, může být užitečné zahrnout sloupec do `ServiceLog` tabulky s názvem `AmountDue`, která tyto informace ohlásila.</span><span class="sxs-lookup"><span data-stu-id="eaad5-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="eaad5-113">Tento sloupec se dá vytvořit jako normální sloupec, ale je potřeba ho aktualizovat, aby se změnily hodnoty `Rate` nebo `Duration` sloupce.</span><span class="sxs-lookup"><span data-stu-id="eaad5-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="eaad5-114">Lepším řešením je nastavit `AmountDue` sloupec jako počítaný sloupec pomocí `Rate * Duration`výrazů.</span><span class="sxs-lookup"><span data-stu-id="eaad5-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="eaad5-115">To by způsobilo, SQL Server automaticky vypočítat hodnotu `AmountDue` sloupce pokaždé, když se na ni odkazuje v dotazu.</span><span class="sxs-lookup"><span data-stu-id="eaad5-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="eaad5-116">Vzhledem k tomu, že hodnota počítaného sloupce je určena výrazem, jsou tyto sloupce určeny pouze pro čtení, a proto nemohou mít přiřazené hodnoty v `INSERT` nebo `UPDATE`ch příkazech.</span><span class="sxs-lookup"><span data-stu-id="eaad5-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="eaad5-117">Pokud jsou však vypočítané sloupce součástí hlavního dotazu pro TableAdapter, který používá příkazy SQL ad hoc, jsou automaticky zahrnuty do automaticky generovaných příkazů `INSERT` a `UPDATE`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="eaad5-118">V důsledku toho je nutné aktualizovat TableAdapter s `INSERT` a `UPDATE` dotazy a `InsertCommand` a `UpdateCommand` vlastnosti pro odebrání odkazů na vypočítané sloupce.</span><span class="sxs-lookup"><span data-stu-id="eaad5-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="eaad5-119">Jednou z výzev k použití počítaných sloupců s TableAdapter, který používá příkazy SQL ad-hoc, je, že se automaticky znovu vygenerovaly dotazy TableAdapter s `INSERT` a `UPDATE`, kdykoli Průvodce konfigurací TableAdapter dokončen.</span><span class="sxs-lookup"><span data-stu-id="eaad5-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="eaad5-120">Proto se vypočítané sloupce ručně odeberou z `INSERT` a dotazy `UPDATE` se znovu zobrazí, pokud se průvodce znovu spustí.</span><span class="sxs-lookup"><span data-stu-id="eaad5-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="eaad5-121">I když objekty TableAdapter, které používají uložené procedury, od tohoto brittleness nepřijde, mají vlastní adaptivní, které budeme řešit v kroku 3.</span><span class="sxs-lookup"><span data-stu-id="eaad5-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="eaad5-122">V tomto kurzu přidáme vypočítaný sloupec do tabulky `Suppliers` v databázi Northwind a pak vytvoříte odpovídající TableAdapter pro práci s touto tabulkou a jejím vypočítaným sloupcem.</span><span class="sxs-lookup"><span data-stu-id="eaad5-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="eaad5-123">Naše TableAdapter použije uložené procedury místo ad-hoc příkazů SQL, takže naše přizpůsobení nebudou po použití Průvodce konfigurací TableAdapter ztracena.</span><span class="sxs-lookup"><span data-stu-id="eaad5-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren't lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="eaad5-124">Pojďme začít!</span><span class="sxs-lookup"><span data-stu-id="eaad5-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="eaad5-125">Krok 1: Přidání vypočítaného sloupce do tabulky`Suppliers`</span><span class="sxs-lookup"><span data-stu-id="eaad5-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="eaad5-126">Databáze Northwind neobsahuje žádné počítané sloupce, takže je potřeba přidat jednu dodržovali.</span><span class="sxs-lookup"><span data-stu-id="eaad5-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="eaad5-127">V tomto kurzu přidáme vypočítaný sloupec do tabulky `Suppliers` s názvem `FullContactName`, která vrací kontakt s názvem, názvem a společností, pro kterou pracují, v následujícím formátu: `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="eaad5-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="eaad5-128">Tento počítaný sloupec může být použit v sestavách při zobrazení informací o dodavatelích.</span><span class="sxs-lookup"><span data-stu-id="eaad5-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="eaad5-129">Začněte otevřením `Suppliers` definice tabulky kliknutím pravým tlačítkem myši na tabulku `Suppliers` v Průzkumník serveru a výběrem možnosti otevřít definici tabulky z kontextové nabídky.</span><span class="sxs-lookup"><span data-stu-id="eaad5-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="eaad5-130">Zobrazí se sloupce tabulky a jejich vlastnosti, jako je například datový typ, ať už `NULL` s a tak dále.</span><span class="sxs-lookup"><span data-stu-id="eaad5-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="eaad5-131">Chcete-li přidat vypočítaný sloupec, začněte zadáním názvu sloupce do definice tabulky.</span><span class="sxs-lookup"><span data-stu-id="eaad5-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="eaad5-132">V dalším kroku zadejte svůj výraz do textového pole (vzorec) pod oddílem specifikace vypočítaného sloupce ve sloupci okno Vlastnosti (viz obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="eaad5-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="eaad5-133">Vypočítaný sloupec pojmenujte `FullContactName` a použijte následující výraz:</span><span class="sxs-lookup"><span data-stu-id="eaad5-133">Name the computed column `FullContactName` and use the following expression:</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample1.sql)]

<span data-ttu-id="eaad5-134">Všimněte si, že řetězce lze zřetězit v SQL pomocí operátoru `+`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="eaad5-135">Příkaz `CASE` lze použít jako podmíněný v tradičním programovacím jazyce.</span><span class="sxs-lookup"><span data-stu-id="eaad5-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="eaad5-136">Ve výrazu výše lze příkaz `CASE` přečíst jako: Pokud `ContactTitle` není `NULL` pak výstup hodnoty `ContactTitle` zřetězené s čárkou, jinak vygeneruje nic.</span><span class="sxs-lookup"><span data-stu-id="eaad5-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="eaad5-137">Další informace o užitečnosti `CASE` příkazu naleznete v tématu [výkon příkazů SQL `CASE`](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="eaad5-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="eaad5-138">Místo použití `CASE`ho příkazu zde můžeme použít jinou `ISNULL(ContactTitle, '')`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="eaad5-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) vrátí *checkExpression* , pokud není null, jinak vrátí *replacementValue*.</span><span class="sxs-lookup"><span data-stu-id="eaad5-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="eaad5-140">I když `ISNULL` nebo `CASE` v této instanci budou fungovat, existují složitější scénáře, kdy flexibilitu příkazu `CASE` nemůže odpovídat `ISNULL`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>

<span data-ttu-id="eaad5-141">Po přidání tohoto vypočítaného sloupce by vaše obrazovka měla vypadat jako snímek obrazovky na obrázku 1.</span><span class="sxs-lookup"><span data-stu-id="eaad5-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>

<span data-ttu-id="eaad5-142">[![do tabulky Dodavatelé přidat vypočítaný sloupec s názvem FullContactName](working-with-computed-columns-cs/_static/image2.png)](working-with-computed-columns-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-cs/_static/image2.png)](working-with-computed-columns-cs/_static/image1.png)</span></span>

<span data-ttu-id="eaad5-143">**Obrázek 1**: přidejte do tabulky `Suppliers` vypočítaný sloupec s názvem `FullContactName` ([kliknutím zobrazíte obrázek v plné velikosti).](working-with-computed-columns-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-cs/_static/image3.png))</span></span>

<span data-ttu-id="eaad5-144">Po pojmenování vypočítaného sloupce a zadání jeho výrazu uložte změny v tabulce kliknutím na ikonu Uložit na panelu nástrojů, podržením klávesy CTRL + S nebo přechodem do nabídky soubor a výběrem možnosti Uložit `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="eaad5-145">Uložení tabulky by mělo aktualizovat Průzkumník serveru, včetně právě přidaného sloupce v seznamu sloupců `Suppliers` tabulky s.</span><span class="sxs-lookup"><span data-stu-id="eaad5-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="eaad5-146">Kromě toho se výraz zadaný do textového pole (vzorec) automaticky upraví na ekvivalentní výraz, který odstraní nadbytečné prázdné znaky, obklopuje názvy sloupců s hranatými závorkami (`[]`) a obsahuje závorky k explicitnímu zobrazení pořadí operací:</span><span class="sxs-lookup"><span data-stu-id="eaad5-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample2.sql)]

<span data-ttu-id="eaad5-147">Další informace o vypočítaných sloupcích v Microsoft SQL Server najdete v [technické dokumentaci](https://msdn.microsoft.com/library/ms191250.aspx).</span><span class="sxs-lookup"><span data-stu-id="eaad5-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="eaad5-148">Také si přečtěte téma [Postupy: určení vypočítaných sloupců](https://msdn.microsoft.com/library/ms188300.aspx) pro podrobný návod k vytváření počítaných sloupců.</span><span class="sxs-lookup"><span data-stu-id="eaad5-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="eaad5-149">Ve výchozím nastavení nejsou vypočítané sloupce fyzicky uloženy v tabulce, ale místo toho jsou přepočítány pokaždé, když jsou odkazovány v dotazu.</span><span class="sxs-lookup"><span data-stu-id="eaad5-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="eaad5-150">Zaškrtnutím políčka je trvalé, ale můžete dát SQL Server k fyzickému uložení vypočítaného sloupce v tabulce.</span><span class="sxs-lookup"><span data-stu-id="eaad5-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="eaad5-151">To umožňuje vytvořit index pro vypočítaný sloupec, což může zlepšit výkon dotazů, které používají vypočítanou hodnotu sloupce ve svých `WHERE` klauzulích.</span><span class="sxs-lookup"><span data-stu-id="eaad5-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="eaad5-152">Další informace najdete v tématu [vytváření indexů na počítaných sloupcích](https://msdn.microsoft.com/library/ms189292.aspx) .</span><span class="sxs-lookup"><span data-stu-id="eaad5-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>

## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="eaad5-153">Krok 2: zobrazení hodnot počítaných sloupců</span><span class="sxs-lookup"><span data-stu-id="eaad5-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="eaad5-154">Předtím, než začneme pracovat na vrstvě pro přístup k datům, může trvat několik minut, než se zobrazí `FullContactName` hodnoty.</span><span class="sxs-lookup"><span data-stu-id="eaad5-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="eaad5-155">Z Průzkumník serveru klikněte pravým tlačítkem myši na název tabulky `Suppliers` a v místní nabídce vyberte možnost Nový dotaz.</span><span class="sxs-lookup"><span data-stu-id="eaad5-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="eaad5-156">Tím zobrazíte okno dotazu, které vás vyzve k výběru tabulek, které se mají zahrnout do dotazu.</span><span class="sxs-lookup"><span data-stu-id="eaad5-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="eaad5-157">Přidejte `Suppliers`ovou tabulku a klikněte na Zavřít.</span><span class="sxs-lookup"><span data-stu-id="eaad5-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="eaad5-158">Dále v tabulce Dodavatelé vyhledejte sloupce `CompanyName`, `ContactName`, `ContactTitle`a `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="eaad5-159">Nakonec klikněte na ikonu červeného vykřičníku na panelu nástrojů a spusťte dotaz a zobrazte výsledky.</span><span class="sxs-lookup"><span data-stu-id="eaad5-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="eaad5-160">Jak ukazuje obrázek 2, výsledky zahrnují `FullContactName`, které vypisuje sloupce `CompanyName`, `ContactName`a `ContactTitle` ve formátu ";`ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="eaad5-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format ldquo;`ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="eaad5-161">[![FullContactName používá formát kontakt (ContactTitle, CompanyName).](working-with-computed-columns-cs/_static/image5.png)](working-with-computed-columns-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-cs/_static/image5.png)](working-with-computed-columns-cs/_static/image4.png)</span></span>

<span data-ttu-id="eaad5-162">**Obrázek 2**: `FullContactName` používá formát `ContactName` (`ContactTitle`, `CompanyName`) ([kliknutím zobrazíte obrázek v plné velikosti).](working-with-computed-columns-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-cs/_static/image6.png))</span></span>

## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="eaad5-163">Krok 3: Přidání`SuppliersTableAdapter`do vrstvy přístupu k datům</span><span class="sxs-lookup"><span data-stu-id="eaad5-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="eaad5-164">Aby bylo možné pracovat s informacemi o dodavatelích v naší aplikaci, musíme nejdřív vytvořit TableAdapter a DataTable v naší DAL.</span><span class="sxs-lookup"><span data-stu-id="eaad5-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="eaad5-165">V ideálním případě by to bylo provedeno pomocí stejných přímočarých kroků, které byly zkontrolovány v předchozích kurzech.</span><span class="sxs-lookup"><span data-stu-id="eaad5-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="eaad5-166">Práce s počítanými sloupci ale zavádí několik wrinklesů, které je dobré diskutovat.</span><span class="sxs-lookup"><span data-stu-id="eaad5-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="eaad5-167">Pokud používáte TableAdapter, který používá příkazy SQL ad hoc, můžete do hlavního dotazu TableAdaptery jednoduše vložit vypočítaný sloupec prostřednictvím Průvodce konfigurací TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="eaad5-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="eaad5-168">Tato akce však automaticky generuje `INSERT` a `UPDATE` příkazy, které obsahují vypočítaný sloupec.</span><span class="sxs-lookup"><span data-stu-id="eaad5-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="eaad5-169">Pokud se pokusíte spustit jednu z těchto metod, `SqlException` se zprávou sloupec *ColumnName* sloupce nelze změnit, protože se jedná o vypočítaný sloupec nebo je vyvolána výsledek OPERÁTORu sjednocení.</span><span class="sxs-lookup"><span data-stu-id="eaad5-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="eaad5-170">I když lze příkaz `INSERT` a `UPDATE` ručně upravit prostřednictvím `InsertCommand` TableAdapter s a `UpdateCommand` vlastností, budou při každém opětovném spuštění Průvodce konfigurací TableAdapter ztraceny tyto vlastní úpravy.</span><span class="sxs-lookup"><span data-stu-id="eaad5-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="eaad5-171">Vzhledem k tomu, že brittleness objekty TableAdapter, které používají příkazy SQL ad-hoc, se doporučuje použít uložené procedury při práci s vypočítanými sloupci.</span><span class="sxs-lookup"><span data-stu-id="eaad5-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="eaad5-172">Pokud používáte stávající uložené procedury, jednoduše nakonfigurujte TableAdapter, jak je popsáno v kurzu [použití existujících uložených procedur pro typový objekty TableAdapter sady typů](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="eaad5-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="eaad5-173">Máte-li Průvodce TableAdapter vytvořit uložené procedury pro vás, je důležité nejprve vynechat všechny vypočítané sloupce z hlavního dotazu.</span><span class="sxs-lookup"><span data-stu-id="eaad5-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="eaad5-174">Pokud zahrnete do hlavního dotazu vypočítaný sloupec, Průvodce konfigurací TableAdapter vám po dokončení upozorní, že nemůže vytvořit odpovídající uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="eaad5-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="eaad5-175">V krátkém případě je potřeba nejdřív nakonfigurovat TableAdapter pomocí vypočítaného hlavního dotazu bez sloupců a pak ručně aktualizovat odpovídající uloženou proceduru a `SelectCommand` TableAdapter s, aby zahrnovaly vypočítaný sloupec.</span><span class="sxs-lookup"><span data-stu-id="eaad5-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="eaad5-176">Tento přístup je podobný jako ten, který se používá v kurzu [aktualizace TableAdapter pro použití](updating-the-tableadapter-to-use-joins-cs.md)`JOIN`*s* .</span><span class="sxs-lookup"><span data-stu-id="eaad5-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-cs.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="eaad5-177">Pro tento kurz přidejte nové TableAdapter a nechte si automaticky vytvořit uložené procedury pro nás.</span><span class="sxs-lookup"><span data-stu-id="eaad5-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="eaad5-178">V důsledku toho bude nutné zpočátku z hlavního dotazu vynechat vypočítaný sloupec `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="eaad5-179">Začněte tím, že otevřete `NorthwindWithSprocs` datovou sadu ve složce `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="eaad5-180">Klikněte pravým tlačítkem myši v návrháři a v místní nabídce vyberte možnost Přidat nový TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="eaad5-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="eaad5-181">Tím se spustí Průvodce konfigurací TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="eaad5-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="eaad5-182">Zadejte databázi, ze které se mají dotazovat data (`NORTHWNDConnectionString` z `Web.config`) a klikněte na další.</span><span class="sxs-lookup"><span data-stu-id="eaad5-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="eaad5-183">Vzhledem k tomu, že jsme ještě nevytvořili žádné uložené procedury pro dotazování nebo úpravu `Suppliers` tabulky, vyberte možnost vytvořit nové uložené procedury, aby ji průvodce vytvořil pro nás a klikněte na další.</span><span class="sxs-lookup"><span data-stu-id="eaad5-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>

<span data-ttu-id="eaad5-184">[![zvolit možnost vytvořit nové uložené procedury](working-with-computed-columns-cs/_static/image8.png)](working-with-computed-columns-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-cs/_static/image8.png)](working-with-computed-columns-cs/_static/image7.png)</span></span>

<span data-ttu-id="eaad5-185">**Obrázek 3**: vyberte možnost vytvořit nové uložené procedury ([kliknutím zobrazíte obrázek v plné velikosti).](working-with-computed-columns-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-cs/_static/image9.png))</span></span>

<span data-ttu-id="eaad5-186">V dalším kroku se zobrazí výzva pro hlavní dotaz.</span><span class="sxs-lookup"><span data-stu-id="eaad5-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="eaad5-187">Zadejte následující dotaz, který vrací sloupce `SupplierID`, `CompanyName`, `ContactName`a `ContactTitle` pro každého dodavatele.</span><span class="sxs-lookup"><span data-stu-id="eaad5-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="eaad5-188">Všimněte si, že tento dotaz záměrně vynechá vypočítaný sloupec (`FullContactName`); odpovídající uloženou proceduru aktualizujeme tak, aby obsahovala tento sloupec v kroku 4.</span><span class="sxs-lookup"><span data-stu-id="eaad5-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample3.sql)]

<span data-ttu-id="eaad5-189">Po zadání hlavního dotazu a kliknutí na tlačítko Další vám Průvodce umožní pojmenovat čtyři uložené procedury, které budou vygenerovány.</span><span class="sxs-lookup"><span data-stu-id="eaad5-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="eaad5-190">Pojmenujte tyto uložené procedury `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`a `Suppliers_Delete`, jak ukazuje obrázek 4.</span><span class="sxs-lookup"><span data-stu-id="eaad5-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>

<span data-ttu-id="eaad5-191">[![přizpůsobení názvů automaticky generovaných uložených procedur](working-with-computed-columns-cs/_static/image11.png)](working-with-computed-columns-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-cs/_static/image11.png)](working-with-computed-columns-cs/_static/image10.png)</span></span>

<span data-ttu-id="eaad5-192">**Obrázek 4**: Přizpůsobení názvů automaticky generovaných uložených procedur ([kliknutím zobrazíte obrázek v plné velikosti](working-with-computed-columns-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="eaad5-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-cs/_static/image12.png))</span></span>

<span data-ttu-id="eaad5-193">Další krok průvodce vám umožní pojmenovat metody TableAdapter s a zadat vzory používané pro přístup k datům a jejich aktualizaci.</span><span class="sxs-lookup"><span data-stu-id="eaad5-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="eaad5-194">Nechejte zaškrtnutá všechna tři zaškrtávací políčka, ale přejmenujte metodu `GetData` na `GetSuppliers`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="eaad5-195">Kliknutím na Dokončit dokončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="eaad5-195">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="eaad5-196">[![přejmenovat metodu GetData na getsuppliers](working-with-computed-columns-cs/_static/image14.png)](working-with-computed-columns-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-cs/_static/image14.png)](working-with-computed-columns-cs/_static/image13.png)</span></span>

<span data-ttu-id="eaad5-197">**Obrázek 5**: Přejmenujte metodu `GetData` na `GetSuppliers` ([kliknutím zobrazíte obrázek v plné velikosti).](working-with-computed-columns-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-cs/_static/image15.png))</span></span>

<span data-ttu-id="eaad5-198">Po kliknutí na tlačítko Dokončit průvodce vytvoří čtyři uložené procedury a přidá TableAdapter a odpovídající DataTable do typované datové sady.</span><span class="sxs-lookup"><span data-stu-id="eaad5-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="eaad5-199">Krok 4: zahrnutí vypočítaného sloupce do hlavního dotazu TableAdapter s</span><span class="sxs-lookup"><span data-stu-id="eaad5-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="eaad5-200">Teď je potřeba aktualizovat TableAdapter a DataTable vytvořené v kroku 3, aby zahrnovaly vypočítaný sloupec `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="eaad5-201">To zahrnuje dva kroky:</span><span class="sxs-lookup"><span data-stu-id="eaad5-201">This involves two steps:</span></span>

1. <span data-ttu-id="eaad5-202">Aktualizace uložené procedury `Suppliers_Select` pro vrácení `FullContactName` vypočítaného sloupce a</span><span class="sxs-lookup"><span data-stu-id="eaad5-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="eaad5-203">Aktualizace objektu DataTable tak, aby zahrnovala odpovídající sloupec `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="eaad5-204">Začněte tím, že přejdete na Průzkumník serveru a rozcházíte do složky uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="eaad5-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="eaad5-205">Otevřete `Suppliers_Select` uloženou proceduru a aktualizujte dotaz `SELECT` tak, aby zahrnoval `FullContactName` počítaný sloupec:</span><span class="sxs-lookup"><span data-stu-id="eaad5-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample4.sql)]

<span data-ttu-id="eaad5-206">Uložte změny uložené procedury kliknutím na ikonu Uložit na panelu nástrojů, podržením klávesy CTRL + S nebo výběrem možnosti Uložit `Suppliers_Select` v nabídce soubor.</span><span class="sxs-lookup"><span data-stu-id="eaad5-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="eaad5-207">Potom se vraťte do návrháře DataSet, klikněte pravým tlačítkem na `SuppliersTableAdapter`a v místní nabídce vyberte Konfigurovat.</span><span class="sxs-lookup"><span data-stu-id="eaad5-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="eaad5-208">Všimněte si, že sloupec `Suppliers_Select` nyní obsahuje sloupec `FullContactName` v kolekci datových sloupců.</span><span class="sxs-lookup"><span data-stu-id="eaad5-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>

<span data-ttu-id="eaad5-209">[Pokud chcete aktualizovat sloupce DataTable s, ![spusťte Průvodce konfigurací TableAdapter s.](working-with-computed-columns-cs/_static/image17.png)](working-with-computed-columns-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-cs/_static/image17.png)](working-with-computed-columns-cs/_static/image16.png)</span></span>

<span data-ttu-id="eaad5-210">**Obrázek 6**: spusťte Průvodce konfigurací TableAdapter s a aktualizujte sloupce DataTable s ([kliknutím zobrazíte obrázek v plné velikosti).](working-with-computed-columns-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-cs/_static/image18.png))</span></span>

<span data-ttu-id="eaad5-211">Kliknutím na Dokončit dokončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="eaad5-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="eaad5-212">Tím se automaticky přidá odpovídající sloupec do `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="eaad5-213">Průvodce TableAdapter je dostatečně inteligentní, aby zjistil, že `FullContactName` sloupec je vypočítaný sloupec, a proto jen pro čtení.</span><span class="sxs-lookup"><span data-stu-id="eaad5-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="eaad5-214">V důsledku toho nastaví vlastnost `ReadOnly` sloupců na hodnotu `true`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="eaad5-215">Pokud to chcete ověřit, vyberte sloupec z `SuppliersDataTable` a potom přejděte na okno Vlastnosti (viz obrázek 7).</span><span class="sxs-lookup"><span data-stu-id="eaad5-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="eaad5-216">Všimněte si, že vlastnosti `FullContactName` sloupce s `DataType` a `MaxLength` jsou nastaveny také odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="eaad5-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>

<span data-ttu-id="eaad5-217">[![sloupec FullContactName je označen jen pro čtení.](working-with-computed-columns-cs/_static/image20.png)](working-with-computed-columns-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-cs/_static/image20.png)](working-with-computed-columns-cs/_static/image19.png)</span></span>

<span data-ttu-id="eaad5-218">**Obrázek 7**: `FullContactName` sloupec je označen jen pro čtení ([kliknutím zobrazíte obrázek v plné velikosti](working-with-computed-columns-cs/_static/image21.png)).</span><span class="sxs-lookup"><span data-stu-id="eaad5-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-cs/_static/image21.png))</span></span>

## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="eaad5-219">Krok 5: Přidání metody`GetSupplierBySupplierID`do TableAdapter</span><span class="sxs-lookup"><span data-stu-id="eaad5-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="eaad5-220">V tomto kurzu vytvoříme stránku ASP.NET, která zobrazí dodavatele v mřížce s aktualizovatelným zobrazením.</span><span class="sxs-lookup"><span data-stu-id="eaad5-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="eaad5-221">V minulých kurzech aktualizovali jeden záznam z vrstvy obchodní logiky načtením tohoto konkrétního záznamu z DAL jako silně typovaného objektu DataTable, aktualizací vlastností a následným odesláním aktualizovaného objektu DataTable zpátky zpět na DAL, aby se změny rozšířily. databáze.</span><span class="sxs-lookup"><span data-stu-id="eaad5-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="eaad5-222">Abyste mohli provést tento první krok – načte se záznam, který se aktualizuje z DAL, musíme nejdřív do DAL přidat metodu `GetSupplierBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="eaad5-223">Pravým tlačítkem myši klikněte na `SuppliersTableAdapter` v návrhu datové sady a vyberte možnost Přidat dotaz z kontextové nabídky.</span><span class="sxs-lookup"><span data-stu-id="eaad5-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="eaad5-224">Stejně jako v kroku 3 nechejte průvodce pro nás vytvořit novou úložnou proceduru, a to tak, že vyberete možnost vytvořit novou uloženou proceduru (snímek obrazovky tohoto kroku průvodce najdete zpátky na obrázek 3).</span><span class="sxs-lookup"><span data-stu-id="eaad5-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="eaad5-225">Vzhledem k tomu, že tato metoda vrátí záznam s více sloupci, určete, že chceme použít dotaz SQL, který je SELECT, který vrací řádky a klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="eaad5-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>

<span data-ttu-id="eaad5-226">[![zvolte možnost vybrat, které vrací řádky.](working-with-computed-columns-cs/_static/image23.png)](working-with-computed-columns-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-cs/_static/image23.png)](working-with-computed-columns-cs/_static/image22.png)</span></span>

<span data-ttu-id="eaad5-227">**Obrázek 8**: zvolte možnost vybrat, které vrací řádky ([kliknutím zobrazíte obrázek v plné velikosti](working-with-computed-columns-cs/_static/image24.png)).</span><span class="sxs-lookup"><span data-stu-id="eaad5-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-cs/_static/image24.png))</span></span>

<span data-ttu-id="eaad5-228">V dalším kroku se zobrazí výzva pro dotaz, který se má použít pro tuto metodu.</span><span class="sxs-lookup"><span data-stu-id="eaad5-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="eaad5-229">Zadejte následující příkaz, který vrátí stejná datová pole jako hlavní dotaz, ale pro konkrétního dodavatele.</span><span class="sxs-lookup"><span data-stu-id="eaad5-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample5.sql)]

<span data-ttu-id="eaad5-230">Na další obrazovce se dozvíte, jak pojmenovat uloženou proceduru, která se vygeneruje automaticky.</span><span class="sxs-lookup"><span data-stu-id="eaad5-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="eaad5-231">Pojmenujte tuto uloženou proceduru `Suppliers_SelectBySupplierID` a klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="eaad5-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>

<span data-ttu-id="eaad5-232">[![uloženou proceduru pojmenovat Suppliers_SelectBySupplierID](working-with-computed-columns-cs/_static/image26.png)](working-with-computed-columns-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-cs/_static/image26.png)](working-with-computed-columns-cs/_static/image25.png)</span></span>

<span data-ttu-id="eaad5-233">**Obrázek 9**: pojmenujte uloženou proceduru `Suppliers_SelectBySupplierID` ([kliknutím zobrazíte obrázek v plné velikosti).](working-with-computed-columns-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-cs/_static/image27.png))</span></span>

<span data-ttu-id="eaad5-234">Nakonec průvodce vyzve k zadání vzorů přístupu k datům a názvů metod, které se mají použít pro TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="eaad5-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="eaad5-235">Ponechte zaškrtnuté obě políčka, ale přejmenujte `FillBy` a `GetDataBy` metody na `FillBySupplierID` a `GetSupplierBySupplierID`, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="eaad5-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>

<span data-ttu-id="eaad5-236">[![pojmenovat metody TableAdapter FillBySupplierID a GetSupplierBySupplierID](working-with-computed-columns-cs/_static/image29.png)](working-with-computed-columns-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-cs/_static/image29.png)](working-with-computed-columns-cs/_static/image28.png)</span></span>

<span data-ttu-id="eaad5-237">**Obrázek 10**: pojmenování metod TableAdapter `FillBySupplierID` a `GetSupplierBySupplierID` ([kliknutím zobrazíte obrázek v plné velikosti](working-with-computed-columns-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="eaad5-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-cs/_static/image30.png))</span></span>

<span data-ttu-id="eaad5-238">Kliknutím na Dokončit dokončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="eaad5-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="eaad5-239">Krok 6: vytvoření vrstvy obchodní logiky</span><span class="sxs-lookup"><span data-stu-id="eaad5-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="eaad5-240">Než vytvoříme stránku ASP.NET, která používá vypočítaný sloupec vytvořený v kroku 1, nejdřív je potřeba přidat odpovídající metody do knihoven BLL.</span><span class="sxs-lookup"><span data-stu-id="eaad5-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="eaad5-241">Naše stránka ASP.NET, kterou vytvoříme v kroku 7, umožní uživatelům zobrazit a upravit dodavatele.</span><span class="sxs-lookup"><span data-stu-id="eaad5-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="eaad5-242">Proto potřebujeme, aby naše knihoven BLL poskytovala minimálně metodu pro získání všech dodavatelů a dalšího pro aktualizaci konkrétního dodavatele.</span><span class="sxs-lookup"><span data-stu-id="eaad5-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="eaad5-243">Ve složce `~/App_Code/BLL` vytvořte nový soubor třídy s názvem `SuppliersBLLWithSprocs` a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="eaad5-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>

[!code-csharp[Main](working-with-computed-columns-cs/samples/sample6.cs)]

<span data-ttu-id="eaad5-244">Podobně jako ostatní třídy knihoven BLL má `SuppliersBLLWithSprocs` vlastnost `protected` `Adapter`, která vrací instanci `SuppliersTableAdapter` společně se dvěma `public` metodami: `GetSuppliers` a `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="eaad5-245">Metoda `GetSuppliers` volá a vrátí `SuppliersDataTable` vracené odpovídající `GetSupplier` metodou ve vrstvě přístupu k datům.</span><span class="sxs-lookup"><span data-stu-id="eaad5-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="eaad5-246">Metoda `UpdateSupplier` načte informace o určitém dodavateli, který je aktualizován prostřednictvím volání metody DAL s `GetSupplierBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="eaad5-247">Poté aktualizuje vlastnosti `CategoryName`, `ContactName`a `ContactTitle` a potvrdí tyto změny v databázi voláním metody pro přístup k datům v metodě `Update` a předáním upraveného objektu `SuppliersRow`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="eaad5-248">S výjimkou `SupplierID` a `CompanyName`všechny sloupce v tabulce Dodavatelé povolují `NULL` hodnoty.</span><span class="sxs-lookup"><span data-stu-id="eaad5-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="eaad5-249">Proto pokud jsou předané `contactName` nebo `contactTitle` parametry `null` potřebujeme nastavit odpovídající `ContactName` a `ContactTitle` vlastnosti na hodnotu databáze `NULL` pomocí `SetContactNameNull` a `SetContactTitleNull`ch metod, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="eaad5-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `null` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>

## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="eaad5-250">Krok 7: práce s vypočítaným sloupcem z prezentační vrstvy</span><span class="sxs-lookup"><span data-stu-id="eaad5-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="eaad5-251">Když je vypočítaný sloupec přidaný do tabulky `Suppliers` a odpovídajícím způsobem se aktualizuje a knihoven BLL, budeme připraveni vytvořit stránku ASP.NET, která funguje s vypočítaným sloupcem `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="eaad5-252">Začněte otevřením stránky `ComputedColumns.aspx` ve složce `AdvancedDAL` a přetažením prvku GridView z panelu nástrojů do návrháře.</span><span class="sxs-lookup"><span data-stu-id="eaad5-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="eaad5-253">Nastavte vlastnost `ID` ovládacího prvku GridView na `Suppliers` a ze své inteligentní značky ji navažte na nový prvek ObjectDataSource s názvem `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="eaad5-254">Nakonfigurujte prvek ObjectDataSource tak, aby používal třídu `SuppliersBLLWithSprocs`, kterou jsme přidali zpátky v kroku 6, a klikněte na další.</span><span class="sxs-lookup"><span data-stu-id="eaad5-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>

<span data-ttu-id="eaad5-255">[![nakonfigurovat prvek ObjectDataSource tak, aby používal třídu SuppliersBLLWithSprocs](working-with-computed-columns-cs/_static/image32.png)](working-with-computed-columns-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-cs/_static/image32.png)](working-with-computed-columns-cs/_static/image31.png)</span></span>

<span data-ttu-id="eaad5-256">**Obrázek 11**: Konfigurace prvku ObjectDataSource, aby používal třídu `SuppliersBLLWithSprocs` ([kliknutím zobrazíte obrázek v plné velikosti](working-with-computed-columns-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="eaad5-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-cs/_static/image33.png))</span></span>

<span data-ttu-id="eaad5-257">V `SuppliersBLLWithSprocs` třídy jsou definovány pouze dvě metody: `GetSuppliers` a `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="eaad5-258">Zajistěte, aby byly tyto dvě metody zadány na kartách vybrat a aktualizovat, a kliknutím na tlačítko Dokončit dokončíte konfiguraci prvku ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="eaad5-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="eaad5-259">Po dokončení Průvodce konfigurací zdroje dat přidá Visual Studio vlastnost BoundField pro každé vracená datová pole.</span><span class="sxs-lookup"><span data-stu-id="eaad5-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="eaad5-260">Odeberte `SupplierID` vlastnost BoundField a změňte vlastnosti `HeaderText` `CompanyName`, `ContactName`, `ContactTitle`a `FullContactName` BoundFields na společnost, jméno kontaktu, název a jméno a příjmení kontaktní osoby v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="eaad5-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="eaad5-261">Z inteligentní značky zaškrtněte políčko Povolit úpravy a zapněte možnosti úprav integrované v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="eaad5-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="eaad5-262">Kromě přidání BoundFields do prvku GridView, doplňování Průvodce zdrojem dat také způsobí, že sada Visual Studio nastaví vlastnost ObjectDataSource `OldValuesParameterFormatString` na původní\_{0}.</span><span class="sxs-lookup"><span data-stu-id="eaad5-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="eaad5-263">Vrátí toto nastavení zpět na výchozí hodnotu {0}.</span><span class="sxs-lookup"><span data-stu-id="eaad5-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="eaad5-264">Po provedení těchto úprav prvku GridView a ObjectDataSource by jejich deklarativní označení mělo vypadat podobně jako následující:</span><span class="sxs-lookup"><span data-stu-id="eaad5-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](working-with-computed-columns-cs/samples/sample7.aspx)]

<span data-ttu-id="eaad5-265">Potom navštivte tuto stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="eaad5-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="eaad5-266">Jak ukazuje obrázek 12, je každý dodavatel uveden v mřížce, která obsahuje sloupec `FullContactName`, jehož hodnota je jednoduše zřetězení dalších tří sloupců formátovaných jako `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="eaad5-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="eaad5-267">[![je každý dodavatel uveden v mřížce.](working-with-computed-columns-cs/_static/image35.png)](working-with-computed-columns-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-cs/_static/image35.png)](working-with-computed-columns-cs/_static/image34.png)</span></span>

<span data-ttu-id="eaad5-268">**Obrázek 12**: v mřížce je uveden každý dodavatel ([kliknutím zobrazíte obrázek v plné velikosti](working-with-computed-columns-cs/_static/image36.png)).</span><span class="sxs-lookup"><span data-stu-id="eaad5-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-cs/_static/image36.png))</span></span>

<span data-ttu-id="eaad5-269">Kliknutím na tlačítko Upravit u určitého dodavatele dojde k postbacku a tento řádek je vykreslen v rozhraní pro úpravy (viz obrázek 13).</span><span class="sxs-lookup"><span data-stu-id="eaad5-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="eaad5-270">První tři sloupce vykreslí v jejich výchozím rozhraní pro úpravy – ovládací prvek TextBox, jehož vlastnost `Text` je nastavena na hodnotu datového pole.</span><span class="sxs-lookup"><span data-stu-id="eaad5-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="eaad5-271">Sloupec `FullContactName` však zůstává jako text.</span><span class="sxs-lookup"><span data-stu-id="eaad5-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="eaad5-272">Po přidání BoundFields do prvku GridView při dokončování Průvodce konfigurací zdroje dat byla vlastnost `ReadOnly` `FullContactName` vlastnost BoundField s nastavena na hodnotu `true`, protože odpovídající sloupec `FullContactName` v `SuppliersDataTable` má vlastnost `ReadOnly` nastavena na `true`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `true` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `true`.</span></span> <span data-ttu-id="eaad5-273">Jak je uvedeno v kroku 4, vlastnost `FullContactName` s `ReadOnly` byla nastavena na hodnotu `true`, protože sloupec zjistil, že sloupec byl vypočítaným sloupcem.</span><span class="sxs-lookup"><span data-stu-id="eaad5-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `true` because the TableAdapter detected that the column was a computed column.</span></span>

<span data-ttu-id="eaad5-274">[![sloupec FullContactName nelze upravovat.](working-with-computed-columns-cs/_static/image38.png)](working-with-computed-columns-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="eaad5-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-cs/_static/image38.png)](working-with-computed-columns-cs/_static/image37.png)</span></span>

<span data-ttu-id="eaad5-275">**Obrázek 13**: sloupec `FullContactName` není upravitelný ([kliknutím zobrazíte obrázek v plné velikosti](working-with-computed-columns-cs/_static/image39.png)).</span><span class="sxs-lookup"><span data-stu-id="eaad5-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-cs/_static/image39.png))</span></span>

<span data-ttu-id="eaad5-276">Pokračujte a aktualizujte hodnotu jednoho nebo více upravitelných sloupců a klikněte na aktualizovat.</span><span class="sxs-lookup"><span data-stu-id="eaad5-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="eaad5-277">Všimněte si, jak je hodnota `FullContactName` s automaticky aktualizována, aby odrážela změnu.</span><span class="sxs-lookup"><span data-stu-id="eaad5-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="eaad5-278">Prvek GridView aktuálně používá BoundFields pro upravitelná pole, což vede k výchozímu rozhraní pro úpravy.</span><span class="sxs-lookup"><span data-stu-id="eaad5-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="eaad5-279">Vzhledem k tomu, že pole `CompanyName` je požadováno, mělo by být převedeno na TemplateField, který obsahuje RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="eaad5-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="eaad5-280">Ponechám se to jako cvičení pro zúčastněný čtenář.</span><span class="sxs-lookup"><span data-stu-id="eaad5-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="eaad5-281">Podrobné pokyny k převodu vlastnost BoundField na TemplateField a přidání ovládacích prvků ověřování najdete v kurzu [Přidání ovládacích prvků ověřování do kurzu pro úpravy a vložení rozhraní](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="eaad5-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>

## <a name="summary"></a><span data-ttu-id="eaad5-282">Souhrn</span><span class="sxs-lookup"><span data-stu-id="eaad5-282">Summary</span></span>

<span data-ttu-id="eaad5-283">Při definování schématu pro tabulku Microsoft SQL Server umožňuje zahrnutí počítaných sloupců.</span><span class="sxs-lookup"><span data-stu-id="eaad5-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="eaad5-284">Jedná se o sloupce, jejichž hodnoty se počítají z výrazu, který obvykle odkazuje na hodnoty z jiných sloupců ve stejném záznamu.</span><span class="sxs-lookup"><span data-stu-id="eaad5-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="eaad5-285">Vzhledem k tomu, že hodnoty pro vypočítané sloupce jsou založené na výrazu, jsou jen pro čtení a nelze jí přiřadit hodnotu v `INSERT` nebo v příkazu `UPDATE`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="eaad5-286">To přináší problémy při použití vypočítaného sloupce v hlavním dotazu TableAdapter, který se pokusí automaticky vygenerovat odpovídající příkazy `INSERT`, `UPDATE`a `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="eaad5-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="eaad5-287">V tomto kurzu jsme probrali techniky pro obcházení výzev, které představují vypočítané sloupce.</span><span class="sxs-lookup"><span data-stu-id="eaad5-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="eaad5-288">Konkrétně jsme použili uložené procedury v našich TableAdapter k překonání brittlenesse v objekty TableAdapter, které používají ad-hoc příkazy SQL.</span><span class="sxs-lookup"><span data-stu-id="eaad5-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="eaad5-289">Když Průvodce TableAdapter vytvoří nové uložené procedury, je důležité, aby hlavní dotaz zpočátku vynechal vypočítané sloupce, protože jejich přítomnost brání vygenerování uložených procedur úprav dat.</span><span class="sxs-lookup"><span data-stu-id="eaad5-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="eaad5-290">Po navýšení konfigurace TableAdapter můžete znovu použít jeho `SelectCommand` uloženou proceduru, aby zahrnovala všechny vypočítané sloupce.</span><span class="sxs-lookup"><span data-stu-id="eaad5-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="eaad5-291">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="eaad5-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="eaad5-292">O autorovi</span><span class="sxs-lookup"><span data-stu-id="eaad5-292">About the Author</span></span>

<span data-ttu-id="eaad5-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor 7 ASP/ASP. NET Books a zakladatel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="eaad5-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="eaad5-294">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="eaad5-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="eaad5-295">Nejnovější kniha je [*Sams naučit se ASP.NET 2,0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="eaad5-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="eaad5-296">Dá se získat na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="eaad5-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="eaad5-297">nebo prostřednictvím svého blogu, který najdete na adrese [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="eaad5-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="eaad5-298">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="eaad5-298">Special Thanks To</span></span>

<span data-ttu-id="eaad5-299">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="eaad5-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="eaad5-300">Kontroloři vedoucích k tomuto kurzu byli Hilton Geisenow a Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="eaad5-300">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="eaad5-301">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="eaad5-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="eaad5-302">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="eaad5-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="eaad5-303">[Předchozí](adding-additional-datatable-columns-cs.md)
> [Další](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs.md)</span><span class="sxs-lookup"><span data-stu-id="eaad5-303">[Previous](adding-additional-datatable-columns-cs.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs.md)</span></span>
