---
uid: web-forms/overview/data-access/working-with-batched-data/batch-inserting-vb
title: Dávkové vkládání (VB) | Microsoft Docs
author: rick-anderson
description: Naučte se, jak vložit více záznamů databáze v rámci jedné operace. Ve vrstvě uživatelského rozhraní rozšiřujeme prvek GridView tak, aby umožňoval uživateli zadat více n...
ms.author: riande
ms.date: 06/26/2007
ms.assetid: 48e2a4ae-77ca-4208-a204-c38c690ffb59
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-inserting-vb
msc.type: authoredcontent
ms.openlocfilehash: 413a0e209b1899414eaab70aff07ee0d3223f28f
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/28/2019
ms.locfileid: "74643125"
---
# <a name="batch-inserting-vb"></a><span data-ttu-id="15b59-104">Dávkové vkládání (VB)</span><span class="sxs-lookup"><span data-stu-id="15b59-104">Batch Inserting (VB)</span></span>

<span data-ttu-id="15b59-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="15b59-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="15b59-106">[Stažení kódu](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_VB.zip) nebo [stažení PDF](batch-inserting-vb/_static/datatutorial66vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="15b59-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_VB.zip) or [Download PDF](batch-inserting-vb/_static/datatutorial66vb1.pdf)</span></span>

> <span data-ttu-id="15b59-107">Naučte se, jak vložit více záznamů databáze v rámci jedné operace.</span><span class="sxs-lookup"><span data-stu-id="15b59-107">Learn how to insert multiple database records in a single operation.</span></span> <span data-ttu-id="15b59-108">Ve vrstvě uživatelského rozhraní rozšiřujeme prvek GridView tak, aby umožňoval uživateli zadat více nových záznamů.</span><span class="sxs-lookup"><span data-stu-id="15b59-108">In the User Interface Layer we extend the GridView to allow the user to enter multiple new records.</span></span> <span data-ttu-id="15b59-109">Ve vrstvě přístupu k datům rozbalíme operace více operací vložení v rámci transakce, aby se zajistilo, že všechna vložení budou úspěšná, nebo se všechna vložení vrátí zpět.</span><span class="sxs-lookup"><span data-stu-id="15b59-109">In the Data Access Layer we wrap the multiple Insert operations within a transaction to ensure that all insertions succeed or all insertions are rolled back.</span></span>

## <a name="introduction"></a><span data-ttu-id="15b59-110">Úvod</span><span class="sxs-lookup"><span data-stu-id="15b59-110">Introduction</span></span>

<span data-ttu-id="15b59-111">V kurzu [dávkové aktualizace](batch-updating-vb.md) jsme se podívali na přizpůsobení ovládacího prvku GridView, který prezentuje rozhraní, kde se dá upravovat víc záznamů.</span><span class="sxs-lookup"><span data-stu-id="15b59-111">In the [Batch Updating](batch-updating-vb.md) tutorial we looked at customizing the GridView control to present an interface where multiple records were editable.</span></span> <span data-ttu-id="15b59-112">Uživatel, který navštívil stránku, může provést řadu změn a pak jediným kliknutím na tlačítko provést dávkovou aktualizaci.</span><span class="sxs-lookup"><span data-stu-id="15b59-112">The user visiting the page could make a series of changes and then, with a single button click, perform a batch update.</span></span> <span data-ttu-id="15b59-113">V situacích, kdy uživatelé běžně aktualizují mnoho záznamů v jednom z nich, může toto rozhraní ukládat dlouhé kliknutí a přepínání mezi jednotlivými jednotlivými řádky, když jsou v porovnání s výchozími funkcemi pro úpravu řádků, které se poprvé prozkoumaly v kurzu [Přehled vložení, aktualizace a odstranění dat](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="15b59-113">For situations where users commonly update many records in one go, such an interface can save countless clicks and keyboard-to-mouse context switches when compared to the default per-row editing features that were first explored back in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial.</span></span>

<span data-ttu-id="15b59-114">Tento koncept se dá použít i při přidávání záznamů.</span><span class="sxs-lookup"><span data-stu-id="15b59-114">This concept can also be applied when adding records.</span></span> <span data-ttu-id="15b59-115">Představte si, že v článku Northwind Traders jsme běžně dostávali dodávky od dodavatelů, kteří pro konkrétní kategorii obsahují řadu produktů.</span><span class="sxs-lookup"><span data-stu-id="15b59-115">Imagine that here at Northwind Traders we commonly receive shipments from suppliers that contain a number of products for a particular category.</span></span> <span data-ttu-id="15b59-116">Příkladem může být doručení šesti různých produktů čaje a kávy od hospodářských obchodníků z Brna.</span><span class="sxs-lookup"><span data-stu-id="15b59-116">As an example, we might receive a shipment of six different tea and coffee products from Tokyo Traders.</span></span> <span data-ttu-id="15b59-117">Pokud uživatel zadá šest produktů po jednom prostřednictvím ovládacího prvku DetailsView, bude muset zvolit mnoho stejných hodnot znovu a znovu: bude muset zvolit stejnou kategorii (nápoje), stejného dodavatele (Brno obchodníci), stejnou Nepokračující hodnotu ( False) a stejné jednotky v hodnotě pořadí (0).</span><span class="sxs-lookup"><span data-stu-id="15b59-117">If a user enters the six products one at a time through a DetailsView control, they will have to choose many of the same values over and over again: they will need to choose the same category (Beverages), the same supplier (Tokyo Traders), the same discontinued value (False), and the same units on order value (0).</span></span> <span data-ttu-id="15b59-118">Tato opakující se položka dat je časově náročná, ale je náchylná k chybám.</span><span class="sxs-lookup"><span data-stu-id="15b59-118">This repetitive data entry is not only time consuming, but is prone to errors.</span></span>

<span data-ttu-id="15b59-119">S malým množstvím práce můžeme vytvořit dávkové vkládání rozhraní, které umožňuje uživateli zvolit dodavatel a kategorii jednou, zadat řady názvů produktů a jednotkové ceny a potom kliknutím na tlačítko Přidat nové produkty do databáze (viz obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="15b59-119">With a little work we can create a batch inserting interface that enables the user to choose the supplier and category once, enter a series of product names and unit prices, and then click a button to add the new products to the database (see Figure 1).</span></span> <span data-ttu-id="15b59-120">Při přidání každého produktu se jeho `ProductName` a datová pole `UnitPrice` přiřazují hodnoty zadané v textových polích, zatímco `CategoryID` a `SupplierID` hodnoty jsou přiřazeny hodnoty z ovládacích prvků DropDownList v horní části formuláře.</span><span class="sxs-lookup"><span data-stu-id="15b59-120">As each product is added, its `ProductName` and `UnitPrice` data fields are assigned the values entered in the TextBoxes, while its `CategoryID` and `SupplierID` values are assigned the values from the DropDownLists at the top fo the form.</span></span> <span data-ttu-id="15b59-121">Hodnoty `Discontinued` a `UnitsOnOrder` jsou nastaveny na pevně zakódované hodnoty `False` a 0 v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="15b59-121">The `Discontinued` and `UnitsOnOrder` values are set to the hard-coded values of `False` and 0, respectively.</span></span>

<span data-ttu-id="15b59-122">[![rozhraní Batch pro vložení](batch-inserting-vb/_static/image2.png)](batch-inserting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-122">[![The Batch Inserting Interface](batch-inserting-vb/_static/image2.png)](batch-inserting-vb/_static/image1.png)</span></span>

<span data-ttu-id="15b59-123">**Obrázek 1**: dávkové vkládání rozhraní ([kliknutím zobrazíte obrázek v plné velikosti](batch-inserting-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="15b59-123">**Figure 1**: The Batch Inserting Interface ([Click to view full-size image](batch-inserting-vb/_static/image3.png))</span></span>

<span data-ttu-id="15b59-124">V tomto kurzu vytvoříme stránku, která implementuje rozhraní Batch pro vložení zobrazené na obrázku 1.</span><span class="sxs-lookup"><span data-stu-id="15b59-124">In this tutorial we will create a page that implements the batch inserting interface shown in Figure 1.</span></span> <span data-ttu-id="15b59-125">Stejně jako v předchozích dvou kurzech zabalíme vložení do rozsahu transakce, aby se zajistila nedělitelnost.</span><span class="sxs-lookup"><span data-stu-id="15b59-125">As with the previous two tutorials, we will wrap the insertions within the scope of a transaction to ensure atomicity.</span></span> <span data-ttu-id="15b59-126">Pojďme začít!</span><span class="sxs-lookup"><span data-stu-id="15b59-126">Let s get started!</span></span>

## <a name="step-1-creating-the-display-interface"></a><span data-ttu-id="15b59-127">Krok 1: vytvoření rozhraní pro zobrazení</span><span class="sxs-lookup"><span data-stu-id="15b59-127">Step 1: Creating the Display Interface</span></span>

<span data-ttu-id="15b59-128">Tento kurz se skládá z jedné stránky, která je rozdělená do dvou oblastí: oblast zobrazení a oblast vložení.</span><span class="sxs-lookup"><span data-stu-id="15b59-128">This tutorial will consist of a single page that is divided into two regions: a display region and an inserting region.</span></span> <span data-ttu-id="15b59-129">Rozhraní zobrazení, které v tomto kroku vytvoříte, zobrazuje produkty v prvku GridView a obsahuje tlačítko s názvem dodávka produktu.</span><span class="sxs-lookup"><span data-stu-id="15b59-129">The display interface, which we'll create in this step, shows the products in a GridView and includes a button titled Process Product Shipment.</span></span> <span data-ttu-id="15b59-130">Po kliknutí na toto tlačítko je rozhraní zobrazení nahrazeno rozhraním pro vložení, které je zobrazeno na obrázku 1.</span><span class="sxs-lookup"><span data-stu-id="15b59-130">When this button is clicked, the display interface is replaced with the inserting interface, which is shown in Figure 1.</span></span> <span data-ttu-id="15b59-131">Rozhraní zobrazení se vrátí po kliknutí na tlačítka Přidat produkty z odeslání nebo zrušit.</span><span class="sxs-lookup"><span data-stu-id="15b59-131">The display interface returns after the Add Products from Shipment or Cancel buttons are clicked.</span></span> <span data-ttu-id="15b59-132">Rozhraní pro vložení vytvoříme v kroku 2.</span><span class="sxs-lookup"><span data-stu-id="15b59-132">We'll create the inserting interface in Step 2.</span></span>

<span data-ttu-id="15b59-133">Při vytváření stránky, která má dvě rozhraní, pouze jedna, která je viditelná současně, každé rozhraní je obvykle umístěno v rámci [webového ovládacího prvku panelu](http://www.w3schools.com/aspnet/control_panel.asp), který slouží jako kontejner pro jiné ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="15b59-133">When creating a page that has two interfaces, only one of which is visible at a time, each interface typically is placed within a [Panel Web control](http://www.w3schools.com/aspnet/control_panel.asp), which serves as a container for other controls.</span></span> <span data-ttu-id="15b59-134">Proto má naše stránka dva ovládací prvky panelu pro každé rozhraní.</span><span class="sxs-lookup"><span data-stu-id="15b59-134">Therefore, our page will have two Panel controls one for each interface.</span></span>

<span data-ttu-id="15b59-135">Začněte otevřením stránky `BatchInsert.aspx` ve složce `BatchData` a přetažením panelu z panelu nástrojů do návrháře (viz obrázek 2).</span><span class="sxs-lookup"><span data-stu-id="15b59-135">Start by opening the `BatchInsert.aspx` page in the `BatchData` folder and drag a Panel from the Toolbox onto the Designer (see Figure 2).</span></span> <span data-ttu-id="15b59-136">Nastavte vlastnost panel s `ID` na `DisplayInterface`.</span><span class="sxs-lookup"><span data-stu-id="15b59-136">Set the Panel s `ID` property to `DisplayInterface`.</span></span> <span data-ttu-id="15b59-137">Když přidáte panel do návrháře, jeho `Height` a vlastnosti `Width` jsou nastaveny na 50px a 125px, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="15b59-137">When adding the Panel to the Designer, its `Height` and `Width` properties are set to 50px and 125px, respectively.</span></span> <span data-ttu-id="15b59-138">Vymažte z okno Vlastnosti tyto hodnoty vlastností.</span><span class="sxs-lookup"><span data-stu-id="15b59-138">Clear out these property values from the Properties window.</span></span>

<span data-ttu-id="15b59-139">[![přetáhněte panel z panelu nástrojů na Návrhář.](batch-inserting-vb/_static/image5.png)](batch-inserting-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-139">[![Drag a Panel from the Toolbox onto the Designer](batch-inserting-vb/_static/image5.png)](batch-inserting-vb/_static/image4.png)</span></span>

<span data-ttu-id="15b59-140">**Obrázek 2**: přetáhněte panel z panelu nástrojů do návrháře ([kliknutím zobrazíte obrázek v plné velikosti](batch-inserting-vb/_static/image6.png)).</span><span class="sxs-lookup"><span data-stu-id="15b59-140">**Figure 2**: Drag a Panel from the Toolbox onto the Designer ([Click to view full-size image](batch-inserting-vb/_static/image6.png))</span></span>

<span data-ttu-id="15b59-141">Potom přetáhněte tlačítko a ovládací prvek GridView do panelu.</span><span class="sxs-lookup"><span data-stu-id="15b59-141">Next, drag a Button and GridView control into the Panel.</span></span> <span data-ttu-id="15b59-142">Nastavte vlastnost `ID` tlačítko na `ProcessShipment` a jeho vlastnost `Text` na zpracovávání dodávky produktu.</span><span class="sxs-lookup"><span data-stu-id="15b59-142">Set the Button s `ID` property to `ProcessShipment` and its `Text` property to Process Product Shipment.</span></span> <span data-ttu-id="15b59-143">Nastavte vlastnost `ID` ovládacího prvku GridView na `ProductsGrid` a ze své inteligentní značky ji navažte na nový prvek ObjectDataSource s názvem `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="15b59-143">Set the GridView s `ID` property to `ProductsGrid` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="15b59-144">Nakonfigurujte prvek ObjectDataSource tak, aby vyčetl data z `ProductsBLL` třídy s `GetProducts` metody.</span><span class="sxs-lookup"><span data-stu-id="15b59-144">Configure the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="15b59-145">Vzhledem k tomu, že se tento prvek GridView používá jenom k zobrazení dat, nastavte rozevírací seznamy na kartách aktualizace, vložení a odstranění na (žádné).</span><span class="sxs-lookup"><span data-stu-id="15b59-145">Since this GridView is used only to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="15b59-146">Kliknutím na Dokončit dokončete Průvodce konfigurací zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="15b59-146">Click Finish to complete the Configure Data Source wizard.</span></span>

<span data-ttu-id="15b59-147">[![zobrazení dat vrácených z metody ProductsBLL třídy s GetProducts](batch-inserting-vb/_static/image8.png)](batch-inserting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-147">[![Display the Data Returned from the ProductsBLL Class s GetProducts Method](batch-inserting-vb/_static/image8.png)](batch-inserting-vb/_static/image7.png)</span></span>

<span data-ttu-id="15b59-148">**Obrázek 3**: zobrazení dat vrácených z `GetProducts` metody `ProductsBLL` třídy s ([kliknutím zobrazíte obrázek v plné velikosti](batch-inserting-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="15b59-148">**Figure 3**: Display the Data Returned from the `ProductsBLL` Class s `GetProducts` Method ([Click to view full-size image](batch-inserting-vb/_static/image9.png))</span></span>

<span data-ttu-id="15b59-149">[![nastavení rozevíracích seznamů na kartách aktualizace, vložení a odstranění na (žádné)](batch-inserting-vb/_static/image11.png)](batch-inserting-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-149">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-inserting-vb/_static/image11.png)](batch-inserting-vb/_static/image10.png)</span></span>

<span data-ttu-id="15b59-150">**Obrázek 4**: nastavení rozevíracích seznamů na kartách aktualizace, vložení a odstranění na (žádné) ([kliknutím zobrazíte obrázek v plné velikosti).](batch-inserting-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-150">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-inserting-vb/_static/image12.png))</span></span>

<span data-ttu-id="15b59-151">Po dokončení průvodce ObjectDataSource bude Visual Studio přidávat BoundFields a třídě CheckBoxField podporována pro pole dat produktu.</span><span class="sxs-lookup"><span data-stu-id="15b59-151">After completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for the product data fields.</span></span> <span data-ttu-id="15b59-152">Odeberte všechna pole s výjimkou `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`a `Discontinued`.</span><span class="sxs-lookup"><span data-stu-id="15b59-152">Remove all but the `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, and `Discontinued` fields.</span></span> <span data-ttu-id="15b59-153">Nebojte se dělat všechna estetická přizpůsobení.</span><span class="sxs-lookup"><span data-stu-id="15b59-153">Feel free to make any aesthetic customizations.</span></span> <span data-ttu-id="15b59-154">Rozhodli jste se formátovat pole `UnitPrice` jako hodnotu měny, změnit pořadí polí a přejmenovat několik polí `HeaderText` hodnot.</span><span class="sxs-lookup"><span data-stu-id="15b59-154">I decided to format the `UnitPrice` field as a currency value, reordered the fields, and renamed several of the fields `HeaderText` values.</span></span> <span data-ttu-id="15b59-155">Také nakonfigurujete prvek GridView tak, aby zahrnoval podporu stránkování a řazení, zaškrtnutím políčka Povolit stránkování a Povolit řazení v inteligentní značce GridView s.</span><span class="sxs-lookup"><span data-stu-id="15b59-155">Also configure the GridView to include paging and sorting support by checking the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="15b59-156">Po přidání ovládacího prvku panel, tlačítko, GridView a ObjectDataSource a přizpůsobení polí prvku GridView, by vaše deklarativní označení stránky mělo vypadat podobně jako následující:</span><span class="sxs-lookup"><span data-stu-id="15b59-156">After adding the Panel, Button, GridView, and ObjectDataSource controls and customizing the GridView s fields, your page s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](batch-inserting-vb/samples/sample1.aspx)]

<span data-ttu-id="15b59-157">Všimněte si, že značky pro tlačítko a GridView se zobrazí v rámci značek pro otevírání a zavírání `<asp:Panel>`.</span><span class="sxs-lookup"><span data-stu-id="15b59-157">Note that the markup for the Button and GridView appear within the opening and closing `<asp:Panel>` tags.</span></span> <span data-ttu-id="15b59-158">Vzhledem k tomu, že se tyto ovládací prvky nacházejí v `DisplayInterface`m panelu, můžeme je skrýt jednoduše nastavením vlastnosti panel s `Visible` na `False`.</span><span class="sxs-lookup"><span data-stu-id="15b59-158">Since these controls are within the `DisplayInterface` Panel, we can hide them by simply setting the Panel s `Visible` property to `False`.</span></span> <span data-ttu-id="15b59-159">Krok 3: při překrytí vlastnosti panel s `Visible` v reakci na tlačítko můžete zobrazit jedno rozhraní a zároveň ho skrýt.</span><span class="sxs-lookup"><span data-stu-id="15b59-159">Step 3 looks at programmatically changing the Panel s `Visible` property in response to a button click to show one interface while hiding the other.</span></span>

<span data-ttu-id="15b59-160">Chvilku si můžete prohlédnout v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="15b59-160">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="15b59-161">Jak ukazuje obrázek 5, měli byste vidět tlačítko zpracovat produktovou dodávku nad prvek GridView, ve kterém jsou uvedené produkty deset v čase.</span><span class="sxs-lookup"><span data-stu-id="15b59-161">As Figure 5 shows, you should see a Process Product Shipment button above a GridView that lists the products ten at a time.</span></span>

<span data-ttu-id="15b59-162">[![ovládacího prvku GridView zobrazí seznam produktů a nabízí možnosti řazení a stránkování.](batch-inserting-vb/_static/image14.png)](batch-inserting-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-162">[![The GridView Lists the Products and Offers Sorting and Paging Capabilities](batch-inserting-vb/_static/image14.png)](batch-inserting-vb/_static/image13.png)</span></span>

<span data-ttu-id="15b59-163">**Obrázek 5**: prvek GridView obsahuje seznam produktů a nabízí možnosti řazení a stránkování ([kliknutím zobrazíte obrázek v plné velikosti](batch-inserting-vb/_static/image15.png)).</span><span class="sxs-lookup"><span data-stu-id="15b59-163">**Figure 5**: The GridView Lists the Products and Offers Sorting and Paging Capabilities ([Click to view full-size image](batch-inserting-vb/_static/image15.png))</span></span>

## <a name="step-2-creating-the-inserting-interface"></a><span data-ttu-id="15b59-164">Krok 2: vytvoření rozhraní pro vložení</span><span class="sxs-lookup"><span data-stu-id="15b59-164">Step 2: Creating the Inserting Interface</span></span>

<span data-ttu-id="15b59-165">Po dokončení rozhraní zobrazení jsme připraveni vytvořit rozhraní pro vložení.</span><span class="sxs-lookup"><span data-stu-id="15b59-165">With the display interface complete, we re ready to create the inserting interface.</span></span> <span data-ttu-id="15b59-166">V tomto kurzu vytvoříme rozhraní pro vložení, které vyzve k zadání jedné hodnoty dodavatele a kategorie a potom umožní uživateli zadat až pět názvů produktů a hodnot jednotkových cen.</span><span class="sxs-lookup"><span data-stu-id="15b59-166">For this tutorial, let s create an inserting interface that prompts for a single supplier and category value and then allows the user to enter up to five product names and unit price values.</span></span> <span data-ttu-id="15b59-167">Pomocí tohoto rozhraní může uživatel přidat jeden až pět nových produktů, které sdílejí stejnou kategorii a dodavatele, ale mají jedinečné názvy produktů a ceny.</span><span class="sxs-lookup"><span data-stu-id="15b59-167">With this interface, the user can add one to five new products that all share the same category and supplier, but have unique product names and prices.</span></span>

<span data-ttu-id="15b59-168">Začněte přetažením panelu z panelu nástrojů do návrháře a jeho umístěním pod existující `DisplayInterface` panel.</span><span class="sxs-lookup"><span data-stu-id="15b59-168">Start by dragging a Panel from the Toolbox onto the Designer, placing it beneath the existing `DisplayInterface` Panel.</span></span> <span data-ttu-id="15b59-169">Nastavte vlastnost `ID` tohoto nově přidaného panelu na `InsertingInterface` a nastavte jeho vlastnost `Visible` na `False`.</span><span class="sxs-lookup"><span data-stu-id="15b59-169">Set the `ID` property of this newly added Panel to `InsertingInterface` and set its `Visible` property to `False`.</span></span> <span data-ttu-id="15b59-170">Přidáme kód, který nastaví vlastnost `InsertingInterface` panel s `Visible` na `True` v kroku 3.</span><span class="sxs-lookup"><span data-stu-id="15b59-170">We'll add code that sets the `InsertingInterface` Panel s `Visible` property to `True` in Step 3.</span></span> <span data-ttu-id="15b59-171">Také vymažte `Height` panelů a `Width` hodnoty vlastností.</span><span class="sxs-lookup"><span data-stu-id="15b59-171">Also clear out the Panel s `Height` and `Width` property values.</span></span>

<span data-ttu-id="15b59-172">Dál je potřeba vytvořit rozhraní pro vložení, které bylo na obrázku 1 zobrazeno zpátky.</span><span class="sxs-lookup"><span data-stu-id="15b59-172">Next, we need to create the inserting interface that was shown back in Figure 1.</span></span> <span data-ttu-id="15b59-173">Toto rozhraní je možné vytvořit pomocí nejrůznějších technik jazyka HTML, ale budeme používat poměrně jednoduchý řádek: tabulka se čtyřmi řádky se čtyřmi sloupci.</span><span class="sxs-lookup"><span data-stu-id="15b59-173">This interface can be created through a variety of HTML techniques, but we will use a fairly straightforward one: a four-column, seven-row table.</span></span>

> [!NOTE]
> <span data-ttu-id="15b59-174">Při zadávání značek pro prvky HTML `<table>` raději použít zobrazení zdroje.</span><span class="sxs-lookup"><span data-stu-id="15b59-174">When entering markup for HTML `<table>` elements, I prefer to use the Source view.</span></span> <span data-ttu-id="15b59-175">I když má aplikace Visual Studio nástroje pro přidání `<table>` prvků prostřednictvím návrháře, zdá se, že se Návrhář jeví jako příliš ochotno vložit nepožádat o `style` nastavení do značky.</span><span class="sxs-lookup"><span data-stu-id="15b59-175">While Visual Studio does have tools for adding `<table>` elements through the Designer, the Designer seems all too willing to inject unasked for `style` settings into the markup.</span></span> <span data-ttu-id="15b59-176">Po vytvoření značky `<table>` se obvykle vrátíte do návrháře a přidáte webové ovládací prvky a nastavíte jejich vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="15b59-176">Once I have created the `<table>` markup, I usually return to the Designer to add the Web controls and set their properties.</span></span> <span data-ttu-id="15b59-177">Při vytváření tabulek s předem určenými sloupci a řádky, které dáváte přednost použití statického HTML místo [webového ovládacího prvku tabulka](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) , protože jakékoli webové ovládací prvky umístěné v rámci webového ovládacího prvku tabulka lze použít pouze pomocí `FindControl("controlID")`ho vzoru.</span><span class="sxs-lookup"><span data-stu-id="15b59-177">When creating tables with pre-determined columns and rows I prefer using static HTML rather than the [Table Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) because any Web controls placed within a Table Web control can only be accessed using the `FindControl("controlID")` pattern.</span></span> <span data-ttu-id="15b59-178">K tomu ale použijte webové ovládací prvky tabulky pro dynamicky se velikost tabulek (ty, jejichž řádky nebo sloupce jsou založené na některých kritériích pro databázi nebo uživatele), protože ovládací prvek web Table lze sestavit programově.</span><span class="sxs-lookup"><span data-stu-id="15b59-178">I do, however, use Table Web controls for dynamically-sized tables (ones whose rows or columns are based on some database or user-specified criteria), since the Table Web control can be constructed programmatically.</span></span>

<span data-ttu-id="15b59-179">Do `<asp:Panel>` značek `InsertingInterface` panelu zadejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="15b59-179">Enter the following markup within the `<asp:Panel>` tags of the `InsertingInterface` Panel:</span></span>

[!code-html[Main](batch-inserting-vb/samples/sample2.html)]

<span data-ttu-id="15b59-180">Toto `<table>` označení zatím neobsahuje žádné webové ovládací prvky, přidáme je za chvíli.</span><span class="sxs-lookup"><span data-stu-id="15b59-180">This `<table>` markup does not include any Web controls yet, we'll add those momentarily.</span></span> <span data-ttu-id="15b59-181">Všimněte si, že každý prvek `<tr>` obsahuje konkrétní nastavení třídy CSS: `BatchInsertHeaderRow` pro řádek záhlaví, kde se dostanou DropDownList dodavatele a kategorie. `BatchInsertFooterRow` pro řádek zápatí, ve kterém budou tlačítka Přidat produkty z expedice a Storno přecházet. a střídavě `BatchInsertRow` a `BatchInsertAlternatingRow` hodnoty pro řádky, které budou obsahovat ovládací prvky TextBox pro produkt a jednotkové ceny.</span><span class="sxs-lookup"><span data-stu-id="15b59-181">Note that each `<tr>` element contains a particular CSS class setting: `BatchInsertHeaderRow` for the header row where the supplier and category DropDownLists will go; `BatchInsertFooterRow` for the footer row where the Add Products from Shipment and Cancel Buttons will go; and alternating `BatchInsertRow` and `BatchInsertAlternatingRow` values for the rows that will contain the product and unit price TextBox controls.</span></span> <span data-ttu-id="15b59-182">V souboru `Styles.css` jsem vytvořil odpovídající třídy šablony stylů CSS, aby rozhraní pro vložení mělo vzhled podobné ovládacím prvkům GridView a DetailsView, které jsme použili v těchto kurzech.</span><span class="sxs-lookup"><span data-stu-id="15b59-182">I ve created corresponding CSS classes in the `Styles.css` file to give the inserting interface an appearance similar to the GridView and DetailsView controls we ve used throughout these tutorials.</span></span> <span data-ttu-id="15b59-183">Níže jsou uvedeny tyto třídy CSS.</span><span class="sxs-lookup"><span data-stu-id="15b59-183">These CSS classes are shown below.</span></span>

[!code-css[Main](batch-inserting-vb/samples/sample3.css)]

<span data-ttu-id="15b59-184">Po zadání tohoto kódu se vraťte do zobrazení Návrh.</span><span class="sxs-lookup"><span data-stu-id="15b59-184">With this markup entered, return to the Design view.</span></span> <span data-ttu-id="15b59-185">Tato `<table>` by se měla v Návrháři zobrazovat jako tabulka se čtyřmi sloupci a sedmi řádky, jak ukazuje obrázek 6.</span><span class="sxs-lookup"><span data-stu-id="15b59-185">This `<table>` should show as a four-column, seven-row table in the Designer, as Figure 6 illustrates.</span></span>

<span data-ttu-id="15b59-186">[![rozhraní pro vložení se skládá ze čtyř sloupců tabulky se sedmi řádky](batch-inserting-vb/_static/image17.png)](batch-inserting-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-186">[![The Inserting Interface is Composed of a Four-Column, Seven-Row Table](batch-inserting-vb/_static/image17.png)](batch-inserting-vb/_static/image16.png)</span></span>

<span data-ttu-id="15b59-187">**Obrázek 6**: rozhraní pro vložení se skládá ze čtyř sloupců tabulky se sedmi řádky ([kliknutím zobrazíte obrázek v plné velikosti).](batch-inserting-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-187">**Figure 6**: The Inserting Interface is Composed of a Four-Column, Seven-Row Table ([Click to view full-size image](batch-inserting-vb/_static/image18.png))</span></span>

<span data-ttu-id="15b59-188">Nově jsme teď připraveni přidat webové ovládací prvky do rozhraní pro vložení.</span><span class="sxs-lookup"><span data-stu-id="15b59-188">We re now ready to add the Web controls to the inserting interface.</span></span> <span data-ttu-id="15b59-189">Přetáhněte ze sady nástrojů dvě DropDownListy do příslušných buněk v tabulce jedna pro dodavatele a jednu pro kategorii.</span><span class="sxs-lookup"><span data-stu-id="15b59-189">Drag two DropDownLists from the Toolbox into the appropriate cells in the table one for the supplier and one for the category.</span></span>

<span data-ttu-id="15b59-190">Nastavte vlastnost `ID` DropDownList pro dodavatele na `Suppliers` a navažte ji na nový prvek ObjectDataSource s názvem `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="15b59-190">Set the supplier DropDownList s `ID` property to `Suppliers` and bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="15b59-191">Nakonfigurujte nový prvek ObjectDataSource tak, aby načetl jeho data z `SuppliersBLL` třídy s `GetSuppliers` a nastavte rozevírací seznam s kartami aktualizace na hodnotu (žádné).</span><span class="sxs-lookup"><span data-stu-id="15b59-191">Configure the new ObjectDataSource to retrieve its data from the `SuppliersBLL` class s `GetSuppliers` method and set the UPDATE tab s drop-down list to (None).</span></span> <span data-ttu-id="15b59-192">Kliknutím na Dokončit dokončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="15b59-192">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="15b59-193">[![nakonfigurovat prvek ObjectDataSource tak, aby používal metodu SuppliersBLL třídy s getdodavatelé](batch-inserting-vb/_static/image20.png)](batch-inserting-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-193">[![Configure the ObjectDataSource to Use the SuppliersBLL Class s GetSuppliers Method](batch-inserting-vb/_static/image20.png)](batch-inserting-vb/_static/image19.png)</span></span>

<span data-ttu-id="15b59-194">**Obrázek 7**: Konfigurace prvku ObjectDataSource pro použití `GetSuppliers` metody `SuppliersBLL` třídy s ([kliknutím zobrazíte obrázek v plné velikosti](batch-inserting-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="15b59-194">**Figure 7**: Configure the ObjectDataSource to Use the `SuppliersBLL` Class s `GetSuppliers` Method ([Click to view full-size image](batch-inserting-vb/_static/image21.png))</span></span>

<span data-ttu-id="15b59-195">Musí `Suppliers` DropDownList zobrazit `CompanyName` datová pole a jako hodnoty `ListItem` s používat pole `SupplierID` data.</span><span class="sxs-lookup"><span data-stu-id="15b59-195">Have the `Suppliers` DropDownList display the `CompanyName` data field and use the `SupplierID` data field as its `ListItem` s values.</span></span>

<span data-ttu-id="15b59-196">[![zobrazení datového pole CompanyName a jako hodnotu použít ČísloDodavatele.](batch-inserting-vb/_static/image23.png)](batch-inserting-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-196">[![Display the CompanyName Data Field and Use SupplierID as the Value](batch-inserting-vb/_static/image23.png)](batch-inserting-vb/_static/image22.png)</span></span>

<span data-ttu-id="15b59-197">**Obrázek 8**: zobrazení datového pole `CompanyName` a použití `SupplierID` jako hodnoty ([kliknutím zobrazíte obrázek v plné velikosti](batch-inserting-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="15b59-197">**Figure 8**: Display the `CompanyName` Data Field and Use `SupplierID` as the Value ([Click to view full-size image](batch-inserting-vb/_static/image24.png))</span></span>

<span data-ttu-id="15b59-198">Pojmenujte druhý `Categories` DropDownList a navažte jej na nový prvek ObjectDataSource s názvem `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="15b59-198">Name the second DropDownList `Categories` and bind it to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="15b59-199">Nakonfigurujte `CategoriesDataSource` ObjectDataSource tak, aby používala metodu `CategoriesBLL` třídy s `GetCategories`; nastavte rozevírací seznamy na kartách aktualizovat a odstranit na (žádné) a kliknutím na Dokončit dokončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="15b59-199">Configure the `CategoriesDataSource` ObjectDataSource to use the `CategoriesBLL` class s `GetCategories` method; set the drop-down lists in the UPDATE and DELETE tabs to (None) and click Finish to complete the wizard.</span></span> <span data-ttu-id="15b59-200">Nakonec má DropDownList zobrazit `CategoryName` data pole a jako hodnotu použít `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="15b59-200">Finally, have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="15b59-201">Po přidání těchto dvou ovládacích prvků DropDownList a jejich svázání s vhodně nakonfigurovanými ObjectDataSources by měla obrazovka vypadat podobně jako obrázek 9.</span><span class="sxs-lookup"><span data-stu-id="15b59-201">After these two DropDownLists have been added and bound to appropriately configured ObjectDataSources, your screen should look similar to Figure 9.</span></span>

<span data-ttu-id="15b59-202">[![řádek hlavičky teď obsahuje DropDownList a kategorie DropDownList.](batch-inserting-vb/_static/image26.png)](batch-inserting-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-202">[![The Header Row Now Contains the Suppliers and Categories DropDownLists](batch-inserting-vb/_static/image26.png)](batch-inserting-vb/_static/image25.png)</span></span>

<span data-ttu-id="15b59-203">**Obrázek 9**: řádek záhlaví obsahuje nyní `Suppliers` a `Categories` DropDownList ([kliknutím zobrazíte obrázek v plné velikosti).](batch-inserting-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-203">**Figure 9**: The Header Row Now Contains the `Suppliers` and `Categories` DropDownLists ([Click to view full-size image](batch-inserting-vb/_static/image27.png))</span></span>

<span data-ttu-id="15b59-204">Teď je potřeba vytvořit textová pole, abyste mohli shromažďovat název a cenu každého nového produktu.</span><span class="sxs-lookup"><span data-stu-id="15b59-204">We now need to create the TextBoxes to collect the name and price for each new product.</span></span> <span data-ttu-id="15b59-205">Přetáhněte ovládací prvek TextBox ze sady nástrojů do návrháře pro každý z pěti názvů produktů a cenových řádků.</span><span class="sxs-lookup"><span data-stu-id="15b59-205">Drag a TextBox control from the Toolbox onto the Designer for each of the five product name and price rows.</span></span> <span data-ttu-id="15b59-206">Nastavte vlastnosti `ID` textových polí na `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`atd.</span><span class="sxs-lookup"><span data-stu-id="15b59-206">Set the `ID` properties of the TextBoxes to `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, and so on.</span></span>

<span data-ttu-id="15b59-207">Přidejte CompareValidator za každé textové pole s jednotkovými cenami a nastavte vlastnost `ControlToValidate` na odpovídající `ID`.</span><span class="sxs-lookup"><span data-stu-id="15b59-207">Add a CompareValidator after each of the unit price TextBoxes, setting the `ControlToValidate` property to the appropriate `ID`.</span></span> <span data-ttu-id="15b59-208">Nastavte také vlastnost `Operator` na `GreaterThanEqual`, `ValueToCompare` na 0 a `Type` na `Currency`.</span><span class="sxs-lookup"><span data-stu-id="15b59-208">Also set the `Operator` property to `GreaterThanEqual`, `ValueToCompare` to 0, and `Type` to `Currency`.</span></span> <span data-ttu-id="15b59-209">Tato nastavení instruují CompareValidator, aby zajistila, že cena, je-li zadána, je platná hodnota měny, která je větší nebo rovna nule.</span><span class="sxs-lookup"><span data-stu-id="15b59-209">These settings instruct the CompareValidator to ensure that the price, if entered, is a valid currency value that is greater than or equal to zero.</span></span> <span data-ttu-id="15b59-210">Nastavte vlastnost `Text` na \*a `ErrorMessage` na cenu musí být větší nebo rovna nule.</span><span class="sxs-lookup"><span data-stu-id="15b59-210">Set the `Text` property to \*, and `ErrorMessage` to The price must be greater than or equal to zero.</span></span> <span data-ttu-id="15b59-211">Vynechejte také žádné symboly měny.</span><span class="sxs-lookup"><span data-stu-id="15b59-211">Also, please omit any currency symbols.</span></span>

> [!NOTE]
> <span data-ttu-id="15b59-212">Rozhraní pro vložení neobsahuje žádné ovládací prvky RequiredFieldValidator, i když pole `ProductName` v databázové tabulce `Products` nepovoluje hodnoty `NULL`.</span><span class="sxs-lookup"><span data-stu-id="15b59-212">The inserting interface does not include any RequiredFieldValidator controls, even though the `ProductName` field in the `Products` database table does not allow `NULL` values.</span></span> <span data-ttu-id="15b59-213">Důvodem je to, že chceme, aby uživatel mohl zadat až pět produktů.</span><span class="sxs-lookup"><span data-stu-id="15b59-213">This is because we want to let the user enter up to five products.</span></span> <span data-ttu-id="15b59-214">Pokud by například uživatel pro první tři řádky poskytoval název produktu a jednotkovou cenu, ponechají si poslední dva řádky, ale do systému přidá tři nové produkty.</span><span class="sxs-lookup"><span data-stu-id="15b59-214">For example, if the user were to provide the product name and unit price for the first three rows, leaving the last two rows blank, we d just add three new products to the system.</span></span> <span data-ttu-id="15b59-215">Vzhledem k tomu, že je potřeba `ProductName`, budeme muset programově zkontrolovat, jestli je k dispozici odpovídající hodnota názvu produktu, aby bylo zajištěno, že bude zadána Jednotková cena.</span><span class="sxs-lookup"><span data-stu-id="15b59-215">Since `ProductName` is required, however, we will need to programmatically check to ensure that if a unit price is entered that a corresponding product name value is provided.</span></span> <span data-ttu-id="15b59-216">Tuto kontrolu provedeme v kroku 4.</span><span class="sxs-lookup"><span data-stu-id="15b59-216">We'll tackle this check in Step 4.</span></span>

<span data-ttu-id="15b59-217">Při ověřování vstupu uživatele, CompareValidator hlásí neplatná data, pokud hodnota obsahuje symbol měny.</span><span class="sxs-lookup"><span data-stu-id="15b59-217">When validating the user s input, the CompareValidator reports invalid data if the value contains a currency symbol.</span></span> <span data-ttu-id="15b59-218">Přidejte $ před každé textové pole s jednotkovými cenami, které slouží jako vizuální upozornění, které uživateli dává pokyn, aby při zadávání ceny vynechal symbol měny.</span><span class="sxs-lookup"><span data-stu-id="15b59-218">Add a $ in front of each of the unit price TextBoxes to serve as a visual cue that instructs the user to omit the currency symbol when entering the price.</span></span>

<span data-ttu-id="15b59-219">Nakonec přidejte ovládací prvek ovládací souhrnu ověření do panelu `InsertingInterface`, nastavení jeho vlastnosti `ShowMessageBox` na `True` a jeho vlastnost `ShowSummary` na `False`.</span><span class="sxs-lookup"><span data-stu-id="15b59-219">Lastly, add a ValidationSummary control within the `InsertingInterface` Panel, settings its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span> <span data-ttu-id="15b59-220">Pokud uživatel zadá neplatnou hodnotu jednotkové ceny, zobrazí se u těchto nastavení hvězdička vedle problematických ovládacích prvků TextBox a ovládací souhrnu ověření zobrazí objekt MessageBox na straně klienta, který zobrazuje chybovou zprávu, kterou jsme zadali dříve.</span><span class="sxs-lookup"><span data-stu-id="15b59-220">With these settings, if the user enters an invalid unit price value, an asterisk will appear next to the offending TextBox controls and the ValidationSummary will display a client-side messagebox that shows the error message we specified earlier.</span></span>

<span data-ttu-id="15b59-221">V tomto okamžiku by měla obrazovka vypadat podobně jako obrázek 10.</span><span class="sxs-lookup"><span data-stu-id="15b59-221">At this point, your screen should look similar to Figure 10.</span></span>

<span data-ttu-id="15b59-222">[![rozhraní pro vložení teď obsahuje textová pole pro názvy produktů a jejich ceny.](batch-inserting-vb/_static/image29.png)](batch-inserting-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-222">[![The Inserting Interface Now Includes TextBoxes for the Products Names and Prices](batch-inserting-vb/_static/image29.png)](batch-inserting-vb/_static/image28.png)</span></span>

<span data-ttu-id="15b59-223">**Obrázek 10**: rozhraní pro vložení obsahuje textové pole pro názvy produktů a jejich ceny ([kliknutím zobrazíte obrázek v plné velikosti).](batch-inserting-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-223">**Figure 10**: The Inserting Interface Now Includes TextBoxes for the Products Names and Prices ([Click to view full-size image](batch-inserting-vb/_static/image30.png))</span></span>

<span data-ttu-id="15b59-224">Dál je potřeba přidat do řádku zápatí tlačítko Přidat produkty z expedice a zrušit.</span><span class="sxs-lookup"><span data-stu-id="15b59-224">Next we need to add the Add Products from Shipment and Cancel buttons to the footer row.</span></span> <span data-ttu-id="15b59-225">Přetáhněte ze sady nástrojů dva ovládací prvky tlačítka do zápatí rozhraní pro vložení, nastavením tlačítek `ID` vlastností `AddProducts` a `CancelButton` a `Text` vlastností přidejte produkty z expedice a zrušit v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="15b59-225">Drag two Button controls from the Toolbox into the footer of the inserting interface, setting the Buttons `ID` properties to `AddProducts` and `CancelButton` and `Text` properties to Add Products from Shipment and Cancel, respectively.</span></span> <span data-ttu-id="15b59-226">Kromě toho nastavte vlastnost `CancelButton` ovládací prvek s `CausesValidation` na `false`.</span><span class="sxs-lookup"><span data-stu-id="15b59-226">In addition, set the `CancelButton` control s `CausesValidation` property to `false`.</span></span>

<span data-ttu-id="15b59-227">Nakonec musíme přidat webový ovládací prvek popisku, který zobrazí stavové zprávy pro dvě rozhraní.</span><span class="sxs-lookup"><span data-stu-id="15b59-227">Finally, we need to add a Label Web control that will display status messages for the two interfaces.</span></span> <span data-ttu-id="15b59-228">Například když uživatel úspěšně přidá novou zásilku produktů, chceme se vrátit na zobrazovací rozhraní a zobrazit potvrzovací zprávu.</span><span class="sxs-lookup"><span data-stu-id="15b59-228">For example, when a user successfully adds a new shipment of products, we want to return to the display interface and display a confirmation message.</span></span> <span data-ttu-id="15b59-229">Pokud ale uživatel zadá cenu za nový produkt, ale ponechá název produktu, musíme zobrazit upozornění, protože pole `ProductName` je povinné.</span><span class="sxs-lookup"><span data-stu-id="15b59-229">If, however, the user provides a price for a new product but leaves off the product name, we need to display a warning message since the `ProductName` field is required.</span></span> <span data-ttu-id="15b59-230">Vzhledem k tomu, že potřebujeme, aby se tato zpráva zobrazovala pro obě rozhraní, umístěte ji v horní části stránky mimo panely.</span><span class="sxs-lookup"><span data-stu-id="15b59-230">Since we need this message to display for both interfaces, place it at the top of the page outside of the Panels.</span></span>

<span data-ttu-id="15b59-231">Přetáhněte ovládací prvek web Label ze sady nástrojů na začátek stránky v návrháři.</span><span class="sxs-lookup"><span data-stu-id="15b59-231">Drag a Label Web control from the Toolbox to the top of the page in the Designer.</span></span> <span data-ttu-id="15b59-232">Nastavte vlastnost `ID` na `StatusLabel`, vymažte vlastnost `Text` a nastavte vlastnosti `Visible` a `EnableViewState` na `False`.</span><span class="sxs-lookup"><span data-stu-id="15b59-232">Set the `ID` property to `StatusLabel`, clear out the `Text` property, and set the `Visible` and `EnableViewState` properties to `False`.</span></span> <span data-ttu-id="15b59-233">Jak jsme viděli v předchozích kurzech, nastavením vlastnosti `EnableViewState` na `False` umožníme programově změnit hodnoty vlastnosti Label a tak, aby se automaticky vrátily zpět na výchozí hodnoty při následném odeslání.</span><span class="sxs-lookup"><span data-stu-id="15b59-233">As we have seen in previous tutorials, setting the `EnableViewState` property to `False` allows us to programmatically change the Label s property values and have them automatically revert back to their defaults on the subsequent postback.</span></span> <span data-ttu-id="15b59-234">Tím se zjednoduší kód pro zobrazení stavové zprávy v reakci na určitou akci uživatele, která zmizí při následném zpětném odeslání.</span><span class="sxs-lookup"><span data-stu-id="15b59-234">This simplifies the code for showing a status message in response to some user action that disappears on the subsequent postback.</span></span> <span data-ttu-id="15b59-235">Nakonec nastavte vlastnost `StatusLabel` Control s `CssClass` na Warning, což je název třídy CSS definované v `Styles.css`, která zobrazuje text ve velkém, kurzívě, tučně červené písmo.</span><span class="sxs-lookup"><span data-stu-id="15b59-235">Finally, set the `StatusLabel` control s `CssClass` property to Warning, which is the name of a CSS class defined in `Styles.css` that displays text in a large, italic, bold, red font.</span></span>

<span data-ttu-id="15b59-236">Obrázek 11 znázorňuje Návrháře sady Visual Studio po přidání a konfiguraci popisku.</span><span class="sxs-lookup"><span data-stu-id="15b59-236">Figure 11 shows the Visual Studio Designer after the Label has been added and configured.</span></span>

<span data-ttu-id="15b59-237">[![umístit ovládací prvek StatusLabel nad dva ovládací prvky panelu](batch-inserting-vb/_static/image32.png)](batch-inserting-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-237">[![Place the StatusLabel Control Above the Two Panel Controls](batch-inserting-vb/_static/image32.png)](batch-inserting-vb/_static/image31.png)</span></span>

<span data-ttu-id="15b59-238">**Obrázek 11**: ovládací prvek `StatusLabel` nad dvěma ovládacími prvky panelu ([kliknutím zobrazíte obrázek v plné velikosti](batch-inserting-vb/_static/image33.png)).</span><span class="sxs-lookup"><span data-stu-id="15b59-238">**Figure 11**: Place the `StatusLabel` Control Above the Two Panel Controls ([Click to view full-size image](batch-inserting-vb/_static/image33.png))</span></span>

## <a name="step-3-switching-between-the-display-and-inserting-interfaces"></a><span data-ttu-id="15b59-239">Krok 3: přepínání mezi rozhraními Display a vložení</span><span class="sxs-lookup"><span data-stu-id="15b59-239">Step 3: Switching Between the Display and Inserting Interfaces</span></span>

<span data-ttu-id="15b59-240">V tuto chvíli jsme dokončili značky pro naše rozhraní zobrazení a vkládání, ale pořád zbývá dvě úlohy:</span><span class="sxs-lookup"><span data-stu-id="15b59-240">At this point we have completed the markup for our display and inserting interfaces, but we re still left with two tasks:</span></span>

- <span data-ttu-id="15b59-241">Přepínání mezi rozhraními Display a vložení</span><span class="sxs-lookup"><span data-stu-id="15b59-241">Switching between the display and inserting interfaces</span></span>
- <span data-ttu-id="15b59-242">Přidání produktů v dodávce do databáze</span><span class="sxs-lookup"><span data-stu-id="15b59-242">Adding the products in the shipment to the database</span></span>

<span data-ttu-id="15b59-243">V současné době je rozhraní zobrazení viditelné, ale rozhraní pro vložení je skryté.</span><span class="sxs-lookup"><span data-stu-id="15b59-243">Currently, the display interface is visible but the inserting interface is hidden.</span></span> <span data-ttu-id="15b59-244">Důvodem je, že vlastnost `DisplayInterface` panel s `Visible` je nastavena na hodnotu `True` (výchozí hodnota), zatímco vlastnost `InsertingInterface` panel s `Visible` je nastavena na hodnotu `False`.</span><span class="sxs-lookup"><span data-stu-id="15b59-244">This is because the `DisplayInterface` Panel s `Visible` property is set to `True` (the default value), while the `InsertingInterface` Panel s `Visible` property is set to `False`.</span></span> <span data-ttu-id="15b59-245">Pro přepínání mezi oběma rozhraními stačí jednoduše přepnout jednotlivé ovládací prvky s `Visible` hodnotou vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="15b59-245">To switch between the two interfaces we simply need to toggle each control s `Visible` property value.</span></span>

<span data-ttu-id="15b59-246">Po kliknutí na tlačítko pro expedici procesu produktu se chceme přesunout z rozhraní pro zobrazení na rozhraní pro vložení.</span><span class="sxs-lookup"><span data-stu-id="15b59-246">We want to move from the display interface to the inserting interface when the Process Product Shipment button is clicked.</span></span> <span data-ttu-id="15b59-247">Proto vytvořte obslužnou rutinu události pro toto tlačítko s `Click` událost, která obsahuje následující kód:</span><span class="sxs-lookup"><span data-stu-id="15b59-247">Therefore, create an event handler for this Button s `Click` event that contains the following code:</span></span>

[!code-vb[Main](batch-inserting-vb/samples/sample4.vb)]

<span data-ttu-id="15b59-248">Tento kód jednoduše skryje panel `DisplayInterface` a zobrazí `InsertingInterface` panel.</span><span class="sxs-lookup"><span data-stu-id="15b59-248">This code simply hides the `DisplayInterface` Panel and shows the `InsertingInterface` Panel.</span></span>

<span data-ttu-id="15b59-249">Dále vytvořte obslužné rutiny události pro ovládací prvky přidat produkty z expedice a zrušit v rozhraní pro vložení.</span><span class="sxs-lookup"><span data-stu-id="15b59-249">Next, create event handlers for the Add Products from Shipment and Cancel Button controls in the inserting interface.</span></span> <span data-ttu-id="15b59-250">Po kliknutí na některé z těchto tlačítek se musíme vrátit zpátky na zobrazovací rozhraní.</span><span class="sxs-lookup"><span data-stu-id="15b59-250">When either of these Buttons is clicked, we need to revert back to the display interface.</span></span> <span data-ttu-id="15b59-251">Vytvořte obslužné rutiny událostí `Click` pro obě ovládací prvky tlačítko tak, aby volaly `ReturnToDisplayInterface`, metoda, kterou přidáme za chvíli.</span><span class="sxs-lookup"><span data-stu-id="15b59-251">Create `Click` event handlers for both Button controls so that they call `ReturnToDisplayInterface`, a method we will add momentarily.</span></span> <span data-ttu-id="15b59-252">Kromě skrytí `InsertingInterface`ho panelu a zobrazení `DisplayInterface`ho panelu musí metoda `ReturnToDisplayInterface` vracet webové ovládací prvky do stavu před úpravou.</span><span class="sxs-lookup"><span data-stu-id="15b59-252">In addition to hiding the `InsertingInterface` Panel and showing the `DisplayInterface` Panel, the `ReturnToDisplayInterface` method needs to return the Web controls to their pre-editing state.</span></span> <span data-ttu-id="15b59-253">To zahrnuje nastavení vlastností DropDownList `SelectedIndex` na hodnotu 0 a vymazávání vlastností `Text` ovládacích prvků TextBox.</span><span class="sxs-lookup"><span data-stu-id="15b59-253">This involves setting the DropDownLists `SelectedIndex` properties to 0 and clearing out the `Text` properties of the TextBox controls.</span></span>

> [!NOTE]
> <span data-ttu-id="15b59-254">Zvažte, co se může stát, když jsme ovládací prvky před návratem do rozhraní zobrazení nevrátili do stavu před úpravou.</span><span class="sxs-lookup"><span data-stu-id="15b59-254">Consider what might happen if we didn't return the controls to their pre-editing state before returning to the display interface.</span></span> <span data-ttu-id="15b59-255">Uživatel může kliknout na tlačítko Zpracovat dodávku produktu, zadat produkty z dodávky a pak kliknout na Přidat produkty z dodávky.</span><span class="sxs-lookup"><span data-stu-id="15b59-255">A user might click the Process Product Shipment button, enter the products from the shipment, and then click Add Products from Shipment.</span></span> <span data-ttu-id="15b59-256">To by mohlo přidat produkty a vrátit uživatele do rozhraní zobrazení.</span><span class="sxs-lookup"><span data-stu-id="15b59-256">This would add the products and return the user to the display interface.</span></span> <span data-ttu-id="15b59-257">V tomto okamžiku může uživatel chtít přidat další dodávku.</span><span class="sxs-lookup"><span data-stu-id="15b59-257">At this point the user might want to add another shipment.</span></span> <span data-ttu-id="15b59-258">Po kliknutí na tlačítko Zpracovat dodávku produktu by se vrátila do rozhraní pro vložení, ale výběry DropDownList a hodnoty TextBox by se měly pořád naplnit jejich předchozími hodnotami.</span><span class="sxs-lookup"><span data-stu-id="15b59-258">Upon clicking the Process Product Shipment button they would return to the inserting interface but the DropDownList selections and TextBox values would still be populated with their previous values.</span></span>

[!code-vb[Main](batch-inserting-vb/samples/sample5.vb)]

<span data-ttu-id="15b59-259">Oba obslužné rutiny událostí `Click` jednoduše volají metodu `ReturnToDisplayInterface`, ale v kroku 4 se vrátíme k obslužné rutině události přidat produkty z dodávky `Click` a přidáte kód pro uložení produktů.</span><span class="sxs-lookup"><span data-stu-id="15b59-259">Both `Click` event handlers simply call the `ReturnToDisplayInterface` method, although we'll return to the Add Products from Shipment `Click` event handler in Step 4 and add code to save the products.</span></span> <span data-ttu-id="15b59-260">`ReturnToDisplayInterface` spustí vrácením `Suppliers` a `Categories` DropDownList na první možnosti.</span><span class="sxs-lookup"><span data-stu-id="15b59-260">`ReturnToDisplayInterface` starts by returning the `Suppliers` and `Categories` DropDownLists to their first options.</span></span> <span data-ttu-id="15b59-261">Tyto dvě konstanty `firstControlID` a `lastControlID` označují počáteční a koncové hodnoty indexu ovládacího prvku používané při pojmenování názvu produktu a textových polí s cenami v rozhraní vkládání a používají se v hranicích `For` smyčky, která nastavuje `Text` vlastnosti ovládacího prvku TextBox zpět na prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="15b59-261">The two constants `firstControlID` and `lastControlID` mark the starting and ending control index values used in naming the product name and unit price TextBoxes in the inserting interface and are used in the bounds of the `For` loop that sets the `Text` properties of the TextBox controls back to an empty string.</span></span> <span data-ttu-id="15b59-262">Nakonec se panely `Visible` vlastnosti resetují, aby bylo vkládání rozhraní skryté a zobrazené rozhraní zobrazení.</span><span class="sxs-lookup"><span data-stu-id="15b59-262">Finally, the Panels `Visible` properties are reset so that the inserting interface is hidden and the display interface shown.</span></span>

<span data-ttu-id="15b59-263">Chvíli počkejte, než otestujete tuto stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="15b59-263">Take a moment to test out this page in a browser.</span></span> <span data-ttu-id="15b59-264">Při první návštěvě stránky by se mělo zobrazit rozhraní pro zobrazení zobrazené na obrázku 5.</span><span class="sxs-lookup"><span data-stu-id="15b59-264">When first visiting the page you should see the display interface as was shown in Figure 5.</span></span> <span data-ttu-id="15b59-265">Klikněte na tlačítko Zpracovat dodávku produktu.</span><span class="sxs-lookup"><span data-stu-id="15b59-265">Click the Process Product Shipment button.</span></span> <span data-ttu-id="15b59-266">Stránka se odešle zpět a mělo by se teď zobrazit rozhraní pro vložení, jak je znázorněno na obrázku 12.</span><span class="sxs-lookup"><span data-stu-id="15b59-266">The page will postback and you should now see the inserting interface as shown in Figure 12.</span></span> <span data-ttu-id="15b59-267">Kliknutím na tlačítko Přidat produkty z expedice nebo zrušit se vrátíte k rozhraní zobrazení.</span><span class="sxs-lookup"><span data-stu-id="15b59-267">Clicking either the Add Products from Shipment or Cancel buttons returns you to the display interface.</span></span>

> [!NOTE]
> <span data-ttu-id="15b59-268">Při prohlížení rozhraní pro vkládání si chvíli počkejte, než CompareValidators otestujete v textových polích s cenami za jednotku.</span><span class="sxs-lookup"><span data-stu-id="15b59-268">While viewing the inserting interface, take a moment to test out the CompareValidators on the unit price TextBoxes.</span></span> <span data-ttu-id="15b59-269">Když kliknete na tlačítko Přidat produkty z dodávky s neplatnými hodnotami měny nebo ceny s hodnotou menší než nula, mělo by se zobrazit upozornění na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="15b59-269">You should see a client-side messagebox warning when clicking the Add Products from Shipment button with invalid currency values or prices with a value less than zero.</span></span>

<span data-ttu-id="15b59-270">[Po kliknutí na tlačítko Zpracovat dodávku produktu se zobrazí ![rozhraní pro vložení.](batch-inserting-vb/_static/image35.png)](batch-inserting-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-270">[![The Inserting Interface is Displayed After Clicking the Process Product Shipment Button](batch-inserting-vb/_static/image35.png)](batch-inserting-vb/_static/image34.png)</span></span>

<span data-ttu-id="15b59-271">**Obrázek 12**: rozhraní pro vložení se zobrazí po kliknutí na tlačítko Zpracovat dodávku produktu ([kliknutím zobrazíte obrázek v plné velikosti](batch-inserting-vb/_static/image36.png)).</span><span class="sxs-lookup"><span data-stu-id="15b59-271">**Figure 12**: The Inserting Interface is Displayed After Clicking the Process Product Shipment Button ([Click to view full-size image](batch-inserting-vb/_static/image36.png))</span></span>

## <a name="step-4-adding-the-products"></a><span data-ttu-id="15b59-272">Krok 4: Přidání produktů</span><span class="sxs-lookup"><span data-stu-id="15b59-272">Step 4: Adding the Products</span></span>

<span data-ttu-id="15b59-273">Vše, co pro tento kurz zbývá, je uložit produkty do databáze v okně Přidat produkty z tlačítka pro expedici s `Click` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="15b59-273">All that remains for this tutorial is to save the products to the database in the Add Products from Shipment Button s `Click` event handler.</span></span> <span data-ttu-id="15b59-274">To lze provést vytvořením `ProductsDataTable` a přidáním instance `ProductsRow` pro každý zadaný název produktu.</span><span class="sxs-lookup"><span data-stu-id="15b59-274">This can be accomplished by creating a `ProductsDataTable` and adding a `ProductsRow` instance for each of the product names supplied.</span></span> <span data-ttu-id="15b59-275">Po přidání těchto `ProductsRow` se provede volání metody `ProductsBLL` třídy s `UpdateWithTransaction` předání do `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="15b59-275">Once these `ProductsRow` s have been added we will make a call to the `ProductsBLL` class s `UpdateWithTransaction` method passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="15b59-276">Odvolat, že metoda `UpdateWithTransaction`, která byla vytvořena zpátky v [rámci kurzu transakce](wrapping-database-modifications-within-a-transaction-vb.md) , předává `ProductsDataTable` do metody `UpdateWithTransaction` `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="15b59-276">Recall that the `UpdateWithTransaction` method, which was created back in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial, passes the `ProductsDataTable` to the `ProductsTableAdapter`'s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="15b59-277">Odtud se spustí transakce ADO.NET a TableAdapter vydá příkaz `INSERT` do databáze pro každý přidaný `ProductsRow` v objektu DataTable.</span><span class="sxs-lookup"><span data-stu-id="15b59-277">From there, an ADO.NET transaction is started and the TableAdapter issues an `INSERT` statement to the database for each added `ProductsRow` in the DataTable.</span></span> <span data-ttu-id="15b59-278">Za předpokladu, že jsou všechny produkty přidány bez chyby, transakce je potvrzena, jinak se vrátí zpět.</span><span class="sxs-lookup"><span data-stu-id="15b59-278">Assuming all products are added without error, the transaction is committed, otherwise it is rolled back.</span></span>

<span data-ttu-id="15b59-279">Kód pro obslužnou rutinu tlačítka pro přidání produktů z `Click` pro příjem také musí provést kontrolu chyb.</span><span class="sxs-lookup"><span data-stu-id="15b59-279">The code for the Add Products from Shipment Button s `Click` event handler also needs to perform a bit of error checking.</span></span> <span data-ttu-id="15b59-280">Vzhledem k tomu, že v rozhraní pro vkládání nejsou použité žádné RequiredFieldValidators, může uživatel zadat cenu za produkt a zároveň ho vynechat.</span><span class="sxs-lookup"><span data-stu-id="15b59-280">Since there are no RequiredFieldValidators used in the inserting interface, a user could enter a price for a product while omitting its name.</span></span> <span data-ttu-id="15b59-281">Vzhledem k tomu, že je název produktu povinný, pokud taková podmínka odloží, musíme uživateli upozornit a nepokračovat v vkládání.</span><span class="sxs-lookup"><span data-stu-id="15b59-281">Since the product s name is required, if such a condition unfolds we need to alert the user and not proceed with the inserts.</span></span> <span data-ttu-id="15b59-282">Úplný kód obslužné rutiny události `Click` následuje:</span><span class="sxs-lookup"><span data-stu-id="15b59-282">The complete `Click` event handler code follows:</span></span>

[!code-vb[Main](batch-inserting-vb/samples/sample6.vb)]

<span data-ttu-id="15b59-283">Obslužná rutina události začíná tím, že zajistí, že vlastnost `Page.IsValid` vrátí hodnotu `True`.</span><span class="sxs-lookup"><span data-stu-id="15b59-283">The event handler starts by ensuring that the `Page.IsValid` property returns a value of `True`.</span></span> <span data-ttu-id="15b59-284">Pokud vrátí `False`, znamená to, že jeden nebo více CompareValidators vydává neplatné údaje. v takovém případě se nechcete pokusit vložit zadané produkty. při pokusu o přiřazení hodnoty jednotkové ceny zadané uživatelem do vlastnosti `ProductsRow` s `UnitPrice` se ale ukončí výjimka.</span><span class="sxs-lookup"><span data-stu-id="15b59-284">If it returns `False`, then that means one or more of the CompareValidators are reporting invalid data; in such a case we do not want to attempt to insert the entered products or we'll end up with an exception when attempting to assign the user-entered unit price value to the `ProductsRow` s `UnitPrice` property.</span></span>

<span data-ttu-id="15b59-285">V dalším kroku se vytvoří nová instance `ProductsDataTable` (`products`).</span><span class="sxs-lookup"><span data-stu-id="15b59-285">Next, a new `ProductsDataTable` instance is created (`products`).</span></span> <span data-ttu-id="15b59-286">Smyčka `For` slouží k iterování v názvu produktu a textových polích s cenami za jednotku a vlastnosti `Text` jsou čteny do místních proměnných `productName` a `unitPrice`.</span><span class="sxs-lookup"><span data-stu-id="15b59-286">A `For` loop is used to iterate through the product name and unit price TextBoxes and the `Text` properties are read into the local variables `productName` and `unitPrice`.</span></span> <span data-ttu-id="15b59-287">Pokud uživatel zadal hodnotu pro jednotkovou cenu, ale ne pro odpovídající název produktu, `StatusLabel` zobrazí zprávu, pokud zadáte jednotkovou cenu, musíte také uvést název produktu a obslužné rutiny události se ukončí.</span><span class="sxs-lookup"><span data-stu-id="15b59-287">If the user has entered a value for the unit price but not for the corresponding product name, the `StatusLabel` displays the message If you provide a unit price you must also include the name of the product and the event handler is exited.</span></span>

<span data-ttu-id="15b59-288">Pokud byl zadán název produktu, vytvoří se nová instance `ProductsRow` pomocí metody `ProductsDataTable` s `NewProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="15b59-288">If a product name has been provided, a new `ProductsRow` instance is created using the `ProductsDataTable` s `NewProductsRow` method.</span></span> <span data-ttu-id="15b59-289">Tato nová vlastnost `ProductsRow` instance `ProductName` je nastavena na textové pole s aktuálním názvem produktu, zatímco vlastnosti `SupplierID` a `CategoryID` jsou přiřazeny k `SelectedValue` vlastnostem ovládacích prvků DropDownList v hlavičce vložení rozhraní s.</span><span class="sxs-lookup"><span data-stu-id="15b59-289">This new `ProductsRow` instance s `ProductName` property is set to the current product name TextBox while the `SupplierID` and `CategoryID` properties are assigned to the `SelectedValue` properties of the DropDownLists in the inserting interface s header.</span></span> <span data-ttu-id="15b59-290">Pokud uživatel zadal hodnotu ceny produktu, je přiřazen k vlastnosti `ProductsRow` instance s `UnitPrice`; v opačném případě zůstane vlastnost ponecháno Nepřiřazeno. výsledkem bude `NULL` hodnota `UnitPrice` v databázi.</span><span class="sxs-lookup"><span data-stu-id="15b59-290">If the user entered a value for the product s price, it is assigned to the `ProductsRow` instance s `UnitPrice` property; otherwise, the property is left unassigned, which will result in a `NULL` value for `UnitPrice` in the database.</span></span> <span data-ttu-id="15b59-291">Nakonec jsou vlastnosti `Discontinued` a `UnitsOnOrder` přiřazeny pevně zakódované hodnoty `False` a 0 v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="15b59-291">Finally, the `Discontinued` and `UnitsOnOrder` properties are assigned to the hard-coded values `False` and 0, respectively.</span></span>

<span data-ttu-id="15b59-292">Až se vlastnosti přiřadí do instance `ProductsRow`, přidají se do `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="15b59-292">After the properties have been assigned to the `ProductsRow` instance it is added to the `ProductsDataTable`.</span></span>

<span data-ttu-id="15b59-293">Po dokončení smyčky `For` zkontrolujeme, jestli se nějaké produkty přidaly.</span><span class="sxs-lookup"><span data-stu-id="15b59-293">At the completion of the `For` loop, we check whether any products have been added.</span></span> <span data-ttu-id="15b59-294">Uživatel může po všech případech kliknout na položku Přidat produkty z dodávky a teprve potom zadat názvy produktů nebo ceny.</span><span class="sxs-lookup"><span data-stu-id="15b59-294">The user may, after all, have clicked the Add Products from Shipment before entering any product names or prices.</span></span> <span data-ttu-id="15b59-295">Pokud je v `ProductsDataTable`alespoň jeden produkt, je volána metoda `ProductsBLL` třídy `UpdateWithTransaction`.</span><span class="sxs-lookup"><span data-stu-id="15b59-295">If there is at least one product in the `ProductsDataTable`, the `ProductsBLL` class s `UpdateWithTransaction` method is called.</span></span> <span data-ttu-id="15b59-296">Dále jsou data znovu svázána s `ProductsGrid` GridView, takže nově přidané produkty se zobrazí v rozhraní zobrazení.</span><span class="sxs-lookup"><span data-stu-id="15b59-296">Next, the data is rebound to the `ProductsGrid` GridView so that the newly added products will appear in the display interface.</span></span> <span data-ttu-id="15b59-297">`StatusLabel` se aktualizuje, aby se zobrazila potvrzovací zpráva a vyvolalo se `ReturnToDisplayInterface`, aby se přestalo rozhraní pro vkládání a zobrazení rozhraní.</span><span class="sxs-lookup"><span data-stu-id="15b59-297">The `StatusLabel` is updated to display a confirmation message and the `ReturnToDisplayInterface` is invoked, hiding the inserting interface and showing the display interface.</span></span>

<span data-ttu-id="15b59-298">Pokud nebyly zadány žádné produkty, rozhraní pro vložení zůstane zobrazeno, ale zpráva nebyla přidána žádná zboží.</span><span class="sxs-lookup"><span data-stu-id="15b59-298">If no products were entered, the inserting interface remains displayed but the message No products were added.</span></span> <span data-ttu-id="15b59-299">Zadejte prosím názvy produktů a jednotkové ceny v textových polích, které se zobrazí.</span><span class="sxs-lookup"><span data-stu-id="15b59-299">Please enter the product names and unit prices in the textboxes is displayed.</span></span>

<span data-ttu-id="15b59-300">Obrázek s 13, 14 a 15 zobrazuje rozhraní pro vkládání a zobrazování v akci.</span><span class="sxs-lookup"><span data-stu-id="15b59-300">Figure s 13, 14, and 15 show the inserting and display interfaces in action.</span></span> <span data-ttu-id="15b59-301">Na obrázku 13 zadal uživatel hodnotu jednotkové ceny bez odpovídajícího názvu produktu.</span><span class="sxs-lookup"><span data-stu-id="15b59-301">In Figure 13, the user has entered a unit price value without a corresponding product name.</span></span> <span data-ttu-id="15b59-302">Obrázek 14 ukazuje rozhraní zobrazení po úspěšném přidání tří nových produktů, zatímco obrázek 15 ukazuje dva z nově přidaných produktů v prvku GridView (třetí z nich je na předchozí stránce).</span><span class="sxs-lookup"><span data-stu-id="15b59-302">Figure 14 shows the display interface after three new products have been added successfully, while Figure 15 shows two of the newly added products in the GridView (the third one is on the previous page).</span></span>

<span data-ttu-id="15b59-303">[Při zadání jednotkové ceny se ![vyžaduje název produktu.](batch-inserting-vb/_static/image38.png)](batch-inserting-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-303">[![A Product Name is Required When Entering a Unit Price](batch-inserting-vb/_static/image38.png)](batch-inserting-vb/_static/image37.png)</span></span>

<span data-ttu-id="15b59-304">**Obrázek 13**: při zadávání ceny za jednotku se vyžaduje název produktu ([kliknutím zobrazíte obrázek v plné velikosti](batch-inserting-vb/_static/image39.png)).</span><span class="sxs-lookup"><span data-stu-id="15b59-304">**Figure 13**: A Product Name is Required When Entering a Unit Price ([Click to view full-size image](batch-inserting-vb/_static/image39.png))</span></span>

<span data-ttu-id="15b59-305">[pro dodavatele Mayumi se přidal tento ![tři nové veggies.](batch-inserting-vb/_static/image41.png)](batch-inserting-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-305">[![Three New Veggies Have Been Added for the Supplier Mayumi s](batch-inserting-vb/_static/image41.png)](batch-inserting-vb/_static/image40.png)</span></span>

<span data-ttu-id="15b59-306">**Obrázek 14**: Přidali jsme tři nové veggies pro dodavatele Mayumi s ([kliknutím zobrazíte obrázek v plné velikosti).](batch-inserting-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-306">**Figure 14**: Three New Veggies Have Been Added for the Supplier Mayumi s ([Click to view full-size image](batch-inserting-vb/_static/image42.png))</span></span>

<span data-ttu-id="15b59-307">[![nové produkty najdete na poslední stránce prvku GridView.](batch-inserting-vb/_static/image44.png)](batch-inserting-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="15b59-307">[![The New Products Can Be Found in the Last Page of the GridView](batch-inserting-vb/_static/image44.png)](batch-inserting-vb/_static/image43.png)</span></span>

<span data-ttu-id="15b59-308">**Obrázek 15**: nové produkty lze najít na poslední stránce prvku GridView ([kliknutím zobrazíte obrázek v plné velikosti](batch-inserting-vb/_static/image45.png)).</span><span class="sxs-lookup"><span data-stu-id="15b59-308">**Figure 15**: The New Products Can Be Found in the Last Page of the GridView ([Click to view full-size image](batch-inserting-vb/_static/image45.png))</span></span>

> [!NOTE]
> <span data-ttu-id="15b59-309">Dávková vložení logiky použité v tomto kurzu zabalí vložení do oboru transakce.</span><span class="sxs-lookup"><span data-stu-id="15b59-309">The batch inserting logic used in this tutorial wraps the inserts within the scope of transaction.</span></span> <span data-ttu-id="15b59-310">Pokud to chcete ověřit, záměrně zavádí chybu na úrovni databáze.</span><span class="sxs-lookup"><span data-stu-id="15b59-310">To verify this, purposefully introduce a database-level error.</span></span> <span data-ttu-id="15b59-311">Například namísto přiřazení nové vlastnosti `ProductsRow` instance s `CategoryID` k vybrané hodnotě v `Categories` DropDownList, přiřaďte ji k hodnotě, jako je `i * 5`.</span><span class="sxs-lookup"><span data-stu-id="15b59-311">For example, rather than assigning the new `ProductsRow` instance s `CategoryID` property to the selected value in the `Categories` DropDownList, assign it to a value like `i * 5`.</span></span> <span data-ttu-id="15b59-312">Tady `i` je indexer smyčky a má hodnoty od 1 do 5.</span><span class="sxs-lookup"><span data-stu-id="15b59-312">Here `i` is the loop indexer and has values ranging from 1 to 5.</span></span> <span data-ttu-id="15b59-313">Proto při přidávání dvou nebo více produktů do dávky vloží první produkt platnou hodnotu `CategoryID` (5), ale další produkty budou mít `CategoryID` hodnoty, které neodpovídají hodnotám `CategoryID` v tabulce `Categories`.</span><span class="sxs-lookup"><span data-stu-id="15b59-313">Therefore, when adding two or more products in batch insert the first product will have a valid `CategoryID` value (5), but subsequent products will have `CategoryID` values that do not match up to `CategoryID` values in the `Categories` table.</span></span> <span data-ttu-id="15b59-314">Čistým účinkem je to, že zatímco první `INSERT` bude úspěšná, dojde při selhání k porušení omezení cizího klíče.</span><span class="sxs-lookup"><span data-stu-id="15b59-314">The net effect is that while the first `INSERT` will succeed, subsequent ones will fail with a foreign key constraint violation.</span></span> <span data-ttu-id="15b59-315">Vzhledem k tomu, že dávková operace INSERT je atomická, první `INSERT` se vrátí zpět a vrátí databázi do stavu před zahájením procesu dávkového vkládání.</span><span class="sxs-lookup"><span data-stu-id="15b59-315">Since the batch insert is atomic, the first `INSERT` will be rolled back, returning the database to its state before the batch insert process began.</span></span>

## <a name="summary"></a><span data-ttu-id="15b59-316">Přehled</span><span class="sxs-lookup"><span data-stu-id="15b59-316">Summary</span></span>

<span data-ttu-id="15b59-317">V tomto a předchozích dvou kurzech jsme vytvořili rozhraní, která umožňují aktualizovat, odstraňovat a vkládat dávky dat, a to vše, co používalo podporu transakcí, kterou jsme přidali do vrstvy přístupu k datům v [rámci](wrapping-database-modifications-within-a-transaction-vb.md) kurzových úprav v transakci.</span><span class="sxs-lookup"><span data-stu-id="15b59-317">Over this and the previous two tutorials we have created interfaces that allow for updating, deleting, and inserting batches of data, all of which used the transaction support we added to the Data Access Layer in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial.</span></span> <span data-ttu-id="15b59-318">V některých scénářích Tato uživatelská rozhraní dávkového zpracování významně zlepšují efektivitu koncových uživatelů tím, že rozchází na počet kliknutí, postbacků a přepínačů kontextu klávesnice na myš a zároveň zachovává integritu podkladových dat.</span><span class="sxs-lookup"><span data-stu-id="15b59-318">For certain scenarios, such batch processing user interfaces greatly improve end user efficiency by cutting down on the number of clicks, postbacks, and keyboard-to-mouse context switches, while also maintaining the integrity of the underlying data.</span></span>

<span data-ttu-id="15b59-319">V tomto kurzu se dokončí náš pohled na práci s daty v dávce.</span><span class="sxs-lookup"><span data-stu-id="15b59-319">This tutorial completes our look at working with batched data.</span></span> <span data-ttu-id="15b59-320">V další sadě kurzů se seznámíte s řadou pokročilých scénářů vrstev přístupu k datům, včetně použití uložených procedur v metodách TableAdapter s, konfigurace nastavení na úrovni připojení a příkazů v DAL, šifrování připojovacích řetězců a dalších akcí.</span><span class="sxs-lookup"><span data-stu-id="15b59-320">The next set of tutorials explores a variety of advanced Data Access Layer scenarios, including using stored procedures in the TableAdapter s methods, configuring connection- and command-level settings in the DAL, encrypting connection strings, and more!</span></span>

<span data-ttu-id="15b59-321">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="15b59-321">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="15b59-322">O autorovi</span><span class="sxs-lookup"><span data-stu-id="15b59-322">About the Author</span></span>

<span data-ttu-id="15b59-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor 7 ASP/ASP. NET Books a zakladatel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="15b59-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="15b59-324">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="15b59-324">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="15b59-325">Nejnovější kniha je [*Sams naučit se ASP.NET 2,0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="15b59-325">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="15b59-326">Dá se získat na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="15b59-326">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="15b59-327">nebo prostřednictvím svého blogu, který najdete na adrese [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="15b59-327">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="15b59-328">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="15b59-328">Special Thanks To</span></span>

<span data-ttu-id="15b59-329">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="15b59-329">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="15b59-330">Kontroloři vedoucích k tomuto kurzu byli Hilton Giesenow a S Ren Jacob Lauritsen.</span><span class="sxs-lookup"><span data-stu-id="15b59-330">Lead reviewers for this tutorial were Hilton Giesenow and S ren Jacob Lauritsen.</span></span> <span data-ttu-id="15b59-331">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="15b59-331">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="15b59-332">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="15b59-332">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="15b59-333">Předchozí</span><span class="sxs-lookup"><span data-stu-id="15b59-333">Previous</span></span>](batch-deleting-vb.md)
