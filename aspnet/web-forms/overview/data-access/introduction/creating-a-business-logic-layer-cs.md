---
uid: web-forms/overview/data-access/introduction/creating-a-business-logic-layer-cs
title: Vytvoření vrstvy obchodní logiky (C#) | Dokumentace Microsoftu
author: rick-anderson
description: V tomto kurzu uvidíme, jak centralizovat do obchodní logiku vrstvy (BLL), která slouží jako zprostředkovatel pro výměnu dat mezi t obchodní pravidla...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 85554606-47cb-4e4f-9848-eed9da579056
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-business-logic-layer-cs
msc.type: authoredcontent
ms.openlocfilehash: fd3bf46394f562462c561bf06370d2f372e47d0a
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/09/2019
ms.locfileid: "59415260"
---
# <a name="creating-a-business-logic-layer-c"></a><span data-ttu-id="78cd2-103">Vytvoření vrstvy obchodní logiky (C#)</span><span class="sxs-lookup"><span data-stu-id="78cd2-103">Creating a Business Logic Layer (C#)</span></span>

<span data-ttu-id="78cd2-104">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="78cd2-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="78cd2-105">[Stáhněte si ukázkovou aplikaci](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_2_CS.exe) nebo [stahovat PDF](creating-a-business-logic-layer-cs/_static/datatutorial02cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="78cd2-105">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_2_CS.exe) or [Download PDF](creating-a-business-logic-layer-cs/_static/datatutorial02cs1.pdf)</span></span>

> <span data-ttu-id="78cd2-106">V tomto kurzu uvidíme, jak centralizovat obchodních pravidel do obchodní logiku vrstvy (BLL), která slouží jako zprostředkovatel pro výměnu dat mezi prezentační vrstvou a vrstvy DAL.</span><span class="sxs-lookup"><span data-stu-id="78cd2-106">In this tutorial we'll see how to centralize your business rules into a Business Logic Layer (BLL) that serves as an intermediary for data exchange between the presentation layer and the DAL.</span></span>


## <a name="introduction"></a><span data-ttu-id="78cd2-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="78cd2-107">Introduction</span></span>

<span data-ttu-id="78cd2-108">Data přístup Layer (DAL) vytvořené v [první kurz](creating-a-data-access-layer-cs.md) jasně odděluje data přístup logiky od logiky prezentace.</span><span class="sxs-lookup"><span data-stu-id="78cd2-108">The Data Access Layer (DAL) created in the [first tutorial](creating-a-data-access-layer-cs.md) cleanly separates the data access logic from the presentation logic.</span></span> <span data-ttu-id="78cd2-109">Ale při DAL čistě odděluje podrobnosti o přístupu dat od prezentační vrstvy, nevynucuje žádná obchodní pravidla, která jim umožňují uplatnit.</span><span class="sxs-lookup"><span data-stu-id="78cd2-109">However, while the DAL cleanly separates the data access details from the presentation layer, it does not enforce any business rules that may apply.</span></span> <span data-ttu-id="78cd2-110">Například pro naši aplikaci budeme chtít zakázat `CategoryID` nebo `SupplierID` pole `Products` tabulka, která má být změněna při `Discontinued` je nastaveno na 1 nebo budeme chtít vynutit pravidla služební zákazu situace, kdy Zaměstnanec spravuje uživatele, který byl přijat po nich.</span><span class="sxs-lookup"><span data-stu-id="78cd2-110">For example, for our application we may want to disallow the `CategoryID` or `SupplierID` fields of the `Products` table to be modified when the `Discontinued` field is set to 1, or we might want to enforce seniority rules, prohibiting situations in which an employee is managed by someone who was hired after them.</span></span> <span data-ttu-id="78cd2-111">Další z typických možností je možná jenom uživatelé autorizace v konkrétní roli můžete odstranit produktů nebo můžete změnit `UnitPrice` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="78cd2-111">Another common scenario is authorization perhaps only users in a particular role can delete products or can change the `UnitPrice` value.</span></span>

<span data-ttu-id="78cd2-112">V tomto kurzu uvidíme, jak centralizovat těchto obchodních pravidel do obchodní logiku vrstvy (BLL), která slouží jako zprostředkovatel pro výměnu dat mezi prezentační vrstvou a vrstvy DAL.</span><span class="sxs-lookup"><span data-stu-id="78cd2-112">In this tutorial we'll see how to centralize these business rules into a Business Logic Layer (BLL) that serves as an intermediary for data exchange between the presentation layer and the DAL.</span></span> <span data-ttu-id="78cd2-113">V reálné aplikaci BLL by měla být implementována jako samostatný projekt knihovny tříd; ale tyto kurzy jsme budete implementovat BLL jako řadu objektů třídy v našich `App_Code` složku pro zjednodušení strukturu projektu.</span><span class="sxs-lookup"><span data-stu-id="78cd2-113">In a real-world application, the BLL should be implemented as a separate Class Library project; however, for these tutorials we'll implement the BLL as a series of classes in our `App_Code` folder in order to simplify the project structure.</span></span> <span data-ttu-id="78cd2-114">Obrázek 1 ukazuje architekturu vztahy mezi prezentační vrstvou, knihoven BLL a DAL.</span><span class="sxs-lookup"><span data-stu-id="78cd2-114">Figure 1 illustrates the architectural relationships among the presentation layer, BLL, and DAL.</span></span>


![BLL odděluje prezentační vrstvy z vrstvy přístupu k datům a ukládá obchodní pravidla](creating-a-business-logic-layer-cs/_static/image1.png)

<span data-ttu-id="78cd2-116">**Obrázek 1**: BLL odděluje prezentační vrstvy z vrstvy přístupu k datům a ukládá obchodní pravidla</span><span class="sxs-lookup"><span data-stu-id="78cd2-116">**Figure 1**: The BLL Separates the Presentation Layer from the Data Access Layer and Imposes Business Rules</span></span>


## <a name="step-1-creating-the-bll-classes"></a><span data-ttu-id="78cd2-117">Krok 1: Vytvoření tříd BLL</span><span class="sxs-lookup"><span data-stu-id="78cd2-117">Step 1: Creating the BLL Classes</span></span>

<span data-ttu-id="78cd2-118">Našich knihoven BLL se skládá ze čtyř tříd, jeden pro každý TableAdapter v DAL; Každá z těchto tříd BLL bude mít metody pro načítání, vkládání, aktualizaci a odstraňování z příslušných TableAdapter v použití pravidel obchodními vrstvy DAL.</span><span class="sxs-lookup"><span data-stu-id="78cd2-118">Our BLL will be composed of four classes, one for each TableAdapter in the DAL; each of these BLL classes will have methods for retrieving, inserting, updating, and deleting from the respective TableAdapter in the DAL, applying the appropriate business rules.</span></span>

<span data-ttu-id="78cd2-119">Chcete-li více čistě oddělte třídy související s vrstvou DAL a BLL, vytvoříme dvě podsložky v `App_Code` složce `DAL` a `BLL`.</span><span class="sxs-lookup"><span data-stu-id="78cd2-119">To more cleanly separate the DAL- and BLL-related classes, let's create two subfolders in the `App_Code` folder, `DAL` and `BLL`.</span></span> <span data-ttu-id="78cd2-120">Jednoduše klikněte pravým tlačítkem na `App_Code` složku v Průzkumníku řešení a zvolte možnost nové složky.</span><span class="sxs-lookup"><span data-stu-id="78cd2-120">Simply right-click on the `App_Code` folder in the Solution Explorer and choose New Folder.</span></span> <span data-ttu-id="78cd2-121">Po vytvoření tyto dvě složky, přesuňte typované datové sady vytvořené v první kurz služby do `DAL` podsložky.</span><span class="sxs-lookup"><span data-stu-id="78cd2-121">After creating these two folders, move the Typed DataSet created in the first tutorial into the `DAL` subfolder.</span></span>

<span data-ttu-id="78cd2-122">Dále vytvořte čtyři soubory tříd BLL v `BLL` podsložky.</span><span class="sxs-lookup"><span data-stu-id="78cd2-122">Next, create the four BLL class files in the `BLL` subfolder.</span></span> <span data-ttu-id="78cd2-123">Chcete-li to provést, klikněte pravým tlačítkem na `BLL` podsložku, zvolte možnost Přidat novou položku a zvolte šablonu třídy.</span><span class="sxs-lookup"><span data-stu-id="78cd2-123">To accomplish this, right-click on the `BLL` subfolder, choose Add a New Item, and choose the Class template.</span></span> <span data-ttu-id="78cd2-124">Název třídy čtyři `ProductsBLL`, `CategoriesBLL`, `SuppliersBLL`, a `EmployeesBLL`.</span><span class="sxs-lookup"><span data-stu-id="78cd2-124">Name the four classes `ProductsBLL`, `CategoriesBLL`, `SuppliersBLL`, and `EmployeesBLL`.</span></span>


![Čtyři nové třídy přidat složku App_Code](creating-a-business-logic-layer-cs/_static/image2.png)

<span data-ttu-id="78cd2-126">**Obrázek 2**: Přidat čtyři nové třídy `App_Code` složky</span><span class="sxs-lookup"><span data-stu-id="78cd2-126">**Figure 2**: Add Four New Classes to the `App_Code` Folder</span></span>


<span data-ttu-id="78cd2-127">V dalším kroku přidejme metody do všech tříd jednoduše zabalit metody definované pro objekty TableAdapter z prvního kurzu.</span><span class="sxs-lookup"><span data-stu-id="78cd2-127">Next, let's add methods to each of the classes to simply wrap the methods defined for the TableAdapters from the first tutorial.</span></span> <span data-ttu-id="78cd2-128">Teď tyto metody se právě volají přímo do vrstvy DAL; se vrátíme později a přidejte veškeré potřebné obchodní logiky.</span><span class="sxs-lookup"><span data-stu-id="78cd2-128">For now, these methods will just call directly into the DAL; we'll return later to add any needed business logic.</span></span>

> [!NOTE]
> <span data-ttu-id="78cd2-129">Pokud používáte Visual Studio Standard Edition nebo vyšší (to znamená, že *není* pomocí Visual Web Developer), Volitelně můžete navrhnout vizuálně pomocí tříd [návrhář tříd](https://msdn.microsoft.com/library/default.asp?url=/library/dv_vstechart/html/clssdsgnr.asp).</span><span class="sxs-lookup"><span data-stu-id="78cd2-129">If you are using Visual Studio Standard Edition or above (that is, you're *not* using Visual Web Developer), you can optionally design your classes visually using the [Class Designer](https://msdn.microsoft.com/library/default.asp?url=/library/dv_vstechart/html/clssdsgnr.asp).</span></span> <span data-ttu-id="78cd2-130">Odkazovat [blogu návrháře tříd](https://blogs.msdn.com/classdesigner/default.aspx) Další informace o této nové funkce v sadě Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="78cd2-130">Refer to the [Class Designer Blog](https://blogs.msdn.com/classdesigner/default.aspx) for more information on this new feature in Visual Studio.</span></span>


<span data-ttu-id="78cd2-131">Pro `ProductsBLL` třídy, je potřeba přidat celkem sedmi metod:</span><span class="sxs-lookup"><span data-stu-id="78cd2-131">For the `ProductsBLL` class we need to add a total of seven methods:</span></span>

- `GetProducts()` <span data-ttu-id="78cd2-132">Vrátí všechny produkty</span><span class="sxs-lookup"><span data-stu-id="78cd2-132">returns all products</span></span>
- `GetProductByProductID(productID)` <span data-ttu-id="78cd2-133">Vrátí hodnotu pomocí zadaného kódu product ID produktu</span><span class="sxs-lookup"><span data-stu-id="78cd2-133">returns the product with the specified product ID</span></span>
- `GetProductsByCategoryID(categoryID)` <span data-ttu-id="78cd2-134">Vrátí všechny produkty v určené kategorii</span><span class="sxs-lookup"><span data-stu-id="78cd2-134">returns all products from the specified category</span></span>
- `GetProductsBySupplier(supplierID)` <span data-ttu-id="78cd2-135">Vrátí všechny produkty od zadané dodavatele</span><span class="sxs-lookup"><span data-stu-id="78cd2-135">returns all products from the specified supplier</span></span>
- `AddProduct(productName, supplierID, categoryID, quantityPerUnit, unitPrice, unitsInStock, unitsOnOrder, reorderLevel, discontinued)` <span data-ttu-id="78cd2-136">Vložení nového produktu do databáze pomocí hodnot předaný; Vrátí `ProductID` hodnotu nově vloženou záznamu</span><span class="sxs-lookup"><span data-stu-id="78cd2-136">inserts a new product into the database using the values passed-in; returns the `ProductID` value of the newly inserted record</span></span>
- `UpdateProduct(productName, supplierID, categoryID, quantityPerUnit, unitPrice, unitsInStock, unitsOnOrder, reorderLevel, discontinued, productID)` <span data-ttu-id="78cd2-137">Aktualizuje existující produktu v databázi pomocí hodnoty předané; Vrátí `true` Pokud přesně jeden řádek byl aktualizován, `false` jinak</span><span class="sxs-lookup"><span data-stu-id="78cd2-137">updates an existing product in the database using the passed-in values; returns `true` if precisely one row was updated, `false` otherwise</span></span>
- `DeleteProduct(productID)` <span data-ttu-id="78cd2-138">Odstraní zadaný produkt z databáze</span><span class="sxs-lookup"><span data-stu-id="78cd2-138">deletes the specified product from the database</span></span>

<span data-ttu-id="78cd2-139">ProductsBLL.cs</span><span class="sxs-lookup"><span data-stu-id="78cd2-139">ProductsBLL.cs</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample1.cs)]

<span data-ttu-id="78cd2-140">Metody, které jednoduše vrátí data `GetProducts`, `GetProductByProductID`, `GetProductsByCategoryID`, a `GetProductBySuppliersID` jsou poměrně jednoduché, jak jednoduše volají do vrstvy DAL.</span><span class="sxs-lookup"><span data-stu-id="78cd2-140">The methods that simply return data `GetProducts`, `GetProductByProductID`, `GetProductsByCategoryID`, and `GetProductBySuppliersID` are fairly straightforward as they simply call down into the DAL.</span></span> <span data-ttu-id="78cd2-141">I když v některých scénářích může být obchodní pravidla, které je potřeba implementovat na této úrovni (jako jsou pravidla autorizace na základě aktuálně přihlášeného uživatele nebo role, do které patří uživateli), jednoduše Ponecháme tyto metody jako-je.</span><span class="sxs-lookup"><span data-stu-id="78cd2-141">While in some scenarios there may be business rules that need to be implemented at this level (such as authorization rules based on the currently logged on user or the role to which the user belongs), we'll simply leave these methods as-is.</span></span> <span data-ttu-id="78cd2-142">Pro tyto metody pak BLL slouží pouze jako proxy server, jehož prostřednictvím přistupuje prezentační vrstvy k podkladová data z vrstvy přístupu k datům.</span><span class="sxs-lookup"><span data-stu-id="78cd2-142">For these methods, then, the BLL serves merely as a proxy through which the presentation layer accesses the underlying data from the Data Access Layer.</span></span>

<span data-ttu-id="78cd2-143">`AddProduct` a `UpdateProduct` metody i jako parametry hodnoty pro pole různých produktů a přidat nový produkt aktualizace trvat i existující, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="78cd2-143">The `AddProduct` and `UpdateProduct` methods both take in as parameters the values for the various product fields and add a new product or update an existing one, respectively.</span></span> <span data-ttu-id="78cd2-144">Od mnoha `Product` sloupců tabulky může přijmout `NULL` hodnoty (`CategoryID`, `SupplierID`, a `UnitPrice`, další), tyto vstupní parametry pro `AddProduct` a `UpdateProduct` , která je namapována na takové použití sloupce [typy připouštějící hodnotu Null](https://msdn.microsoft.com/library/1t3y8s4s(v=vs.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="78cd2-144">Since many of the `Product` table's columns can accept `NULL` values (`CategoryID`, `SupplierID`, and `UnitPrice`, to name a few), those input parameters for `AddProduct` and `UpdateProduct` that map to such columns use [nullable types](https://msdn.microsoft.com/library/1t3y8s4s(v=vs.80).aspx).</span></span> <span data-ttu-id="78cd2-145">Typy s možnou hodnotou Null jsou nové pro rozhraní .NET 2.0 a poskytuje techniku pro označující, zda typ hodnoty by měly místo toho být `null`.</span><span class="sxs-lookup"><span data-stu-id="78cd2-145">Nullable types are new to .NET 2.0 and provide a technique for indicating whether a value type should, instead, be `null`.</span></span> <span data-ttu-id="78cd2-146">V jazyce C# můžete označit příznakem typu hodnoty jako typ s možnou hodnotou Null přidáním `?` po typu (například `int? x;`).</span><span class="sxs-lookup"><span data-stu-id="78cd2-146">In C# you can flag a value type as a nullable type by adding `?` after the type (like `int? x;`).</span></span> <span data-ttu-id="78cd2-147">Odkazovat [typy připouštějící hodnotu Null](https://msdn.microsoft.com/library/1t3y8s4s.aspx) tématu [Průvodce programováním v C#](https://msdn.microsoft.com/library/67ef8sbd%28VS.80%29.aspx) Další informace.</span><span class="sxs-lookup"><span data-stu-id="78cd2-147">Refer to the [Nullable Types](https://msdn.microsoft.com/library/1t3y8s4s.aspx) section in the [C# Programming Guide](https://msdn.microsoft.com/library/67ef8sbd%28VS.80%29.aspx) for more information.</span></span>

<span data-ttu-id="78cd2-148">Všechny tři metody vrátit hodnotu typu Boolean označující, zda byl řádek vložit, aktualizovat nebo odstranit, protože operace nemusí mít za následek ovlivněných řádků.</span><span class="sxs-lookup"><span data-stu-id="78cd2-148">All three methods return a Boolean value indicating whether a row was inserted, updated, or deleted since the operation may not result in an affected row.</span></span> <span data-ttu-id="78cd2-149">Například, pokud zavolá vývojář stránky `DeleteProduct` předávání v `ProductID` pro neexistující produkt, `DELETE` prohlášení vydané do databáze bude mít žádný vliv a proto `DeleteProduct` vrátí metoda `false`.</span><span class="sxs-lookup"><span data-stu-id="78cd2-149">For example, if the page developer calls `DeleteProduct` passing in a `ProductID` for a non-existent product, the `DELETE` statement issued to the database will have no affect and therefore the `DeleteProduct` method will return `false`.</span></span>

<span data-ttu-id="78cd2-150">Všimněte si, že při přidání nového produktu nebo aktualizuje existující pořídíme produktu nové nebo upravené hodnoty v polích jako seznam skaláry, na rozdíl od přijetí `ProductsRow` instance.</span><span class="sxs-lookup"><span data-stu-id="78cd2-150">Note that when adding a new product or updating an existing one we take in the new or modified product's field values as a list of scalars as opposed to accepting a `ProductsRow` instance.</span></span> <span data-ttu-id="78cd2-151">Tento přístup byla vybrána, protože `ProductsRow` třída odvozena z ADO.NET `DataRow` třídu, která nemá výchozí konstruktor bez parametrů.</span><span class="sxs-lookup"><span data-stu-id="78cd2-151">This approach was chosen because the `ProductsRow` class derives from the ADO.NET `DataRow` class, which doesn't have a default parameterless constructor.</span></span> <span data-ttu-id="78cd2-152">Chcete-li vytvořit nový `ProductsRow` instanci, musíte nejdřív vytvoříme `ProductsDataTable` instance a pak vyvolejte jeho `NewProductRow()` – metoda (které děláme `AddProduct`).</span><span class="sxs-lookup"><span data-stu-id="78cd2-152">In order to create a new `ProductsRow` instance, we must first create a `ProductsDataTable` instance and then invoke its `NewProductRow()` method (which we do in `AddProduct`).</span></span> <span data-ttu-id="78cd2-153">Tento nedostatek rears jeho head, když jsme na vkládání a aktualizacích produktů pomocí ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="78cd2-153">This shortcoming rears its head when we turn to inserting and updating products using the ObjectDataSource.</span></span> <span data-ttu-id="78cd2-154">Stručně řečeno ObjectDataSource se pokusí vytvořit instanci vstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="78cd2-154">In short, the ObjectDataSource will try to create an instance of the input parameters.</span></span> <span data-ttu-id="78cd2-155">Pokud se očekává, že metoda knihoven BLL `ProductsRow` instance, ObjectDataSource se pokusí vytvořit, ale nezdaří z důvodu nedostatku výchozí konstruktor bez parametrů.</span><span class="sxs-lookup"><span data-stu-id="78cd2-155">If the BLL method expects a `ProductsRow` instance, the ObjectDataSource will try to create one, but fail due to the lack of a default parameterless constructor.</span></span> <span data-ttu-id="78cd2-156">Další informace o tomto problému najdete v následujících dvou příspěvky ve fórech ASP.NET: [Aktualizuje se ObjectDataSources s silně typovaných datových sad](https://forums.asp.net/1098630/ShowPost.aspx), a [problém s ObjectDataSource a silně-typová](https://forums.asp.net/1048212/ShowPost.aspx).</span><span class="sxs-lookup"><span data-stu-id="78cd2-156">For more information on this problem, refer to the following two ASP.NET Forums posts: [Updating ObjectDataSources with Strongly-Typed DataSets](https://forums.asp.net/1098630/ShowPost.aspx), and [Problem With ObjectDataSource and Strongly-Typed DataSet](https://forums.asp.net/1048212/ShowPost.aspx).</span></span>

<span data-ttu-id="78cd2-157">Dále v obou `AddProduct` a `UpdateProduct`, vytvoří kód `ProductsRow` instance a naplní ji hodnotami právě předaný.</span><span class="sxs-lookup"><span data-stu-id="78cd2-157">Next, in both `AddProduct` and `UpdateProduct`, the code creates a `ProductsRow` instance and populates it with the values just passed in.</span></span> <span data-ttu-id="78cd2-158">Při přiřazování hodnot objektů DataColumns objektu DataRow situace může nastat různé kontroly ověření na úrovni pole.</span><span class="sxs-lookup"><span data-stu-id="78cd2-158">When assigning values to DataColumns of a DataRow various field-level validation checks can occur.</span></span> <span data-ttu-id="78cd2-159">Proto sestavení předaných hodnot ručně zpět do DataRow pomáhá zajistit platnost dat předávaných metodě BLL.</span><span class="sxs-lookup"><span data-stu-id="78cd2-159">Therefore, manually putting the passed in values back into a DataRow helps ensure the validity of the data being passed to the BLL method.</span></span> <span data-ttu-id="78cd2-160">Objekt DataRow třídy silného typu vygenerované sadou Visual Studio bohužel nepoužívejte typy připouštějící hodnotu Null.</span><span class="sxs-lookup"><span data-stu-id="78cd2-160">Unfortunately the strongly-typed DataRow classes generated by Visual Studio do not use nullable types.</span></span> <span data-ttu-id="78cd2-161">Místo toho k označení, že by měl odpovídat konkrétní objekt DataColumn v DataRow `NULL` databáze hodnotě musíme použít `SetColumnNameNull()` metody.</span><span class="sxs-lookup"><span data-stu-id="78cd2-161">Rather, to indicate that a particular DataColumn in a DataRow should correspond to a `NULL` database value we must use the `SetColumnNameNull()` method.</span></span>

<span data-ttu-id="78cd2-162">V `UpdateProduct` načteme nejprve v produktu k aktualizaci pomocí `GetProductByProductID(productID)`.</span><span class="sxs-lookup"><span data-stu-id="78cd2-162">In `UpdateProduct` we first load in the product to update using `GetProductByProductID(productID)`.</span></span> <span data-ttu-id="78cd2-163">Když to může zdát, jako je zbytečné cesty k databázi, bude prokázat smysl v budoucích kurzech, které se zabývají optimistického řízení souběžnosti tento další latence.</span><span class="sxs-lookup"><span data-stu-id="78cd2-163">While this may seem like an unnecessary trip to the database, this extra trip will prove worthwhile in future tutorials that explore optimistic concurrency.</span></span> <span data-ttu-id="78cd2-164">Optimistická souběžnost je technika, k zajištění, že dva uživatelé, kteří pracují současně na stejná data náhodnému přepsání nepřípustným změny.</span><span class="sxs-lookup"><span data-stu-id="78cd2-164">Optimistic concurrency is a technique to ensure that two users who are simultaneously working on the same data don't accidentally overwrite one another's changes.</span></span> <span data-ttu-id="78cd2-165">Zachytávat celý záznam také usnadňuje vytváření metod aktualizace BLL, změnit pouze podmnožinu sloupců objekt DataRow.</span><span class="sxs-lookup"><span data-stu-id="78cd2-165">Grabbing the entire record also makes it easier to create update methods in the BLL that only modify a subset of the DataRow's columns.</span></span> <span data-ttu-id="78cd2-166">Když se podíváme `SuppliersBLL` třídy uvidíme takových příkladů.</span><span class="sxs-lookup"><span data-stu-id="78cd2-166">When we explore the `SuppliersBLL` class we'll see such an example.</span></span>

<span data-ttu-id="78cd2-167">A konečně, Všimněte si, že `ProductsBLL` třída nemá [DataObject atribut](https://msdn.microsoft.com/library/system.componentmodel.dataobjectattribute.aspx) použit ( `[System.ComponentModel.DataObject]` syntaxe přímo před příkaz třídy v horní části souboru) a metody mají [ Atributy DataObjectMethodAttribute](https://msdn.microsoft.com/library/system.componentmodel.dataobjectmethodattribute.aspx).</span><span class="sxs-lookup"><span data-stu-id="78cd2-167">Finally, note that the `ProductsBLL` class has the [DataObject attribute](https://msdn.microsoft.com/library/system.componentmodel.dataobjectattribute.aspx) applied to it (the `[System.ComponentModel.DataObject]` syntax right before the class statement near the top of the file) and the methods have [DataObjectMethodAttribute attributes](https://msdn.microsoft.com/library/system.componentmodel.dataobjectmethodattribute.aspx).</span></span> <span data-ttu-id="78cd2-168">`DataObject` Atribut určí třídy jako vhodný pro vazbu k objektu [ovládacího prvku ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), že `DataObjectMethodAttribute` označuj účel metody.</span><span class="sxs-lookup"><span data-stu-id="78cd2-168">The `DataObject` attribute marks the class as being an object suitable for binding to an [ObjectDataSource control](https://msdn.microsoft.com/library/9a4kyhcx.aspx), whereas the `DataObjectMethodAttribute` indicates the purpose of the method.</span></span> <span data-ttu-id="78cd2-169">Jak uvidíme v budoucích kurzech, technologii ASP.NET 2.0 ObjectDataSource usnadňuje deklarativní přístup k datům ze třídy.</span><span class="sxs-lookup"><span data-stu-id="78cd2-169">As we'll see in future tutorials, ASP.NET 2.0's ObjectDataSource makes it easy to declaratively access data from a class.</span></span> <span data-ttu-id="78cd2-170">Chcete-li filtrovat seznam možných tříd pro vazbu v Průvodci ObjectDataSource, ve výchozím nastavení pouze tyto třídy, které jsou označeny jako `DataObjects` jsou uvedeny v rozevíracím seznamu průvodci.</span><span class="sxs-lookup"><span data-stu-id="78cd2-170">To help filter the list of possible classes to bind to in the ObjectDataSource's wizard, by default only those classes marked as `DataObjects` are shown in the wizard's drop-down list.</span></span> <span data-ttu-id="78cd2-171">`ProductsBLL` Třídy bude fungovat stejně, bez těchto atributů, ale jejich přidávání usnadňuje práci v prvku ObjectDataSource průvodce.</span><span class="sxs-lookup"><span data-stu-id="78cd2-171">The `ProductsBLL` class will work just as well without these attributes, but adding them makes it easier to work with in the ObjectDataSource's wizard.</span></span>

## <a name="adding-the-other-classes"></a><span data-ttu-id="78cd2-172">Přidávání tříd</span><span class="sxs-lookup"><span data-stu-id="78cd2-172">Adding the Other Classes</span></span>

<span data-ttu-id="78cd2-173">S `ProductsBLL` třídy kompletní, stále je potřeba přidat tříd pro práci s kategorií, Dodavatelé a zaměstnanci.</span><span class="sxs-lookup"><span data-stu-id="78cd2-173">With the `ProductsBLL` class complete, we still need to add the classes for working with categories, suppliers, and employees.</span></span> <span data-ttu-id="78cd2-174">Za chvíli vytvořit následující třídy a metody využitím konceptů, jako v předchozím příkladu:</span><span class="sxs-lookup"><span data-stu-id="78cd2-174">Take a moment to create the following classes and methods using the concepts from the example above:</span></span>

- **<span data-ttu-id="78cd2-175">CategoriesBLL.cs</span><span class="sxs-lookup"><span data-stu-id="78cd2-175">CategoriesBLL.cs</span></span>**

    - `GetCategories()`
    - `GetCategoryByCategoryID(categoryID)`
- **<span data-ttu-id="78cd2-176">SuppliersBLL.cs</span><span class="sxs-lookup"><span data-stu-id="78cd2-176">SuppliersBLL.cs</span></span>**

    - `GetSuppliers()`
    - `GetSupplierBySupplierID(supplierID)`
    - `GetSuppliersByCountry(country)`
    - `UpdateSupplierAddress(supplierID, address, city, country)`
- **<span data-ttu-id="78cd2-177">EmployeesBLL.cs</span><span class="sxs-lookup"><span data-stu-id="78cd2-177">EmployeesBLL.cs</span></span>**

    - `GetEmployees()`
    - `GetEmployeeByEmployeeID(employeeID)`
    - `GetEmployeesByManager(managerID)`

<span data-ttu-id="78cd2-178">Je jedna metoda za zmínku `SuppliersBLL` třídy `UpdateSupplierAddress` metody.</span><span class="sxs-lookup"><span data-stu-id="78cd2-178">The one method worth noting is the `SuppliersBLL` class's `UpdateSupplierAddress` method.</span></span> <span data-ttu-id="78cd2-179">Tato metoda poskytuje rozhraní pro aktualizaci jenom informace o adrese dodavatele.</span><span class="sxs-lookup"><span data-stu-id="78cd2-179">This method provides an interface for updating just the supplier's address information.</span></span> <span data-ttu-id="78cd2-180">Interně tato metoda načte v `SupplierDataRow` objekt pro zadaný `supplierID` (pomocí `GetSupplierBySupplierID`), nastaví vlastností souvisejících s adresou a pak zavolá do `SupplierDataTable`společnosti `Update` metoda.</span><span class="sxs-lookup"><span data-stu-id="78cd2-180">Internally, this method reads in the `SupplierDataRow` object for the specified `supplierID` (using `GetSupplierBySupplierID`), sets its address-related properties, and then calls down into the `SupplierDataTable`'s `Update` method.</span></span> <span data-ttu-id="78cd2-181">`UpdateSupplierAddress` Metoda takto:</span><span class="sxs-lookup"><span data-stu-id="78cd2-181">The `UpdateSupplierAddress` method follows:</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample2.cs)]

<span data-ttu-id="78cd2-182">Odkazovat na soubor ke stažení v tomto článku pro moje úplnou implementaci třídy BLL.</span><span class="sxs-lookup"><span data-stu-id="78cd2-182">Refer to this article's download for my complete implementation of the BLL classes.</span></span>

## <a name="step-2-accessing-the-typed-datasets-through-the-bll-classes"></a><span data-ttu-id="78cd2-183">Krok 2: Přístup k zadané datové sady pomocí tříd knihoven BLL</span><span class="sxs-lookup"><span data-stu-id="78cd2-183">Step 2: Accessing the Typed DataSets Through the BLL Classes</span></span>

<span data-ttu-id="78cd2-184">V tomto prvním kurzu jsme viděli příklady pracovat přímo s datovou sadou zadali prostřednictvím kódu programu, ale přidání z našich tříd BLL prezentační vrstvy by měl fungovat BLL místo toho.</span><span class="sxs-lookup"><span data-stu-id="78cd2-184">In the first tutorial we saw examples of working directly with the Typed DataSet programmatically, but with the addition of our BLL classes, the presentation tier should work against the BLL instead.</span></span> <span data-ttu-id="78cd2-185">V `AllProducts.aspx` příklad z první kurz `ProductsTableAdapter` byla použita k vytvoření vazby seznam produktů prvku GridView, jak je znázorněno v následujícím kódu:</span><span class="sxs-lookup"><span data-stu-id="78cd2-185">In the `AllProducts.aspx` example from the first tutorial, the `ProductsTableAdapter` was used to bind the list of products to a GridView, as shown in the following code:</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample3.cs)]

<span data-ttu-id="78cd2-186">Použít nové BLL třídy, všechny, které je potřeba změnit je, stačí nahradit prvním řádku kódu `ProductsTableAdapter` objektu `ProductBLL` objektu:</span><span class="sxs-lookup"><span data-stu-id="78cd2-186">To use the new BLL classes, all that needs to be changed is the first line of code simply replace the `ProductsTableAdapter` object with a `ProductBLL` object:</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample4.cs)]

<span data-ttu-id="78cd2-187">Třídy BLL lze přistupovat pomocí ObjectDataSource také deklarativně (jak můžete datové sady typu).</span><span class="sxs-lookup"><span data-stu-id="78cd2-187">The BLL classes can also be accessed declaratively (as can the Typed DataSet) by using the ObjectDataSource.</span></span> <span data-ttu-id="78cd2-188">Budeme mluvit o ObjectDataSource podrobněji v následujících kurzech.</span><span class="sxs-lookup"><span data-stu-id="78cd2-188">We'll be discussing the ObjectDataSource in greater detail in the following tutorials.</span></span>


[![T<span data-ttu-id="78cd2-189">má seznam produktů se zobrazí v GridView]</span><span class="sxs-lookup"><span data-stu-id="78cd2-189">he List of Products is Displayed in a GridView]</span></span>(creating-a-business-logic-layer-cs/_static/image4.png)](creating-a-business-logic-layer-cs/_static/image3.png)

<span data-ttu-id="78cd2-190">**Obrázek 3**: Zobrazí se seznam produktů v GridView ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-business-logic-layer-cs/_static/image5.png))</span><span class="sxs-lookup"><span data-stu-id="78cd2-190">**Figure 3**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-business-logic-layer-cs/_static/image5.png))</span></span>


## <a name="step-3-adding-field-level-validation-to-the-datarow-classes"></a><span data-ttu-id="78cd2-191">Krok 3: Přidání ověření na úrovni pole třídy objektu DataRow</span><span class="sxs-lookup"><span data-stu-id="78cd2-191">Step 3: Adding Field-Level Validation to the DataRow Classes</span></span>

<span data-ttu-id="78cd2-192">Ověření na úrovni pole jsou kontroly, které se vztahují na hodnoty vlastností objektů firmy při vkládání nebo aktualizaci.</span><span class="sxs-lookup"><span data-stu-id="78cd2-192">Field-level validation are checks that pertains to the property values of the business objects when inserting or updating.</span></span> <span data-ttu-id="78cd2-193">Některá pole pravidla pro produkty patří:</span><span class="sxs-lookup"><span data-stu-id="78cd2-193">Some field-level validation rules for products include:</span></span>

- <span data-ttu-id="78cd2-194">`ProductName` Pole musí být 40 znaků nebo méně</span><span class="sxs-lookup"><span data-stu-id="78cd2-194">The `ProductName` field must be 40 characters or less in length</span></span>
- <span data-ttu-id="78cd2-195">`QuantityPerUnit` Pole musí být 20 znaků nebo méně</span><span class="sxs-lookup"><span data-stu-id="78cd2-195">The `QuantityPerUnit` field must be 20 characters or less in length</span></span>
- <span data-ttu-id="78cd2-196">`ProductID`, `ProductName`, A `Discontinued` pole jsou povinná, ale všechny ostatní pole jsou volitelná</span><span class="sxs-lookup"><span data-stu-id="78cd2-196">The `ProductID`, `ProductName`, and `Discontinued` fields are required, but all other fields are optional</span></span>
- <span data-ttu-id="78cd2-197">`UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, A `ReorderLevel` pole musí být větší než nebo rovna hodnotě nula.</span><span class="sxs-lookup"><span data-stu-id="78cd2-197">The `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields must be greater than or equal to zero</span></span>

<span data-ttu-id="78cd2-198">Tato pravidla můžete a by měl být vyjádřen na úrovni databáze.</span><span class="sxs-lookup"><span data-stu-id="78cd2-198">These rules can and should be expressed at the database level.</span></span> <span data-ttu-id="78cd2-199">Znak limitu `ProductName` a `QuantityPerUnit` pole jsou zachyceny na základě těchto sloupců v datové typy `Products` tabulky (`nvarchar(40)` a `nvarchar(20)`v uvedeném pořadí).</span><span class="sxs-lookup"><span data-stu-id="78cd2-199">The character limit on the `ProductName` and `QuantityPerUnit` fields are captured by the data types of those columns in the `Products` table (`nvarchar(40)` and `nvarchar(20)`, respectively).</span></span> <span data-ttu-id="78cd2-200">Určuje, zda jsou povinné a nepovinné pole jsou vyjádřeny ve sloupci tabulky databáze umožňuje `NULL` s.</span><span class="sxs-lookup"><span data-stu-id="78cd2-200">Whether fields are required and optional are expressed by if the database table column allows `NULL` s.</span></span> <span data-ttu-id="78cd2-201">Čtyři [kontrola omezení](https://msdn.microsoft.com/library/ms188258.aspx) existuje, ujistěte se, že pouze hodnoty větší než nebo rovna hodnotě nula. můžete usnadnit do `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, nebo `ReorderLevel` sloupce.</span><span class="sxs-lookup"><span data-stu-id="78cd2-201">Four [check constraints](https://msdn.microsoft.com/library/ms188258.aspx) exist that ensure that only values greater than or equal to zero can make it into the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, or `ReorderLevel` columns.</span></span>

<span data-ttu-id="78cd2-202">Kromě vynucuje tato pravidla na databázi by také měly být vynucují na úrovni datové sady.</span><span class="sxs-lookup"><span data-stu-id="78cd2-202">In addition to enforcing these rules at the database they should also be enforced at the DataSet level.</span></span> <span data-ttu-id="78cd2-203">Délka pole a určuje, zda je hodnota požadované nebo volitelné jsou ve skutečnosti už zachycena pro každý objekt DataTable sadu objektů DataColumns.</span><span class="sxs-lookup"><span data-stu-id="78cd2-203">In fact, the field length and whether a value is required or optional are already captured for each DataTable's set of DataColumns.</span></span> <span data-ttu-id="78cd2-204">Zobrazíte existující ověření na úrovni pole automaticky k dispozici, přejděte na návrháři datových sad, vyberte pole z jednoho DataTables a přejděte do okna Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="78cd2-204">To see the existing field-level validation automatically provided, go to the DataSet Designer, select a field from one of the DataTables and then go to the Properties window.</span></span> <span data-ttu-id="78cd2-205">Jak ukazuje obrázek 4 `QuantityPerUnit` objekt DataColumn v `ProductsDataTable` má maximální délku 20 znaků a neumožňuje procházet spojené `NULL` hodnoty.</span><span class="sxs-lookup"><span data-stu-id="78cd2-205">As Figure 4 shows, the `QuantityPerUnit` DataColumn in the `ProductsDataTable` has a maximum length of 20 characters and does allow `NULL` values.</span></span> <span data-ttu-id="78cd2-206">Pokud jsme pokus o nastavení `ProductsDataRow`společnosti `QuantityPerUnit` vlastnost na hodnotu řetězce, který je delší než 20 znaků `ArgumentException` bude vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="78cd2-206">If we attempt to set the `ProductsDataRow`'s `QuantityPerUnit` property to a string value longer than 20 characters an `ArgumentException` will be thrown.</span></span>


[![T<span data-ttu-id="78cd2-207">má objekt DataColumn poskytuje základní ověření na úrovni pole]</span><span class="sxs-lookup"><span data-stu-id="78cd2-207">he DataColumn Provides Basic Field-Level Validation]</span></span>(creating-a-business-logic-layer-cs/_static/image7.png)](creating-a-business-logic-layer-cs/_static/image6.png)

<span data-ttu-id="78cd2-208">**Obrázek 4**: Objekt DataColumn poskytuje základní úrovni pole ověření ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-business-logic-layer-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="78cd2-208">**Figure 4**: The DataColumn Provides Basic Field-Level Validation ([Click to view full-size image](creating-a-business-logic-layer-cs/_static/image8.png))</span></span>


<span data-ttu-id="78cd2-209">Bohužel jsme nelze zadat rozsah kontroly, jako `UnitPrice` hodnota musí být větší než nebo rovna hodnotě nula, v okně Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="78cd2-209">Unfortunately, we can't specify bounds checks, such as the `UnitPrice` value must be greater than or equal to zero, through the Properties window.</span></span> <span data-ttu-id="78cd2-210">Aby bylo možné poskytovat tento typ pole potřebujeme vytvořit obslužnou rutinu události pro DataTable [columnchanging –](https://msdn.microsoft.com/library/system.data.datatable.columnchanging%28VS.80%29.aspx) událostí.</span><span class="sxs-lookup"><span data-stu-id="78cd2-210">In order to provide this type of field-level validation we need to create an event handler for the DataTable's [ColumnChanging](https://msdn.microsoft.com/library/system.data.datatable.columnchanging%28VS.80%29.aspx) event.</span></span> <span data-ttu-id="78cd2-211">Jak je uvedeno v [předchozím kurzu](creating-a-data-access-layer-cs.md), datové sady, datové tabulky a datového řádku objektů vytvořených typované datové sady je možné rozšířit pomocí částečných tříd.</span><span class="sxs-lookup"><span data-stu-id="78cd2-211">As mentioned in the [preceding tutorial](creating-a-data-access-layer-cs.md), the DataSet, DataTables, and DataRow objects created by the Typed DataSet can be extended through the use of partial classes.</span></span> <span data-ttu-id="78cd2-212">Tímto způsobem můžeme vytvářet `ColumnChanging` obslužné rutiny události pro `ProductsDataTable` třídy.</span><span class="sxs-lookup"><span data-stu-id="78cd2-212">Using this technique we can create a `ColumnChanging` event handler for the `ProductsDataTable` class.</span></span> <span data-ttu-id="78cd2-213">Začněte tím, že vytvoření třídy v `App_Code` složku s názvem `ProductsDataTable.ColumnChanging.cs`.</span><span class="sxs-lookup"><span data-stu-id="78cd2-213">Start by creating a class in the `App_Code` folder named `ProductsDataTable.ColumnChanging.cs`.</span></span>


[![A<span data-ttu-id="78cd2-214">Přidat novou třídu ke složce App_Code]</span><span class="sxs-lookup"><span data-stu-id="78cd2-214">dd a New Class to the App_Code Folder]</span></span>(creating-a-business-logic-layer-cs/_static/image10.png)](creating-a-business-logic-layer-cs/_static/image9.png)

<span data-ttu-id="78cd2-215">**Obrázek 5**: Přidejte novou třídu do `App_Code` složky ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-business-logic-layer-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="78cd2-215">**Figure 5**: Add a New Class to the `App_Code` Folder ([Click to view full-size image](creating-a-business-logic-layer-cs/_static/image11.png))</span></span>


<span data-ttu-id="78cd2-216">Dále vytvořte obslužnou rutinu události pro `ColumnChanging` událost, která zajistí, že `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, a `ReorderLevel` hodnoty ve sloupcích (není-li `NULL`) jsou větší než nebo rovna hodnotě nula.</span><span class="sxs-lookup"><span data-stu-id="78cd2-216">Next, create an event handler for the `ColumnChanging` event that ensures that the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` column values (if not `NULL`) are greater than or equal to zero.</span></span> <span data-ttu-id="78cd2-217">Pokud tyto sloupce je mimo rozsah, výjimku `ArgumentException`.</span><span class="sxs-lookup"><span data-stu-id="78cd2-217">If any such column is out of range, throw an `ArgumentException`.</span></span>

<span data-ttu-id="78cd2-218">ProductsDataTable.ColumnChanging.cs</span><span class="sxs-lookup"><span data-stu-id="78cd2-218">ProductsDataTable.ColumnChanging.cs</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample5.cs)]

## <a name="step-4-adding-custom-business-rules-to-the-blls-classes"></a><span data-ttu-id="78cd2-219">Krok 4: Přidání vlastních obchodních pravidel BLL třídy</span><span class="sxs-lookup"><span data-stu-id="78cd2-219">Step 4: Adding Custom Business Rules to the BLL's Classes</span></span>

<span data-ttu-id="78cd2-220">Kromě ověření na úrovni pole může být vysoké úrovně vlastní obchodní pravidla, které zahrnují různé entity nebo koncepty anyAttribute není na úrovni jednoho sloupce, jako například:</span><span class="sxs-lookup"><span data-stu-id="78cd2-220">In addition to field-level validation, there may be high-level custom business rules that involve different entities or concepts not expressible at the single column level, such as:</span></span>

- <span data-ttu-id="78cd2-221">Pokud se vyřazuje, produktu, jeho `UnitPrice` se nedá aktualizovat</span><span class="sxs-lookup"><span data-stu-id="78cd2-221">If a product is discontinued, its `UnitPrice` cannot be updated</span></span>
- <span data-ttu-id="78cd2-222">Zaměstnance zemi, kde bydlíte musí být stejný jako jejich správce zemi, kde bydlíte</span><span class="sxs-lookup"><span data-stu-id="78cd2-222">An employee's country of residence must be the same as their manager's country of residence</span></span>
- <span data-ttu-id="78cd2-223">Produkt nejde ukončit, pokud je jenom produkt poskytnutých dodavatelem</span><span class="sxs-lookup"><span data-stu-id="78cd2-223">A product cannot be discontinued if it is the only product provided by the supplier</span></span>

<span data-ttu-id="78cd2-224">Třídy BLL by měl obsahovat kontroly pro zajištění dodržování obchodních pravidel vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="78cd2-224">The BLL classes should contain checks to ensure adherence to the application's business rules.</span></span> <span data-ttu-id="78cd2-225">Tyto kontroly lze přidat přímo do metod, na které se vztahují.</span><span class="sxs-lookup"><span data-stu-id="78cd2-225">These checks can be added directly to the methods to which they apply.</span></span>

<span data-ttu-id="78cd2-226">Představte si, že naše obchodní pravidla určují, že produkt nelze označit ukončená Pokud byla pouze produkt z daného dodavatele.</span><span class="sxs-lookup"><span data-stu-id="78cd2-226">Imagine that our business rules dictate that a product could not be marked discontinued if it was the only product from a given supplier.</span></span> <span data-ttu-id="78cd2-227">To znamená pokud produkt *X* byl jenom produkt jsme zakoupili od dodavatele *Y*, jsme nelze označit *X* jako ukončena; Pokud je však dodavatele *Y*nám součástí tři produkty *A*, *B*, a *C*, jsme mohli označit všechny a všechny z nich bude ukončena.</span><span class="sxs-lookup"><span data-stu-id="78cd2-227">That is, if product *X* was the only product we purchased from supplier *Y*, we could not mark *X* as discontinued; if, however, supplier *Y* supplied us with three products, *A*, *B*, and *C*, then we could mark any and all of these as discontinued.</span></span> <span data-ttu-id="78cd2-228">Vždy nejsou zarovnány liché obchodní pravidlo, ale obchodní pravidla a zdravý!</span><span class="sxs-lookup"><span data-stu-id="78cd2-228">An odd business rule, but business rules and common sense aren't always aligned!</span></span>

<span data-ttu-id="78cd2-229">K vynucení toto obchodní pravidlo v `UpdateProducts` začít kontrolou, jestli metoda `Discontinued` byl nastaven na `true` a proto jsme by volání `GetProductsBySupplierID` určit počet produktů jsme zakoupili od dodavatele tohoto produktu.</span><span class="sxs-lookup"><span data-stu-id="78cd2-229">To enforce this business rule in the `UpdateProducts` method we'd start by checking if `Discontinued` was set to `true` and, if so, we'd call `GetProductsBySupplierID` to determine how many products we purchased from this product's supplier.</span></span> <span data-ttu-id="78cd2-230">Pokud pouze jeden produkt zakoupen od tohoto dodavatele, jsme throw `ApplicationException`.</span><span class="sxs-lookup"><span data-stu-id="78cd2-230">If only one product is purchased from this supplier, we throw an `ApplicationException`.</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample6.cs)]

## <a name="responding-to-validation-errors-in-the-presentation-tier"></a><span data-ttu-id="78cd2-231">Reakce na chyby ověření do prezentační vrstvy</span><span class="sxs-lookup"><span data-stu-id="78cd2-231">Responding to Validation Errors in the Presentation Tier</span></span>

<span data-ttu-id="78cd2-232">Při volání BLL od prezentační vrstvy můžeme rozhodnout, zda pokus o zpracovávat všechny výjimky, které může být vyvolána, nebo jim bublinový až technologie ASP.NET (což vyvolá `HttpApplication`společnosti `Error` událostí).</span><span class="sxs-lookup"><span data-stu-id="78cd2-232">When calling the BLL from the presentation tier we can decide whether to attempt to handle any exceptions that might be raised or let them bubble up to ASP.NET (which will raise the `HttpApplication`'s `Error` event).</span></span> <span data-ttu-id="78cd2-233">Ke zpracování výjimky při práci s BLL prostřednictvím kódu programu, můžeme použít [try... catch](https://msdn.microsoft.com/library/0yd65esw.aspx) bloku, jako v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="78cd2-233">To handle an exception when working with the BLL programmatically, we can use a [try...catch](https://msdn.microsoft.com/library/0yd65esw.aspx) block, as the following example shows:</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample7.cs)]

<span data-ttu-id="78cd2-234">Jak uvidíme v budoucích kurzech, zpracovávat výjimky, které se BLL při použití dat ovládací prvek webu pro vkládání, aktualizace nebo odstranění dat mohou být zpracovány přímo v obslužné rutině události na rozdíl od nutnosti pro zalomení kódu v `try...catch` bloky.</span><span class="sxs-lookup"><span data-stu-id="78cd2-234">As we'll see in future tutorials, handling exceptions that bubble up from the BLL when using a data Web control for inserting, updating, or deleting data can be handled directly in an event handler as opposed to having to wrap code in `try...catch` blocks.</span></span>

## <a name="summary"></a><span data-ttu-id="78cd2-235">Souhrn</span><span class="sxs-lookup"><span data-stu-id="78cd2-235">Summary</span></span>

<span data-ttu-id="78cd2-236">Aplikace s dobře navrženou obsahuje do různých vrstev, z nichž každý zapouzdřuje určité role.</span><span class="sxs-lookup"><span data-stu-id="78cd2-236">A well architected application is crafted into distinct layers, each of which encapsulates a particular role.</span></span> <span data-ttu-id="78cd2-237">Z prvního kurzu této série článku jsme vytvořili vrstvy přístupu k datům pomocí zadané datové sady; v tomto kurzu jsme vytvořili vrstvy obchodní logiky jako řadu objektů třídy v naší aplikaci `App_Code` složky, které volají naši vrstvy DAL.</span><span class="sxs-lookup"><span data-stu-id="78cd2-237">In the first tutorial of this article series we created a Data Access Layer using Typed DataSets; in this tutorial we built a Business Logic Layer as a series of classes in our application's `App_Code` folder that call down into our DAL.</span></span> <span data-ttu-id="78cd2-238">BLL implementuje pole úrovni nebo obchodní logiku pro naši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="78cd2-238">The BLL implements the field-level and business-level logic for our application.</span></span> <span data-ttu-id="78cd2-239">Kromě vytvoření samostatných BLL, jako jsme to udělali v tomto kurzu, Další možností je rozšíření metod objekty TableAdapter pomocí částečných tříd.</span><span class="sxs-lookup"><span data-stu-id="78cd2-239">In addition to creating a separate BLL, as we did in this tutorial, another option is to extend the TableAdapters' methods through the use of partial classes.</span></span> <span data-ttu-id="78cd2-240">Však tímto způsobem neumožňuje přepsat stávající metody ani nemá ho oddělíte naše DAL a našich knihoven BLL čistě přístup, který jsme měli v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="78cd2-240">However, using this technique does not allow us to override existing methods nor does it separate our DAL and our BLL as cleanly as the approach we've taken in this article.</span></span>

<span data-ttu-id="78cd2-241">DAL a BLL kompletní jsme připraveni na na našich prezentační vrstvy.</span><span class="sxs-lookup"><span data-stu-id="78cd2-241">With the DAL and BLL complete, we're ready to start on our presentation layer.</span></span> <span data-ttu-id="78cd2-242">V [další kurz](master-pages-and-site-navigation-cs.md) vytvoříme trvat stručný náhradního procesu z témat datového přístupu a definovat rozložení konzistentní stránky pro používání v rámci kurzů.</span><span class="sxs-lookup"><span data-stu-id="78cd2-242">In the [next tutorial](master-pages-and-site-navigation-cs.md) we'll take a brief detour from data access topics and define a consistent page layout for use throughout the tutorials.</span></span>

<span data-ttu-id="78cd2-243">Všechno nejlepší programování!</span><span class="sxs-lookup"><span data-stu-id="78cd2-243">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="78cd2-244">O autorovi</span><span class="sxs-lookup"><span data-stu-id="78cd2-244">About the Author</span></span>

<span data-ttu-id="78cd2-245">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a Zakladatel [4GuysFromRolla.com](http://www.4guysfromrolla.com), má práce s Microsoft webových technologiích od roku 1998.</span><span class="sxs-lookup"><span data-stu-id="78cd2-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="78cd2-246">Scott funguje jako nezávislý konzultant, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="78cd2-246">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="78cd2-247">Jeho nejnovější knihy [ *Edice nakladatelství Sams naučit sami ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="78cd2-247">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="78cd2-248">Může být dosáhl v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="78cd2-248">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="78cd2-249">nebo prostřednictvím jeho blogu, který lze nalézt v [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="78cd2-249">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="78cd2-250">Speciální k</span><span class="sxs-lookup"><span data-stu-id="78cd2-250">Special Thanks To</span></span>

<span data-ttu-id="78cd2-251">V této sérii kurzů byl recenzován uživatelem mnoho užitečných revidující.</span><span class="sxs-lookup"><span data-stu-id="78cd2-251">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="78cd2-252">Vedoucí revidující pro účely tohoto kurzu byly Liz Shulok, Dennis Patterson, Carlos Santos a Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="78cd2-252">Lead reviewers for this tutorial were Liz Shulok, Dennis Patterson, Carlos Santos, and Hilton Giesenow.</span></span> <span data-ttu-id="78cd2-253">Zajímat téma Moje nadcházejících článcích MSDN?</span><span class="sxs-lookup"><span data-stu-id="78cd2-253">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="78cd2-254">Pokud ano, vyřaďte mě řádek na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="78cd2-254">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="78cd2-255">[Předchozí](creating-a-data-access-layer-cs.md)
> [další](master-pages-and-site-navigation-cs.md)</span><span class="sxs-lookup"><span data-stu-id="78cd2-255">[Previous](creating-a-data-access-layer-cs.md)
[Next](master-pages-and-site-navigation-cs.md)</span></span>
