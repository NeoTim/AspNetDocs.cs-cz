---
uid: web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-vb
title: Zobrazení binárních dat ve webových ovládacích prvcích dat (VB) | Microsoft Docs
author: rick-anderson
description: V tomto kurzu se podíváme na možnosti, jak prezentovat binární data na webové stránce, včetně zobrazení souboru obrázku a zřízení odkazu ke stažení f...
ms.author: riande
ms.date: 03/27/2007
ms.assetid: 9201656a-e1c2-4020-824b-18fb632d2925
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-vb
msc.type: authoredcontent
ms.openlocfilehash: 27c901af092aa990f557750dc5d2c42ba2644c02
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/28/2019
ms.locfileid: "74640702"
---
# <a name="displaying-binary-data-in-the-data-web-controls-vb"></a><span data-ttu-id="1f78d-103">Zobrazení binárních dat ve webových ovládacích prvcích dat (VB)</span><span class="sxs-lookup"><span data-stu-id="1f78d-103">Displaying Binary Data in the Data Web Controls (VB)</span></span>

<span data-ttu-id="1f78d-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1f78d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1f78d-105">[Stáhnout ukázkovou aplikaci](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_VB.exe) nebo [Stáhnout PDF](displaying-binary-data-in-the-data-web-controls-vb/_static/datatutorial55vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1f78d-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_VB.exe) or [Download PDF](displaying-binary-data-in-the-data-web-controls-vb/_static/datatutorial55vb1.pdf)</span></span>

> <span data-ttu-id="1f78d-106">V tomto kurzu se podíváme na možnosti, jak prezentovat binární data na webové stránce, včetně zobrazení souboru obrázku a zřízení odkazu ke stažení pro soubor PDF.</span><span class="sxs-lookup"><span data-stu-id="1f78d-106">In this tutorial we look at the options to present binary data on a Web page, including the display of an image file and the provision of a 'Download' link for a PDF file.</span></span>

## <a name="introduction"></a><span data-ttu-id="1f78d-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="1f78d-107">Introduction</span></span>

<span data-ttu-id="1f78d-108">V předchozím kurzu jsme prozkoumali dva postupy pro přiřazení binárních dat k základnímu datovému modelu aplikace a pomocí ovládacího prvku pro nahrání souborů nahrajte soubory z prohlížeče do systému souborů webového serveru s.</span><span class="sxs-lookup"><span data-stu-id="1f78d-108">In the preceding tutorial we explored the two techniques for associating binary data with an application s underlying data model and used the FileUpload control to upload files from a browser to the web server s file system.</span></span> <span data-ttu-id="1f78d-109">Ještě jsme viděli, jak přidružit nahraná binární data k datovému modelu.</span><span class="sxs-lookup"><span data-stu-id="1f78d-109">We ve yet to see how to associate the uploaded binary data with the data model.</span></span> <span data-ttu-id="1f78d-110">To znamená, že po nahrání a uložení souboru do systému souborů musí být cesta k souboru uložena v příslušném záznamu databáze.</span><span class="sxs-lookup"><span data-stu-id="1f78d-110">That is, after a file has been uploaded and saved to the file system, a path to the file must be stored in the appropriate database record.</span></span> <span data-ttu-id="1f78d-111">Pokud jsou data ukládána přímo v databázi, pak nahraná binární data nemusí být uložena do systému souborů, ale musí být vložena do databáze.</span><span class="sxs-lookup"><span data-stu-id="1f78d-111">If the data is being stored directly in the database, then the uploaded binary data need not be saved to the file system, but must be injected into the database.</span></span>

<span data-ttu-id="1f78d-112">Předtím, než se podíváme na přiřazení dat k datovému modelu, si ale nejdřív podíváme, jak zadat binární data pro koncového uživatele.</span><span class="sxs-lookup"><span data-stu-id="1f78d-112">Before we look at associating the data with the data model, though, let s first look at how to provide the binary data to the end user.</span></span> <span data-ttu-id="1f78d-113">Prezentace textových dat je dostatečně jednoduchá, ale jak mají být prezentována binární data?</span><span class="sxs-lookup"><span data-stu-id="1f78d-113">Presenting text data is simple enough, but how should binary data be presented?</span></span> <span data-ttu-id="1f78d-114">Záleží samozřejmě na typu binárních dat.</span><span class="sxs-lookup"><span data-stu-id="1f78d-114">It depends, of course, on the type of binary data.</span></span> <span data-ttu-id="1f78d-115">V případě imagí nejspíš chceme zobrazit obrázek. v případě souborů PDF, dokumentů aplikace Microsoft Word, souborů ZIP a dalších typů binárních dat je pravděpodobně vhodnější poskytnout odkaz ke stažení.</span><span class="sxs-lookup"><span data-stu-id="1f78d-115">For images, we likely want to display the image; for PDFs, Microsoft Word documents, ZIP files, and other types of binary data, providing a Download link is probably more appropriate.</span></span>

<span data-ttu-id="1f78d-116">V tomto kurzu se podíváme na to, jak prezentovat binární data spolu s přidruženými textovými daty pomocí datových ovládacích prvků web, jako jsou GridView a DetailsView.</span><span class="sxs-lookup"><span data-stu-id="1f78d-116">In this tutorial we will look at how to present the binary data alongside its associated text data using data Web controls like the GridView and DetailsView.</span></span> <span data-ttu-id="1f78d-117">V dalším kurzu provedeme naši pozornost přidružení nahraného souboru k databázi.</span><span class="sxs-lookup"><span data-stu-id="1f78d-117">In the next tutorial we'll turn our attention to associating an uploaded file with the database.</span></span>

## <a name="step-1-providingbrochurepathvalues"></a><span data-ttu-id="1f78d-118">Krok 1: poskytování hodnot`BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="1f78d-118">Step 1: Providing`BrochurePath`Values</span></span>

<span data-ttu-id="1f78d-119">Sloupec `Picture` v tabulce `Categories` již obsahuje binární data pro různé image kategorií.</span><span class="sxs-lookup"><span data-stu-id="1f78d-119">The `Picture` column in the `Categories` table already contains binary data for the various category images.</span></span> <span data-ttu-id="1f78d-120">Konkrétně sloupec `Picture` pro každý záznam obsahuje binární obsah rastrového obrázku s nízkou kvalitou, 16 barev.</span><span class="sxs-lookup"><span data-stu-id="1f78d-120">Specifically, the `Picture` column for each record holds the binary contents of a grainy, low-quality, 16-color bitmap image.</span></span> <span data-ttu-id="1f78d-121">Každý obrázek kategorie má 172 pixelů na šířku a 120 pixelů na výšku a spotřebovává zhruba 11 KB.</span><span class="sxs-lookup"><span data-stu-id="1f78d-121">Each category image is 172 pixels wide and 120 pixels tall and consumes roughly 11 KB.</span></span> <span data-ttu-id="1f78d-122">Čím více, binární obsah ve sloupci `Picture` obsahuje hlavičku [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) 78 bajtů, která musí být před zobrazením obrázku odstraněna.</span><span class="sxs-lookup"><span data-stu-id="1f78d-122">What s more, the binary content in the `Picture` column includes a 78-byte [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) header that must be stripped before displaying the image.</span></span> <span data-ttu-id="1f78d-123">Tyto informace hlavičky jsou k dispozici, protože databáze Northwind má své kořeny v aplikaci Microsoft Access.</span><span class="sxs-lookup"><span data-stu-id="1f78d-123">This header information is present because the Northwind database has its roots in Microsoft Access.</span></span> <span data-ttu-id="1f78d-124">V aplikaci Access se binární data ukládají pomocí datového typu objektu OLE, který se v této hlavičce rozsměruje.</span><span class="sxs-lookup"><span data-stu-id="1f78d-124">In Access, binary data is stored using the OLE Object data type, which tacks on this header.</span></span> <span data-ttu-id="1f78d-125">Prozatím se dozvíte, jak oddělit hlavičky z těchto kvalitních imagí, aby se zobrazil obrázek.</span><span class="sxs-lookup"><span data-stu-id="1f78d-125">For now, we'll see how to strip the headers from these low-quality images in order to display the picture.</span></span> <span data-ttu-id="1f78d-126">V budoucím kurzu sestavíme rozhraní pro aktualizaci sloupce kategorie s `Picture` a nahradíte tyto bitmapové obrázky, které používají záhlaví OLE, s ekvivalentními obrázky JPG bez zbytečných hlaviček OLE.</span><span class="sxs-lookup"><span data-stu-id="1f78d-126">In a future tutorial we'll build an interface for updating a category s `Picture` column and replace these bitmap images that use OLE headers with equivalent JPG images without the unnecessary OLE headers.</span></span>

<span data-ttu-id="1f78d-127">V předchozím kurzu jsme viděli, jak používat ovládací prvek pro nahrání souborů.</span><span class="sxs-lookup"><span data-stu-id="1f78d-127">In the preceding tutorial we saw how to use the FileUpload control.</span></span> <span data-ttu-id="1f78d-128">Proto můžete pokračovat a přidat soubory brožur do systému souborů webového serveru s.</span><span class="sxs-lookup"><span data-stu-id="1f78d-128">Therefore, you can go ahead and add brochure files to the web server s file system.</span></span> <span data-ttu-id="1f78d-129">V takovém případě ale neaktualizuje sloupec `BrochurePath` v tabulce `Categories`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-129">Doing so, however, does not update the `BrochurePath` column in the `Categories` table.</span></span> <span data-ttu-id="1f78d-130">V dalším kurzu se dozvíte, jak toho dosáhnout, ale pro teď potřebujeme ručně zadat hodnoty pro tento sloupec.</span><span class="sxs-lookup"><span data-stu-id="1f78d-130">In the next tutorial we'll see how to accomplish this, but for now we need to manually provide values for this column.</span></span>

<span data-ttu-id="1f78d-131">V tomto kurzu pro stažení najdete sedm souborů brožury PDF ve složce `~/Brochures`, jednu pro každou z kategorií s výjimkou rybích plodů.</span><span class="sxs-lookup"><span data-stu-id="1f78d-131">In this tutorial s download you'll find seven PDF brochure files in the `~/Brochures` folder, one for each of the categories except Seafood.</span></span> <span data-ttu-id="1f78d-132">Záměrně jsem při přidávání brožury o mořském plodu, který ilustruje způsob zpracování scénářů, ve kterých nejsou ke všem záznamům přidružená binární data.</span><span class="sxs-lookup"><span data-stu-id="1f78d-132">I purposefully omitted adding a Seafood brochure to illustrate how to handle scenarios where not all records have associated binary data.</span></span> <span data-ttu-id="1f78d-133">Chcete-li aktualizovat `Categories`ovou tabulku pomocí těchto hodnot, klikněte pravým tlačítkem myši na uzel `Categories` z Průzkumník serveru a vyberte možnost zobrazit data tabulky.</span><span class="sxs-lookup"><span data-stu-id="1f78d-133">To update the `Categories` table with these values, right-click on the `Categories` node from Server Explorer and choose Show Table Data.</span></span> <span data-ttu-id="1f78d-134">Pak zadejte virtuální cesty k souborům brožur pro každou kategorii, která obsahuje leták, jak ukazuje obrázek 1.</span><span class="sxs-lookup"><span data-stu-id="1f78d-134">Then, enter the virtual paths to the brochure files for each category that has a brochure, as Figure 1 shows.</span></span> <span data-ttu-id="1f78d-135">Vzhledem k tomu, že pro kategorii rybího moře není k dispozici žádná brožura, ponechte hodnotu `BrochurePath` sloupce s jako `NULL`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-135">Since there is no brochure for the Seafood category, leave its `BrochurePath` column s value as `NULL`.</span></span>

<span data-ttu-id="1f78d-136">[![ručně zadat hodnoty pro sloupec Categories Table s BrochurePath](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-136">[![Manually Enter the Values for the Categories Table s BrochurePath Column](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.png)</span></span>

<span data-ttu-id="1f78d-137">**Obrázek 1**: ručně zadejte hodnoty pro sloupec `Categories` `BrochurePath` tabulky ([kliknutím zobrazíte obrázek v plné velikosti).](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-137">**Figure 1**: Manually Enter the Values for the `Categories` Table s `BrochurePath` Column ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.png))</span></span>

## <a name="step-2-providing-a-download-link-for-the-brochures-in-a-gridview"></a><span data-ttu-id="1f78d-138">Krok 2: poskytnutí odkazu ke stažení pro brožury v prvku GridView</span><span class="sxs-lookup"><span data-stu-id="1f78d-138">Step 2: Providing a Download Link for the Brochures in a GridView</span></span>

<span data-ttu-id="1f78d-139">S `BrochurePath` hodnotami zadanými pro tabulku `Categories` jsme znovu připraveni vytvořit prvek GridView, který obsahuje seznam jednotlivých kategorií spolu s odkazem na stažení kategorie s brožurou.</span><span class="sxs-lookup"><span data-stu-id="1f78d-139">With the `BrochurePath` values provided for the `Categories` table, we re ready to create a GridView that lists each category along with a link to download the category s brochure.</span></span> <span data-ttu-id="1f78d-140">V kroku 4 rozšíříme tento prvek GridView a zobrazí se také obrázek kategorie s.</span><span class="sxs-lookup"><span data-stu-id="1f78d-140">In Step 4 we'll extend this GridView to also display the category s image.</span></span>

<span data-ttu-id="1f78d-141">Začněte přetažením prvku GridView z panelu nástrojů do návrháře stránky `DisplayOrDownloadData.aspx` ve složce `BinaryData`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-141">Start by dragging a GridView from the Toolbox onto the Designer of the `DisplayOrDownloadData.aspx` page in the `BinaryData` folder.</span></span> <span data-ttu-id="1f78d-142">Nastavte `ID` prvku GridView s `Categories` a pomocí inteligentní značky GridView s vyberte, že se má vytvořit vazba k novému zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="1f78d-142">Set the GridView s `ID` to `Categories` and through the GridView s smart tag, choose to bind it to a new data source.</span></span> <span data-ttu-id="1f78d-143">Konkrétně ho navažte na prvek ObjectDataSource s názvem `CategoriesDataSource`, který načte data pomocí metody `CategoriesBLL` Object s `GetCategories()`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-143">Specifically, bind it to an ObjectDataSource named `CategoriesDataSource` that retrieves data using the `CategoriesBLL` object s `GetCategories()` method.</span></span>

<span data-ttu-id="1f78d-144">[![vytvořit nový prvek ObjectDataSource s názvem CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-144">[![Create a New ObjectDataSource Named CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.png)</span></span>

<span data-ttu-id="1f78d-145">**Obrázek 2**: vytvoření nového prvku ObjectDataSource s názvem `CategoriesDataSource` ([kliknutím zobrazíte obrázek v plné velikosti](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="1f78d-145">**Figure 2**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.png))</span></span>

<span data-ttu-id="1f78d-146">[![nakonfigurovat prvek ObjectDataSource tak, aby používal třídu CategoriesBLL](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-146">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.png)</span></span>

<span data-ttu-id="1f78d-147">**Obrázek 3**: Konfigurace prvku ObjectDataSource, aby používal třídu `CategoriesBLL` ([kliknutím zobrazíte obrázek v plné velikosti](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="1f78d-147">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.png))</span></span>

<span data-ttu-id="1f78d-148">[![načíst seznam kategorií pomocí metody GetCategories ()](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-148">[![Retrieve the List of Categories Using the GetCategories() Method](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.png)</span></span>

<span data-ttu-id="1f78d-149">**Obrázek 4**: načtení seznamu kategorií pomocí metody `GetCategories()` ([kliknutím zobrazíte obrázek v plné velikosti](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="1f78d-149">**Figure 4**: Retrieve the List of Categories Using the `GetCategories()` Method ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.png))</span></span>

<span data-ttu-id="1f78d-150">Po dokončení Průvodce konfigurací zdroje dat bude Visual Studio automaticky přidávat vlastnost BoundField do `Categories` GridView pro `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`a `BrochurePath` `DataColumn` s.</span><span class="sxs-lookup"><span data-stu-id="1f78d-150">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField to the `Categories` GridView for the `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, and `BrochurePath` `DataColumn` s.</span></span> <span data-ttu-id="1f78d-151">Pokračujte a odeberte `NumberOfProducts` vlastnost BoundField, protože dotaz `GetCategories()` metody s nenačítá tyto informace.</span><span class="sxs-lookup"><span data-stu-id="1f78d-151">Go ahead and remove the `NumberOfProducts` BoundField since the `GetCategories()` method s query does not retrieve this information.</span></span> <span data-ttu-id="1f78d-152">Odeberte taky `CategoryID` vlastnost BoundField a přejmenujte `CategoryName` a `BrochurePath` vlastnosti `HeaderText` na kategorie a brožury.</span><span class="sxs-lookup"><span data-stu-id="1f78d-152">Also remove the `CategoryID` BoundField and rename the `CategoryName` and `BrochurePath` BoundFields `HeaderText` properties to Category and Brochure, respectively.</span></span> <span data-ttu-id="1f78d-153">Po provedení těchto změn by deklarativní značky GridView a ObjectDataSource s měly vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="1f78d-153">After making these changes, your GridView and ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample1.aspx)]

<span data-ttu-id="1f78d-154">Zobrazit tuto stránku v prohlížeči (viz obrázek 5).</span><span class="sxs-lookup"><span data-stu-id="1f78d-154">View this page through a browser (see Figure 5).</span></span> <span data-ttu-id="1f78d-155">V seznamu se zobrazí každá z těchto osmi kategorií.</span><span class="sxs-lookup"><span data-stu-id="1f78d-155">Each of the eight categories is listed.</span></span> <span data-ttu-id="1f78d-156">Sedm kategorií s hodnotami `BrochurePath` má `BrochurePath` hodnotu zobrazenou v příslušném vlastnost BoundField.</span><span class="sxs-lookup"><span data-stu-id="1f78d-156">The seven categories with `BrochurePath` values have the `BrochurePath` value displayed in the respective BoundField.</span></span> <span data-ttu-id="1f78d-157">Ryby, u kterých je `NULL` hodnotou `BrochurePath`, se zobrazí prázdná buňka.</span><span class="sxs-lookup"><span data-stu-id="1f78d-157">Seafood, which has a `NULL` value for its `BrochurePath`, displays an empty cell.</span></span>

<span data-ttu-id="1f78d-158">[![je uvedena každá kategorie s názvem, popisem a hodnotou BrochurePath.](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-158">[![Each Category s Name, Description, and BrochurePath Value is Listed](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.png)</span></span>

<span data-ttu-id="1f78d-159">**Obrázek 5**: v seznamu jsou uvedeny všechny kategorie s názvem, popis a `BrochurePath` ([kliknutím zobrazíte obrázek v plné velikosti](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.png)).</span><span class="sxs-lookup"><span data-stu-id="1f78d-159">**Figure 5**: Each Category s Name, Description, and `BrochurePath` Value is Listed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.png))</span></span>

<span data-ttu-id="1f78d-160">Místo zobrazení textu `BrochurePath`ho sloupce chceme vytvořit odkaz na leták.</span><span class="sxs-lookup"><span data-stu-id="1f78d-160">Rather than displaying the text of the `BrochurePath` column, we want to create a link to the brochure.</span></span> <span data-ttu-id="1f78d-161">K tomu je potřeba odebrat `BrochurePath` vlastnost BoundField a nahradit ho HyperLinkField.</span><span class="sxs-lookup"><span data-stu-id="1f78d-161">To accomplish this, remove the `BrochurePath` BoundField and replace it with a HyperLinkField.</span></span> <span data-ttu-id="1f78d-162">Nastavte novou vlastnost HyperLinkField s `HeaderText` na hodnotu leták, její vlastnost `Text` na hodnotu zobrazit brožuru a její vlastnost `DataNavigateUrlFields` na `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-162">Set the new HyperLinkField s `HeaderText` property to Brochure, its `Text` property to View Brochure, and its `DataNavigateUrlFields` property to `BrochurePath`.</span></span>

![Přidat HyperLinkField pro BrochurePath](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.gif)

<span data-ttu-id="1f78d-164">**Obrázek 6**: Přidání HyperLinkField pro `BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="1f78d-164">**Figure 6**: Add a HyperLinkField for `BrochurePath`</span></span>

<span data-ttu-id="1f78d-165">Tím se přidá sloupec odkazů do prvku GridView, jak ukazuje obrázek 7.</span><span class="sxs-lookup"><span data-stu-id="1f78d-165">This will add a column of links to the GridView, as Figure 7 shows.</span></span> <span data-ttu-id="1f78d-166">Kliknutím na odkaz zobrazení brožury se PDF buď zobrazí přímo v prohlížeči, nebo vyzve uživatele ke stažení souboru v závislosti na tom, jestli je nainstalovaná čtečka PDF a nastavení prohlížeče s.</span><span class="sxs-lookup"><span data-stu-id="1f78d-166">Clicking a View Brochure link will either display the PDF directly in the browser or prompt the user to download the file, depending on whether a PDF reader is installed and the browser s settings.</span></span>

<span data-ttu-id="1f78d-167">[![můžete zobrazit brožuru kategorie s kliknutím na odkaz Zobrazit brožuru.](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-167">[![A Category s Brochure Can Be Viewed by Clicking the View Brochure Link](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.png)</span></span>

<span data-ttu-id="1f78d-168">**Obrázek 7**: Brožura kategorie s se dá zobrazit kliknutím na odkaz Zobrazit brožuru ([kliknutím zobrazíte obrázek v plné velikosti](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.png)).</span><span class="sxs-lookup"><span data-stu-id="1f78d-168">**Figure 7**: A Category s Brochure Can Be Viewed by Clicking the View Brochure Link ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.png))</span></span>

<span data-ttu-id="1f78d-169">[Zobrazuje se ![kategorie s brožurou PDF.](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-169">[![The Category s Brochure PDF is Displayed](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.png)</span></span>

<span data-ttu-id="1f78d-170">**Obrázek 8**: zobrazení kategorie s brožurou PDF ([kliknutím zobrazíte obrázek v plné velikosti](displaying-binary-data-in-the-data-web-controls-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="1f78d-170">**Figure 8**: The Category s Brochure PDF is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image14.png))</span></span>

## <a name="hiding-the-view-brochure-text-for-categories-without-a-brochure"></a><span data-ttu-id="1f78d-171">Skrytí textu v brožuře zobrazení pro kategorie bez brožury</span><span class="sxs-lookup"><span data-stu-id="1f78d-171">Hiding the View Brochure Text for Categories Without a Brochure</span></span>

<span data-ttu-id="1f78d-172">Jak ukazuje obrázek 7, `BrochurePath` HyperLinkField zobrazí hodnotu vlastnosti `Text` (zobrazení brožury) pro všechny záznamy bez ohledu na to, zda existuje hodnota, která není`NULL` pro `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-172">As Figure 7 shows, the `BrochurePath` HyperLinkField displays its `Text` property value ( View Brochure ) for all records, regardless of whether there s a non-`NULL` value for `BrochurePath`.</span></span> <span data-ttu-id="1f78d-173">Pokud je samozřejmě `BrochurePath` `NULL`, odkaz se zobrazí pouze jako text, jako je například případ s kategorií rybích plodů (odkaz zpět na obrázek 7).</span><span class="sxs-lookup"><span data-stu-id="1f78d-173">Of course, if `BrochurePath` is `NULL`, then the link is displayed as text only, as is the case with the Seafood category (refer back to Figure 7).</span></span> <span data-ttu-id="1f78d-174">Místo zobrazení textu v podobě brožury může být vhodné, aby tyto kategorie bez `BrochurePath` hodnoty zobrazovaly nějaký alternativní text, například není dostupná žádná brožura.</span><span class="sxs-lookup"><span data-stu-id="1f78d-174">Rather than displaying the text View Brochure, it might be nice to have those categories without a `BrochurePath` value display some alternate text, like No Brochure Available.</span></span>

<span data-ttu-id="1f78d-175">Aby bylo možné toto chování poskytnout, musíme použít TemplateField, jehož obsah je generován prostřednictvím volání metody stránky, která generuje příslušný výstup na základě `BrochurePath` hodnoty.</span><span class="sxs-lookup"><span data-stu-id="1f78d-175">In order to provide this behavior, we need to use a TemplateField whose content is generated via a call to a page method that emits the appropriate output based on the `BrochurePath` value.</span></span> <span data-ttu-id="1f78d-176">Nejdříve jsme tuto techniku formátování prozkoumali zpět v kurzu [použití templatefields v ovládacím prvku GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="1f78d-176">We first explored this formatting technique back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span></span>

<span data-ttu-id="1f78d-177">Přepněte HyperLinkField na TemplateField tím, že vyberete `BrochurePath` HyperLinkField a pak kliknete na tlačítko převést toto pole na odkaz TemplateField v dialogovém okně Upravit sloupce.</span><span class="sxs-lookup"><span data-stu-id="1f78d-177">Turn the HyperLinkField into a TemplateField by selecting the `BrochurePath` HyperLinkField and then clicking on the Convert this field into a TemplateField link in the Edit Columns dialog box.</span></span>

![Převést HyperLinkField na TemplateField](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.gif)

<span data-ttu-id="1f78d-179">**Obrázek 9**: převod HyperLinkField na TemplateField</span><span class="sxs-lookup"><span data-stu-id="1f78d-179">**Figure 9**: Convert the HyperLinkField into a TemplateField</span></span>

<span data-ttu-id="1f78d-180">Tím se vytvoří TemplateField s `ItemTemplate`, která obsahuje webový ovládací prvek hypertextového odkazu, jehož vlastnost `NavigateUrl` je svázána s hodnotou `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-180">This will create a TemplateField with an `ItemTemplate` that contains a HyperLink Web control whose `NavigateUrl` property is bound to the `BrochurePath` value.</span></span> <span data-ttu-id="1f78d-181">Nahraďte tento kód voláním metody `GenerateBrochureLink`a předejte hodnotu `BrochurePath`:</span><span class="sxs-lookup"><span data-stu-id="1f78d-181">Replace this markup with a call to the method `GenerateBrochureLink`, passing in the value of `BrochurePath`:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample2.aspx)]

<span data-ttu-id="1f78d-182">Dále vytvořte metodu `Protected` ve třídě ASP.NET stránky s kódem na pozadí s názvem `GenerateBrochureLink`, která vrací `String` a přijímá `Object` jako vstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="1f78d-182">Next, create a `Protected` method in the ASP.NET page s code-behind class named `GenerateBrochureLink` that returns a `String` and accepts an `Object` as an input parameter.</span></span>

[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample3.vb)]

<span data-ttu-id="1f78d-183">Tato metoda určuje, zda je hodnota předaného `Object` databáze `NULL` a pokud ano, vrátí zprávu oznamující, že v kategorii chybí brožura.</span><span class="sxs-lookup"><span data-stu-id="1f78d-183">This method determines if the passed-in `Object` value is a database `NULL` and, if so, returns a message indicating that the category lacks a brochure.</span></span> <span data-ttu-id="1f78d-184">V opačném případě, pokud je `BrochurePath` hodnota, zobrazí se v hypertextovém odkazu.</span><span class="sxs-lookup"><span data-stu-id="1f78d-184">Otherwise, if there is a `BrochurePath` value, it s displayed in a hyperlink.</span></span> <span data-ttu-id="1f78d-185">Všimněte si, že pokud je hodnota `BrochurePath` přítomna, je předána [metodě`ResolveUrl(url)`](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="1f78d-185">Note that if the `BrochurePath` value is present it s passed into the [`ResolveUrl(url)` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span></span> <span data-ttu-id="1f78d-186">Tato metoda vyřeší předanou *adresu URL*a nahradí `~` znak odpovídající virtuální cestou.</span><span class="sxs-lookup"><span data-stu-id="1f78d-186">This method resolves the passed-in *url*, replacing the `~` character with the appropriate virtual path.</span></span> <span data-ttu-id="1f78d-187">Například pokud je aplikace rootem na `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` vrátí `/Tutorial55/Brochures/Meat.pdf`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-187">For example, if the application is rooted at `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` will return `/Tutorial55/Brochures/Meat.pdf`.</span></span>

<span data-ttu-id="1f78d-188">Obrázek 10 ukazuje stránku po použití těchto změn.</span><span class="sxs-lookup"><span data-stu-id="1f78d-188">Figure 10 shows the page after these changes have been applied.</span></span> <span data-ttu-id="1f78d-189">Všimněte si, že pole `BrochurePath` kategorie v mořských plodech nyní zobrazuje text bez dostupné brožury.</span><span class="sxs-lookup"><span data-stu-id="1f78d-189">Note that the Seafood category s `BrochurePath` field now displays the text No Brochure Available .</span></span>

<span data-ttu-id="1f78d-190">[![text není k dispozici žádná brožura pro tyto kategorie bez brožury.](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-190">[![The Text No Brochure Available is Displayed for Those Categories Without a Brochure](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image15.png)</span></span>

<span data-ttu-id="1f78d-191">**Obrázek 10**: text žádná brožura není k dispozici pro tyto kategorie bez brožury ([kliknutím zobrazíte obrázek v plné velikosti).](displaying-binary-data-in-the-data-web-controls-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-191">**Figure 10**: The Text No Brochure Available is Displayed for Those Categories Without a Brochure ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image16.png))</span></span>

## <a name="step-3-adding-a-web-page-to-display-a-category-s-picture"></a><span data-ttu-id="1f78d-192">Krok 3: Přidání webové stránky pro zobrazení obrázku kategorie s</span><span class="sxs-lookup"><span data-stu-id="1f78d-192">Step 3: Adding a Web Page to Display a Category s Picture</span></span>

<span data-ttu-id="1f78d-193">Když uživatel navštíví stránku ASP.NET, obdrží stránku ASP.NET stránky s kódem HTML.</span><span class="sxs-lookup"><span data-stu-id="1f78d-193">When a user visits an ASP.NET page, they receive the ASP.NET page s HTML.</span></span> <span data-ttu-id="1f78d-194">Přijatý kód HTML je pouze text a neobsahuje žádná binární data.</span><span class="sxs-lookup"><span data-stu-id="1f78d-194">The received HTML is just text and does not contain any binary data.</span></span> <span data-ttu-id="1f78d-195">Všechna další binární data, jako jsou obrázky, zvukové soubory, aplikace Macromedia Flash, vložená Media Player videa Windows a tak dále, existují jako samostatné prostředky na webovém serveru.</span><span class="sxs-lookup"><span data-stu-id="1f78d-195">Any additional binary data, such as images, sound files, Macromedia Flash applications, embedded Windows Media Player videos, and so forth, exist as separate resources on the web server.</span></span> <span data-ttu-id="1f78d-196">KÓD HTML obsahuje odkazy na tyto soubory, ale nezahrnuje skutečný obsah souborů.</span><span class="sxs-lookup"><span data-stu-id="1f78d-196">The HTML contains references to these files, but does not include the actual contents of the files.</span></span>

<span data-ttu-id="1f78d-197">Například v jazyce HTML je `<img>` element použit pro odkazování na obrázek, s atributem `src` odkazujícím na soubor obrázku, například:</span><span class="sxs-lookup"><span data-stu-id="1f78d-197">For example, in HTML the `<img>` element is used to reference a picture, with the `src` attribute pointing to the image file like so:</span></span>

[!code-html[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample4.html)]

<span data-ttu-id="1f78d-198">Když prohlížeč tento kód HTML obdrží, provede další požadavek na webový server, který načte binární obsah souboru obrázku, který se pak zobrazí v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="1f78d-198">When a browser receives this HTML, it makes another request to the web server to retrieve the binary contents of the image file, which it then displays in the browser.</span></span> <span data-ttu-id="1f78d-199">Stejný koncept platí pro všechna binární data.</span><span class="sxs-lookup"><span data-stu-id="1f78d-199">The same concept applies to any binary data.</span></span> <span data-ttu-id="1f78d-200">V kroku 2 se brožura neodeslala do prohlížeče jako součást značky HTML stránky.</span><span class="sxs-lookup"><span data-stu-id="1f78d-200">In Step 2, the brochure was not sent down to the browser as part of the page s HTML markup.</span></span> <span data-ttu-id="1f78d-201">Namísto toho vykreslené hypertextové odkazy HTML, které po kliknutí vyvolaly, způsobila, že prohlížeč požaduje přímo dokument PDF.</span><span class="sxs-lookup"><span data-stu-id="1f78d-201">Rather, the rendered HTML provided hyperlinks that, when clicked, caused the browser to request the PDF document directly.</span></span>

<span data-ttu-id="1f78d-202">Chcete-li zobrazit nebo dovolit uživatelům stahovat binární data, která jsou uložena v databázi, musíme vytvořit samostatnou webovou stránku, která vrací data.</span><span class="sxs-lookup"><span data-stu-id="1f78d-202">To display or allow users to download binary data that resides within the database, we need to create a separate web page that returns the data.</span></span> <span data-ttu-id="1f78d-203">Pro naši aplikaci je k dispozici pouze jedno binární datové pole, které je přímo v databázi Uloženo v kategorii s obrázkem.</span><span class="sxs-lookup"><span data-stu-id="1f78d-203">For our application, there s only one binary data field stored directly in the database the category s picture.</span></span> <span data-ttu-id="1f78d-204">Proto potřebujeme stránku, která při volání vrátí data obrázku konkrétní kategorie.</span><span class="sxs-lookup"><span data-stu-id="1f78d-204">Therefore, we need a page that, when called, returns the image data for a particular category.</span></span>

<span data-ttu-id="1f78d-205">Přidejte novou stránku ASP.NET do složky `BinaryData` s názvem `DisplayCategoryPicture.aspx`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-205">Add a new ASP.NET page to the `BinaryData` folder named `DisplayCategoryPicture.aspx`.</span></span> <span data-ttu-id="1f78d-206">Když to uděláte, ponechejte políčko vybrat hlavní stránku nezaškrtnuté.</span><span class="sxs-lookup"><span data-stu-id="1f78d-206">When doing so, leave the Select master page checkbox unchecked.</span></span> <span data-ttu-id="1f78d-207">Tato stránka očekává `CategoryID` hodnotu v řetězci QueryString a vrátí binární data pro daný sloupec kategorie s `Picture`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-207">This page expects a `CategoryID` value in the querystring and returns the binary data of that category s `Picture` column.</span></span> <span data-ttu-id="1f78d-208">Vzhledem k tomu, že tato stránka vrací binární data a nic jiného, nepotřebuje žádný kód v oddílu HTML.</span><span class="sxs-lookup"><span data-stu-id="1f78d-208">Since this page returns binary data and nothing else, it does not need any markup in the HTML section.</span></span> <span data-ttu-id="1f78d-209">Proto klikněte v levém dolním rohu na kartu zdroj a odeberte všechny značky stránky s výjimkou direktivy `<%@ Page %>`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-209">Therefore, click on the Source tab in the lower left corner and remove all of the page s markup except for the `<%@ Page %>` directive.</span></span> <span data-ttu-id="1f78d-210">To znamená, že deklarativní označení `DisplayCategoryPicture.aspx` s by se měla skládat z jednoho řádku:</span><span class="sxs-lookup"><span data-stu-id="1f78d-210">That is, `DisplayCategoryPicture.aspx` s declarative markup should consist of a single line:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample5.aspx)]

<span data-ttu-id="1f78d-211">Pokud se v direktivě `<%@ Page %>` zobrazí atribut `MasterPageFile`, odeberte ho.</span><span class="sxs-lookup"><span data-stu-id="1f78d-211">If you see the `MasterPageFile` attribute in the `<%@ Page %>` directive, remove it.</span></span>

<span data-ttu-id="1f78d-212">Do třídy s kódem na pozadí přidejte následující kód do obslužné rutiny události `Page_Load`:</span><span class="sxs-lookup"><span data-stu-id="1f78d-212">In the page s code-behind class, add the following code to the `Page_Load` event handler:</span></span>

[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample6.vb)]

<span data-ttu-id="1f78d-213">Tento kód začíná čtením v `CategoryID` hodnota QueryString do proměnné s názvem `categoryID`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-213">This code starts by reading in the `CategoryID` querystring value into a variable named `categoryID`.</span></span> <span data-ttu-id="1f78d-214">V dalším kroku se data obrázku načítají prostřednictvím volání metody `CategoriesBLL` třídy s `GetCategoryWithBinaryDataByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-214">Next, the picture data is retrieved via a call to the `CategoriesBLL` class s `GetCategoryWithBinaryDataByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="1f78d-215">Tato data se vrátí klientovi pomocí metody `Response.BinaryWrite(data)`, ale před tím, než se zavolá, se musí odstranit záhlaví `Picture` sloupce s hodnotou OLE.</span><span class="sxs-lookup"><span data-stu-id="1f78d-215">This data is returned to the client by using the `Response.BinaryWrite(data)` method, but before this is called, the `Picture` column value s OLE header must be removed.</span></span> <span data-ttu-id="1f78d-216">K tomu je potřeba vytvořit pole `Byte` s názvem `strippedImageData`, která budou obsahovat přesně 78 znaků, než je ve sloupci `Picture`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-216">This is accomplished by creating a `Byte` array named `strippedImageData` that will hold precisely 78 characters less than what is in the `Picture` column.</span></span> <span data-ttu-id="1f78d-217">[Metoda`Array.Copy`](https://msdn.microsoft.com/library/z50k9bft.aspx) slouží ke zkopírování dat z `category.Picture` počínaje pozicí 78 až do `strippedImageData`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-217">The [`Array.Copy` method](https://msdn.microsoft.com/library/z50k9bft.aspx) is used to copy the data from `category.Picture` starting at position 78 over to `strippedImageData`.</span></span>

<span data-ttu-id="1f78d-218">Vlastnost `Response.ContentType` Určuje [typ MIME](http://en.wikipedia.org/wiki/MIME) vraceného obsahu, aby prohlížeč věděl, jak ho vykreslit.</span><span class="sxs-lookup"><span data-stu-id="1f78d-218">The `Response.ContentType` property specifies the [MIME type](http://en.wikipedia.org/wiki/MIME) of the content being returned so that the browser knows how to render it.</span></span> <span data-ttu-id="1f78d-219">Vzhledem k tomu, že sloupec `Categories` `Picture` tabulky je rastrový obrázek, tady se používá typ MIME rastrového obrázku (obrázek/bmp).</span><span class="sxs-lookup"><span data-stu-id="1f78d-219">Since the `Categories` table s `Picture` column is a bitmap image, the bitmap MIME type is used here (image/bmp).</span></span> <span data-ttu-id="1f78d-220">Vynecháte-li typ MIME, bude většina prohlížečů stále zobrazovat obrázek správně, protože může odvodit typ na základě obsahu binárních dat souboru obrázku.</span><span class="sxs-lookup"><span data-stu-id="1f78d-220">If you omit the MIME type, most browsers will still display the image correctly because they can infer the type based on the contents of the image file s binary data.</span></span> <span data-ttu-id="1f78d-221">Nicméně je obezřetné zahrnout typ MIME, pokud je to možné.</span><span class="sxs-lookup"><span data-stu-id="1f78d-221">However, it s prudent to include the MIME type when possible.</span></span> <span data-ttu-id="1f78d-222">Úplný seznam [typů médií MIME](http://www.iana.org/assignments/media-types/)najdete na [webu Internet Assigned Numbers Authority](http://www.iana.org/) .</span><span class="sxs-lookup"><span data-stu-id="1f78d-222">See the [Internet Assigned Numbers Authority s website](http://www.iana.org/) for a complete listing of [MIME media types](http://www.iana.org/assignments/media-types/).</span></span>

<span data-ttu-id="1f78d-223">Po vytvoření této stránky můžete zobrazit konkrétní obrázek kategorie s `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-223">With this page created, a particular category s picture can be viewed by visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="1f78d-224">Obrázek 11 znázorňuje obrázek kategorie nápoje, který se dá zobrazit z `DisplayCategoryPicture.aspx?CategoryID=1`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-224">Figure 11 shows the Beverages category s picture, which can be viewed from `DisplayCategoryPicture.aspx?CategoryID=1`.</span></span>

<span data-ttu-id="1f78d-225">[![se zobrazuje obrázek kategorie nápoje](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-225">[![The Beverages Category s Picture is Displayed](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image17.png)</span></span>

<span data-ttu-id="1f78d-226">**Obrázek 11**: zobrazuje se obrázek kategorie nápoje ([kliknutím zobrazíte obrázek v plné velikosti).](displaying-binary-data-in-the-data-web-controls-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-226">**Figure 11**: The Beverages Category s Picture is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image18.png))</span></span>

<span data-ttu-id="1f78d-227">Pokud při návštěvě `DisplayCategoryPicture.aspx?CategoryID=categoryID`dojde k výjimce, která čtení nedokáže přetypovat objekt typu System. DBNull na typ System. Byte [], existují dvě věci, které mohou být příčinou.</span><span class="sxs-lookup"><span data-stu-id="1f78d-227">If, when visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`, you get an exception that reads Unable to cast object of type 'System.DBNull' to type 'System.Byte[]', there are two things that may be causing this.</span></span> <span data-ttu-id="1f78d-228">Nejdříve `Picture` sloupec `Categories` tabulek s povoluje hodnoty `NULL`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-228">First, the `Categories` table s `Picture` column does allow `NULL` values.</span></span> <span data-ttu-id="1f78d-229">`DisplayCategoryPicture.aspx` stránka však předpokládá, že existuje hodnota, která není`NULL`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-229">The `DisplayCategoryPicture.aspx` page, however, assumes there is a non-`NULL` value present.</span></span> <span data-ttu-id="1f78d-230">Vlastnost `Picture` `CategoriesDataTable` nelze použít přímo, pokud má hodnotu `NULL`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-230">The `Picture` property of the `CategoriesDataTable` cannot be directly accessed if it has a `NULL` value.</span></span> <span data-ttu-id="1f78d-231">Pokud chcete povolit `NULL` hodnoty pro sloupec `Picture`, přejete si, že chcete zahrnout následující podmínku:</span><span class="sxs-lookup"><span data-stu-id="1f78d-231">If you do want to allow `NULL` values for the `Picture` column, you d want to include the following condition:</span></span>

[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample7.vb)]

<span data-ttu-id="1f78d-232">Výše uvedený kód předpokládá, že existuje nějaký soubor obrázku s názvem `NoPictureAvailable.gif` ve složce `Images`, kterou chcete zobrazit pro tyto kategorie bez obrázku.</span><span class="sxs-lookup"><span data-stu-id="1f78d-232">The above code assumes that there s some image file named `NoPictureAvailable.gif` in the `Images` folder that you want to display for those categories without a picture.</span></span>

<span data-ttu-id="1f78d-233">Tato výjimka by mohla být také způsobena tím, že se příkaz `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` metodě s `SELECT` vrátí zpět na hlavní seznam sloupců dotazů, ke kterému může dojít, pokud používáte příkazy SQL ad hoc a vy znovu spustíte Průvodce pro hlavní dotaz TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="1f78d-233">This exception could also be caused if the `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement has reverted back to the main query s column list, which can happen if you are using ad-hoc SQL statements and you ve re-run the wizard for the TableAdapter s main query.</span></span> <span data-ttu-id="1f78d-234">Zkontrolujte, zda `GetCategoryWithBinaryDataByCategoryID` metoda s `SELECT` příkaz stále obsahuje sloupec `Picture`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-234">Check to ensure that `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement still includes the `Picture` column.</span></span>

> [!NOTE]
> <span data-ttu-id="1f78d-235">Pokaždé, když se `DisplayCategoryPicture.aspx` navštíví, k databázi se dostanete a vrátí se zadané údaje o obrázcích pro kategorie s.</span><span class="sxs-lookup"><span data-stu-id="1f78d-235">Every time the `DisplayCategoryPicture.aspx` is visited, the database is accessed and the specified category s picture data is returned.</span></span> <span data-ttu-id="1f78d-236">Pokud se obrázek kategorie s nezměnil, protože ho uživatel naposledy zobrazil, je to však nevyužité úsilí.</span><span class="sxs-lookup"><span data-stu-id="1f78d-236">If the category s picture hasn't changed since the user has last viewed it, though, this is wasted effort.</span></span> <span data-ttu-id="1f78d-237">Naštěstí protokol HTTP umožňuje *podmíněné načtení*.</span><span class="sxs-lookup"><span data-stu-id="1f78d-237">Fortunately, HTTP allows for *conditional GETs*.</span></span> <span data-ttu-id="1f78d-238">Klient, který vydává požadavek HTTP, odesílá společně [`If-Modified-Since` HLAVIČCE http](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) , která poskytuje datum a čas posledního načtení tohoto prostředku z webového serveru od klienta.</span><span class="sxs-lookup"><span data-stu-id="1f78d-238">With a conditional GET, the client making the HTTP request sends along an [`If-Modified-Since` HTTP header](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) that provides the date and time the client last retrieved this resource from the web server.</span></span> <span data-ttu-id="1f78d-239">Pokud se obsah od tohoto zadaného data nezměnil, může webový server reagovat s [nezměněným stavovým kódem (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) a neposílá zpět požadovaný obsah prostředku.</span><span class="sxs-lookup"><span data-stu-id="1f78d-239">If the content has not changed since this specified date, the web server may respond with a [Not Modified status code (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) and forgo sending back the requested resource s content.</span></span> <span data-ttu-id="1f78d-240">V krátké době tato technika zbavuje webový server, že potřebuje odeslat obsah pro prostředek, pokud se nezměnil od chvíle, kdy se klient naposledy připojil.</span><span class="sxs-lookup"><span data-stu-id="1f78d-240">In short, this technique relieves the web server from having to send back content for a resource if it has not been modified since the client last accessed it.</span></span>

<span data-ttu-id="1f78d-241">K implementaci tohoto chování ale vyžaduje přidání `PictureLastModified`ho sloupce do tabulky `Categories` k zachycení při poslední aktualizaci sloupce `Picture` a také kódu pro kontrolu `If-Modified-Since` hlavičky.</span><span class="sxs-lookup"><span data-stu-id="1f78d-241">To implement this behavior, however, requires that you add a `PictureLastModified` column to the `Categories` table to capture when the `Picture` column was last updated as well as code to check for the `If-Modified-Since` header.</span></span> <span data-ttu-id="1f78d-242">Další informace o hlavičkách `If-Modified-Since` a pracovním postupu podmíněného načtení najdete v tématu [http podmíněný přístup pro hackery RSS](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) a [hlubší pohled na provádění požadavků HTTP na stránce ASP.NET](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="1f78d-242">For more information on the `If-Modified-Since` header and the conditional GET workflow, see [HTTP Conditional GET for RSS Hackers](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) and [A Deeper Look at Performing HTTP Requests in an ASP.NET Page](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span></span>

## <a name="step-4-displaying-the-category-pictures-in-a-gridview"></a><span data-ttu-id="1f78d-243">Krok 4: zobrazení obrázků kategorií v prvku GridView</span><span class="sxs-lookup"><span data-stu-id="1f78d-243">Step 4: Displaying the Category Pictures in a GridView</span></span>

<span data-ttu-id="1f78d-244">Teď, když máme webovou stránku pro zobrazení konkrétní kategorie s obrázkem, můžeme ji zobrazit pomocí [webového ovládacího prvku obrázek](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) nebo `<img>` HTML elementu, který odkazuje na `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-244">Now that we have a web page to display a particular category s picture, we can display it using the [Image Web control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) or an HTML `<img>` element pointing to `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="1f78d-245">Obrázky, jejichž adresa URL je určena daty databáze, mohou být zobrazeny v prvku GridView nebo DetailsView pomocí ImageField.</span><span class="sxs-lookup"><span data-stu-id="1f78d-245">Images whose URL is determined by database data can be displayed in the GridView or DetailsView using the ImageField.</span></span> <span data-ttu-id="1f78d-246">ImageField obsahuje vlastnosti `DataImageUrlField` a `DataImageUrlFormatString`, které fungují jako `DataNavigateUrlFields` HyperLinkField s a vlastnosti `DataNavigateUrlFormatString`.</span><span class="sxs-lookup"><span data-stu-id="1f78d-246">The ImageField contains `DataImageUrlField` and `DataImageUrlFormatString` properties that work like the HyperLinkField s `DataNavigateUrlFields` and `DataNavigateUrlFormatString` properties.</span></span>

<span data-ttu-id="1f78d-247">Nechejte rozšířit `Categories` GridView v `DisplayOrDownloadData.aspx` přidáním ImageField, aby se zobrazily jednotlivé obrázky kategorií.</span><span class="sxs-lookup"><span data-stu-id="1f78d-247">Let s augment the `Categories` GridView in `DisplayOrDownloadData.aspx` by adding an ImageField to show each category s picture.</span></span> <span data-ttu-id="1f78d-248">Jednoduše přidejte ImageField a nastavte jeho `DataImageUrlField` a vlastnosti `DataImageUrlFormatString` na `CategoryID` a `DisplayCategoryPicture.aspx?CategoryID={0}`v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="1f78d-248">Simply add the ImageField and set its `DataImageUrlField` and `DataImageUrlFormatString` properties to `CategoryID` and `DisplayCategoryPicture.aspx?CategoryID={0}`, respectively.</span></span> <span data-ttu-id="1f78d-249">Tím se vytvoří sloupec GridView, který vykreslí `<img>` element, jehož `src` odkazuje na atribut `DisplayCategoryPicture.aspx?CategoryID={0}`, kde {0} je nahrazeno hodnotou `CategoryID` řádku GridView.</span><span class="sxs-lookup"><span data-stu-id="1f78d-249">This will create a GridView column that renders an `<img>` element whose `src` attribute references `DisplayCategoryPicture.aspx?CategoryID={0}`, where {0} is replaced with the GridView row s `CategoryID` value.</span></span>

![Přidat ImageField do prvku GridView.](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.gif)

<span data-ttu-id="1f78d-251">**Obrázek 12**: Přidání prvku ImageField do prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="1f78d-251">**Figure 12**: Add an ImageField to the GridView</span></span>

<span data-ttu-id="1f78d-252">Po přidání ImageField by vaše deklarativní syntaxe GridViewu měla vypadat jako soothe po:</span><span class="sxs-lookup"><span data-stu-id="1f78d-252">After adding the ImageField, your GridView s declarative syntax should look like soothe following:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample8.aspx)]

<span data-ttu-id="1f78d-253">Chvíli počkejte, než tuto stránku zobrazíte v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="1f78d-253">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="1f78d-254">Všimněte si, jak každý záznam nyní obsahuje obrázek pro kategorii.</span><span class="sxs-lookup"><span data-stu-id="1f78d-254">Note how each record now includes a picture for the category.</span></span>

<span data-ttu-id="1f78d-255">[![je pro každý řádek zobrazený obrázek kategorie s](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="1f78d-255">[![The Category s Picture is Displayed for Each Row](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image19.png)</span></span>

<span data-ttu-id="1f78d-256">**Obrázek 13**: kategorie s – obrázek se zobrazí pro každý řádek ([kliknutím zobrazíte obrázek v plné velikosti](displaying-binary-data-in-the-data-web-controls-vb/_static/image20.png)).</span><span class="sxs-lookup"><span data-stu-id="1f78d-256">**Figure 13**: The Category s Picture is Displayed for Each Row ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image20.png))</span></span>

## <a name="summary"></a><span data-ttu-id="1f78d-257">Přehled</span><span class="sxs-lookup"><span data-stu-id="1f78d-257">Summary</span></span>

<span data-ttu-id="1f78d-258">V tomto kurzu jsme prozkoumali, jak prezentovat binární data.</span><span class="sxs-lookup"><span data-stu-id="1f78d-258">In this tutorial we examined how to present binary data.</span></span> <span data-ttu-id="1f78d-259">Způsob, jakým jsou data uvedena, závisí na typu dat.</span><span class="sxs-lookup"><span data-stu-id="1f78d-259">How the data is presented depends on the type of data.</span></span> <span data-ttu-id="1f78d-260">Pro soubory brožur PDF jsme uživatelům nabídli odkaz na zobrazení brožury, který po kliknutí přivedl uživatele přímo k souboru PDF.</span><span class="sxs-lookup"><span data-stu-id="1f78d-260">For the PDF brochure files, we offered the user a View Brochure link that, when clicked, took the user directly to the PDF file.</span></span> <span data-ttu-id="1f78d-261">V případě obrázku kategorie s jsme nejprve vytvořili stránku, která načte a vrátí binární data z databáze a pak tuto stránku použila k zobrazení všech kategorií s v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="1f78d-261">For the category s picture, we first created a page to retrieve and return the binary data from the database and then used that page to display each category s picture in a GridView.</span></span>

<span data-ttu-id="1f78d-262">Teď, když jsme si vyhledali, jak zobrazit binární data, jsme přezkoumali, jak provést vkládání, aktualizace a odstraňování dat v databázi s binárními daty.</span><span class="sxs-lookup"><span data-stu-id="1f78d-262">Now that we ve looked at how to display binary data, we re ready to examine how to perform insert, updates, and deletes against the database with the binary data.</span></span> <span data-ttu-id="1f78d-263">V dalším kurzu se podíváme na to, jak přidružit nahraný soubor k odpovídajícímu záznamu databáze.</span><span class="sxs-lookup"><span data-stu-id="1f78d-263">In the next tutorial we'll look at how to associate an uploaded file with its corresponding database record.</span></span> <span data-ttu-id="1f78d-264">V tomto kurzu se dozvíte, jak aktualizovat existující binární data a jak odstranit binární data při odebrání přidruženého záznamu.</span><span class="sxs-lookup"><span data-stu-id="1f78d-264">In the tutorial after that, we'll see how to update existing binary data as well as how to delete the binary data when its associated record is removed.</span></span>

<span data-ttu-id="1f78d-265">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="1f78d-265">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="1f78d-266">O autorovi</span><span class="sxs-lookup"><span data-stu-id="1f78d-266">About the Author</span></span>

<span data-ttu-id="1f78d-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor 7 ASP/ASP. NET Books a zakladatel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="1f78d-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1f78d-268">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="1f78d-268">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1f78d-269">Nejnovější kniha je [*Sams naučit se ASP.NET 2,0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="1f78d-269">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1f78d-270">Dá se získat na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1f78d-270">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1f78d-271">nebo prostřednictvím svého blogu, který najdete na adrese [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="1f78d-271">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="1f78d-272">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="1f78d-272">Special Thanks To</span></span>

<span data-ttu-id="1f78d-273">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="1f78d-273">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="1f78d-274">Kontroloři vedoucích k tomuto kurzu byli Teresa Murphy a Dave Gardner.</span><span class="sxs-lookup"><span data-stu-id="1f78d-274">Lead reviewers for this tutorial were Teresa Murphy and Dave Gardner.</span></span> <span data-ttu-id="1f78d-275">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="1f78d-275">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="1f78d-276">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1f78d-276">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1f78d-277">[Předchozí](uploading-files-vb.md)
> [Další](including-a-file-upload-option-when-adding-a-new-record-vb.md)</span><span class="sxs-lookup"><span data-stu-id="1f78d-277">[Previous](uploading-files-vb.md)
[Next](including-a-file-upload-option-when-adding-a-new-record-vb.md)</span></span>
