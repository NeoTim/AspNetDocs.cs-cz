---
uid: web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
title: Nahrávání souborů (VB) | Microsoft Docs
author: rick-anderson
description: Naučte se, jak uživatelům dovolit ukládat binární soubory (například dokumenty Word nebo PDF) na web, kde se můžou ukládat do systému souborů serveru...
ms.author: riande
ms.date: 03/27/2007
ms.assetid: f7c00fbd-652c-433d-8ed3-0e5168a4d4df
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
msc.type: authoredcontent
ms.openlocfilehash: 6e0d57ef2f1e8132f19777a7d14e94611c68adcd
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/28/2019
ms.locfileid: "74615303"
---
# <a name="uploading-files-vb"></a><span data-ttu-id="8c9d9-103">Nahrávání souborů (VB)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-103">Uploading Files (VB)</span></span>

<span data-ttu-id="8c9d9-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8c9d9-105">[Stáhnout ukázkovou aplikaci](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) nebo [Stáhnout PDF](uploading-files-vb/_static/datatutorial54vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) or [Download PDF](uploading-files-vb/_static/datatutorial54vb1.pdf)</span></span>

> <span data-ttu-id="8c9d9-106">Naučte se, jak uživatelům dovolit ukládat binární soubory (například dokumenty Word nebo PDF) na web, kde se můžou ukládat buď do systému souborů serveru, nebo do databáze.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-106">Learn how to allow users to upload binary files (such as Word or PDF documents) to your Web site where they may be stored in either the server's file system or the database.</span></span>

## <a name="introduction"></a><span data-ttu-id="8c9d9-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="8c9d9-107">Introduction</span></span>

<span data-ttu-id="8c9d9-108">Všechny kurzy, které jsme doposud zkoumali, pracovaly výhradně s textovými daty.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-108">All of the tutorials we ve examined so far have worked exclusively with text data.</span></span> <span data-ttu-id="8c9d9-109">Mnoho aplikací však má datové modely, které zachycují textová i binární data.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-109">However, many applications have data models that capture both text and binary data.</span></span> <span data-ttu-id="8c9d9-110">Online Web dating může uživatelům dovolit nahrát obrázek, který se má přidružit k profilu.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-110">An online dating site might allow users to upload a picture to associate with their profile.</span></span> <span data-ttu-id="8c9d9-111">Náborový web může umožnit uživatelům odeslat svůj životopis jako dokument Microsoft Word nebo PDF.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-111">A recruiting website might let users upload their resume as a Microsoft Word or PDF document.</span></span>

<span data-ttu-id="8c9d9-112">Práce s binárními daty přidává novou sadu výzev.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-112">Working with binary data adds a new set of challenges.</span></span> <span data-ttu-id="8c9d9-113">Je nutné rozhodnout, jak jsou binární data uložena v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-113">We must decide how the binary data is stored in the application.</span></span> <span data-ttu-id="8c9d9-114">Rozhraní, které se používá pro vkládání nových záznamů, je třeba aktualizovat, aby mohl uživatel odeslat soubor ze svého počítače. je nutné provést další kroky pro zobrazení nebo poskytnutí prostředků pro stažení přidružených binárních dat záznamu.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-114">The interface used for inserting new records has to be updated to allow the user to upload a file from their computer and extra steps must be taken to display or provide a means for downloading a record s associated binary data.</span></span> <span data-ttu-id="8c9d9-115">V tomto kurzu a dalších třech prozkoumáme, jak tyto výzvy nakládat.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-115">In this tutorial and the next three we'll explore how to hurdle these challenges.</span></span> <span data-ttu-id="8c9d9-116">Na konci těchto kurzů sestavíme plně funkční aplikaci, která přidruží obrázek a brožuru PDF k jednotlivým kategoriím.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-116">At the end of these tutorials we'll have built a fully functional application that associates a picture and PDF brochure with each category.</span></span> <span data-ttu-id="8c9d9-117">V tomto konkrétním kurzu se podíváme na různé techniky ukládání binárních dat a prozkoumejte, jak uživatelům umožnit nahrání souboru ze svého počítače a jeho uložení v systému souborů webového serveru s.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-117">In this particular tutorial we'll look at different techniques for storing binary data and explore how to enable users to upload a file from their computer and have it saved on the web server s file system.</span></span>

> [!NOTE]
> <span data-ttu-id="8c9d9-118">Binární data, která jsou součástí datového modelu aplikace s, jsou někdy označována jako [objekt BLOB](http://en.wikipedia.org/wiki/Binary_large_object), což je zkratka pro binární rozsáhlý objekt.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-118">Binary data that is part of an application s data model is sometimes referred to as a [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), an acronym for Binary Large OBject.</span></span> <span data-ttu-id="8c9d9-119">V těchto kurzech jsem zvolil použití binárních dat terminologie, i když pojem BLOB je synonymum.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-119">In these tutorials I have chosen to use the terminology binary data, although the term BLOB is synonymous.</span></span>

## <a name="step-1-creating-the-working-with-binary-data-web-pages"></a><span data-ttu-id="8c9d9-120">Krok 1: Vytvoření webové stránky práce s binárními daty</span><span class="sxs-lookup"><span data-stu-id="8c9d9-120">Step 1: Creating the Working with Binary Data Web Pages</span></span>

<span data-ttu-id="8c9d9-121">Předtím, než začneme prozkoumat výzvy spojené s přidáním podpory pro binární data, si nejdřív věnujte chvilku vytvoření stránek ASP.NET v našem projektu webu, který budeme potřebovat pro tento kurz a další tři.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-121">Before we begin to explore the challenges associated with adding support for binary data, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="8c9d9-122">Začněte přidáním nové složky s názvem `BinaryData`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-122">Start by adding a new folder named `BinaryData`.</span></span> <span data-ttu-id="8c9d9-123">Dále přidejte následující stránky ASP.NET do této složky a nezapomeňte přidružit jednotlivé stránky k `Site.master` hlavní stránce:</span><span class="sxs-lookup"><span data-stu-id="8c9d9-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `FileUpload.aspx`
- `DisplayOrDownloadData.aspx`
- `UploadInDetailsView.aspx`
- `UpdatingAndDeleting.aspx`

![Přidání stránek ASP.NET pro binární kurzy související s daty](uploading-files-vb/_static/image1.gif)

<span data-ttu-id="8c9d9-125">**Obrázek 1**: přidejte stránky ASP.NET pro binární kurzy související s daty.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-125">**Figure 1**: Add the ASP.NET Pages for the Binary Data-Related Tutorials</span></span>

<span data-ttu-id="8c9d9-126">Podobně jako v ostatních složkách `Default.aspx` ve složce `BinaryData` vypíše kurzy v části.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-126">Like in the other folders, `Default.aspx` in the `BinaryData` folder will list the tutorials in its section.</span></span> <span data-ttu-id="8c9d9-127">Zajistěte, aby tato funkce poskytovala `SectionLevelTutorialListing.ascx` uživatelský ovládací prvek.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="8c9d9-128">Proto tento uživatelský ovládací prvek přidejte do `Default.aspx` tím, že ho přetáhnete z Průzkumník řešení na zobrazení Návrh stránky.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="8c9d9-129">[![přidat uživatelský ovládací prvek SectionLevelTutorialListing. ascx do default. aspx](uploading-files-vb/_static/image2.gif)](uploading-files-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](uploading-files-vb/_static/image2.gif)](uploading-files-vb/_static/image1.png)</span></span>

<span data-ttu-id="8c9d9-130">**Obrázek 2**: Přidání uživatelského ovládacího prvku `SectionLevelTutorialListing.ascx` do `Default.aspx` ([kliknutím zobrazíte obrázek v plné velikosti](uploading-files-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="8c9d9-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](uploading-files-vb/_static/image2.png))</span></span>

<span data-ttu-id="8c9d9-131">Nakonec tyto stránky přidejte jako položky do souboru `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-131">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="8c9d9-132">Konkrétně přidejte následující značky po rozšíření ovládacího prvku GridView `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="8c9d9-132">Specifically, add the following markup after the Enhancing the GridView `<siteMapNode>`:</span></span>

[!code-xml[Main](uploading-files-vb/samples/sample1.xml)]

<span data-ttu-id="8c9d9-133">Po aktualizaci `Web.sitemap`chvíli počkejte, než se zobrazí web kurzy prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="8c9d9-134">Nabídka na levé straně teď obsahuje položky pro práci s binárními kurzy dat.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-134">The menu on the left now includes items for the Working with Binary Data tutorials.</span></span>

![Mapa webu teď obsahuje položky pro práci s binárními kurzy dat](uploading-files-vb/_static/image3.gif)

<span data-ttu-id="8c9d9-136">**Obrázek 3**: Mapa webu teď obsahuje položky pro práci s binárními kurzy dat.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-136">**Figure 3**: The Site Map Now Includes Entries for the Working with Binary Data Tutorials</span></span>

## <a name="step-2-deciding-where-to-store-the-binary-data"></a><span data-ttu-id="8c9d9-137">Krok 2: rozhodnutí, kam uložit binární data</span><span class="sxs-lookup"><span data-stu-id="8c9d9-137">Step 2: Deciding Where to Store the Binary Data</span></span>

<span data-ttu-id="8c9d9-138">Binární data spojená s datovým modelem aplikace s mohou být uložena na jednom ze dvou míst: v systému souborů webového serveru s odkazem na soubor uložený v databázi. nebo přímo v samotné databázi (viz obrázek 4).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-138">Binary data that is associated with the application s data model can be stored in one of two places: on the web server s file system with a reference to the file stored in the database; or directly within the database itself (see Figure 4).</span></span> <span data-ttu-id="8c9d9-139">Každý přístup má svou vlastní sadu specialistů a nevýhody a je podrobnější diskuzi.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-139">Each approach has its own set of pros and cons and merits a more detailed discussion.</span></span>

<span data-ttu-id="8c9d9-140">[![binární data mohou být uložena v systému souborů nebo přímo v databázi.](uploading-files-vb/_static/image4.gif)](uploading-files-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-140">[![Binary Data Can Be Stored On the File System or Directly in the Database](uploading-files-vb/_static/image4.gif)](uploading-files-vb/_static/image3.png)</span></span>

<span data-ttu-id="8c9d9-141">**Obrázek 4**: binární data se můžou ukládat do systému souborů nebo přímo do databáze ([kliknutím zobrazíte obrázek v plné velikosti).](uploading-files-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-141">**Figure 4**: Binary Data Can Be Stored On the File System or Directly in the Database ([Click to view full-size image](uploading-files-vb/_static/image4.png))</span></span>

<span data-ttu-id="8c9d9-142">Představte si, že chceme databázi Northwind rozšíříme, aby k jednotlivým produktům přidružil obrázek.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-142">Imagine that we wanted to extend the Northwind database to associate a picture with each product.</span></span> <span data-ttu-id="8c9d9-143">Jednou z možností je uložit tyto soubory obrázků do systému souborů webového serveru s a zaznamenat cestu v `Products` tabulce.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-143">One option would be to store these image files on the web server s file system and record the path in the `Products` table.</span></span> <span data-ttu-id="8c9d9-144">S tímto přístupem přidáme sloupec `ImagePath` do tabulky `Products` typu `varchar(200)`, možná.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-144">With this approach, we d add an `ImagePath` column to the `Products` table of type `varchar(200)`, perhaps.</span></span> <span data-ttu-id="8c9d9-145">Když uživatel nahrál obrázek pro adresu Chai, může být tento obrázek uložený v systému souborů webového serveru s na `~/Images/Tea.jpg`, kde `~` představuje fyzickou cestu aplikace.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-145">When a user uploaded a picture for Chai, that picture might be stored on the web server s file system at `~/Images/Tea.jpg`, where `~` represents the application s physical path.</span></span> <span data-ttu-id="8c9d9-146">To znamená, že pokud je web rootem na fyzické cestě `C:\Websites\Northwind\`, `~/Images/Tea.jpg` by byl ekvivalentní `C:\Websites\Northwind\Images\Tea.jpg`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-146">That is, if the web site is rooted at the physical path `C:\Websites\Northwind\`, `~/Images/Tea.jpg` would be equivalent to `C:\Websites\Northwind\Images\Tea.jpg`.</span></span> <span data-ttu-id="8c9d9-147">Po nahrání souboru obrázku aktualizujeme záznam Chai v tabulce `Products`, aby se jeho `ImagePath` sloupec odkazoval na cestu k novému obrázku.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-147">After uploading the image file, we d update the Chai record in the `Products` table so that its `ImagePath` column referenced the path of the new image.</span></span> <span data-ttu-id="8c9d9-148">Můžeme použít `~/Images/Tea.jpg` nebo jenom `Tea.jpg`, pokud jsme se rozhodli, že se všechny image produktů umístí do složky `Images` aplikací.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-148">We could use `~/Images/Tea.jpg` or just `Tea.jpg` if we decided that all product images would be placed in the application s `Images` folder.</span></span>

<span data-ttu-id="8c9d9-149">Mezi hlavní výhody ukládání binárních dat v systému souborů patří:</span><span class="sxs-lookup"><span data-stu-id="8c9d9-149">The main advantages of storing the binary data on the file system are:</span></span>

- <span data-ttu-id="8c9d9-150">**Snadné implementace** při krátkém výskytu, ukládání a načítání binárních dat uložených přímo v databázi zahrnuje trochu větší kód než při práci s daty prostřednictvím systému souborů.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-150">**Ease of implementation** as we'll see shortly, storing and retrieving binary data stored directly within the database involves a bit more code than when working with data through the file system.</span></span> <span data-ttu-id="8c9d9-151">Aby mohl uživatel zobrazit nebo stáhnout binární data, musí být předložen s adresou URL těchto dat.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-151">Additionally, in order for a user to view or download binary data they must be presented with a URL to that data.</span></span> <span data-ttu-id="8c9d9-152">Pokud se data nachází v systému souborů webového serveru s, adresa URL je jednoduchá.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-152">If the data resides on the web server s file system, the URL is straightforward.</span></span> <span data-ttu-id="8c9d9-153">Pokud jsou data uložena v databázi, je třeba vytvořit webovou stránku, která načte a vrátí data z databáze.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-153">If the data is stored in the database, however, a web page needs to be created that will retrieve and return the data from the database.</span></span>
- <span data-ttu-id="8c9d9-154">**Širší přístup k binárním datům** může být potřeba, aby binární data byla dostupná pro jiné služby nebo aplikace, které nemůžou přečítat data z databáze.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-154">**Wider access to the binary data** the binary data may need to be accessible to other services or applications, ones that cannot pull the data from the database.</span></span> <span data-ttu-id="8c9d9-155">Například Image přidružené k jednotlivým produktům můžou být k dispozici také uživatelům prostřednictvím [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol). v takovém případě je třeba uložit binární data do systému souborů.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-155">For example, the images associated with each product might also need to be available to users through [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), in which case we d want to store the binary data on the file system.</span></span>
- <span data-ttu-id="8c9d9-156">**Výkon** v případě, že jsou binární data uložena v systému souborů, bude zatížení a zahlcení sítě mezi databázovým serverem a webovým serverem menší než v případě, že jsou binární data ukládána přímo v rámci databáze.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-156">**Performance** if the binary data is stored on the file system, the demand and network congestion between the database server and web server will be less than if the binary data is stored directly within the database.</span></span>

<span data-ttu-id="8c9d9-157">Hlavní nevýhodou ukládání binárních dat v systému souborů je, že odděluje data z databáze.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-157">The main disadvantage of storing binary data on the file system is that it decouples the data from the database.</span></span> <span data-ttu-id="8c9d9-158">Pokud se záznam z `Products` tabulky odstraní, přidružený soubor v systému souborů webového serveru s se automaticky neodstraní.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-158">If a record is deleted from the `Products` table, the associated file on the web server s file system is not automatically deleted.</span></span> <span data-ttu-id="8c9d9-159">Abychom mohli soubor odstranit, je potřeba napsat další kód, jinak se soubor nepoužívá v nepoužitém, osamoceném souboru.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-159">We must write extra code to delete the file or the file system will become cluttered with unused, orphaned files.</span></span> <span data-ttu-id="8c9d9-160">Při zálohování databáze musíme také zajistit, aby se v systému souborů musely zálohovat související binární data.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-160">Furthermore, when backing up the database, we must make sure to make backups of the associated binary data on the file system, as well.</span></span> <span data-ttu-id="8c9d9-161">Přesunutí databáze na jiný web nebo na server přináší podobné problémy.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-161">Moving the database to another site or server poses similar challenges.</span></span>

<span data-ttu-id="8c9d9-162">Případně lze binární data uložit přímo do databáze Microsoft SQL Server 2005 vytvořením sloupce typu `varbinary`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-162">Alternatively, binary data can be stored directly in a Microsoft SQL Server 2005 database by creating a column of type `varbinary`.</span></span> <span data-ttu-id="8c9d9-163">Podobně jako u jiných datových typů s proměnlivou délkou můžete zadat maximální délku binárních dat, která lze v tomto sloupci uchovávat.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-163">Like with other variable length data types, you can specify a maximum length of the binary data that can be held in this column.</span></span> <span data-ttu-id="8c9d9-164">Například pro vyhradení na maximum 5 000 bajtů použijte `varbinary(5000)`; `varbinary(MAX)` umožňuje maximální velikost úložiště, přibližně 2 GB.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-164">For example, to reserve at most 5,000 bytes use `varbinary(5000)`; `varbinary(MAX)` allows for the maximum storage size, about 2 GB.</span></span>

<span data-ttu-id="8c9d9-165">Hlavní výhodou ukládání binárních dat přímo v databázi je těsné spojení mezi binárními daty a záznamem databáze.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-165">The main advantage of storing binary data directly in the database is the tight coupling between the binary data and the database record.</span></span> <span data-ttu-id="8c9d9-166">Tím se značně zjednodušily úlohy správy databáze, jako je zálohování nebo přesun databáze na jiný web nebo server.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-166">This greatly simplifies database administration tasks, like backups or moving the database to a different site or server.</span></span> <span data-ttu-id="8c9d9-167">Odstraněním záznamu se také automaticky odstraní odpovídající binární data.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-167">Also, deleting a record automatically deletes the corresponding binary data.</span></span> <span data-ttu-id="8c9d9-168">Existují také složitější výhody ukládání binárních dat v databázi.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-168">There are also more subtle benefits of storing the binary data in the database.</span></span> <span data-ttu-id="8c9d9-169">Podrobnější diskuzi najdete v tématu [ukládání binárních souborů přímo v databázi pomocí ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) .</span><span class="sxs-lookup"><span data-stu-id="8c9d9-169">See [Storing Binary Files Directly in the Database Using ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) for a more in-depth discussion.</span></span>

> [!NOTE]
> <span data-ttu-id="8c9d9-170">V Microsoft SQL Server 2000 a starších verzích měl `varbinary` datový typ maximální limit 8 000 bajtů.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-170">In Microsoft SQL Server 2000 and earlier versions, the `varbinary` data type had a maximum limit of 8,000 bytes.</span></span> <span data-ttu-id="8c9d9-171">Chcete-li uložit až 2 GB binárních dat, je třeba místo toho použít [datový typ`image`](https://msdn.microsoft.com/library/ms187993.aspx) .</span><span class="sxs-lookup"><span data-stu-id="8c9d9-171">To store up to 2 GB of binary data the [`image` data type](https://msdn.microsoft.com/library/ms187993.aspx) needs to be used instead.</span></span> <span data-ttu-id="8c9d9-172">Při přidání `MAX` v SQL Server 2005 se ale datový typ `image` už nepoužívá.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-172">With the addition of `MAX` in SQL Server 2005, however, the `image` data type has been deprecated.</span></span> <span data-ttu-id="8c9d9-173">Podporuje se i pro zpětnou kompatibilitu, ale společnost Microsoft oznámila, že datový typ `image` bude v budoucí verzi SQL Server odebraný.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-173">It s still supported for backwards compatibility, but Microsoft has announced that the `image` data type will be removed in a future version of SQL Server.</span></span>

<span data-ttu-id="8c9d9-174">Pokud pracujete se starším datovým modelem, může se zobrazit `image` datový typ.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-174">If you are working with an older data model you may see the `image` data type.</span></span> <span data-ttu-id="8c9d9-175">Tabulka Northwind Database s `Categories` obsahuje sloupec `Picture`, který se dá použít k uložení binárních dat souboru obrázku pro danou kategorii.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-175">The Northwind database s `Categories` table has a `Picture` column that can be used to store the binary data of an image file for the category.</span></span> <span data-ttu-id="8c9d9-176">Vzhledem k tomu, že databáze Northwind má své kořeny v aplikaci Microsoft Access a starších verzích SQL Server, je tento sloupec typu `image`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-176">Since the Northwind database has its roots in Microsoft Access and earlier versions of SQL Server, this column is of type `image`.</span></span>

<span data-ttu-id="8c9d9-177">Pro tento kurz a další tři budeme používat oba přístupy.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-177">For this tutorial and the next three, we'll use both approaches.</span></span> <span data-ttu-id="8c9d9-178">Tabulka `Categories` již obsahuje `Picture` sloupec pro ukládání binárního obsahu obrázku pro kategorii.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-178">The `Categories` table already has a `Picture` column for storing the binary content of an image for the category.</span></span> <span data-ttu-id="8c9d9-179">Přidáme další sloupec `BrochurePath`pro uložení cesty k souboru PDF v systému souborů webového serveru s, který se dá použít k zajištění kvalitního přehledu o kategorii pro tisk.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-179">We'll add an additional column, `BrochurePath`, to store a path to a PDF on the web server s file system that can be used to provide a print-quality, polished overview of the category.</span></span>

## <a name="step-3-adding-thebrochurepathcolumn-to-thecategoriestable"></a><span data-ttu-id="8c9d9-180">Krok 3: Přidání sloupce`BrochurePath`do tabulky`Categories`</span><span class="sxs-lookup"><span data-stu-id="8c9d9-180">Step 3: Adding the`BrochurePath`Column to the`Categories`Table</span></span>

<span data-ttu-id="8c9d9-181">V současné době má tabulka Categories pouze čtyři sloupce: `CategoryID`, `CategoryName`, `Description`a `Picture`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-181">Currently the Categories table has only four columns: `CategoryID`, `CategoryName`, `Description`, and `Picture`.</span></span> <span data-ttu-id="8c9d9-182">Kromě těchto polí musíme přidat nový, který bude odkazovat na brožuru kategorie s (pokud existuje).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-182">In addition to these fields, we need to add a new one that will point to the category s brochure (if one exists).</span></span> <span data-ttu-id="8c9d9-183">Chcete-li přidat tento sloupec, přejděte na Průzkumník serveru, přejděte k podrobnostem tabulky, klikněte pravým tlačítkem myši na tabulku `Categories` a vyberte možnost otevřít definici tabulky (viz obrázek 5).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-183">To add this column, go to the Server Explorer, drill down into the Tables, right-click on the `Categories` table and choose Open Table Definition (see Figure 5).</span></span> <span data-ttu-id="8c9d9-184">Pokud nevidíte Průzkumník serveru, udělejte to tak, že vyberete možnost Průzkumník serveru v nabídce zobrazení, nebo stiskněte CTRL + ALT + S.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-184">If you do not see the Server Explorer, bring it up by selecting the Server Explorer option from the View menu, or hit Ctrl+Alt+S.</span></span>

<span data-ttu-id="8c9d9-185">Do tabulky `Categories` s názvem `BrochurePath` přidejte nový sloupec `varchar(200)` a povolí `NULL` a klikněte na ikonu Uložit (nebo stiskněte klávesu CTRL + S).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-185">Add a new `varchar(200)` column to the `Categories` table that is named `BrochurePath` and allows `NULL` s and click the Save icon (or hit Ctrl+S).</span></span>

<span data-ttu-id="8c9d9-186">[![přidat sloupec BrochurePath do tabulky Categories](uploading-files-vb/_static/image5.gif)](uploading-files-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-186">[![Add a BrochurePath Column to the Categories Table](uploading-files-vb/_static/image5.gif)](uploading-files-vb/_static/image5.png)</span></span>

<span data-ttu-id="8c9d9-187">**Obrázek 5**: přidání sloupce `BrochurePath` do tabulky `Categories` ([kliknutím zobrazíte obrázek v plné velikosti](uploading-files-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="8c9d9-187">**Figure 5**: Add a `BrochurePath` Column to the `Categories` Table ([Click to view full-size image](uploading-files-vb/_static/image6.png))</span></span>

## <a name="step-4-updating-the-architecture-to-use-thepictureandbrochurepathcolumns"></a><span data-ttu-id="8c9d9-188">Krok 4: Aktualizace architektury pro použití sloupců`Picture`a`BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="8c9d9-188">Step 4: Updating the Architecture to Use the`Picture`and`BrochurePath`Columns</span></span>

<span data-ttu-id="8c9d9-189">`CategoriesDataTable` ve vrstvě pro přístup k datům (DAL) v současné době má definováno čtyři `DataColumn` s: `CategoryID`, `CategoryName`, `Description`a `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-189">The `CategoriesDataTable` in the Data Access Layer (DAL) currently has four `DataColumn` s defined: `CategoryID`, `CategoryName`, `Description`, and `NumberOfProducts`.</span></span> <span data-ttu-id="8c9d9-190">Když jsme tento DataTable původně navrhli v kurzu [Vytvoření vrstvy přístupu k datům](../introduction/creating-a-data-access-layer-vb.md) , `CategoriesDataTable` mít jenom první tři sloupce; `NumberOfProducts` sloupec byl přidán v [seznamu hlavní/podrobnosti pomocí seznamu hlavních záznamů s odrážkami s kurzem podrobností DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="8c9d9-190">When we originally designed this DataTable in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial, the `CategoriesDataTable` only had the first three columns; the `NumberOfProducts` column was added in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial.</span></span>

<span data-ttu-id="8c9d9-191">Jak je popsáno v tématu *Vytvoření vrstvy přístupu k datům*, tvoří datové tabulky v zadané datové sadě obchodní objekty.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-191">As discussed in *Creating a Data Access Layer*, the DataTables in the Typed DataSet make up the business objects.</span></span> <span data-ttu-id="8c9d9-192">Objekty TableAdapter zodpovídá za komunikaci s databází a naplnění obchodních objektů pomocí výsledků dotazu.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-192">The TableAdapters are responsible for communicating with the database and populating the business objects with the query results.</span></span> <span data-ttu-id="8c9d9-193">`CategoriesDataTable` vyplní `CategoriesTableAdapter`, která má tři metody načítání dat:</span><span class="sxs-lookup"><span data-stu-id="8c9d9-193">The `CategoriesDataTable` is populated by the `CategoriesTableAdapter`, which has three data retrieval methods:</span></span>

- <span data-ttu-id="8c9d9-194">`GetCategories()` spustí hlavní dotaz TableAdapter s a vrátí pole `CategoryID`, `CategoryName`a `Description` všech záznamů v tabulce `Categories`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-194">`GetCategories()` executes the TableAdapter s main query and returns the `CategoryID`, `CategoryName`, and `Description` fields of all records in the `Categories` table.</span></span> <span data-ttu-id="8c9d9-195">Hlavní dotaz je používán automaticky generovanými `Insert` a metodami `Update`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-195">The main query is what is used by the auto-generated `Insert` and `Update` methods.</span></span>
- <span data-ttu-id="8c9d9-196">`GetCategoryByCategoryID(categoryID)` vrátí pole `CategoryID`, `CategoryName`a `Description` kategorie, jejichž `CategoryID` se rovná hodnotě *KódKategorie*.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-196">`GetCategoryByCategoryID(categoryID)` returns the `CategoryID`, `CategoryName`, and `Description` fields of the category whose `CategoryID` equals *categoryID*.</span></span>
- <span data-ttu-id="8c9d9-197">`GetCategoriesAndNumberOfProducts()` – vrátí pole `CategoryID`, `CategoryName`a `Description` pro všechny záznamy v tabulce `Categories`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-197">`GetCategoriesAndNumberOfProducts()` - returns the `CategoryID`, `CategoryName`, and `Description` fields for all records in the `Categories` table.</span></span> <span data-ttu-id="8c9d9-198">Používá také poddotaz k vrácení počtu produktů přidružených ke každé kategorii.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-198">Also uses a subquery to return the number of products associated with each category.</span></span>

<span data-ttu-id="8c9d9-199">Všimněte si, že žádný z těchto dotazů nevrátí `Categories` tabulce `Picture` nebo `BrochurePath` sloupců; ani `CategoriesDataTable` pro tato pole zadat `DataColumn`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-199">Notice that none of these queries return the `Categories` table s `Picture` or `BrochurePath` columns; nor does the `CategoriesDataTable` provide `DataColumn` s for these fields.</span></span> <span data-ttu-id="8c9d9-200">Aby bylo možné pracovat s vlastnostmi obrázku a `BrochurePath`, je nutné je nejprve přidat do `CategoriesDataTable` a poté aktualizovat třídu `CategoriesTableAdapter`, aby tyto sloupce vracela.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-200">In order to work with the Picture and `BrochurePath` properties, we need to first add them to the `CategoriesDataTable` and then update the `CategoriesTableAdapter` class to return these columns.</span></span>

## <a name="adding-thepictureandbrochurepathdatacolumn-s"></a><span data-ttu-id="8c9d9-201">Přidání`Picture`a`BrochurePath``DataColumn` s</span><span class="sxs-lookup"><span data-stu-id="8c9d9-201">Adding the`Picture`and`BrochurePath``DataColumn` s</span></span>

<span data-ttu-id="8c9d9-202">Začněte přidáním těchto dvou sloupců do `CategoriesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-202">Start by adding these two columns to the `CategoriesDataTable`.</span></span> <span data-ttu-id="8c9d9-203">Klikněte pravým tlačítkem na záhlaví `CategoriesDataTable` s, v místní nabídce vyberte Přidat a pak zvolte možnost sloupec.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-203">Right-click on the `CategoriesDataTable` s header, select Add from the context menu and then choose the Column option.</span></span> <span data-ttu-id="8c9d9-204">Tím se vytvoří nový `DataColumn` v objektu DataTable s názvem `Column1`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-204">This will create a new `DataColumn` in the DataTable named `Column1`.</span></span> <span data-ttu-id="8c9d9-205">Přejmenujte tento sloupec na `Picture`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-205">Rename this column to `Picture`.</span></span> <span data-ttu-id="8c9d9-206">V okno Vlastnosti nastavte vlastnost `DataColumn` s `DataType` na `System.Byte[]` (nejedná se o možnost v rozevíracím seznamu, je nutné ji zadat).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-206">From the Properties window, set the `DataColumn` s `DataType` property to `System.Byte[]` (this is not an option in the drop-down list; you need to type it in).</span></span>

<span data-ttu-id="8c9d9-207">[![vytvořit datový sloupec s názvem Picture, jehož datový typ je System. Byte []](uploading-files-vb/_static/image6.gif)](uploading-files-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-207">[![Create a DataColumn Named Picture whose DataType is System.Byte[]](uploading-files-vb/_static/image6.gif)](uploading-files-vb/_static/image7.png)</span></span>

<span data-ttu-id="8c9d9-208">**Obrázek 6**: vytvoření `DataColumn` s názvem `Picture`, jehož `DataType` je `System.Byte[]` ([kliknutím zobrazíte obrázek v plné velikosti](uploading-files-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="8c9d9-208">**Figure 6**: Create a `DataColumn` Named `Picture` whose `DataType` is `System.Byte[]` ([Click to view full-size image](uploading-files-vb/_static/image8.png))</span></span>

<span data-ttu-id="8c9d9-209">Přidejte do objektu DataTable další `DataColumn` a pojmenujte ji `BrochurePath` pomocí výchozí `DataType` hodnoty (`System.String`).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-209">Add another `DataColumn` to the DataTable, naming it `BrochurePath` using the default `DataType` value (`System.String`).</span></span>

## <a name="returning-thepictureandbrochurepathvalues-from-the-tableadapter"></a><span data-ttu-id="8c9d9-210">Vrácení`Picture`a`BrochurePath`hodnot z TableAdapter</span><span class="sxs-lookup"><span data-stu-id="8c9d9-210">Returning the`Picture`and`BrochurePath`Values from the TableAdapter</span></span>

<span data-ttu-id="8c9d9-211">Po přidání těchto dvou `DataColumn`ů do `CategoriesDataTable`jsme připraveni aktualizovat `CategoriesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-211">With these two `DataColumn` s added to the `CategoriesDataTable`, we re ready to update the `CategoriesTableAdapter`.</span></span> <span data-ttu-id="8c9d9-212">V hlavním dotazu TableAdapter můžeme mít oba tyto hodnoty sloupců, ale to by při každém vyvolání metody `GetCategories()` vrátilo binární data.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-212">We could have both of these column values returned in the main TableAdapter query, but this would bring back the binary data every time the `GetCategories()` method was invoked.</span></span> <span data-ttu-id="8c9d9-213">Místo toho aktualizujte hlavní dotaz TableAdapter tak, aby vracel `BrochurePath` a vytvořil další metodu načtení dat, která vrátí konkrétní kategorii `Picture` sloupci.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-213">Instead, let s update the main TableAdapter query to bring back `BrochurePath` and create an additional data retrieval method that returns a particular category s `Picture` column.</span></span>

<span data-ttu-id="8c9d9-214">Chcete-li aktualizovat hlavní dotaz TableAdapter, klikněte pravým tlačítkem myši na hlavičku `CategoriesTableAdapter` s a v místní nabídce vyberte možnost konfigurovat.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-214">To update the main TableAdapter query, right-click on the `CategoriesTableAdapter` s header and choose the Configure option from the context menu.</span></span> <span data-ttu-id="8c9d9-215">Tím se zobrazí Průvodce konfigurací adaptéru tabulky, který jsme viděli v několika minulých kurzech.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-215">This brings up the Table Adapter Configuration Wizard, which we ve seen in a number of past tutorials.</span></span> <span data-ttu-id="8c9d9-216">Aktualizujte dotaz tak, aby se vrátil `BrochurePath` a klikněte na Dokončit.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-216">Update the query to bring back the `BrochurePath` and click Finish.</span></span>

<span data-ttu-id="8c9d9-217">[![aktualizujte seznam sloupců v příkazu SELECT tak, aby vracel také BrochurePath](uploading-files-vb/_static/image7.gif)](uploading-files-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-217">[![Update the Column List in the SELECT Statement to Also Return BrochurePath](uploading-files-vb/_static/image7.gif)](uploading-files-vb/_static/image9.png)</span></span>

<span data-ttu-id="8c9d9-218">**Obrázek 7**: aktualizace seznamu sloupců v příkazu `SELECT`, aby se vracely taky `BrochurePath` ([kliknutím zobrazíte obrázek v plné velikosti](uploading-files-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="8c9d9-218">**Figure 7**: Update the Column List in the `SELECT` Statement to Also Return `BrochurePath` ([Click to view full-size image](uploading-files-vb/_static/image10.png))</span></span>

<span data-ttu-id="8c9d9-219">Při použití příkazů SQL ad hoc pro TableAdapter aktualizuje seznam sloupců v hlavním dotazu seznam sloupců pro všechny metody `SELECT` dotazů v TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-219">When using ad-hoc SQL statements for the TableAdapter, updating the column list in the main query updates the column list for all of the `SELECT` query methods in the TableAdapter.</span></span> <span data-ttu-id="8c9d9-220">To znamená, že `GetCategoryByCategoryID(categoryID)` metoda byla aktualizována tak, aby vracela sloupec `BrochurePath`, což může být to, co zamýšleli.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-220">That means the `GetCategoryByCategoryID(categoryID)` method has been updated to return the `BrochurePath` column, which might be what we intended.</span></span> <span data-ttu-id="8c9d9-221">Ale aktualizoval také seznam sloupců v metodě `GetCategoriesAndNumberOfProducts()` a odebrali jsme tak poddotaz, který vrátí počet produktů pro každou kategorii.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-221">However, it also updated the column list in the `GetCategoriesAndNumberOfProducts()` method, removing the subquery that returns the number of products for each category!</span></span> <span data-ttu-id="8c9d9-222">Proto musíme tuto metodu s `SELECT` dotazem aktualizovat.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-222">Therefore, we need to update this method s `SELECT` query.</span></span> <span data-ttu-id="8c9d9-223">Klikněte pravým tlačítkem na metodu `GetCategoriesAndNumberOfProducts()`, vyberte konfigurovat a vraťte `SELECT` dotaz zpátky na původní hodnotu:</span><span class="sxs-lookup"><span data-stu-id="8c9d9-223">Right-click on the `GetCategoriesAndNumberOfProducts()` method, choose Configure, and revert the `SELECT` query back to its original value:</span></span>

[!code-sql[Main](uploading-files-vb/samples/sample2.sql)]

<span data-ttu-id="8c9d9-224">Dále vytvořte novou metodu TableAdapter, která vrátí určitou kategorii s `Picture` hodnotou sloupce.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-224">Next, create a new TableAdapter method that returns a particular category s `Picture` column value.</span></span> <span data-ttu-id="8c9d9-225">Klikněte pravým tlačítkem na záhlaví `CategoriesTableAdapter` s a vyberte možnost Přidat dotaz. spustí se Průvodce konfigurací dotazu TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-225">Right-click on the `CategoriesTableAdapter` s header and choose the Add Query option to launch the TableAdapter Query Configuration Wizard.</span></span> <span data-ttu-id="8c9d9-226">První krok tohoto průvodce se zeptá, jestli chceme dotazovat data pomocí příkazu SQL ad hoc, nové uložené procedury nebo existující.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-226">The first step of this wizard asks us if we want to query data using an ad-hoc SQL statement, a new stored procedure, or an existing one.</span></span> <span data-ttu-id="8c9d9-227">Vyberte možnost použít příkazy jazyka SQL a klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-227">Select Use SQL statements and click Next.</span></span> <span data-ttu-id="8c9d9-228">Vzhledem k tomu, že vrátíme řádek, zvolte v druhém kroku možnost vybrat, která vrací řádky.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-228">Since we will be returning a row, choose the SELECT which returns rows option from the second step.</span></span>

<span data-ttu-id="8c9d9-229">[![výběru možnosti použít příkazy SQL](uploading-files-vb/_static/image8.gif)](uploading-files-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-229">[![Select the Use SQL statements Option](uploading-files-vb/_static/image8.gif)](uploading-files-vb/_static/image11.png)</span></span>

<span data-ttu-id="8c9d9-230">**Obrázek 8**: vyberte možnost použít příkazy SQL ([kliknutím zobrazíte obrázek v plné velikosti](uploading-files-vb/_static/image12.png)).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-230">**Figure 8**: Select the Use SQL statements Option ([Click to view full-size image](uploading-files-vb/_static/image12.png))</span></span>

<span data-ttu-id="8c9d9-231">[![vzhledem k tomu, že dotaz vrátí záznam z tabulky Categories, zvolte vybrat, který vrátí řádky.](uploading-files-vb/_static/image9.gif)](uploading-files-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-231">[![Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows](uploading-files-vb/_static/image9.gif)](uploading-files-vb/_static/image13.png)</span></span>

<span data-ttu-id="8c9d9-232">**Obrázek 9**: vzhledem k tomu, že dotaz vrátí záznam z tabulky Categories, zvolte vybrat, který vrátí řádky ([kliknutím zobrazíte obrázek v plné velikosti).](uploading-files-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-232">**Figure 9**: Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows ([Click to view full-size image](uploading-files-vb/_static/image14.png))</span></span>

<span data-ttu-id="8c9d9-233">V třetím kroku zadejte následující dotaz SQL a klikněte na další:</span><span class="sxs-lookup"><span data-stu-id="8c9d9-233">In the third step, enter the following SQL query and click Next:</span></span>

[!code-sql[Main](uploading-files-vb/samples/sample3.sql)]

<span data-ttu-id="8c9d9-234">Posledním krokem je výběr názvu nové metody.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-234">The last step is to choose the name for the new method.</span></span> <span data-ttu-id="8c9d9-235">Pro naplnění objektu DataTable použijte `FillCategoryWithBinaryDataByCategoryID` a `GetCategoryWithBinaryDataByCategoryID` a vraťte se ke vzorům DataTable.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-235">Use `FillCategoryWithBinaryDataByCategoryID` and `GetCategoryWithBinaryDataByCategoryID` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span> <span data-ttu-id="8c9d9-236">Kliknutím na Dokončit dokončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-236">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="8c9d9-237">[![zvolit názvy pro metody TableAdapter s](uploading-files-vb/_static/image10.gif)](uploading-files-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-237">[![Choose the Names for the TableAdapter s Methods](uploading-files-vb/_static/image10.gif)](uploading-files-vb/_static/image15.png)</span></span>

<span data-ttu-id="8c9d9-238">**Obrázek 10**: vyberte názvy pro metody TableAdapter s ([kliknutím zobrazíte obrázek v plné velikosti](uploading-files-vb/_static/image16.png)).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-238">**Figure 10**: Choose the Names for the TableAdapter s Methods ([Click to view full-size image](uploading-files-vb/_static/image16.png))</span></span>

> [!NOTE]
> <span data-ttu-id="8c9d9-239">Po dokončení Průvodce konfigurací dotazu na tabulkový adaptér se může zobrazit dialogové okno s dotazem, že nový text příkazu vrátí data se schématem, které se liší od schématu hlavního dotazu.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-239">After completing the Table Adapter Query Configuration Wizard you may see a dialog box informing you that the new command text returns data with schema different from the schema of the main query.</span></span> <span data-ttu-id="8c9d9-240">V krátkém případě Průvodce zaznamená, že hlavní `GetCategories()` dotaz TableAdapter s vrací jiné schéma než ten, který jsme právě vytvořili.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-240">In short, the wizard is noting that the TableAdapter s main query `GetCategories()` returns a different schema than the one we just created.</span></span> <span data-ttu-id="8c9d9-241">Ale to je to, co chceme, takže můžete tuto zprávu ignorovat.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-241">But this is what we want, so you can disregard this message.</span></span>

<span data-ttu-id="8c9d9-242">Mějte na paměti, že pokud používáte příkazy SQL ad hoc a pomocí Průvodce změníte hlavní dotaz TableAdapter s v pozdějším časovém okamžiku, změní se seznam sloupců `GetCategoryWithBinaryDataByCategoryID` metoda s `SELECT`, aby se zahrnuly jenom tyto sloupce z hlavního dotazu (to znamená, že se z dotazu odebere sloupec `Picture`).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-242">Also, keep in mind that if you are using ad-hoc SQL statements and use the wizard to change the TableAdapter s main query at some later point in time, it will modify the `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement s column list to include just those columns from the main query (that is, it will remove the `Picture` column from the query).</span></span> <span data-ttu-id="8c9d9-243">Seznam sloupců bude nutné aktualizovat ručně, aby vracel sloupec `Picture`, podobně jako v předchozích krocích v tomto kroku jsme použili metodu `GetCategoriesAndNumberOfProducts()`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-243">You will have to manually update the column list to return the `Picture` column, similar to what we did with the `GetCategoriesAndNumberOfProducts()` method earlier in this step.</span></span>

<span data-ttu-id="8c9d9-244">Po přidání dvou `DataColumn` s do `CategoriesDataTable` a metody `GetCategoryWithBinaryDataByCategoryID` do `CategoriesTableAdapter`by tyto třídy v Návrháři typované datové sady měly vypadat jako snímek obrazovky na obrázku 11.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-244">After adding the two `DataColumn` s to the `CategoriesDataTable` and the `GetCategoryWithBinaryDataByCategoryID` method to the `CategoriesTableAdapter`, these classes in the Typed DataSet Designer should look like the screenshot in Figure 11.</span></span>

![Návrhář DataSet obsahuje nové sloupce a metodu.](uploading-files-vb/_static/image11.gif)

<span data-ttu-id="8c9d9-246">**Obrázek 11**: Návrhář datových sad zahrnuje nové sloupce a metodu.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-246">**Figure 11**: The DataSet Designer Includes the New Columns and Method</span></span>

## <a name="updating-the-business-logic-layer-bll"></a><span data-ttu-id="8c9d9-247">Aktualizace vrstvy obchodní logiky (knihoven BLL)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-247">Updating the Business Logic Layer (BLL)</span></span>

<span data-ttu-id="8c9d9-248">Po aktualizaci DAL je vše potřeba rozšířit vrstvu obchodní logiky (knihoven BLL) tak, aby zahrnovala metodu pro novou metodu `CategoriesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-248">With the DAL updated, all that remains is to augment the Business Logic Layer (BLL) to include a method for the new `CategoriesTableAdapter` method.</span></span> <span data-ttu-id="8c9d9-249">Do `CategoriesBLL` třídy přidejte následující metodu:</span><span class="sxs-lookup"><span data-stu-id="8c9d9-249">Add the following method to the `CategoriesBLL` class:</span></span>

[!code-vb[Main](uploading-files-vb/samples/sample4.vb)]

## <a name="step-5-uploading-a-file-from-the-client-to-the-web-server"></a><span data-ttu-id="8c9d9-250">Krok 5: nahrání souboru z klienta na webový server</span><span class="sxs-lookup"><span data-stu-id="8c9d9-250">Step 5: Uploading a File From the Client to the Web Server</span></span>

<span data-ttu-id="8c9d9-251">Při shromažďování binárních dat často tato data dodávají koncovým uživatelem.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-251">When collecting binary data, oftentimes this data is supplied by an end user.</span></span> <span data-ttu-id="8c9d9-252">Aby bylo možné tyto informace zachytit, musí být uživatel schopný nahrávat soubor ze svého počítače na webový server.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-252">To capture this information, the user needs to be able to upload a file from their computer to the web server.</span></span> <span data-ttu-id="8c9d9-253">Nahraná data pak musí být integrovaná s datovým modelem, což může znamenat, že soubor se uloží do systému souborů webového serveru s a přidá cestu k souboru do databáze nebo zapíše binární obsah přímo do databáze.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-253">The uploaded data then needs to be integrated with the data model, which may mean saving the file to the web server s file system and adding a path to the file in the database, or writing the binary contents directly into the database.</span></span> <span data-ttu-id="8c9d9-254">V tomto kroku se podíváme na to, jak uživateli dovolit nahrávat soubory ze svého počítače na server.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-254">In this step we'll look at how to allow a user to upload files from their computer to the server.</span></span> <span data-ttu-id="8c9d9-255">V dalším kurzu zapnete naši pozornost pro integraci nahraného souboru s datovým modelem.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-255">In the next tutorial we'll turn our attention to integrating the uploaded file with data model.</span></span>

<span data-ttu-id="8c9d9-256">[Webový ovládací prvek](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) ASP.NET 2,0 s New Upload poskytuje mechanismus pro uživatele, kteří odesílají soubor ze svého počítače na webový server.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-256">ASP.NET 2.0 s new [FileUpload Web control](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) provides a mechanism for users to send a file from their computer to the web server.</span></span> <span data-ttu-id="8c9d9-257">Ovládací prvek nahrání souboru se vykresluje jako `<input>` element, jehož atribut `type` je nastaven na soubor, které prohlížeče se zobrazí jako textové pole s tlačítkem Procházet.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-257">The FileUpload control renders as an `<input>` element whose `type` attribute is set to file, which browsers display as a textbox with a Browse button.</span></span> <span data-ttu-id="8c9d9-258">Kliknutím na tlačítko Procházet zobrazíte dialogové okno, ve kterém může uživatel vybrat soubor.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-258">Clicking the Browse button brings up a dialog box from which the user can select a file.</span></span> <span data-ttu-id="8c9d9-259">Když se formulář publikuje zpátky, vybraný obsah souborů s se pošle spolu s zpětným voláním.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-259">When the form is posted back, the selected file s contents are sent along with the postback.</span></span> <span data-ttu-id="8c9d9-260">Na straně serveru jsou informace o nahraném souboru přístupné prostřednictvím vlastností ovládacího prvku pro nahrání souboru.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-260">On the server-side, information about the uploaded file is accessible through the FileUpload control s properties.</span></span>

<span data-ttu-id="8c9d9-261">Chcete-li předvést nahrávání souborů, otevřete stránku `FileUpload.aspx` ve složce `BinaryData`, přetáhněte ovládací prvek pro nahrání souboru ze sady nástrojů do návrháře a nastavte vlastnost `ID` ovládacího prvku na `UploadTest`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-261">To demonstrate uploading files, open the `FileUpload.aspx` page in the `BinaryData` folder, drag a FileUpload control from the Toolbox onto the Designer, and set the control s `ID` property to `UploadTest`.</span></span> <span data-ttu-id="8c9d9-262">Dále přidejte ovládací prvek web Button nastavení `ID` a `Text` vlastností na `UploadButton` a nahrajte vybraný soubor v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-262">Next, add a Button Web control setting its `ID` and `Text` properties to `UploadButton` and Upload Selected File, respectively.</span></span> <span data-ttu-id="8c9d9-263">Nakonec umístěte ovládací prvek popisek webu pod tlačítko, vymažte jeho vlastnost `Text` a nastavte jeho vlastnost `ID` na `UploadDetails`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-263">Finally, place a Label Web control beneath the Button, clear out its `Text` property and set its `ID` property to `UploadDetails`.</span></span>

<span data-ttu-id="8c9d9-264">[![přidat na stránku ASP.NET ovládací prvek pro nahrání souborů](uploading-files-vb/_static/image12.gif)](uploading-files-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-264">[![Add a FileUpload Control to the ASP.NET Page](uploading-files-vb/_static/image12.gif)](uploading-files-vb/_static/image17.png)</span></span>

<span data-ttu-id="8c9d9-265">**Obrázek 12**: Přidání ovládacího prvku nahrání souborů na stránku ASP.NET ([kliknutím zobrazíte obrázek v plné velikosti](uploading-files-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="8c9d9-265">**Figure 12**: Add a FileUpload Control to the ASP.NET Page ([Click to view full-size image](uploading-files-vb/_static/image18.png))</span></span>

<span data-ttu-id="8c9d9-266">Obrázek 13 ukazuje tuto stránku při prohlížení v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-266">Figure 13 shows this page when viewed through a browser.</span></span> <span data-ttu-id="8c9d9-267">Všimněte si, že kliknutím na tlačítko Procházet zobrazíte dialogové okno Výběr souboru, které uživateli umožňuje vybrat soubor ze svého počítače.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-267">Note that clicking the Browse button brings up a file selection dialog box, allowing the user to pick a file from their computer.</span></span> <span data-ttu-id="8c9d9-268">Po výběru souboru dojde po kliknutí na tlačítko nahrát vybraný soubor k odeslání zpětného volání, které pošle vybraný binární obsah souboru s na webový server.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-268">Once a file has been selected, clicking the Upload Selected File button causes a postback that sends the selected file s binary content to the web server.</span></span>

<span data-ttu-id="8c9d9-269">[![může uživatel vybrat soubor, který se má odeslat ze svého počítače na server.](uploading-files-vb/_static/image13.gif)](uploading-files-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-269">[![The User Can Select a File to Upload from their Computer to the Server](uploading-files-vb/_static/image13.gif)](uploading-files-vb/_static/image19.png)</span></span>

<span data-ttu-id="8c9d9-270">**Obrázek 13**: uživatel může vybrat soubor, který se má nahrát z počítače na server ([kliknutím zobrazíte obrázek v plné velikosti).](uploading-files-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-270">**Figure 13**: The User Can Select a File to Upload from their Computer to the Server ([Click to view full-size image](uploading-files-vb/_static/image20.png))</span></span>

<span data-ttu-id="8c9d9-271">Při zpětném odeslání se nahraný soubor může uložit do systému souborů nebo jeho binární data může pracovat přímo přes datový proud.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-271">On postback, the uploaded file can be saved to the file system or its binary data can be worked with directly through a Stream.</span></span> <span data-ttu-id="8c9d9-272">V tomto příkladu vytvoříme složku `~/Brochures` a uložíte tam uložený soubor.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-272">For this example, let s create a `~/Brochures` folder and save the uploaded file there.</span></span> <span data-ttu-id="8c9d9-273">Začněte přidáním `Brochures` složky do lokality jako podsložky kořenového adresáře.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-273">Start by adding the `Brochures` folder to the site as a subfolder of the root directory.</span></span> <span data-ttu-id="8c9d9-274">Dále vytvořte obslužnou rutinu události pro událost `Click` `UploadButton` s a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="8c9d9-274">Next, create an event handler for the `UploadButton` s `Click` event and add the following code:</span></span>

[!code-vb[Main](uploading-files-vb/samples/sample5.vb)]

<span data-ttu-id="8c9d9-275">Ovládací prvek nahrání souborů poskytuje celou řadu vlastností pro práci s nahranými daty.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-275">The FileUpload control provides a variety of properties for working with the uploaded data.</span></span> <span data-ttu-id="8c9d9-276">Například [vlastnost`HasFile`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) označuje, zda byl soubor nahrán uživatelem, zatímco [vlastnost`FileBytes`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) poskytuje přístup k nahraným binárním datům jako pole bajtů.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-276">For instance, the [`HasFile` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) indicates whether a file was uploaded by the user, while the [`FileBytes` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) provides access to the uploaded binary data as an array of bytes.</span></span> <span data-ttu-id="8c9d9-277">Obslužná rutina události `Click` se spustí tím, že zajistí, že se soubor nahrál.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-277">The `Click` event handler starts by ensuring that a file has been uploaded.</span></span> <span data-ttu-id="8c9d9-278">Pokud byl soubor nahrán, popisek zobrazuje název nahraného souboru, jeho velikost v bajtech a jeho typ obsahu.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-278">If a file has been uploaded, the Label shows the name of the uploaded file, its size in bytes, and its content-type.</span></span>

> [!NOTE]
> <span data-ttu-id="8c9d9-279">Chcete-li zajistit, aby uživatel načetl soubor, můžete zkontrolovat vlastnost `HasFile` a zobrazit upozornění, pokud se `False`, nebo můžete místo toho použít [ovládací prvek RequiredFieldValidator](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) .</span><span class="sxs-lookup"><span data-stu-id="8c9d9-279">To ensure that the user uploads a file you can check the `HasFile` property and display a warning if it s `False`, or you may use the [RequiredFieldValidator control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) instead.</span></span>

<span data-ttu-id="8c9d9-280">Soubor upload s `SaveAs(filePath)` uloží nahraný soubor do zadaného souboru *FilePath*.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-280">The FileUpload s `SaveAs(filePath)` saves the uploaded file to the specified *filePath*.</span></span> <span data-ttu-id="8c9d9-281">*FilePath* musí být *fyzická cesta* (`C:\Websites\Brochures\SomeFile.pdf`) místo *virtuální* *cesty* (`/Brochures/SomeFile.pdf`).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-281">*filePath* must be a *physical path* (`C:\Websites\Brochures\SomeFile.pdf`) rather than a *virtual* *path* (`/Brochures/SomeFile.pdf`).</span></span> <span data-ttu-id="8c9d9-282">[Metoda`Server.MapPath(virtPath)`](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) přebírá virtuální cestu a vrátí její odpovídající fyzickou cestu.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-282">The [`Server.MapPath(virtPath)` method](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) takes a virtual path and returns its corresponding physical path.</span></span> <span data-ttu-id="8c9d9-283">Tady je virtuální cesta `~/Brochures/fileName`, kde *filename* je název nahraného souboru.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-283">Here, the virtual path is `~/Brochures/fileName`, where *fileName* is the name of the uploaded file.</span></span> <span data-ttu-id="8c9d9-284">Další informace o virtuálních a fyzických cestách a použití `Server.MapPath`najdete v tématu [použití serveru. MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) .</span><span class="sxs-lookup"><span data-stu-id="8c9d9-284">See [Using Server.MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) for more information on virtual and physical paths and using `Server.MapPath`.</span></span>

<span data-ttu-id="8c9d9-285">Po dokončení obslužné rutiny události `Click` chvíli počkejte, než se otestuje stránka v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-285">After completing the `Click` event handler, take a moment to test out the page in a browser.</span></span> <span data-ttu-id="8c9d9-286">Klikněte na tlačítko Procházet a vyberte soubor z pevného disku a pak klikněte na tlačítko nahrát vybraný soubor.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-286">Click the Browse button and select a file from your hard drive and then click the Upload Selected File button.</span></span> <span data-ttu-id="8c9d9-287">Postback odešle obsah vybraného souboru na webový server, který zobrazí informace o souboru před jeho uložením do složky `~/Brochures`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-287">The postback will send the contents of the selected file to the web server, which will then display information about the file before saving it to the `~/Brochures` folder.</span></span> <span data-ttu-id="8c9d9-288">Po nahrání souboru se vraťte do sady Visual Studio a klikněte na tlačítko Aktualizovat v Průzkumník řešení.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-288">After uploading the file, return to Visual Studio and click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="8c9d9-289">Měli byste vidět soubor, který jste právě Nahráli ve složce ~/Brochures.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-289">You should see the file you just uploaded in the ~/Brochures folder!</span></span>

<span data-ttu-id="8c9d9-290">[![soubor EvolutionValley. jpg byl nahrán na webový server.](uploading-files-vb/_static/image14.gif)](uploading-files-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-290">[![The File EvolutionValley.jpg Has Been Uploaded to the Web Server](uploading-files-vb/_static/image14.gif)](uploading-files-vb/_static/image21.png)</span></span>

<span data-ttu-id="8c9d9-291">**Obrázek 14**: soubor `EvolutionValley.jpg` byl nahrán na webový server ([kliknutím zobrazíte obrázek v plné velikosti](uploading-files-vb/_static/image22.png)).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-291">**Figure 14**: The File `EvolutionValley.jpg` Has Been Uploaded to the Web Server ([Click to view full-size image](uploading-files-vb/_static/image22.png))</span></span>

![EvolutionValley. jpg se uložil do složky ~/Brochures.](uploading-files-vb/_static/image15.gif)

<span data-ttu-id="8c9d9-293">**Obrázek 15**: `EvolutionValley.jpg` byl uložen do složky `~/Brochures`</span><span class="sxs-lookup"><span data-stu-id="8c9d9-293">**Figure 15**: `EvolutionValley.jpg` Was Saved to the `~/Brochures` Folder</span></span>

## <a name="subtleties-with-saving-uploaded-files-to-the-file-system"></a><span data-ttu-id="8c9d9-294">Odlišností s uložením nahraných souborů do systému souborů</span><span class="sxs-lookup"><span data-stu-id="8c9d9-294">Subtleties with Saving Uploaded Files to the File System</span></span>

<span data-ttu-id="8c9d9-295">Při ukládání nahrávání souborů do systému souborů webového serveru s je třeba řešit několik odlišností.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-295">There are several subtleties that must be addressed when saving uploading files to the web server s file system.</span></span> <span data-ttu-id="8c9d9-296">Za prvé se vyskytl problém s zabezpečením.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-296">First, there s the issue of security.</span></span> <span data-ttu-id="8c9d9-297">Aby bylo možné uložit soubor do systému souborů, musí mít kontext zabezpečení, pod kterým je stránka ASP.NET spuštěná, oprávnění k zápisu.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-297">To save a file to the file system, the security context under which the ASP.NET page is executing must have Write permissions.</span></span> <span data-ttu-id="8c9d9-298">Webový server ASP.NET Development běží v kontextu aktuálního uživatelského účtu.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-298">The ASP.NET Development Web Server runs under the context of your current user account.</span></span> <span data-ttu-id="8c9d9-299">Pokud jako webový server používáte Microsoft s Internetová informační služba (IIS), závisí kontext zabezpečení na verzi služby IIS a její konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-299">If you are using Microsoft s Internet Information Services (IIS) as the web server, the security context depends on the version of IIS and its configuration.</span></span>

<span data-ttu-id="8c9d9-300">Další výzvou k ukládání souborů do systému souborů se otáčí kolem názvů souborů.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-300">Another challenge of saving files to the file system revolves around naming the files.</span></span> <span data-ttu-id="8c9d9-301">V současné době stránka ukládá všechny nahrané soubory do adresáře `~/Brochures` pomocí stejného názvu jako soubor v počítači klienta s.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-301">Currently, our page saves all of the uploaded files to the `~/Brochures` directory using the same name as the file on the client s computer.</span></span> <span data-ttu-id="8c9d9-302">Pokud uživatel A nahraje brožuru s názvem `Brochure.pdf`, soubor se uloží jako `~/Brochure/Brochure.pdf`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-302">If User A uploads a brochure with the name `Brochure.pdf`, the file will be saved as `~/Brochure/Brochure.pdf`.</span></span> <span data-ttu-id="8c9d9-303">Ale co když někdy později uživatel B nahraje jiný soubor brožury, ke kterému má stejný název souboru (`Brochure.pdf`)?</span><span class="sxs-lookup"><span data-stu-id="8c9d9-303">But what if sometime later User B uploads a different brochure file that happens to have the same filename (`Brochure.pdf`)?</span></span> <span data-ttu-id="8c9d9-304">S kódem, který teď máme, se soubor User A s přepíše pomocí nahrávání uživatele B s.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-304">With the code we have now, User A s file will be overwritten with User B s upload.</span></span>

<span data-ttu-id="8c9d9-305">Existuje několik postupů pro řešení konfliktů názvů souborů.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-305">There are a number of techniques for resolving file name conflicts.</span></span> <span data-ttu-id="8c9d9-306">Jednou z možností je zakázat nahrávání souboru, pokud už existuje jeden se stejným názvem.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-306">One option is to prohibit uploading a file if there already exists one with the same name.</span></span> <span data-ttu-id="8c9d9-307">Když se v tomto postupu uživatel B pokusí odeslat soubor s názvem `Brochure.pdf`, systém ho neuloží a místo toho se zobrazí zpráva s oznámením, že soubor přejmenoval uživatel B, a zkuste to znovu.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-307">With this approach, when User B attempts to upload a file named `Brochure.pdf`, the system would not save their file and instead display a message informing User B to rename the file and try again.</span></span> <span data-ttu-id="8c9d9-308">Další možností je uložit soubor s jedinečným názvem souboru, což může být [globálně jedinečný identifikátor (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) nebo hodnota z odpovídajících sloupců záznamů databáze s primárními klíči (za předpokladu, že je odeslání přidruženo k určitému řádku v datovém modelu).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-308">Another approach is to save the file using a unique file name, which could be a [globally unique identifier (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) or the value from the corresponding database record s primary key column(s) (assuming that the upload is associated with a particular row in the data model).</span></span> <span data-ttu-id="8c9d9-309">V dalším kurzu podrobněji prozkoumáme tyto možnosti.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-309">In the next tutorial we'll explore these options in more detail.</span></span>

## <a name="challenges-involved-with-very-large-amounts-of-binary-data"></a><span data-ttu-id="8c9d9-310">Problémy související s velmi velkým objemem binárních dat</span><span class="sxs-lookup"><span data-stu-id="8c9d9-310">Challenges Involved with Very Large Amounts of Binary Data</span></span>

<span data-ttu-id="8c9d9-311">V těchto kurzech se předpokládá, že zaznamenaná binární data jsou velmi velmi velká.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-311">These tutorials assume that the binary data captured is modest in size.</span></span> <span data-ttu-id="8c9d9-312">Práce s velmi velkým objemem binárních datových souborů, které jsou v několika megabajtech nebo větší, přináší nové výzvy, které přesahují rámec těchto kurzů.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-312">Working with very large amounts of binary data files that are several megabytes or larger introduces new challenges that are beyond the scope of these tutorials.</span></span> <span data-ttu-id="8c9d9-313">Například ve výchozím nastavení ASP.NET odmítne odesílání více než 4 MB, i když lze nakonfigurovat prostřednictvím [elementu`<httpRuntime>`](https://msdn.microsoft.com/library/e1f13641.aspx) v `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-313">For example, by default ASP.NET will reject uploads of more than 4 MB, although this can be configured through the [`<httpRuntime>` element](https://msdn.microsoft.com/library/e1f13641.aspx) in `Web.config`.</span></span> <span data-ttu-id="8c9d9-314">Služba IIS ukládá i vlastní omezení velikosti nahrávání souborů.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-314">IIS imposes its own file upload size limitations, too.</span></span> <span data-ttu-id="8c9d9-315">Další informace najdete v tématu o [velikosti souboru pro nahrání služby IIS](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) .</span><span class="sxs-lookup"><span data-stu-id="8c9d9-315">See [IIS Upload File Size](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) for more information.</span></span> <span data-ttu-id="8c9d9-316">Kromě toho může čas potřebný k nahrání velkých souborů překročit výchozí 110 sekund, než se ASP.NET počká na požadavek.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-316">Furthermore, the time taken to upload large files might exceed the default 110 seconds ASP.NET will wait for a request.</span></span> <span data-ttu-id="8c9d9-317">K dispozici jsou také problémy s pamětí a výkonem, které vznikají při práci s velkými soubory.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-317">There are also memory and performance issues that arise when working with large files.</span></span>

<span data-ttu-id="8c9d9-318">Ovládací prvek nahrání souboru je nepraktický pro nahrávání velkých souborů.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-318">The FileUpload control is impractical for large file uploads.</span></span> <span data-ttu-id="8c9d9-319">Vzhledem k tomu, že se obsah souborů odesílá na server, musí koncový uživatel sami čekat bez potvrzení, že jejich nahrávání probíhá.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-319">As the file s contents are being posted to the server, the end user must patiently wait without any confirmation that their upload is progressing.</span></span> <span data-ttu-id="8c9d9-320">Nejedná se tedy o problém při práci s menšími soubory, které je možné nahrát během několika sekund, ale může se jednat o problém při práci s většími soubory, které mohou trvat déle než jedna minuta.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-320">This is not so much an issue when dealing with smaller files that can be uploaded in a few seconds, but can be an issue when dealing with larger files that may take minutes to upload.</span></span> <span data-ttu-id="8c9d9-321">Existují různé ovládací prvky pro nahrávání souborů třetích stran, které jsou vhodnější pro zpracování rozsáhlých nahrávání a mnohé z těchto dodavatelů poskytují indikátory průběhu a Správce nahrávání ActiveX, kteří představují mnohem pokročilejší prostředí pro uživatele.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-321">There are a variety of third-party file upload controls that are better suited for handling large uploads and many of these vendors provide progress indicators and ActiveX upload managers that present a much more polished user experience.</span></span>

<span data-ttu-id="8c9d9-322">Pokud vaše aplikace potřebuje zpracovat velké soubory, budete muset pečlivě prozkoumat výzvy a najít vhodná řešení pro vaše konkrétní potřeby.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-322">If your application needs to handle large files, you'll need to carefully investigate the challenges and find suitable solutions for your particular needs.</span></span>

## <a name="summary"></a><span data-ttu-id="8c9d9-323">Přehled</span><span class="sxs-lookup"><span data-stu-id="8c9d9-323">Summary</span></span>

<span data-ttu-id="8c9d9-324">Sestavování aplikace, která potřebuje zachytit binární data, zavádí řadu problémů.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-324">Building an application that needs to capture binary data introduces a number of challenges.</span></span> <span data-ttu-id="8c9d9-325">V tomto kurzu jsme prozkoumali první dvě: rozhodnutí, kam uložit binární data a umožníte uživateli nahrávat binární obsah prostřednictvím webové stránky.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-325">In this tutorial we explored the first two: deciding where to store the binary data and allowing a user to upload binary content through a web page.</span></span> <span data-ttu-id="8c9d9-326">V dalších třech kurzech se dozvíte, jak přidružit nahraná data k záznamu v databázi a jak zobrazit binární data společně s textovými datovými poli.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-326">Over the next three tutorials, we'll see how to associate the uploaded data with a record in the database as well as how to display the binary data alongside its text data fields.</span></span>

<span data-ttu-id="8c9d9-327">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="8c9d9-327">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="8c9d9-328">Další čtení</span><span class="sxs-lookup"><span data-stu-id="8c9d9-328">Further Reading</span></span>

<span data-ttu-id="8c9d9-329">Další informace o tématech popsaných v tomto kurzu najdete v následujících zdrojích informací:</span><span class="sxs-lookup"><span data-stu-id="8c9d9-329">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="8c9d9-330">Použití datových typů s velkými hodnotami</span><span class="sxs-lookup"><span data-stu-id="8c9d9-330">Using Large-Value Data Types</span></span>](https://msdn.microsoft.com/library/ms178158.aspx)
- [<span data-ttu-id="8c9d9-331">Rychlé zprovoznění ovládacího prvku nahrání souborů</span><span class="sxs-lookup"><span data-stu-id="8c9d9-331">FileUpload Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/fileupload.aspx)
- [<span data-ttu-id="8c9d9-332">Serverový ovládací prvek pro nahrávání souborů ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="8c9d9-332">The ASP.NET 2.0 FileUpload Server Control</span></span>](http://www.wrox.com/WileyCDA/Section/id-292158.html)
- [<span data-ttu-id="8c9d9-333">Tmavá strana nahrávání souborů</span><span class="sxs-lookup"><span data-stu-id="8c9d9-333">The Dark Side of File Uploads</span></span>](http://www.aspnetresources.com/articles/dark_side_of_file_uploads.aspx)

## <a name="about-the-author"></a><span data-ttu-id="8c9d9-334">O autorovi</span><span class="sxs-lookup"><span data-stu-id="8c9d9-334">About the Author</span></span>

<span data-ttu-id="8c9d9-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor 7 ASP/ASP. NET Books a zakladatel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8c9d9-336">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-336">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8c9d9-337">Nejnovější kniha je [*Sams naučit se ASP.NET 2,0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-337">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8c9d9-338">Dá se získat na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-338">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="8c9d9-339">nebo prostřednictvím svého blogu, který najdete na adrese [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="8c9d9-339">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="8c9d9-340">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="8c9d9-340">Special Thanks To</span></span>

<span data-ttu-id="8c9d9-341">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-341">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="8c9d9-342">Kontroloři vedoucích k tomuto kurzu byli Teresa Murphy a Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="8c9d9-342">Lead reviewers for this tutorial were Teresa Murphy and Bernadette Leigh.</span></span> <span data-ttu-id="8c9d9-343">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="8c9d9-343">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8c9d9-344">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-344">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="8c9d9-345">[Předchozí](updating-and-deleting-existing-binary-data-cs.md)
> [Další](displaying-binary-data-in-the-data-web-controls-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8c9d9-345">[Previous](updating-and-deleting-existing-binary-data-cs.md)
[Next](displaying-binary-data-in-the-data-web-controls-vb.md)</span></span>
