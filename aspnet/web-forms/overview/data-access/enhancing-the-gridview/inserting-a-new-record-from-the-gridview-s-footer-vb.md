---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: Vložení nového záznamu ze zápatí prvku GridView (VB) | Microsoft Docs
author: rick-anderson
description: I když ovládací prvek GridView neposkytuje integrovanou podporu pro vkládání nového záznamu dat, v tomto kurzu se dozvíte, jak rozšířit prvek GridView tak, aby zahrnoval...
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: 67ef370a90bc843f5c2da80bb43c8ef8de216b51
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78590466"
---
# <a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="0fb24-103">Vložení nového záznamu ze zápatí prvku GridView (VB)</span><span class="sxs-lookup"><span data-stu-id="0fb24-103">Inserting a New Record from the GridView's Footer (VB)</span></span>

<span data-ttu-id="0fb24-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0fb24-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0fb24-105">[Stáhnout ukázkovou aplikaci](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) nebo [Stáhnout PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0fb24-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="0fb24-106">I když ovládací prvek GridView neposkytuje integrovanou podporu pro vkládání nového záznamu dat, v tomto kurzu se dozvíte, jak rozšířit prvek GridView tak, aby zahrnoval rozhraní pro vložení.</span><span class="sxs-lookup"><span data-stu-id="0fb24-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="0fb24-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="0fb24-107">Introduction</span></span>

<span data-ttu-id="0fb24-108">Jak je popsáno v tématu [Přehled vložení, aktualizace a odstranění dat](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) , jednotlivé webové ovládací prvky GridView, DetailsView a FormView obsahují integrované možnosti změny dat.</span><span class="sxs-lookup"><span data-stu-id="0fb24-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="0fb24-109">Při použití s deklarativními ovládacími prvky zdroje dat lze tyto tři webové ovládací prvky rychle a snadno nakonfigurovat pro úpravu dat a ve scénářích, aniž byste museli psát jediný řádek kódu.</span><span class="sxs-lookup"><span data-stu-id="0fb24-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="0fb24-110">Bohužel pouze ovládací prvky DetailsView a FormView poskytují integrované možnosti vkládání, úprav a odstraňování.</span><span class="sxs-lookup"><span data-stu-id="0fb24-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="0fb24-111">Prvek GridView nabízí pouze úpravu a odstraňování podpory.</span><span class="sxs-lookup"><span data-stu-id="0fb24-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="0fb24-112">Nicméně s malým pravoúhlým odmašťování můžeme ovládací prvek GridView rozšířit tak, aby zahrnoval rozhraní pro vložení.</span><span class="sxs-lookup"><span data-stu-id="0fb24-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="0fb24-113">Při přidávání možností vkládání do prvku GridView zodpovídáme za rozhodování o tom, jak se přidávají nové záznamy, vytvoří se rozhraní pro vložení a napíše se kód pro vložení nového záznamu.</span><span class="sxs-lookup"><span data-stu-id="0fb24-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="0fb24-114">V tomto kurzu se podíváme na přidání rozhraní pro vložení do řádku zápatí GridView s (viz obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="0fb24-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="0fb24-115">Buňka zápatí pro každý sloupec obsahuje příslušný prvek uživatelského rozhraní pro shromažďování dat (textové pole pro název produktu, DropDownList pro dodavatele atd.).</span><span class="sxs-lookup"><span data-stu-id="0fb24-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="0fb24-116">Pro tlačítko Přidat potřebujeme také sloupec, který po kliknutí způsobí zpětné odeslání a vložení nového záznamu do tabulky `Products` pomocí hodnot zadaných v řádku zápatí.</span><span class="sxs-lookup"><span data-stu-id="0fb24-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>

<span data-ttu-id="0fb24-117">[![řádku zápatí poskytuje rozhraní pro přidávání nových produktů.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="0fb24-118">**Obrázek 1**: řádek zápatí poskytuje rozhraní pro přidání nových produktů ([kliknutím zobrazíte obrázek v plné velikosti).](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>

## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="0fb24-119">Krok 1: zobrazení informací o produktu v prvku GridView</span><span class="sxs-lookup"><span data-stu-id="0fb24-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="0fb24-120">Předtím, než se budeme věnovat dodržovali vytváření rozhraní pro vložení do zápatí GridView s, se nejprve nezapomeňte zaměřit na přidání prvku GridView na stránku, která obsahuje seznam produktů v databázi.</span><span class="sxs-lookup"><span data-stu-id="0fb24-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="0fb24-121">Začněte otevřením stránky `InsertThroughFooter.aspx` ve složce `EnhancedGridView` a přetažením prvku GridView z panelu nástrojů do návrháře, nastavením vlastnosti `ID` prvku GridView s `Products`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="0fb24-122">Dále použijte inteligentní značku GridView s pro svázání s novým prvkem ObjectDataSource s názvem `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>

<span data-ttu-id="0fb24-123">[![vytvořit nový prvek ObjectDataSource s názvem ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="0fb24-124">**Obrázek 2**: vytvoření nového prvku ObjectDataSource s názvem `ProductsDataSource` ([kliknutím zobrazíte obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="0fb24-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>

<span data-ttu-id="0fb24-125">Nakonfigurujte prvek ObjectDataSource pro použití metody `GetProducts()` `ProductsBLL` třídy s k načtení informací o produktu.</span><span class="sxs-lookup"><span data-stu-id="0fb24-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="0fb24-126">V tomto kurzu se zaměřujeme výhradně na přidávání možností vkládání a nedělejte si starosti s úpravami a odstraňováním.</span><span class="sxs-lookup"><span data-stu-id="0fb24-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="0fb24-127">Proto se ujistěte, že rozevírací seznam na kartě Vložení je nastaven na `AddProduct()` a že rozevírací seznamy na kartách aktualizovat a odstranit jsou nastaveny na hodnotu (žádné).</span><span class="sxs-lookup"><span data-stu-id="0fb24-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>

<span data-ttu-id="0fb24-128">[![namapovat metodu AddProduct na metodu ObjectDataSource s Insert ()](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="0fb24-129">**Obrázek 3**: namapujte metodu `AddProduct` na metodu `Insert()` ObjectDataSource s ([kliknutím zobrazíte obrázek v plné velikosti).](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>

<span data-ttu-id="0fb24-130">[![nastavení rozevíracích seznamů aktualizovat a odstranit na (žádné)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="0fb24-131">**Obrázek 4**: nastavení rozevíracích seznamů aktualizovat a odstranit na (žádné) ([kliknutím zobrazíte obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="0fb24-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>

<span data-ttu-id="0fb24-132">Po dokončení Průvodce přidáním zdroje dat v prvku ObjectDataSource pro sadu Visual Studio automaticky přidá pole do prvku GridView pro každé z odpovídajících datových polí.</span><span class="sxs-lookup"><span data-stu-id="0fb24-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="0fb24-133">Prozatím ponechte všechna pole přidaná v aplikaci Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0fb24-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="0fb24-134">Později v tomto kurzu se vrátíme a odebereme některá pole, jejichž hodnoty není potřeba zadat při přidávání nového záznamu.</span><span class="sxs-lookup"><span data-stu-id="0fb24-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="0fb24-135">Vzhledem k tomu, že databáze obsahuje blízko až 80 produktů, bude nutné, aby se uživatel přesunul do dolní části webové stránky, aby bylo možné přidat nový záznam.</span><span class="sxs-lookup"><span data-stu-id="0fb24-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="0fb24-136">Proto umožníme stránkování, aby bylo vkládání rozhraní lépe viditelné a dostupné.</span><span class="sxs-lookup"><span data-stu-id="0fb24-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="0fb24-137">Chcete-li zapnout stránkování, stačí zaškrtnout políčko Povolit stránkování z inteligentní značky GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="0fb24-138">V tomto okamžiku by deklarativní označení GridView a ObjectDataSource s měly vypadat podobně jako následující:</span><span class="sxs-lookup"><span data-stu-id="0fb24-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]

<span data-ttu-id="0fb24-139">[![všechna pole dat produktu se zobrazují ve stránkovém prvku GridView.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="0fb24-140">**Obrázek 5**: všechna pole dat produktu se zobrazují v stránkovaném prvku GridView ([kliknutím zobrazíte obrázek v plné velikosti).](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>

## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="0fb24-141">Krok 2: Přidání řádku zápatí</span><span class="sxs-lookup"><span data-stu-id="0fb24-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="0fb24-142">Spolu s jeho řádky záhlaví a dat obsahuje prvek GridView řádek zápatí.</span><span class="sxs-lookup"><span data-stu-id="0fb24-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="0fb24-143">Řádky záhlaví a zápatí se zobrazí v závislosti na hodnotách [`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx) a [`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx) vlastností prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="0fb24-144">Chcete-li zobrazit řádek zápatí, jednoduše nastavte vlastnost `ShowFooter` na hodnotu `True`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="0fb24-145">Jak ukazuje obrázek 6, nastavení vlastnosti `ShowFooter` na `True` přidá do mřížky řádek zápatí.</span><span class="sxs-lookup"><span data-stu-id="0fb24-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>

<span data-ttu-id="0fb24-146">[![pro zobrazení řádku zápatí nastavte ShowFooter na hodnotu true.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="0fb24-147">**Obrázek 6**: Chcete-li zobrazit řádek zápatí, nastavte `ShowFooter` na `True` ([kliknutím zobrazíte obrázek v plné velikosti).](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>

<span data-ttu-id="0fb24-148">Všimněte si, že řádek zápatí má tmavě červenou barvu pozadí.</span><span class="sxs-lookup"><span data-stu-id="0fb24-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="0fb24-149">Důvodem je motiv DataWebControls, který jsme vytvořili a použili na všechny stránky zpátky v kurzu [zobrazení dat s](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) využitím prvku ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0fb24-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="0fb24-150">Konkrétně soubor `GridView.skin` konfiguruje vlastnost `FooterStyle`, která používá třídu `FooterStyle` šablony stylů CSS.</span><span class="sxs-lookup"><span data-stu-id="0fb24-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="0fb24-151">Třída `FooterStyle` je definována v `Styles.css` následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="0fb24-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>

[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="0fb24-152">V předchozích kurzech jsme prozkoumali pomocí řádku zápatí GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="0fb24-153">V případě potřeby se vraťte k [zobrazení souhrnných informací v](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) kurzu pro aktualizační program v části zápatí prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>

<span data-ttu-id="0fb24-154">Po nastavení vlastnosti `ShowFooter` na `True`chvíli počkejte, než se výstup zobrazí v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="0fb24-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="0fb24-155">V současné době se v řádku zápatí neobsahují žádné textové ani webové ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="0fb24-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="0fb24-156">V kroku 3 Upravme zápatí pro každé pole GridView tak, aby obsahovalo příslušné rozhraní pro vložení.</span><span class="sxs-lookup"><span data-stu-id="0fb24-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>

<span data-ttu-id="0fb24-157">[![prázdného řádku zápatí se zobrazí nad ovládacími prvky rozhraní stránkování.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="0fb24-158">**Obrázek 7**: prázdný řádek zápatí se zobrazí nad ovládacími prvky rozhraní stránkování ([kliknutím zobrazíte obrázek v plné velikosti).](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>

## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="0fb24-159">Krok 3: přizpůsobení řádku zápatí</span><span class="sxs-lookup"><span data-stu-id="0fb24-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="0fb24-160">Zpět v kurzu [použití templatefields v kurzu ovládacího prvku GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) jsme viděli, jak významně přizpůsobit zobrazení konkrétního sloupce GridView pomocí templatefields (na rozdíl od BoundFields nebo CheckBoxFields); v [části přizpůsobení rozhraní pro úpravu dat](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) jsme se vyhledali pomocí vlastností templatefields k přizpůsobení rozhraní pro úpravy v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="0fb24-161">Odvolání, že TemplateField se skládá z několika šablon, které definují kombinaci značek, webových ovládacích prvků a syntaxe datových vazeb použitých pro určité typy řádků.</span><span class="sxs-lookup"><span data-stu-id="0fb24-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="0fb24-162">`ItemTemplate`například určuje šablonu použitou pro řádky jen pro čtení, zatímco `EditItemTemplate` definuje šablonu pro upravitelný řádek.</span><span class="sxs-lookup"><span data-stu-id="0fb24-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="0fb24-163">Společně s `ItemTemplate` a `EditItemTemplate`pole TemplateField také obsahuje `FooterTemplate`, které určuje obsah pro řádek zápatí.</span><span class="sxs-lookup"><span data-stu-id="0fb24-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="0fb24-164">Proto můžeme přidat webové ovládací prvky, které jsou potřeba pro každé pole vkládání rozhraní do `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="0fb24-165">Chcete-li začít, převeďte všechna pole v prvku GridView na TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="0fb24-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="0fb24-166">To lze provést kliknutím na odkaz Upravit sloupce v inteligentní značce GridView s, výběrem každého pole v levém dolním rohu a kliknutím na tlačítko převést toto pole na odkaz TemplateField.</span><span class="sxs-lookup"><span data-stu-id="0fb24-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>

![Převést každé pole na TemplateField](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="0fb24-168">**Obrázek 8**: převod každého pole na TemplateField</span><span class="sxs-lookup"><span data-stu-id="0fb24-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>

<span data-ttu-id="0fb24-169">Kliknutím na tlačítko převést toto pole na TemplateField dojde k zapínání aktuálního typu pole do ekvivalentní hodnoty TemplateField.</span><span class="sxs-lookup"><span data-stu-id="0fb24-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="0fb24-170">Například každá vlastnost BoundField je nahrazena vlastností TemplateField s `ItemTemplate`, která obsahuje popisek, který zobrazuje příslušné datové pole a `EditItemTemplate`, které zobrazuje datové pole v textovém poli.</span><span class="sxs-lookup"><span data-stu-id="0fb24-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="0fb24-171">`ProductName` vlastnost BoundField byl převeden na následující značky TemplateField:</span><span class="sxs-lookup"><span data-stu-id="0fb24-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="0fb24-172">Podobně `Discontinued` třídě CheckBoxField podporována byl převeden na TemplateField, jehož `ItemTemplate` a `EditItemTemplate` obsahují webový ovládací prvek CheckBox (s políčkem `ItemTemplate` s zakázáním).</span><span class="sxs-lookup"><span data-stu-id="0fb24-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="0fb24-173">Vlastnost BoundField `ProductID` jen pro čtení bylo převedeno na TemplateField s ovládacím prvkem popisek v `ItemTemplate` a `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="0fb24-174">V krátkém případě převod existujícího pole GridView na TemplateField je rychlý a snadný způsob, jak přepnout na více přizpůsobitelného TemplateField, aniž by došlo ke ztrátě všech existujících funkcí polí.</span><span class="sxs-lookup"><span data-stu-id="0fb24-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="0fb24-175">Vzhledem k tomu, že komponenta GridView, kterou jsme provedli, jsme si nemuseli upravovat podporu, nebojte se `EditItemTemplate` z každého pole TemplateField a opouštíte jenom `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="0fb24-176">Po provedení tohoto postupu by deklarativní označení GridView s mělo vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="0fb24-176">After doing this, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="0fb24-177">Teď, když se každé pole GridView převede na TemplateField, můžeme do každého pole s `FooterTemplate`zadat příslušné rozhraní pro vložení.</span><span class="sxs-lookup"><span data-stu-id="0fb24-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="0fb24-178">Některá pole nebudou mít rozhraní pro vložení (`ProductID`, například). ostatní se budou lišit ve webových ovládacích prvcích používaných ke shromažďování nových informací o produktech.</span><span class="sxs-lookup"><span data-stu-id="0fb24-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="0fb24-179">Chcete-li vytvořit rozhraní pro úpravy, vyberte odkaz Upravit šablony z inteligentní značky GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="0fb24-180">Pak v rozevíracím seznamu vyberte odpovídající pole `FooterTemplate` a přetáhněte příslušný ovládací prvek z panelu nástrojů do návrháře.</span><span class="sxs-lookup"><span data-stu-id="0fb24-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>

<span data-ttu-id="0fb24-181">[![do každého pole s šablona FooterTemplate přidejte příslušné rozhraní pro vložení.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="0fb24-182">**Obrázek 9**: Přidejte příslušné rozhraní pro vložení do každého pole s `FooterTemplate` ([kliknutím zobrazíte obrázek v plné velikosti).](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>

<span data-ttu-id="0fb24-183">Následující seznam s odrážkami vypíše pole GridView a určí rozhraní pro vložení, které se má přidat:</span><span class="sxs-lookup"><span data-stu-id="0fb24-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="0fb24-184">`ProductID` žádné.</span><span class="sxs-lookup"><span data-stu-id="0fb24-184">`ProductID` none.</span></span>
- <span data-ttu-id="0fb24-185">`ProductName` přidejte textové pole a nastavte jeho `ID` na `NewProductName`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="0fb24-186">Přidejte ovládací prvek RequiredFieldValidator a zajistěte, aby uživatel zadal hodnotu pro nový název produktu.</span><span class="sxs-lookup"><span data-stu-id="0fb24-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="0fb24-187">`SupplierID` žádné.</span><span class="sxs-lookup"><span data-stu-id="0fb24-187">`SupplierID` none.</span></span>
- <span data-ttu-id="0fb24-188">`CategoryID` žádné.</span><span class="sxs-lookup"><span data-stu-id="0fb24-188">`CategoryID` none.</span></span>
- <span data-ttu-id="0fb24-189">`QuantityPerUnit` přidejte textové pole a nastavte jeho `ID` na `NewQuantityPerUnit`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="0fb24-190">`UnitPrice` přidat textové pole s názvem `NewUnitPrice` a CompareValidator, které zajistí, že zadaná hodnota je hodnota měny větší nebo rovna nule.</span><span class="sxs-lookup"><span data-stu-id="0fb24-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="0fb24-191">`UnitsInStock` použít textové pole, jehož `ID` je nastavené na `NewUnitsInStock`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="0fb24-192">Zahrňte CompareValidator, který zajistí, že zadaná hodnota je celočíselná hodnota větší nebo rovna nule.</span><span class="sxs-lookup"><span data-stu-id="0fb24-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="0fb24-193">`UnitsOnOrder` použít textové pole, jehož `ID` je nastavené na `NewUnitsOnOrder`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="0fb24-194">Zahrňte CompareValidator, který zajistí, že zadaná hodnota je celočíselná hodnota větší nebo rovna nule.</span><span class="sxs-lookup"><span data-stu-id="0fb24-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="0fb24-195">`ReorderLevel` použít textové pole, jehož `ID` je nastavené na `NewReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="0fb24-196">Zahrňte CompareValidator, který zajistí, že zadaná hodnota je celočíselná hodnota větší nebo rovna nule.</span><span class="sxs-lookup"><span data-stu-id="0fb24-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="0fb24-197">`Discontinued` přidejte zaškrtávací políčko a nastavte jeho `ID` na `NewDiscontinued`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="0fb24-198">`CategoryName` přidejte objekt DropDownList a nastavte jeho `ID` na `NewCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="0fb24-199">Navažte ji na nový prvek ObjectDataSource s názvem `CategoriesDataSource` a nakonfigurujte ho tak, aby používal metodu `GetCategories()` `CategoriesBLL` třídy s.</span><span class="sxs-lookup"><span data-stu-id="0fb24-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="0fb24-200">Mít `ListItem` DropDownList s, zobrazí `CategoryName` data pole, a to jako jejich hodnoty pomocí pole `CategoryID` data.</span><span class="sxs-lookup"><span data-stu-id="0fb24-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="0fb24-201">`SupplierName` přidejte objekt DropDownList a nastavte jeho `ID` na `NewSupplierID`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="0fb24-202">Navažte ji na nový prvek ObjectDataSource s názvem `SuppliersDataSource` a nakonfigurujte ho tak, aby používal metodu `GetSuppliers()` `SuppliersBLL` třídy s.</span><span class="sxs-lookup"><span data-stu-id="0fb24-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="0fb24-203">Mít `ListItem` DropDownList s, zobrazí `CompanyName` data pole, a to jako jejich hodnoty pomocí pole `SupplierID` data.</span><span class="sxs-lookup"><span data-stu-id="0fb24-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="0fb24-204">Pro každé ovládací prvky ověřování zrušte zaškrtnutí vlastnosti `ForeColor` tak, aby se místo výchozí červené hodnoty popředí `FooterStyle` třídy CSS Class s používala bílá barva popředí.</span><span class="sxs-lookup"><span data-stu-id="0fb24-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="0fb24-205">Pro podrobný popis také použijte vlastnost `ErrorMessage`, ale nastavte vlastnost `Text` na hvězdičku.</span><span class="sxs-lookup"><span data-stu-id="0fb24-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="0fb24-206">Chcete-li zabránit tomu, aby text ovládacího prvku ověřování způsobil přebalení rozhraní vložení na dva řádky, nastavte vlastnost `FooterStyle` s `Wrap` na hodnotu false pro každý `FooterTemplate` s, který používá ovládací prvek ověřování.</span><span class="sxs-lookup"><span data-stu-id="0fb24-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="0fb24-207">Nakonec přidejte ovládací prvek ovládací souhrnu ověření pod prvek GridView a nastavte jeho vlastnost `ShowMessageBox` na `True` a jeho vlastnost `ShowSummary` na `False`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="0fb24-208">Když přidáváte nový produkt, musíme zadat `CategoryID` a `SupplierID`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="0fb24-209">Tyto informace jsou zachyceny prostřednictvím ovládacích prvků DropDownList v buňkách zápatí pro pole `CategoryName` a `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="0fb24-210">Rozhodli jste se použít tato pole na rozdíl od `CategoryID` a `SupplierID` TemplateFields, protože v řádcích s daty gridu se uživatel pravděpodobně lépe zajímá, aby zobrazil názvy kategorií a dodavatelů, nikoli jejich hodnoty ID.</span><span class="sxs-lookup"><span data-stu-id="0fb24-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="0fb24-211">Vzhledem k tomu, že hodnoty `CategoryID` a `SupplierID` jsou nyní zaznamenávány do `CategoryName` a `SupplierName` pole pro vkládání rozhraní, můžeme odebrat `CategoryID` a `SupplierID` TemplateFields z prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="0fb24-212">Obdobně se `ProductID` nepoužívá při přidávání nového produktu, takže je možné také odebrat `ProductID` TemplateField.</span><span class="sxs-lookup"><span data-stu-id="0fb24-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="0fb24-213">Ale nechte pole `ProductID` v mřížce.</span><span class="sxs-lookup"><span data-stu-id="0fb24-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="0fb24-214">Kromě textových polí, DropDownList, zaškrtávacích políček a ověřovacích ovládacích prvků, které tvoří rozhraní pro vložení, budete potřebovat také tlačítko Přidat, které po kliknutí provede logiku pro přidání nového produktu do databáze.</span><span class="sxs-lookup"><span data-stu-id="0fb24-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="0fb24-215">V kroku 4 přidáme tlačítko Přidat do rozhraní pro vložení v `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="0fb24-216">Nebojte se zlepšit vzhled různých polí GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="0fb24-217">Například můžete chtít naformátovat `UnitPrice` hodnoty jako měnu, Zarovnat pole `UnitsInStock`, `UnitsOnOrder`a `ReorderLevel` a aktualizovat `HeaderText` hodnoty pro pole TemplateField.</span><span class="sxs-lookup"><span data-stu-id="0fb24-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="0fb24-218">Po vytvoření slew pro vkládání rozhraní v `FooterTemplate` s, odebrání `SupplierID`a `CategoryID` TemplateFields a zlepšení estetickosti mřížky prostřednictvím formátování a zarovnání TemplateFields by vaše deklarativní značky GridViewu měly vypadat podobně jako následující:</span><span class="sxs-lookup"><span data-stu-id="0fb24-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="0fb24-219">Při prohlížení v prohlížeči teď řádek zápatí prvku GridView. obsahuje dokončené rozhraní vložení (viz obrázek 10).</span><span class="sxs-lookup"><span data-stu-id="0fb24-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="0fb24-220">V tomto okamžiku vložení rozhraní nezahrnuje prostředek pro uživatele, který indikuje, že zadal data pro nový produkt a chce do databáze vložit nový záznam.</span><span class="sxs-lookup"><span data-stu-id="0fb24-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="0fb24-221">I když jsme ještě zjistili, jak se data zadaná do zápatí budou překládat do nového záznamu v databázi `Products`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="0fb24-222">V kroku 4 se podíváme na to, jak zahrnout tlačítko Přidat do rozhraní pro vkládání a jak spustit kód při zpětném volání, když se na něj klikne.</span><span class="sxs-lookup"><span data-stu-id="0fb24-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="0fb24-223">Krok 5 ukazuje, jak vložit nový záznam pomocí dat z zápatí.</span><span class="sxs-lookup"><span data-stu-id="0fb24-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>

<span data-ttu-id="0fb24-224">[![zápatí prvku GridView poskytuje rozhraní pro přidání nového záznamu.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="0fb24-225">**Obrázek 10**: zápatí prvku GridView poskytuje rozhraní pro přidání nového záznamu ([kliknutím zobrazíte obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png)).</span><span class="sxs-lookup"><span data-stu-id="0fb24-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>

## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="0fb24-226">Krok 4: zahrnutí tlačítka Přidat do rozhraní pro vložení</span><span class="sxs-lookup"><span data-stu-id="0fb24-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="0fb24-227">Do rozhraní pro vkládání musíme vložit tlačítko Přidat, protože rozhraní pro vložení řádku zápatí v tuto chvíli neobsahuje prostředky pro uživatele, aby označovali, že dokončili zadávání informací o novém produktu.</span><span class="sxs-lookup"><span data-stu-id="0fb24-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="0fb24-228">To může být umístěno v jednom z existujících `FooterTemplate` s nebo do mřížky pro tento účel přidat nový sloupec.</span><span class="sxs-lookup"><span data-stu-id="0fb24-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="0fb24-229">Pro tento kurz přidejte tlačítko Přidat do `ProductID` TemplateField `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="0fb24-230">V návrháři klikněte na odkaz Upravit šablony v inteligentní značce GridView s a pak v rozevíracím seznamu zvolte `ProductID` pole s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="0fb24-231">Přidejte webový ovládací prvek tlačítko (nebo objekt LinkButton nebo obrázkové, pokud dáváte přednost) k šabloně, nastavení jeho ID na hodnotu `AddProduct`, jeho `CommandName` pro vložení a jeho vlastnost `Text` k přidání, jak je znázorněno na obrázku 11.</span><span class="sxs-lookup"><span data-stu-id="0fb24-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>

<span data-ttu-id="0fb24-232">[![umístit tlačítko Přidat do pole ProductID TemplateField s šablona FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="0fb24-233">**Obrázek 11**: Vložte tlačítko přidat do `ProductID` TemplateField s `FooterTemplate` ([kliknutím zobrazíte obrázek v plné velikosti).](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>

<span data-ttu-id="0fb24-234">Až budete mít tlačítko Přidat, otestujte stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="0fb24-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="0fb24-235">Všimněte si, že když kliknete na tlačítko Přidat s neplatnými daty v rozhraní pro vložení, zpětné volání je krátké a ovládací prvek ovládací souhrnu ověření indikuje neplatná data (viz obrázek 12).</span><span class="sxs-lookup"><span data-stu-id="0fb24-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="0fb24-236">Po zadání příslušných dat se kliknutím na tlačítko Přidat vyvolá postback.</span><span class="sxs-lookup"><span data-stu-id="0fb24-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="0fb24-237">Do databáze se ale nepřidá žádný záznam.</span><span class="sxs-lookup"><span data-stu-id="0fb24-237">No record is added to the database, however.</span></span> <span data-ttu-id="0fb24-238">Abychom mohli vkládat, budete muset napsat bitovou kopii kódu.</span><span class="sxs-lookup"><span data-stu-id="0fb24-238">We will need to write a bit of code to actually perform the insert.</span></span>

<span data-ttu-id="0fb24-239">[![tlačítko Přidat s zpětným voláním je krátké, pokud v rozhraní pro vkládání nejsou platná data.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="0fb24-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="0fb24-240">**Obrázek 12**: v případě, že je v rozhraní pro vkládání neplatné nějaké údaje ([kliknutím zobrazíte obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png)), je tlačítko Přidat a zpět v případě neplatných.</span><span class="sxs-lookup"><span data-stu-id="0fb24-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="0fb24-241">Ovládací prvky ověřování v rozhraní vložení nebyly přiřazeny ke skupině ověření.</span><span class="sxs-lookup"><span data-stu-id="0fb24-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="0fb24-242">To funguje, pokud je rozhraní pro vkládání jedinou sadou ověřovacích ovládacích prvků na stránce.</span><span class="sxs-lookup"><span data-stu-id="0fb24-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="0fb24-243">Pokud jsou však na stránce k dispozici další ovládací prvky ověřování (například ovládací prvky ověřování v rozhraní pro úpravy gridu), měla by být ovládacím prvkům pro vložení rozhraní a tlačítku Přidat `ValidationGroup` vlastností přiřazena stejná hodnota, aby bylo možné tyto ovládací prvky přidružit ke konkrétní skupině ověření.</span><span class="sxs-lookup"><span data-stu-id="0fb24-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="0fb24-244">Další informace o dělení ověřovacích ovládacích prvků a tlačítek na stránce do ověřovacích skupin naleznete v tématu [deprotínající ovládací prvky ověřování v ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) .</span><span class="sxs-lookup"><span data-stu-id="0fb24-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>

## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="0fb24-245">Krok 5: vložení nového záznamu do`Products`tabulky</span><span class="sxs-lookup"><span data-stu-id="0fb24-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="0fb24-246">Při použití vestavěných funkcí úprav ovládacího prvku GridView, prvek GridView automaticky zpracuje veškerou práci potřebnou k aktualizaci.</span><span class="sxs-lookup"><span data-stu-id="0fb24-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="0fb24-247">Zejména při kliknutí na tlačítko Aktualizovat kopíruje hodnoty zadané z rozhraní pro úpravy do parametrů v kolekci ObjectDataSource `UpdateParameters` Collection a zahájí aktualizaci vyvoláním metody ObjectDataSource s `Update()`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="0fb24-248">Vzhledem k tomu, že prvek GridView neposkytuje integrovanou funkcionalitu pro vkládání, je nutné implementovat kód, který volá metodu ObjectDataSource s `Insert()` a kopíruje hodnoty z rozhraní pro vložení do kolekce ObjectDataSource s `InsertParameters`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="0fb24-249">Tato logika vložení by měla být provedena po kliknutí na tlačítko Přidat.</span><span class="sxs-lookup"><span data-stu-id="0fb24-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="0fb24-250">Jak je popsáno v kurzu [přidávání a reagování na tlačítka v](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) prvku GridView, je kliknutí na tlačítko, LinkButton nebo obrázkové v prvku GridView, událost GridView `RowCommand`, která se aktivuje při zpětném volání.</span><span class="sxs-lookup"><span data-stu-id="0fb24-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="0fb24-251">Tato událost aktivuje, zda bylo tlačítko, LinkButton nebo obrázkové přidáno explicitně, například tlačítko Přidat v řádku zápatí, nebo zda bylo automaticky přidáno prvek GridView (například LinkButtons v horní části každého sloupce, pokud je vybrána možnost Povolit řazení), nebo LinkButtons v rozhraní stránkování, pokud je vybráno možnost Povolit stránkování).</span><span class="sxs-lookup"><span data-stu-id="0fb24-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="0fb24-252">Proto pokud chcete reagovat na uživatele kliknutím na tlačítko Přidat, musíme vytvořit obslužnou rutinu události pro `RowCommand` událost GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="0fb24-253">Vzhledem k tomu, že se tato událost aktivuje *vždy, když se* klikne na tlačítko, LinkButton nebo obrázkové v prvku GridView, je důležité, abyste pokračovali pouze s logikou vložení, pokud vlastnost `CommandName` předaná do obslužné rutiny události mapuje na `CommandName` hodnotu tlačítka Přidat (vložit).</span><span class="sxs-lookup"><span data-stu-id="0fb24-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="0fb24-254">Kromě toho by měl být také pokračovat pouze v případě, že ovládací prvky ověřování vykazují platná data.</span><span class="sxs-lookup"><span data-stu-id="0fb24-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="0fb24-255">Chcete-li to přizpůsobit, vytvořte obslužnou rutinu události pro událost `RowCommand` s následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="0fb24-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="0fb24-256">Může dojít k zajímání, proč obslužná rutina události kontroluje vlastnost `Page.IsValid`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="0fb24-257">Po všech nebudete moct postback potlačit, pokud v rozhraní pro vkládání nejsou k dispozici neplatná data?</span><span class="sxs-lookup"><span data-stu-id="0fb24-257">After all, won't the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="0fb24-258">Tento předpoklad je správný, dokud uživatel nezakázal JavaScript nebo neučinil kroky pro obcházení logiky ověřování na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="0fb24-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="0fb24-259">V krátkém případě by se jedna neměla spoléhat výhradně na ověřování na straně klienta; před prací s daty by měla být vždy provedena kontrolu platnosti na straně serveru.</span><span class="sxs-lookup"><span data-stu-id="0fb24-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>

<span data-ttu-id="0fb24-260">V kroku 1 jsme vytvořili `ProductsDataSource` ObjectDataSource tak, že jeho `Insert()` metoda je namapována na `AddProduct` metodu `ProductsBLL` třídy s.</span><span class="sxs-lookup"><span data-stu-id="0fb24-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="0fb24-261">Pro vložení nového záznamu do tabulky `Products` můžeme jednoduše vyvolat metodu `Insert()` ObjectDataSource s:</span><span class="sxs-lookup"><span data-stu-id="0fb24-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="0fb24-262">Nyní, když byla vyvolána metoda `Insert()`, vše zůstává ke zkopírování hodnot z rozhraní pro vložení do parametrů předaných metodě `AddProduct` `ProductsBLL` třídy s.</span><span class="sxs-lookup"><span data-stu-id="0fb24-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="0fb24-263">Jak jsme se vrátili při [zkoumání událostí spojených s kurzem vložení, aktualizace a odstranění](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) , můžete to provést prostřednictvím události ObjectDataSource `Inserting`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="0fb24-264">V `Inserting` události potřebujeme programově odkazovat na ovládací prvky z řádku zápatí `Products` GridView s a přiřadit jejich hodnoty do kolekce `e.InputParameters`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="0fb24-265">Pokud uživatel vynechá hodnotu, třeba když necháte pole `ReorderLevel` prázdné pole, je nutné zadat, aby byla hodnota vložená do databáze `NULL`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="0fb24-266">Vzhledem k tomu, že metoda `AddProducts` akceptuje typy s možnou hodnotou null pro pole databáze s možnou hodnotou null, stačí použít typ s možnou hodnotou null a nastavit jeho hodnotu na `Nothing` v případě vynechání vstupu uživatele.</span><span class="sxs-lookup"><span data-stu-id="0fb24-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="0fb24-267">Když je obslužná rutina události `Inserting` dokončená, dají se do tabulky databáze `Products` přidat nové záznamy přes řádek zápatí GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="0fb24-268">Pokračujte a zkuste přidat několik nových produktů.</span><span class="sxs-lookup"><span data-stu-id="0fb24-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="0fb24-269">Vylepšení a přizpůsobení operace přidání</span><span class="sxs-lookup"><span data-stu-id="0fb24-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="0fb24-270">V současné době kliknutím na tlačítko Přidat přidáte nový záznam do tabulky databáze, ale neposkytnete žádný druh vizuální zpětné vazby, který záznam úspěšně přidal.</span><span class="sxs-lookup"><span data-stu-id="0fb24-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="0fb24-271">V ideálním případě by okno popisek webového ovládacího prvku nebo upozornění na straně klienta informovalo uživatele o tom, že jejich vložení bylo úspěšné.</span><span class="sxs-lookup"><span data-stu-id="0fb24-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="0fb24-272">Tuto funkci mám jako cvičení pro čtenáře.</span><span class="sxs-lookup"><span data-stu-id="0fb24-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="0fb24-273">Prvek GridView použitý v tomto kurzu nepoužívá pro uvedené produkty žádné pořadí řazení, ani neumožňuje koncovému uživateli data seřadit.</span><span class="sxs-lookup"><span data-stu-id="0fb24-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="0fb24-274">V důsledku toho jsou záznamy seřazeny tak, jak jsou v databázi, podle jejich primárního pole klíče.</span><span class="sxs-lookup"><span data-stu-id="0fb24-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="0fb24-275">Vzhledem k tomu, že každý nový záznam má `ProductID` hodnotu větší než poslední, pokaždé, když se přidá nový produkt, se směruje na konec mřížky.</span><span class="sxs-lookup"><span data-stu-id="0fb24-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="0fb24-276">Proto může být vhodné po přidání nového záznamu automaticky odeslat uživatele na poslední stránku prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="0fb24-277">To lze provést přidáním následujícího řádku kódu po volání `ProductsDataSource.Insert()` v obslužné rutině události `RowCommand` pro indikaci, že uživatel musí být odeslán na poslední stránku po vytvoření vazby dat na prvek GridView:</span><span class="sxs-lookup"><span data-stu-id="0fb24-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="0fb24-278">`SendUserToLastPage` je logická proměnná na úrovni stránky, která má zpočátku přiřazenou hodnotu `False`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="0fb24-279">V obslužné rutině `DataBound` ovládacího prvku GridView, pokud je `SendUserToLastPage` false, je vlastnost `PageIndex` aktualizována tak, aby odesílala uživatele na poslední stránku.</span><span class="sxs-lookup"><span data-stu-id="0fb24-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="0fb24-280">Důvod, proč je nastavena vlastnost `PageIndex` v obslužné rutině události `DataBound` (na rozdíl od obslužné rutiny události `RowCommand`) je, že když obslužná rutina události `RowCommand` aktivuje, je to proto, že jsme ještě do tabulky `Products`ch databází přidali nový záznam.</span><span class="sxs-lookup"><span data-stu-id="0fb24-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="0fb24-281">Proto v obslužné rutině události `RowCommand` poslední index stránky (`PageCount - 1`) představuje poslední index stránky *před* přidáním nového produktu.</span><span class="sxs-lookup"><span data-stu-id="0fb24-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="0fb24-282">Pro většinu přidávaných produktů je poslední index stránky stejný po přidání nového produktu.</span><span class="sxs-lookup"><span data-stu-id="0fb24-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="0fb24-283">Pokud ale přidaný produkt vede k novému indexu poslední stránky, pokud jsme `PageIndex` v obslužné rutině události `RowCommand` nesprávně aktualizovali pak budeme považovat za druhý na poslední stránku (poslední index stránky před přidáním nového produktu), a to na rozdíl od nového indexu poslední stránky.</span><span class="sxs-lookup"><span data-stu-id="0fb24-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="0fb24-284">Vzhledem k tomu, že se obslužná rutina události `DataBound` aktivuje poté, co se přidá nový produkt a data se předají do mřížky, nastavím vlastnost `PageIndex`, že máme znovu napravo správné indexu poslední stránky.</span><span class="sxs-lookup"><span data-stu-id="0fb24-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="0fb24-285">Nakonec je ovládací prvek GridView použitý v tomto kurzu poměrně velký v důsledku počtu polí, která musí být shromažďována pro přidání nového produktu.</span><span class="sxs-lookup"><span data-stu-id="0fb24-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="0fb24-286">Vzhledem k této šířce může být upřednostňováno svislé rozložení ovládacího prvku DetailsView s.</span><span class="sxs-lookup"><span data-stu-id="0fb24-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="0fb24-287">Celkovou šířku prvku GridView s lze snížit shromažďováním menšího počtu vstupů.</span><span class="sxs-lookup"><span data-stu-id="0fb24-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="0fb24-288">Možná nepotřebujeme při přidávání nového produktu shromažďovat pole `UnitsOnOrder`, `UnitsInStock`a `ReorderLevel`. v takovém případě je možné tato pole odebrat z prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="0fb24-289">Pro úpravu shromažďovaných dat můžeme použít jeden ze dvou přístupů:</span><span class="sxs-lookup"><span data-stu-id="0fb24-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="0fb24-290">Pokračujte v použití metody `AddProduct`, která očekává hodnoty pro pole `UnitsOnOrder`, `UnitsInStock`a `ReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="0fb24-291">V obslužné rutině události `Inserting` poskytují pevně zakódované výchozí hodnoty, které se použijí pro tyto vstupy, které byly odebrány z rozhraní pro vložení.</span><span class="sxs-lookup"><span data-stu-id="0fb24-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="0fb24-292">Vytvořte nové přetížení metody `AddProduct` ve třídě `ProductsBLL`, která nepřijímá vstupy pro pole `UnitsOnOrder`, `UnitsInStock`a `ReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="0fb24-293">Pak na stránce ASP.NET nakonfigurujte prvek ObjectDataSource tak, aby používal toto nové přetížení.</span><span class="sxs-lookup"><span data-stu-id="0fb24-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="0fb24-294">Obě možnosti budou fungovat i stejně.</span><span class="sxs-lookup"><span data-stu-id="0fb24-294">Either option will work equally as well.</span></span> <span data-ttu-id="0fb24-295">V minulých kurzech jsme použili druhou možnost a vytvořením několika přetížení pro metodu `ProductsBLL` třídy s `UpdateProduct`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="0fb24-296">Souhrn</span><span class="sxs-lookup"><span data-stu-id="0fb24-296">Summary</span></span>

<span data-ttu-id="0fb24-297">V prvku GridView chybí vestavěné možnosti vkládání nalezené v ovládacím prvku DetailsView a FormView, ale s mikroúsilím je možné přidat rozhraní vložení do řádku zápatí.</span><span class="sxs-lookup"><span data-stu-id="0fb24-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="0fb24-298">Chcete-li zobrazit řádek zápatí v prvku GridView, stačí nastavit jeho vlastnost `ShowFooter` na hodnotu `True`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="0fb24-299">Obsah řádku zápatí lze přizpůsobit pro každé pole tak, že převede pole na TemplateField a přidáte rozhraní pro vložení do `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="0fb24-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="0fb24-300">Jak jsme viděli v tomto kurzu, `FooterTemplate` mohou obsahovat tlačítka, textová pole, DropDownList, zaškrtávací políčka a ovládací prvky zdroje dat pro vyplnění datových ovládacích prvků řízených daty (například DropDownList) a ověřovací ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="0fb24-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="0fb24-301">Společně s ovládacími prvky pro shromažďování vstupu uživatele, je třeba přidat tlačítko Přidat, LinkButton nebo obrázkové.</span><span class="sxs-lookup"><span data-stu-id="0fb24-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="0fb24-302">Po kliknutí na tlačítko Přidat je vyvolána metoda ObjectDataSource s `Insert()` k zahájení vkládání pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="0fb24-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="0fb24-303">Prvek ObjectDataSource pak zavolá nakonfigurovanou metodu Insert (metoda `ProductsBLL` třídy s `AddProduct` v tomto kurzu).</span><span class="sxs-lookup"><span data-stu-id="0fb24-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="0fb24-304">Před vyvoláním metody Insert je nutné zkopírovat hodnoty z rozhraní GridView s `InsertParameters` do kolekce ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="0fb24-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="0fb24-305">To lze provést programově odkazování na webové ovládací prvky rozhraní v prvku ObjectDataSource s `Inserting` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="0fb24-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="0fb24-306">V tomto kurzu se dokončí náš pohled na techniky pro vylepšení vzhledu prvků GridView.</span><span class="sxs-lookup"><span data-stu-id="0fb24-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="0fb24-307">Další sada kurzů bude kontrolovat, jak pracovat s binárními daty, jako jsou obrázky, soubory PDF, dokumenty aplikace Word atd. a webové ovládací prvky dat.</span><span class="sxs-lookup"><span data-stu-id="0fb24-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="0fb24-308">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="0fb24-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0fb24-309">O autorovi</span><span class="sxs-lookup"><span data-stu-id="0fb24-309">About the Author</span></span>

<span data-ttu-id="0fb24-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor 7 ASP/ASP. NET Books a zakladatel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="0fb24-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0fb24-311">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="0fb24-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0fb24-312">Nejnovější kniha je [*Sams naučit se ASP.NET 2,0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0fb24-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0fb24-313">Dá se získat na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0fb24-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0fb24-314">nebo prostřednictvím svého blogu, který najdete na adrese [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0fb24-314">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0fb24-315">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="0fb24-315">Special Thanks To</span></span>

<span data-ttu-id="0fb24-316">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="0fb24-316">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0fb24-317">Kontrolor pro tento kurz byl Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="0fb24-317">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="0fb24-318">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="0fb24-318">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0fb24-319">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0fb24-319">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="0fb24-320">Předchozí</span><span class="sxs-lookup"><span data-stu-id="0fb24-320">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)
