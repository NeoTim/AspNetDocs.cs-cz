---
uid: web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
title: Ukládání dat do mezipaměti v prvku ObjectDataSource (VB) | Microsoft Docs
author: rick-anderson
description: Ukládání do mezipaměti může znamenat rozdíl mezi pomalým a rychlou webovou aplikací. Tento kurz je první ze čtyř, které se podrobněji podíváte na ukládání do mezipaměti v ASP.NET...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: 2e56a733-5512-48a6-9276-70a65bbe4d5d
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 16f20d9a0f4f677073174d680418b278dba40b07
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/28/2019
ms.locfileid: "74612291"
---
# <a name="caching-data-with-the-objectdatasource-vb"></a><span data-ttu-id="ee982-104">Ukládání dat do mezipaměti ovládacím prvkem ObjectDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="ee982-104">Caching Data with the ObjectDataSource (VB)</span></span>

<span data-ttu-id="ee982-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ee982-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ee982-106">[Stáhnout ukázkovou aplikaci](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) nebo [Stáhnout PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ee982-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) or [Download PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span></span>

> <span data-ttu-id="ee982-107">Ukládání do mezipaměti může znamenat rozdíl mezi pomalým a rychlou webovou aplikací.</span><span class="sxs-lookup"><span data-stu-id="ee982-107">Caching can mean the difference between a slow and a fast Web application.</span></span> <span data-ttu-id="ee982-108">Tento kurz je první ze čtyř, které se podrobněji podíváte na ukládání do mezipaměti v ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="ee982-108">This tutorial is the first of four that take a detailed look at caching in ASP.NET.</span></span> <span data-ttu-id="ee982-109">Seznamte se s klíčovými koncepty ukládání do mezipaměti a postupem, jak používat ukládání do mezipaměti do prezentační vrstvy prostřednictvím ovládacího prvku ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ee982-109">Learn the key concepts of caching and how to apply caching to the Presentation Layer through the ObjectDataSource control.</span></span>

## <a name="introduction"></a><span data-ttu-id="ee982-110">Úvod</span><span class="sxs-lookup"><span data-stu-id="ee982-110">Introduction</span></span>

<span data-ttu-id="ee982-111">V počítačové vědy je *ukládání do mezipaměti* náročné na data nebo informace, které jsou nákladné pro získání a uložení kopie IT v umístění, ve kterém je rychlejší přístup.</span><span class="sxs-lookup"><span data-stu-id="ee982-111">In computer science, *caching* is the process of taking data or information that is expensive to obtain and storing a copy of it in a location that is quicker to access.</span></span> <span data-ttu-id="ee982-112">Pro aplikace řízené daty velké a složité dotazy běžně využívají většinu doby spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee982-112">For data-driven applications, large and complex queries commonly consume the majority of the application s execution time.</span></span> <span data-ttu-id="ee982-113">Výkon aplikace se pak dá často zlepšit tím, že se výsledky nákladných databázových dotazů ukládají do paměti aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee982-113">Such an application s performance, then, can often be improved by storing the results of expensive database queries in the application s memory.</span></span>

<span data-ttu-id="ee982-114">ASP.NET 2,0 nabízí celou řadu možností ukládání do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-114">ASP.NET 2.0 offers a variety of caching options.</span></span> <span data-ttu-id="ee982-115">Pomocí *ukládání výstupu do mezipaměti*lze uložit celou webovou stránku nebo uživatelský ovládací prvek s vykreslenými značkami.</span><span class="sxs-lookup"><span data-stu-id="ee982-115">An entire web page or User Control s rendered markup can be cached through *output caching*.</span></span> <span data-ttu-id="ee982-116">Ovládací prvky ObjectDataSource a SqlDataSource poskytují také možnosti ukládání do mezipaměti, což umožňuje ukládat data do mezipaměti na úrovni ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="ee982-116">The ObjectDataSource and SqlDataSource controls provide caching capabilities as well, thereby allowing data to be cached at the control level.</span></span> <span data-ttu-id="ee982-117">A ASP.NET s *data cache* poskytuje BOHATÝCH rozhraní API pro ukládání do mezipaměti, které umožňuje vývojářům stránek programově ukládat objekty do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-117">And ASP.NET s *data cache* provides a rich caching API that enables page developers to programmatically cache objects.</span></span> <span data-ttu-id="ee982-118">V tomto kurzu a dalších třech prověříme použití funkcí pro ukládání do mezipaměti ObjectDataSource s a také do mezipaměti dat.</span><span class="sxs-lookup"><span data-stu-id="ee982-118">In this tutorial and the next three we'll examine using the ObjectDataSource s caching features as well as the data cache.</span></span> <span data-ttu-id="ee982-119">Také si probereme, jak ukládat data v rámci aplikace do mezipaměti při spuštění a jak zajistit aktuálnost dat v mezipaměti pomocí závislostí mezipaměti SQL.</span><span class="sxs-lookup"><span data-stu-id="ee982-119">We'll also explore how to cache application-wide data at startup and how to keep cached data fresh through the use of SQL cache dependencies.</span></span> <span data-ttu-id="ee982-120">Tyto kurzy nezkoumá ukládání výstupu do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-120">These tutorials do not explore output caching.</span></span> <span data-ttu-id="ee982-121">Podrobný pohled na výstup do mezipaměti najdete v tématu [ukládání výstupu do mezipaměti v ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="ee982-121">For a detailed look at output caching, see [Output Caching in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span></span>

<span data-ttu-id="ee982-122">Ukládání do mezipaměti je možné v rámci architektury použít na jakémkoli místě, od vrstvy přístupu k datům až po prezentační vrstvu.</span><span class="sxs-lookup"><span data-stu-id="ee982-122">Caching can be applied at any place in the architecture, from the Data Access Layer up through the Presentation Layer.</span></span> <span data-ttu-id="ee982-123">V tomto kurzu se podíváme na použití ukládání do mezipaměti do prezentační vrstvy prostřednictvím ovládacího prvku ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ee982-123">In this tutorial we'll look at applying caching to the Presentation Layer through the ObjectDataSource control.</span></span> <span data-ttu-id="ee982-124">V dalším kurzu prověříme ukládání dat do mezipaměti do vrstvy obchodní logiky.</span><span class="sxs-lookup"><span data-stu-id="ee982-124">In the next tutorial we'll examine caching data at the Business Logic Layer.</span></span>

## <a name="key-caching-concepts"></a><span data-ttu-id="ee982-125">Koncepty ukládání klíčů do mezipaměti</span><span class="sxs-lookup"><span data-stu-id="ee982-125">Key Caching Concepts</span></span>

<span data-ttu-id="ee982-126">Ukládání do mezipaměti může výrazně zlepšit celkový výkon a škálovatelnost aplikace tím, že vybírá data, která jsou náročná na generování a ukládání kopie IT, do umístění, ke kterému se dá efektivněji připínat.</span><span class="sxs-lookup"><span data-stu-id="ee982-126">Caching can greatly improve an application s overall performance and scalability by taking data that is expensive to generate and storing a copy of it in a location that can be more efficiently accessed.</span></span> <span data-ttu-id="ee982-127">Vzhledem k tomu, že mezipaměť obsahuje pouze kopii skutečných, podkladových dat, může být zastaralá nebo *zastaralá*, pokud se změní podkladová data.</span><span class="sxs-lookup"><span data-stu-id="ee982-127">Since the cache holds just a copy of the actual, underlying data, it can become outdated, or *stale*, if the underlying data changes.</span></span> <span data-ttu-id="ee982-128">Pro boj proti tomu může vývojář stránky určit kritéria, podle kterých bude položka mezipaměti z mezipaměti *vyřazena* , a to pomocí:</span><span class="sxs-lookup"><span data-stu-id="ee982-128">To combat this, a page developer can indicate criteria by which the cache item will be *evicted* from the cache, using either:</span></span>

- <span data-ttu-id="ee982-129">**Kritéria založené na čase** : položka může být přidána do mezipaměti pro absolutní nebo posuvnou dobu trvání.</span><span class="sxs-lookup"><span data-stu-id="ee982-129">**Time-based criteria** an item may be added to the cache for an absolute or sliding duration.</span></span> <span data-ttu-id="ee982-130">Například vývojář stránky může indikovat dobu trvání, například 60 sekund.</span><span class="sxs-lookup"><span data-stu-id="ee982-130">For example, a page developer may indicate a duration of, say, 60 seconds.</span></span> <span data-ttu-id="ee982-131">Po absolutní době se položka uložená v mezipaměti vyřadí 60 sekund po přidání do mezipaměti, bez ohledu na to, jak často k nim došlo.</span><span class="sxs-lookup"><span data-stu-id="ee982-131">With an absolute duration, the cached item is evicted 60 seconds after it was added to cache, regardless of how frequently it was accessed.</span></span> <span data-ttu-id="ee982-132">Po klouzavé době je položka uložená v mezipaměti vyřazena 60 sekund po posledním přístupu.</span><span class="sxs-lookup"><span data-stu-id="ee982-132">With a sliding duration, the cached item is evicted 60 seconds after the last access.</span></span>
- <span data-ttu-id="ee982-133">**Kritéria založená na závislostech** : při přidání do mezipaměti může být k položce přidružena závislost.</span><span class="sxs-lookup"><span data-stu-id="ee982-133">**Dependency-based criteria** a dependency can be associated with an item when added to the cache.</span></span> <span data-ttu-id="ee982-134">Pokud se závislost položky změní, je vyřazena z mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-134">When the item s dependency changes it is evicted from the cache.</span></span> <span data-ttu-id="ee982-135">Závislost může být soubor, jiná položka v mezipaměti nebo kombinace těchto dvou.</span><span class="sxs-lookup"><span data-stu-id="ee982-135">The dependency may be a file, another cache item, or a combination of the two.</span></span> <span data-ttu-id="ee982-136">ASP.NET 2,0 také umožňuje závislosti mezipaměti SQL, které vývojářům umožňují přidat položku do mezipaměti a nechat ji vyřadit, když se změní podkladová data databáze.</span><span class="sxs-lookup"><span data-stu-id="ee982-136">ASP.NET 2.0 also allows SQL cache dependencies, which enable developers to add an item to the cache and have it evicted when the underlying database data changes.</span></span> <span data-ttu-id="ee982-137">Závislosti mezipaměti SQL prověříme v kurzu [použití závislostí mezipaměti SQL](using-sql-cache-dependencies-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="ee982-137">We will examine SQL cache dependencies in the upcoming [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="ee982-138">Bez ohledu na zadané kritérium vyřazení může být položka v mezipaměti *uklizena* předtím, než byla splněna kritéria založená na čase nebo závislosti.</span><span class="sxs-lookup"><span data-stu-id="ee982-138">Regardless of the eviction criteria specified, an item in the cache may be *scavenged* before the time-based or dependency-based criteria has been met.</span></span> <span data-ttu-id="ee982-139">Pokud mezipaměť dosáhla své kapacity, je nutné odebrat existující položky, aby bylo možné přidat nové.</span><span class="sxs-lookup"><span data-stu-id="ee982-139">If the cache has reached its capacity, existing items must be removed before new ones can be added.</span></span> <span data-ttu-id="ee982-140">V důsledku toho při práci s daty uloženými v mezipaměti je důležité, abyste vždycky předpokládali, že data uložená v mezipaměti nemusí být k dispozici.</span><span class="sxs-lookup"><span data-stu-id="ee982-140">Consequently, when programmatically working with cached data it s vital that you always assume that the cached data may not be present.</span></span> <span data-ttu-id="ee982-141">Podíváme se na vzor, který se použije při přístupu k datům z mezipaměti programově v našem dalším kurzu, který ukládá *data do mezipaměti v architektuře*.</span><span class="sxs-lookup"><span data-stu-id="ee982-141">We'll look at the pattern to use when accessing data from the cache programmatically in our next tutorial, *Caching Data in the Architecture*.</span></span>

<span data-ttu-id="ee982-142">Ukládání do mezipaměti poskytuje ekonomické prostředky pro zlepšení výkonu aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee982-142">Caching provides an economical means for squeezing more performance from an application.</span></span> <span data-ttu-id="ee982-143">Jako [Steven Smith](http://aspadvice.com/blogs/ssmith/) klouby ve svém článku [ukládání do mezipaměti ASP.NET: techniky a osvědčené postupy](https://msdn.microsoft.com/library/aa478965.aspx):</span><span class="sxs-lookup"><span data-stu-id="ee982-143">As [Steven Smith](http://aspadvice.com/blogs/ssmith/) articulates in his article [ASP.NET Caching: Techniques and Best Practices](https://msdn.microsoft.com/library/aa478965.aspx):</span></span>

<span data-ttu-id="ee982-144">Ukládání do mezipaměti může být dobrým způsobem, jak dosáhnout dostatečného výkonu, aniž by bylo potřeba provádět spoustu času a analýzy.</span><span class="sxs-lookup"><span data-stu-id="ee982-144">Caching can be a good way to get good enough performance without requiring a lot of time and analysis.</span></span> <span data-ttu-id="ee982-145">Paměť je levné, takže pokud můžete získat potřebný výkon uložením výstupu do mezipaměti po dobu 30 sekund, nikoli za den nebo týden, kde se snažíte optimalizovat váš kód nebo databázi, udělejte řešení ukládání do mezipaměti (za předpokladu, že staré údaje 30 sekund jsou ok) a přesun na.</span><span class="sxs-lookup"><span data-stu-id="ee982-145">Memory is cheap, so if you can get the performance you need by caching the output for 30 seconds instead of spending a day or a week trying to optimize your code or database, do the caching solution (assuming 30-second old data is ok) and move on.</span></span> <span data-ttu-id="ee982-146">Nekvalitní návrh bude pravděpodobně třeba zachytit, takže samozřejmě byste se měli pokusit aplikace navrhovat správně.</span><span class="sxs-lookup"><span data-stu-id="ee982-146">Eventually, poor design will probably catch up to you, so of course you should try to design your applications correctly.</span></span> <span data-ttu-id="ee982-147">Pokud ale budete potřebovat dobrý výkon ještě dnes, ukládání do mezipaměti může být skvělým [přístupem] a koupit si čas k refaktorování aplikace v pozdější době, kdy k tomu budete mít čas.</span><span class="sxs-lookup"><span data-stu-id="ee982-147">But if you just need to get good enough performance today, caching can be an excellent [approach], buying you time to refactor your application at a later date when you have the time to do so.</span></span>

<span data-ttu-id="ee982-148">I když ukládání do mezipaměti může poskytovat výrazné zvýšení výkonu, není použitelné ve všech situacích, jako je třeba u aplikací, které používají často aktualizovaná data v reálném čase, nebo v případech, kdy se zastaralá data nepřijala v krátké době.</span><span class="sxs-lookup"><span data-stu-id="ee982-148">While caching can provide appreciable performance enhancements, it is not applicable in all situations, such as with applications that use real-time, frequently-updating data, or where even shortly-lived stale data is unacceptable.</span></span> <span data-ttu-id="ee982-149">U většiny aplikací je však vhodné použít ukládání do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-149">But for the majority of applications, caching should be used.</span></span> <span data-ttu-id="ee982-150">Další informace o ukládání do mezipaměti v ASP.NET 2,0 najdete v části [ukládání do mezipaměti pro výkon](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) v [kurzech pro rychlé zprovoznění ASP.NET 2,0](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span><span class="sxs-lookup"><span data-stu-id="ee982-150">For more background on caching in ASP.NET 2.0, refer to the [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) section of the [ASP.NET 2.0 QuickStart Tutorials](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span></span>

## <a name="step-1-creating-the-caching-web-pages"></a><span data-ttu-id="ee982-151">Krok 1: vytvoření webových stránek pro ukládání do mezipaměti</span><span class="sxs-lookup"><span data-stu-id="ee982-151">Step 1: Creating the Caching Web Pages</span></span>

<span data-ttu-id="ee982-152">Před zahájením průzkumu funkcí pro ukládání do mezipaměti ObjectDataSource s a pojďme nejdřív chvíli trvat, než se vytvoří stránky ASP.NET v našem projektu webu, který budeme potřebovat pro tento kurz a další tři.</span><span class="sxs-lookup"><span data-stu-id="ee982-152">Before we start our exploration of the ObjectDataSource s caching features, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="ee982-153">Začněte přidáním nové složky s názvem `Caching`.</span><span class="sxs-lookup"><span data-stu-id="ee982-153">Start by adding a new folder named `Caching`.</span></span> <span data-ttu-id="ee982-154">Dále přidejte následující stránky ASP.NET do této složky a nezapomeňte přidružit jednotlivé stránky k `Site.master` hlavní stránce:</span><span class="sxs-lookup"><span data-stu-id="ee982-154">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ObjectDataSource.aspx`
- `FromTheArchitecture.aspx`
- `AtApplicationStartup.aspx`
- `SqlCacheDependencies.aspx`

![Přidání stránek ASP.NET pro kurzy související s ukládáním do mezipaměti](caching-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="ee982-156">**Obrázek 1**: přidání stránek ASP.NET pro kurzy související s ukládáním do mezipaměti</span><span class="sxs-lookup"><span data-stu-id="ee982-156">**Figure 1**: Add the ASP.NET Pages for the Caching-Related Tutorials</span></span>

<span data-ttu-id="ee982-157">Podobně jako v ostatních složkách `Default.aspx` ve složce `Caching` vypíše kurzy v části.</span><span class="sxs-lookup"><span data-stu-id="ee982-157">Like in the other folders, `Default.aspx` in the `Caching` folder will list the tutorials in its section.</span></span> <span data-ttu-id="ee982-158">Zajistěte, aby tato funkce poskytovala `SectionLevelTutorialListing.ascx` uživatelský ovládací prvek.</span><span class="sxs-lookup"><span data-stu-id="ee982-158">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="ee982-159">Proto tento uživatelský ovládací prvek přidejte do `Default.aspx` tím, že ho přetáhnete z Průzkumník řešení na zobrazení Návrh stránky.</span><span class="sxs-lookup"><span data-stu-id="ee982-159">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="ee982-160">[![obrázek 2: Přidání uživatelského ovládacího prvku SectionLevelTutorialListing. ascx do default. aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="ee982-160">[![Figure 2: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="ee982-161">**Obrázek 2**: obrázek 2: Přidání uživatelského ovládacího prvku `SectionLevelTutorialListing.ascx` do `Default.aspx` ([kliknutím zobrazíte obrázek v plné velikosti](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="ee982-161">**Figure 2**: Figure 2: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="ee982-162">Nakonec tyto stránky přidejte jako položky do souboru `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="ee982-162">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="ee982-163">Konkrétně přidejte následující kód po práci s binárními daty `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="ee982-163">Specifically, add the following markup after the Working with Binary Data `<siteMapNode>`:</span></span>

[!code-xml[Main](caching-data-with-the-objectdatasource-vb/samples/sample1.xml)]

<span data-ttu-id="ee982-164">Po aktualizaci `Web.sitemap`chvíli počkejte, než se zobrazí web kurzy prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="ee982-164">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="ee982-165">V nabídce na levé straně teď najdete položky kurzů pro ukládání do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-165">The menu on the left now includes items for the caching tutorials.</span></span>

![Mapa webu teď obsahuje položky kurzů pro ukládání do mezipaměti.](caching-data-with-the-objectdatasource-vb/_static/image5.png)

<span data-ttu-id="ee982-167">**Obrázek 3**: Mapa webu teď obsahuje položky kurzů pro ukládání do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-167">**Figure 3**: The Site Map Now Includes Entries for the Caching Tutorials</span></span>

## <a name="step-2-displaying-a-list-of-products-in-a-web-page"></a><span data-ttu-id="ee982-168">Krok 2: zobrazení seznamu produktů na webové stránce</span><span class="sxs-lookup"><span data-stu-id="ee982-168">Step 2: Displaying a List of Products in a Web Page</span></span>

<span data-ttu-id="ee982-169">V tomto kurzu se seznámíte s použitím integrovaných funkcí ukládání do mezipaměti v rámci ovládacího prvku ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ee982-169">This tutorial explores how to use the ObjectDataSource control s built-in caching features.</span></span> <span data-ttu-id="ee982-170">Předtím, než se můžeme podívat na tyto funkce, musíme nejdřív potřebovat stránku, ze které můžete pracovat.</span><span class="sxs-lookup"><span data-stu-id="ee982-170">Before we can look at these features, though, we first need a page to work from.</span></span> <span data-ttu-id="ee982-171">Umožňuje vytvořit webovou stránku, která používá prvek GridView k vypsání informací o produktu načtených prvkem ObjectDataSource z třídy `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="ee982-171">Let s create a web page that uses a GridView to list product information retrieved by an ObjectDataSource from the `ProductsBLL` class.</span></span>

<span data-ttu-id="ee982-172">Začněte tím, že otevřete stránku `ObjectDataSource.aspx` ve složce `Caching`.</span><span class="sxs-lookup"><span data-stu-id="ee982-172">Start by opening the `ObjectDataSource.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="ee982-173">Přetáhněte prvek GridView z panelu nástrojů do návrháře, nastavte jeho vlastnost `ID` na `Products`a z jeho inteligentní značky vyberte možnost svázání s novým ovládacím prvkem ObjectDataSource s názvem `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="ee982-173">Drag a GridView from the Toolbox onto the Designer, set its `ID` property to `Products`, and, from its smart tag, choose to bind it to a new ObjectDataSource control named `ProductsDataSource`.</span></span> <span data-ttu-id="ee982-174">Nakonfigurujte prvek ObjectDataSource pro práci s třídou `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="ee982-174">Configure the ObjectDataSource to work with the `ProductsBLL` class.</span></span>

<span data-ttu-id="ee982-175">[![nakonfigurovat prvek ObjectDataSource tak, aby používal třídu ProductsBLL](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="ee982-175">[![Configure the ObjectDataSource to Use the ProductsBLL Class](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span></span>

<span data-ttu-id="ee982-176">**Obrázek 4**: Konfigurace prvku ObjectDataSource, aby používal třídu `ProductsBLL` ([kliknutím zobrazíte obrázek v plné velikosti](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="ee982-176">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span></span>

<span data-ttu-id="ee982-177">Pro tuto stránku vytvoříme upravitelný prvek GridView, abyste mohli prošetřit, co se stane, když se data uložená v ovládacím prvku ObjectDataSource upraví prostřednictvím rozhraní GridView s.</span><span class="sxs-lookup"><span data-stu-id="ee982-177">For this page, let s create an editable GridView so that we can examine what happens when data cached in the ObjectDataSource is modified through the GridView s interface.</span></span> <span data-ttu-id="ee982-178">Nechejte rozevírací seznam na kartě vybrat nastavený na výchozí `GetProducts()`, ale změňte vybranou položku na kartě aktualizace na `UpdateProduct` přetížení, které přijímá `productName`, `unitPrice`a `productID` jako vstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="ee982-178">Leave the drop-down list in the SELECT tab set to its default, `GetProducts()`, but change the selected item in the UPDATE tab to the `UpdateProduct` overload that accepts `productName`, `unitPrice`, and `productID` as its input parameters.</span></span>

<span data-ttu-id="ee982-179">[![v rozevíracím seznamu karta aktualizace nastavit odpovídající přetížení UpdateProduct](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="ee982-179">[![Set the UPDATE Tab s Drop-Down List to the Appropriate UpdateProduct Overload](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="ee982-180">**Obrázek 5**: rozevírací seznam karty aktualizace nastavte na odpovídající `UpdateProduct` přetížení ([kliknutím zobrazíte obrázek v plné velikosti).](caching-data-with-the-objectdatasource-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="ee982-180">**Figure 5**: Set the UPDATE Tab s Drop-Down List to the Appropriate `UpdateProduct` Overload ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span></span>

<span data-ttu-id="ee982-181">Nakonec nastavte rozevírací seznamy na kartách vložit a odstranit na (žádné) a klikněte na Dokončit.</span><span class="sxs-lookup"><span data-stu-id="ee982-181">Finally, set the drop-down lists in the INSERT and DELETE tabs to (None) and click Finish.</span></span> <span data-ttu-id="ee982-182">Po dokončení Průvodce konfigurací zdroje dat sada Visual Studio nastaví vlastnost ObjectDataSource s `OldValuesParameterFormatString` na `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="ee982-182">Upon completing the Configure Data Source wizard, Visual Studio sets the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="ee982-183">Jak je popsáno v kurzu [vložení, aktualizace a odstranění dat](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) , je nutné tuto vlastnost odebrat z deklarativní syntaxe nebo nastavit zpět na výchozí hodnotu, `{0}`, aby mohl náš pracovní postup aktualizace pokračovat bez chyby.</span><span class="sxs-lookup"><span data-stu-id="ee982-183">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, this property needs to be removed from the declarative syntax or set back to its default value, `{0}`, in order for our update workflow to proceed without error.</span></span>

<span data-ttu-id="ee982-184">Kromě toho, po dokončení průvodce, Visual Studio přidá pole do prvku GridView pro každé pole dat produktu.</span><span class="sxs-lookup"><span data-stu-id="ee982-184">Furthermore, at the completion of the wizard Visual Studio adds a field to the GridView for each of the product data fields.</span></span> <span data-ttu-id="ee982-185">Odeberte všechny kromě `ProductName`, `CategoryName`a `UnitPrice` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="ee982-185">Remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="ee982-186">Dále aktualizujte `HeaderText` vlastnosti každého z těchto BoundFields na produkt, kategorii a cenu.</span><span class="sxs-lookup"><span data-stu-id="ee982-186">Next, update the `HeaderText` properties of each of these BoundFields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="ee982-187">Vzhledem k tomu, že je vyžadováno pole `ProductName`, převeďte vlastnost BoundField na TemplateField a přidejte RequiredFieldValidator do `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="ee982-187">Since the `ProductName` field is required, convert the BoundField into a TemplateField and add a RequiredFieldValidator to the `EditItemTemplate`.</span></span> <span data-ttu-id="ee982-188">Podobně převeďte `UnitPrice` vlastnost BoundField na TemplateField a přidejte CompareValidator, abyste zajistili, že hodnota zadaná uživatelem je platná hodnota měny, která je větší nebo rovna nule.</span><span class="sxs-lookup"><span data-stu-id="ee982-188">Similarly, convert the `UnitPrice` BoundField into a TemplateField and add a CompareValidator to ensure that the value entered by the user is a valid currency value that s greater than or equal to zero.</span></span> <span data-ttu-id="ee982-189">Kromě těchto úprav si klidně provedete všechny estetické změny, jako je například zarovnání doprava `UnitPrice` hodnoty, nebo určení formátování `UnitPrice`ho textu v rozhraních jen pro čtení a úpravách.</span><span class="sxs-lookup"><span data-stu-id="ee982-189">In addition to these modifications, feel free to perform any aesthetic changes, such as right-aligning the `UnitPrice` value, or specifying the formatting for the `UnitPrice` text in its read-only and editing interfaces.</span></span>

<span data-ttu-id="ee982-190">Nastavte upravitelný prvek GridView zaškrtnutím políčka Povolit úpravy v inteligentní značce GridView.</span><span class="sxs-lookup"><span data-stu-id="ee982-190">Make the GridView editable by checking the Enable Editing checkbox in the GridView s smart tag.</span></span> <span data-ttu-id="ee982-191">Zaškrtněte také políčka Povolit stránkování a Povolit řazení.</span><span class="sxs-lookup"><span data-stu-id="ee982-191">Also check the Enable Paging and Enable Sorting checkboxes.</span></span>

> [!NOTE]
> <span data-ttu-id="ee982-192">Potřebujete zkontrolovat, jak přizpůsobit rozhraní pro úpravy prvku GridView s?</span><span class="sxs-lookup"><span data-stu-id="ee982-192">Need a review of how to customize the GridView s editing interface?</span></span> <span data-ttu-id="ee982-193">Pokud ano, přečtěte si kurz [přizpůsobení rozhraní pro úpravu dat](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="ee982-193">If so, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>

<span data-ttu-id="ee982-194">[![povolit podporu prvku GridView pro úpravy, řazení a stránkování](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="ee982-194">[![Enable GridView Support for Editing, Sorting, and Paging](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span></span>

<span data-ttu-id="ee982-195">**Obrázek 6**: povolení podpory prvku GridView pro úpravy, řazení a stránkování ([kliknutím zobrazíte obrázek v plné velikosti](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="ee982-195">**Figure 6**: Enable GridView Support for Editing, Sorting, and Paging ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span></span>

<span data-ttu-id="ee982-196">Po provedení úprav těchto prvků GridView by deklarativní označení GridView a ObjectDataSource s mělo vypadat podobně jako následující:</span><span class="sxs-lookup"><span data-stu-id="ee982-196">After making these GridView modifications, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](caching-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="ee982-197">Jak ukazuje obrázek 7, upravitelný GridView zobrazí název, kategorii a cenu každého z produktů v databázi.</span><span class="sxs-lookup"><span data-stu-id="ee982-197">As Figure 7 shows, the editable GridView lists the name, category, and price of each of the products in the database.</span></span> <span data-ttu-id="ee982-198">Chvíli počkejte, než otestujete funkčnost stránky a seřaďte výsledky, stránky a upravte záznam.</span><span class="sxs-lookup"><span data-stu-id="ee982-198">Take a moment to test out the page s functionality sort the results, page through them, and edit a record.</span></span>

<span data-ttu-id="ee982-199">[![každý název produktu, kategorie a cena se zobrazí ve stejném, upravitelném, upravitelném prvku GridView.](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="ee982-199">[![Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span></span>

<span data-ttu-id="ee982-200">**Obrázek 7**: každý název produktu, kategorie a cena jsou uvedené ve stejném, upravitelném, upravitelném prvku GridView ([kliknutím zobrazíte obrázek v plné velikosti](caching-data-with-the-objectdatasource-vb/_static/image17.png)).</span><span class="sxs-lookup"><span data-stu-id="ee982-200">**Figure 7**: Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span></span>

## <a name="step-3-examining-when-the-objectdatasource-is-requesting-data"></a><span data-ttu-id="ee982-201">Krok 3: prozkoumání, kdy prvek ObjectDataSource požaduje data</span><span class="sxs-lookup"><span data-stu-id="ee982-201">Step 3: Examining When the ObjectDataSource is Requesting Data</span></span>

<span data-ttu-id="ee982-202">`Products` GridView načte svá data pro zobrazení vyvoláním metody `Select` prvku `ProductsDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ee982-202">The `Products` GridView retrieves its data to display by invoking the `Select` method of the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="ee982-203">Tento prvek ObjectDataSource vytvoří instanci třídy Business Logic Layer s `ProductsBLL` a zavolá jeho metodu `GetProducts()`, která zase zavolá metodu `GetProducts()` Data Access Layer s `ProductsTableAdapter` s.</span><span class="sxs-lookup"><span data-stu-id="ee982-203">This ObjectDataSource creates an instance of the Business Logic Layer s `ProductsBLL` class and calls its `GetProducts()` method, which in turn calls the Data Access Layer s `ProductsTableAdapter` s `GetProducts()` method.</span></span> <span data-ttu-id="ee982-204">Metoda DAL se připojí k databázi Northwind a vydá nakonfigurovaný dotaz `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="ee982-204">The DAL method connects to the Northwind database and issues the configured `SELECT` query.</span></span> <span data-ttu-id="ee982-205">Tato data se pak vrátí na DAL, který je zabalí do `NorthwindDataTable`.</span><span class="sxs-lookup"><span data-stu-id="ee982-205">This data is then returned to the DAL, which packages it up in a `NorthwindDataTable`.</span></span> <span data-ttu-id="ee982-206">Objekt DataTable je vrácen do knihoven BLL, který jej vrátí do prvku ObjectDataSource, který jej vrátí do prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="ee982-206">The DataTable object is returned to the BLL, which returns it to the ObjectDataSource, which returns it to the GridView.</span></span> <span data-ttu-id="ee982-207">Prvek GridView potom vytvoří objekt `GridViewRow` pro každý `DataRow` v objektu DataTable a každý `GridViewRow` se nakonec vykreslí do kódu HTML vráceného klientovi a zobrazí se v prohlížeči návštěvníka.</span><span class="sxs-lookup"><span data-stu-id="ee982-207">The GridView then creates a `GridViewRow` object for each `DataRow` in the DataTable, and each `GridViewRow` is eventually rendered into the HTML that is returned to the client and displayed on the visitor s browser.</span></span>

<span data-ttu-id="ee982-208">Tato posloupnost událostí probíhá každý a pokaždé, když prvek GridView musí vytvořit vazby na podkladová data.</span><span class="sxs-lookup"><span data-stu-id="ee982-208">This sequence of events happens each and every time the GridView needs to bind to its underlying data.</span></span> <span data-ttu-id="ee982-209">K tomu dojde při prvním navštívení stránky, při přesunu z jedné stránky dat do druhé při řazení prvku GridView nebo při úpravě dat GridView s pomocí vestavěných úprav nebo odstranění rozhraní.</span><span class="sxs-lookup"><span data-stu-id="ee982-209">That happens when the page is first visited, when moving from one page of data to another, when sorting the GridView, or when modifying the GridView s data through its built-in editing or deleting interfaces.</span></span> <span data-ttu-id="ee982-210">Je-li stav zobrazení GridView. je zakázán, bude prvek GridView také při každém zpětném odeslání svázán.</span><span class="sxs-lookup"><span data-stu-id="ee982-210">If the GridView s view state is disabled, the GridView will be rebound on each and every postback as well.</span></span> <span data-ttu-id="ee982-211">Prvek GridView lze také explicitně převázat na jeho data voláním jeho `DataBind()` metody.</span><span class="sxs-lookup"><span data-stu-id="ee982-211">The GridView can also be explicitly rebound to its data by calling its `DataBind()` method.</span></span>

<span data-ttu-id="ee982-212">Aby bylo možné plně vyhodnotit četnost, s jakou jsou data načítána z databáze, zobrazí se zpráva s oznámením, že se data znovu načítají.</span><span class="sxs-lookup"><span data-stu-id="ee982-212">To fully appreciate the frequency with which the data is retrieved from the database, let s display a message indicating when the data is being re-retrieved.</span></span> <span data-ttu-id="ee982-213">Přidejte ovládací prvek popisek webu nad prvek GridView s názvem `ODSEvents`.</span><span class="sxs-lookup"><span data-stu-id="ee982-213">Add a Label Web control above the GridView named `ODSEvents`.</span></span> <span data-ttu-id="ee982-214">Vymažte vlastnost `Text` a nastavte její vlastnost `EnableViewState` na `False`.</span><span class="sxs-lookup"><span data-stu-id="ee982-214">Clear out its `Text` property and set its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="ee982-215">Pod popiskem přidejte webový ovládací prvek tlačítko a nastavte jeho vlastnost `Text` na postback.</span><span class="sxs-lookup"><span data-stu-id="ee982-215">Underneath the Label, add a Button Web control and set its `Text` property to Postback .</span></span>

<span data-ttu-id="ee982-216">[![přidání popisku a tlačítka na stránku nad ovládací prvek GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="ee982-216">[![Add a Label and Button to the Page Above the GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span></span>

<span data-ttu-id="ee982-217">**Obrázek 8**: Přidání popisku a tlačítka na stránku nad prvek GridView ([kliknutím zobrazíte obrázek v plné velikosti](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="ee982-217">**Figure 8**: Add a Label and Button to the Page Above the GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span></span>

<span data-ttu-id="ee982-218">Během pracovního postupu přístupu k datům se v prvku ObjectDataSource s `Selecting` událost aktivuje před vytvořením podkladového objektu a vyvoláním jeho nakonfigurované metody.</span><span class="sxs-lookup"><span data-stu-id="ee982-218">During the data access workflow, the ObjectDataSource s `Selecting` event fires before the underlying object is created and its configured method invoked.</span></span> <span data-ttu-id="ee982-219">Vytvořte obslužnou rutinu události pro tuto událost a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="ee982-219">Create an event handler for this event and add the following code:</span></span>

[!code-vb[Main](caching-data-with-the-objectdatasource-vb/samples/sample3.vb)]

<span data-ttu-id="ee982-220">Pokaždé, když prvek ObjectDataSource vytvoří požadavek na architekturu dat, zobrazí se v popisku text, který vybral událost.</span><span class="sxs-lookup"><span data-stu-id="ee982-220">Each time the ObjectDataSource makes a request to the architecture for data, the Label will display the text Selecting event fired .</span></span>

<span data-ttu-id="ee982-221">Navštivte tuto stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="ee982-221">Visit this page in a browser.</span></span> <span data-ttu-id="ee982-222">Při prvním navštívení stránky se zobrazí text výběr události.</span><span class="sxs-lookup"><span data-stu-id="ee982-222">When the page is first visited, the text Selecting event fired is shown.</span></span> <span data-ttu-id="ee982-223">Klikněte na tlačítko pro odeslání a Všimněte si, že text zmizí (za předpokladu, že vlastnost GridView `EnableViewState` je nastavena na hodnotu `True`, výchozí).</span><span class="sxs-lookup"><span data-stu-id="ee982-223">Click the Postback button and note that the text disappears (assuming that the GridView s `EnableViewState` property is set to `True`, the default).</span></span> <span data-ttu-id="ee982-224">Důvodem je, že při postbacku je prvek GridView znovu sestaven z jeho stavu zobrazení, a proto neměňte prvek ObjectDataSource pro jeho data.</span><span class="sxs-lookup"><span data-stu-id="ee982-224">This is because, on postback, the GridView is reconstructed from its view state and therefore doesn t turn to the ObjectDataSource for its data.</span></span> <span data-ttu-id="ee982-225">Řazení, stránkování nebo upravování dat ale způsobí, že se prvek GridView znovu připojí ke zdroji dat, a proto se text vypálené události vygeneruje znovu.</span><span class="sxs-lookup"><span data-stu-id="ee982-225">Sorting, paging, or editing the data, however, causes the GridView to rebind to its data source, and therefore the Selecting event fired text reappears.</span></span>

<span data-ttu-id="ee982-226">[![pokaždé, když je prvek GridView svázán s jeho zdrojem dat, zobrazí se výběr aktivované události.](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="ee982-226">[![Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span></span>

<span data-ttu-id="ee982-227">**Obrázek 9**: pokaždé, když je prvek GridView svázán s jeho zdrojem dat, je zobrazena událost vyvolaná události ([kliknutím zobrazíte obrázek v plné velikosti).](caching-data-with-the-objectdatasource-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="ee982-227">**Figure 9**: Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span></span>

<span data-ttu-id="ee982-228">[![kliknutí na tlačítko pro odeslání způsobí, že prvek GridView bude znovu vytvořen z jeho stavu zobrazení.](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="ee982-228">[![Clicking the Postback Button Causes the GridView to be Reconstructed from its View State](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span></span>

<span data-ttu-id="ee982-229">**Obrázek 10**: kliknutím na tlačítko pro odeslání dojde k rekonstrukci prvku GridView ze stavu zobrazení ([kliknutím zobrazíte obrázek v plné velikosti](caching-data-with-the-objectdatasource-vb/_static/image26.png)).</span><span class="sxs-lookup"><span data-stu-id="ee982-229">**Figure 10**: Clicking the Postback Button Causes the GridView to be Reconstructed from its View State ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span></span>

<span data-ttu-id="ee982-230">Může se zdát, že wasteful načíst data databáze pokaždé, když jsou data stránkovaná nebo seřazená.</span><span class="sxs-lookup"><span data-stu-id="ee982-230">It may seem wasteful to retrieve the database data each time the data is paged through or sorted.</span></span> <span data-ttu-id="ee982-231">Po všech případech, vzhledem k opakovanému použití výchozího stránkování, prvek ObjectDataSource načetl všechny záznamy při zobrazení první stránky.</span><span class="sxs-lookup"><span data-stu-id="ee982-231">After all, since we re using default paging, the ObjectDataSource has retrieved all of the records when displaying the first page.</span></span> <span data-ttu-id="ee982-232">I v případě, že prvek GridView neposkytuje podporu řazení a stránkování, data musí být načítána z databáze pokaždé, když je stránka poprvé navštívena jakýmkoli uživatelem (a při každém postbacku, pokud je stav zobrazení zakázán).</span><span class="sxs-lookup"><span data-stu-id="ee982-232">Even if the GridView does not provide sorting and paging support, the data must be retrieved from the database each time the page is first visited by any user (and on every postback, if view state is disabled).</span></span> <span data-ttu-id="ee982-233">Pokud však prvek GridView zobrazuje stejná data pro všechny uživatele, tyto dodatečné žádosti o databázi jsou nadbytečné.</span><span class="sxs-lookup"><span data-stu-id="ee982-233">But if the GridView is showing the same data to all users, these extra database requests are superfluous.</span></span> <span data-ttu-id="ee982-234">Proč Neukládat do mezipaměti výsledky vrácené z metody `GetProducts()` a navážete prvek GridView na tyto výsledky v mezipaměti?</span><span class="sxs-lookup"><span data-stu-id="ee982-234">Why not cache the results returned from the `GetProducts()` method and bind the GridView to those cached results?</span></span>

## <a name="step-4-caching-the-data-using-the-objectdatasource"></a><span data-ttu-id="ee982-235">Krok 4: ukládání dat do mezipaměti pomocí prvku ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="ee982-235">Step 4: Caching the Data Using the ObjectDataSource</span></span>

<span data-ttu-id="ee982-236">Pouhým nastavením několika vlastností lze prvek ObjectDataSource nakonfigurovat tak, aby automaticky do mezipaměti načetl data v mezipaměti ASP.NET data.</span><span class="sxs-lookup"><span data-stu-id="ee982-236">By simply setting a few properties, the ObjectDataSource can be configured to automatically cache its retrieved data in the ASP.NET data cache.</span></span> <span data-ttu-id="ee982-237">Následující seznam shrnuje vlastnosti prvku ObjectDataSource související s mezipamětí:</span><span class="sxs-lookup"><span data-stu-id="ee982-237">The following list summarizes the cache-related properties of the ObjectDataSource:</span></span>

- <span data-ttu-id="ee982-238">Aby bylo možné povolit ukládání do mezipaměti, musí být [EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) nastavené na `True`.</span><span class="sxs-lookup"><span data-stu-id="ee982-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) must be set to `True` to enable caching.</span></span> <span data-ttu-id="ee982-239">Výchozí hodnota je `False`.</span><span class="sxs-lookup"><span data-stu-id="ee982-239">The default is `False`.</span></span>
- <span data-ttu-id="ee982-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) velikost času v sekundách, po kterou jsou data uložena do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) the amount of time, in seconds, that the data is cached.</span></span> <span data-ttu-id="ee982-241">Výchozí hodnota je 0.</span><span class="sxs-lookup"><span data-stu-id="ee982-241">The default is 0.</span></span> <span data-ttu-id="ee982-242">Prvek ObjectDataSource bude ukládat data do mezipaměti pouze v případě, že je `EnableCaching` `True` a `CacheDuration` je nastavena na hodnotu větší než nula.</span><span class="sxs-lookup"><span data-stu-id="ee982-242">The ObjectDataSource will only cache data if `EnableCaching` is `True` and `CacheDuration` is set to a value greater than zero.</span></span>
- <span data-ttu-id="ee982-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) může být nastavená na `Absolute` nebo `Sliding`.</span><span class="sxs-lookup"><span data-stu-id="ee982-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) can be set to `Absolute` or `Sliding`.</span></span> <span data-ttu-id="ee982-244">Pokud `Absolute`, prvek ObjectDataSource uloží získaná data do mezipaměti pro `CacheDuration` sekund. Pokud `Sliding`, vyprší platnost dat až po `CacheDuration` sekund.</span><span class="sxs-lookup"><span data-stu-id="ee982-244">If `Absolute`, the ObjectDataSource caches its retrieved data for `CacheDuration` seconds; if `Sliding`, the data expires only after it has not been accessed for `CacheDuration` seconds.</span></span> <span data-ttu-id="ee982-245">Výchozí hodnota je `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="ee982-245">The default is `Absolute`.</span></span>
- <span data-ttu-id="ee982-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) tuto vlastnost použijte k přidružení položek mezipaměti ObjectDataSource s ke stávající závislosti mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) use this property to associate the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="ee982-247">Datové položky ObjectDataSource s lze předčasně vyřadit z mezipaměti tím, že vyprší její přidružená `CacheKeyDependency`.</span><span class="sxs-lookup"><span data-stu-id="ee982-247">The ObjectDataSource s data entries can be prematurely evicted from the cache by expiring its associated `CacheKeyDependency`.</span></span> <span data-ttu-id="ee982-248">Tato vlastnost se nejčastěji používá k přidružení závislosti mezipaměti SQL s mezipamětí ObjectDataSource s, což je téma v budoucnu v kurzu [použití závislostí mezipaměti SQL](using-sql-cache-dependencies-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="ee982-248">This property is most commonly used to associate a SQL cache dependency with the ObjectDataSource s cache, a topic we'll explore in the future [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="ee982-249">Umožňuje konfigurovat `ProductsDataSource` ObjectDataSource, aby data mohla ukládat do mezipaměti na 30 sekund na absolutním měřítku.</span><span class="sxs-lookup"><span data-stu-id="ee982-249">Let s configure the `ProductsDataSource` ObjectDataSource to cache its data for 30 seconds on an absolute scale.</span></span> <span data-ttu-id="ee982-250">Vlastnost ObjectDataSource `EnableCaching` nastavte na hodnotu `True` a vlastnost `CacheDuration` na hodnotu 30.</span><span class="sxs-lookup"><span data-stu-id="ee982-250">Set the ObjectDataSource s `EnableCaching` property to `True` and its `CacheDuration` property to 30.</span></span> <span data-ttu-id="ee982-251">Ponechte vlastnost `CacheExpirationPolicy` nastavenou na výchozí hodnotu `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="ee982-251">Leave the `CacheExpirationPolicy` property set to its default, `Absolute`.</span></span>

<span data-ttu-id="ee982-252">[![nakonfigurovat prvek ObjectDataSource tak, aby data mohla ukládat do mezipaměti po dobu 30 sekund](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="ee982-252">[![Configure the ObjectDataSource to Cache its Data for 30 Seconds](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span></span>

<span data-ttu-id="ee982-253">**Obrázek 11**: Konfigurace prvku ObjectDataSource pro ukládání dat do mezipaměti po dobu 30 sekund ([kliknutím zobrazíte obrázek v plné velikosti](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="ee982-253">**Figure 11**: Configure the ObjectDataSource to Cache its Data for 30 Seconds ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span></span>

<span data-ttu-id="ee982-254">Uložte změny a znovu navštivte tuto stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="ee982-254">Save your changes and revisit this page in a browser.</span></span> <span data-ttu-id="ee982-255">Při první návštěvě stránky se zobrazí text výběr události, který vyvolala událost, protože data nejsou v mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-255">The Selecting event fired text will appear when you first visit the page, as initially the data is not in the cache.</span></span> <span data-ttu-id="ee982-256">Ale následné postbacky spouštěné kliknutím na tlačítko pro odeslání, řazení, stránkování nebo kliknutí na tlačítka pro úpravy nebo zrušení *nezobrazují* příkaz pro výběr události, který vyvolal událost.</span><span class="sxs-lookup"><span data-stu-id="ee982-256">But subsequent postbacks triggered by clicking the Postback button, sorting, paging, or clicking the Edit or Cancel buttons does *not* redisplay the Selecting event fired text.</span></span> <span data-ttu-id="ee982-257">Důvodem je, že událost `Selecting` je aktivována pouze v případě, že prvek ObjectDataSource získá data z jeho podkladového objektu; událost `Selecting` se neaktivuje, pokud jsou data načítána z mezipaměti dat.</span><span class="sxs-lookup"><span data-stu-id="ee982-257">This is because the `Selecting` event only fires when the ObjectDataSource gets its data from its underlying object; the `Selecting` event does not fire if the data is pulled from the data cache.</span></span>

<span data-ttu-id="ee982-258">Po 30 sekundách budou data z mezipaměti vyřazena.</span><span class="sxs-lookup"><span data-stu-id="ee982-258">After 30 seconds, the data will be evicted from the cache.</span></span> <span data-ttu-id="ee982-259">Data budou také vyřazena z mezipaměti, pokud jsou vyvolány metody ObjectDataSource `Insert`, `Update`nebo `Delete`.</span><span class="sxs-lookup"><span data-stu-id="ee982-259">The data will also be evicted from the cache if the ObjectDataSource s `Insert`, `Update`, or `Delete` methods are invoked.</span></span> <span data-ttu-id="ee982-260">V důsledku toho po uplynutí 30 sekund nebo kliknutí na tlačítko Aktualizovat, řazení, stránkování nebo kliknutí na tlačítka pro úpravy nebo zrušení způsobí, že prvek ObjectDataSource získá data z jeho podkladového objektu a zobrazí text, který událost výběru vyvolala, když `Selecting` událost aktivuje.</span><span class="sxs-lookup"><span data-stu-id="ee982-260">Consequently, after 30 seconds have passed or the Update button has been clicked, sorting, paging, or clicking the Edit or Cancel buttons will cause the ObjectDataSource to get its data from its underlying object, displaying the Selecting event fired text when the `Selecting` event fires.</span></span> <span data-ttu-id="ee982-261">Tyto vrácené výsledky jsou umístěny zpátky do mezipaměti dat.</span><span class="sxs-lookup"><span data-stu-id="ee982-261">These returned results are placed back into the data cache.</span></span>

> [!NOTE]
> <span data-ttu-id="ee982-262">Pokud se zobrazí text, který událost výběru vyvolala často, i když očekáváte, že prvek ObjectDataSource bude pracovat s daty uloženými v mezipaměti, může to být způsobeno omezeními paměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-262">If you see the Selecting event fired text frequently, even when you expect the ObjectDataSource to be working with cached data, it may be due to memory constraints.</span></span> <span data-ttu-id="ee982-263">Pokud není dostatek volné paměti, data přidaná do mezipaměti prvku ObjectDataSource mohla být uklizena.</span><span class="sxs-lookup"><span data-stu-id="ee982-263">If there is not enough free memory, the data added to the cache by the ObjectDataSource may have been scavenged.</span></span> <span data-ttu-id="ee982-264">Pokud se v prvku ObjectDataSource nejeví správně ukládat data do mezipaměti, nebo je jenom ukládat do mezipaměti, ukončete některé aplikace a uvolněte paměť a zkuste to znovu.</span><span class="sxs-lookup"><span data-stu-id="ee982-264">If the ObjectDataSource doesn t appear to be correctly caching the data or only caches the data sporadically, close some applications to free memory and try again.</span></span>

<span data-ttu-id="ee982-265">Obrázek 12 znázorňuje pracovní postup pro ukládání do mezipaměti ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="ee982-265">Figure 12 illustrates the ObjectDataSource s caching workflow.</span></span> <span data-ttu-id="ee982-266">Když se na obrazovce zobrazí text, který vyvolal událost, je to způsobeno tím, že data nebyla v mezipaměti a musela být načtena z podkladového objektu.</span><span class="sxs-lookup"><span data-stu-id="ee982-266">When the Selecting event fired text appears on your screen, it is because the data was not in the cache and had to be retrieved from the underlying object.</span></span> <span data-ttu-id="ee982-267">V případě, že tento text chybí, ale s tím, že data byla k dispozici z mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-267">When this text is missing, however, it s because the data was available from the cache.</span></span> <span data-ttu-id="ee982-268">Když se data vrátí z mezipaměti, neproběhne žádné volání podkladového objektu a proto se neprovede žádné dotazy databáze.</span><span class="sxs-lookup"><span data-stu-id="ee982-268">When the data is returned from the cache there s no call to the underlying object and, therefore, no database query executed.</span></span>

![Prvek ObjectDataSource ukládá a načítá jeho data z mezipaměti dat.](caching-data-with-the-objectdatasource-vb/_static/image30.png)

<span data-ttu-id="ee982-270">**Obrázek 12**: prvek ObjectDataSource uchovává a načítá jeho data z mezipaměti dat.</span><span class="sxs-lookup"><span data-stu-id="ee982-270">**Figure 12**: The ObjectDataSource Stores and Retrieves its Data from the Data Cache</span></span>

<span data-ttu-id="ee982-271">Každá aplikace ASP.NET má svou vlastní instanci mezipaměti dat, která se sdílí se všemi stránkami a návštěvníky.</span><span class="sxs-lookup"><span data-stu-id="ee982-271">Each ASP.NET application has its own data cache instance that s shared across all pages and visitors.</span></span> <span data-ttu-id="ee982-272">To znamená, že data uložená v mezipaměti dat v prvku ObjectDataSource jsou podobně sdílena ve všech uživatelích, kteří stránku navštívili.</span><span class="sxs-lookup"><span data-stu-id="ee982-272">That means that the data stored in the data cache by the ObjectDataSource is likewise shared across all users who visit the page.</span></span> <span data-ttu-id="ee982-273">Pokud to chcete ověřit, otevřete stránku `ObjectDataSource.aspx` v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="ee982-273">To verify this, open the `ObjectDataSource.aspx` page in a browser.</span></span> <span data-ttu-id="ee982-274">Při první návštěvě stránky se zobrazí text vyvolaná událost, která se zobrazí (za předpokladu, že byla data přidaná do mezipaměti pomocí předchozích testů) vyřazením z tohoto okamžiku vyřazena.</span><span class="sxs-lookup"><span data-stu-id="ee982-274">When first visiting the page, the Selecting event fired text will appear (assuming that the data added to the cache by previous tests has, by now, been evicted).</span></span> <span data-ttu-id="ee982-275">Otevřete druhou instanci prohlížeče a zkopírujte a vložte adresu URL z první instance prohlížeče do druhé.</span><span class="sxs-lookup"><span data-stu-id="ee982-275">Open a second browser instance and copy and paste the URL from the first browser instance to the second.</span></span> <span data-ttu-id="ee982-276">Ve druhé instanci prohlížeče není zobrazen text vyvolaný událostmi, protože používá stejná data uložená v mezipaměti jako první.</span><span class="sxs-lookup"><span data-stu-id="ee982-276">In the second browser instance, the Selecting event fired text is not shown because it s using the same cached data as the first.</span></span>

<span data-ttu-id="ee982-277">Při vkládání načtených dat do mezipaměti prvek ObjectDataSource používá hodnotu klíče mezipaměti, která zahrnuje: hodnoty vlastností `CacheDuration` a `CacheExpirationPolicy`; typ základního byznys objektu používaného prvkem ObjectDataSource, který je zadán prostřednictvím [vlastnosti`TypeName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`v tomto příkladu); hodnota vlastnosti `SelectMethod` a název a hodnoty parametrů v kolekci `SelectParameters`; a hodnoty jeho `StartRowIndex` a `MaximumRows` vlastností, které se používají při implementaci [vlastního stránkování](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span><span class="sxs-lookup"><span data-stu-id="ee982-277">When inserting its retrieved data into the cache, the ObjectDataSource uses a cache key value that includes: the `CacheDuration` and `CacheExpirationPolicy` property values; the type of the underlying business object being used by the ObjectDataSource, which is specified via the [`TypeName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in this example); the value of the `SelectMethod` property and the name and values of the parameters in the `SelectParameters` collection; and the values of its `StartRowIndex` and `MaximumRows` properties, which are used when implementing [custom paging](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span></span>

<span data-ttu-id="ee982-278">Vytvoření hodnoty klíče mezipaměti jako kombinace těchto vlastností zajistí při změně těchto hodnot jedinečnou položku mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-278">Crafting the cache key value as a combination of these properties ensures a unique cache entry as these values change.</span></span> <span data-ttu-id="ee982-279">Například v minulých kurzech jsme se podívali na použití `GetProductsByCategoryID(categoryID)``ProductsBLL` třídy s, který vrátí všechny produkty zadané kategorie.</span><span class="sxs-lookup"><span data-stu-id="ee982-279">For example, in past tutorials we ve looked at using the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)`, which returns all products for a specified category.</span></span> <span data-ttu-id="ee982-280">Jeden uživatel může přijít na stránku a zobrazit nápoje, jejichž `CategoryID` je 1.</span><span class="sxs-lookup"><span data-stu-id="ee982-280">One user might come to the page and view beverages, which has a `CategoryID` of 1.</span></span> <span data-ttu-id="ee982-281">Pokud prvek ObjectDataSource ukládá výsledky do mezipaměti bez ohledu na `SelectParameters` hodnoty, když jiný uživatel přestal na stránku a zobrazit koření v době, kdy byly v mezipaměti uložené nápoje, d uvidí nealkoholické produkty v mezipaměti, nikoli koření.</span><span class="sxs-lookup"><span data-stu-id="ee982-281">If the ObjectDataSource cached its results without regard for the `SelectParameters` values, when another user came to the page to view condiments while the beverages products were in the cache, they d see the cached beverage products rather than condiments.</span></span> <span data-ttu-id="ee982-282">Změnou klíče mezipaměti pomocí těchto vlastností, které zahrnují hodnoty `SelectParameters`, prvek ObjectDataSource udržuje samostatnou položku mezipaměti pro nápoje a koření.</span><span class="sxs-lookup"><span data-stu-id="ee982-282">By varying the cache key by these properties, which include the values of the `SelectParameters`, the ObjectDataSource maintains a separate cache entry for beverages and condiments.</span></span>

## <a name="stale-data-concerns"></a><span data-ttu-id="ee982-283">Obavy o zastaralá data</span><span class="sxs-lookup"><span data-stu-id="ee982-283">Stale Data Concerns</span></span>

<span data-ttu-id="ee982-284">Prvek ObjectDataSource automaticky vyřadí své položky z mezipaměti, když je vyvolána kterákoli z jeho `Insert`, `Update`nebo `Delete` metod.</span><span class="sxs-lookup"><span data-stu-id="ee982-284">The ObjectDataSource automatically evicts its items from the cache when any one of its `Insert`, `Update`, or `Delete` methods is invoked.</span></span> <span data-ttu-id="ee982-285">To pomáhá chránit před zastaralými daty tím, že při změně dat na stránce vymaže položky mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-285">This helps protect against stale data by clearing out the cache entries when the data is modified through the page.</span></span> <span data-ttu-id="ee982-286">Je však možné, že prvek ObjectDataSource používá ukládání do mezipaměti a stále zobrazuje zastaralá data.</span><span class="sxs-lookup"><span data-stu-id="ee982-286">However, it is possible for an ObjectDataSource using caching to still display stale data.</span></span> <span data-ttu-id="ee982-287">V nejjednodušším případě může to být způsobeno tím, že se data mění přímo v rámci databáze.</span><span class="sxs-lookup"><span data-stu-id="ee982-287">In the simplest case, it can be due to the data changing directly within the database.</span></span> <span data-ttu-id="ee982-288">Správce databáze pravděpodobně právě spustil skript, který mění některé záznamy v databázi.</span><span class="sxs-lookup"><span data-stu-id="ee982-288">Perhaps a database administrator just ran a script that modifies some of the records in the database.</span></span>

<span data-ttu-id="ee982-289">Tento scénář může také odložení jemným způsobem.</span><span class="sxs-lookup"><span data-stu-id="ee982-289">This scenario could also unfold in a more subtle way.</span></span> <span data-ttu-id="ee982-290">I když prvek ObjectDataSource vyloučí své položky z mezipaměti, když je volána jedna z jeho metod změny dat, odebrané položky v mezipaměti jsou pro konkrétní kombinaci vlastností prvků ObjectDataSource (`CacheDuration`, `TypeName`, `SelectMethod`a tak dále).</span><span class="sxs-lookup"><span data-stu-id="ee982-290">While the ObjectDataSource evicts its items from the cache when one of its data modification methods is called, the cached items removed are for the ObjectDataSource s particular combination of property values (`CacheDuration`, `TypeName`, `SelectMethod`, and so on).</span></span> <span data-ttu-id="ee982-291">Pokud máte dvě ObjectDataSource, které používají různé `SelectMethods` nebo `SelectParameters`, ale stále mohou aktualizovat stejná data, pak jedna prvek ObjectDataSource může aktualizovat řádek a zrušit platnost svých záznamů v mezipaměti, ale odpovídající řádek pro druhý prvek ObjectDataSource bude i nadále obsluhován z mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-291">If you have two ObjectDataSources that use different `SelectMethods` or `SelectParameters`, but still can update the same data, then one ObjectDataSource may update a row and invalidate its own cache entries, but the corresponding row for the second ObjectDataSource will still be served from the cached.</span></span> <span data-ttu-id="ee982-292">Doporučuje se vytvářet stránky, na které se tato funkce projeví.</span><span class="sxs-lookup"><span data-stu-id="ee982-292">I encourage you to create pages to exhibit this functionality.</span></span> <span data-ttu-id="ee982-293">Vytvořte stránku, která zobrazí upravitelnou datovou prvek GridView, který načte svá data z prvku ObjectDataSource, který používá ukládání do mezipaměti a je nakonfigurován pro získání dat z `GetProducts()` metody `ProductsBLL` třídy s.</span><span class="sxs-lookup"><span data-stu-id="ee982-293">Create a page that displays an editable GridView that pulls its data from an ObjectDataSource that uses caching and is configured to get data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="ee982-294">Přidejte další upravitelný prvek GridView a prvek ObjectDataSource na tuto stránku (nebo jinou), ale pro tuto druhou prvek ObjectDataSource použijte metodu `GetProductsByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="ee982-294">Add another editable GridView and ObjectDataSource to this page (or another one), but for this second ObjectDataSource have it use the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="ee982-295">Vzhledem k tomu, že se tyto dva ObjectDataSource `SelectMethod` vlastnosti liší, každá z nich má své vlastní hodnoty uložené v mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-295">Since the two ObjectDataSources `SelectMethod` properties differ, they ll each have their own cached values.</span></span> <span data-ttu-id="ee982-296">Pokud upravíte produkt v jedné mřížce, při příštím navázání dat zpět do jiné mřížky (po stránkování, řazení atd.) bude i nadále fungovat stará data uložená v mezipaměti a nebudou odrážet změny provedené z jiné mřížky.</span><span class="sxs-lookup"><span data-stu-id="ee982-296">If you edit a product in one grid, the next time you bind the data back to the other grid (by paging, sorting, and so forth), it will still serve the old, cached data and not reflect the change that was made from the other grid.</span></span>

<span data-ttu-id="ee982-297">V krátké době vyprší jenom vypršení platnosti, pokud jste si ochotni mít možnost mít zastaralá data a využijete kratší vypršení platnosti pro scénáře, ve kterých je aktuálnost dat důležité.</span><span class="sxs-lookup"><span data-stu-id="ee982-297">In short, only use time-based expiries if you are willing to have the potential of stale data, and use shorter expiries for scenarios where the freshness of data is important.</span></span> <span data-ttu-id="ee982-298">Pokud nejsou zastaralá data přijatelná, buď nepovolí ukládání do mezipaměti, nebo použití závislostí mezipaměti SQL (za předpokladu, že se jedná o databázová data, která jste</span><span class="sxs-lookup"><span data-stu-id="ee982-298">If stale data is not acceptable, either forgo caching or use SQL cache dependencies (assuming it is database data you re caching).</span></span> <span data-ttu-id="ee982-299">Závislosti mezipaměti SQL prozkoumáme v budoucím kurzu.</span><span class="sxs-lookup"><span data-stu-id="ee982-299">We'll explore SQL cache dependencies in a future tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="ee982-300">Přehled</span><span class="sxs-lookup"><span data-stu-id="ee982-300">Summary</span></span>

<span data-ttu-id="ee982-301">V tomto kurzu jsme prozkoumali integrované možnosti ukládání do mezipaměti v prvku ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="ee982-301">In this tutorial we examined the ObjectDataSource s built-in caching capabilities.</span></span> <span data-ttu-id="ee982-302">Pouhým nastavením několika vlastností můžeme ovládacím prvkem ObjectDataSource dát do mezipaměti výsledky vrácené ze zadaného `SelectMethod` do mezipaměti dat ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="ee982-302">By simply setting a few properties, we can instruct the ObjectDataSource to cache the results returned from the specified `SelectMethod` into the ASP.NET data cache.</span></span> <span data-ttu-id="ee982-303">Vlastnosti `CacheDuration` a `CacheExpirationPolicy` označují dobu, po kterou je položka ukládána do mezipaměti, a zda se jedná o absolutní nebo klouzavé vypršení platnosti.</span><span class="sxs-lookup"><span data-stu-id="ee982-303">The `CacheDuration` and `CacheExpirationPolicy` properties indicate the duration the item is cached and whether it is an absolute or sliding expiration.</span></span> <span data-ttu-id="ee982-304">Vlastnost `CacheKeyDependency` přidružuje všechny položky mezipaměti ObjectDataSource s existující závislostí mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-304">The `CacheKeyDependency` property associates all of the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="ee982-305">To lze použít k vyřazení položek ObjectDataSource s z mezipaměti před dosažením vypršení časového limitu, který se obvykle používá u závislostí mezipaměti SQL.</span><span class="sxs-lookup"><span data-stu-id="ee982-305">This can be used to evict the ObjectDataSource s entries from the cache before the time-based expiration is reached, and is typically used with SQL cache dependencies.</span></span>

<span data-ttu-id="ee982-306">Vzhledem k tomu, že prvek ObjectDataSource jednoduše ukládá do mezipaměti své hodnoty do mezipaměti dat, můžeme programově replikovat vestavěnou funkci ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="ee982-306">Since the ObjectDataSource simply caches its values to the data cache, we could replicate the ObjectDataSource s built-in functionality programmatically.</span></span> <span data-ttu-id="ee982-307">Nevyužívá smysl k tomu, aby to provedla v prezentační vrstvě, protože prvek ObjectDataSource tuto funkci nabízí mimo pole, ale v samostatné vrstvě architektury můžeme implementovat funkce ukládání do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="ee982-307">It doesn t make sense to do this at the Presentation Layer, since the ObjectDataSource offers this functionality out of the box, but we can implement caching capabilities in a separate layer of the architecture.</span></span> <span data-ttu-id="ee982-308">K tomu musíme opakovat stejnou logiku, jakou používá prvek ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ee982-308">To do so, we'll need to repeat the same logic used by the ObjectDataSource.</span></span> <span data-ttu-id="ee982-309">Podíváme se, jak programově pracovat s datovou mezipamětí v rámci architektury v našem dalším kurzu.</span><span class="sxs-lookup"><span data-stu-id="ee982-309">We'll explore how to programmatically work with the data cache from within the architecture in our next tutorial.</span></span>

<span data-ttu-id="ee982-310">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="ee982-310">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="ee982-311">Další čtení</span><span class="sxs-lookup"><span data-stu-id="ee982-311">Further Reading</span></span>

<span data-ttu-id="ee982-312">Další informace o tématech popsaných v tomto kurzu najdete v následujících zdrojích informací:</span><span class="sxs-lookup"><span data-stu-id="ee982-312">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="ee982-313">ASP.NET Caching: postupy a osvědčené postupy</span><span class="sxs-lookup"><span data-stu-id="ee982-313">ASP.NET Caching: Techniques and Best Practices</span></span>](https://msdn.microsoft.com/library/aa478965.aspx)
- [<span data-ttu-id="ee982-314">Průvodce architekturou ukládání do mezipaměti pro aplikace .NET Framework</span><span class="sxs-lookup"><span data-stu-id="ee982-314">Caching Architecture Guide for .NET Framework Applications</span></span>](https://msdn.microsoft.com/library/ee817645.aspx)
- [<span data-ttu-id="ee982-315">Ukládání výstupu do mezipaměti v ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="ee982-315">Output Caching in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="ee982-316">O autorovi</span><span class="sxs-lookup"><span data-stu-id="ee982-316">About the Author</span></span>

<span data-ttu-id="ee982-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor 7 ASP/ASP. NET Books a zakladatel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="ee982-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ee982-318">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="ee982-318">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ee982-319">Nejnovější kniha je [*Sams naučit se ASP.NET 2,0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="ee982-319">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ee982-320">Dá se získat na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ee982-320">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="ee982-321">nebo prostřednictvím svého blogu, který najdete na adrese [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="ee982-321">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ee982-322">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="ee982-322">Special Thanks To</span></span>

<span data-ttu-id="ee982-323">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="ee982-323">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ee982-324">Kontrolor pro tento kurz byl Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="ee982-324">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="ee982-325">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="ee982-325">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ee982-326">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ee982-326">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ee982-327">[Předchozí](using-sql-cache-dependencies-cs.md)
> [Další](caching-data-in-the-architecture-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ee982-327">[Previous](using-sql-cache-dependencies-cs.md)
[Next](caching-data-in-the-architecture-vb.md)</span></span>
