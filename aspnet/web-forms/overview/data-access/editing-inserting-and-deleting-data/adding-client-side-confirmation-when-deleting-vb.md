---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
title: Přidání potvrzení na straně klienta při odstraňování (VB) | Microsoft Docs
author: rick-anderson
description: V rozhraních, které jsme doposud vytvořili, může uživatel omylem odstranit data kliknutím na tlačítko Odstranit, když chtějí kliknout na tlačítko Upravit. V této t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 6331e02e-c465-4cdf-bd3f-f07680c289d6
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: addb5a1fdc5793309388c5f06b44fb3b145bc102
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78610514"
---
# <a name="adding-client-side-confirmation-when-deleting-vb"></a><span data-ttu-id="1d855-104">Přidání potvrzení odstranění na straně klienta (VB)</span><span class="sxs-lookup"><span data-stu-id="1d855-104">Adding Client-Side Confirmation When Deleting (VB)</span></span>

<span data-ttu-id="1d855-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1d855-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1d855-106">[Stáhnout ukázkovou aplikaci](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) nebo [Stáhnout PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1d855-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) or [Download PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span></span>

> <span data-ttu-id="1d855-107">V rozhraních, které jsme doposud vytvořili, může uživatel omylem odstranit data kliknutím na tlačítko Odstranit, když chtějí kliknout na tlačítko Upravit.</span><span class="sxs-lookup"><span data-stu-id="1d855-107">In the interfaces we've created so far, a user can accidentally delete data by clicking the Delete button when they meant to click the Edit button.</span></span> <span data-ttu-id="1d855-108">V tomto kurzu přidáme potvrzovací dialog na straně klienta, který se zobrazí po kliknutí na tlačítko pro odstranění.</span><span class="sxs-lookup"><span data-stu-id="1d855-108">In this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

## <a name="introduction"></a><span data-ttu-id="1d855-109">Úvod</span><span class="sxs-lookup"><span data-stu-id="1d855-109">Introduction</span></span>

<span data-ttu-id="1d855-110">V posledních několika kurzech jsme se seznámili s tím, jak používat naši architekturu aplikace, prvek ObjectDataSource a datově webové ovládací prvky, které poskytují funkce pro vkládání, úpravy a odstraňování.</span><span class="sxs-lookup"><span data-stu-id="1d855-110">Over the past several tutorials we ve seen how to use our application architecture, ObjectDataSource, and the data Web controls in concert to provide inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="1d855-111">Odstranění rozhraní, které jsme zkoumali, jsme doposud sestavili pomocí tlačítka odstranit, které po kliknutí způsobí postback a vyvolá metodu ObjectDataSource `Delete()`.</span><span class="sxs-lookup"><span data-stu-id="1d855-111">The deleting interfaces we ve examined thus far have been composed of a Delete button that, when clicked, causes a postback and invokes the ObjectDataSource s `Delete()` method.</span></span> <span data-ttu-id="1d855-112">Metoda `Delete()` potom vyvolá nakonfigurovanou metodu z vrstvy obchodní logiky, která rozšíří volání dolů do vrstvy přístupu k datům, a vydává v databázi skutečný příkaz `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="1d855-112">The `Delete()` method then invokes the configured method from the Business Logic Layer, which propagates the call down to the Data Access Layer, issuing the actual `DELETE` statement to the database.</span></span>

<span data-ttu-id="1d855-113">Toto uživatelské rozhraní sice umožňuje návštěvníkům odstraňovat záznamy prostřednictvím ovládacích prvků GridView, DetailsView nebo FormView, ale nemá žádné řazení potvrzení, když uživatel klikne na tlačítko Odstranit.</span><span class="sxs-lookup"><span data-stu-id="1d855-113">While this user interface enables visitors to delete records through the GridView, DetailsView, or FormView controls, it lacks any sort of confirmation when the user clicks the Delete button.</span></span> <span data-ttu-id="1d855-114">Pokud uživatel omylem klikne na tlačítko Odstranit, když chtějí kliknout na upravit, místo toho se odstraní záznam, který chtěl aktualizovat.</span><span class="sxs-lookup"><span data-stu-id="1d855-114">If a user accidentally clicks the Delete button when they meant to click Edit, the record they meant to update will instead be deleted.</span></span> <span data-ttu-id="1d855-115">Aby k tomu nedocházelo, v tomto kurzu přidáme potvrzovací dialog na straně klienta, který se zobrazí po kliknutí na tlačítko pro odstranění.</span><span class="sxs-lookup"><span data-stu-id="1d855-115">To help prevent this, in this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

<span data-ttu-id="1d855-116">Funkce `confirm(string)` JavaScriptu zobrazí svůj vstupní parametr řetězce jako text uvnitř modálního dialogového okna, které je vybavené dvěma tlačítky-OK a zrušit (viz obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="1d855-116">The JavaScript `confirm(string)` function displays its string input parameter as the text inside a modal dialog box that comes equipped with two buttons - OK and Cancel (see Figure 1).</span></span> <span data-ttu-id="1d855-117">Funkce `confirm(string)` vrací logickou hodnotu v závislosti na tlačítku, na které je kliknuto (`true`, pokud uživatel klikne na tlačítko OK a `false` Pokud klikne na tlačítko Storno).</span><span class="sxs-lookup"><span data-stu-id="1d855-117">The `confirm(string)` function returns a Boolean value depending on what button is clicked (`true`, if the user clicks OK, and `false` if they click Cancel).</span></span>

![Metoda potvrdit (String) pro JavaScript zobrazuje modální objekt MessageBox na straně klienta.](adding-client-side-confirmation-when-deleting-vb/_static/image1.png)

<span data-ttu-id="1d855-119">**Obrázek 1**: metoda `confirm(string)` JavaScriptu zobrazuje modální, objekt MessageBox na straně klienta</span><span class="sxs-lookup"><span data-stu-id="1d855-119">**Figure 1**: The JavaScript `confirm(string)` Method Displays a Modal, Client-Side Messagebox</span></span>

<span data-ttu-id="1d855-120">Pokud je při odeslání formuláře vrácena hodnota `false`a z obslužné rutiny události na straně klienta, odeslání formuláře se zruší.</span><span class="sxs-lookup"><span data-stu-id="1d855-120">During a form submission, if a value of `false` is returned from a client-side event handler then the form submission is cancelled.</span></span> <span data-ttu-id="1d855-121">Tato funkce umožňuje, aby obslužná rutina události Odstranit tlačítko `onclick` na straně klienta vrátila hodnotu volání `confirm("Are you sure you want to delete this product?")`.</span><span class="sxs-lookup"><span data-stu-id="1d855-121">Using this feature, we can have the Delete button s client-side `onclick` event handler return the value of a call to `confirm("Are you sure you want to delete this product?")`.</span></span> <span data-ttu-id="1d855-122">Pokud uživatel klikne na tlačítko Storno, `confirm(string)` vrátí hodnotu false, což způsobí, že odeslání formuláře bude zrušeno.</span><span class="sxs-lookup"><span data-stu-id="1d855-122">If the user clicks Cancel, `confirm(string)` will return false, thereby causing the form submission to cancel.</span></span> <span data-ttu-id="1d855-123">Bez postbacku se neodstraní produkt, na kterém bylo tlačítko pro odstranění kliknuto.</span><span class="sxs-lookup"><span data-stu-id="1d855-123">With no postback, the product whose Delete button was clicked won't be deleted.</span></span> <span data-ttu-id="1d855-124">Pokud však uživatel klikne na tlačítko OK v potvrzovacím dialogovém okně, bude zpětné volání pokračovat unabated a produkt bude odstraněn.</span><span class="sxs-lookup"><span data-stu-id="1d855-124">If, however, the user clicks OK in the confirmation dialog box, the postback will continue unabated and the product will be deleted.</span></span> <span data-ttu-id="1d855-125">Další informace o této technice naleznete v [použití `confirm()` metody JavaScriptu k řízení odesílání formuláře](http://www.webreference.com/programming/javascript/confirm/) .</span><span class="sxs-lookup"><span data-stu-id="1d855-125">Consult [Using JavaScript s `confirm()` Method to Control Form Submission](http://www.webreference.com/programming/javascript/confirm/) for more information on this technique.</span></span>

<span data-ttu-id="1d855-126">Přidání potřebného skriptu na straně klienta se mírně liší při použití šablon než při použití CommandField.</span><span class="sxs-lookup"><span data-stu-id="1d855-126">Adding the necessary client-side script differs slightly if using templates than when using a CommandField.</span></span> <span data-ttu-id="1d855-127">Proto se v tomto kurzu podíváme na příklad FormView a GridView.</span><span class="sxs-lookup"><span data-stu-id="1d855-127">Therefore, in this tutorial we will look at both a FormView and GridView example.</span></span>

> [!NOTE]
> <span data-ttu-id="1d855-128">Pomocí technik potvrzení na straně klienta, podobně jako u těch, které jsou popsány v tomto kurzu, předpokládá, že uživatelé budou navštěvovat prohlížeče, které podporují JavaScript a mají povolený JavaScript.</span><span class="sxs-lookup"><span data-stu-id="1d855-128">Using client-side confirmation techniques, like the ones discussed in this tutorial, assumes that your users are visiting with browsers that support JavaScript and that they have JavaScript enabled.</span></span> <span data-ttu-id="1d855-129">Pokud některé z těchto předpokladů nejsou pro konkrétního uživatele pravdivé, kliknutí na tlačítko Odstranit okamžitě způsobí postback (nezobrazuje potvrzení MessageBox).</span><span class="sxs-lookup"><span data-stu-id="1d855-129">If either of these assumptions are not true for a particular user, clicking the Delete button will immediately cause a postback (not displaying a confirm messagebox).</span></span>

## <a name="step-1-creating-a-formview-that-supports-deletion"></a><span data-ttu-id="1d855-130">Krok 1: vytvoření třídy FormView podporující odstranění</span><span class="sxs-lookup"><span data-stu-id="1d855-130">Step 1: Creating a FormView That Supports Deletion</span></span>

<span data-ttu-id="1d855-131">Začněte přidáním třídy FormView na stránku `ConfirmationOnDelete.aspx` ve složce `EditInsertDelete` a vytvořte její vazbu na nový prvek ObjectDataSource, který vrátí zpět informace o produktu prostřednictvím metody `ProductsBLL` třídy s `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="1d855-131">Start by adding a FormView to the `ConfirmationOnDelete.aspx` page in the `EditInsertDelete` folder, binding it to a new ObjectDataSource that pulls back the product information via the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="1d855-132">Také prvek ObjectDataSource nakonfigurujte tak, aby byla metoda `ProductsBLL` třídy s `DeleteProduct(productID)` namapována na metodu ObjectDataSource s `Delete()`. Zajistěte, aby se v rozevíracích seznamech pro vložení a aktualizaci nastavily (žádné).</span><span class="sxs-lookup"><span data-stu-id="1d855-132">Also configure the ObjectDataSource so that the `ProductsBLL` class s `DeleteProduct(productID)` method is mapped to the ObjectDataSource s `Delete()` method; ensure that the INSERT and UPDATE tabs drop-down lists are set to (None).</span></span> <span data-ttu-id="1d855-133">Nakonec zaškrtněte políčko Povolit stránkování v inteligentní značce FormView s.</span><span class="sxs-lookup"><span data-stu-id="1d855-133">Finally, check the Enable Paging checkbox in the FormView s smart tag.</span></span>

<span data-ttu-id="1d855-134">Po provedení tohoto postupu budou nové deklarativní označení ObjectDataSource s vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="1d855-134">After these steps, the new ObjectDataSource s declarative markup will look like the following:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample1.aspx)]

<span data-ttu-id="1d855-135">Stejně jako v předchozích příkladech, které nepoužívaly optimistickou souběžnost, je třeba vymazat vlastnost ObjectDataSource s `OldValuesParameterFormatString`.</span><span class="sxs-lookup"><span data-stu-id="1d855-135">As in our past examples that did not use optimistic concurrency, take a moment to clear out the ObjectDataSource s `OldValuesParameterFormatString` property.</span></span>

<span data-ttu-id="1d855-136">Vzhledem k tomu, že byl svázán s ovládacím prvkem ObjectDataSource, který podporuje pouze odstranění, `ItemTemplate` FormView s nabízí pouze tlačítko Odstranit a nemá nové a aktualizovat tlačítka.</span><span class="sxs-lookup"><span data-stu-id="1d855-136">Since it has been bound to an ObjectDataSource control that only supports deleting, the FormView s `ItemTemplate` offers only the Delete button, lacking the New and Update buttons.</span></span> <span data-ttu-id="1d855-137">Deklarativní označení FormView s obsahuje nadbytečné `EditItemTemplate` a `InsertItemTemplate`, které je možné odebrat.</span><span class="sxs-lookup"><span data-stu-id="1d855-137">The FormView s declarative markup, however, includes a superfluous `EditItemTemplate` and `InsertItemTemplate`, which can be removed.</span></span> <span data-ttu-id="1d855-138">Věnujte prosím chvíli přizpůsobení `ItemTemplate` tak, aby se zobrazila pouze podmnožina datových polí produktu.</span><span class="sxs-lookup"><span data-stu-id="1d855-138">Take a moment to customize the `ItemTemplate` so that is shows only a subset of the product data fields.</span></span> <span data-ttu-id="1d855-139">Nakonfigurovali jsem mi, aby se název produktu zobrazil v `<h3>`ovém nadpisu nad názvem dodavatele a kategorie (společně s tlačítkem odstranit).</span><span class="sxs-lookup"><span data-stu-id="1d855-139">I ve configured mine to show the product s name in an `<h3>` heading above its supplier and category names (along with the Delete button).</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="1d855-140">Díky těmto změnám máme plně funkční webovou stránku, která umožňuje uživateli postupně přepínat produkty, a to tak, že jednoduše kliknete na tlačítko Odstranit.</span><span class="sxs-lookup"><span data-stu-id="1d855-140">With these changes, we have a fully functional web page that allows a user to toggle through the products one at a time, with the ability to delete a product by simply clicking the Delete button.</span></span> <span data-ttu-id="1d855-141">Na obrázku 2 se po zobrazení v prohlížeči zobrazí snímek obrazovky s naším průběhem.</span><span class="sxs-lookup"><span data-stu-id="1d855-141">Figure 2 shows a screen shot of our progress thus far when viewed through a browser.</span></span>

<span data-ttu-id="1d855-142">[![FormView zobrazí informace o jednom produktu.](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="1d855-142">[![The FormView Shows Information About a Single Product](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span></span>

<span data-ttu-id="1d855-143">**Obrázek 2**: třída FormView zobrazuje informace o jednom produktu ([kliknutím zobrazíte obrázek v plné velikosti).](adding-client-side-confirmation-when-deleting-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="1d855-143">**Figure 2**: The FormView Shows Information About a Single Product ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span></span>

## <a name="step-2-calling-the-confirmstring-function-from-the-delete-buttons-client-side-onclick-event"></a><span data-ttu-id="1d855-144">Krok 2: volání funkce potvrdit (String) z události při kliknutí na tlačítko pro odstranění na straně klienta</span><span class="sxs-lookup"><span data-stu-id="1d855-144">Step 2: Calling the confirm(string) Function from the Delete Buttons Client-Side onclick Event</span></span>

<span data-ttu-id="1d855-145">Při vytvoření třídy FormView je posledním krokem konfigurace tlačítka odstranit tak, že když na něj kliká návštěvník, vyvolá se funkce JavaScript `confirm(string)`.</span><span class="sxs-lookup"><span data-stu-id="1d855-145">With the FormView created, the final step is to configure the Delete button such that when it s clicked by the visitor, the JavaScript `confirm(string)` function is invoked.</span></span> <span data-ttu-id="1d855-146">Přidání skriptu na straně klienta k události `onclick` tlačítkem, LinkButton nebo obrázkové s na straně klienta se dá provést pomocí `OnClientClick property`, která je v ASP.NET 2,0 nová.</span><span class="sxs-lookup"><span data-stu-id="1d855-146">Adding client-side script to a Button, LinkButton, or ImageButton s client-side `onclick` event can be accomplished through the use of the `OnClientClick property`, which is new to ASP.NET 2.0.</span></span> <span data-ttu-id="1d855-147">Vzhledem k tomu, že chceme mít vrácenou hodnotu funkce `confirm(string)`, jednoduše nastavte tuto vlastnost na: `return confirm('Are you certain that you want to delete this product?');`</span><span class="sxs-lookup"><span data-stu-id="1d855-147">Since we want to have the value of the `confirm(string)` function returned, simply set this property to: `return confirm('Are you certain that you want to delete this product?');`</span></span>

<span data-ttu-id="1d855-148">Po této změně by deklarativní syntaxe odstranit LinkButton s měla vypadat nějak takto:</span><span class="sxs-lookup"><span data-stu-id="1d855-148">After this change the Delete LinkButton s declarative syntax should look something like:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="1d855-149">To všechno je!</span><span class="sxs-lookup"><span data-stu-id="1d855-149">That s all there is to it!</span></span> <span data-ttu-id="1d855-150">Obrázek 3 ukazuje snímek obrazovky s tímto potvrzením v akci.</span><span class="sxs-lookup"><span data-stu-id="1d855-150">Figure 3 shows a screen shot of this confirmation in action.</span></span> <span data-ttu-id="1d855-151">Kliknutím na tlačítko Odstranit zobrazíte dialogové okno Potvrdit.</span><span class="sxs-lookup"><span data-stu-id="1d855-151">Clicking the Delete button brings up the confirm dialog box.</span></span> <span data-ttu-id="1d855-152">Pokud uživatel klikne na zrušit, zpětné volání se zruší a produkt se neodstraní.</span><span class="sxs-lookup"><span data-stu-id="1d855-152">If the user clicks Cancel, the postback is cancelled and the product is not deleted.</span></span> <span data-ttu-id="1d855-153">Pokud však uživatel klikne na tlačítko OK, zpětné volání pokračuje a je vyvolána metoda ObjectDataSource s `Delete()`, ukončené záznamem v záznamu databáze.</span><span class="sxs-lookup"><span data-stu-id="1d855-153">If, however, the user clicks OK, the postback continues and the ObjectDataSource s `Delete()` method is invoked, culminating in the database record being deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="1d855-154">Řetězec předaný do funkce `confirm(string)` JavaScriptu je oddělen apostrofy (spíše než uvozovky).</span><span class="sxs-lookup"><span data-stu-id="1d855-154">The string passed into the `confirm(string)` JavaScript function is delimited with apostrophes (rather than quotation marks).</span></span> <span data-ttu-id="1d855-155">V jazyce JavaScript mohou být řetězce odděleny pomocí obou znaků.</span><span class="sxs-lookup"><span data-stu-id="1d855-155">In JavaScript, strings can be delimited using either character.</span></span> <span data-ttu-id="1d855-156">Tady používáme apostrofy, aby oddělovače řetězce předaných do `confirm(string)` nevedly k nejednoznačnosti s oddělovači použitými pro hodnotu vlastnosti `OnClientClick`.</span><span class="sxs-lookup"><span data-stu-id="1d855-156">We use apostrophes here so that the delimiters for the string passed into `confirm(string)` do not introduce an ambiguity with the delimiters used for the `OnClientClick` property value.</span></span>

<span data-ttu-id="1d855-157">[Po kliknutí na tlačítko Odstranit se teď zobrazí ![potvrzení.](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="1d855-157">[![A Confirmation is Now Displayed When Clicking the Delete Button](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="1d855-158">**Obrázek 3**: po kliknutí na tlačítko Odstranit se teď zobrazí potvrzení ([kliknutím zobrazíte obrázek v plné velikosti](adding-client-side-confirmation-when-deleting-vb/_static/image7.png)).</span><span class="sxs-lookup"><span data-stu-id="1d855-158">**Figure 3**: A Confirmation is Now Displayed When Clicking the Delete Button ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span></span>

## <a name="step-3-configuring-the-onclientclick-property-for-the-delete-button-in-a-commandfield"></a><span data-ttu-id="1d855-159">Krok 3: Konfigurace vlastnosti OnClientClick pro tlačítko Odstranit v CommandField</span><span class="sxs-lookup"><span data-stu-id="1d855-159">Step 3: Configuring the OnClientClick Property for the Delete Button in a CommandField</span></span>

<span data-ttu-id="1d855-160">Při práci s tlačítkem, LinkButton nebo obrázkové přímo v šabloně můžete k ní přidružit potvrzovací dialog tak, že jednoduše nakonfigurujete jeho vlastnost `OnClientClick`, aby vracela výsledky funkce JavaScriptu `confirm(string)`.</span><span class="sxs-lookup"><span data-stu-id="1d855-160">When working with a Button, LinkButton, or ImageButton directly in a template, a confirmation dialog box can be associated with it by simply configuring its `OnClientClick` property to return the results of the JavaScript `confirm(string)` function.</span></span> <span data-ttu-id="1d855-161">Nicméně CommandField, který přidá pole pro odstranění do prvku GridView nebo DetailsView – nemá vlastnost `OnClientClick`, která může být nastavena deklarativně.</span><span class="sxs-lookup"><span data-stu-id="1d855-161">However, the CommandField - which adds a field of Delete buttons to a GridView or DetailsView - does not have an `OnClientClick` property that can be set declaratively.</span></span> <span data-ttu-id="1d855-162">Místo toho je nutné programově odkázat na tlačítko Odstranit v prvku GridView nebo DetailsView odpovídajícím `DataBound` obslužné rutiny události a následně nastavit jeho vlastnost `OnClientClick`.</span><span class="sxs-lookup"><span data-stu-id="1d855-162">Instead, we must programmatically reference the Delete button in the GridView or DetailsView s appropriate `DataBound` event handler, and then set its `OnClientClick` property there.</span></span>

> [!NOTE]
> <span data-ttu-id="1d855-163">Při nastavení vlastnosti odstranit tlačítka `OnClientClick` v příslušné obslužné rutině události `DataBound` máme přístup k datům, které jsou svázané s aktuálním záznamem.</span><span class="sxs-lookup"><span data-stu-id="1d855-163">When setting the Delete button s `OnClientClick` property in the appropriate `DataBound` event handler, we have access to the data was bound to the current record.</span></span> <span data-ttu-id="1d855-164">To znamená, že můžeme zvětšit zprávu s potvrzením, aby obsahovala podrobnosti o konkrétním záznamu, například, opravdu chcete odstranit produkt Chai? "</span><span class="sxs-lookup"><span data-stu-id="1d855-164">This means we can extend the confirmation message to include details about the particular record, such as, "Are you sure you want to delete the Chai product?"</span></span> <span data-ttu-id="1d855-165">Toto přizpůsobení je možné také v šablonách pomocí syntaxe DataBinding.</span><span class="sxs-lookup"><span data-stu-id="1d855-165">Such customization is also possible in templates using databinding syntax.</span></span>

<span data-ttu-id="1d855-166">Chcete-li nastavit vlastnost `OnClientClick` pro tlačítka odstranit v CommandField, přidejte na stránku prvek GridView.</span><span class="sxs-lookup"><span data-stu-id="1d855-166">To practice setting the `OnClientClick` property for the Delete button(s) in a CommandField, let s add a GridView to the page.</span></span> <span data-ttu-id="1d855-167">Proveďte konfiguraci tohoto prvku GridView pro použití stejného ovládacího prvku ObjectDataSource, který používá FormView.</span><span class="sxs-lookup"><span data-stu-id="1d855-167">Configure this GridView to use the same ObjectDataSource control that the FormView uses.</span></span> <span data-ttu-id="1d855-168">Také omezte BoundFields prvku GridView s tak, aby obsahovala pouze název produktu, kategorii a dodavatele.</span><span class="sxs-lookup"><span data-stu-id="1d855-168">Also limit the GridView s BoundFields to only include the product s name, category, and supplier.</span></span> <span data-ttu-id="1d855-169">Nakonec zaškrtněte políčko Povolit odstranění z inteligentní značky GridView s.</span><span class="sxs-lookup"><span data-stu-id="1d855-169">Lastly, check the Enable Deleting checkbox from the GridView s smart tag.</span></span> <span data-ttu-id="1d855-170">Tím se přidá CommandField do kolekce GridView `Columns` s vlastností `ShowDeleteButton` nastavenou na `true`.</span><span class="sxs-lookup"><span data-stu-id="1d855-170">This will add a CommandField to the GridView s `Columns` collection with its `ShowDeleteButton` property set to `true`.</span></span>

<span data-ttu-id="1d855-171">Po provedení těchto změn by deklarativní označení GridView s mělo vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="1d855-171">After making these changes, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample4.aspx)]

<span data-ttu-id="1d855-172">CommandField obsahuje jednu instanci LinkButton, ke které lze přistupovat programově z obslužné rutiny události GridView s `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="1d855-172">The CommandField contains a single Delete LinkButton instance that can be accessed programmatically from the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="1d855-173">Po odkazování můžete vlastnost `OnClientClick` nastavit odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="1d855-173">Once referenced, we can set its `OnClientClick` property accordingly.</span></span> <span data-ttu-id="1d855-174">Vytvořte obslužnou rutinu události pro událost `RowDataBound` pomocí následujícího kódu:</span><span class="sxs-lookup"><span data-stu-id="1d855-174">Create an event handler for the `RowDataBound` event using the following code:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample5.vb)]

<span data-ttu-id="1d855-175">Tato obslužná rutina události funguje s řádky dat (ty, které budou mít tlačítko Odstranit) a začínají programově odkazem na tlačítko Odstranit.</span><span class="sxs-lookup"><span data-stu-id="1d855-175">This event handler works with data rows (those that will have the Delete button) and begins by programmatically referencing the Delete button.</span></span> <span data-ttu-id="1d855-176">V části Obecné použijte následující vzor:</span><span class="sxs-lookup"><span data-stu-id="1d855-176">In general use the following pattern:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="1d855-177">*ButtonType* je typ tlačítka používaného CommandField tlačítkem, LinkButton nebo obrázkové.</span><span class="sxs-lookup"><span data-stu-id="1d855-177">*ButtonType* is the type of button being used by the CommandField - Button, LinkButton, or ImageButton.</span></span> <span data-ttu-id="1d855-178">Ve výchozím nastavení CommandField používá LinkButtons, ale lze jej přizpůsobit prostřednictvím `ButtonType property`CommandField s.</span><span class="sxs-lookup"><span data-stu-id="1d855-178">By default, the CommandField uses LinkButtons, but this can be customized via the CommandField s `ButtonType property`.</span></span> <span data-ttu-id="1d855-179">*CommandFieldIndex* je ordinální index CommandField v rámci kolekce GridView `Columns`, zatímco *controlIndex* je indexem tlačítka odstranit v rámci kolekce CommandField s `Controls`.</span><span class="sxs-lookup"><span data-stu-id="1d855-179">The *commandFieldIndex* is the ordinal index of the CommandField within the GridView s `Columns` collection, whereas the *controlIndex* is the index of the Delete button within the CommandField s `Controls` collection.</span></span> <span data-ttu-id="1d855-180">Hodnota *controlIndex* závisí na pozici tlačítka s relativně k ostatním tlačítkům v CommandField.</span><span class="sxs-lookup"><span data-stu-id="1d855-180">The *controlIndex* value depends on the button s position relative to other buttons in the CommandField.</span></span> <span data-ttu-id="1d855-181">Pokud je například jediným tlačítkem zobrazeným v CommandField tlačítko Odstranit, použijte index 0.</span><span class="sxs-lookup"><span data-stu-id="1d855-181">For example, if the only button displayed in the CommandField is the Delete button, use an index of 0.</span></span> <span data-ttu-id="1d855-182">Pokud však existuje tlačítko pro úpravy, které předchází tlačítku odstranit, použijte index 2.</span><span class="sxs-lookup"><span data-stu-id="1d855-182">If, however, there s an Edit button that precedes the Delete button, use an index of 2.</span></span> <span data-ttu-id="1d855-183">Důvod, proč je použit index 2, je, protože před tlačítkem Delete jsou přidány dva ovládací prvky pomocí CommandField: tlačítko Upravit a LiteralControl, které se používají k přidání nějakého prostoru mezi tlačítky upravit a odstranit.</span><span class="sxs-lookup"><span data-stu-id="1d855-183">The reason an index of 2 is used is because two controls are added by the CommandField before the Delete button: the Edit button and a LiteralControl that s used to add some space between the Edit and Delete buttons.</span></span>

<span data-ttu-id="1d855-184">Pro náš konkrétní příklad má CommandField použití LinkButtons a v poli nejvíce vlevo je *commandFieldIndex* 0.</span><span class="sxs-lookup"><span data-stu-id="1d855-184">For our particular example, the CommandField uses LinkButtons and, being the left-most field, has a *commandFieldIndex* of 0.</span></span> <span data-ttu-id="1d855-185">Vzhledem k tomu, že nejsou k dispozici žádná další tlačítka, ale tlačítko Odstranit v CommandField, používáme *controlIndex* 0.</span><span class="sxs-lookup"><span data-stu-id="1d855-185">Since there are no other buttons but the Delete button in the CommandField, we use a *controlIndex* of 0.</span></span>

<span data-ttu-id="1d855-186">Po odkazování na tlačítko Odstranit v CommandField se další informace o produktu sváže s aktuálním řádkem prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="1d855-186">After referencing the Delete button in the CommandField, we next grab information about the product bound to the current GridView row.</span></span> <span data-ttu-id="1d855-187">Nakonec nastavíme vlastnost tlačítka odstranit `OnClientClick` na odpovídající jazyk JavaScript, který obsahuje název produktu.</span><span class="sxs-lookup"><span data-stu-id="1d855-187">Finally, we set the Delete button s `OnClientClick` property to the appropriate JavaScript, which includes the product s name.</span></span> <span data-ttu-id="1d855-188">Vzhledem k tomu, že řetězec jazyka JavaScript předaný do funkce `confirm(string)` je oddělený pomocí apostrofů, je nutné, aby se všechny apostrofy objevily v názvu produktu.</span><span class="sxs-lookup"><span data-stu-id="1d855-188">Since the JavaScript string passed into the `confirm(string)` function is delimited using apostrophes we must escape any apostrophes that appear within the product s name.</span></span> <span data-ttu-id="1d855-189">Konkrétně všechny apostrofy v názvu produktu jsou uvozeny znakem "`\'`".</span><span class="sxs-lookup"><span data-stu-id="1d855-189">In particular, any apostrophes in the product s name are escaped with "`\'`".</span></span>

<span data-ttu-id="1d855-190">Po dokončení těchto změn se kliknutím na tlačítko Odstranit v prvku GridView zobrazí přizpůsobené potvrzovací dialogové okno (viz obrázek 4).</span><span class="sxs-lookup"><span data-stu-id="1d855-190">With these changes complete, clicking on a Delete button in the GridView displays a customized confirmation dialog box (see Figure 4).</span></span> <span data-ttu-id="1d855-191">Stejně jako u ovládacího prvku MessageBox ze třídy FormView, pokud uživatel klikne na zrušit, zpětné volání se zruší, čímž se zabrání v výskytu odstranění.</span><span class="sxs-lookup"><span data-stu-id="1d855-191">As with the confirmation messagebox from the FormView, if the user clicks Cancel the postback is cancelled, thereby preventing the deletion from occurring.</span></span>

> [!NOTE]
> <span data-ttu-id="1d855-192">Tento postup lze také použít k programovému přístupu k tlačítku odstranit v CommandField v prvku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="1d855-192">This technique can also be used to programmatically access the Delete button in the CommandField in a DetailsView.</span></span> <span data-ttu-id="1d855-193">Pro prvek DetailsView však vytvoříte obslužnou rutinu události pro událost `DataBound`, protože prvek DetailsView nemá `RowDataBound` událost.</span><span class="sxs-lookup"><span data-stu-id="1d855-193">For the DetailsView, however, you d create an event handler for the `DataBound` event, since the DetailsView does not have a `RowDataBound` event.</span></span>

<span data-ttu-id="1d855-194">[![kliknutím na tlačítko Odstranit GridView. se zobrazí dialogové okno přizpůsobené potvrzení.](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="1d855-194">[![Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span></span>

<span data-ttu-id="1d855-195">**Obrázek 4**: kliknutím na tlačítko pro odstranění prvku GridView se zobrazí dialogové okno přizpůsobené potvrzení (Kliknutím zobrazíte[obrázek v plné velikosti).](adding-client-side-confirmation-when-deleting-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="1d855-195">**Figure 4**: Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span></span>

## <a name="using-templatefields"></a><span data-ttu-id="1d855-196">Použití vlastností TemplateField</span><span class="sxs-lookup"><span data-stu-id="1d855-196">Using TemplateFields</span></span>

<span data-ttu-id="1d855-197">Jednou z nevýhod CommandField je, že k jeho tlačítkům musí být přistup prostřednictvím indexování a výsledný objekt musí být převeden na odpovídající typ tlačítka (tlačítko, LinkButton nebo obrázkové).</span><span class="sxs-lookup"><span data-stu-id="1d855-197">One of the disadvantages of the CommandField is that its buttons must be accessed through indexing and that the resulting object must be cast to the appropriate button type (Button, LinkButton, or ImageButton).</span></span> <span data-ttu-id="1d855-198">Použití "Magic Numbers" a pevně zakódovaných typů pozve k problémům, které nelze zjistit do doby běhu.</span><span class="sxs-lookup"><span data-stu-id="1d855-198">Using "magic numbers" and hard-coded types invites problems that cannot be discovered until runtime.</span></span> <span data-ttu-id="1d855-199">Například pokud jste vy nebo jiný vývojář, přidá nová tlačítka do CommandField v nějakém okamžiku v budoucnosti (například tlačítko pro úpravy) nebo změní vlastnost `ButtonType`, existující kód bude stále zkompilován bez chyb, ale návštěvě stránky může způsobit výjimku nebo neočekávané chování, v závislosti na tom, jak byl kód napsán a jaké změny byly provedeny.</span><span class="sxs-lookup"><span data-stu-id="1d855-199">For example, if you, or another developer, adds new buttons to the CommandField at some point in the future (such as an Edit button) or changes the `ButtonType` property, the existing code will still compile without error, but visiting the page may cause an exception or unexpected behavior, depending on how your code was written and what changes were made.</span></span>

<span data-ttu-id="1d855-200">Alternativním řešením je převést prvky GridView a DetailsView s CommandFields na TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="1d855-200">An alternative approach is to convert the GridView and DetailsView s CommandFields into TemplateFields.</span></span> <span data-ttu-id="1d855-201">Tím se vygeneruje TemplateField s `ItemTemplate`, který má LinkButton (nebo tlačítko nebo obrázkové) pro každé tlačítko v CommandField.</span><span class="sxs-lookup"><span data-stu-id="1d855-201">This will generate a TemplateField with an `ItemTemplate` that has a LinkButton (or Button or ImageButton) for each button in the CommandField.</span></span> <span data-ttu-id="1d855-202">Tato tlačítka `OnClientClick` vlastností lze přiřadit deklarativně, jak jsme viděli ve třídě FormView, nebo k nim lze programově přistupovat v příslušné obslužné rutině události `DataBound` pomocí následujícího vzoru:</span><span class="sxs-lookup"><span data-stu-id="1d855-202">These buttons `OnClientClick` properties can be assigned declaratively, as we saw with the FormView, or can be programmatically accessed in the appropriate `DataBound` event handler using the following pattern:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="1d855-203">Kde *controlID* je hodnota vlastnosti `ID` tlačítko s tlačítkem.</span><span class="sxs-lookup"><span data-stu-id="1d855-203">Where *controlID* is the value of the button s `ID` property.</span></span> <span data-ttu-id="1d855-204">I když tento model stále vyžaduje pevně zakódovaný typ pro přetypování, odstraňuje nutnost indexování, což umožňuje změnit rozložení, aniž by to vedlo k chybě za běhu.</span><span class="sxs-lookup"><span data-stu-id="1d855-204">While this pattern still requires a hard-coded type for the cast, it removes the need for indexing, allowing for the layout to change without resulting in a runtime error.</span></span>

## <a name="summary"></a><span data-ttu-id="1d855-205">Souhrn</span><span class="sxs-lookup"><span data-stu-id="1d855-205">Summary</span></span>

<span data-ttu-id="1d855-206">Funkce `confirm(string)` JavaScriptu je běžně používaná technika pro řízení pracovního postupu odeslání formuláře.</span><span class="sxs-lookup"><span data-stu-id="1d855-206">The JavaScript `confirm(string)` function is a commonly used technique for controlling form submission workflow.</span></span> <span data-ttu-id="1d855-207">Po spuštění funkce zobrazí modální dialogové okno na straně klienta, které obsahuje dvě tlačítka, OK a Storno.</span><span class="sxs-lookup"><span data-stu-id="1d855-207">When executed, the function displays a modal, client-side dialog box that includes two buttons, OK and Cancel.</span></span> <span data-ttu-id="1d855-208">Pokud uživatel klikne na tlačítko OK, funkce `confirm(string)` vrátí `true`; Kliknutím na zrušit vrátíte `false`.</span><span class="sxs-lookup"><span data-stu-id="1d855-208">If the user clicks OK, the `confirm(string)` function returns `true`; clicking Cancel returns `false`.</span></span> <span data-ttu-id="1d855-209">Tato funkce, která je spojená s chováním prohlížeče s pro zrušení odeslání formuláře, pokud obslužná rutina události během procesu odeslání vrací `false`, lze použít k zobrazení potvrzovacího objektu MessageBox při odstraňování záznamu.</span><span class="sxs-lookup"><span data-stu-id="1d855-209">This functionality, coupled with a browser s behavior to cancel a form submission if an event handler during the submission process returns `false`, can be used to display a confirmation messagebox when deleting a record.</span></span>

<span data-ttu-id="1d855-210">Funkci `confirm(string)` lze přidružit k ovládacímu prvku webového ovládacího prvku tlačítko s `onclick` obslužnou rutinu události na straně klienta prostřednictvím vlastnosti `OnClientClick` ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="1d855-210">The `confirm(string)` function can be associated with a Button Web control s client-side `onclick` event handler through the control s `OnClientClick` property.</span></span> <span data-ttu-id="1d855-211">Při práci s tlačítkem odstranit v šabloně – buď v jedné ze šablon FormView s, nebo v prvku TemplateField v ovládacím prvku DetailsView nebo GridView – Tato vlastnost může být nastavena deklarativně nebo programově, jak jsme viděli v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="1d855-211">When working with a Delete button in a template - either in one of the FormView s templates or in a TemplateField in the DetailsView or GridView - this property can be set either declaratively or programmatically, as we saw in this tutorial.</span></span>

<span data-ttu-id="1d855-212">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="1d855-212">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="1d855-213">O autorovi</span><span class="sxs-lookup"><span data-stu-id="1d855-213">About the Author</span></span>

<span data-ttu-id="1d855-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor 7 ASP/ASP. NET Books a zakladatel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="1d855-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1d855-215">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="1d855-215">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1d855-216">Nejnovější kniha je [*Sams naučit se ASP.NET 2,0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="1d855-216">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1d855-217">Dá se získat na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1d855-217">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1d855-218">nebo prostřednictvím svého blogu, který najdete na adrese [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="1d855-218">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1d855-219">[Předchozí](implementing-optimistic-concurrency-vb.md)
> [Další](limiting-data-modification-functionality-based-on-the-user-vb.md)</span><span class="sxs-lookup"><span data-stu-id="1d855-219">[Previous](implementing-optimistic-concurrency-vb.md)
[Next](limiting-data-modification-functionality-based-on-the-user-vb.md)</span></span>
