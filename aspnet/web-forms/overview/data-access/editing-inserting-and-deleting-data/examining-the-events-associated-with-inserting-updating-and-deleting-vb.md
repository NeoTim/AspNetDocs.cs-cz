---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
title: Zkoumání událostí spojených s vložením, aktualizací a odstraněním (VB) | Microsoft Docs
author: rick-anderson
description: V tomto kurzu prověříme události, ke kterým dojde před, během a po operaci vložení, aktualizace nebo odstranění webového ovládacího prvku ASP.NET data. W...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: c9bd10a7-eff8-4d8c-bec9-963c2aef2d6e
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: 35edb3cefc6fe23bb56e667c02d10dc7798f730d
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78608624"
---
# <a name="examining-the-events-associated-with-inserting-updating-and-deleting-vb"></a><span data-ttu-id="3186d-104">Zkoumání událostí spojených s vložením, aktualizací a odstraněním (VB)</span><span class="sxs-lookup"><span data-stu-id="3186d-104">Examining the Events Associated with Inserting, Updating, and Deleting (VB)</span></span>

<span data-ttu-id="3186d-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3186d-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3186d-106">[Stáhnout ukázkovou aplikaci](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) nebo [Stáhnout PDF](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="3186d-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) or [Download PDF](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span></span>

> <span data-ttu-id="3186d-107">V tomto kurzu prověříme události, ke kterým dojde před, během a po operaci vložení, aktualizace nebo odstranění webového ovládacího prvku ASP.NET data.</span><span class="sxs-lookup"><span data-stu-id="3186d-107">In this tutorial we'll examine using the events that occur before, during, and after an insert, update, or delete operation of an ASP.NET data Web control.</span></span> <span data-ttu-id="3186d-108">Také se dozvíte, jak přizpůsobit rozhraní pro úpravy tak, aby se aktualizovala pouze podmnožina polí produktu.</span><span class="sxs-lookup"><span data-stu-id="3186d-108">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="introduction"></a><span data-ttu-id="3186d-109">Úvod</span><span class="sxs-lookup"><span data-stu-id="3186d-109">Introduction</span></span>

<span data-ttu-id="3186d-110">Při použití vestavěných funkcí pro vkládání, úpravy nebo odstraňování funkcí ovládacího prvku GridView, DetailsView nebo FormView se celá řada kroků zobrazí, když koncový uživatel dokončí proces přidání nového záznamu nebo aktualizace nebo odstranění existujícího záznamu.</span><span class="sxs-lookup"><span data-stu-id="3186d-110">When using the built-in inserting, editing, or deleting features of the GridView, DetailsView, or FormView controls, a variety of steps transpire when the end user completes the process of adding a new record or updating or deleting an existing record.</span></span> <span data-ttu-id="3186d-111">Jak jsme probrali v [předchozím kurzu](an-overview-of-inserting-updating-and-deleting-data-vb.md), když se v prvku GridView upraví řádek, tlačítko Upravit je nahrazeno tlačítky aktualizovat a zrušit a BoundFields přepínat na textová pole.</span><span class="sxs-lookup"><span data-stu-id="3186d-111">As we discussed in the [previous tutorial](an-overview-of-inserting-updating-and-deleting-data-vb.md), when a row is edited in the GridView the Edit button is replaced by Update and Cancel buttons and the BoundFields turn into TextBoxes.</span></span> <span data-ttu-id="3186d-112">Jakmile koncový uživatel aktualizuje data a klikne na aktualizovat, provedou se následující kroky při zpětném odeslání:</span><span class="sxs-lookup"><span data-stu-id="3186d-112">After the end user updates the data and clicks Update, the following steps are performed on postback:</span></span>

1. <span data-ttu-id="3186d-113">Prvek GridView naplní své prvky ObjectDataSource `UpdateParameters` s jedinečným identifikačním polem (přes vlastnost `DataKeyNames`) upravovaného záznamu spolu s hodnotami zadanými uživatelem.</span><span class="sxs-lookup"><span data-stu-id="3186d-113">The GridView populates its ObjectDataSource's `UpdateParameters` with the edited record's unique identifying field(s) (via the `DataKeyNames` property) along with the values entered by the user</span></span>
2. <span data-ttu-id="3186d-114">Prvek GridView Vyvolá metodu `Update()` prvku ObjectDataSource, která zase vyvolá příslušnou metodu v podkladovém objektu (`ProductsDAL.UpdateProduct`, v našem předchozím kurzu).</span><span class="sxs-lookup"><span data-stu-id="3186d-114">The GridView invokes its ObjectDataSource's `Update()` method, which in turn invokes the appropriate method in the underlying object (`ProductsDAL.UpdateProduct`, in our previous tutorial)</span></span>
3. <span data-ttu-id="3186d-115">Podkladová data, která nyní obsahují aktualizované změny, jsou svázána s prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="3186d-115">The underlying data, which now includes the updated changes, is rebound to the GridView</span></span>

<span data-ttu-id="3186d-116">Během této sekvence kroků se může vyvolávat několik událostí, což nám umožní vytvářet obslužné rutiny událostí pro přidání vlastní logiky tam, kde je to potřeba.</span><span class="sxs-lookup"><span data-stu-id="3186d-116">During this sequence of steps, a number of events fire, enabling us to create event handlers to add custom logic where needed.</span></span> <span data-ttu-id="3186d-117">Například před krokem 1 se aktivuje událost `RowUpdating` prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="3186d-117">For example, prior to Step 1, the GridView's `RowUpdating` event fires.</span></span> <span data-ttu-id="3186d-118">V tuto chvíli můžeme žádost o aktualizaci zrušit, pokud došlo k chybě ověřování.</span><span class="sxs-lookup"><span data-stu-id="3186d-118">We can, at this point, cancel the update request if there is some validation error.</span></span> <span data-ttu-id="3186d-119">Když je vyvolána metoda `Update()`, aktivuje se událost `Updating` prvku ObjectDataSource, která poskytuje příležitost k přidání nebo přizpůsobení hodnot všech `UpdateParameters`.</span><span class="sxs-lookup"><span data-stu-id="3186d-119">When the `Update()` method is invoked, the ObjectDataSource's `Updating` event fires, providing an opportunity to add or customize the values of any of the `UpdateParameters`.</span></span> <span data-ttu-id="3186d-120">Po dokončení provádění metody základního objektu ObjectDataSource je vyvolána událost `Updated` prvku ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3186d-120">After the ObjectDataSource's underlying object's method has completed executing, the ObjectDataSource's `Updated` event is raised.</span></span> <span data-ttu-id="3186d-121">Obslužná rutina události `Updated` může zkontrolovat podrobnosti o operaci aktualizace, například kolik řádků bylo ovlivněno a zda došlo k výjimce.</span><span class="sxs-lookup"><span data-stu-id="3186d-121">An event handler for the `Updated` event can inspect the details about the update operation, such as how many rows were affected and whether or not an exception occurred.</span></span> <span data-ttu-id="3186d-122">Nakonec po kroku 2 se aktivuje událost `RowUpdated` prvku GridView; Obslužná rutina události pro tuto událost může prošetřit další informace o právě provedené operaci aktualizace.</span><span class="sxs-lookup"><span data-stu-id="3186d-122">Finally, after Step 2, the GridView's `RowUpdated` event fires; an event handler for this event can examine additional information about the update operation just performed.</span></span>

<span data-ttu-id="3186d-123">Obrázek 1 znázorňuje tuto řadu událostí a kroků při aktualizaci prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="3186d-123">Figure 1 depicts this series of events and steps when updating a GridView.</span></span> <span data-ttu-id="3186d-124">Vzor události na obrázku 1 není jedinečný pro aktualizaci pomocí prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="3186d-124">The event pattern in Figure 1 is not unique to updating with a GridView.</span></span> <span data-ttu-id="3186d-125">Vložení, aktualizace nebo odstranění dat z prvku GridView, DetailsView nebo FormView sestaví stejnou sekvenci událostí před a po úrovni pro webový ovládací prvek data i ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3186d-125">Inserting, updating, or deleting data from the GridView, DetailsView, or FormView precipitates the same sequence of pre- and post-level events for both the data Web control and the ObjectDataSource.</span></span>

<span data-ttu-id="3186d-126">[![řady událostí spouštěných před a po událostech při aktualizaci dat v prvku GridView.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-126">[![A Series of Pre- and Post-Events Fire When Updating Data in a GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span></span>

<span data-ttu-id="3186d-127">**Obrázek 1**: řada aktiv před a po událostech při aktualizaci dat v prvku GridView ([kliknutím zobrazíte obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="3186d-127">**Figure 1**: A Series of Pre- and Post-Events Fire When Updating Data in a GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span></span>

<span data-ttu-id="3186d-128">V tomto kurzu prověříme tyto události a rozšíříme možnosti vkládání, aktualizace a odstraňování webových ovládacích prvků ASP.NET data.</span><span class="sxs-lookup"><span data-stu-id="3186d-128">In this tutorial we'll examine using these events to extend the built-in inserting, updating, and deleting capabilities of the ASP.NET data Web controls.</span></span> <span data-ttu-id="3186d-129">Také se dozvíte, jak přizpůsobit rozhraní pro úpravy tak, aby se aktualizovala pouze podmnožina polí produktu.</span><span class="sxs-lookup"><span data-stu-id="3186d-129">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="step-1-updating-a-productsproductnameandunitpricefields"></a><span data-ttu-id="3186d-130">Krok 1: aktualizace polí`ProductName`a`UnitPrice`produktu</span><span class="sxs-lookup"><span data-stu-id="3186d-130">Step 1: Updating a Product's`ProductName`and`UnitPrice`Fields</span></span>

<span data-ttu-id="3186d-131">V rozhraní pro úpravy z předchozího kurzu musela být zahrnutá *všechna* pole produktu, která byla jen pro čtení.</span><span class="sxs-lookup"><span data-stu-id="3186d-131">In the editing interfaces from the previous tutorial *all* product fields that were not read-only had to be included.</span></span> <span data-ttu-id="3186d-132">Pokud jsme chtěli odebrat pole z prvku GridView – řekněme `QuantityPerUnit` – při aktualizaci dat webový ovládací prvek data by nastavil `UpdateParameters` hodnotu prvku ObjectDataSource `QuantityPerUnit`.</span><span class="sxs-lookup"><span data-stu-id="3186d-132">If we were to remove a field from the GridView - say `QuantityPerUnit` - when updating the data the data Web control would not set the ObjectDataSource's `QuantityPerUnit` `UpdateParameters` value.</span></span> <span data-ttu-id="3186d-133">Prvek ObjectDataSource pak předáte hodnotu `Nothing` do metody `UpdateProduct` knihoven BLL (Business Logic Layer), která by změnila sloupec `QuantityPerUnit` upravovaného databázového záznamu na `NULL` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="3186d-133">The ObjectDataSource would then pass in a value of `Nothing` into the `UpdateProduct` Business Logic Layer (BLL) method, which would change the edited database record's `QuantityPerUnit` column to a `NULL` value.</span></span> <span data-ttu-id="3186d-134">Podobně platí, že pokud je požadované pole, například `ProductName`, odebráno z rozhraní pro úpravy, aktualizace se nezdaří a "*sloupec" ProductName "nepovoluje hodnotu null*".</span><span class="sxs-lookup"><span data-stu-id="3186d-134">Similarly, if a required field, such as `ProductName`, is removed from the editing interface, the update will fail with a "*Column 'ProductName' does not allow nulls*" exception.</span></span> <span data-ttu-id="3186d-135">Důvodem tohoto chování bylo, že prvek ObjectDataSource byl nakonfigurován tak, aby volal metodu `UpdateProduct` třídy `ProductsBLL`, která očekávala vstupní parametr pro každé pole produktu.</span><span class="sxs-lookup"><span data-stu-id="3186d-135">The reason for this behavior was because the ObjectDataSource was configured to call the `ProductsBLL` class's `UpdateProduct` method, which expected an input parameter for each of the product fields.</span></span> <span data-ttu-id="3186d-136">Proto kolekce `UpdateParameters` ObjectDataSource obsahuje parametr pro každý vstupní parametr metody.</span><span class="sxs-lookup"><span data-stu-id="3186d-136">Therefore, the ObjectDataSource's `UpdateParameters` collection contained a parameter for each of the method's input parameters.</span></span>

<span data-ttu-id="3186d-137">Pokud chceme poskytnout datovou datovou datovou položku, která umožňuje koncovému uživateli aktualizovat pouze podmnožinu polí, je nutné buď programově nastavit chybějící `UpdateParameters` hodnoty v obslužné rutině události `Updating` ObjectDataSource nebo vytvořit a volat metodu knihoven BLL, která očekává pouze podmnožinu polí.</span><span class="sxs-lookup"><span data-stu-id="3186d-137">If we want to provide a data Web control that allows the end user to only update a subset of fields, then we need to either programmatically set the missing `UpdateParameters` values in the ObjectDataSource's `Updating` event handler or create and call a BLL method that expects only a subset of the fields.</span></span> <span data-ttu-id="3186d-138">Pojďme tento přístup prozkoumat.</span><span class="sxs-lookup"><span data-stu-id="3186d-138">Let's explore this latter approach.</span></span>

<span data-ttu-id="3186d-139">Konkrétně vytvoříme stránku, která zobrazí pouze pole `ProductName` a `UnitPrice` v upravitelném prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="3186d-139">Specifically, let's create a page that displays just the `ProductName` and `UnitPrice` fields in an editable GridView.</span></span> <span data-ttu-id="3186d-140">Rozhraní pro úpravy tohoto prvku GridView umožní uživateli aktualizovat pouze dvě zobrazená pole `ProductName` a `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="3186d-140">This GridView's editing interface will only allow the user to update the two displayed fields, `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="3186d-141">Vzhledem k tomu, že toto rozhraní pro úpravy poskytuje pouze podmnožinu polí produktu, je nutné vytvořit prvek ObjectDataSource, který používá existující `UpdateProduct` metodu knihoven BLL a má chybějící hodnoty pole produktu, které jsou nastaveny programově ve své obslužné rutině události `Updating`, nebo musíme vytvořit novou metodu knihoven BLL, která očekává pouze podmnožinu polí definovaných v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="3186d-141">Since this editing interface only provides a subset of a product's fields, we either need to create an ObjectDataSource that uses the existing BLL's `UpdateProduct` method and has the missing product field values set programmatically in its `Updating` event handler, or we need to create a new BLL method that expects only the subset of fields defined in the GridView.</span></span> <span data-ttu-id="3186d-142">Pro účely tohoto kurzu použijeme druhou možnost a vytvoříme přetížení metody `UpdateProduct`, kterou používá jenom tři vstupní parametry: `productName`, `unitPrice`a `productID`:</span><span class="sxs-lookup"><span data-stu-id="3186d-142">For this tutorial, let's use the latter option and create an overload of the `UpdateProduct` method, one that takes in just three input parameters: `productName`, `unitPrice`, and `productID`:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample1.vb)]

<span data-ttu-id="3186d-143">Podobně jako původní metoda `UpdateProduct` se toto přetížení spustí tak, že zkontroluje, jestli v databázi není nějaký produkt se zadaným `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="3186d-143">Like the original `UpdateProduct` method, this overload starts by checking to see if there is a product in the database with the specified `ProductID`.</span></span> <span data-ttu-id="3186d-144">V takovém případě vrátí `False`, což znamená, že žádost o aktualizaci informací o produktu se nezdařila.</span><span class="sxs-lookup"><span data-stu-id="3186d-144">If not, it returns `False`, indicating that the request to update the product information failed.</span></span> <span data-ttu-id="3186d-145">V opačném případě aktualizuje existující `ProductName` a `UnitPrice` pole záznamu produktu a potvrdí aktualizaci voláním `Update()` metody TableAdapter, která předává instanci `ProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="3186d-145">Otherwise it updates the existing product record's `ProductName` and `UnitPrice` fields accordingly and commits the update by calling the TableAdapter's `Update()` method, passing in the `ProductsRow` instance.</span></span>

<span data-ttu-id="3186d-146">S tímto přidáním do naší `ProductsBLL` třídy jsme připraveni vytvořit zjednodušené rozhraní GridView.</span><span class="sxs-lookup"><span data-stu-id="3186d-146">With this addition to our `ProductsBLL` class, we're ready to create the simplified GridView interface.</span></span> <span data-ttu-id="3186d-147">Otevřete `DataModificationEvents.aspx` ve složce `EditInsertDelete` a přidejte prvek GridView do stránky.</span><span class="sxs-lookup"><span data-stu-id="3186d-147">Open the `DataModificationEvents.aspx` in the `EditInsertDelete` folder and add a GridView to the page.</span></span> <span data-ttu-id="3186d-148">Vytvořte nový prvek ObjectDataSource a nakonfigurujte ho tak, aby používal třídu `ProductsBLL` s mapováním jeho `Select()`ch metod na `GetProducts` a jeho `Update()`ou metodou mapování na `UpdateProduct` přetížení, které používá pouze `productName`, `unitPrice`a `productID` vstupních parametrů.</span><span class="sxs-lookup"><span data-stu-id="3186d-148">Create a new ObjectDataSource and configure it to use the `ProductsBLL` class with its `Select()` method mapping to `GetProducts` and its `Update()` method mapping to the `UpdateProduct` overload that takes in only the `productName`, `unitPrice`, and `productID` input parameters.</span></span> <span data-ttu-id="3186d-149">Obrázek 2 ukazuje Průvodce vytvořením zdroje dat při mapování `Update()` metody prvku ObjectDataSource na nové přetížení metody `UpdateProduct` `ProductsBLL` třídy.</span><span class="sxs-lookup"><span data-stu-id="3186d-149">Figure 2 shows the Create Data Source wizard when mapping the ObjectDataSource's `Update()` method to the `ProductsBLL` class's new `UpdateProduct` method overload.</span></span>

<span data-ttu-id="3186d-150">[![namapovat metodu Update () prvku ObjectDataSource na nové přetížení UpdateProduct](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-150">[![Map the ObjectDataSource's Update() Method to the New UpdateProduct Overload](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span></span>

<span data-ttu-id="3186d-151">**Obrázek 2**: namapujte metodu `Update()` prvku ObjectDataSource na nové přetížení `UpdateProduct` ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-151">**Figure 2**: Map the ObjectDataSource's `Update()` Method to the New `UpdateProduct` Overload ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png))</span></span>

<span data-ttu-id="3186d-152">Vzhledem k tomu, že náš příklad bude zpočátku potřebovat možnost upravovat data, ale ne vkládat nebo odstraňovat záznamy, je nutné explicitně určit, že metody `Insert()` a `Delete()` elementu ObjectDataSource by neměly být namapovány na žádnou z metod třídy `ProductsBLL`, a to tak, že přejdete na karty Vložit a odstranit a v rozevíracím seznamu zvolíte možnost (žádné).</span><span class="sxs-lookup"><span data-stu-id="3186d-152">Since our example will initially just need the ability to edit data, but not to insert or delete records, take a moment to explicitly indicate that the ObjectDataSource's `Insert()` and `Delete()` methods shouldn't be mapped to any of the `ProductsBLL` class's methods by going to the INSERT and DELETE tabs and choosing (None) from the drop-down list.</span></span>

<span data-ttu-id="3186d-153">[z rozevíracího seznamu pro karty Vložit a odstranit ![zvolit (žádné).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-153">[![Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span></span>

<span data-ttu-id="3186d-154">**Obrázek 3**: vyberte (žádný) z rozevíracího seznamu pro záložky INSERT a Delete ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-154">**Figure 3**: Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png))</span></span>

<span data-ttu-id="3186d-155">Po dokončení tohoto průvodce zaškrtněte políčko Povolit úpravy z inteligentní značky prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="3186d-155">After completing this wizard check the Enable Editing checkbox from the GridView's smart tag.</span></span>

<span data-ttu-id="3186d-156">Při dokončení Průvodce vytvořením zdroje dat a vázání na prvek GridView vytvořila aplikace Visual Studio deklarativní syntaxi pro oba ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="3186d-156">With the completion of the Create Data Source wizard and binding that to the GridView, Visual Studio has created the declarative syntax for both controls.</span></span> <span data-ttu-id="3186d-157">Přejít do zobrazení zdroje a zkontrolovat deklarativní označení prvku ObjectDataSource, které je zobrazeno níže:</span><span class="sxs-lookup"><span data-stu-id="3186d-157">Go to the Source view to inspect the ObjectDataSource's declarative markup, which is shown below:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="3186d-158">Vzhledem k tomu, že nejsou k dispozici žádná mapování pro metody `Insert()` a `Delete()` prvku ObjectDataSource, nejsou žádné `InsertParameters` ani oddíly `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="3186d-158">Since there are no mappings for the ObjectDataSource's `Insert()` and `Delete()` methods, there are no `InsertParameters` or `DeleteParameters` sections.</span></span> <span data-ttu-id="3186d-159">Kromě toho, vzhledem k tomu, že `Update()` metoda je namapována na přetížení metody `UpdateProduct`, která přijímá pouze tři vstupní parametry, oddíl `UpdateParameters` má pouze tři instance `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="3186d-159">Furthermore, since the `Update()` method is mapped to the `UpdateProduct` method overload that only accepts three input parameters, the `UpdateParameters` section has just three `Parameter` instances.</span></span>

<span data-ttu-id="3186d-160">Všimněte si, že vlastnost `OldValuesParameterFormatString` prvku ObjectDataSource je nastavena na hodnotu `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="3186d-160">Note that the ObjectDataSource's `OldValuesParameterFormatString` property is set to `original_{0}`.</span></span> <span data-ttu-id="3186d-161">Tato vlastnost je automaticky nastavena sadou Visual Studio při použití Průvodce konfigurací zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="3186d-161">This property is set automatically by Visual Studio when using the Configure Data Source wizard.</span></span> <span data-ttu-id="3186d-162">Vzhledem k tomu, že naše metody knihoven BLL neočekávají, že původní hodnota `ProductID` má být předána, odeberte přiřazení této vlastnosti z deklarativní syntaxe prvku ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3186d-162">However, since our BLL methods don't expect the original `ProductID` value to be passed in, remove this property assignment altogether from the ObjectDataSource's declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="3186d-163">Pokud jednoduše vymažete hodnotu vlastnosti `OldValuesParameterFormatString` z okno Vlastnosti ve zobrazení Návrh, bude vlastnost stále existovat v deklarativní syntaxi, ale bude nastavena na prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="3186d-163">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but will be set to an empty string.</span></span> <span data-ttu-id="3186d-164">Buď odeberte vlastnost zcela z deklarativní syntaxe nebo z okno Vlastnosti nastavte výchozí hodnotu `{0}`.</span><span class="sxs-lookup"><span data-stu-id="3186d-164">Either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>

<span data-ttu-id="3186d-165">I když prvek ObjectDataSource má pouze `UpdateParameters` pro název produktu, cenu a ID, Visual Studio přidalo do prvku GridView hodnotu vlastnost BoundField nebo třídě CheckBoxField podporována pro každé pole produktu.</span><span class="sxs-lookup"><span data-stu-id="3186d-165">While the ObjectDataSource only has `UpdateParameters` for the product's name, price, and ID, Visual Studio has added a BoundField or CheckBoxField in the GridView for each of the product's fields.</span></span>

<span data-ttu-id="3186d-166">[![prvek GridView obsahuje pro každé pole produktu vlastnost BoundField nebo třídě CheckBoxField podporována.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-166">[![The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span></span>

<span data-ttu-id="3186d-167">**Obrázek 4**: prvek GridView obsahuje vlastnost BoundField nebo třídě CheckBoxField podporována pro každé pole produktu ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-167">**Figure 4**: The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png))</span></span>

<span data-ttu-id="3186d-168">Když koncový uživatel upraví produkt a klikne na jeho tlačítko aktualizace, prvek GridView vytvoří výčet těchto polí, která nebyla jen pro čtení.</span><span class="sxs-lookup"><span data-stu-id="3186d-168">When the end user edits a product and clicks its Update button, the GridView enumerates those fields that were not read-only.</span></span> <span data-ttu-id="3186d-169">Potom nastaví hodnotu odpovídající parametr v kolekci `UpdateParameters` ObjectDataSource na hodnotu zadanou uživatelem.</span><span class="sxs-lookup"><span data-stu-id="3186d-169">It then sets the value of the corresponding parameter in the ObjectDataSource's `UpdateParameters` collection to the value entered by the user.</span></span> <span data-ttu-id="3186d-170">Pokud není k dispozici odpovídající parametr, prvek GridView ho přidá do kolekce.</span><span class="sxs-lookup"><span data-stu-id="3186d-170">If there is not a corresponding parameter, the GridView adds one to the collection.</span></span> <span data-ttu-id="3186d-171">Proto pokud v našem prvku GridView obsahuje BoundFields a CheckBoxFields pro všechna pole produktu, prvek ObjectDataSource ukončí vyvolání `UpdateProduct` přetížení, které převezme všechny tyto parametry, navzdory tomu, že deklarativní označení ovládacího prvku ObjectDataSource určuje pouze tři vstupní parametry (viz obrázek 5).</span><span class="sxs-lookup"><span data-stu-id="3186d-171">Therefore, if our GridView contains BoundFields and CheckBoxFields for all of the product's fields, the ObjectDataSource will end up invoking the `UpdateProduct` overload that takes in all of these parameters, despite the fact that the ObjectDataSource's declarative markup specifies only three input parameters (see Figure 5).</span></span> <span data-ttu-id="3186d-172">Podobně, pokud je v prvku GridView nějaká kombinace polí produktu, která nejsou jen pro čtení, která neodpovídá vstupním parametrům pro `UpdateProduct` přetížení, při pokusu o aktualizaci se vyvolá výjimka.</span><span class="sxs-lookup"><span data-stu-id="3186d-172">Similarly, if there is some combination of non-read-only product fields in the GridView that doesn't correspond to the input parameters for a `UpdateProduct` overload, an exception will be raised when attempting to update.</span></span>

<span data-ttu-id="3186d-173">[![bude prvek GridView přidávat parametry do kolekce UpdateParameters ObjectDataSource](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-173">[![The GridView Will Add Parameters to the ObjectDataSource's UpdateParameters Collection](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span></span>

<span data-ttu-id="3186d-174">**Obrázek 5**: prvek GridView přidá parametry do kolekce `UpdateParameters` ObjectDataSource ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-174">**Figure 5**: The GridView Will Add Parameters to the ObjectDataSource's `UpdateParameters` Collection ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png))</span></span>

<span data-ttu-id="3186d-175">Chcete-li zajistit, aby prvek ObjectDataSource vyvolal přetížení `UpdateProduct`, které přebírá pouze název produktu, cenu a ID, je nutné omezit prvek GridView tak, aby měl upravitelná pole pro pouze `ProductName` a `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="3186d-175">To ensure that the ObjectDataSource invokes the `UpdateProduct` overload that takes in just the product's name, price, and ID, we need to restrict the GridView to having editable fields for just the `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="3186d-176">To lze provést odebráním ostatních BoundFields a CheckBoxFields nastavením vlastností `ReadOnly` na hodnotu `True`nebo kombinací dvou polí.</span><span class="sxs-lookup"><span data-stu-id="3186d-176">This can be accomplished by removing the other BoundFields and CheckBoxFields, by setting those other fields' `ReadOnly` property to `True`, or by some combination of the two.</span></span> <span data-ttu-id="3186d-177">Pro tento kurz můžeme jednoduše odebrat všechna pole GridView s výjimkou `ProductName` a `UnitPrice` BoundFields, po které bude deklarativní označení prvku GridView vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="3186d-177">For this tutorial let's simply remove all GridView fields except the `ProductName` and `UnitPrice` BoundFields, after which the GridView's declarative markup will look like:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="3186d-178">I když přetížení `UpdateProduct` očekává tři vstupní parametry, máme v našem prvku GridView pouze dvě BoundFields.</span><span class="sxs-lookup"><span data-stu-id="3186d-178">Even though the `UpdateProduct` overload expects three input parameters, we only have two BoundFields in our GridView.</span></span> <span data-ttu-id="3186d-179">Důvodem je, že vstupní parametr `productID` je hodnota primárního klíče a byla předána prostřednictvím hodnoty vlastnosti `DataKeyNames` upravovaného řádku.</span><span class="sxs-lookup"><span data-stu-id="3186d-179">This is because the `productID` input parameter is a primary key value and passed in through the value of the `DataKeyNames` property for the edited row.</span></span>

<span data-ttu-id="3186d-180">Náš prvek GridView, společně s `UpdateProduct` přetížením, umožňuje uživateli upravit pouze název a cenu produktu, aniž by ztratili jakékoli jiné pole produktu.</span><span class="sxs-lookup"><span data-stu-id="3186d-180">Our GridView, along with the `UpdateProduct` overload, allows a user to edit just the name and price of a product without losing any of the other product fields.</span></span>

<span data-ttu-id="3186d-181">[![rozhraní umožňuje upravovat pouze název a cenu produktu.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-181">[![The Interface Allows Editing Just the Product's Name and Price](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span></span>

<span data-ttu-id="3186d-182">**Obrázek 6**: rozhraní umožňuje upravovat pouze název a cenu produktu ([kliknutím zobrazíte obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png)).</span><span class="sxs-lookup"><span data-stu-id="3186d-182">**Figure 6**: The Interface Allows Editing Just the Product's Name and Price ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="3186d-183">Jak je popsáno v předchozím kurzu, je důležité, aby byl povolen stav zobrazení GridView s (výchozí chování).</span><span class="sxs-lookup"><span data-stu-id="3186d-183">As discussed in the previous tutorial, it is vitally important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="3186d-184">Pokud nastavíte vlastnost `EnableViewState` prvku GridView s na hodnotu `false`, spustíte riziko, že neúmyslně odstraní nebo upraví záznamy v souběžných uživatelích.</span><span class="sxs-lookup"><span data-stu-id="3186d-184">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="3186d-185">Viz [Upozornění: problém souběžnosti s ASP.NET 2,0 gridviews/DetailsView/formviews, které podporují úpravy a/nebo odstraňování a jejichž stav zobrazení je zakázán](http://scottonwriting.net/sowblog/posts/10054.aspx) pro další informace.</span><span class="sxs-lookup"><span data-stu-id="3186d-185">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="improving-theunitpriceformatting"></a><span data-ttu-id="3186d-186">Vylepšení formátování`UnitPrice`</span><span class="sxs-lookup"><span data-stu-id="3186d-186">Improving the`UnitPrice`Formatting</span></span>

<span data-ttu-id="3186d-187">I když příklad prvku GridView zobrazený na obrázku 6 funguje, pole `UnitPrice` není vůbec zformátováno, což vede k tomu, že má za následek zobrazení ceny, které neobsahuje žádné symboly měny a má čtyři desetinná místa.</span><span class="sxs-lookup"><span data-stu-id="3186d-187">While the GridView example shown in Figure 6 works, the `UnitPrice` field is not formatted at all, resulting in a price display that lacks any currency symbols and has four decimal places.</span></span> <span data-ttu-id="3186d-188">Chcete-li použít formátování měny pro neupravitelné řádky, jednoduše nastavte vlastnost `DataFormatString` `UnitPrice` vlastnost BoundField na hodnotu `{0:c}` a její vlastnost `HtmlEncode` na `False`.</span><span class="sxs-lookup"><span data-stu-id="3186d-188">To apply a currency formatting for the non-editable rows, simply set the `UnitPrice` BoundField's `DataFormatString` property to `{0:c}` and its `HtmlEncode` property to `False`.</span></span>

<span data-ttu-id="3186d-189">[![nastavte odpovídající vlastnosti DataFormatString a HtmlEncode.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-189">[![Set the UnitPrice's DataFormatString and HtmlEncode Properties Accordingly](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span></span>

<span data-ttu-id="3186d-190">**Obrázek 7**: odpovídajícím způsobem nastavte vlastnosti `UnitPrice``DataFormatString` a `HtmlEncode` ([kliknutím zobrazíte obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png)).</span><span class="sxs-lookup"><span data-stu-id="3186d-190">**Figure 7**: Set the `UnitPrice`'s `DataFormatString` and `HtmlEncode` Properties Accordingly ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png))</span></span>

<span data-ttu-id="3186d-191">V důsledku této změny formát řádků, které nemůžete upravovat, ceníte jako měnu. upravený řádek však stále zobrazuje hodnotu bez symbolu měny a se čtyřmi desetinnými místy.</span><span class="sxs-lookup"><span data-stu-id="3186d-191">With this change, the non-editable rows format the price as a currency; the edited row, however, still displays the value without the currency symbol and with four decimal places.</span></span>

<span data-ttu-id="3186d-192">[![řádky, které nemůžete upravovat, se teď naformátují jako hodnoty měny.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-192">[![The Non-Editable Rows are Now Formatted as Currency Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span></span>

<span data-ttu-id="3186d-193">**Obrázek 8**: neupravitelné řádky jsou nyní formátovány jako hodnoty měny ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-193">**Figure 8**: The Non-Editable Rows are Now Formatted as Currency Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png))</span></span>

<span data-ttu-id="3186d-194">Pokyny pro formátování zadané ve vlastnosti `DataFormatString` lze použít pro rozhraní úprav nastavením vlastnosti `ApplyFormatInEditMode` vlastnost BoundField na hodnotu `True` (výchozí hodnota je `False`).</span><span class="sxs-lookup"><span data-stu-id="3186d-194">The formatting instructions specified in the `DataFormatString` property can be applied to the editing interface by setting the BoundField's `ApplyFormatInEditMode` property to `True` (the default is `False`).</span></span> <span data-ttu-id="3186d-195">Nastavte tuto vlastnost na `True`chvíli počkejte.</span><span class="sxs-lookup"><span data-stu-id="3186d-195">Take a moment to set this property to `True`.</span></span>

<span data-ttu-id="3186d-196">[![nastavte vlastnost ApplyFormatInEditMode UnitPrice vlastnost BoundField na hodnotu true.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-196">[![Set the UnitPrice BoundField's ApplyFormatInEditMode property to True](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span></span>

<span data-ttu-id="3186d-197">**Obrázek 9**: nastavte vlastnost `ApplyFormatInEditMode` `UnitPrice` vlastnost BoundField na hodnotu `True` ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-197">**Figure 9**: Set the `UnitPrice` BoundField's `ApplyFormatInEditMode` property to `True` ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png))</span></span>

<span data-ttu-id="3186d-198">Tato změna znamená, že hodnota `UnitPrice` zobrazená na upravovaném řádku je také formátována jako měna.</span><span class="sxs-lookup"><span data-stu-id="3186d-198">With this change, the value of the `UnitPrice` displayed in the edited row is also formatted as a currency.</span></span>

<span data-ttu-id="3186d-199">[![hodnota UnitPrice upravovaného řádku je teď naformátovaná jako měna.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-199">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span></span>

<span data-ttu-id="3186d-200">**Obrázek 10**: hodnota `UnitPrice` upravovaného řádku se teď formátuje jako měna ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-200">**Figure 10**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png))</span></span>

<span data-ttu-id="3186d-201">Aktualizace produktu pomocí symbolu měny v textovém poli, jako je $19,00, ale vyvolá `FormatException`.</span><span class="sxs-lookup"><span data-stu-id="3186d-201">However, updating a product with the currency symbol in the textbox such as $19.00 throws a `FormatException`.</span></span> <span data-ttu-id="3186d-202">Když se GridView pokusí přiřadit uživatelsky zadané hodnoty do kolekce `UpdateParameters` ObjectDataSource, není schopen převést řetězec `UnitPrice` "$19,00" do `Decimal` požadovaného parametrem (viz obrázek 11).</span><span class="sxs-lookup"><span data-stu-id="3186d-202">When the GridView attempts to assign the user-supplied values to the ObjectDataSource's `UpdateParameters` collection it is unable to convert the `UnitPrice` string "$19.00" into the `Decimal` required by the parameter (see Figure 11).</span></span> <span data-ttu-id="3186d-203">Chcete-li tento problém vyřešit, můžeme vytvořit obslužnou rutinu události pro událost `RowUpdating` prvku GridView a nechat ji analyzovat uživatelem zadanou `UnitPrice` jako `Decimal`ve formátu měny.</span><span class="sxs-lookup"><span data-stu-id="3186d-203">To remedy this we can create an event handler for the GridView's `RowUpdating` event and have it parse the user-supplied `UnitPrice` as a currency-formatted `Decimal`.</span></span>

<span data-ttu-id="3186d-204">Událost `RowUpdating` prvku GridView přijímá jako svůj druhý parametr objekt typu [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), který obsahuje `NewValues` slovníku jako jednu z vlastností, která obsahuje uživatelem zadané hodnoty, které mají být přiřazeny do kolekce `UpdateParameters` prvku ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3186d-204">The GridView's `RowUpdating` event accepts as its second parameter an object of type [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), which includes a `NewValues` dictionary as one of its properties that holds the user-supplied values ready to be assigned to the ObjectDataSource's `UpdateParameters` collection.</span></span> <span data-ttu-id="3186d-205">Existující hodnotu `UnitPrice` v kolekci `NewValues` můžeme přepsat pomocí desítkové hodnoty, která je analyzovaná pomocí formátu měny s následujícími řádky kódu v obslužné rutině události `RowUpdating`:</span><span class="sxs-lookup"><span data-stu-id="3186d-205">We can overwrite the existing `UnitPrice` value in the `NewValues` collection with a decimal value parsed using the currency format with the following lines of code in the `RowUpdating` event handler:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample4.vb)]

<span data-ttu-id="3186d-206">Pokud uživatel zadal `UnitPrice` hodnotu (například "$19,00"), bude tato hodnota přepsána hodnotou typu Decimal, vypočítanou [argumentem Decimal. Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx)a analýzou hodnoty jako měny.</span><span class="sxs-lookup"><span data-stu-id="3186d-206">If the user has supplied a `UnitPrice` value (such as "$19.00"), this value is overwritten with the decimal value computed by [Decimal.Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), parsing the value as a currency.</span></span> <span data-ttu-id="3186d-207">Tato akce správně analyzuje desetinné číslo v případě symbolů měn, čárky, desetinných míst atd. a používá [výčty NumberStyles](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) v oboru názvů [System. Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) .</span><span class="sxs-lookup"><span data-stu-id="3186d-207">This will correctly parse the decimal in the event of any currency symbols, commas, decimal points, and so on, and uses the [NumberStyles enumeration](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) in the [System.Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) namespace.</span></span>

<span data-ttu-id="3186d-208">Obrázek 11 ukazuje problém způsobený symboly měny v uživatelsky dodávaném `UnitPrice`, spolu s tím, jak lze využít obslužnou rutinu události `RowUpdating` prvku GridView pro správné analyzování tohoto vstupu.</span><span class="sxs-lookup"><span data-stu-id="3186d-208">Figure 11 shows both the problem caused by currency symbols in the user-supplied `UnitPrice`, along with how the GridView's `RowUpdating` event handler can be utilized to correctly parse such input.</span></span>

<span data-ttu-id="3186d-209">[![hodnota UnitPrice upravovaného řádku je teď naformátovaná jako měna.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-209">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span></span>

<span data-ttu-id="3186d-210">**Obrázek 11**: hodnota `UnitPrice` upravovaného řádku se teď formátuje jako měna ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-210">**Figure 11**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png))</span></span>

## <a name="step-2-prohibitingnull-unitprices"></a><span data-ttu-id="3186d-211">Krok 2: zákaz`NULL UnitPrices`</span><span class="sxs-lookup"><span data-stu-id="3186d-211">Step 2: Prohibiting`NULL UnitPrices`</span></span>

<span data-ttu-id="3186d-212">I když je databáze nakonfigurovaná tak, aby povolovala `NULL` hodnoty ve sloupci `UnitPrice` `Products` tabulky, můžeme uživatelům, kteří navštíví tuto konkrétní stránku, zabránit v zadání hodnoty `NULL` `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="3186d-212">While the database is configured to allow `NULL` values in the `Products` table's `UnitPrice` column, we may want to prevent users visiting this particular page from specifying a `NULL` `UnitPrice` value.</span></span> <span data-ttu-id="3186d-213">To znamená, že pokud se uživateli nepodaří zadat `UnitPrice` hodnotu při úpravě řádku produktu, místo uložení výsledků do databáze chceme zobrazit zprávu informující o uživateli, který prostřednictvím této stránky musí mít všechny upravené produkty v ceně.</span><span class="sxs-lookup"><span data-stu-id="3186d-213">That is, if a user fails to enter a `UnitPrice` value when editing a product row, rather than save the results to the database we want to display a message informing the user that, through this page, any edited products must have a price specified.</span></span>

<span data-ttu-id="3186d-214">Objekt `GridViewUpdateEventArgs` předaný do obslužné rutiny události `RowUpdating` prvku GridView obsahuje vlastnost `Cancel`, která, pokud je nastavena na `True`, ukončí proces aktualizace.</span><span class="sxs-lookup"><span data-stu-id="3186d-214">The `GridViewUpdateEventArgs` object passed into the GridView's `RowUpdating` event handler contains a `Cancel` property that, if set to `True`, terminates the updating process.</span></span> <span data-ttu-id="3186d-215">Nyní rozšíříme obslužnou rutinu `RowUpdating`, aby se nastavila `e.Cancel` na `True`, a zobrazila se zpráva s vysvětlením, proč má `UnitPrice` hodnota v `NewValues` Collection hodnotu `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="3186d-215">Let's extend the `RowUpdating` event handler to set `e.Cancel` to `True` and display a message explaining why if the `UnitPrice` value in the `NewValues` collection has a value of `Nothing`.</span></span>

<span data-ttu-id="3186d-216">Začněte přidáním webového ovládacího prvku popisek na stránku s názvem `MustProvideUnitPriceMessage`.</span><span class="sxs-lookup"><span data-stu-id="3186d-216">Start by adding a Label Web control to the page named `MustProvideUnitPriceMessage`.</span></span> <span data-ttu-id="3186d-217">Tento ovládací prvek popisek se zobrazí, pokud uživatel při aktualizaci produktu nezadá `UnitPrice`ovou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="3186d-217">This Label control will be displayed if the user fails to specify a `UnitPrice` value when updating a product.</span></span> <span data-ttu-id="3186d-218">Nastavte vlastnost `Text` popisku na hodnotu pro produkt musíte zadat cenu.</span><span class="sxs-lookup"><span data-stu-id="3186d-218">Set the Label's `Text` property to "You must provide a price for the product."</span></span> <span data-ttu-id="3186d-219">Také jsem vytvořil novou třídu CSS v `Styles.css` s názvem `Warning` s následující definicí:</span><span class="sxs-lookup"><span data-stu-id="3186d-219">I've also created a new CSS class in `Styles.css` named `Warning` with the following definition:</span></span>

[!code-css[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample5.css)]

<span data-ttu-id="3186d-220">Nakonec nastavte vlastnost `CssClass` popisku na hodnotu `Warning`.</span><span class="sxs-lookup"><span data-stu-id="3186d-220">Finally, set the Label's `CssClass` property to `Warning`.</span></span> <span data-ttu-id="3186d-221">V tomto okamžiku by měl Návrhář zobrazit varovnou zprávu červeně, tučně, kurzívou a velmi velkou velikostí písma nad prvek GridView, jak je znázorněno na obrázku 12.</span><span class="sxs-lookup"><span data-stu-id="3186d-221">At this point the Designer should show the warning message in a red, bold, italic, extra large font size above the GridView, as shown in Figure 12.</span></span>

<span data-ttu-id="3186d-222">[do prvku GridView bylo přidáno ![popisku.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-222">[![A Label Has Been Added Above the GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span></span>

<span data-ttu-id="3186d-223">**Obrázek 12**: popisek byl přidán nad prvek GridView ([kliknutím zobrazíte obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png)).</span><span class="sxs-lookup"><span data-stu-id="3186d-223">**Figure 12**: A Label Has Been Added Above the GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png))</span></span>

<span data-ttu-id="3186d-224">Ve výchozím nastavení by tento popisek měl být skrytý, proto nastavte jeho vlastnost `Visible` na `False` v obslužné rutině události `Page_Load`:</span><span class="sxs-lookup"><span data-stu-id="3186d-224">By default, this Label should be hidden, so set its `Visible` property to `False` in the `Page_Load` event handler:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="3186d-225">Pokud se uživatel pokusí aktualizovat produkt bez zadání `UnitPrice`, chceme aktualizaci zrušit a zobrazit popisek upozornění.</span><span class="sxs-lookup"><span data-stu-id="3186d-225">If the user attempts to update a product without specifying the `UnitPrice`, we want to cancel the update and display the warning label.</span></span> <span data-ttu-id="3186d-226">Rozšiřte obslužnou rutinu události `RowUpdating` prvku GridView následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="3186d-226">Augment the GridView's `RowUpdating` event handler as follows:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="3186d-227">Pokud se uživatel pokusí uložit produkt bez zadání ceny, aktualizace se zruší a zobrazí se užitečná zpráva.</span><span class="sxs-lookup"><span data-stu-id="3186d-227">If a user attempts to save a product without specifying a price, the update is cancelled and a helpful message is displayed.</span></span> <span data-ttu-id="3186d-228">I když databáze (a obchodní logika) umožňuje `NULL` `UnitPrice` s, tato konkrétní ASP.NET stránka ne.</span><span class="sxs-lookup"><span data-stu-id="3186d-228">While the database (and business logic) allows for `NULL` `UnitPrice` s, this particular ASP.NET page does not.</span></span>

<span data-ttu-id="3186d-229">[![uživatel nemůže ponechat prázdné pole UnitPrice.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-229">[![A User Cannot Leave UnitPrice Blank](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span></span>

<span data-ttu-id="3186d-230">**Obrázek 13**: uživatel nesmí opustit `UnitPrice` prázdné ([kliknutím zobrazíte obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png)).</span><span class="sxs-lookup"><span data-stu-id="3186d-230">**Figure 13**: A User Cannot Leave `UnitPrice` Blank ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png))</span></span>

<span data-ttu-id="3186d-231">Zatím jsme viděli, jak pomocí události `RowUpdating` prvku GridView programově změnit hodnoty parametrů přiřazené kolekci `UpdateParameters` ObjectDataSource a jak úplně zrušit proces aktualizace.</span><span class="sxs-lookup"><span data-stu-id="3186d-231">So far we have seen how to use the GridView's `RowUpdating` event to programmatically alter the parameter values assigned to the ObjectDataSource's `UpdateParameters` collection as well as how to cancel the updating process altogether.</span></span> <span data-ttu-id="3186d-232">Tyto koncepty přenesou ovládací prvky DetailsView a FormView a také platí pro vkládání a odstraňování.</span><span class="sxs-lookup"><span data-stu-id="3186d-232">These concepts carry over to the DetailsView and FormView controls and also apply to inserting and deleting.</span></span>

<span data-ttu-id="3186d-233">Tyto úlohy lze také provést na úrovni ObjectDataSource prostřednictvím obslužných rutin událostí pro své `Inserting`, `Updating`a `Deleting` událostí.</span><span class="sxs-lookup"><span data-stu-id="3186d-233">These tasks can also be done at the ObjectDataSource level through event handlers for its `Inserting`, `Updating`, and `Deleting` events.</span></span> <span data-ttu-id="3186d-234">Tyto události se aktivují před tím, než se vyvolá přidružená metoda podkladového objektu, a nabídne poslední možnost, jak změnit kolekci vstupních parametrů, nebo zrušit operaci přímo.</span><span class="sxs-lookup"><span data-stu-id="3186d-234">These events fire before the associated method of the underlying object is invoked and provide a last-chance opportunity to modify the input parameters collection or cancel the operation outright.</span></span> <span data-ttu-id="3186d-235">Obslužné rutiny událostí pro tyto tři události jsou předány objektu typu [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) , který má dvě vlastnosti zájmu:</span><span class="sxs-lookup"><span data-stu-id="3186d-235">The event handlers for these three events are passed an object of type [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) that has two properties of interest:</span></span>

- <span data-ttu-id="3186d-236">[Cancel](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), pokud je nastavená na `True`, zruší prováděnou operaci.</span><span class="sxs-lookup"><span data-stu-id="3186d-236">[Cancel](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), which, if set to `True`, cancels the operation being performed</span></span>
- <span data-ttu-id="3186d-237">[Vstupní parametry](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), což je kolekce `InsertParameters`, `UpdateParameters`nebo `DeleteParameters`, v závislosti na tom, zda je obslužná rutina události pro událost `Inserting`, `Updating`nebo `Deleting`</span><span class="sxs-lookup"><span data-stu-id="3186d-237">[InputParameters](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), which is the collection of `InsertParameters`, `UpdateParameters`, or `DeleteParameters`, depending on whether the event handler is for the `Inserting`, `Updating`, or `Deleting` event</span></span>

<span data-ttu-id="3186d-238">Chcete-li znázornit práci s hodnotami parametrů na úrovni ObjectDataSource, vložte do naší stránky prvek DetailsView, který umožňuje uživatelům přidat nový produkt.</span><span class="sxs-lookup"><span data-stu-id="3186d-238">To illustrate working with the parameter values at the ObjectDataSource level, let's include a DetailsView in our page that allows the users to add a new product.</span></span> <span data-ttu-id="3186d-239">Tento prvek DetailsView bude sloužit k poskytnutí rozhraní pro rychlé přidání nového produktu do databáze.</span><span class="sxs-lookup"><span data-stu-id="3186d-239">This DetailsView will be used to provide an interface for quickly adding a new product to the database.</span></span> <span data-ttu-id="3186d-240">Pokud chcete zachovat konzistentní uživatelské rozhraní při přidávání nového produktu, umožněte uživateli, aby zadal jenom hodnoty pro pole `ProductName` a `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="3186d-240">To keep a consistent user interface when adding a new product let's allow the user to only enter values for the `ProductName` and `UnitPrice` fields.</span></span> <span data-ttu-id="3186d-241">Ve výchozím nastavení se hodnoty, které nejsou zadány v rozhraní vložení ovládacího prvku DetailsView, nastaví na hodnotu `NULL` databáze.</span><span class="sxs-lookup"><span data-stu-id="3186d-241">By default, those values that aren't supplied in the DetailsView's inserting interface will be set to a `NULL` database value.</span></span> <span data-ttu-id="3186d-242">Můžeme však použít událost `Inserting` ObjectDataSource k vložení různých výchozích hodnot, jak uvidíme krátce.</span><span class="sxs-lookup"><span data-stu-id="3186d-242">However, we can use the ObjectDataSource's `Inserting` event to inject different default values, as we'll see shortly.</span></span>

## <a name="step-3-providing-an-interface-to-add-new-products"></a><span data-ttu-id="3186d-243">Krok 3: poskytnutí rozhraní pro přidání nových produktů</span><span class="sxs-lookup"><span data-stu-id="3186d-243">Step 3: Providing an Interface to Add New Products</span></span>

<span data-ttu-id="3186d-244">Přetáhněte prvek DetailsView z panelu nástrojů do návrháře nad prvkem GridView, vymažte jeho `Height` a `Width` vlastností a vytvořte jeho vazby na prvek ObjectDataSource, který je již přítomen na stránce.</span><span class="sxs-lookup"><span data-stu-id="3186d-244">Drag a DetailsView from the Toolbox onto the Designer above the GridView, clear out its `Height` and `Width` properties, and bind it to the ObjectDataSource already present on the page.</span></span> <span data-ttu-id="3186d-245">Tím se pro každé pole produktu přidá vlastnost BoundField nebo třídě CheckBoxField podporována.</span><span class="sxs-lookup"><span data-stu-id="3186d-245">This will add a BoundField or CheckBoxField for each of the product's fields.</span></span> <span data-ttu-id="3186d-246">Vzhledem k tomu, že chceme pomocí tohoto prvku DetailsView přidat nové produkty, musíme z inteligentní značky zaškrtnout možnost Povolit vkládání; Nicméně neexistuje žádná taková možnost, protože `Insert()` metoda ObjectDataSource není namapována na metodu třídy `ProductsBLL` (odvolání tohoto mapování na hodnotu (žádné) při konfiguraci zdroje dat viz obrázek 3).</span><span class="sxs-lookup"><span data-stu-id="3186d-246">Since we want to use this DetailsView to add new products, we need to check the Enable Inserting option from the smart tag; however, there's no such option because the ObjectDataSource's `Insert()` method is not mapped to a method in the `ProductsBLL` class (recall that we set this mapping to (None) when configuring the data source see Figure 3).</span></span>

<span data-ttu-id="3186d-247">Chcete-li prvek ObjectDataSource nakonfigurovat, vyberte odkaz konfigurace zdroje dat z jeho inteligentní značky a spuštění průvodce.</span><span class="sxs-lookup"><span data-stu-id="3186d-247">To configure the ObjectDataSource, select the Configure Data Source link from its smart tag, launching the wizard.</span></span> <span data-ttu-id="3186d-248">První obrazovka umožňuje změnit základní objekt, ke kterému je prvek ObjectDataSource svázán; Nechejte nastavenou na `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="3186d-248">The first screen allows you to change the underlying object the ObjectDataSource is bound to; leave it set to `ProductsBLL`.</span></span> <span data-ttu-id="3186d-249">Na další obrazovce jsou uvedena mapování z metod prvku ObjectDataSource na základní objekt.</span><span class="sxs-lookup"><span data-stu-id="3186d-249">The next screen lists the mappings from the ObjectDataSource's methods to the underlying object's.</span></span> <span data-ttu-id="3186d-250">I když explicitně uvádíme, že metody `Insert()` a `Delete()` by neměly být namapované na žádné metody, pokud přejdete na karty pro vložení a odstranění, uvidíte, že je zde mapování.</span><span class="sxs-lookup"><span data-stu-id="3186d-250">Even though we explicitly indicated that the `Insert()` and `Delete()` methods should not be mapped to any methods, if you go to the INSERT and DELETE tabs you'll see that a mapping is there.</span></span> <span data-ttu-id="3186d-251">Důvodem je, že metody `AddProduct` a `DeleteProduct` `ProductsBLL`používají atribut `DataObjectMethodAttribute` k označení toho, že jsou výchozími metodami pro `Insert()` a `Delete()`v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="3186d-251">This is because the `ProductsBLL`'s `AddProduct` and `DeleteProduct` methods use the `DataObjectMethodAttribute` attribute to indicate that they are the default methods for `Insert()` and `Delete()`, respectively.</span></span> <span data-ttu-id="3186d-252">Proto Průvodce ObjectDataSource při každém spuštění Průvodce vybere pouze v případě, že není explicitně zadána nějaká hodnota.</span><span class="sxs-lookup"><span data-stu-id="3186d-252">Hence, the ObjectDataSource wizard selects these each time you run the wizard unless there's some other value explicitly specified.</span></span>

<span data-ttu-id="3186d-253">Ponechte `Insert()` metodu ukazující na metodu `AddProduct`, ale znovu nastavte rozevírací seznam odstranit kartu na (žádné).</span><span class="sxs-lookup"><span data-stu-id="3186d-253">Leave the `Insert()` method pointing to the `AddProduct` method, but again set the DELETE tab's drop-down list to (None).</span></span>

<span data-ttu-id="3186d-254">[![nastavit rozevírací seznam na kartě Vložení na metodu AddProduct](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-254">[![Set the INSERT Tab's Drop-Down List to the AddProduct Method](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span></span>

<span data-ttu-id="3186d-255">**Obrázek 14**: nastavte rozevírací seznam karty vložit na `AddProduct` metodu ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-255">**Figure 14**: Set the INSERT Tab's Drop-Down List to the `AddProduct` Method ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png))</span></span>

<span data-ttu-id="3186d-256">[![nastavit rozevírací seznam na kartě odstranit na (žádné)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-256">[![Set the DELETE Tab's Drop-Down List to (None)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span></span>

<span data-ttu-id="3186d-257">**Obrázek 15**: Nastavení rozevíracího seznamu na kartě odstranit na (žádné) ([kliknutím zobrazíte obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="3186d-257">**Figure 15**: Set the DELETE Tab's Drop-Down List to (None) ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span></span>

<span data-ttu-id="3186d-258">Po provedení těchto změn bude deklarativní syntaxe ObjectDataSource rozbalena tak, aby zahrnovala kolekci `InsertParameters`, jak je znázorněno níže:</span><span class="sxs-lookup"><span data-stu-id="3186d-258">After making these changes, the ObjectDataSource's declarative syntax will be expanded to include an `InsertParameters` collection, as shown below:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample8.aspx)]

<span data-ttu-id="3186d-259">Opětovné spuštění průvodce znovu přidal vlastnost `OldValuesParameterFormatString`.</span><span class="sxs-lookup"><span data-stu-id="3186d-259">Rerunning the wizard added back the `OldValuesParameterFormatString` property.</span></span> <span data-ttu-id="3186d-260">Chvíli počkejte, než tuto vlastnost vymažete, nastavením výchozí hodnoty (`{0}`) nebo jejím odebráním z deklarativní syntaxe.</span><span class="sxs-lookup"><span data-stu-id="3186d-260">Take a moment to clear this property by setting it to the default value (`{0}`) or removing it altogether from the declarative syntax.</span></span>

<span data-ttu-id="3186d-261">V prvku ObjectDataSource, který poskytuje možnosti vložení, inteligentní značka ovládacího prvku DetailsView nyní obsahuje zaškrtávací políčko Povolit vkládání; Vraťte se do návrháře a podívejte se na tuto možnost.</span><span class="sxs-lookup"><span data-stu-id="3186d-261">With the ObjectDataSource providing inserting capabilities, the DetailsView's smart tag will now include the Enable Inserting checkbox; return to the Designer and check this option.</span></span> <span data-ttu-id="3186d-262">Dále zredukovali ovládací prvek DetailsView tak, aby měl pouze dvě BoundFields-`ProductName` a `UnitPrice`-a CommandField.</span><span class="sxs-lookup"><span data-stu-id="3186d-262">Next, pare down the DetailsView so that it only has two BoundFields - `ProductName` and `UnitPrice` - and the CommandField.</span></span> <span data-ttu-id="3186d-263">V tomto okamžiku by deklarativní syntaxe ovládacího prvku DetailsView vypadala takto:</span><span class="sxs-lookup"><span data-stu-id="3186d-263">At this point the DetailsView's declarative syntax should look like:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample9.aspx)]

<span data-ttu-id="3186d-264">Obrázek 16 ukazuje tuto stránku při prohlížení v prohlížeči v tomto okamžiku.</span><span class="sxs-lookup"><span data-stu-id="3186d-264">Figure 16 shows this page when viewed through a browser at this point.</span></span> <span data-ttu-id="3186d-265">Jak vidíte, DetailsView zobrazí název a cenu prvního produktu (Chai).</span><span class="sxs-lookup"><span data-stu-id="3186d-265">As you can see, the DetailsView lists the name and price of the first product (Chai).</span></span> <span data-ttu-id="3186d-266">To je ale rozhraní pro vložení, které poskytuje způsob, jak uživateli rychle přidat nový produkt do databáze.</span><span class="sxs-lookup"><span data-stu-id="3186d-266">What we want, however, is an inserting interface that provides a means for the user to quickly add a new product to the database.</span></span>

<span data-ttu-id="3186d-267">[![prvek DetailsView je aktuálně vykreslen v režimu jen pro čtení.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-267">[![The DetailsView is Currently Rendered in Read-Only Mode](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span></span>

<span data-ttu-id="3186d-268">**Obrázek 16**: element DetailsView je aktuálně vykreslen v režimu jen pro čtení ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-268">**Figure 16**: The DetailsView is Currently Rendered in Read-Only Mode ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png))</span></span>

<span data-ttu-id="3186d-269">Aby bylo možné zobrazit prvek DetailsView v režimu vložení, musíme nastavit vlastnost `DefaultMode` na hodnotu `Inserting`.</span><span class="sxs-lookup"><span data-stu-id="3186d-269">In order to show the DetailsView in its inserting mode we need to set the `DefaultMode` property to `Inserting`.</span></span> <span data-ttu-id="3186d-270">Tím se v režimu vkládání vykreslí prvek DetailsView při prvním navštívení a po vložení nového záznamu ho zachová.</span><span class="sxs-lookup"><span data-stu-id="3186d-270">This renders the DetailsView in insert mode when first visited and keeps it there after inserting a new record.</span></span> <span data-ttu-id="3186d-271">Jak ukazuje obrázek 17, například prvek DetailsView poskytuje rychlé rozhraní pro přidání nového záznamu.</span><span class="sxs-lookup"><span data-stu-id="3186d-271">As Figure 17 shows, such a DetailsView provides a quick interface for adding a new record.</span></span>

<span data-ttu-id="3186d-272">[![ovládacího prvku DetailsView poskytuje rozhraní pro rychlé přidání nového produktu.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-272">[![The DetailsView Provides an Interface for Quickly Adding a New Product](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span></span>

<span data-ttu-id="3186d-273">**Obrázek 17**: element DetailsView poskytuje rozhraní pro rychlé přidání nového produktu ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-273">**Figure 17**: The DetailsView Provides an Interface for Quickly Adding a New Product ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png))</span></span>

<span data-ttu-id="3186d-274">Když uživatel zadá název produktu a cenu (například "Acme voda" a 1,99, jako na obrázku 17), a klikne na tlačítko Vložit, vystavení se provede a vloží se pracovní postup, který vyvolal nový záznam produktu přidaný do databáze.</span><span class="sxs-lookup"><span data-stu-id="3186d-274">When the user enters a product name and price (such as "Acme Water" and 1.99, as in Figure 17) and clicks Insert, a postback ensues and the inserting workflow commences, culminating in a new product record being added to the database.</span></span> <span data-ttu-id="3186d-275">Prvek DetailsView udržuje své rozhraní pro vložení a prvek GridView je automaticky svázán se zdrojem dat, aby mohl zahrnout nový produkt, jak je znázorněno na obrázku 18.</span><span class="sxs-lookup"><span data-stu-id="3186d-275">The DetailsView maintains its inserting interface and the GridView is automatically rebound to its data source in order to include the new product, as shown in Figure 18.</span></span>

![Produkt](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image52.png)

<span data-ttu-id="3186d-277">**Obrázek 18**: produkt "Acme voda" byl přidán do databáze.</span><span class="sxs-lookup"><span data-stu-id="3186d-277">**Figure 18**: The Product "Acme Water" Has Been Added to the Database</span></span>

<span data-ttu-id="3186d-278">I když v prvku GridView na obrázku 18 není zobrazený, pole produktu, které chybí z rozhraní DetailsView `CategoryID`, `SupplierID`, `QuantityPerUnit`a tak dále, jsou přiřazena `NULL` hodnoty databáze.</span><span class="sxs-lookup"><span data-stu-id="3186d-278">While the GridView in Figure 18 doesn't show it, the product fields lacking from the DetailsView interface `CategoryID`, `SupplierID`, `QuantityPerUnit`, and so on are assigned `NULL` database values.</span></span> <span data-ttu-id="3186d-279">Můžete to zobrazit provedením následujících kroků:</span><span class="sxs-lookup"><span data-stu-id="3186d-279">You can see this by performing the following steps:</span></span>

1. <span data-ttu-id="3186d-280">Přejít na Průzkumník serveru v aplikaci Visual Studio</span><span class="sxs-lookup"><span data-stu-id="3186d-280">Go to the Server Explorer in Visual Studio</span></span>
2. <span data-ttu-id="3186d-281">Rozbalení uzlu databáze `NORTHWND.MDF`</span><span class="sxs-lookup"><span data-stu-id="3186d-281">Expanding the `NORTHWND.MDF` database node</span></span>
3. <span data-ttu-id="3186d-282">Pravým tlačítkem myši klikněte na uzel `Products` databázová tabulka.</span><span class="sxs-lookup"><span data-stu-id="3186d-282">Right-click on the `Products` database table node</span></span>
4. <span data-ttu-id="3186d-283">Vyberte možnost zobrazit data tabulky.</span><span class="sxs-lookup"><span data-stu-id="3186d-283">Select Show Table Data</span></span>

<span data-ttu-id="3186d-284">Zobrazí se seznam všech záznamů v `Products` tabulce.</span><span class="sxs-lookup"><span data-stu-id="3186d-284">This will list all of the records in the `Products` table.</span></span> <span data-ttu-id="3186d-285">Jak ukazuje obrázek 19, všechny sloupce nového produktu, které jsou jiné než `ProductID`, `ProductName`a `UnitPrice` mají `NULL` hodnoty.</span><span class="sxs-lookup"><span data-stu-id="3186d-285">As Figure 19 shows, all of our new product's columns other than `ProductID`, `ProductName`, and `UnitPrice` have `NULL` values.</span></span>

<span data-ttu-id="3186d-286">[![pole produktu, která nejsou k dispozici v ovládacím prvku DetailsView, jsou přiřazeny hodnoty NULL.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-286">[![The Product Fields Not Provided in the DetailsView are Assigned NULL Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span></span>

<span data-ttu-id="3186d-287">**Obrázek 19**: pole produktu, která nejsou k dispozici v ovládacím prvku DetailsView, jsou přiřazena `NULL` hodnoty ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-287">**Figure 19**: The Product Fields Not Provided in the DetailsView are Assigned `NULL` Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png))</span></span>

<span data-ttu-id="3186d-288">Pro jednu nebo více hodnot tohoto sloupce můžeme zadat výchozí hodnotu, která je jiná než `NULL`, protože `NULL` není nejlepší výchozí možností nebo protože sloupec databáze sám nepovoluje `NULL` s.</span><span class="sxs-lookup"><span data-stu-id="3186d-288">We may want to provide a default value other than `NULL` for one or more of these column values, either because `NULL` isn't the best default option or because the database column itself doesn't allow `NULL` s.</span></span> <span data-ttu-id="3186d-289">K tomu můžeme programově nastavit hodnoty parametrů kolekce `InputParameters` ovládacího prvku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="3186d-289">To accomplish this we can programmatically set the values of the parameters of the DetailsView's `InputParameters` collection.</span></span> <span data-ttu-id="3186d-290">Toto přiřazení lze provést buď v obslužné rutině události `ItemInserting` ovládacího prvku DetailsView nebo v události `Inserting` elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3186d-290">This assignment can be done either in the event handler for the DetailsView's `ItemInserting` event or the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="3186d-291">Vzhledem k tomu, že jsme se už seznámili s použitím událostí předběžného a post na úrovni webového ovládacího prvku dat, pojďme tento čas prozkoumat pomocí událostí ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3186d-291">Since we've already looked at using the pre- and post-level events at the data Web control level, let's explore using the ObjectDataSource's events this time.</span></span>

## <a name="step-4-assigning-values-to-thecategoryidandsupplieridparameters"></a><span data-ttu-id="3186d-292">Krok 4: přiřazení hodnot k parametrům`CategoryID`a`SupplierID`</span><span class="sxs-lookup"><span data-stu-id="3186d-292">Step 4: Assigning Values to the`CategoryID`and`SupplierID`Parameters</span></span>

<span data-ttu-id="3186d-293">Pro účely tohoto kurzu si představte, že pro naši aplikaci při přidávání nového produktu prostřednictvím tohoto rozhraní je potřeba přiřadit `CategoryID` a `SupplierID` hodnotu 1.</span><span class="sxs-lookup"><span data-stu-id="3186d-293">For this tutorial let's imagine that for our application when adding a new product through this interface it should be assigned a `CategoryID` and `SupplierID` value of 1.</span></span> <span data-ttu-id="3186d-294">Jak bylo zmíněno dříve, prvek ObjectDataSource má dvojici událostí před a po úrovni, které se aktivují během procesu změny dat.</span><span class="sxs-lookup"><span data-stu-id="3186d-294">As mentioned earlier, the ObjectDataSource has a pair of pre- and post-level events that fire during the data modification process.</span></span> <span data-ttu-id="3186d-295">Když je vyvolána jeho `Insert()` metoda, prvek ObjectDataSource nejprve vyvolá událost `Inserting` a pak zavolá metodu, na kterou byla `Insert()` metoda namapována, a nakonec vyvolá událost `Inserted`.</span><span class="sxs-lookup"><span data-stu-id="3186d-295">When its `Insert()` method is invoked, the ObjectDataSource first raises its `Inserting` event, then calls the method that its `Insert()` method has been mapped to, and finally raises the `Inserted` event.</span></span> <span data-ttu-id="3186d-296">Obslužná rutina události `Inserting` poskytne nám poslední příležitost k vylepšení vstupních parametrů nebo zrušení operace.</span><span class="sxs-lookup"><span data-stu-id="3186d-296">The `Inserting` event handler affords us one last opportunity to tweak the input parameters or cancel the operation outright.</span></span>

> [!NOTE]
> <span data-ttu-id="3186d-297">V reálné aplikaci byste pravděpodobně chtěli dát uživateli možnost zadat kategorii a dodavatele, nebo by tuto hodnotu vybrali na základě některých kritérií nebo obchodní logiky (místo toho, abyste vybrali ID 1).</span><span class="sxs-lookup"><span data-stu-id="3186d-297">In a real-world application you would likely want to either let the user specify the category and supplier or would pick this value for them based on some criteria or business logic (rather than blindly selecting an ID of 1).</span></span> <span data-ttu-id="3186d-298">Bez ohledu na tento příklad ukazuje, jak programově nastavit hodnotu vstupního parametru z události předběžné úrovně prvku ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3186d-298">Regardless, the example illustrates how to programmatically set the value of an input parameter from the ObjectDataSource's pre-level event.</span></span>

<span data-ttu-id="3186d-299">Chvíli počkejte, než se vytvoří obslužná rutina události pro událost `Inserting` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3186d-299">Take a moment to create an event handler for the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="3186d-300">Všimněte si, že druhý vstupní parametr obslužné rutiny události je objekt typu `ObjectDataSourceMethodEventArgs`, který má vlastnost pro přístup k kolekci Parameters (`InputParameters`) a vlastnost pro zrušení operace (`Cancel`).</span><span class="sxs-lookup"><span data-stu-id="3186d-300">Notice that the event handler's second input parameter is an object of type `ObjectDataSourceMethodEventArgs`, which has a property to access the parameters collection (`InputParameters`) and a property to cancel the operation (`Cancel`).</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample10.vb)]

<span data-ttu-id="3186d-301">V tomto okamžiku vlastnost `InputParameters` obsahuje kolekci `InsertParameters` prvku ObjectDataSource s hodnotami přiřazenými z prvku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="3186d-301">At this point, the `InputParameters` property contains the ObjectDataSource's `InsertParameters` collection with the values assigned from the DetailsView.</span></span> <span data-ttu-id="3186d-302">Chcete-li změnit hodnotu jednoho z těchto parametrů, stačí použít: `e.InputParameters("paramName") = value`.</span><span class="sxs-lookup"><span data-stu-id="3186d-302">To change the value of one of these parameters, simply use: `e.InputParameters("paramName") = value`.</span></span> <span data-ttu-id="3186d-303">Proto chcete-li nastavit `CategoryID` a `SupplierID` na hodnotu 1, upravte `Inserting` obslužnou rutinu události tak, aby vypadala takto:</span><span class="sxs-lookup"><span data-stu-id="3186d-303">Therefore, to set the `CategoryID` and `SupplierID` to values of 1, adjust the `Inserting` event handler to look like the following:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample11.vb)]

<span data-ttu-id="3186d-304">Tentokrát při přidávání nového produktu (například Acme soda) se sloupce `CategoryID` a `SupplierID` nového produktu nastaví na hodnotu 1 (viz obrázek 20).</span><span class="sxs-lookup"><span data-stu-id="3186d-304">This time when adding a new product (such as Acme Soda), the `CategoryID` and `SupplierID` columns of the new product are set to 1 (see Figure 20).</span></span>

<span data-ttu-id="3186d-305">[![nových produktů teď mají hodnoty KódKategorie a KódDodavatele nastavené na 1.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-305">[![New Products Now Have Their CategoryID and SupplierID Values Set to 1](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span></span>

<span data-ttu-id="3186d-306">**Obrázek 20**: nové produkty mají nyní své `CategoryID` a `SupplierID` hodnoty nastaveny na hodnotu 1 ([kliknutím zobrazíte obrázek v plné velikosti).](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="3186d-306">**Figure 20**: New Products Now Have Their `CategoryID` and `SupplierID` Values Set to 1 ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png))</span></span>

## <a name="summary"></a><span data-ttu-id="3186d-307">Souhrn</span><span class="sxs-lookup"><span data-stu-id="3186d-307">Summary</span></span>

<span data-ttu-id="3186d-308">Během úprav, vkládání a odstraňování procesu může ovládací prvek data web i ObjectDataSource pokračovat prostřednictvím řady událostí před a po úrovni.</span><span class="sxs-lookup"><span data-stu-id="3186d-308">During the editing, inserting, and deleting process, both the data Web control and the ObjectDataSource proceed through a number of pre- and post-level events.</span></span> <span data-ttu-id="3186d-309">V tomto kurzu jsme prozkoumali události na úrovni služby a zjistili jsme, jak je použít k přizpůsobení vstupních parametrů nebo k tomu, aby se operace změny dat zcela zrušila jak z ovládacího prvku data Control, tak z událostí ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3186d-309">In this tutorial we examined the pre-level events and saw how to use these to customize the input parameters or cancel the data modification operation altogether both from the data Web control and ObjectDataSource's events.</span></span> <span data-ttu-id="3186d-310">V dalším kurzu se podíváme na vytváření a používání obslužných rutin událostí pro události na úrovni post.</span><span class="sxs-lookup"><span data-stu-id="3186d-310">In the next tutorial we'll look at creating and using event handlers for the post-level events.</span></span>

<span data-ttu-id="3186d-311">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="3186d-311">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="3186d-312">O autorovi</span><span class="sxs-lookup"><span data-stu-id="3186d-312">About the Author</span></span>

<span data-ttu-id="3186d-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor 7 ASP/ASP. NET Books a zakladatel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="3186d-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3186d-314">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="3186d-314">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3186d-315">Nejnovější kniha je [*Sams naučit se ASP.NET 2,0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="3186d-315">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="3186d-316">Dá se získat na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3186d-316">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="3186d-317">nebo prostřednictvím svého blogu, který najdete na adrese [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="3186d-317">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="3186d-318">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="3186d-318">Special Thanks To</span></span>

<span data-ttu-id="3186d-319">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="3186d-319">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3186d-320">Kontroloři vedoucích k tomuto kurzu byli Jackie Goor a Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="3186d-320">Lead reviewers for this tutorial were Jackie Goor and Liz Shulok.</span></span> <span data-ttu-id="3186d-321">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="3186d-321">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3186d-322">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3186d-322">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="3186d-323">[Předchozí](an-overview-of-inserting-updating-and-deleting-data-vb.md)
> [Další](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="3186d-323">[Previous](an-overview-of-inserting-updating-and-deleting-data-vb.md)
[Next](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span></span>
