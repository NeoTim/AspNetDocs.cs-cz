---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs
title: Dotazování na data pomocí ovládacího prvku SqlDataSourceC#() | Microsoft Docs
author: rick-anderson
description: V předchozích kurzech jsme použili ovládací prvek ObjectDataSource k úplnému oddělení prezentační vrstvy z vrstvy přístupu k datům. Začíná na tomto tutor...
ms.author: riande
ms.date: 02/20/2007
ms.assetid: 60512d6a-b572-4b7a-beb3-3e44b4d2020c
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs
msc.type: authoredcontent
ms.openlocfilehash: 5bda42965f7d1db71b207c0b76e251b8fff64e31
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/28/2019
ms.locfileid: "74606144"
---
# <a name="querying-data-with-the-sqldatasource-control-c"></a><span data-ttu-id="31af6-104">Dotazování na data ovládacím prvkem SqlDataSource (C#)</span><span class="sxs-lookup"><span data-stu-id="31af6-104">Querying Data with the SqlDataSource Control (C#)</span></span>

<span data-ttu-id="31af6-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="31af6-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="31af6-106">[Stáhnout ukázkovou aplikaci](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_CS.exe) nebo [Stáhnout PDF](querying-data-with-the-sqldatasource-control-cs/_static/datatutorial47cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="31af6-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_CS.exe) or [Download PDF](querying-data-with-the-sqldatasource-control-cs/_static/datatutorial47cs1.pdf)</span></span>

> <span data-ttu-id="31af6-107">V předchozích kurzech jsme použili ovládací prvek ObjectDataSource k úplnému oddělení prezentační vrstvy z vrstvy přístupu k datům.</span><span class="sxs-lookup"><span data-stu-id="31af6-107">In the preceding tutorials we used the ObjectDataSource control to fully separate the presentation layer from the Data Access layer.</span></span> <span data-ttu-id="31af6-108">Od tohoto kurzu se dozvíte, jak lze ovládací prvek SqlDataSource použít pro jednoduché aplikace, které nevyžadují takovou striktní oddělení prezentace a přístup k datům.</span><span class="sxs-lookup"><span data-stu-id="31af6-108">Starting with this tutorial, we learn how the SqlDataSource control can be used for simple applications that do not require such a strict separation of presentation and data access.</span></span>

## <a name="introduction"></a><span data-ttu-id="31af6-109">Úvod</span><span class="sxs-lookup"><span data-stu-id="31af6-109">Introduction</span></span>

<span data-ttu-id="31af6-110">Všechny kurzy, které jsme doposud prozkoumali, používaly vrstvenou architekturu skládající se z prezentační, obchodní logiky a vrstev přístupu k datům.</span><span class="sxs-lookup"><span data-stu-id="31af6-110">All of the tutorials we ve examined so far have used a tiered architecture consisting of presentation, Business Logic, and Data Access layers.</span></span> <span data-ttu-id="31af6-111">Vrstva přístupu k datům (DAL) byla vytvořena v prvním kurzu ([Vytvoření vrstvy přístupu k datům](../introduction/creating-a-data-access-layer-cs.md)) a vrstvy obchodní logiky v druhé ([Vytvoření vrstvy obchodní logiky](../introduction/creating-a-business-logic-layer-cs.md)).</span><span class="sxs-lookup"><span data-stu-id="31af6-111">The Data Access Layer (DAL) was crafted in the first tutorial ([Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md)) and the Business Logic Layer in the second ([Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-cs.md)).</span></span> <span data-ttu-id="31af6-112">Počínaje kurzem [zobrazení dat s](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) popisem ObjectDataSource jsme viděli, jak používat ASP.NET 2,0 s novým ovládacím prvkem ObjectDataSource pro deklarativní rozhraní s architekturou z prezentační vrstvy.</span><span class="sxs-lookup"><span data-stu-id="31af6-112">Starting with the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) tutorial, we saw how to use ASP.NET 2.0 s new ObjectDataSource control to declaratively interface with the architecture from the presentation layer.</span></span>

<span data-ttu-id="31af6-113">I když všechny kurzy, které doposud používaly architekturu pro práci s daty, také umožňují přístup k datům databáze, jejich vkládání, aktualizace a odstraňování dat přímo ze stránky ASP.NET a jejich obejití.</span><span class="sxs-lookup"><span data-stu-id="31af6-113">While all of the tutorials so far have used the architecture to work with data, it is also possible to access, insert, update, and delete database data directly from an ASP.NET page, bypassing the architecture.</span></span> <span data-ttu-id="31af6-114">Tím umístíte konkrétní databázové dotazy a obchodní logiku přímo do webové stránky.</span><span class="sxs-lookup"><span data-stu-id="31af6-114">Doing so places the specific database queries and business logic directly in the web page.</span></span> <span data-ttu-id="31af6-115">Pro dostatečně velké nebo složité aplikace, navrhování, implementaci a používání vrstvených architektur je v případě úspěchu, aktualizace a udržovatelnosti aplikace velmi důležité.</span><span class="sxs-lookup"><span data-stu-id="31af6-115">For sufficiently large or complex applications, designing, implementing, and using a tiered architecture is vitally important for the success, updatability, and maintainability of the application.</span></span> <span data-ttu-id="31af6-116">Vývoj robustní architektury však může být zbytečný při vytváření více než jedna z nich, jednorázových aplikací.</span><span class="sxs-lookup"><span data-stu-id="31af6-116">Developing a robust architecture, however, may be unnecessary when creating exceedingly simple, one-off applications.</span></span>

<span data-ttu-id="31af6-117">ASP.NET 2,0 poskytuje pět vestavěných ovládacích prvků zdroje dat [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx)a [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="31af6-117">ASP.NET 2.0 provides five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span></span> <span data-ttu-id="31af6-118">Třída SqlDataSource se dá použít pro přístup k datům a jejich úpravu přímo z relační databáze, včetně Microsoft SQL Server, Microsoft Access, Oracle, MySQL a dalších.</span><span class="sxs-lookup"><span data-stu-id="31af6-118">The SqlDataSource can be used to access and modify data directly from a relational database, including Microsoft SQL Server, Microsoft Access, Oracle, MySQL, and others.</span></span> <span data-ttu-id="31af6-119">V tomto kurzu a dalších třech prozkoumáme, jak pracovat s ovládacím prvkem SqlDataSource, prozkoumat způsob dotazování a filtrování dat databáze a jak používat SqlDataSource k vkládání, aktualizaci a odstraňování dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-119">In this tutorial and the next three, we'll examine how to work with the SqlDataSource control, exploring how to query and filter database data, as well as how to use the SqlDataSource to insert, update, and delete data.</span></span>

![ASP.NET 2,0 zahrnuje pět vestavěných ovládacích prvků zdroje dat.](querying-data-with-the-sqldatasource-control-cs/_static/image1.gif)

<span data-ttu-id="31af6-121">**Obrázek 1**: ASP.NET 2,0 zahrnuje pět vestavěných ovládacích prvků zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-121">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>

## <a name="comparing-the-objectdatasource-and-sqldatasource"></a><span data-ttu-id="31af6-122">Porovnání prvku ObjectDataSource a SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="31af6-122">Comparing the ObjectDataSource and SqlDataSource</span></span>

<span data-ttu-id="31af6-123">Koncepční ovládací prvky ObjectDataSource i SqlDataSource jsou jednoduše proxy na data.</span><span class="sxs-lookup"><span data-stu-id="31af6-123">Conceptually, both the ObjectDataSource and SqlDataSource controls are simply proxies to data.</span></span> <span data-ttu-id="31af6-124">Jak je popsáno v kurzu [zobrazení dat s](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) využitím prvku ObjectDataSource, prvek ObjectDataSource obsahuje vlastnosti, které určují typ objektu, který poskytuje data a metody k vyvolání pro výběr, vložení, aktualizaci a odstranění dat z podkladového typu objektu.</span><span class="sxs-lookup"><span data-stu-id="31af6-124">As discussed in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) tutorial, the ObjectDataSource has properties that indicate the object type that provides the data and the methods to invoke to select, insert, update, and delete data from the underlying object type.</span></span> <span data-ttu-id="31af6-125">Po nakonfigurování vlastností ObjectDataSource s lze ovládací prvek data web, jako je například GridView, DetailsView nebo DataList, svázat s ovládacím prvkem, pomocí `Select()`ObjectDataSource s, `Insert()`, `Delete()`a `Update()` metody pro interakci s podkladovou architekturou.</span><span class="sxs-lookup"><span data-stu-id="31af6-125">Once the ObjectDataSource s properties have been configured, a data Web control such as a GridView, DetailsView, or DataList can be bound to the control, using the ObjectDataSource s `Select()`, `Insert()`, `Delete()`, and `Update()` methods to interact with the underlying architecture.</span></span>

<span data-ttu-id="31af6-126">Třída SqlDataSource poskytuje stejné funkce, ale funguje na relační databázi, nikoli v knihovně objektů.</span><span class="sxs-lookup"><span data-stu-id="31af6-126">The SqlDataSource provides the same functionality, but operates against a relational database rather than an object library.</span></span> <span data-ttu-id="31af6-127">Ve třídě SqlDataSource je nutné zadat připojovací řetězec databáze a ad-hoc dotazy SQL nebo uložené procedury, které mají být provedeny pro vložení, aktualizaci, odstranění a načtení dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-127">With the SqlDataSource, we must specify the database connection string and the ad-hoc SQL queries or stored procedures to execute to insert, update, delete, and retrieve data.</span></span> <span data-ttu-id="31af6-128">Metody `Select()`SqlDataSource, `Insert()`, `Update()`a `Delete()`, se při vyvolání připojí k zadané databázi a vydávají odpovídající dotaz SQL.</span><span class="sxs-lookup"><span data-stu-id="31af6-128">The SqlDataSource s `Select()`, `Insert()`, `Update()`, and `Delete()` methods, when invoked, connect to the specified database and issue the appropriate SQL query.</span></span> <span data-ttu-id="31af6-129">Jak znázorňuje následující obrázek, tyto metody grunt práci s připojením k databázi, vydávají dotaz a vracejí výsledky.</span><span class="sxs-lookup"><span data-stu-id="31af6-129">As the following diagram illustrates, the these methods do the grunt work of connecting to a database, issuing a query, and returning the results.</span></span>

![Třída SqlDataSource slouží jako proxy k databázi.](querying-data-with-the-sqldatasource-control-cs/_static/image2.gif)

<span data-ttu-id="31af6-131">**Obrázek 2**: třída SqlDataSource slouží jako proxy databáze.</span><span class="sxs-lookup"><span data-stu-id="31af6-131">**Figure 2**: The SqlDataSource Serves as a Proxy to the Database</span></span>

> [!NOTE]
> <span data-ttu-id="31af6-132">V tomto kurzu se zaměříme na načítání dat z databáze.</span><span class="sxs-lookup"><span data-stu-id="31af6-132">In this tutorial we'll focus on retrieving data from the database.</span></span> <span data-ttu-id="31af6-133">V kurzu [vložení, aktualizace a odstranění dat pomocí ovládacího prvku SqlDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-cs.md) uvidíte, jak nakonfigurovat SqlDataSource pro podporu vložení, aktualizace a odstranění.</span><span class="sxs-lookup"><span data-stu-id="31af6-133">In the [Inserting, Updating, and Deleting Data with the SqlDataSource Control](inserting-updating-and-deleting-data-with-the-sqldatasource-cs.md) tutorial, we'll see how to configure the SqlDataSource to support inserting, updating, and deleting.</span></span>

## <a name="the-sqldatasource-and-accessdatasource-controls"></a><span data-ttu-id="31af6-134">Ovládací prvky SqlDataSource a AccessDataSource</span><span class="sxs-lookup"><span data-stu-id="31af6-134">The SqlDataSource and AccessDataSource Controls</span></span>

<span data-ttu-id="31af6-135">Kromě ovládacího prvku SqlDataSource ASP.NET 2,0 také obsahuje ovládací prvek AccessDataSource.</span><span class="sxs-lookup"><span data-stu-id="31af6-135">In addition to the SqlDataSource control, ASP.NET 2.0 also includes an AccessDataSource control.</span></span> <span data-ttu-id="31af6-136">Tyto dva různé ovládací prvky zavedou mnoho vývojářů, kteří jsou noví v ASP.NET 2,0, což má za následek, že ovládací prvek AccessDataSource je navržený tak, aby fungoval výhradně s přístupem k aplikaci Microsoft Access s ovládacím prvkem SqlDataSource Microsoft SQL Server navrženým</span><span class="sxs-lookup"><span data-stu-id="31af6-136">These two different controls lead many developers new to ASP.NET 2.0 to suspect that the AccessDataSource control is designed to work exclusively with Microsoft Access with the SqlDataSource control designed to work exclusively with Microsoft SQL Server.</span></span> <span data-ttu-id="31af6-137">I když je prvek AccessDataSource navržený tak, aby fungoval konkrétně s přístupem k aplikaci Microsoft Access, ovládací prvek SqlDataSource *funguje s relační databází, ke které* lze přistupovat prostřednictvím rozhraní .NET.</span><span class="sxs-lookup"><span data-stu-id="31af6-137">While the AccessDataSource is designed to work specifically with Microsoft Access, the SqlDataSource control works with *any* relational database that can be accessed through .NET.</span></span> <span data-ttu-id="31af6-138">To zahrnuje všechna úložiště dat kompatibilní s OleDb nebo rozhraním ODBC, jako jsou Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL a PostgreSQL, a to i mezi mnoha ostatními.</span><span class="sxs-lookup"><span data-stu-id="31af6-138">This includes any OleDb- or ODBC-compliant data stores, such as Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL, and PostgreSQL, among many others.</span></span>

<span data-ttu-id="31af6-139">Jediným rozdílem mezi ovládacími prvky AccessDataSource a SqlDataSource je způsob, jakým jsou zadány informace o připojení databáze.</span><span class="sxs-lookup"><span data-stu-id="31af6-139">The sole difference between the AccessDataSource and SqlDataSource controls is how the database connection information is specified.</span></span> <span data-ttu-id="31af6-140">Ovládací prvek AccessDataSource potřebuje pouze cestu k souboru databáze aplikace Access.</span><span class="sxs-lookup"><span data-stu-id="31af6-140">The AccessDataSource control needs just the file path to the Access database file.</span></span> <span data-ttu-id="31af6-141">Třída SqlDataSource na druhé straně vyžaduje úplný připojovací řetězec.</span><span class="sxs-lookup"><span data-stu-id="31af6-141">The SqlDataSource, on the other hand, requires a complete connection string.</span></span>

## <a name="step-1-creating-the-sqldatasource-web-pages"></a><span data-ttu-id="31af6-142">Krok 1: vytvoření webových stránek SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="31af6-142">Step 1: Creating the SqlDataSource Web Pages</span></span>

<span data-ttu-id="31af6-143">Předtím, než začneme zkoumat, jak pracovat přímo s daty databáze pomocí ovládacího prvku SqlDataSource, si nejdřív chvíli počkejte, než vytvoříte stránky ASP.NET v našem projektu webu, který budeme potřebovat pro tento kurz a další tři.</span><span class="sxs-lookup"><span data-stu-id="31af6-143">Before we start exploring how to work directly with database data using the SqlDataSource control, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="31af6-144">Začněte přidáním nové složky s názvem `SqlDataSource`.</span><span class="sxs-lookup"><span data-stu-id="31af6-144">Start by adding a new folder named `SqlDataSource`.</span></span> <span data-ttu-id="31af6-145">Dále přidejte následující stránky ASP.NET do této složky a nezapomeňte přidružit jednotlivé stránky k `Site.master` hlavní stránce:</span><span class="sxs-lookup"><span data-stu-id="31af6-145">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Querying.aspx`
- `ParameterizedQueries.aspx`
- `InsertUpdateDelete.aspx`
- `OptimisticConcurrency.aspx`

![Přidání stránek ASP.NET pro kurzy týkající se SqlDataSource](querying-data-with-the-sqldatasource-control-cs/_static/image3.gif)

<span data-ttu-id="31af6-147">**Obrázek 3**: přidání stránek ASP.NET pro kurzy týkající se SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="31af6-147">**Figure 3**: Add the ASP.NET Pages for the SqlDataSource-Related Tutorials</span></span>

<span data-ttu-id="31af6-148">Podobně jako v ostatních složkách `Default.aspx` ve složce `SqlDataSource` vypíše kurzy v části.</span><span class="sxs-lookup"><span data-stu-id="31af6-148">Like in the other folders, `Default.aspx` in the `SqlDataSource` folder will list the tutorials in its section.</span></span> <span data-ttu-id="31af6-149">Zajistěte, aby tato funkce poskytovala `SectionLevelTutorialListing.ascx` uživatelský ovládací prvek.</span><span class="sxs-lookup"><span data-stu-id="31af6-149">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="31af6-150">Proto tento uživatelský ovládací prvek přidejte do `Default.aspx` tím, že ho přetáhnete z Průzkumník řešení na zobrazení Návrh stránky.</span><span class="sxs-lookup"><span data-stu-id="31af6-150">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="31af6-151">[![přidat uživatelský ovládací prvek SectionLevelTutorialListing. ascx do default. aspx](querying-data-with-the-sqldatasource-control-cs/_static/image5.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image4.gif)</span><span class="sxs-lookup"><span data-stu-id="31af6-151">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](querying-data-with-the-sqldatasource-control-cs/_static/image5.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image4.gif)</span></span>

<span data-ttu-id="31af6-152">**Obrázek 4**: Přidání uživatelského ovládacího prvku `SectionLevelTutorialListing.ascx` do `Default.aspx` ([kliknutím zobrazíte obrázek v plné velikosti](querying-data-with-the-sqldatasource-control-cs/_static/image6.gif))</span><span class="sxs-lookup"><span data-stu-id="31af6-152">**Figure 4**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](querying-data-with-the-sqldatasource-control-cs/_static/image6.gif))</span></span>

<span data-ttu-id="31af6-153">Nakonec tyto čtyři stránky přidejte jako položky do souboru `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="31af6-153">Lastly, add these four pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="31af6-154">Konkrétně přidejte následující značku po přidání vlastních tlačítek do prvku DataList a Repeater `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="31af6-154">Specifically, add the following markup after the Adding Custom Buttons to the DataList and Repeater `<siteMapNode>`:</span></span>

[!code-sql[Main](querying-data-with-the-sqldatasource-control-cs/samples/sample1.sql)]

<span data-ttu-id="31af6-155">Po aktualizaci `Web.sitemap`chvíli počkejte, než se zobrazí web kurzy prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="31af6-155">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="31af6-156">Nabídka na levé straně teď obsahuje položky pro kurzy pro úpravy, vkládání a odstraňování.</span><span class="sxs-lookup"><span data-stu-id="31af6-156">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![Mapa webu teď obsahuje položky pro kurzy SqlDataSource](querying-data-with-the-sqldatasource-control-cs/_static/image7.gif)

<span data-ttu-id="31af6-158">**Obrázek 5**: Mapa webu teď obsahuje položky pro kurzy SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="31af6-158">**Figure 5**: The Site Map Now Includes Entries for the SqlDataSource Tutorials</span></span>

## <a name="step-2-adding-and-configuring-the-sqldatasource-control"></a><span data-ttu-id="31af6-159">Krok 2: Přidání a konfigurace ovládacího prvku SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="31af6-159">Step 2: Adding and Configuring the SqlDataSource Control</span></span>

<span data-ttu-id="31af6-160">Začněte tím, že otevřete stránku `Querying.aspx` ve složce `SqlDataSource` a přepnete na zobrazení Návrh.</span><span class="sxs-lookup"><span data-stu-id="31af6-160">Start by opening the `Querying.aspx` page in the `SqlDataSource` folder and switch to Design view.</span></span> <span data-ttu-id="31af6-161">Přetáhněte ovládací prvek SqlDataSource ze sady nástrojů do návrháře a nastavte jeho `ID` na `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="31af6-161">Drag a SqlDataSource control from the Toolbox onto the Designer and set its `ID` to `ProductsDataSource`.</span></span> <span data-ttu-id="31af6-162">Stejně jako v prvku ObjectDataSource, třída SqlDataSource nevytvoří žádný Vykreslený výstup, a proto se zobrazí jako šedé pole na návrhové ploše.</span><span class="sxs-lookup"><span data-stu-id="31af6-162">As with the ObjectDataSource, the SqlDataSource does not produce any rendered output and therefore appears as a gray box on the design surface.</span></span> <span data-ttu-id="31af6-163">Chcete-li konfigurovat SqlDataSource, klikněte na odkaz konfigurace zdroje dat z inteligentní značky SqlDataSource s.</span><span class="sxs-lookup"><span data-stu-id="31af6-163">To configure the SqlDataSource, click on the Configure Data Source link from the SqlDataSource s smart tag.</span></span>

![Klikněte na odkaz konfigurace zdroje dat z inteligentní značky SqlDataSource s.](querying-data-with-the-sqldatasource-control-cs/_static/image8.gif)

<span data-ttu-id="31af6-165">**Obrázek 6**: klikněte na odkaz konfigurace zdroje dat ze inteligentní značky SqlDataSource s.</span><span class="sxs-lookup"><span data-stu-id="31af6-165">**Figure 6**: Click on the Configure Data Source Link from the SqlDataSource s Smart Tag</span></span>

<span data-ttu-id="31af6-166">Tím se zobrazí průvodce pro ovládací prvek SqlDataSource s konfigurací zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-166">This brings up the SqlDataSource control s Configure Data Source wizard.</span></span> <span data-ttu-id="31af6-167">I když se postup Průvodce s liší od ovládacího prvku ObjectDataSource s, je konečný cíl stejný, aby poskytoval podrobné informace o tom, jak načíst, vkládat, aktualizovat a odstraňovat data prostřednictvím zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-167">While the wizard s steps differ from the ObjectDataSource control s, the end goal is the same to provide the details on how to retrieve, insert, update, and delete data through the data source.</span></span> <span data-ttu-id="31af6-168">Pro SqlDataSource to zahrnuje určení podkladové databáze, která se má použít, a poskytnutí příkazů SQL ad hoc nebo uložených procedur.</span><span class="sxs-lookup"><span data-stu-id="31af6-168">For the SqlDataSource this entails specifying the underlying database to use and providing the ad-hoc SQL statements or stored procedures.</span></span>

<span data-ttu-id="31af6-169">První krok průvodce vás vyzve k zadání databáze.</span><span class="sxs-lookup"><span data-stu-id="31af6-169">The first wizard step prompts us for the database.</span></span> <span data-ttu-id="31af6-170">Rozevírací seznam obsahuje tyto databáze nacházející se ve složce Web Application `App_Data` a ty, které byly přidány do uzlu datová připojení v Průzkumník serveru.</span><span class="sxs-lookup"><span data-stu-id="31af6-170">The drop-down list includes those databases found in the web application s `App_Data` folder and those that have been added to the Data Connections node in the Server Explorer.</span></span> <span data-ttu-id="31af6-171">Vzhledem k tomu, že jsme už přidali připojovací řetězec pro databázi `NORTHWIND.MDF` do složky `App_Data` do našeho souboru projektu s `Web.config`, rozevírací seznam obsahuje odkaz na tento připojovací řetězec `NORTHWINDConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="31af6-171">Since we ve already added a connection string for the `NORTHWIND.MDF` database in the `App_Data` folder to our project s `Web.config` file, the drop-down list includes a reference to that connection string, `NORTHWINDConnectionString`.</span></span> <span data-ttu-id="31af6-172">V rozevíracím seznamu vyberte tuto položku a klikněte na další.</span><span class="sxs-lookup"><span data-stu-id="31af6-172">Choose this item from the drop-down list and click Next.</span></span>

![Z rozevíracího seznamu vyberte NORTHWINDConnectionString.](querying-data-with-the-sqldatasource-control-cs/_static/image9.gif)

<span data-ttu-id="31af6-174">**Obrázek 7**: volba `NORTHWINDConnectionString` v rozevíracím seznamu</span><span class="sxs-lookup"><span data-stu-id="31af6-174">**Figure 7**: Choose the `NORTHWINDConnectionString` from the Drop-Down List</span></span>

<span data-ttu-id="31af6-175">Po výběru databáze Průvodce požádá, aby dotaz vrátil data.</span><span class="sxs-lookup"><span data-stu-id="31af6-175">After choosing the database, the wizard asks for the query to return data.</span></span> <span data-ttu-id="31af6-176">Můžeme buď zadat sloupce tabulky nebo zobrazení, které se mají vrátit, nebo můžete zadat vlastní příkaz SQL nebo zadat uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="31af6-176">We can either specify the columns of a table or view to return or can enter a custom SQL statement or specify a stored procedure.</span></span> <span data-ttu-id="31af6-177">Mezi touto volbou můžete přepínat pomocí příkazu zadat vlastní příkaz SQL nebo uloženou proceduru a určit sloupce z tabulky nebo přepínačů zobrazení.</span><span class="sxs-lookup"><span data-stu-id="31af6-177">You can toggle between this choice through the Specify a custom SQL statement or stored procedure and Specify columns from a table or view radio buttons.</span></span>

> [!NOTE]
> <span data-ttu-id="31af6-178">V tomto prvním příkladu použijte možnost zadat sloupce z tabulky nebo zobrazení.</span><span class="sxs-lookup"><span data-stu-id="31af6-178">For this first example, let s use the Specify columns from a table or view option.</span></span> <span data-ttu-id="31af6-179">Později v tomto kurzu se vrátíme k Průvodci a prozkoumejte možnost zadat vlastní příkaz SQL nebo uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="31af6-179">We'll return to the wizard later in this tutorial and explore the Specify a custom SQL statement or stored procedure option.</span></span>

<span data-ttu-id="31af6-180">Na obrázku 8 se zobrazí obrazovka konfigurovat příkaz pro výběr, pokud je vybrán přepínač zadat sloupce z tabulky nebo zobrazení.</span><span class="sxs-lookup"><span data-stu-id="31af6-180">Figure 8 shows the Configure the Select Statement screen when the Specify columns from a table or view radio button is selected.</span></span> <span data-ttu-id="31af6-181">Rozevírací seznam obsahuje sadu tabulek a zobrazení v databázi Northwind s vybranými sloupci tabulky nebo zobrazení v následujícím seznamu zaškrtávacích políček.</span><span class="sxs-lookup"><span data-stu-id="31af6-181">The drop-down list contains the set of tables and views in the Northwind database, with the selected table or view s columns displayed in the checkbox list below.</span></span> <span data-ttu-id="31af6-182">V tomto příkladu můžete pomocí tabulky `Products` vracet sloupce `ProductID`, `ProductName`a `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="31af6-182">For this example, let s return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table.</span></span> <span data-ttu-id="31af6-183">Jak ukazuje obrázek 8, po provedení těchto výběrů zobrazí průvodce Výsledný příkaz SQL `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span><span class="sxs-lookup"><span data-stu-id="31af6-183">As Figure 8 shows, after making these selections the wizard shows the resulting SQL statement `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span></span>

![Vrátit data z tabulky Products](querying-data-with-the-sqldatasource-control-cs/_static/image10.gif)

<span data-ttu-id="31af6-185">**Obrázek 8**: návratová Data z `Products` tabulky</span><span class="sxs-lookup"><span data-stu-id="31af6-185">**Figure 8**: Return Data from the `Products` Table</span></span>

<span data-ttu-id="31af6-186">Jakmile nakonfigurujete Průvodce tak, aby vracel sloupce `ProductID`, `ProductName`a `UnitPrice` z tabulky `Products`, klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="31af6-186">Once you have configured the wizard to return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table, click the Next button.</span></span> <span data-ttu-id="31af6-187">Tato poslední obrazovka nabízí příležitost k prohlédnutí výsledků dotazu nakonfigurovaného z předchozího kroku.</span><span class="sxs-lookup"><span data-stu-id="31af6-187">This final screen provides an opportunity to examine the results of the query configured from the previous step.</span></span> <span data-ttu-id="31af6-188">Kliknutí na tlačítko Test Query spustí nakonfigurovaný příkaz `SELECT` a zobrazí výsledky v mřížce.</span><span class="sxs-lookup"><span data-stu-id="31af6-188">Clicking the Test Query button executes the configured `SELECT` statement and displays the results in a grid.</span></span>

![Kliknutím na tlačítko Test dotazu si můžete prohlédnout svůj dotaz SELECT.](querying-data-with-the-sqldatasource-control-cs/_static/image11.gif)

<span data-ttu-id="31af6-190">**Obrázek 9**: kliknutím na tlačítko Test dotazu si můžete prohlédnout `SELECT` dotaz</span><span class="sxs-lookup"><span data-stu-id="31af6-190">**Figure 9**: Click the Test Query Button to Review Your `SELECT` Query</span></span>

<span data-ttu-id="31af6-191">Průvodce dokončíte kliknutím na tlačítko Dokončit.</span><span class="sxs-lookup"><span data-stu-id="31af6-191">To complete the wizard, click Finish.</span></span>

<span data-ttu-id="31af6-192">Podobně jako v prvku ObjectDataSource, průvodce setřídě SqlDataSource pouze přiřazuje hodnoty vlastnostím ovládacího prvku, konkrétně [`ConnectionString`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) a [`SelectCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) vlastností.</span><span class="sxs-lookup"><span data-stu-id="31af6-192">Like with the ObjectDataSource, the SqlDataSource s wizard merely assigns values to the control s properties, namely the [`ConnectionString`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) and [`SelectCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) properties.</span></span> <span data-ttu-id="31af6-193">Po dokončení průvodce by deklarativní označení ovládacího prvku SqlDataSource mělo vypadat podobně jako v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="31af6-193">After completing the wizard, your SqlDataSource control s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-cs/samples/sample2.aspx)]

<span data-ttu-id="31af6-194">Vlastnost `ConnectionString` poskytuje informace o tom, jak se připojit k databázi.</span><span class="sxs-lookup"><span data-stu-id="31af6-194">The `ConnectionString` property provides information on how to connect to the database.</span></span> <span data-ttu-id="31af6-195">Této vlastnosti může být přiřazena úplná, pevně zakódovaná hodnota připojovacího řetězce nebo může ukazovat na připojovací řetězec v `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="31af6-195">This property can be assigned a complete, hard-coded connection string value or can point to a connection string in `Web.config`.</span></span> <span data-ttu-id="31af6-196">Chcete-li odkazovat na hodnotu připojovacího řetězce v souboru Web. config, použijte syntaxi `<%$ expressionPrefix:expressionValue %>`.</span><span class="sxs-lookup"><span data-stu-id="31af6-196">To reference a connection string value in Web.config, use the syntax `<%$ expressionPrefix:expressionValue %>`.</span></span> <span data-ttu-id="31af6-197">*ExpressionPrefix* je obvykle connectionStrings a *expressionValue* je název řetězce připojení v [části`<connectionStrings>`](https://msdn.microsoft.com/library/bf7sd233.aspx)`Web.config`.</span><span class="sxs-lookup"><span data-stu-id="31af6-197">Typically, *expressionPrefix* is ConnectionStrings and *expressionValue* is the name of the connect string in the `Web.config` [`<connectionStrings>` section](https://msdn.microsoft.com/library/bf7sd233.aspx).</span></span> <span data-ttu-id="31af6-198">Syntaxe se však dá použít k odkazování `<appSettings>` prvků nebo obsahu ze souborů prostředků.</span><span class="sxs-lookup"><span data-stu-id="31af6-198">However, the syntax can be used to reference `<appSettings>` elements or content from resource files.</span></span> <span data-ttu-id="31af6-199">Další informace o této syntaxi najdete v tématu [Přehled výrazů ASP.NET](https://msdn.microsoft.com/library/d5bd1tad.aspx) .</span><span class="sxs-lookup"><span data-stu-id="31af6-199">See [ASP.NET Expressions Overview](https://msdn.microsoft.com/library/d5bd1tad.aspx) for more on this syntax.</span></span>

<span data-ttu-id="31af6-200">Vlastnost `SelectCommand` Určuje příkaz SQL ad hoc nebo uloženou proceduru, která má být provedena pro vrácení dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-200">The `SelectCommand` property specifies the ad-hoc SQL statement or stored procedure to execute to return the data.</span></span>

## <a name="step-3-adding-a-data-web-control-and-binding-it-to-the-sqldatasource"></a><span data-ttu-id="31af6-201">Krok 3: Přidání webového ovládacího prvku data a jeho svázání na třídě SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="31af6-201">Step 3: Adding a Data Web Control and Binding it to the SqlDataSource</span></span>

<span data-ttu-id="31af6-202">Jakmile je třída SqlDataSource nakonfigurována, může být svázána s datovým ovládacím prvkem webového ovládacího prvku, jako je například GridView nebo DetailsView.</span><span class="sxs-lookup"><span data-stu-id="31af6-202">Once the SqlDataSource has been configured, it can be bound to a data Web control, such as a GridView or DetailsView.</span></span> <span data-ttu-id="31af6-203">Pro tento kurz se zobrazí data v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="31af6-203">For this tutorial, let s display the data in a GridView.</span></span> <span data-ttu-id="31af6-204">Z panelu nástrojů přetáhněte prvek GridView na stránku a navažte jej na `ProductsDataSource` SqlDataSource tím, že v rozevíracím seznamu v inteligentní značce GridView. vyberete zdroj dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-204">From the Toolbox, drag a GridView onto the page and bind it to the `ProductsDataSource` SqlDataSource by choosing the data source from the drop-down list in the GridView s smart tag.</span></span>

<span data-ttu-id="31af6-205">[![přidání prvku GridView a jeho svázání s ovládacím prvkem SqlDataSource](querying-data-with-the-sqldatasource-control-cs/_static/image13.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image12.gif)</span><span class="sxs-lookup"><span data-stu-id="31af6-205">[![Add a GridView and Bind it to the SqlDataSource Control](querying-data-with-the-sqldatasource-control-cs/_static/image13.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image12.gif)</span></span>

<span data-ttu-id="31af6-206">**Obrázek 10**: Přidání prvku GridView a jeho svázání s ovládacím prvkem SqlDataSource ([kliknutím zobrazíte obrázek v plné velikosti](querying-data-with-the-sqldatasource-control-cs/_static/image14.gif))</span><span class="sxs-lookup"><span data-stu-id="31af6-206">**Figure 10**: Add a GridView and Bind it to the SqlDataSource Control ([Click to view full-size image](querying-data-with-the-sqldatasource-control-cs/_static/image14.gif))</span></span>

<span data-ttu-id="31af6-207">Jakmile vyberete ovládací prvek SqlDataSource z rozevíracího seznamu v inteligentní značce GridView s, Visual Studio automaticky přidá vlastnost BoundField nebo třídě CheckBoxField podporována do prvku GridView pro každý sloupec vrácený ovládacím prvkem zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-207">Once you ve selected the SqlDataSource control from the drop-down list in the GridView s smart tag, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the columns returned by the data source control.</span></span> <span data-ttu-id="31af6-208">Vzhledem k tomu, že třída SqlDataSource vrátí tři databázové sloupce `ProductID`, `ProductName`a `UnitPrice` existují tři pole v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="31af6-208">Since the SqlDataSource returns three database columns `ProductID`, `ProductName`, and `UnitPrice` there are three fields in the GridView.</span></span>

<span data-ttu-id="31af6-209">Chvíli počkejte, než se nakonfiguruje ovládací prvek GridView s třemi BoundFieldsy.</span><span class="sxs-lookup"><span data-stu-id="31af6-209">Take a moment to configure the GridView s three BoundFields.</span></span> <span data-ttu-id="31af6-210">Změňte vlastnost `ProductName` pole s `HeaderText` na název produktu a `UnitPrice` pole s na Price.</span><span class="sxs-lookup"><span data-stu-id="31af6-210">Change the `ProductName` field s `HeaderText` property to Product Name and the `UnitPrice` field s to Price.</span></span> <span data-ttu-id="31af6-211">Naformátujte také pole `UnitPrice` jako měnu.</span><span class="sxs-lookup"><span data-stu-id="31af6-211">Also format the `UnitPrice` field as a currency.</span></span> <span data-ttu-id="31af6-212">Po provedení těchto úprav by deklarativní značky GridViewu měly vypadat podobně jako následující:</span><span class="sxs-lookup"><span data-stu-id="31af6-212">After making these modifications, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-cs/samples/sample3.aspx)]

<span data-ttu-id="31af6-213">Navštivte tuto stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="31af6-213">Visit this page through a browser.</span></span> <span data-ttu-id="31af6-214">Jak ukazuje obrázek 11, GridView zobrazí seznam jednotlivých produktů `ProductID`, `ProductName`a `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="31af6-214">As Figure 11 shows, the GridView lists each product s `ProductID`, `ProductName`, and `UnitPrice` values.</span></span>

<span data-ttu-id="31af6-215">[![prvek GridView zobrazuje jednotlivé hodnoty produktů ProductID, NázevVýrobku a UnitPrice.](querying-data-with-the-sqldatasource-control-cs/_static/image16.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image15.gif)</span><span class="sxs-lookup"><span data-stu-id="31af6-215">[![The GridView Displays Each Product s ProductID, ProductName, and UnitPrice Values](querying-data-with-the-sqldatasource-control-cs/_static/image16.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image15.gif)</span></span>

<span data-ttu-id="31af6-216">**Obrázek 11**: prvek GridView zobrazuje jednotlivé produkty `ProductID`, `ProductName`a `UnitPrice` hodnoty ([kliknutím zobrazíte obrázek v plné velikosti).](querying-data-with-the-sqldatasource-control-cs/_static/image17.gif)</span><span class="sxs-lookup"><span data-stu-id="31af6-216">**Figure 11**: The GridView Displays Each Product s `ProductID`, `ProductName`, and `UnitPrice` Values ([Click to view full-size image](querying-data-with-the-sqldatasource-control-cs/_static/image17.gif))</span></span>

<span data-ttu-id="31af6-217">Když je stránka navštívena, prvek GridView Vyvolá svou metodu správy zdrojů dat s `Select()`.</span><span class="sxs-lookup"><span data-stu-id="31af6-217">When the page is visited the GridView invokes its data source control s `Select()` method.</span></span> <span data-ttu-id="31af6-218">Když jsme používali ovládací prvek ObjectDataSource, tato metoda se nazývá `ProductsBLL` třídy s `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="31af6-218">When we were using the ObjectDataSource control, this called the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="31af6-219">Ve třídě SqlDataSource však metoda `Select()` naváže připojení k zadané databázi a vydá `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, v tomto příkladu).</span><span class="sxs-lookup"><span data-stu-id="31af6-219">With the SqlDataSource, however, the `Select()` method establishes a connection to the specified database and issues the `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, in this example).</span></span> <span data-ttu-id="31af6-220">Třída SqlDataSource vrátí svůj výsledek, který prvek GridView vytvoří, a vytvoří řádek v prvku GridView pro každý vrácený záznam databáze.</span><span class="sxs-lookup"><span data-stu-id="31af6-220">The SqlDataSource returns its results which the GridView then enumerates, creating a row in the GridView for each database record returned.</span></span>

## <a name="the-built-in-data-web-control-features-and-the-sqldatasource-control"></a><span data-ttu-id="31af6-221">Vestavěné funkce webového ovládacího prvku a ovládací prvek SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="31af6-221">The Built-In Data Web Control Features and the SqlDataSource Control</span></span>

<span data-ttu-id="31af6-222">Obecně platí, že funkce, které jsou součástí ovládacího prvku data web Controls stránkování, řazení, úpravy, odstranění, vložení a tak dále, jsou specifické pro webový ovládací prvek dat a nejsou závislé na použitém ovládacím prvku zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-222">In general, the features inherent to the data Web controls paging, sorting, editing, deleting, inserting, and so on are specific to the data Web control and are not dependent on the data source control used.</span></span> <span data-ttu-id="31af6-223">To znamená, že GridView může využít integrované stránkování, řazení, úpravy a odstranění, zda je svázána s prvkem ObjectDataSource nebo SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="31af6-223">That is, the GridView can utilize its built-in paging, sorting, editing, and deleting whether it is bound to an ObjectDataSource or a SqlDataSource.</span></span> <span data-ttu-id="31af6-224">Některé funkce webového ovládacího prvku jsou však citlivé na používané ovládací prvky zdroje dat nebo na konfiguraci správy zdrojů dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-224">However, certain data Web control features are sensitive to the data source control being used or to the data source control s configuration.</span></span>

<span data-ttu-id="31af6-225">Například v kurzu [efektivního stránkování po velkých objemech dat](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) jsme probrali, jak ve výchozím nastavení logika stránkování pro datové ovládací prvky data naively vrátí *všechny* záznamy z podkladového zdroje dat a potom zobrazí jenom příslušnou podmnožinu záznamů, která má daný index stránky, a počet záznamů, které se mají zobrazit na stránce.</span><span class="sxs-lookup"><span data-stu-id="31af6-225">For example, in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) tutorial we discussed how, by default, the paging logic for the data Web controls naively returns *all* records from the underlying data source and then displays only the appropriate subset of records given the current page index and the number of records to display per page.</span></span> <span data-ttu-id="31af6-226">Tento model je vysoce neefektivní při stránkování prostřednictvím dostatečně velkých sad výsledků.</span><span class="sxs-lookup"><span data-stu-id="31af6-226">This model is highly inefficient when paging through sufficiently large result sets.</span></span> <span data-ttu-id="31af6-227">Prvek ObjectDataSource je možné nakonfigurovat tak, aby podporoval vlastní stránkování, které vrací pouze přesné podmnožiny záznamů, které se mají zobrazit.</span><span class="sxs-lookup"><span data-stu-id="31af6-227">Fortunately, the ObjectDataSource can be configured to support custom paging, which returns only the precise subset of records to display.</span></span> <span data-ttu-id="31af6-228">Ovládací prvek SqlDataSource ale nemá vlastnosti pro implementaci vlastního stránkování.</span><span class="sxs-lookup"><span data-stu-id="31af6-228">The SqlDataSource control, however, lacks the properties for implementing custom paging.</span></span>

<span data-ttu-id="31af6-229">Další Subtlety se stránkováním a řazením se projeví na třídě SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="31af6-229">Another subtlety with paging and sorting arises with the SqlDataSource.</span></span> <span data-ttu-id="31af6-230">Ve výchozím nastavení mohou být data vrácená ze sady SqlDataSource stránkovaná nebo seřazena prostřednictvím prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="31af6-230">By default, the data returned from a SqlDataSource can be paged or sorted through the GridView.</span></span> <span data-ttu-id="31af6-231">To provedete tak, že zaškrtnete možnosti Povolit stránkování a Povolit řazení v inteligentní značce GridView s v `Querying.aspx` a ověříte, že funguje podle očekávání.</span><span class="sxs-lookup"><span data-stu-id="31af6-231">To demonstrate this, check the Enable Paging and Enable Sorting options in the GridView s smart tag in `Querying.aspx` and verify that this works as expected.</span></span>

<span data-ttu-id="31af6-232">Řazení a stránkování funguje, protože třída SqlDataSource načítá databázová data do volně typované datové sady.</span><span class="sxs-lookup"><span data-stu-id="31af6-232">Sorting and paging works because the SqlDataSource retrieves the database data into a loosely-typed DataSet.</span></span> <span data-ttu-id="31af6-233">Celkový počet záznamů vrácených dotazem: základní aspekt implementace stránkování lze zjistit z datové sady.</span><span class="sxs-lookup"><span data-stu-id="31af6-233">The total number of records returned by the query an essential aspect to implementing paging can be ascertained from the DataSet.</span></span> <span data-ttu-id="31af6-234">Kromě toho je možné výsledky datové sady seřadit pomocí objektu DataView.</span><span class="sxs-lookup"><span data-stu-id="31af6-234">Additionally, the DataSet s results can be sorted through a DataView.</span></span> <span data-ttu-id="31af6-235">Tyto možnosti jsou automaticky používány třídou SqlDataSource při žádosti GridView na stránkovaná nebo seřazená data.</span><span class="sxs-lookup"><span data-stu-id="31af6-235">These capabilities are automatically used by the SqlDataSource when the GridView requests paged or sorted data.</span></span>

<span data-ttu-id="31af6-236">Třída SqlDataSource může být nakonfigurována tak, aby vracela objekt DataReader, a ne datovou sadu změnou jeho [`DataSourceMode` vlastností](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) z `DataSet` (výchozí) na `DataReader`.</span><span class="sxs-lookup"><span data-stu-id="31af6-236">The SqlDataSource can be configured to return a DataReader instead of a DataSet by changing its [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) from `DataSet` (the default) to `DataReader`.</span></span> <span data-ttu-id="31af6-237">Použití objektu DataReader může být upřednostňováno v situacích při předávání výsledků z objektu SqlDataSource s existujícímu kódu, který očekává objekt DataReader.</span><span class="sxs-lookup"><span data-stu-id="31af6-237">Using a DataReader might be preferred in situations when passing the SqlDataSource s results to existing code that expects a DataReader.</span></span> <span data-ttu-id="31af6-238">Vzhledem k tomu, že datačtecí objekty výrazně zjednodušují objekty než datové sady, nabízejí lepší výkon.</span><span class="sxs-lookup"><span data-stu-id="31af6-238">Furthermore, since DataReaders are considerably simpler objects than DataSets, they offer better performance.</span></span> <span data-ttu-id="31af6-239">Pokud tuto změnu provedete, webové ovládací prvky dat ale nemusí ani seřadit ani stránku, protože třída SqlDataSource nemůže zjistit, kolik záznamů je vráceno dotazem, ani DataReader nenabízí žádné techniky pro řazení vrácených dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-239">If you make this change, however, the data Web control can neither sort nor page since the SqlDataSource cannot ascertain how many records are returned by the query, nor does the DataReader offer any techniques for sorting the returned data.</span></span>

## <a name="step-4-using-a-custom-sql-statement-or-stored-procedure"></a><span data-ttu-id="31af6-240">Krok 4: použití vlastního příkazu SQL nebo uložené procedury</span><span class="sxs-lookup"><span data-stu-id="31af6-240">Step 4: Using a Custom SQL Statement or Stored Procedure</span></span>

<span data-ttu-id="31af6-241">Při konfiguraci ovládacího prvku SqlDataSource lze dotaz, který se použije k vrácení dat, zadat v jednom ze dvou přístupů jako na vlastní příkaz SQL nebo uloženou proceduru nebo jako sloupce z existující tabulky nebo zobrazení.</span><span class="sxs-lookup"><span data-stu-id="31af6-241">When configuring the SqlDataSource control, the query used to return data can be specified in one of two approaches as a custom SQL statement or stored procedure, or as columns from an existing table or view.</span></span> <span data-ttu-id="31af6-242">V kroku 2 jsme prozkoumali výběr sloupců z `Products` tabulky.</span><span class="sxs-lookup"><span data-stu-id="31af6-242">In Step 2 we examined selecting columns from the `Products` table.</span></span> <span data-ttu-id="31af6-243">Pojďme se podívat na použití vlastního příkazu SQL.</span><span class="sxs-lookup"><span data-stu-id="31af6-243">Let s look at using a custom SQL statement.</span></span>

<span data-ttu-id="31af6-244">Přidejte další ovládací prvek GridView na stránku `Querying.aspx` a vyberte možnost vytvořit nový zdroj dat z rozevíracího seznamu v inteligentní značce.</span><span class="sxs-lookup"><span data-stu-id="31af6-244">Add another GridView control to the `Querying.aspx` page and choose to create a new data source from the drop-down list in the smart tag.</span></span> <span data-ttu-id="31af6-245">Dále určete, že data budou načítána z databáze. tím se vytvoří nový ovládací prvek SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="31af6-245">Next, indicate that the data will be pulled from a database this will create a new SqlDataSource control.</span></span> <span data-ttu-id="31af6-246">Pojmenujte `ProductsWithCategoryInfoDataSource`ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="31af6-246">Name the control `ProductsWithCategoryInfoDataSource`.</span></span>

![Vytvořit nový ovládací prvek SqlDataSource s názvem ProductsWithCategoryInfoDataSource](querying-data-with-the-sqldatasource-control-cs/_static/image18.gif)

<span data-ttu-id="31af6-248">**Obrázek 12**: vytvoření nového ovládacího prvku SqlDataSource s názvem `ProductsWithCategoryInfoDataSource`</span><span class="sxs-lookup"><span data-stu-id="31af6-248">**Figure 12**: Create a New SqlDataSource Control Named `ProductsWithCategoryInfoDataSource`</span></span>

<span data-ttu-id="31af6-249">Na další obrazovce se zobrazí výzva k zadání databáze.</span><span class="sxs-lookup"><span data-stu-id="31af6-249">The next screen asks us to specify the database.</span></span> <span data-ttu-id="31af6-250">Stejně jako na obrázku 7 jsme v rozevíracím seznamu vybrali `NORTHWINDConnectionString` a kliknete na další.</span><span class="sxs-lookup"><span data-stu-id="31af6-250">As we did back in Figure 7, select the `NORTHWINDConnectionString` from the drop-down list and click Next.</span></span> <span data-ttu-id="31af6-251">Na obrazovce konfigurace příkazu SELECT zvolte přepínač zadat vlastní příkaz SQL nebo uložený postup a klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="31af6-251">In the Configure the Select Statement screen, choose the Specify a custom SQL statement or stored procedure radio button and click Next.</span></span> <span data-ttu-id="31af6-252">Tím se zobrazí obrazovka definovat vlastní příkazy nebo uložené procedury, která nabízí karty označené jako SELECT, UPDATE, INSERT a DELETE.</span><span class="sxs-lookup"><span data-stu-id="31af6-252">This will bring up the Define Custom Statements or Stored Procedures screen, which offers tabs labeled SELECT, UPDATE, INSERT, and DELETE.</span></span> <span data-ttu-id="31af6-253">Na každé kartě můžete zadat vlastní příkaz SQL do textového pole nebo zvolit uloženou proceduru z rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="31af6-253">In each tab you can enter a custom SQL statement into the textbox or choose a stored procedure from the drop-down list.</span></span> <span data-ttu-id="31af6-254">V tomto kurzu se podíváme na zadání vlastního příkazu SQL. Další kurz obsahuje příklad, který používá uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="31af6-254">In this tutorial we will look at entering a custom SQL statement; the next tutorial includes an example that uses a stored procedure.</span></span>

![Zadejte vlastní příkaz SQL nebo vyberte uloženou proceduru.](querying-data-with-the-sqldatasource-control-cs/_static/image19.gif)

<span data-ttu-id="31af6-256">**Obrázek 13**: zadejte vlastní příkaz SQL nebo vyberte uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="31af6-256">**Figure 13**: Enter a Custom SQL Statement or Pick a Stored Procedure</span></span>

<span data-ttu-id="31af6-257">Vlastní příkaz SQL lze zadat ručně do textového pole nebo lze vytvořit graficky kliknutím na tlačítko Tvůrce dotazů.</span><span class="sxs-lookup"><span data-stu-id="31af6-257">The custom SQL statement can be entered by hand into the textbox or can be constructed graphically by clicking the Query Builder button.</span></span> <span data-ttu-id="31af6-258">Z Tvůrce dotazů nebo textového pole použijte následující dotaz k vrácení polí `ProductID` a `ProductName` z tabulky `Products` pomocí `JOIN` k načtení `CategoryName` produktů z `Categories` tabulky:</span><span class="sxs-lookup"><span data-stu-id="31af6-258">From either the Query Builder or the textbox, use the following query to return the `ProductID` and `ProductName` fields from the `Products` table using a `JOIN` to retrieve the product s `CategoryName` from the `Categories` table:</span></span>

[!code-sql[Main](querying-data-with-the-sqldatasource-control-cs/samples/sample4.sql)]

![Dotaz můžete graficky sestavit pomocí Tvůrce dotazů](querying-data-with-the-sqldatasource-control-cs/_static/image20.gif)

<span data-ttu-id="31af6-260">**Obrázek 14**: dotaz můžete graficky sestavit pomocí Tvůrce dotazů</span><span class="sxs-lookup"><span data-stu-id="31af6-260">**Figure 14**: You can Graphically Construct the Query Using the Query Builder</span></span>

<span data-ttu-id="31af6-261">Po zadání dotazu klikněte na tlačítko Další a pokračujte na obrazovku test Query.</span><span class="sxs-lookup"><span data-stu-id="31af6-261">After specifying the query, click Next to proceed to the Test Query screen.</span></span> <span data-ttu-id="31af6-262">Kliknutím na Dokončit dokončete Průvodce SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="31af6-262">Click Finish to complete the SqlDataSource wizard.</span></span>

<span data-ttu-id="31af6-263">Po dokončení průvodce bude do prvku GridView přidána tři BoundFieldsy, které zobrazují sloupce `ProductID`, `ProductName`a `CategoryName`, které byly vráceny z dotazu a výsledkem je následující deklarativní označení:</span><span class="sxs-lookup"><span data-stu-id="31af6-263">After completing the wizard, the GridView will have three BoundFields added to it displaying the `ProductID`, `ProductName`, and `CategoryName` columns returned from the query and resulting in the following declarative markup:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-cs/samples/sample5.aspx)]

<span data-ttu-id="31af6-264">[![se v prvku GridView zobrazuje každé ID produktu, název a přiřazená kategorie s názvem.](querying-data-with-the-sqldatasource-control-cs/_static/image22.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image21.gif)</span><span class="sxs-lookup"><span data-stu-id="31af6-264">[![The GridView Shows Each Product s ID, Name, and Associated Category Name](querying-data-with-the-sqldatasource-control-cs/_static/image22.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image21.gif)</span></span>

<span data-ttu-id="31af6-265">**Obrázek 15**: prvek GridView zobrazuje každé ID produktu, název a přiřazený název kategorie ([kliknutím zobrazíte obrázek v plné velikosti).](querying-data-with-the-sqldatasource-control-cs/_static/image23.gif)</span><span class="sxs-lookup"><span data-stu-id="31af6-265">**Figure 15**: The GridView Shows Each Product s ID, Name, and Associated Category Name ([Click to view full-size image](querying-data-with-the-sqldatasource-control-cs/_static/image23.gif))</span></span>

## <a name="summary"></a><span data-ttu-id="31af6-266">Přehled</span><span class="sxs-lookup"><span data-stu-id="31af6-266">Summary</span></span>

<span data-ttu-id="31af6-267">V tomto kurzu jsme viděli, jak zadávat dotazy a zobrazovat data pomocí ovládacího prvku SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="31af6-267">In this tutorial we saw how to query and display data using the SqlDataSource control.</span></span> <span data-ttu-id="31af6-268">Podobně jako prvek ObjectDataSource, třída SqlDataSource slouží jako proxy a poskytuje deklarativní přístup pro přístup k datům.</span><span class="sxs-lookup"><span data-stu-id="31af6-268">Like the ObjectDataSource, the SqlDataSource serves as a proxy, providing a declarative approach to accessing data.</span></span> <span data-ttu-id="31af6-269">Jeho vlastnosti určují databázi, ke které se má připojit, a dotaz SQL `SELECT`, který se má provést. dá se zadat pomocí okno Vlastnosti nebo pomocí Průvodce konfigurací zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="31af6-269">Its properties specify the database to connect to and the SQL `SELECT` query to execute; they can be specified through the Properties window or by using the Configure DataSource wizard.</span></span>

<span data-ttu-id="31af6-270">Příklady dotazů `SELECT`, které jsme prozkoumali v tomto kurzu, vrátily všechny záznamy ze zadaného dotazu.</span><span class="sxs-lookup"><span data-stu-id="31af6-270">The `SELECT` query examples we examined in this tutorial returned all of the records from the specified query.</span></span> <span data-ttu-id="31af6-271">Ovládací prvek SqlDataSource však může obsahovat klauzuli `WHERE` s parametry, jejichž hodnoty jsou přiřazeny programově nebo automaticky načteny ze zadaného zdroje.</span><span class="sxs-lookup"><span data-stu-id="31af6-271">The SqlDataSource control, however, can include a `WHERE` clause with parameters whose values are assigned programmatically or are automatically pulled from a specified source.</span></span> <span data-ttu-id="31af6-272">Podíváme se, jak vytvořit a používat parametrizované dotazy v dalším kurzu.</span><span class="sxs-lookup"><span data-stu-id="31af6-272">We'll examine how to create and use parameterized queries in the next tutorial!</span></span>

<span data-ttu-id="31af6-273">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="31af6-273">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="31af6-274">Další čtení</span><span class="sxs-lookup"><span data-stu-id="31af6-274">Further Reading</span></span>

<span data-ttu-id="31af6-275">Další informace o tématech popsaných v tomto kurzu najdete v následujících zdrojích informací:</span><span class="sxs-lookup"><span data-stu-id="31af6-275">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="31af6-276">Přístup k datům relační databáze</span><span class="sxs-lookup"><span data-stu-id="31af6-276">Accessing Relational Database Data</span></span>](http://aspnet.4guysfromrolla.com/articles/022206-1.aspx)
- [<span data-ttu-id="31af6-277">SqlDataSource – Přehled ovládacího prvku</span><span class="sxs-lookup"><span data-stu-id="31af6-277">SqlDataSource Control Overview</span></span>](https://msdn.microsoft.com/library/dz12d98w.aspx)
- [<span data-ttu-id="31af6-278">Kurzy rychlý Start ASP.NET: ovládací prvek SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="31af6-278">ASP.NET Quickstart Tutorials: The SqlDataSource Control</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/sqldatasource.aspx)
- [<span data-ttu-id="31af6-279">`<connectionStrings>` element Web. config</span><span class="sxs-lookup"><span data-stu-id="31af6-279">The Web.config `<connectionStrings>` Element</span></span>](https://msdn.microsoft.com/library/bf7sd233.aspx)
- [<span data-ttu-id="31af6-280">Odkaz na připojovací řetězec databáze</span><span class="sxs-lookup"><span data-stu-id="31af6-280">Database Connection String Reference</span></span>](http://www.connectionstrings.com/)

## <a name="about-the-author"></a><span data-ttu-id="31af6-281">O autorovi</span><span class="sxs-lookup"><span data-stu-id="31af6-281">About the Author</span></span>

<span data-ttu-id="31af6-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor 7 ASP/ASP. NET Books a zakladatel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="31af6-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="31af6-283">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="31af6-283">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="31af6-284">Nejnovější kniha je [*Sams naučit se ASP.NET 2,0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="31af6-284">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="31af6-285">Dá se získat na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="31af6-285">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="31af6-286">nebo prostřednictvím svého blogu, který najdete na adrese [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="31af6-286">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="31af6-287">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="31af6-287">Special Thanks To</span></span>

<span data-ttu-id="31af6-288">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="31af6-288">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="31af6-289">Kontroloři vedoucích k tomuto kurzu byli Zuzana Connery, Bernadette Leigh a David Suru.</span><span class="sxs-lookup"><span data-stu-id="31af6-289">Lead reviewers for this tutorial were Susan Connery, Bernadette Leigh, and David Suru.</span></span> <span data-ttu-id="31af6-290">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="31af6-290">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="31af6-291">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="31af6-291">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="31af6-292">Next</span><span class="sxs-lookup"><span data-stu-id="31af6-292">Next</span></span>](using-parameterized-queries-with-the-sqldatasource-cs.md)
