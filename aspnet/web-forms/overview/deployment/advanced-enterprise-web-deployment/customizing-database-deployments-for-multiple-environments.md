---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments
title: Přizpůsobení nasazení databáze pro více prostředí | Microsoft Docs
author: jrjlee
description: 'Toto téma popisuje, jak přizpůsobit vlastnosti databáze na konkrétní cílová prostředí v rámci procesu nasazení. Poznámka: téma předpokládá, že je to th...'
ms.author: riande
ms.date: 05/04/2012
ms.assetid: a172979a-1318-4318-a9c6-4f9560d26267
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments
msc.type: authoredcontent
ms.openlocfilehash: 8ae8cb1a322afb95c5d2e8d5e73c7825c7b2fe5a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78604025"
---
# <a name="customizing-database-deployments-for-multiple-environments"></a><span data-ttu-id="0e5ef-104">Přizpůsobení nasazené databáze pro různá prostředí</span><span class="sxs-lookup"><span data-stu-id="0e5ef-104">Customizing Database Deployments for Multiple Environments</span></span>

<span data-ttu-id="0e5ef-105">od [Jason Novák](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="0e5ef-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="0e5ef-106">Stáhnout PDF</span><span class="sxs-lookup"><span data-stu-id="0e5ef-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="0e5ef-107">Toto téma popisuje, jak přizpůsobit vlastnosti databáze na konkrétní cílová prostředí v rámci procesu nasazení.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-107">This topic describes how to tailor the properties of a database to specific target environments as part of the deployment process.</span></span>
> 
> > [!NOTE]
> > <span data-ttu-id="0e5ef-108">Téma předpokládá, že nasazujete databázový projekt sady Visual Studio 2010 pomocí nástroje MSBuild. exe a VSDBCMD. exe.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-108">The topic assumes that you're deploying a Visual Studio 2010 database project using MSBuild.exe and VSDBCMD.exe.</span></span> <span data-ttu-id="0e5ef-109">Další informace o tom, proč můžete zvolit tento přístup, najdete v tématu [nasazení webu v podniku](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md) a [nasazení databázových projektů](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span><span class="sxs-lookup"><span data-stu-id="0e5ef-109">For more information on why you might choose this approach, see [Web Deployment in the Enterprise](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md) and [Deploying Database Projects](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span></span>
> 
> 
> <span data-ttu-id="0e5ef-110">Když nasadíte databázový projekt do více cílů, často budete chtít přizpůsobit vlastnosti nasazení databáze pro každé cílové prostředí.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-110">When you deploy a database project to multiple destinations, you'll often want to customize the database deployment properties for each target environment.</span></span> <span data-ttu-id="0e5ef-111">Například v testovacích prostředích byste při každém nasazení obvykle znovu vytvořili databázi, zatímco v pracovních nebo produkčních prostředích byste měli větší mnohem více pravděpodobných přírůstkových aktualizací, abyste zachovali data.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-111">For example, in test environments you'd typically recreate the database on every deployment, whereas in staging or production environments you'd be a lot more likely to make incremental updates to preserve your data.</span></span>
> 
> <span data-ttu-id="0e5ef-112">V projektu databáze sady Visual Studio 2010 jsou nastavení nasazení obsažena v rámci konfiguračního souboru nasazení (. SqlDeployment).</span><span class="sxs-lookup"><span data-stu-id="0e5ef-112">In a Visual Studio 2010 database project, deployment settings are contained within a deployment configuration (.sqldeployment) file.</span></span> <span data-ttu-id="0e5ef-113">V tomto tématu se dozvíte, jak vytvořit soubory konfigurace nasazení specifické pro konkrétní prostředí a zadat tu, kterou chcete použít jako parametr VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-113">This topic will show you how to create environment-specific deployment configuration files and specify the one you want to use as a VSDBCMD parameter.</span></span>

<span data-ttu-id="0e5ef-114">Toto téma je součástí série kurzů založených na požadavcích podnikového nasazení fiktivní společnosti s názvem Fabrikam, Inc. Tato série kurzů používá ukázkové řešení&#x2014;, pomocí kterého [řešení](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;správce kontaktů představuje webovou aplikaci s realistickou úrovní složitosti, včetně aplikace ASP.NET MVC 3, služby Windows Communication Foundation (WCF) a databázového projektu.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-114">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="0e5ef-115">Metoda nasazení na srdce těchto kurzů je založena na způsobu rozdělení souborů projektu popsaných v tématu [Principy souboru projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md), ve kterém je proces sestavení řízen dvěma soubory&#x2014;projektu jeden, který obsahuje pokyny pro sestavení, které platí pro každé cílové prostředí, a jedno obsahující nastavení sestavení a nasazení specifické pro konkrétní prostředí.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-115">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="0e5ef-116">V době sestavení je soubor projektu specifický pro prostředí sloučen do souboru projektu prostředí – nezávislá a vytvoří kompletní sadu instrukcí pro sestavení.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-116">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="0e5ef-117">Přehled úlohy</span><span class="sxs-lookup"><span data-stu-id="0e5ef-117">Task Overview</span></span>

<span data-ttu-id="0e5ef-118">V tomto tématu se předpokládá, že:</span><span class="sxs-lookup"><span data-stu-id="0e5ef-118">This topic assumes that:</span></span>

- <span data-ttu-id="0e5ef-119">Použijete přístup k rozdělenému souboru projektu k nasazení řešení, jak je popsáno v tématu [Principy souboru projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span><span class="sxs-lookup"><span data-stu-id="0e5ef-119">You use the split project file approach to solution deployment, as described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span></span>
- <span data-ttu-id="0e5ef-120">Zavoláte VSDBCMD ze souboru projektu pro nasazení databázového projektu, jak je popsáno v tématu [Principy procesu sestavení](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="0e5ef-120">You call VSDBCMD from the project file to deploy your database project, as described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>

<span data-ttu-id="0e5ef-121">Pokud chcete vytvořit systém nasazení, který podporuje různé vlastnosti nasazení databáze mezi cílovými prostředími, budete muset:</span><span class="sxs-lookup"><span data-stu-id="0e5ef-121">To create a deployment system that supports varying the database deployment properties between target environments, you'll need to:</span></span>

- <span data-ttu-id="0e5ef-122">Vytvořte soubor konfigurace nasazení (. SqlDeployment) pro každé cílové prostředí.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-122">Create a deployment configuration (.sqldeployment) file for each target environment.</span></span>
- <span data-ttu-id="0e5ef-123">Vytvořte příkaz VSDBCMD, který určuje konfigurační soubor nasazení jako přepínač příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-123">Create a VSDBCMD command that specifies the deployment configuration file as a command-line switch.</span></span>
- <span data-ttu-id="0e5ef-124">Parametrizovat příkaz VSDBCMD v souboru projektu Microsoft Build Engine (MSBuild), aby VSDBCMD možnosti byly vhodné pro cílové prostředí.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-124">Parameterize the VSDBCMD command in a Microsoft Build Engine (MSBuild) project file, so that the VSDBCMD options are appropriate to the target environment.</span></span>

<span data-ttu-id="0e5ef-125">V tomto tématu se dozvíte, jak provádět jednotlivé postupy.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-125">This topic will show you how to perform each of these procedures.</span></span>

## <a name="creating-environment-specific-deployment-configuration-files"></a><span data-ttu-id="0e5ef-126">Vytváření konfiguračních souborů nasazení specifických pro konkrétní prostředí</span><span class="sxs-lookup"><span data-stu-id="0e5ef-126">Creating Environment-Specific Deployment Configuration Files</span></span>

<span data-ttu-id="0e5ef-127">Ve výchozím nastavení databázový projekt obsahuje jeden konfigurační soubor nasazení s názvem *Database. SqlDeployment*.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-127">By default, a database project contains a single deployment configuration file named *Database.sqldeployment*.</span></span> <span data-ttu-id="0e5ef-128">Pokud tento soubor otevřete v aplikaci Visual Studio 2010, můžete zobrazit různé možnosti nasazení, které máte k dispozici:</span><span class="sxs-lookup"><span data-stu-id="0e5ef-128">If you open this file in Visual Studio 2010, you can see the different deployment options that are available to you:</span></span>

- <span data-ttu-id="0e5ef-129">**Kolace porovnání nasazení**</span><span class="sxs-lookup"><span data-stu-id="0e5ef-129">**Deployment comparison collation**.</span></span> <span data-ttu-id="0e5ef-130">To vám umožní vybrat, jestli se má použít kolace databáze vašeho projektu ( *zdrojová* kolace) nebo kolace databáze cílového serveru ( *cílová* kolace).</span><span class="sxs-lookup"><span data-stu-id="0e5ef-130">This lets you choose whether to use the database collation of your project (the *source* collation) or the database collation of your destination server (the *target* collation).</span></span> <span data-ttu-id="0e5ef-131">Ve většině případů budete chtít použít zdrojovou kolaci při nasazení do vývojového nebo testovacího prostředí.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-131">In most cases, you'll want to use the source collation when you deploy to a development or test environment.</span></span> <span data-ttu-id="0e5ef-132">Při nasazení do pracovního nebo produkčního prostředí obvykle budete chtít opustit cílovou kolaci beze změny, abyste se vyhnuli problémům s interoperabilitou.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-132">When you deploy to a staging or production environment, you'll usually want to leave the target collation unchanged to avoid any interoperability issues.</span></span>
- <span data-ttu-id="0e5ef-133">**Nasaďte vlastnosti databáze**.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-133">**Deploy database properties**.</span></span> <span data-ttu-id="0e5ef-134">To vám umožní vybrat, jestli se mají použít vlastnosti databáze, jak jsou definované v souboru *Database. sqlsettings* .</span><span class="sxs-lookup"><span data-stu-id="0e5ef-134">This lets you choose whether to apply the database properties, as defined in the *Database.sqlsettings* file.</span></span> <span data-ttu-id="0e5ef-135">Při prvním nasazení databáze byste měli nasadit vlastnosti databáze.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-135">When you deploy a database for the first time, you should deploy the database properties.</span></span> <span data-ttu-id="0e5ef-136">Pokud aktualizujete existující databázi, vlastnosti by již měly být na místě a nemuseli byste je znovu nasazovat.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-136">If you're updating an existing database, the properties should already be in place, and you shouldn't need to deploy them again.</span></span>
- <span data-ttu-id="0e5ef-137">**Vždy znovu vytvořit databázi**.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-137">**Always re-create database**.</span></span> <span data-ttu-id="0e5ef-138">To vám umožní vybrat, jestli se má znovu vytvořit cílová databáze pokaždé, když nasadíte nebo provedete přírůstkové změny, aby se cílová databáze zajistila v aktuálním stavu pomocí schématu.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-138">This lets you choose whether to re-create the target database every time you deploy or make incremental changes to bring the target database up to date with your schema.</span></span> <span data-ttu-id="0e5ef-139">Pokud databázi znovu vytvoříte, ztratíte všechna data ve stávající databázi.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-139">If you re-create the database, you'll lose any data in the existing database.</span></span> <span data-ttu-id="0e5ef-140">V takovém případě byste je měli obvykle nastavit na **hodnotu false** pro nasazení do pracovních nebo produkčních prostředí.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-140">As such, you should usually set this to **false** for deployments to staging or production environments.</span></span>
- <span data-ttu-id="0e5ef-141">**Zablokuje přírůstkové nasazení, pokud může dojít ke ztrátě dat**.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-141">**Block incremental deployment if data loss might occur**.</span></span> <span data-ttu-id="0e5ef-142">To vám umožní vybrat, jestli se má nasazení zastavit, pokud Změna schématu databáze způsobí ztrátu dat.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-142">This lets you choose whether deployment should stop if a change to the database schema will cause the loss of data.</span></span> <span data-ttu-id="0e5ef-143">Pro nasazení do produkčního prostředí je obvykle nastavena **hodnota true** , abyste měli možnost zasáhnout a chránit veškerá důležitá data.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-143">You typically set this to **true** for a deployment to a production environment, to give you the opportunity to intervene and protect any important data.</span></span> <span data-ttu-id="0e5ef-144">Pokud jste nastavili možnost **vždy znovu vytvořit databázi** na **hodnotu NEPRAVDA**, toto nastavení nebude mít žádný vliv.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-144">If you have set **Always re-create database** to **false**, this setting will have no effect.</span></span>
- <span data-ttu-id="0e5ef-145">**Spustit nasazení v režimu jednoho uživatele**.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-145">**Execute deployment in single-user mode**.</span></span> <span data-ttu-id="0e5ef-146">To obvykle není problém ve vývojových nebo testovacích prostředích.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-146">This is not usually an issue in development or test environments.</span></span> <span data-ttu-id="0e5ef-147">Nicméně tuto hodnotu nastavte na **true** pro nasazení do pracovních nebo produkčních prostředí.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-147">However, you should typically set this to **true** for deployments to staging or production environments.</span></span> <span data-ttu-id="0e5ef-148">To uživatelům brání v provádění změn v databázi během probíhajícího nasazení.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-148">This prevents users from making changes to the database while the deployment is underway.</span></span>
- <span data-ttu-id="0e5ef-149">**Před nasazením zálohujte databázi**.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-149">**Back up database before deployment**.</span></span> <span data-ttu-id="0e5ef-150">Toto nastavení je obvykle nastaveno na **hodnotu true** při nasazení do provozního prostředí, jako preventivní opatření před ztrátou dat.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-150">You typically set this to **true** when you deploy to a production environment, as a precaution against data loss.</span></span> <span data-ttu-id="0e5ef-151">Můžete ji také nastavit na **hodnotu true** při nasazení do přípravného prostředí, pokud vaše pracovní databáze obsahuje velké množství dat.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-151">You may also want to set it to **true** when you deploy to a staging environment, if your staging database contains a lot of data.</span></span>
- <span data-ttu-id="0e5ef-152">**Generujte příkazy drop pro objekty, které jsou v cílové databázi, ale které nejsou v projektu databáze**.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-152">**Generate DROP statements for objects that are in the target database but that are not in the database project**.</span></span> <span data-ttu-id="0e5ef-153">Ve většině případů jde o nedílnou a podstatnou součást provádění přírůstkových změn v databázi.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-153">In most cases, this is an integral and essential part of making incremental changes to a database.</span></span> <span data-ttu-id="0e5ef-154">Pokud jste nastavili možnost **vždy znovu vytvořit databázi** na **hodnotu NEPRAVDA**, toto nastavení nebude mít žádný vliv.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-154">If you have set **Always re-create database** to **false**, this setting will have no effect.</span></span>
- <span data-ttu-id="0e5ef-155">**Nepoužívejte příkazy ALTER ASSEMBLY k aktualizaci typů CLR**.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-155">**Do not use ALTER ASSEMBLY statements to update CLR types**.</span></span> <span data-ttu-id="0e5ef-156">Toto nastavení určuje, jak má SQL Server aktualizovat typy modulu CLR (Common Language Runtime) na novější verze sestavení.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-156">This setting determines how SQL Server should update common language runtime (CLR) types to newer assembly versions.</span></span> <span data-ttu-id="0e5ef-157">Ve většině scénářů by měl být nastaven na **hodnotu false** .</span><span class="sxs-lookup"><span data-stu-id="0e5ef-157">This should be set to **false** in most scenarios.</span></span>

<span data-ttu-id="0e5ef-158">V této tabulce jsou uvedena typická nastavení nasazení pro různá cílová prostředí.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-158">This table shows typical deployment settings for different destination environments.</span></span> <span data-ttu-id="0e5ef-159">Nastavení se ale může lišit v závislosti na vašich přesných požadavcích.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-159">However, your settings may be different depending on your exact requirements.</span></span>

|  | <span data-ttu-id="0e5ef-160">Vývojář a testování</span><span class="sxs-lookup"><span data-stu-id="0e5ef-160">Developer/Test</span></span> | <span data-ttu-id="0e5ef-161">Příprava/integrace</span><span class="sxs-lookup"><span data-stu-id="0e5ef-161">Staging/Integration</span></span> | <span data-ttu-id="0e5ef-162">Výroba</span><span class="sxs-lookup"><span data-stu-id="0e5ef-162">Production</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="0e5ef-163">**Kolace porovnání nasazení**</span><span class="sxs-lookup"><span data-stu-id="0e5ef-163">**Deployment comparison collation**</span></span> | <span data-ttu-id="0e5ef-164">Zdroj</span><span class="sxs-lookup"><span data-stu-id="0e5ef-164">Source</span></span> | <span data-ttu-id="0e5ef-165">Cíl</span><span class="sxs-lookup"><span data-stu-id="0e5ef-165">Target</span></span> | <span data-ttu-id="0e5ef-166">Cíl</span><span class="sxs-lookup"><span data-stu-id="0e5ef-166">Target</span></span> |
| <span data-ttu-id="0e5ef-167">**Nasadit vlastnosti databáze**</span><span class="sxs-lookup"><span data-stu-id="0e5ef-167">**Deploy database properties**</span></span> | <span data-ttu-id="0e5ef-168">True</span><span class="sxs-lookup"><span data-stu-id="0e5ef-168">True</span></span> | <span data-ttu-id="0e5ef-169">Pouze poprvé</span><span class="sxs-lookup"><span data-stu-id="0e5ef-169">First time only</span></span> | <span data-ttu-id="0e5ef-170">Pouze poprvé</span><span class="sxs-lookup"><span data-stu-id="0e5ef-170">First time only</span></span> |
| <span data-ttu-id="0e5ef-171">**Vždy znovu vytvořit databázi**</span><span class="sxs-lookup"><span data-stu-id="0e5ef-171">**Always re-create database**</span></span> | <span data-ttu-id="0e5ef-172">True</span><span class="sxs-lookup"><span data-stu-id="0e5ef-172">True</span></span> | <span data-ttu-id="0e5ef-173">False</span><span class="sxs-lookup"><span data-stu-id="0e5ef-173">False</span></span> | <span data-ttu-id="0e5ef-174">False</span><span class="sxs-lookup"><span data-stu-id="0e5ef-174">False</span></span> |
| <span data-ttu-id="0e5ef-175">**Blokovat přírůstkové nasazení, pokud může dojít ke ztrátě dat**</span><span class="sxs-lookup"><span data-stu-id="0e5ef-175">**Block incremental deployment if data loss might occur**</span></span> | <span data-ttu-id="0e5ef-176">False</span><span class="sxs-lookup"><span data-stu-id="0e5ef-176">False</span></span> | <span data-ttu-id="0e5ef-177">Možná</span><span class="sxs-lookup"><span data-stu-id="0e5ef-177">Maybe</span></span> | <span data-ttu-id="0e5ef-178">True</span><span class="sxs-lookup"><span data-stu-id="0e5ef-178">True</span></span> |
| <span data-ttu-id="0e5ef-179">**Spustit skript nasazení v režimu jednoho uživatele**</span><span class="sxs-lookup"><span data-stu-id="0e5ef-179">**Execute deployment script in single-user mode**</span></span> | <span data-ttu-id="0e5ef-180">False</span><span class="sxs-lookup"><span data-stu-id="0e5ef-180">False</span></span> | <span data-ttu-id="0e5ef-181">True</span><span class="sxs-lookup"><span data-stu-id="0e5ef-181">True</span></span> | <span data-ttu-id="0e5ef-182">True</span><span class="sxs-lookup"><span data-stu-id="0e5ef-182">True</span></span> |
| <span data-ttu-id="0e5ef-183">**Zálohování databáze před nasazením**</span><span class="sxs-lookup"><span data-stu-id="0e5ef-183">**Back up database before deployment**</span></span> | <span data-ttu-id="0e5ef-184">False</span><span class="sxs-lookup"><span data-stu-id="0e5ef-184">False</span></span> | <span data-ttu-id="0e5ef-185">Možná</span><span class="sxs-lookup"><span data-stu-id="0e5ef-185">Maybe</span></span> | <span data-ttu-id="0e5ef-186">True</span><span class="sxs-lookup"><span data-stu-id="0e5ef-186">True</span></span> |
| <span data-ttu-id="0e5ef-187">**Generovat příkazy DROP pro objekty, které jsou v cílové databázi, ale které nejsou v projektu databáze**</span><span class="sxs-lookup"><span data-stu-id="0e5ef-187">**Generate DROP statements for objects that are in the target database but that are not in the database project**</span></span> | <span data-ttu-id="0e5ef-188">False</span><span class="sxs-lookup"><span data-stu-id="0e5ef-188">False</span></span> | <span data-ttu-id="0e5ef-189">True</span><span class="sxs-lookup"><span data-stu-id="0e5ef-189">True</span></span> | <span data-ttu-id="0e5ef-190">True</span><span class="sxs-lookup"><span data-stu-id="0e5ef-190">True</span></span> |
| <span data-ttu-id="0e5ef-191">**Nepoužívejte příkazy ALTER ASSEMBLY k aktualizaci typů CLR.**</span><span class="sxs-lookup"><span data-stu-id="0e5ef-191">**Do not use ALTER ASSEMBLY statements to update CLR types**</span></span> | <span data-ttu-id="0e5ef-192">False</span><span class="sxs-lookup"><span data-stu-id="0e5ef-192">False</span></span> | <span data-ttu-id="0e5ef-193">False</span><span class="sxs-lookup"><span data-stu-id="0e5ef-193">False</span></span> | <span data-ttu-id="0e5ef-194">False</span><span class="sxs-lookup"><span data-stu-id="0e5ef-194">False</span></span> |

> [!NOTE]
> <span data-ttu-id="0e5ef-195">Další informace o vlastnostech nasazení databáze a ohledech na prostředí najdete v tématu [Přehled nastavení databázového projektu](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx), [Postupy: Konfigurace vlastností pro podrobnosti o nasazení](https://msdn.microsoft.com/library/dd172125.aspx), [sestavení a nasazení databáze do izolovaného vývojového prostředí](https://msdn.microsoft.com/library/dd193409.aspx)a [vytváření a nasazování databází do pracovního nebo produkčního prostředí](https://msdn.microsoft.com/library/dd193413.aspx).</span><span class="sxs-lookup"><span data-stu-id="0e5ef-195">For more information on database deployment properties and environment considerations, see [An Overview of Database Project Settings](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx), [How to: Configure Properties for Deployment Details](https://msdn.microsoft.com/library/dd172125.aspx), [Build and Deploy Database to an Isolated Development Environment](https://msdn.microsoft.com/library/dd193409.aspx), and [Build and Deploy Databases to a Staging or Production Environment](https://msdn.microsoft.com/library/dd193413.aspx).</span></span>

<span data-ttu-id="0e5ef-196">Pro podporu nasazení databázového projektu na více cílů byste měli vytvořit konfigurační soubor nasazení pro každé cílové prostředí.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-196">To support the deployment of a database project to multiple destinations, you should create a deployment configuration file for each target environment.</span></span>

<span data-ttu-id="0e5ef-197">**Vytvoření konfiguračního souboru specifického pro prostředí**</span><span class="sxs-lookup"><span data-stu-id="0e5ef-197">**To create an environment-specific configuration file**</span></span>

1. <span data-ttu-id="0e5ef-198">V aplikaci Visual Studio 2010 v okně **Průzkumník řešení** klikněte pravým tlačítkem na projekt databáze a pak klikněte na **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-198">In Visual Studio 2010, in the **Solution Explorer** window, right-click your database project, and then click **Properties**.</span></span>
2. <span data-ttu-id="0e5ef-199">Na stránce Vlastnosti projektu databáze na kartě **nasadit** na řádku **konfigurační soubor nasazení** klikněte na **Nový**.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-199">On the database project properties page, on the **Deploy** tab, in the **Deployment configuration file** row, click **New**.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image1.png)
3. <span data-ttu-id="0e5ef-200">V dialogovém okně **Nový konfigurační soubor nasazení** dejte souboru smysluplný název (například **TestEnvironment. SqlDeployment**) a pak klikněte na **Uložit**.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-200">In the **New Deployment Configuration File** dialog box, give the file a meaningful name (for example, **TestEnvironment.sqldeployment**), and then click **Save**.</span></span>
4. <span data-ttu-id="0e5ef-201">Na stránce *[filename] \* \* \* *. SqlDeployment** nastavte vlastnosti nasazení tak, aby odpovídaly požadavkům vašeho cílového prostředí, a pak soubor uložte.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-201">On the *[Filename]\*\*\*.sqldeployment*\* page, set the deployment properties to match the requirements of your destination environment, and then save the file.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image2.png)
5. <span data-ttu-id="0e5ef-202">Všimněte si, že nový soubor je přidán do složky Properties (vlastnosti) projektu databáze.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-202">Notice that the new file is added to the Properties folder in your database project.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image3.png)

## <a name="specifying-the-deployment-configuration-file-in-vsdbcmd"></a><span data-ttu-id="0e5ef-203">Určení konfiguračního souboru nasazení v VSDBCMD</span><span class="sxs-lookup"><span data-stu-id="0e5ef-203">Specifying the Deployment Configuration File in VSDBCMD</span></span>

<span data-ttu-id="0e5ef-204">Použijete-li konfigurace řešení (například ladění a vydání) v rámci sady Visual Studio 2010, můžete k každé konfiguraci přidružit konfigurační soubor nasazení.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-204">When you use solution configurations (like Debug and Release) within Visual Studio 2010, you can associate a deployment configuration file with each configuration.</span></span> <span data-ttu-id="0e5ef-205">Když sestavíte určitou konfiguraci, proces sestavení vygeneruje soubor manifestu nasazení specifický pro konfiguraci, který odkazuje na konfigurační soubor nasazení specifický pro konkrétní konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-205">When you build a particular configuration, the build process generates a configuration-specific deployment manifest file that points to the configuration-specific deployment configuration file.</span></span> <span data-ttu-id="0e5ef-206">Jedním z hlavních cílů přístupu k nasazení, které jsou popsány v těchto kurzech, je však poskytnout lidem možnost řídit proces nasazení bez použití sady Visual Studio 2010 a konfigurací řešení.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-206">However, one of the main aims of the approach to deployment described in these tutorials is to give people the ability to control the deployment process without using Visual Studio 2010 and solution configurations.</span></span> <span data-ttu-id="0e5ef-207">V tomto přístupu je konfigurace řešení stejná bez ohledu na cílové prostředí nasazení.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-207">In this approach, the solution configuration is the same regardless of the target deployment environment.</span></span> <span data-ttu-id="0e5ef-208">K přizpůsobení nasazení databáze na konkrétní cílové prostředí můžete použít možnosti příkazového řádku VSDBCMD k určení konfiguračního souboru nasazení.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-208">To tailor your database deployment to a specific destination environment, you can use the VSDBCMD command-line options to specify your deployment configuration file.</span></span>

<span data-ttu-id="0e5ef-209">Chcete-li zadat konfigurační soubor nasazení v VSDBCMD, použijte přepínač **p:/DeploymentConfigurationFile** a zadejte úplnou cestu k souboru.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-209">To specify a deployment configuration file in your VSDBCMD, use the **p:/DeploymentConfigurationFile** switch and provide the full path to your file.</span></span> <span data-ttu-id="0e5ef-210">Tím dojde k přepsání konfiguračního souboru nasazení, který identifikuje manifest nasazení.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-210">This will override the deployment configuration file that the deployment manifest identifies.</span></span> <span data-ttu-id="0e5ef-211">Například můžete použít tento příkaz VSDBCMD k nasazení databáze **ContactManager** do testovacího prostředí:</span><span class="sxs-lookup"><span data-stu-id="0e5ef-211">For example, you could use this VSDBCMD command to deploy the **ContactManager** database to a test environment:</span></span>

[!code-console[Main](customizing-database-deployments-for-multiple-environments/samples/sample1.cmd)]

> [!NOTE]
> <span data-ttu-id="0e5ef-212">Všimněte si, že proces sestavení může přejmenovat soubor. SqlDeployment při zkopírování souboru do výstupního adresáře.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-212">Note that the build process may rename your .sqldeployment file when it copies the file to the output directory.</span></span>

<span data-ttu-id="0e5ef-213">Pokud používáte proměnné příkazů SQL ve skriptech SQL pro předběžné nasazení nebo po nasazení, můžete použít podobný přístup k přidružení souboru. sqlcmdvars specifického pro prostředí k vašemu nasazení.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-213">If you use SQL command variables in your pre-deployment or post-deployment SQL scripts, you can use a similar approach to associate an environment-specific .sqlcmdvars file with your deployment.</span></span> <span data-ttu-id="0e5ef-214">V tomto případě použijete přepínač **p:/SqlCommandVariablesFile** k identifikaci souboru. sqlcmdvars.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-214">In this case, you use the **p:/SqlCommandVariablesFile** switch to identify your .sqlcmdvars file.</span></span>

## <a name="running-the-vsdbcmd-command-from-an-msbuild-project-file"></a><span data-ttu-id="0e5ef-215">Spuštění příkazu VSDBCMD ze souboru projektu MSBuild</span><span class="sxs-lookup"><span data-stu-id="0e5ef-215">Running the VSDBCMD Command from an MSBuild Project File</span></span>

<span data-ttu-id="0e5ef-216">Můžete vyvolat příkaz VSDBCMD ze souboru projektu MSBuild pomocí úlohy **exec** v rámci cíle MSBuild.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-216">You can invoke a VSDBCMD command from an MSBuild project file by using an **Exec** task within an MSBuild target.</span></span> <span data-ttu-id="0e5ef-217">V nejjednodušším tvaru by vypadalo takto:</span><span class="sxs-lookup"><span data-stu-id="0e5ef-217">In its simplest form, it would look like this:</span></span>

[!code-xml[Main](customizing-database-deployments-for-multiple-environments/samples/sample2.xml)]

- <span data-ttu-id="0e5ef-218">V praxi, aby bylo možné soubory projektu snadno číst a opakovaně používat, budete chtít vytvořit vlastnosti pro uložení různých parametrů příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-218">In practice, to make your project files easy to read and reuse, you'll want to create properties to store the various command-line parameters.</span></span> <span data-ttu-id="0e5ef-219">To usnadňuje uživatelům zadání hodnot vlastností do souboru projektu specifického pro prostředí nebo přepisu výchozích hodnot z příkazového řádku MSBuild.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-219">This makes it easier for users to provide property values in an environment-specific project file or to override default values from the MSBuild command line.</span></span> <span data-ttu-id="0e5ef-220">Použijete-li přístup k rozdělenému souboru projektu, který je popsaný v tématu [Principy souboru projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md), měli byste odpovídajícím způsobem rozdělit pokyny a vlastnosti sestavení mezi tyto dva soubory:</span><span class="sxs-lookup"><span data-stu-id="0e5ef-220">If you use the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), you should divide your build instructions and properties between the two files accordingly:</span></span>
- <span data-ttu-id="0e5ef-221">Nastavení specifické pro prostředí, jako je název souboru konfigurace nasazení, připojovací řetězec databáze a název cílové databáze, by měly přejít do souboru projektu specifického pro prostředí.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-221">Environment-specific settings, like the deployment configuration filename, the database connection string, and the target database name, should go in the environment-specific project file.</span></span>
- <span data-ttu-id="0e5ef-222">Cíl nástroje MSBuild, který spouští příkaz VSDBCMD, spolu s jakýmikoli univerzálními vlastnostmi, jako je umístění spustitelného souboru VSDBCMD, by měl přejít do souboru univerzálního projektu.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-222">The MSBuild target that runs the VSDBCMD command, together with any universal properties like the location of the VSDBCMD executable, should go in the universal project file.</span></span>

<span data-ttu-id="0e5ef-223">Měli byste také zajistit, aby projekt databáze byl vytvořen před vyvoláním VSDBCMD, aby byl vytvořen soubor. DeployManifest a byl připraven k použití.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-223">You should also ensure that you build the database project before you invoke VSDBCMD so that the .deploymanifest file is created and ready to use.</span></span> <span data-ttu-id="0e5ef-224">Úplný příklad tohoto přístupu si můžete prohlédnout v tématu [Principy procesu sestavení](../web-deployment-in-the-enterprise/understanding-the-build-process.md), který vás provede soubory projektu v [ukázkovém řešení Správce kontaktů](../web-deployment-in-the-enterprise/the-contact-manager-solution.md).</span><span class="sxs-lookup"><span data-stu-id="0e5ef-224">You can see a full example of this approach in the topic [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md), which walks you through the project files in the [Contact Manager sample solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="0e5ef-225">Závěr</span><span class="sxs-lookup"><span data-stu-id="0e5ef-225">Conclusion</span></span>

<span data-ttu-id="0e5ef-226">Toto téma popisuje, jak můžete přizpůsobit vlastnosti databáze na jiná cílová prostředí při nasazení databázových projektů pomocí nástroje MSBuild a VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-226">This topic described how you can tailor database properties to different destination environments when you deploy database projects using MSBuild and VSDBCMD.</span></span> <span data-ttu-id="0e5ef-227">Tento přístup je užitečný v případě, že potřebujete nasadit databázové projekty jako součást větších podnikových řešení na úrovni podniku.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-227">This approach is useful when you need to deploy database projects as part of larger, enterprise-scale solutions.</span></span> <span data-ttu-id="0e5ef-228">Tato řešení se často nasazují na více cílů, jako jsou například vývojové nebo testovací prostředí v izolovaném prostoru, pracovní nebo integrační platformy a produkční nebo aktivní prostředí.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-228">These solutions are often deployed to multiple destinations, like sandboxed development or test environments, staging or integration platforms, and production or live environments.</span></span> <span data-ttu-id="0e5ef-229">Každé z těchto cílových prostředí obvykle vyžaduje jedinečnou sadu vlastností nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="0e5ef-229">Each of these target environments typically requires a unique set of database deployment properties.</span></span>

## <a name="further-reading"></a><span data-ttu-id="0e5ef-230">Další čtení</span><span class="sxs-lookup"><span data-stu-id="0e5ef-230">Further Reading</span></span>

<span data-ttu-id="0e5ef-231">Další informace o nasazení databázových projektů pomocí VSDBCMD. exe najdete v tématu [nasazení databázových projektů](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span><span class="sxs-lookup"><span data-stu-id="0e5ef-231">For more information on deploying database projects using VSDBCMD.exe, see [Deploying Database Projects](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span></span> <span data-ttu-id="0e5ef-232">Další informace o použití vlastních souborů projektu MSBuild pro řízení procesu nasazení naleznete v tématu [porozumění souboru projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md) a [porozumění procesu sestavení](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="0e5ef-232">For more information on using custom MSBuild project files to control the deployment process, see [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md) and [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>

<span data-ttu-id="0e5ef-233">Tyto články na webu MSDN poskytují obecnější pokyny k nasazení databáze:</span><span class="sxs-lookup"><span data-stu-id="0e5ef-233">These articles on MSDN provide more general guidance on database deployment:</span></span>

- <span data-ttu-id="0e5ef-234">[Přehled nastavení databázového projektu](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="0e5ef-234">[An Overview of Database Project Settings](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx)</span></span>
- [<span data-ttu-id="0e5ef-235">Postupy: Konfigurace vlastností pro podrobnosti nasazení</span><span class="sxs-lookup"><span data-stu-id="0e5ef-235">How to: Configure Properties for Deployment Details</span></span>](https://msdn.microsoft.com/library/dd172125.aspx)
- [<span data-ttu-id="0e5ef-236">Sestavování a nasazování databází do izolovaného vývojového prostředí</span><span class="sxs-lookup"><span data-stu-id="0e5ef-236">Build and Deploy Databases to an Isolated Development Environment</span></span>](https://msdn.microsoft.com/library/dd193409.aspx)
- [<span data-ttu-id="0e5ef-237">Sestavování a nasazování databází do pracovního nebo produkčního prostředí</span><span class="sxs-lookup"><span data-stu-id="0e5ef-237">Build and Deploy Databases to a Staging or Production Environment</span></span>](https://msdn.microsoft.com/library/dd193413.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="0e5ef-238">[Předchozí](performing-a-what-if-deployment.md)
> [Další](deploying-database-role-memberships-to-test-environments.md)</span><span class="sxs-lookup"><span data-stu-id="0e5ef-238">[Previous](performing-a-what-if-deployment.md)
[Next](deploying-database-role-memberships-to-test-environments.md)</span></span>
