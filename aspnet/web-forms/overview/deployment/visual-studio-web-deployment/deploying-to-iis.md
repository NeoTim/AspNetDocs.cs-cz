---
uid: web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-iis
title: 'ASP.NET nasazení webu pomocí sady Visual Studio: nasazení do testu | Microsoft Docs'
author: tdykstra
description: V této sérii kurzů se dozvíte, jak nasadit (publikovat) webovou aplikaci ASP.NET, která bude Azure App Service Web Apps nebo poskytovateli hostingu třetí strany, pomocí usin...
ms.author: riande
ms.date: 01/16/2019
ms.assetid: 8bf2c4fb-4ee5-4841-bfc2-03462c1f7a7a
msc.legacyurl: /web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-iis
msc.type: authoredcontent
ms.openlocfilehash: c45003325832258466a787bc589bf40e844248a2
ms.sourcegitcommit: 4b324a11131e38f920126066b94ff478aa9927f8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/13/2019
ms.locfileid: "70985858"
---
# <a name="aspnet-web-deployment-using-visual-studio-deploying-to-test"></a><span data-ttu-id="69916-103">ASP.NET nasazení webu pomocí sady Visual Studio: nasazení do testování</span><span class="sxs-lookup"><span data-stu-id="69916-103">ASP.NET Web Deployment using Visual Studio: Deploying to Test</span></span>

<span data-ttu-id="69916-104">tím, že [Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="69916-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="69916-105">V této sérii kurzů se dozvíte, jak nasadit (publikovat) webovou aplikaci ASP.NET, která bude Azure App Service Web Apps nebo poskytovateli hostování třetí strany pomocí sady Visual Studio 2017.</span><span class="sxs-lookup"><span data-stu-id="69916-105">This tutorial series shows how to deploy (publish) an ASP.NET web application to Azure App Service Web Apps or to a third-party hosting provider using Visual Studio 2017.</span></span> <span data-ttu-id="69916-106">Informace o řadě najdete v [prvním kurzu v řadě](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="69916-106">For information about the series, see [the first tutorial in the series](introduction.md).</span></span>

<span data-ttu-id="69916-107">Aktuální verzi nasazení do Azure najdete v tématu [Vytvoření webové aplikace v ASP.NET Core v Azure](/azure/app-service/app-service-web-get-started-dotnet).</span><span class="sxs-lookup"><span data-stu-id="69916-107">For a current version of deploying to Azure, see [Create an ASP.NET Core web app in Azure](/azure/app-service/app-service-web-get-started-dotnet).</span></span>

## <a name="overview"></a><span data-ttu-id="69916-108">Přehled</span><span class="sxs-lookup"><span data-stu-id="69916-108">Overview</span></span>

<span data-ttu-id="69916-109">V tomto kurzu nasadíte webovou aplikaci v ASP.NET do služby Internet Information Server (IIS) na místním počítači.</span><span class="sxs-lookup"><span data-stu-id="69916-109">In this tutorial, you'll deploy an ASP.NET web application to Internet Information Server (IIS) on your local computer.</span></span>

<span data-ttu-id="69916-110">Obecně platí, že když vyvíjíte aplikaci, spustíte ji a otestujete ji v aplikaci Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="69916-110">Generally when you develop an application, you run it and test it in Visual Studio.</span></span> <span data-ttu-id="69916-111">Ve výchozím nastavení používají projekty webové aplikace v aplikaci Visual Studio 2017 IIS Express jako vývojový webový server.</span><span class="sxs-lookup"><span data-stu-id="69916-111">By default, web application projects in Visual Studio 2017 use IIS Express as the development web server.</span></span> <span data-ttu-id="69916-112">IIS Express se chová podobně jako plná služba IIS, než vývojový server sady Visual Studio (označovaný také jako Cassini), který Visual Studio 2017 používá ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="69916-112">IIS Express behaves more like full IIS than the Visual Studio Development Server (also known as Cassini), which Visual Studio 2017 uses by default.</span></span> <span data-ttu-id="69916-113">Ale vývoj webového serveru nefunguje úplně stejně jako služba IIS.</span><span class="sxs-lookup"><span data-stu-id="69916-113">But neither development web server works exactly like IIS.</span></span> <span data-ttu-id="69916-114">V důsledku toho může aplikace správně běžet a testovat v aplikaci Visual Studio, ale při nasazení do služby IIS dojde k chybě.</span><span class="sxs-lookup"><span data-stu-id="69916-114">Consequently, an app could run and test correctly in Visual Studio but fail when it's deployed to IIS.</span></span>

<span data-ttu-id="69916-115">Můžete spolehlivě testovat aplikaci dvěma způsoby:</span><span class="sxs-lookup"><span data-stu-id="69916-115">You can reliably test your application in two ways:</span></span>

1. <span data-ttu-id="69916-116">Nasaďte aplikaci do služby IIS na svém vývojovém počítači pomocí stejného procesu, který později použijete k jeho nasazení do provozního prostředí.</span><span class="sxs-lookup"><span data-stu-id="69916-116">Deploy your application to IIS on your development computer using the same process that you'll use later to deploy it to your production environment.</span></span>

   <span data-ttu-id="69916-117">Aplikaci Visual Studio můžete nakonfigurovat tak, aby používala službu IIS při spuštění webového projektu, ale to by nemohlo testovat proces nasazení.</span><span class="sxs-lookup"><span data-stu-id="69916-117">You can configure Visual Studio to use IIS when you run a web project, but that wouldn't test your deployment process.</span></span> <span data-ttu-id="69916-118">Tato metoda ověří váš proces nasazení a aplikace správně funguje v rámci služby IIS.</span><span class="sxs-lookup"><span data-stu-id="69916-118">This method validates your deployment process and that your application runs correctly under IIS.</span></span>

2. <span data-ttu-id="69916-119">Nasaďte aplikaci do testovacího prostředí podobného vašemu provoznímu prostředí.</span><span class="sxs-lookup"><span data-stu-id="69916-119">Deploy your application to a test environment similar to your production environment.</span></span> 
 
   <span data-ttu-id="69916-120">Provozní prostředí pro tyto kurzy je Web Apps v Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="69916-120">The production environment for these tutorials is Web Apps in Azure App Service.</span></span> <span data-ttu-id="69916-121">Ideální testovací prostředí je další webová aplikace vytvořená ve službě Azure.</span><span class="sxs-lookup"><span data-stu-id="69916-121">The ideal test environment is an additional web app created in the Azure Service.</span></span> <span data-ttu-id="69916-122">I když by byl nastavený stejným způsobem jako produkční webová aplikace, měli byste ho použít jenom pro testování.</span><span class="sxs-lookup"><span data-stu-id="69916-122">Though it would be set up the same way as a production web app, you would only use it for testing.</span></span>

<span data-ttu-id="69916-123">Možnost 2 je nejspolehlivější způsob testování.</span><span class="sxs-lookup"><span data-stu-id="69916-123">Option 2 is the most reliable way to test.</span></span> <span data-ttu-id="69916-124">Pokud použijete možnost 2, nemusíte nutně používat možnost 1.</span><span class="sxs-lookup"><span data-stu-id="69916-124">If you use option 2, you don't necessarily need to use option 1.</span></span> <span data-ttu-id="69916-125">Pokud však nasazujete pro poskytovatele hostingu třetí strany, možnost 2 nemusí být vhodná nebo může být náročná, takže v této sérii kurzů se zobrazují obě metody.</span><span class="sxs-lookup"><span data-stu-id="69916-125">However if you're deploying to a third-party hosting provider, option 2 might not be feasible or might be expensive, so this tutorial series shows both methods.</span></span> <span data-ttu-id="69916-126">Pokyny k možnosti 2 jsou k dispozici v kurzu [nasazení do provozního prostředí](deploying-to-production.md) .</span><span class="sxs-lookup"><span data-stu-id="69916-126">Guidance for option 2 is provided in the [Deploying to the Production Environment](deploying-to-production.md) tutorial.</span></span>

<span data-ttu-id="69916-127">Další informace o používání webových serverů v aplikaci Visual Studio naleznete v tématu [webové servery v aplikaci Visual Studio pro webové projekty ASP.NET](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span><span class="sxs-lookup"><span data-stu-id="69916-127">For more information about using web servers in Visual Studio, see [Web Servers in Visual Studio for ASP.NET Web Projects](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span></span>

<span data-ttu-id="69916-128">Připomenutí: Pokud obdržíte chybovou zprávu nebo něco nefunguje při procházení tohoto kurzu, zkontrolujte [stránku Poradce při potížích](troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="69916-128">Reminder: If you receive an error message or something doesn't work as you go through the tutorial, be sure to check the [troubleshooting page](troubleshooting.md).</span></span>

## <a name="download-the-contoso-university-starter-project"></a><span data-ttu-id="69916-129">Stáhnout projekt contoso University Starter</span><span class="sxs-lookup"><span data-stu-id="69916-129">Download the Contoso University starter project</span></span>

<span data-ttu-id="69916-130">Stáhněte a nainstalujte si řešení a projekt společnosti Contoso University Visual Studio Start.</span><span class="sxs-lookup"><span data-stu-id="69916-130">Download and install the Contoso University Visual Studio starter solution and project.</span></span> <span data-ttu-id="69916-131">Toto řešení obsahuje dokončený kurz.</span><span class="sxs-lookup"><span data-stu-id="69916-131">This solution contains the completed tutorial.</span></span> 

[<span data-ttu-id="69916-132">Stáhnout počáteční projekt</span><span class="sxs-lookup"><span data-stu-id="69916-132">Download Starter Project</span></span>](http://go.microsoft.com/fwlink/p/?LinkId=282627)

## <a name="install-iis"></a><span data-ttu-id="69916-133">Instalace služby IIS</span><span class="sxs-lookup"><span data-stu-id="69916-133">Install IIS</span></span>

<span data-ttu-id="69916-134">Pokud chcete nasadit službu IIS na svém vývojovém počítači, zkontrolujte, že je nainstalovaná služba IIS a Nasazení webu.</span><span class="sxs-lookup"><span data-stu-id="69916-134">To deploy to IIS on your development computer, confirm that IIS and Web Deploy are installed.</span></span> <span data-ttu-id="69916-135">Ve výchozím nastavení Visual Studio nainstaluje Nasazení webu, ale služba IIS není zahrnutá ve výchozí konfiguraci Windows 10, Windows 8 nebo Windows 7.</span><span class="sxs-lookup"><span data-stu-id="69916-135">By default, Visual Studio installs Web Deploy, but IIS isn't included in the default Windows 10, Windows 8, or Windows 7 configuration.</span></span> <span data-ttu-id="69916-136">Pokud jste už službu IIS nainstalovali a výchozí fond aplikací už je nastavený na .NET 4, přejděte k [Další části](#sqlexpress).</span><span class="sxs-lookup"><span data-stu-id="69916-136">If you've already installed IIS and the default application pool is already set to .NET 4, skip to [the next section](#sqlexpress).</span></span>

1. <span data-ttu-id="69916-137">Pro instalaci služby IIS a Nasazení webu doporučujeme použít [instalační program webové platformy (pracovního procesu)](https://www.microsoft.com/web/downloads/platform.aspx) .</span><span class="sxs-lookup"><span data-stu-id="69916-137">It's recommended you use the [Web Platform Installer (WPI)](https://www.microsoft.com/web/downloads/platform.aspx) to install IIS and Web Deploy.</span></span> <span data-ttu-id="69916-138">V případě potřeby nainstaluje služba pracovního procesu osvědčenou konfiguraci služby IIS, která zahrnuje požadavky služby IIS a Nasazení webu.</span><span class="sxs-lookup"><span data-stu-id="69916-138">WPI installs a recommended IIS configuration that includes IIS and Web Deploy prerequisites if necessary.</span></span>

   <span data-ttu-id="69916-139">Pokud jste již nainstalovali službu IIS, Nasazení webu nebo kteroukoli z požadovaných součástí, nainstaluje požadavek na instalaci pouze to, co chybí.</span><span class="sxs-lookup"><span data-stu-id="69916-139">If you've already installed IIS, Web Deploy, or any of their required components, the WPI installs only what is missing.</span></span>

   * <span data-ttu-id="69916-140">Pomocí instalačního programu webové platformy nainstalujte službu IIS a Nasazení webu:</span><span class="sxs-lookup"><span data-stu-id="69916-140">Use the Web Platform Installer to install IIS and Web Deploy:</span></span>
    
     ![Instalace služby IIS pomocí procesu pracovního procesu](deploying-to-iis/_static/image30.png)

     ![Instalace Nasazení webu pomocí procesu pracovního procesu](deploying-to-iis/_static/image31.png)

     <span data-ttu-id="69916-143">Zobrazí se zpráva oznamující, že se nainstaluje služba IIS 7.</span><span class="sxs-lookup"><span data-stu-id="69916-143">You'll see messages indicating that IIS 7 will be installed.</span></span> <span data-ttu-id="69916-144">Odkaz funguje pro IIS 8 ve Windows 8; u systému Windows 8 a novějších verzí ale Projděte následující kroky, abyste se ujistili, že je nainstalovaná ASP.NET 4,7:</span><span class="sxs-lookup"><span data-stu-id="69916-144">The link works for IIS 8 in Windows 8; but for Windows 8 and later, go through the following steps to make sure that ASP.NET 4.7 is installed:</span></span>

   * <span data-ttu-id="69916-145">Otevřete **Ovládací panely** > **programy** > **programy a funkce** > **zapnout nebo vypnout funkce systému Windows**.</span><span class="sxs-lookup"><span data-stu-id="69916-145">Open **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off**.</span></span>

   * <span data-ttu-id="69916-146">Rozbalte **Internetová informační služba**, **webové služby**a **funkce pro vývoj aplikací**.</span><span class="sxs-lookup"><span data-stu-id="69916-146">Expand **Internet Information Services**, **World Wide Web Services**, and **Application Development Features**.</span></span>
   
   * <span data-ttu-id="69916-147">Potvrďte, že je vybraná možnost **ASP.NET 4,7** .</span><span class="sxs-lookup"><span data-stu-id="69916-147">Confirm that **ASP.NET 4.7** is selected.</span></span>

     ![Vyberte ASP.NET 4,7](deploying-to-iis/_static/image1a.png)

   * <span data-ttu-id="69916-149">Ověřte, zda je vybrána možnost **webové služby** a **Konzola pro správu služby IIS** .</span><span class="sxs-lookup"><span data-stu-id="69916-149">Confirm that **World Wide Web Services** and **IIS Management Console** is selected.</span></span> <span data-ttu-id="69916-150">Tím se nainstaluje služba IIS a správce služby IIS.</span><span class="sxs-lookup"><span data-stu-id="69916-150">This installs IIS and IIS Manager.</span></span>
    
     ![Vybrat webové služby](deploying-to-iis/_static/image24.png)    
  
   * <span data-ttu-id="69916-152">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="69916-152">Select **OK**.</span></span> <span data-ttu-id="69916-153">Zobrazí se zprávy s dialogovým oknem, které indikují instalaci.</span><span class="sxs-lookup"><span data-stu-id="69916-153">Dialog box messages indicating installation is taking place appear.</span></span>

<span data-ttu-id="69916-154">Po instalaci služby IIS spusťte **Správce služby IIS** , abyste se ujistili, že se k výchozímu fondu aplikací přiřadí .NET Framework verze 4.</span><span class="sxs-lookup"><span data-stu-id="69916-154">After installing IIS, run **IIS Manager** to make sure that the .NET Framework version 4 is assigned to the default application pool.</span></span>

1. <span data-ttu-id="69916-155">Kliknutím na tlačítko WINDOWS + R otevřete dialogové okno **spuštění** .</span><span class="sxs-lookup"><span data-stu-id="69916-155">Press WINDOWS+R to open the **Run** dialog box.</span></span>

   <span data-ttu-id="69916-156">(V systému Windows 8 nebo novějším zadejte na **úvodní** stránce "Run" (spustit).</span><span class="sxs-lookup"><span data-stu-id="69916-156">(On Windows 8 or later, enter "run" on the **Start** page.</span></span> <span data-ttu-id="69916-157">V systému Windows 7 vyberte v nabídce **Start** možnost **Spustit** .</span><span class="sxs-lookup"><span data-stu-id="69916-157">In Windows 7, select **Run** from the **Start** menu.</span></span> <span data-ttu-id="69916-158">Pokud příkaz **Spustit** není v nabídce **Start** , klikněte pravým tlačítkem myši na hlavní panel, vyberte možnost **vlastnosti**, vyberte kartu **Nabídka Start** , vyberte možnost **přizpůsobit**a vyberte možnost **Spustit příkaz**.)</span><span class="sxs-lookup"><span data-stu-id="69916-158">If **Run** isn't in the **Start** menu, right-click the taskbar, select **Properties**, select the **Start Menu** tab, select **Customize**, and select **Run command**.)</span></span>

2. <span data-ttu-id="69916-159">Zadejte "inetmgr" a vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="69916-159">Enter "inetmgr" and select **OK**.</span></span>

3. <span data-ttu-id="69916-160">V podokně **připojení** rozbalte uzel server a vyberte **fondy aplikací**.</span><span class="sxs-lookup"><span data-stu-id="69916-160">In the **Connections** pane, expand the server node and select **Application Pools**.</span></span> <span data-ttu-id="69916-161">V podokně **fondy aplikací** , pokud je aplikace **DefaultAppPool** přiřazena k rozhraní .NET Framework verze 4, jak je znázorněno na následujícím obrázku, přejděte k další části.</span><span class="sxs-lookup"><span data-stu-id="69916-161">In the **Application Pools** pane if **DefaultAppPool** is assigned to the .NET framework version 4 as in the following illustration, skip to the next section.</span></span>

   ![Inetmgr_showing_4.0_app_pools](deploying-to-iis/_static/image5a.png)

4. <span data-ttu-id="69916-163">Pokud vidíte pouze dva fondy aplikací a obě jsou nastaveny na .NET Framework 2,0, nainstalujte ASP.NET 4 do služby IIS.</span><span class="sxs-lookup"><span data-stu-id="69916-163">If you see only two application pools and both are set to .NET Framework 2.0, install ASP.NET 4 in IIS.</span></span>

   <span data-ttu-id="69916-164">V systému Windows 8 nebo novějším se podívejte na předchozí část s pokyny pro zajištění, že je nainstalovaná verze ASP.NET 4,7, nebo si přečtěte, [Jak nainstalovat ASP.NET 4,5 v systému Windows 8 a Windows Server 2012](https://support.microsoft.com/kb/2736284).</span><span class="sxs-lookup"><span data-stu-id="69916-164">For Windows 8 or later, see the previous section's instructions for making sure that ASP.NET 4.7 is installed or see [How to install ASP.NET 4.5 on Windows 8 and Windows Server 2012](https://support.microsoft.com/kb/2736284).</span></span> <span data-ttu-id="69916-165">V případě systému Windows 7 otevřete okno příkazového řádku kliknutím pravým tlačítkem myši na **příkazový řádek** v nabídce **Start** systému Windows a výběrem možnosti **Spustit jako správce**.</span><span class="sxs-lookup"><span data-stu-id="69916-165">For Windows 7, open a command prompt window by right-clicking **Command Prompt** in the Windows **Start** menu and selecting **Run as Administrator**.</span></span> <span data-ttu-id="69916-166">Spuštěním příkazu [aspnet\_regiis. exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) nainstalujete ASP.NET 4 do služby IIS pomocí následujících příkazů.</span><span class="sxs-lookup"><span data-stu-id="69916-166">Run [aspnet\_regiis.exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) to install ASP.NET 4 in IIS using the following commands.</span></span> <span data-ttu-id="69916-167">(V 32 systémech nahraďte "Framework64" rozhraním "Framework".)</span><span class="sxs-lookup"><span data-stu-id="69916-167">(In 32-bit systems, replace "Framework64" with "Framework".)</span></span>

   [!code-console[Main](deploying-to-iis/samples/sample1.cmd)]

   <span data-ttu-id="69916-168">Tento příkaz vytvoří nové fondy aplikací pro .NET Framework 4, výchozí fond aplikací však zůstane nastaven na 2,0.</span><span class="sxs-lookup"><span data-stu-id="69916-168">This command creates new application pools for the .NET Framework 4, but the default application pool will remain set to 2.0.</span></span> <span data-ttu-id="69916-169">Nasazujete aplikaci, která se zaměřuje na rozhraní .NET 4, do tohoto fondu aplikací, takže změňte fond aplikací na .NET 4.</span><span class="sxs-lookup"><span data-stu-id="69916-169">You're deploying an application that targets .NET 4 to that application pool, so change the application pool to .NET 4.</span></span>

5. <span data-ttu-id="69916-170">Pokud jste **Správce služby IIS**zavřeli, spusťte ho znovu, rozbalte uzel serveru a vyberte **fondy aplikací**.</span><span class="sxs-lookup"><span data-stu-id="69916-170">If you closed **IIS Manager**, run it again, expand the server node, and select **Application Pools**.</span></span>

6. <span data-ttu-id="69916-171">V podokně **fondy aplikací** vyberte možnost **DefaultAppPool**.</span><span class="sxs-lookup"><span data-stu-id="69916-171">In the **Application Pools** pane, select **DefaultAppPool**.</span></span> <span data-ttu-id="69916-172">V podokně **Akce** vyberte **základní nastavení**.</span><span class="sxs-lookup"><span data-stu-id="69916-172">In the **Actions** pane, select **Basic Settings**.</span></span>

   ![Inetmgr_selecting_Basic_Settings_for_app_pool](deploying-to-iis/_static/image25.png)

7. <span data-ttu-id="69916-174">V dialogovém okně **Upravit fond aplikací** změňte **verzi .NET CLR** na **.NET CLR v 4.0.30319**.</span><span class="sxs-lookup"><span data-stu-id="69916-174">In the **Edit Application Pool** dialog box, change the **.NET CLR version** to **.NET CLR v4.0.30319**.</span></span> <span data-ttu-id="69916-175">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="69916-175">Select **OK**.</span></span>

   ![Selecting_. NET_4_for_DefaultAppPool](deploying-to-iis/_static/image6a.png)

<span data-ttu-id="69916-177">Nyní jste připraveni publikovat webovou aplikaci do služby IIS.</span><span class="sxs-lookup"><span data-stu-id="69916-177">You're now ready to publish a web application to IIS.</span></span> <span data-ttu-id="69916-178">Nejprve však vytvořte databáze pro testování.</span><span class="sxs-lookup"><span data-stu-id="69916-178">First, however, create databases for testing.</span></span>

<a id="sqlexpress"></a>

## <a name="install-sql-server-express"></a><span data-ttu-id="69916-179">Nainstalovat SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="69916-179">Install SQL Server Express</span></span>

<span data-ttu-id="69916-180">LocalDB není navržený tak, aby fungoval ve službě IIS, takže vaše testovací prostředí musí mít nainstalovaný SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="69916-180">LocalDB isn't designed to work in IIS, so your test environment has to have SQL Server Express installed.</span></span> <span data-ttu-id="69916-181">Pokud používáte Visual Studio 2010 SQL Server Express, je již ve výchozím nastavení nainstalován.</span><span class="sxs-lookup"><span data-stu-id="69916-181">If you're using Visual Studio 2010 SQL Server Express, it's already installed by default.</span></span> <span data-ttu-id="69916-182">Pokud používáte Visual Studio 2012 nebo novější, nainstalujte SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="69916-182">If you're using Visual Studio 2012 or later, install SQL Server Express.</span></span>

<span data-ttu-id="69916-183">Pokud chcete nainstalovat SQL Server Express, Stáhněte si ho a nainstalujte si ho z [webu Download Center: Microsoft SQL Server 2017 Express Edition](https://www.microsoft.com/sql-server/sql-server-editions-express).</span><span class="sxs-lookup"><span data-stu-id="69916-183">To install SQL Server Express, download and install it from [Download Center: Microsoft SQL Server 2017 Express edition](https://www.microsoft.com/sql-server/sql-server-editions-express).</span></span> 

<span data-ttu-id="69916-184">Na první stránce centra instalace SQL Server vyberte **nový SQL Server samostatnou instalaci nebo přidejte funkce do existující instalace** a postupujte podle pokynů pro přijetí výchozích možností.</span><span class="sxs-lookup"><span data-stu-id="69916-184">On the first page of the SQL Server Installation Center, select **New SQL Server stand-alone installation or add features to an existing installation** and follow the instructions accepting the default choices.</span></span> <span data-ttu-id="69916-185">V Průvodci instalací přijměte výchozí nastavení.</span><span class="sxs-lookup"><span data-stu-id="69916-185">In the installation wizard, accept the default settings.</span></span> <span data-ttu-id="69916-186">Další informace o možnostech instalace najdete v tématu [instalace SQL Server v Průvodci instalací (nastavení)](https://msdn.microsoft.com/library/ms143219.aspx).</span><span class="sxs-lookup"><span data-stu-id="69916-186">For more information about installation options, see [Install SQL Server from the Installation Wizard (Setup)](https://msdn.microsoft.com/library/ms143219.aspx).</span></span>

## <a name="create-sql-server-express-databases-for-the-test-environment"></a><span data-ttu-id="69916-187">Vytvoření databází SQL Server Express pro testovací prostředí</span><span class="sxs-lookup"><span data-stu-id="69916-187">Create SQL Server Express databases for the test environment</span></span>

<span data-ttu-id="69916-188">Aplikace Contoso University má dvě databáze:</span><span class="sxs-lookup"><span data-stu-id="69916-188">The Contoso University application has two databases:</span></span> 

1. <span data-ttu-id="69916-189">Databáze členství</span><span class="sxs-lookup"><span data-stu-id="69916-189">Membership database</span></span> 
2. <span data-ttu-id="69916-190">Aplikační databáze</span><span class="sxs-lookup"><span data-stu-id="69916-190">Application database</span></span> 

<span data-ttu-id="69916-191">Tyto databáze můžete nasadit do dvou samostatných databází nebo do jediné databáze.</span><span class="sxs-lookup"><span data-stu-id="69916-191">You can deploy these databases to two separate databases or to a single database.</span></span> <span data-ttu-id="69916-192">Jejich kombinování usnadňuje spojení s databází.</span><span class="sxs-lookup"><span data-stu-id="69916-192">Combining them makes database joins between them easier.</span></span> 

<span data-ttu-id="69916-193">Pokud nasazujete pro poskytovatele hostingu třetí strany, váš plán hostování vám také může poskytnout důvod, jak je kombinovat.</span><span class="sxs-lookup"><span data-stu-id="69916-193">If you're deploying to a third-party hosting provider, your hosting plan might also give you a reason to combine them.</span></span> <span data-ttu-id="69916-194">Zprostředkovatel může například účtovat více databází více nebo nemusí dokonce umožňovat více než jednu databázi.</span><span class="sxs-lookup"><span data-stu-id="69916-194">For example, the provider might charge more for multiple databases or might not even allow more than one database.</span></span>

<span data-ttu-id="69916-195">V tomto kurzu nasadíte do dvou databází v testovacím prostředí a do jedné databáze v pracovním prostředí a v produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="69916-195">In this tutorial, you'll deploy to two databases in the test environment and to one database in the staging and production environments.</span></span>

<span data-ttu-id="69916-196">V nabídce **zobrazení** v aplikaci Visual Studio vyberte možnost **Průzkumník serveru** (**Průzkumník databáze** v aplikaci Visual Web Developer).</span><span class="sxs-lookup"><span data-stu-id="69916-196">From the **View** menu in Visual Studio, select **Server Explorer** (**Database Explorer** in Visual Web Developer).</span></span> <span data-ttu-id="69916-197">Klikněte pravým tlačítkem na **datová připojení** a vyberte **vytvořit novou SQL Server databázi**.</span><span class="sxs-lookup"><span data-stu-id="69916-197">Right-click **Data Connections** and select **Create New SQL Server Database**.</span></span>

![Selecting_Create_New_SQL_Server_Database](deploying-to-iis/_static/image8.png)

<span data-ttu-id="69916-199">V dialogovém okně **vytvořit novou databázi SQL Server** do pole **název serveru** zadejte ".\SQLEXPRESS" a do pole **název nové databáze** zadejte "ASPNET-ContosoUniversity".</span><span class="sxs-lookup"><span data-stu-id="69916-199">In the **Create New SQL Server Database** dialog box, enter ".\SQLExpress" in the **Server name** box and "aspnet-ContosoUniversity" in the **New database name** box.</span></span> <span data-ttu-id="69916-200">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="69916-200">Select **OK**.</span></span>

![Vytvoření ASPNET-ContosoUniversity](deploying-to-iis/_static/image9.png)

<span data-ttu-id="69916-202">Použijte stejný postup k vytvoření nové databáze SQL Server Express School s názvem `ContosoUniversity`.</span><span class="sxs-lookup"><span data-stu-id="69916-202">Follow the same procedure to create a new SQL Server Express School database named `ContosoUniversity`.</span></span>

<span data-ttu-id="69916-203">**Průzkumník serveru** zobrazí dvě nové databáze.</span><span class="sxs-lookup"><span data-stu-id="69916-203">**Server Explorer** shows the two new databases.</span></span>

![Nové databáze v Průzkumník serveru](deploying-to-iis/_static/image10.png)

## <a name="create-a-grant-script-for-the-new-databases"></a><span data-ttu-id="69916-205">Vytvoření skriptu udělení pro nové databáze</span><span class="sxs-lookup"><span data-stu-id="69916-205">Create a grant script for the new databases</span></span>

<span data-ttu-id="69916-206">Když je aplikace spuštěna ve službě IIS ve vývojovém počítači, aplikace používá k přístupu k databázi výchozí přihlašovací údaje fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="69916-206">When the application runs in IIS on your development computer, the application uses the default application pool's credentials to access the database.</span></span> <span data-ttu-id="69916-207">Ve výchozím nastavení ale fond aplikací nemá oprávnění k otevření databází.</span><span class="sxs-lookup"><span data-stu-id="69916-207">However, by default, the application pool doesn't have permission to open the databases.</span></span> <span data-ttu-id="69916-208">To znamená, že pro udělení tohoto oprávnění musíte spustit skript.</span><span class="sxs-lookup"><span data-stu-id="69916-208">This means you need to run a script to grant that permission.</span></span> <span data-ttu-id="69916-209">V této části vytvoříte skript a spustíte ho později, abyste se ujistili, že aplikace může otevírat databáze při spuštění ve službě IIS.</span><span class="sxs-lookup"><span data-stu-id="69916-209">In this section, you'll create that script and run it later to make sure that the application can open the databases when it runs in IIS.</span></span>

<span data-ttu-id="69916-210">V textovém editoru zkopírujte následující příkazy SQL do nového souboru a uložte ho jako *grant. SQL*.</span><span class="sxs-lookup"><span data-stu-id="69916-210">In a text editor, copy the following SQL commands into a new file and save it as *Grant.sql*.</span></span> 

[!code-sql[Main](deploying-to-iis/samples/sample2.sql)]

<span data-ttu-id="69916-211">V aplikaci Visual Studio otevřete řešení contoso University.</span><span class="sxs-lookup"><span data-stu-id="69916-211">In Visual Studio, open the Contoso University solution.</span></span> <span data-ttu-id="69916-212">Klikněte pravým tlačítkem na řešení (ne na jeden z projektů) a vyberte **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="69916-212">Right-click the solution (not one of the projects), and select **Add**.</span></span> <span data-ttu-id="69916-213">Vyberte možnost **existující položka**, přejděte k položce *grant. SQL*a otevřete ji.</span><span class="sxs-lookup"><span data-stu-id="69916-213">Select **Existing Item**, browse to *Grant.sql*, and open it.</span></span>

> [!NOTE]
> <span data-ttu-id="69916-214">Tento skript je navržený tak, aby fungoval s SQL Server Express 2012 nebo novějším a s nastavením služby IIS ve Windows 10, Windows 8 nebo Windows 7, jak jsou uvedeny v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="69916-214">This script is designed to work with SQL Server Express 2012 or later and with the IIS settings in Windows 10, Windows 8, or Windows 7 as they are specified in this tutorial.</span></span> <span data-ttu-id="69916-215">Pokud používáte jinou verzi SQL Server nebo Windows nebo pokud jste v počítači nastavili službu IIS odlišně, může se stát, že se budou vyžadovat změny v tomto skriptu.</span><span class="sxs-lookup"><span data-stu-id="69916-215">If you're using a different version of SQL Server or Windows, or if you set up IIS on your computer differently, changes to this script might be required.</span></span> <span data-ttu-id="69916-216">Další informace o SQL Server skriptů naleznete v tématu [SQL Server Books Online](https://go.microsoft.com/fwlink/?LinkId=132511).</span><span class="sxs-lookup"><span data-stu-id="69916-216">For more information about SQL Server scripts, see [SQL Server Books Online](https://go.microsoft.com/fwlink/?LinkId=132511).</span></span>

> [!NOTE] 
> <span data-ttu-id="69916-217">**Poznámka k zabezpečení** Tento skript poskytuje `db_owner` oprávnění uživateli, který přistupuje k databázi v době běhu, což je to, co budete mít v produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="69916-217">**Security Note** This script gives `db_owner` permissions to the user that accesses the database at run time, which is what you'll have in the production environment.</span></span> <span data-ttu-id="69916-218">V některých scénářích můžete chtít zadat uživatele, který má úplná oprávnění aktualizace schématu databáze jenom pro nasazení, a určit pro dobu běhu jiného uživatele, který má oprávnění jenom pro čtení a zápis dat.</span><span class="sxs-lookup"><span data-stu-id="69916-218">In some scenarios, you might want to specify a user that has full database schema update permissions only for deployment and specify for run time a different user that has permissions only to read and write data.</span></span> <span data-ttu-id="69916-219">Další informace najdete v tématu [Kontrola automatických změn souboru Web. config pro migrace Code First](#reviewingmigrations) dále v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="69916-219">For more information, see [Reviewing the Automatic Web.config Changes for Code First Migrations](#reviewingmigrations) later in this tutorial.</span></span>

<a id="publish"></a>

## <a name="run-the-grant-script-in-the-application-database"></a><span data-ttu-id="69916-220">Spuštění skriptu udělení v aplikační databázi</span><span class="sxs-lookup"><span data-stu-id="69916-220">Run the grant script in the application database</span></span>

<span data-ttu-id="69916-221">Profil publikování můžete nakonfigurovat tak, aby během nasazení spouštěl skript grant v databázi členství, protože toto nasazení databáze používá poskytovatele [dbDacFx](https://docs.microsoft.com/iis/publish/using-web-deploy/dbdacfx-provider-for-incremental-database-publishing) .</span><span class="sxs-lookup"><span data-stu-id="69916-221">You can configure the publish profile to run the grant script in the membership database during deployment because that database deployment uses the [dbDacFx](https://docs.microsoft.com/iis/publish/using-web-deploy/dbdacfx-provider-for-incremental-database-publishing) provider.</span></span> <span data-ttu-id="69916-222">Během nasazování Migrace Code First nemůžete spouštět skripty, což je způsob nasazení aplikační databáze.</span><span class="sxs-lookup"><span data-stu-id="69916-222">You can't run scripts during Code First Migrations deployment, which is how you're deploying the application database.</span></span> <span data-ttu-id="69916-223">To znamená, že před nasazením v aplikační databázi musíte ručně spustit skript.</span><span class="sxs-lookup"><span data-stu-id="69916-223">This means you have to manually run the script before deployment in the application database.</span></span>

1. <span data-ttu-id="69916-224">V aplikaci Visual Studio otevřete soubor *grant. SQL* , který jste vytvořili dříve.</span><span class="sxs-lookup"><span data-stu-id="69916-224">In Visual Studio, open the *Grant.sql* file that you created earlier.</span></span>

2. <span data-ttu-id="69916-225">Vyberte **Connect** (Připojit).</span><span class="sxs-lookup"><span data-stu-id="69916-225">Select **Connect**.</span></span> 

    ![Tlačítko připojit](deploying-to-iis/_static/image11.png)

3. <span data-ttu-id="69916-227">V dialogovém okně **připojit k serveru** jako **název serveru**zadejte *.\SQLEXPRESS* .</span><span class="sxs-lookup"><span data-stu-id="69916-227">In the **Connect to Server** dialog box, enter *.\SQLExpress* as the **Server Name**.</span></span> <span data-ttu-id="69916-228">Vyberte **Connect** (Připojit).</span><span class="sxs-lookup"><span data-stu-id="69916-228">Select **Connect**.</span></span>

4. <span data-ttu-id="69916-229">V rozevíracím seznamu databáze vyberte **ContosoUniversity**.</span><span class="sxs-lookup"><span data-stu-id="69916-229">In the database drop-down list select **ContosoUniversity**.</span></span> <span data-ttu-id="69916-230">Vyberte **Provést**.</span><span class="sxs-lookup"><span data-stu-id="69916-230">Select **Execute**.</span></span> 

   ![](deploying-to-iis/_static/image12.png)

<span data-ttu-id="69916-231">Výchozí identita fondu aplikací nyní má dostatečná oprávnění v databázi aplikace, aby bylo možné Migrace Code First vytvořit tabulky databáze při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="69916-231">The default application pool identity now has sufficient permissions in the application database for Code First Migrations to create the database tables when the application runs.</span></span>

## <a name="publish-to-iis"></a><span data-ttu-id="69916-232">Publikování do služby IIS</span><span class="sxs-lookup"><span data-stu-id="69916-232">Publish to IIS</span></span>

<span data-ttu-id="69916-233">Existuje několik způsobů, jak můžete nasadit do služby IIS pomocí sady Visual Studio a Nasazení webu:</span><span class="sxs-lookup"><span data-stu-id="69916-233">There are several ways you can deploy to IIS using Visual Studio and Web Deploy:</span></span>

* <span data-ttu-id="69916-234">Použijte možnost publikování jedním kliknutím v aplikaci Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="69916-234">Use Visual Studio one-click publish.</span></span>
* <span data-ttu-id="69916-235">Publikování z příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="69916-235">Publish from the command line.</span></span>
* <span data-ttu-id="69916-236">Vytvořte balíček pro nasazení a nainstalujte ho pomocí Správce služby IIS.</span><span class="sxs-lookup"><span data-stu-id="69916-236">Create a deployment package and install it using IIS Manager.</span></span> <span data-ttu-id="69916-237">Balíček má soubor. zip se všemi soubory a metadaty, které jsou potřeba k instalaci lokality ve službě IIS.</span><span class="sxs-lookup"><span data-stu-id="69916-237">The package has a .zip file with all the files and metadata required to install a site in IIS.</span></span>
* <span data-ttu-id="69916-238">Vytvořte balíček pro nasazení a nainstalujte ho pomocí příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="69916-238">Create a deployment package and install it using the command line.</span></span>

<span data-ttu-id="69916-239">Proces, který jste provedli v předchozích kurzech k nastavení sady Visual Studio pro automatizaci úloh nasazení, se vztahuje na všechny tyto metody.</span><span class="sxs-lookup"><span data-stu-id="69916-239">The process you went through in the previous tutorials to set up Visual Studio to automate deployment tasks applies to all of these methods.</span></span> <span data-ttu-id="69916-240">V těchto kurzech použijete první dvě metody.</span><span class="sxs-lookup"><span data-stu-id="69916-240">In these tutorials, you'll use the first two methods.</span></span> <span data-ttu-id="69916-241">Informace o použití balíčků pro nasazení najdete v tématu [nasazení webové aplikace vytvořením a instalací balíčku pro nasazení](https://go.microsoft.com/fwlink/p/?LinkId=282413#package) webu v mapě obsahu nasazení webu pro Visual Studio a ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="69916-241">For information about using deployment packages, see [Deploying a web application by creating and installing a web deployment package](https://go.microsoft.com/fwlink/p/?LinkId=282413#package) in the Web Deployment Content Map for Visual Studio and ASP.NET.</span></span>

<span data-ttu-id="69916-242">Před publikováním se ujistěte, že používáte aplikaci Visual Studio v režimu správce.</span><span class="sxs-lookup"><span data-stu-id="69916-242">Before publishing, make sure that you're running Visual Studio in administrator mode.</span></span> <span data-ttu-id="69916-243">Pokud v záhlaví nevidíte **(správce)** , zavřete Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="69916-243">If you don't see **(Administrator)** in the title bar, close Visual Studio.</span></span> <span data-ttu-id="69916-244">Na **úvodní** stránce Windows 8 (nebo novější) nebo v nabídce **Start** systému Windows 7 klikněte pravým tlačítkem myši na ikonu sady Visual Studio a vyberte možnost **Spustit jako správce**.</span><span class="sxs-lookup"><span data-stu-id="69916-244">In the Windows 8 (or later) **Start** page or the Windows 7 **Start** menu, right-click the Visual Studio icon and select **Run as Administrator**.</span></span> <span data-ttu-id="69916-245">Režim správce je vyžadován pouze k publikování při publikování do služby IIS v místním počítači.</span><span class="sxs-lookup"><span data-stu-id="69916-245">Administrator mode is only required for publishing when you're publishing to IIS on the local computer.</span></span>

### <a name="create-the-publish-profile"></a><span data-ttu-id="69916-246">Vytvořit profil publikování</span><span class="sxs-lookup"><span data-stu-id="69916-246">Create the publish profile</span></span>

1. <span data-ttu-id="69916-247">V **Průzkumník řešení**klikněte pravým tlačítkem myši na projekt **ContosoUniversity** (ne na projekt **ContosoUniversity. dal** ).</span><span class="sxs-lookup"><span data-stu-id="69916-247">In **Solution Explorer**, right-click the **ContosoUniversity** project (not the **ContosoUniversity.DAL** project).</span></span> <span data-ttu-id="69916-248">Vyberte **Publikovat**.</span><span class="sxs-lookup"><span data-stu-id="69916-248">Select **Publish**.</span></span> <span data-ttu-id="69916-249">Zobrazí se stránka **publikování** .</span><span class="sxs-lookup"><span data-stu-id="69916-249">The **Publish** page appears.</span></span>

2. <span data-ttu-id="69916-250">Vyberte **Nový profil**.</span><span class="sxs-lookup"><span data-stu-id="69916-250">Select **New Profile**.</span></span> <span data-ttu-id="69916-251">Zobrazí se dialogové okno **vybrat cíl publikování** .</span><span class="sxs-lookup"><span data-stu-id="69916-251">The **Pick a publish target** dialog box appears.</span></span>

3. <span data-ttu-id="69916-252">Vyberte **IIS, FTP atd**. Vyberte **vytvořit profil**.</span><span class="sxs-lookup"><span data-stu-id="69916-252">Select **IIS, FTP, etc**. Select **Create Profile**.</span></span> <span data-ttu-id="69916-253">Zobrazí se průvodce **publikováním** .</span><span class="sxs-lookup"><span data-stu-id="69916-253">The **Publish** wizard appears.</span></span>

   ![Karta profil Průvodce publikováním webu](deploying-to-iis/_static/image26.png)

4. <span data-ttu-id="69916-255">V rozevírací nabídce **Metoda publikování** vyberte možnost **nasazení webu**.</span><span class="sxs-lookup"><span data-stu-id="69916-255">From the **Publish method** drop-down menu, select **Web Deploy**.</span></span>

5. <span data-ttu-id="69916-256">Jako **Server**zadejte *localhost*.</span><span class="sxs-lookup"><span data-stu-id="69916-256">For **Server**, enter *localhost*.</span></span>

6. <span data-ttu-id="69916-257">Jako **název lokality**zadejte *Default Web site/ContosoUniversity*.</span><span class="sxs-lookup"><span data-stu-id="69916-257">For **Site name**, enter *Default Web Site/ContosoUniversity*.</span></span>

7. <span data-ttu-id="69916-258">Jako **cílovou adresu URL**zadejte *http://localhost/ContosoUniversity* .</span><span class="sxs-lookup"><span data-stu-id="69916-258">For **Destination URL**, enter *http://localhost/ContosoUniversity*.</span></span>

   <span data-ttu-id="69916-259">Nastavení **cílové adresy URL** není vyžadováno.</span><span class="sxs-lookup"><span data-stu-id="69916-259">The **Destination URL** setting isn't required.</span></span> <span data-ttu-id="69916-260">Když Visual Studio dokončí nasazení aplikace, automaticky otevře výchozí prohlížeč na této adrese URL.</span><span class="sxs-lookup"><span data-stu-id="69916-260">When Visual Studio finishes deploying the application, it automatically opens your default browser to this URL.</span></span> <span data-ttu-id="69916-261">Pokud nechcete, aby se prohlížeč po nasazení otevřel automaticky, nechejte toto pole prázdné.</span><span class="sxs-lookup"><span data-stu-id="69916-261">If you don't want the browser to open automatically after deployment, leave this box blank.</span></span>

8. <span data-ttu-id="69916-262">Vyberte **ověřit připojení** , abyste ověřili, že jsou nastavení správná, a můžete se připojit ke službě IIS v místním počítači.</span><span class="sxs-lookup"><span data-stu-id="69916-262">Select **Validate Connection** to verify that the settings are correct and you can connect to IIS on the local computer.</span></span>

   <span data-ttu-id="69916-263">Zelená značka zaškrtnutí ověří, že připojení proběhlo úspěšně.</span><span class="sxs-lookup"><span data-stu-id="69916-263">A green check mark verifies that the connection is successful.</span></span>

   ![Karta pro připojení Průvodce publikováním webu](deploying-to-iis/_static/image27.png)

9. <span data-ttu-id="69916-265">Kliknutím na tlačítko **Další** přejdete na kartu **Nastavení** .</span><span class="sxs-lookup"><span data-stu-id="69916-265">Select **Next** to advance to the **Settings** tab.</span></span>

10. <span data-ttu-id="69916-266">Rozevírací seznam **Konfigurace** určuje konfiguraci sestavení, která se má nasadit.</span><span class="sxs-lookup"><span data-stu-id="69916-266">The **Configuration** drop-down box specifies the build configuration to deploy.</span></span> <span data-ttu-id="69916-267">Nechte nastavenou na výchozí hodnotu **vydaná verze**.</span><span class="sxs-lookup"><span data-stu-id="69916-267">Leave it set to the default value of **Release**.</span></span> <span data-ttu-id="69916-268">V tomto kurzu nebudete nasazovat sestavení pro ladění.</span><span class="sxs-lookup"><span data-stu-id="69916-268">You won't be deploying Debug builds in this tutorial.</span></span>

11. <span data-ttu-id="69916-269">Rozbalte položku **Možnosti publikování souboru**.</span><span class="sxs-lookup"><span data-stu-id="69916-269">Expand **File Publish Options**.</span></span> <span data-ttu-id="69916-270">Vyberte **vyloučit soubory ze složky\_dat aplikace**.</span><span class="sxs-lookup"><span data-stu-id="69916-270">Select **Exclude files from the App\_Data folder**.</span></span>

    <span data-ttu-id="69916-271">V testovacím prostředí aplikace přistupuje k databázím, které jste vytvořili v místní instanci SQL Server Express, nikoli v souborech MDF ve složce *App\_data* .</span><span class="sxs-lookup"><span data-stu-id="69916-271">In the test environment, the application accesses the databases that you created in the local SQL Server Express instance, not the .mdf files in the *App\_Data* folder.</span></span>

12. <span data-ttu-id="69916-272">Nechte **předkompilovat během publikování** a zrušte zaškrtnutí políček **odebrat další soubory v cílovém umístění** .</span><span class="sxs-lookup"><span data-stu-id="69916-272">Leave the **Precompile during publishing** and **Remove additional files at destination** check boxes cleared.</span></span>

    ![Možnosti publikování souboru na kartě nastavení](deploying-to-iis/_static/image15a.png)

    <span data-ttu-id="69916-274">Předkompilace je možnost, která je užitečná hlavně pro velké weby.</span><span class="sxs-lookup"><span data-stu-id="69916-274">Precompiling is an option that is useful mainly for large sites.</span></span> <span data-ttu-id="69916-275">Může zkrátit čas spuštění při prvním vyžádání stránky po publikování webu.</span><span class="sxs-lookup"><span data-stu-id="69916-275">It can reduce startup time the first time a page is requested after the site is published.</span></span>

    <span data-ttu-id="69916-276">Nemusíte odebírat další soubory, protože se jedná o vaše první nasazení a zatím neexistují žádné soubory v cílové složce.</span><span class="sxs-lookup"><span data-stu-id="69916-276">You don't need to remove additional files since this is your first deployment and there won't be any files in the destination folder yet.</span></span>

    > [!NOTE] 
    > <span data-ttu-id="69916-277">Pokud pro následné nasazení na stejnou lokalitu vyberete možnost **odebrat další soubory v cíli** , ujistěte se, že jste používali funkci Preview, abyste viděli, které soubory se před nasazením odstraní.</span><span class="sxs-lookup"><span data-stu-id="69916-277">If you select **Remove additional files at destination** for a subsequent deployment to the same site, make sure that you use the preview feature so that you see in advance which files will be deleted before you deploy.</span></span> <span data-ttu-id="69916-278">Očekávané chování je, že Nasazení webu odstraní soubory na cílovém serveru, který jste odstranili v projektu.</span><span class="sxs-lookup"><span data-stu-id="69916-278">The expected behavior is that Web Deploy will delete files on the destination server that you have deleted in your project.</span></span> <span data-ttu-id="69916-279">Porovnává se ale celá struktura složek ve zdrojové a cílové složce. a v některých případech může Nasazení webu odstranit soubory, které nechcete odstranit.</span><span class="sxs-lookup"><span data-stu-id="69916-279">However, the entire folder structure under the source and destination folders is compared; and in some scenarios, Web Deploy might delete files you don't want to delete.</span></span>
    > 
    > <span data-ttu-id="69916-280">Například pokud máte webovou aplikaci v podsložce na serveru, když nasadíte projekt do kořenové složky, podsložka bude odstraněna.</span><span class="sxs-lookup"><span data-stu-id="69916-280">For example if you have a web application in a subfolder on the server when you deploy a project to the root folder, the subfolder will be deleted.</span></span> <span data-ttu-id="69916-281">Můžete mít jeden projekt pro hlavní web na contoso.com a jiný projekt pro blog na contoso.com/blog.</span><span class="sxs-lookup"><span data-stu-id="69916-281">You might have one project for the main site at contoso.com and another project for a blog at contoso.com/blog.</span></span> <span data-ttu-id="69916-282">Aplikace blogu je v podsložce.</span><span class="sxs-lookup"><span data-stu-id="69916-282">The blog application is in a subfolder.</span></span> <span data-ttu-id="69916-283">Pokud při nasazení hlavní lokality vyberete možnost **odebrat další soubory v cíli** , aplikace blogu se odstraní.</span><span class="sxs-lookup"><span data-stu-id="69916-283">If you select **Remove additional files at destination** when you deploy the main site, the blog application will be deleted.</span></span>
    > 
    > <span data-ttu-id="69916-284">Pro jiný příklad se může stát, že se vaše aplikace\_datovou složku neočekávaně odstranila.</span><span class="sxs-lookup"><span data-stu-id="69916-284">For another example, your App\_Data folder might get deleted unexpectedly.</span></span> <span data-ttu-id="69916-285">Některé databáze, například soubory databáze SQL Server Compact Store ve složce App\_data.</span><span class="sxs-lookup"><span data-stu-id="69916-285">Certain databases such as SQL Server Compact store database files in the App\_Data folder.</span></span> <span data-ttu-id="69916-286">Po počátečním nasazení nechcete uchovávat soubory databáze v následných nasazeních, takže vyberete **vyloučit aplikace\_data** na kartě Balení/publikování webu. Pokud jste vybrali možnost **odebrat další soubory v cílovém umístění** , vaše soubory databáze a aplikace\_data samotné se odstraní při příštím publikování.</span><span class="sxs-lookup"><span data-stu-id="69916-286">After the initial deployment, you don't want to keep copying the database files in subsequent deployments, so you select  **Exclude App\_Data** on the Package/Publish Web tab. After you do that if you have **Remove additional files at destination** selected, your database files and the App\_Data folder itself will be deleted the next time you publish.</span></span>

### <a name="configure-deployment-for-the-membership-database"></a><span data-ttu-id="69916-287">Konfigurace nasazení pro databázi členství</span><span class="sxs-lookup"><span data-stu-id="69916-287">Configure deployment for the membership database</span></span>

<span data-ttu-id="69916-288">Následující postup platí pro databázi **DefaultConnection** v části **databáze** dialogového okna.</span><span class="sxs-lookup"><span data-stu-id="69916-288">The following steps apply to the **DefaultConnection** database in the dialog box's **Databases** section.</span></span>

1. <span data-ttu-id="69916-289">Do pole **řetězec vzdáleného připojení** zadejte následující připojovací řetězec, který odkazuje na novou SQL Server Express databázi členství.</span><span class="sxs-lookup"><span data-stu-id="69916-289">In the **Remote connection string** box, enter the following connection string that points to the new SQL Server Express membership database.</span></span>

   [!code-console[Main](deploying-to-iis/samples/sample3.cmd)]

   <span data-ttu-id="69916-290">Proces nasazení vloží tento připojovací řetězec do nasazeného souboru Web. config, protože je vybrán **použít tento připojovací řetězec za běhu** .</span><span class="sxs-lookup"><span data-stu-id="69916-290">The deployment process puts this connection string in the deployed Web.config file because **Use this connection string at runtime** is selected.</span></span>

    <span data-ttu-id="69916-291">Připojovací řetězec můžete také získat z **Průzkumník serveru**.</span><span class="sxs-lookup"><span data-stu-id="69916-291">You can also get the connection string from **Server Explorer**.</span></span> <span data-ttu-id="69916-292">V **Průzkumník serveru**rozbalte **datová připojení** a vyberte **&lt;nazev_pocitace&gt;\SQLExpress.ASPNET-ContosoUniversity** databázi a potom v okně **vlastnosti** Zkopírujte hodnotu **připojovacího řetězce** .</span><span class="sxs-lookup"><span data-stu-id="69916-292">In **Server Explorer**, expand **Data Connections** and select the **&lt;machinename&gt;\sqlexpress.aspnet-ContosoUniversity** database, then from the **Properties** window copy the **Connection String** value.</span></span> <span data-ttu-id="69916-293">Tento připojovací řetězec bude mít jedno další nastavení, které můžete odstranit: `Pooling=False`.</span><span class="sxs-lookup"><span data-stu-id="69916-293">That connection string will have one additional setting that you can delete: `Pooling=False`.</span></span>

2. <span data-ttu-id="69916-294">Vyberte **aktualizovat databázi**.</span><span class="sxs-lookup"><span data-stu-id="69916-294">Select **Update database**.</span></span>

   <span data-ttu-id="69916-295">Tím dojde k vytvoření schématu databáze v cílové databázi během nasazování.</span><span class="sxs-lookup"><span data-stu-id="69916-295">This causes the database schema to be created in the destination database during deployment.</span></span> <span data-ttu-id="69916-296">V části Další kroky zadáte další skripty, které je třeba spustit: jeden pro udělení přístupu k databázi výchozímu fondu aplikací a jeden pro nasazení dat.</span><span class="sxs-lookup"><span data-stu-id="69916-296">In next steps, you specify the additional scripts that you need to run: one to grant database access to the default application pool and one to deploy data.</span></span>

3. <span data-ttu-id="69916-297">Vyberte **Konfigurovat aktualizace databáze**.</span><span class="sxs-lookup"><span data-stu-id="69916-297">Select **Configure database updates**.</span></span>
 
4. <span data-ttu-id="69916-298">V dialogovém okně **Konfigurovat aktualizace databáze** vyberte **Přidat skript SQL**.</span><span class="sxs-lookup"><span data-stu-id="69916-298">In the **Configure Database Updates** dialog box, select **Add SQL Script**.</span></span> <span data-ttu-id="69916-299">Přejděte do skriptu *grant. SQL* , který jste předtím uložili ve složce řešení.</span><span class="sxs-lookup"><span data-stu-id="69916-299">Navigate to the *Grant.sql* script that you saved earlier in the solution folder.</span></span>

5. <span data-ttu-id="69916-300">Opakujte postup pro přidání skriptu *ASPNET-data-dev. SQL* .</span><span class="sxs-lookup"><span data-stu-id="69916-300">Repeat the process to add the *aspnet-data-dev.sql* script.</span></span>

   ![Konfigurace aktualizací databáze pro databázi členství](deploying-to-iis/_static/image16.png)

6. <span data-ttu-id="69916-302">Vyberte **Zavřít**.</span><span class="sxs-lookup"><span data-stu-id="69916-302">Select **Close**.</span></span>

### <a name="configure-deployment-for-the-application-database"></a><span data-ttu-id="69916-303">Konfigurace nasazení pro databázi aplikace</span><span class="sxs-lookup"><span data-stu-id="69916-303">Configure deployment for the application database</span></span>

<span data-ttu-id="69916-304">Když aplikace Visual Studio zjistí třídu Entity Framework `DbContext`, vytvoří položku v sekci **databáze** , která má zaškrtávací políčko **Spustit migrace Code First** místo zaškrtávacího políčka **databáze aktualizace** .</span><span class="sxs-lookup"><span data-stu-id="69916-304">When Visual Studio detects an Entity Framework `DbContext` class, it creates an entry in the **Databases** section that has an **Execute Code First Migrations** check box instead of an **Update Database** check box.</span></span> <span data-ttu-id="69916-305">V tomto kurzu použijete toto zaškrtávací políčko k určení Migrace Code Firstho nasazení.</span><span class="sxs-lookup"><span data-stu-id="69916-305">For this tutorial, you'll use that check box to specify Code First Migrations deployment.</span></span>

<span data-ttu-id="69916-306">V některých scénářích můžete použít databázi `DbContext`, ale chcete použít poskytovatele dbDacFx místo migrace k nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="69916-306">In some scenarios, you might be using a `DbContext` database but you want to use the dbDacFx provider instead of Migrations to deploy the database.</span></span> <span data-ttu-id="69916-307">V takovém případě si přečtěte téma [návody nasazení Code First databáze bez migrace?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) v nejčastějších dotazech k nasazení webu ASP.NET na webu MSDN.</span><span class="sxs-lookup"><span data-stu-id="69916-307">In that case, see [How do I deploy a Code First database without Migrations?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) in the ASP.NET Web Deployment FAQ on MSDN.</span></span>

<span data-ttu-id="69916-308">Následující postup platí pro databázi **SchoolContext** v části **databáze** dialogového okna.</span><span class="sxs-lookup"><span data-stu-id="69916-308">The following steps apply to the **SchoolContext** database in the dialog box's **Databases** section.</span></span>

1. <span data-ttu-id="69916-309">Do pole **řetězec vzdáleného připojení** zadejte následující připojovací řetězec, který odkazuje na novou SQL Server Express aplikační databázi.</span><span class="sxs-lookup"><span data-stu-id="69916-309">In the **Remote connection string** box, enter the following connection string that points to the new SQL Server Express application database.</span></span>

   [!code-console[Main](deploying-to-iis/samples/sample4.cmd)]

   <span data-ttu-id="69916-310">Proces nasazení vloží tento připojovací řetězec do nasazeného souboru Web. config, protože je vybrán **použít tento připojovací řetězec za běhu** .</span><span class="sxs-lookup"><span data-stu-id="69916-310">The deployment process puts this connection string in the deployed Web.config file because **Use this connection string at runtime** is selected.</span></span>

   <span data-ttu-id="69916-311">Připojovací řetězec aplikační databáze můžete také získat z **Průzkumník serveru** stejným způsobem jako připojovací řetězec databáze členství.</span><span class="sxs-lookup"><span data-stu-id="69916-311">You can also get the application database connection string from **Server Explorer** in the same way you got the membership database connection string.</span></span>

2. <span data-ttu-id="69916-312">Vyberte **Execute migrace Code First (spouští se při spuštění aplikace)** .</span><span class="sxs-lookup"><span data-stu-id="69916-312">Select **Execute Code First Migrations (runs on application start)**.</span></span>

   <span data-ttu-id="69916-313">Tato možnost způsobí, že proces nasazení nakonfiguruje nasazený soubor Web. config a určí `MigrateDatabaseToLatestVersion` inicializátor.</span><span class="sxs-lookup"><span data-stu-id="69916-313">This option causes the deployment process to configure the deployed Web.config file to specify the `MigrateDatabaseToLatestVersion` initializer.</span></span> <span data-ttu-id="69916-314">Tento inicializátor automaticky aktualizuje databázi na nejnovější verzi, když aplikace přistupuje k databázi poprvé po nasazení.</span><span class="sxs-lookup"><span data-stu-id="69916-314">This initializer automatically updates the database to the latest version when the application accesses the database for the first time after deployment.</span></span>

### <a name="configure-publish-profile-transforms"></a><span data-ttu-id="69916-315">Konfigurace transformací profilů publikování</span><span class="sxs-lookup"><span data-stu-id="69916-315">Configure publish profile transforms</span></span>

1. <span data-ttu-id="69916-316">Vyberte **Zavřít**.</span><span class="sxs-lookup"><span data-stu-id="69916-316">Select **Close**.</span></span> <span data-ttu-id="69916-317">Když se zobrazí dotaz, jestli chcete změny uložit, vyberte **Ano** .</span><span class="sxs-lookup"><span data-stu-id="69916-317">Select **Yes** when you are asked if you want to save changes.</span></span>

2. <span data-ttu-id="69916-318">V **Průzkumník řešení**rozbalte položku **vlastnosti**a pak rozbalte **PublishProfiles**.</span><span class="sxs-lookup"><span data-stu-id="69916-318">In **Solution Explorer**, expand **Properties**, expand **PublishProfiles**.</span></span>

3. <span data-ttu-id="69916-319">Klikněte pravým tlačítkem na *CustomProfile. pubxml* a přejmenujte ho *test. pubxml*.</span><span class="sxs-lookup"><span data-stu-id="69916-319">Right-click *CustomProfile.pubxml* and rename it *Test.pubxml*.</span></span>

4. <span data-ttu-id="69916-320">Klikněte pravým tlačítkem na *test. pubxml*.</span><span class="sxs-lookup"><span data-stu-id="69916-320">Right-click *Test.pubxml*.</span></span> <span data-ttu-id="69916-321">Vyberte **přidat konfigurační transformaci**.</span><span class="sxs-lookup"><span data-stu-id="69916-321">Select **Add Config Transform**.</span></span>

   ![Přidat konfigurační nabídku pro transformaci](deploying-to-iis/_static/image17.png)

   <span data-ttu-id="69916-323">Visual Studio vytvoří transformační soubor *Web. test. config* a otevře jej.</span><span class="sxs-lookup"><span data-stu-id="69916-323">Visual Studio creates the *Web.Test.config* transform file and opens it.</span></span>

5. <span data-ttu-id="69916-324">V transformačním souboru *Web. test. config* vložte následující kód hned za úvodní značku konfigurace.</span><span class="sxs-lookup"><span data-stu-id="69916-324">In the *Web.Test.config* transform file, insert the following code immediately after the opening configuration tag.</span></span>

   [!code-xml[Main](deploying-to-iis/samples/sample5.xml)]

    <span data-ttu-id="69916-325">Když použijete profil publikování testu, tato transformace nastaví indikátor prostředí na "test".</span><span class="sxs-lookup"><span data-stu-id="69916-325">When you use the Test publish profile, this transform sets the environment indicator to "Test".</span></span> <span data-ttu-id="69916-326">V nasazeném webu uvidíte "(test)" za nadpisem "contoso University" H1.</span><span class="sxs-lookup"><span data-stu-id="69916-326">In the deployed site, you'll see "(Test)" after the "Contoso University" H1 heading.</span></span>

6. <span data-ttu-id="69916-327">Uložte soubor a zavřete ho.</span><span class="sxs-lookup"><span data-stu-id="69916-327">Save and close the file.</span></span>

7. <span data-ttu-id="69916-328">Klikněte pravým tlačítkem myši na soubor *Web. test. config* a vyberte možnost **Náhled transformace** , abyste se ujistili, že transformace, kterou jste zakódujete, poskytuje očekávané změny.</span><span class="sxs-lookup"><span data-stu-id="69916-328">Right-click the *Web.Test.config* file and select **Preview Transform** to make sure that the transform you coded produces the expected changes.</span></span>

    <span data-ttu-id="69916-329">V okně **Náhled Web. config** se zobrazí výsledek použití transformací *Web. Release. config* a transformací *Web. test. config* .</span><span class="sxs-lookup"><span data-stu-id="69916-329">The **Web.config Preview** window shows the result of applying both the *Web.Release.config* transforms and the *Web.Test.config* transforms.</span></span>

### <a name="preview-the-deployment-updates"></a><span data-ttu-id="69916-330">Náhled aktualizací nasazení</span><span class="sxs-lookup"><span data-stu-id="69916-330">Preview the deployment updates</span></span>

1. <span data-ttu-id="69916-331">Znovu spusťte průvodce **publikováním webu** (klikněte pravým tlačítkem myši na projekt ContosoUniversity, vyberte **publikovat**a pak na **Náhled**).</span><span class="sxs-lookup"><span data-stu-id="69916-331">Open the **Publish Web** wizard again (right-click the ContosoUniversity project, select **Publish**, then **Preview**).</span></span>

2. <span data-ttu-id="69916-332">V dialogovém okně **Náhled** vyberte možnost **Spustit náhled** , chcete-li zobrazit seznam souborů, které budou zkopírovány.</span><span class="sxs-lookup"><span data-stu-id="69916-332">In the **Preview** dialog box, select **Start Preview** to see a list of the files that will be copied.</span></span> 

   ![Publikování náhledu](deploying-to-iis/_static/image29.png)

   <span data-ttu-id="69916-334">Můžete také vybrat odkaz **databáze verze Preview** a zobrazit skripty, které se spustí v databázi členství.</span><span class="sxs-lookup"><span data-stu-id="69916-334">You can also select the **Preview database** link to see the scripts that will run in the membership database.</span></span> <span data-ttu-id="69916-335">(Nejsou spouštěny žádné skripty pro nasazení Migrace Code First, takže není k dispozici žádné zobrazení databáze aplikace.)</span><span class="sxs-lookup"><span data-stu-id="69916-335">(No scripts are run for Code First Migrations deployment, so there's nothing to preview for the application database.)</span></span>

3. <span data-ttu-id="69916-336">Vyberte **Publikovat**.</span><span class="sxs-lookup"><span data-stu-id="69916-336">Select **Publish**.</span></span>

   <span data-ttu-id="69916-337">Pokud Visual Studio není v režimu správce, může se zobrazit chybová zpráva s oprávněním.</span><span class="sxs-lookup"><span data-stu-id="69916-337">If Visual Studio is not in administrator mode, you might get a permissions error message.</span></span> <span data-ttu-id="69916-338">V takovém případě zavřete Visual Studio, otevřete ho v režimu správce a zkuste publikování znovu.</span><span class="sxs-lookup"><span data-stu-id="69916-338">In that case, close Visual Studio, open it in administrator mode, and try to publish again.</span></span>

   <span data-ttu-id="69916-339">Pokud je Visual Studio v režimu správce, okno **výstup** sestavy úspěšné sestavení a publikování.</span><span class="sxs-lookup"><span data-stu-id="69916-339">If Visual Studio is in administrator mode, the **Output** window reports successful build and publish.</span></span>

   ![Output_window_publish_Test](deploying-to-iis/_static/image20.png)

   <span data-ttu-id="69916-341">Pokud jste zadali adresu URL do pole **cílová adresa URL** na kartě **připojení** profilu publikování, prohlížeč se automaticky otevře na domovské stránce společnosti Contoso University běžící ve službě IIS na vašem počítači.</span><span class="sxs-lookup"><span data-stu-id="69916-341">If you entered the URL in the **Destination URL** box on the publish profile **Connection** tab, the browser automatically opens to the Contoso University Home page running in IIS on your computer.</span></span>

## <a name="test-in-the-test-environment"></a><span data-ttu-id="69916-342">Testování v testovacím prostředí</span><span class="sxs-lookup"><span data-stu-id="69916-342">Test in the test environment</span></span>

<span data-ttu-id="69916-343">Všimněte si, že indikátor prostředí zobrazuje "(test)" místo "(dev)", což ukazuje, že transformace *Web. config* pro indikátor prostředí byla úspěšná.</span><span class="sxs-lookup"><span data-stu-id="69916-343">Notice that the environment indicator shows "(Test)" instead of "(Dev)," which shows that the *Web.config* transformation for the environment indicator was successful.</span></span>

<span data-ttu-id="69916-344">Spuštěním stránky **instruktory** ověřte, zda Code First dosazení databáze s daty instruktory.</span><span class="sxs-lookup"><span data-stu-id="69916-344">Run the **Instructors** page to verify that Code First seeded the database with instructor data.</span></span> <span data-ttu-id="69916-345">Když vyberete tuto stránku, může trvat několik minut, než se načtou, protože Code First vytvoří databázi a potom spustí metodu `Seed`.</span><span class="sxs-lookup"><span data-stu-id="69916-345">When you select this page, it may take a few minutes to load because Code First creates the database and then runs the `Seed` method.</span></span> <span data-ttu-id="69916-346">(Neudělal to, když jste na domovské stránce, protože aplikace se ještě nepokoušela o přístup k databázi.)</span><span class="sxs-lookup"><span data-stu-id="69916-346">(It didn't do that when you were on the home page because the application didn't try to access the database yet.)</span></span>

<span data-ttu-id="69916-347">Vyberte kartu **studenti** a ověřte, zda nasazená databáze nemá žádné studenty.</span><span class="sxs-lookup"><span data-stu-id="69916-347">Select the **Students** tab to verify that the deployed database has no students.</span></span>

<span data-ttu-id="69916-348">V nabídce **Students** vyberte **Přidat studenty** .</span><span class="sxs-lookup"><span data-stu-id="69916-348">Select **Add Students** from the **Students** menu.</span></span> <span data-ttu-id="69916-349">Přidejte studenta a pak na stránce **Students** Zobrazte nového studenta.</span><span class="sxs-lookup"><span data-stu-id="69916-349">Add a student, and then view the new student in the **Students** page.</span></span> <span data-ttu-id="69916-350">Tím ověříte, že můžete úspěšně zapisovat do databáze.</span><span class="sxs-lookup"><span data-stu-id="69916-350">This verifies that you can successfully write to the database.</span></span>

<span data-ttu-id="69916-351">V nabídce **kurzy** vyberte **aktualizovat kredity**.</span><span class="sxs-lookup"><span data-stu-id="69916-351">From the **Courses** menu, select **Update Credits**.</span></span> <span data-ttu-id="69916-352">Stránka **aktualizovat kredity** vyžaduje oprávnění správce, aby se zobrazila stránka pro **přihlášení** .</span><span class="sxs-lookup"><span data-stu-id="69916-352">The **Update Credits** page requires administrator permissions, so the **Log In** page is displayed.</span></span> <span data-ttu-id="69916-353">Zadejte přihlašovací údaje účtu správce, které jste vytvořili dříve ("admin" a "devpwd").</span><span class="sxs-lookup"><span data-stu-id="69916-353">Enter the administrator account credentials that you created earlier ("admin" and "devpwd").</span></span> <span data-ttu-id="69916-354">Zobrazí se stránka **aktualizovat kredity** .</span><span class="sxs-lookup"><span data-stu-id="69916-354">The **Update Credits** page is displayed.</span></span> <span data-ttu-id="69916-355">Tím ověříte, že účet správce, který jste vytvořili v předchozím kurzu, byl správně nasazen do testovacího prostředí.</span><span class="sxs-lookup"><span data-stu-id="69916-355">This verifies that the administrator account that you created in the previous tutorial was correctly deployed to the test environment.</span></span>

<span data-ttu-id="69916-356">Ověřte, že složka *knihovny elmah* ve složce *c:\inetpub\wwwroot\ContosoUniversity* existuje pouze s zástupným souborem.</span><span class="sxs-lookup"><span data-stu-id="69916-356">Verify that an *ELMAH* folder exists in the *c:\inetpub\wwwroot\ContosoUniversity* folder with only the placeholder file in it.</span></span>

<a id="reviewingmigrations"></a>

## <a name="review-the-automatic-webconfig-changes-for-code-first-migrations"></a><span data-ttu-id="69916-357">Zkontrolujte automatické změny souboru Web. config pro Migrace Code First</span><span class="sxs-lookup"><span data-stu-id="69916-357">Review the automatic Web.config changes for Code First Migrations</span></span>

<span data-ttu-id="69916-358">Otevřete soubor *Web. config* v nasazené aplikaci na adrese *C:\inetpub\wwwroot\ContosoUniversity* a můžete zjistit, kde se proces nasazení nakonfiguroval migrace Code First k automatické aktualizaci databáze na nejnovější verzi.</span><span class="sxs-lookup"><span data-stu-id="69916-358">Open the *Web.config* file in the deployed application at *C:\inetpub\wwwroot\ContosoUniversity* and you can see where the deployment process configured Code First Migrations to automatically update the database to the latest version.</span></span>

![](deploying-to-iis/_static/image21.png)

<span data-ttu-id="69916-359">Proces nasazení také vytvořil nový připojovací řetězec pro Migrace Code First pro použití výhradně pro aktualizaci schématu databáze:</span><span class="sxs-lookup"><span data-stu-id="69916-359">The deployment process also created a new connection string for Code First Migrations to use exclusively for updating the database schema:</span></span>

![Připojovací řetězec Database_Publish](deploying-to-iis/_static/image22.png)

<span data-ttu-id="69916-361">Tento dodatečný připojovací řetězec umožňuje zadat jeden uživatelský účet pro aktualizace schématu databáze a jiný uživatelský účet pro přístup k datům aplikací.</span><span class="sxs-lookup"><span data-stu-id="69916-361">This additional connection string enables you to specify one user account for database schema updates and a different user account for application data access.</span></span> <span data-ttu-id="69916-362">Můžete například přiřadit roli **vlastníka databáze\_** migrace Code First a **DB\_DataReader** s DB\_rolemi **datawrite** do aplikace.</span><span class="sxs-lookup"><span data-stu-id="69916-362">For example, you could assign the **db\_owner** role to Code First Migrations and **db\_datareader** with **db\_datawriter** roles to the application.</span></span> <span data-ttu-id="69916-363">Jedná se o běžný způsob obrany, který brání potenciálně škodlivému kódu v aplikaci ve změně schématu databáze.</span><span class="sxs-lookup"><span data-stu-id="69916-363">This is a common defense-in-depth pattern that prevents potentially malicious code in the application from changing the database schema.</span></span> <span data-ttu-id="69916-364">(K tomu může dojít například při úspěšném útoku injektáže SQL.) Tyto kurzy tento model nepoužívají.</span><span class="sxs-lookup"><span data-stu-id="69916-364">(For example, this might happen in a successful SQL injection attack.) These tutorials don't use this pattern.</span></span> <span data-ttu-id="69916-365">K implementaci tohoto modelu ve vašem scénáři proveďte tyto kroky:</span><span class="sxs-lookup"><span data-stu-id="69916-365">To implement this pattern in your scenario, take these steps:</span></span>

1. <span data-ttu-id="69916-366">V průvodci **publikování webu** na kartě **Nastavení** zadejte připojovací řetězec, který určuje uživatele s úplnými oprávněními pro aktualizaci schématu databáze.</span><span class="sxs-lookup"><span data-stu-id="69916-366">In the **Publish Web** wizard under the **Settings** tab, enter the connection string that specifies a user with full database schema update permissions.</span></span> <span data-ttu-id="69916-367">Zrušte zaškrtnutí políčka **použít tento připojovací řetězec za běhu** .</span><span class="sxs-lookup"><span data-stu-id="69916-367">Clear the **Use this connection string at runtime** check box.</span></span> <span data-ttu-id="69916-368">V nasazeném souboru Web. config se jedná o `DatabasePublish` připojovací řetězec.</span><span class="sxs-lookup"><span data-stu-id="69916-368">In the deployed Web.config file, this becomes the `DatabasePublish` connection string.</span></span>

2. <span data-ttu-id="69916-369">Vytvořte transformaci souboru Web. config pro připojovací řetězec, který má aplikace používat v době běhu.</span><span class="sxs-lookup"><span data-stu-id="69916-369">Create a Web.config file transformation for the connection string that you want the application to use at run time.</span></span>

## <a name="summary"></a><span data-ttu-id="69916-370">Souhrn</span><span class="sxs-lookup"><span data-stu-id="69916-370">Summary</span></span>

<span data-ttu-id="69916-371">Nyní jste nasadili aplikaci do služby IIS na vývojovém počítači a otestovali ji.</span><span class="sxs-lookup"><span data-stu-id="69916-371">You've now deployed your application to IIS on your development computer and tested it there.</span></span>

![Domovská stránka v testu](deploying-to-iis/_static/image23.png)

<span data-ttu-id="69916-373">Tím se ověří, že proces nasazení zkopíroval obsah aplikace do správného umístění (kromě souborů, které jste nechtěli nasadit), a taky to, že Nasazení webu nakonfigurovaná služba IIS během nasazení správně.</span><span class="sxs-lookup"><span data-stu-id="69916-373">This verifies that the deployment process copied the application's content to the right location (excluding the files that you did not want to deploy) and also that Web Deploy configured IIS correctly during deployment.</span></span> <span data-ttu-id="69916-374">V dalším kurzu spustíte ještě jeden test, který najde úlohu nasazení, která ještě není hotová: nastavení oprávnění složky ve složce *Elm Ah* .</span><span class="sxs-lookup"><span data-stu-id="69916-374">In the next tutorial, you'll run one more test that finds a deployment task that has not yet been done: setting folder permissions on the *Elm ah* folder.</span></span>

## <a name="more-information"></a><span data-ttu-id="69916-375">Další informace</span><span class="sxs-lookup"><span data-stu-id="69916-375">More information</span></span>

<span data-ttu-id="69916-376">Informace o spuštění služby IIS nebo IIS Express v aplikaci Visual Studio naleznete v následujících zdrojích informací:</span><span class="sxs-lookup"><span data-stu-id="69916-376">For information about running IIS or IIS Express in Visual Studio, see the following resources:</span></span>

- <span data-ttu-id="69916-377">[IIS Express přehledu](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) na webu IIS.NET.</span><span class="sxs-lookup"><span data-stu-id="69916-377">[IIS Express Overview](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) on the IIS.net site.</span></span>
- <span data-ttu-id="69916-378">[Představujeme IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) na blogu Scottu Guthrie.</span><span class="sxs-lookup"><span data-stu-id="69916-378">[Introducing IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) on Scott Guthrie's blog.</span></span>
- <span data-ttu-id="69916-379">[Webové servery v aplikaci Visual Studio pro webové projekty ASP.NET](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span><span class="sxs-lookup"><span data-stu-id="69916-379">[Web Servers in Visual Studio for ASP.NET Web Projects](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span></span>
- <span data-ttu-id="69916-380">[Základní rozdíly mezi službou IIS a vývojovým serverem ASP.NET](../../older-versions-getting-started/deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) na webu ASP.NET</span><span class="sxs-lookup"><span data-stu-id="69916-380">[Core Differences Between IIS and the ASP.NET Development Server](../../older-versions-getting-started/deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) on the ASP.NET site.</span></span>

<span data-ttu-id="69916-381">Informace o tom, jaké problémy mohou nastat, když vaše aplikace běží ve středním vztahu důvěryhodnosti, najdete v tématu [hostování aplikací ASP.NET ve středním vztahu důvěryhodnosti](http://www.4guysfromrolla.com/articles/100307-1.aspx) na čtyřech kyberbezpečnosti z webu Rolla.</span><span class="sxs-lookup"><span data-stu-id="69916-381">For information about what issues might arise when your application runs in medium trust, see [Hosting ASP.NET Applications in Medium Trust](http://www.4guysfromrolla.com/articles/100307-1.aspx) on the four Guys from Rolla site.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="69916-382">[Předchozí](project-properties.md)
> [Další](setting-folder-permissions.md)</span><span class="sxs-lookup"><span data-stu-id="69916-382">[Previous](project-properties.md)
[Next](setting-folder-permissions.md)</span></span>
