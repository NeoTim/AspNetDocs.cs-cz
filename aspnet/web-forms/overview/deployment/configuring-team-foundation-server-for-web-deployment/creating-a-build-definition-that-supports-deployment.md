---
uid: web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment
title: Vytvoření definice sestavení, která podporuje nasazení | Microsoft Docs
author: jrjlee
description: Chcete-li provést jakýkoli druh sestavení v Team Foundation Server (TFS) 2010, je nutné vytvořit definici sestavení v rámci týmového projektu. Toto téma des...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: fe47a018-f6d0-4979-80e7-5b1fa75a5865
msc.legacyurl: /web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment
msc.type: authoredcontent
ms.openlocfilehash: e11c91a824446572aaf0b3bc6954b9b8ffb4eaff
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78603997"
---
# <a name="creating-a-build-definition-that-supports-deployment"></a><span data-ttu-id="8fd68-104">Vytvoření definice nasazení, která podporuje nasazení</span><span class="sxs-lookup"><span data-stu-id="8fd68-104">Creating a Build Definition That Supports Deployment</span></span>

<span data-ttu-id="8fd68-105">od [Jason Novák](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="8fd68-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="8fd68-106">Stáhnout PDF</span><span class="sxs-lookup"><span data-stu-id="8fd68-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="8fd68-107">Chcete-li provést jakýkoli druh sestavení v Team Foundation Server (TFS) 2010, je nutné vytvořit definici sestavení v rámci týmového projektu.</span><span class="sxs-lookup"><span data-stu-id="8fd68-107">If you want to perform any kind of build in Team Foundation Server (TFS) 2010, you need to create a build definition within your team project.</span></span> <span data-ttu-id="8fd68-108">Toto téma popisuje, jak vytvořit novou definici sestavení v sadě TFS a jak řídit nasazení webu v rámci procesu sestavení v týmovém sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-108">This topic describes how to create a new build definition in TFS and how to control web deployment as part of the build process in Team Build.</span></span>

<span data-ttu-id="8fd68-109">Toto téma je součástí série kurzů založených na požadavcích podnikového nasazení fiktivní společnosti s názvem Fabrikam, Inc. Tato série kurzů používá ukázkové řešení&#x2014;, pomocí kterého [řešení](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;správce kontaktů představuje webovou aplikaci s realistickou úrovní složitosti, včetně aplikace ASP.NET MVC 3, služby Windows Communication Foundation (WCF) a databázového projektu.</span><span class="sxs-lookup"><span data-stu-id="8fd68-109">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="8fd68-110">Metoda nasazení na srdce těchto kurzů je založena na způsobu rozdělení souboru projektu popsaného v tématu [Principy souboru projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md), ve kterém je proces sestavení a nasazení řízen dvěma soubory&#x2014;projektu, které obsahují pokyny pro sestavení, které platí pro každé cílové prostředí, a jedno obsahující nastavení sestavení a nasazení specifické pro konkrétní prostředí.</span><span class="sxs-lookup"><span data-stu-id="8fd68-110">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build and deployment process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="8fd68-111">V době sestavení je soubor projektu specifický pro prostředí sloučen do souboru projektu prostředí – nezávislá a vytvoří kompletní sadu instrukcí pro sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-111">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="8fd68-112">Přehled úlohy</span><span class="sxs-lookup"><span data-stu-id="8fd68-112">Task Overview</span></span>

<span data-ttu-id="8fd68-113">Definice sestavení je mechanismus, který určuje, jak a kdy dochází k sestavení pro týmové projekty v TFS.</span><span class="sxs-lookup"><span data-stu-id="8fd68-113">A build definition is the mechanism that controls how and when builds occur for team projects in TFS.</span></span> <span data-ttu-id="8fd68-114">Každá definice sestavení Určuje:</span><span class="sxs-lookup"><span data-stu-id="8fd68-114">Each build definition specifies:</span></span>

- <span data-ttu-id="8fd68-115">Věci, které chcete sestavit, například soubory řešení aplikace Visual Studio nebo vlastní soubory projektu Microsoft Build Engine (MSBuild).</span><span class="sxs-lookup"><span data-stu-id="8fd68-115">The things you want to build, like Visual Studio solution files or custom Microsoft Build Engine (MSBuild) project files.</span></span>
- <span data-ttu-id="8fd68-116">Kritéria, která určují, kdy by mělo dojít k sestavení, jako jsou ruční triggery, kontinuální integrace (CI) nebo ověřované vrácení se změnami.</span><span class="sxs-lookup"><span data-stu-id="8fd68-116">The criteria that determine when a build should take place, like manual triggers, continuous integration (CI), or gated check-ins.</span></span>
- <span data-ttu-id="8fd68-117">Umístění, do kterého má tým sestavení odeslat výstupy sestavení, včetně artefaktů nasazení, jako jsou webové balíčky a databázové skripty.</span><span class="sxs-lookup"><span data-stu-id="8fd68-117">The location to which Team Build should send build outputs, including deployment artifacts like web packages and database scripts.</span></span>
- <span data-ttu-id="8fd68-118">Doba, po kterou mají být všechna sestavení uchována.</span><span class="sxs-lookup"><span data-stu-id="8fd68-118">The amount of time that each build should be retained.</span></span>
- <span data-ttu-id="8fd68-119">Různé další parametry procesu sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-119">Various other parameters of the build process.</span></span>

> [!NOTE]
> <span data-ttu-id="8fd68-120">Další informace o definicích sestavení naleznete v tématu [Definice procesu sestavení](https://msdn.microsoft.com/library/ms181715.aspx).</span><span class="sxs-lookup"><span data-stu-id="8fd68-120">For more information on build definitions, see [Define Your Build Process](https://msdn.microsoft.com/library/ms181715.aspx).</span></span>

<span data-ttu-id="8fd68-121">V tomto tématu se dozvíte, jak vytvořit definici sestavení, která používá CI, aby se spustilo sestavení při kontrole nového obsahu vývojářem.</span><span class="sxs-lookup"><span data-stu-id="8fd68-121">This topic will show you how to create a build definition that uses CI, so that a build is triggered when a developer checks in new content.</span></span> <span data-ttu-id="8fd68-122">Pokud je sestavení úspěšné, služba sestavení spustí vlastní soubor projektu pro nasazení řešení do testovacího prostředí.</span><span class="sxs-lookup"><span data-stu-id="8fd68-122">If the build succeeds, the build service runs a custom project file to deploy the solution to a test environment.</span></span>

<span data-ttu-id="8fd68-123">Při aktivaci sestavení je nutné provést tyto akce:</span><span class="sxs-lookup"><span data-stu-id="8fd68-123">When you trigger a build, these actions need to happen:</span></span>

- <span data-ttu-id="8fd68-124">Nejdřív by mělo sestavení týmu sestavit řešení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-124">First, Team Build should build the solution.</span></span> <span data-ttu-id="8fd68-125">V rámci tohoto procesu vytvoří týmový Build kanál pro publikování webu (WPP), který vygeneruje balíčky pro nasazení webu pro každý projekt webové aplikace v řešení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-125">As part of this process, Team Build will invoke the Web Publishing Pipeline (WPP) to generate web deployment packages for each of the web application projects in the solution.</span></span> <span data-ttu-id="8fd68-126">V týmovém sestavení se také spustí všechny testy jednotek spojené s řešením.</span><span class="sxs-lookup"><span data-stu-id="8fd68-126">Team Build will also run any unit tests associated with the solution.</span></span>
- <span data-ttu-id="8fd68-127">Pokud se sestavení řešení nepovede, týmový Build by neměl provádět žádnou další akci.</span><span class="sxs-lookup"><span data-stu-id="8fd68-127">If the solution build fails, Team Build should take no further action.</span></span> <span data-ttu-id="8fd68-128">Selhání testu jednotek by mělo být považováno za selhání sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-128">Unit test failures should be treated as a build failure.</span></span>
- <span data-ttu-id="8fd68-129">Pokud se sestavení řešení zdaří, týmový Build by měl spustit vlastní soubor projektu, který řídí nasazení řešení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-129">If the solution build succeeds, Team Build should run the custom project file that controls the deployment of the solution.</span></span> <span data-ttu-id="8fd68-130">V rámci tohoto procesu týmový Build vyvolá Nasazení webu Nástroj pro nasazení webu Internetová informační služba (IIS), který nainstaluje zabalené webové aplikace na cílové webové servery a vyvolá nástroj VSDBCMD. exe pro spuštění vytváření databáze. skripty na cílových databázových serverech.</span><span class="sxs-lookup"><span data-stu-id="8fd68-130">As part of this process, Team Build will invoke the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to install the packaged web applications on the destination web servers, and it will invoke the VSDBCMD.exe utility to run database creation scripts on the destination database servers.</span></span>

<span data-ttu-id="8fd68-131">To znázorňuje proces:</span><span class="sxs-lookup"><span data-stu-id="8fd68-131">This illustrates the process:</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image1.png)

<span data-ttu-id="8fd68-132">Ukázkové řešení [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) obsahuje vlastní soubor projektu MSBuild, *publikování. proj*, který můžete spustit z nástroje MSBuild nebo sestavení týmu.</span><span class="sxs-lookup"><span data-stu-id="8fd68-132">The [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution includes a custom MSBuild project file, *Publish.proj*, that you can run from MSBuild or Team Build.</span></span> <span data-ttu-id="8fd68-133">Jak je popsáno v tématu [Principy procesu sestavení](../web-deployment-in-the-enterprise/understanding-the-build-process.md), tento soubor projektu definuje logiku, která nasazuje vaše webové balíčky a databáze do cílového prostředí.</span><span class="sxs-lookup"><span data-stu-id="8fd68-133">As described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md), this project file defines the logic that deploys your web packages and databases to a target environment.</span></span> <span data-ttu-id="8fd68-134">Soubor obsahuje logiku, která vynechá proces sestavení a balení, pokud je spuštěn v rámci týmového sestavení, takže je potřeba spustit pouze úlohy nasazení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-134">The file includes logic that omits the building and packaging process if it's running in Team Build, leaving just the deployment tasks to run.</span></span> <span data-ttu-id="8fd68-135">Důvodem je, že při automatizaci nasazení tímto způsobem obvykle budete chtít zajistit, aby se řešení úspěšně sestavilo a před zahájením procesu nasazení předá všechny testy jednotek.</span><span class="sxs-lookup"><span data-stu-id="8fd68-135">This is because when you automate deployment in this way, you'll typically want to ensure that the solution builds successfully and passes any unit tests before the deployment process commences.</span></span>

<span data-ttu-id="8fd68-136">V další části se dozvíte, jak implementovat tento proces vytvořením nové definice sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-136">The next section explains how to implement this process by creating a new build definition.</span></span>

> [!NOTE]
> <span data-ttu-id="8fd68-137">Tento postup&#x2014;, ve kterém jeden automatizovaný proces sestavuje, testuje a nasazuje řešení&#x2014;, je pravděpodobně nejvíce vhodný pro nasazení do testovacích prostředí.</span><span class="sxs-lookup"><span data-stu-id="8fd68-137">This procedure&#x2014;in which a single automated process builds, tests, and deploys a solution&#x2014;is likely to be most suited to deployment to test environments.</span></span> <span data-ttu-id="8fd68-138">V případě pracovních a produkčních prostředí je mnohem více pravděpodobnější, že budete chtít nasadit obsah z předchozího sestavení, které jste již ověřili a ověřili v testovacím prostředí.</span><span class="sxs-lookup"><span data-stu-id="8fd68-138">For staging and production environments you're a lot more likely to want to deploy content from a previous build that you've already verified and validated in a test environment.</span></span> <span data-ttu-id="8fd68-139">Tento přístup je popsaný v dalším tématu [nasazení konkrétního sestavení](deploying-a-specific-build.md).</span><span class="sxs-lookup"><span data-stu-id="8fd68-139">This approach is described in the next topic, [Deploying a Specific Build](deploying-a-specific-build.md).</span></span>

### <a name="who-performs-this-procedure"></a><span data-ttu-id="8fd68-140">Kdo tento postup provádí?</span><span class="sxs-lookup"><span data-stu-id="8fd68-140">Who Performs This Procedure?</span></span>

<span data-ttu-id="8fd68-141">Tento postup obvykle provádí správce TFS.</span><span class="sxs-lookup"><span data-stu-id="8fd68-141">Typically, a TFS administrator performs this procedure.</span></span> <span data-ttu-id="8fd68-142">V některých případech může vedoucí týmu vývojářů převzít zodpovědnost za kolekci týmového projektu v TFS.</span><span class="sxs-lookup"><span data-stu-id="8fd68-142">In some cases, a developer team leader may take responsibility for the team project collection in TFS.</span></span> <span data-ttu-id="8fd68-143">Chcete-li vytvořit novou definici sestavení, musíte být členem skupiny **Správci sestavení kolekcí projektů** pro kolekci týmových projektů, která obsahuje vaše řešení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-143">In order to create a new build definition, you need to be a member of the **Project Collection Build Administrators** group for the team project collection that contains your solution.</span></span>

## <a name="create-a-build-definition-for-ci-and-deployment"></a><span data-ttu-id="8fd68-144">Vytvoření definice sestavení pro CI a nasazení</span><span class="sxs-lookup"><span data-stu-id="8fd68-144">Create a Build Definition for CI and Deployment</span></span>

<span data-ttu-id="8fd68-145">Další postup popisuje, jak vytvořit definici sestavení, která spouští triggery CI.</span><span class="sxs-lookup"><span data-stu-id="8fd68-145">The next procedure describes how to create a build definition that CI triggers.</span></span> <span data-ttu-id="8fd68-146">Pokud je sestavení úspěšné, řešení je nasazeno pomocí logiky ve vlastním souboru projektu MSBuild.</span><span class="sxs-lookup"><span data-stu-id="8fd68-146">If the build succeeds, the solution is deployed using the logic in a custom MSBuild project file.</span></span>

<span data-ttu-id="8fd68-147">**Vytvoření definice sestavení pro CI a nasazení**</span><span class="sxs-lookup"><span data-stu-id="8fd68-147">**To create a build definition for CI and deployment**</span></span>

1. <span data-ttu-id="8fd68-148">V aplikaci Visual Studio 2010 v okně **Team Explorer** rozbalte uzel týmového projektu, klikněte pravým tlačítkem na položku **sestavení**a poté klikněte na možnost **Nová definice sestavení**.</span><span class="sxs-lookup"><span data-stu-id="8fd68-148">In Visual Studio 2010, in the **Team Explorer** window, expand your team project node, right-click **Builds**, and then click **New Build Definition**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image2.png)
2. <span data-ttu-id="8fd68-149">Na kartě **Obecné** zadejte název definice sestavení (například **DeployToTest**) a volitelný popis.</span><span class="sxs-lookup"><span data-stu-id="8fd68-149">On the **General** tab, give the build definition a name (for example, **DeployToTest**) and an optional description.</span></span>
3. <span data-ttu-id="8fd68-150">Na kartě **aktivační událost** vyberte kritéria, u kterých chcete aktivovat nové sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-150">On the **Trigger** tab, select the criteria on which you want to trigger a new build.</span></span> <span data-ttu-id="8fd68-151">Například pokud chcete sestavit řešení a nasadit do testovacího prostředí pokaždé, když vývojář zkontroluje nový kód, vyberte možnost **průběžná integrace**.</span><span class="sxs-lookup"><span data-stu-id="8fd68-151">For example, if you want to build the solution and deploy to the test environment every time a developer checks in new code, select **Continuous Integration**.</span></span>
4. <span data-ttu-id="8fd68-152">Na kartě **výchozí hodnoty sestavení** v poli **Kopírovat výstup sestavení do následující ukládací složky** zadejte cestu UNC (Universal Naming Convention) k odkládací složce (například **\\TFSBUILD\Drops**).</span><span class="sxs-lookup"><span data-stu-id="8fd68-152">On the **Build Defaults** tab, in the **Copy build output to the following drop folder** box, type the Universal Naming Convention (UNC) path of your drop folder (for example, **\\TFSBUILD\Drops**).</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image3.png)

    > [!NOTE]
    > <span data-ttu-id="8fd68-153">Toto odkládací umístění uchovává několik sestavení v závislosti na nakonfigurovaných zásadách uchovávání informací.</span><span class="sxs-lookup"><span data-stu-id="8fd68-153">This drop location stores several builds, depending on the retention policy you configure.</span></span> <span data-ttu-id="8fd68-154">Když chcete publikovat artefakty nasazení z konkrétního sestavení do pracovního nebo produkčního prostředí, najdete je tam.</span><span class="sxs-lookup"><span data-stu-id="8fd68-154">When you want to publish deployment artifacts from a specific build to a staging or production environment, this is where you'll find them.</span></span>
5. <span data-ttu-id="8fd68-155">Na kartě **proces** v rozevíracím seznamu **soubor procesu sestavení** ponechte vybranou možnost **šabloně DefaultTemplate. XAML** .</span><span class="sxs-lookup"><span data-stu-id="8fd68-155">On the **Process** tab, in the **Build process file** dropdown list, leave **DefaultTemplate.xaml** selected.</span></span> <span data-ttu-id="8fd68-156">Toto je jedna z výchozích šablon procesu sestavení, které se přidají do všech nových týmových projektů.</span><span class="sxs-lookup"><span data-stu-id="8fd68-156">This is one of the default build process templates that get added to all new team projects.</span></span>
6. <span data-ttu-id="8fd68-157">V tabulce **parametrů procesu sestavení** klikněte na řádek **položky k sestavení** a potom klikněte na tlačítko se **třemi tečkami** .</span><span class="sxs-lookup"><span data-stu-id="8fd68-157">In the **Build process parameters** table, click in the **Items to Build** row, and then click the **ellipsis** button.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image4.png)
7. <span data-ttu-id="8fd68-158">V dialogovém okně **položky k sestavení** klikněte na tlačítko **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="8fd68-158">In the **Items to Build** dialog box, click **Add**.</span></span>
8. <span data-ttu-id="8fd68-159">Přejděte do umístění souboru řešení a klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="8fd68-159">Browse to the location of your solution file, and then click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image5.png)
9. <span data-ttu-id="8fd68-160">V dialogovém okně **položky k sestavení** klikněte na tlačítko **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="8fd68-160">In the **Items to Build** dialog box, click **Add**.</span></span>
10. <span data-ttu-id="8fd68-161">V rozevíracím seznamu **položky typu** vyberte možnost **soubory projektu MSBuild**.</span><span class="sxs-lookup"><span data-stu-id="8fd68-161">In the **Items of type** dropdown list, select **MSBuild Project files**.</span></span>
11. <span data-ttu-id="8fd68-162">Přejděte do umístění vlastního souboru projektu, pomocí kterého budete řídit proces nasazení, vyberte soubor a klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="8fd68-162">Browse to the location of the custom project file with which you control the deployment process, select the file, and then click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image6.png)
12. <span data-ttu-id="8fd68-163">V dialogovém okně **položky k sestavení** by nyní mělo být zobrazeno dvě položky.</span><span class="sxs-lookup"><span data-stu-id="8fd68-163">The **Items to Build** dialog box should now show two items.</span></span> <span data-ttu-id="8fd68-164">Klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="8fd68-164">Click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image7.png)
13. <span data-ttu-id="8fd68-165">Na kartě **proces** v tabulce **Parametry procesu sestavení** rozbalte část **Upřesnit** .</span><span class="sxs-lookup"><span data-stu-id="8fd68-165">On the **Process** tab, in the **Build process parameters** table, expand the **Advanced** section.</span></span>
14. <span data-ttu-id="8fd68-166">V řádku **argumenty MSBuild** přidejte všechny argumenty příkazového řádku MSBuild, které musí *jedna* z položek sestavit.</span><span class="sxs-lookup"><span data-stu-id="8fd68-166">In the **MSBuild Arguments** row, add any MSBuild command-line arguments that *either* of your items to build requires.</span></span> <span data-ttu-id="8fd68-167">Ve scénáři řešení Contact Manager jsou vyžadovány tyto argumenty:</span><span class="sxs-lookup"><span data-stu-id="8fd68-167">In the Contact Manager solution scenario, these arguments are required:</span></span>

    [!code-console[Main](creating-a-build-definition-that-supports-deployment/samples/sample1.cmd)]

    ![](creating-a-build-definition-that-supports-deployment/_static/image8.png)
15. <span data-ttu-id="8fd68-168">V tomto příkladu:</span><span class="sxs-lookup"><span data-stu-id="8fd68-168">In this example:</span></span>

    1. <span data-ttu-id="8fd68-169">Při sestavování řešení Contact Manageru se vyžadují argumenty balíčku **DeployOnBuild = true** a **DeployTarget =** .</span><span class="sxs-lookup"><span data-stu-id="8fd68-169">The **DeployOnBuild=true** and **DeployTarget=package** arguments are required when you build the Contact Manager solution.</span></span> <span data-ttu-id="8fd68-170">Nástroj MSBuild vydává pokyn k vytváření balíčků pro nasazení webu po sestavení každého projektu webové aplikace, jak je popsáno v tématu [sestavování a balení projektů webových aplikací](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span><span class="sxs-lookup"><span data-stu-id="8fd68-170">This instructs MSBuild to create web deployment packages after building each web application project, as described in [Building and Packaging Web Application Projects](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span></span>
    2. <span data-ttu-id="8fd68-171">Při vytváření souboru *Publish. proj* je vyžadován argument **TargetEnvPropsFile** .</span><span class="sxs-lookup"><span data-stu-id="8fd68-171">The **TargetEnvPropsFile** argument is required when you build the *Publish.proj* file.</span></span> <span data-ttu-id="8fd68-172">Tato vlastnost označuje umístění konfiguračního souboru specifického pro prostředí, jak je popsáno v tématu [Principy procesu sestavení](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="8fd68-172">This property indicates the location of the environment-specific configuration file, as described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>
16. <span data-ttu-id="8fd68-173">Na kartě **zásady uchovávání informací** nakonfigurujte, kolik sestavení každého typu chcete zachovat podle potřeby.</span><span class="sxs-lookup"><span data-stu-id="8fd68-173">On the **Retention Policy** tab, configure how many builds of each type you want to retain as required.</span></span>
17. <span data-ttu-id="8fd68-174">Klikněte na **Uložit**.</span><span class="sxs-lookup"><span data-stu-id="8fd68-174">Click **Save**.</span></span>

## <a name="queue-a-build"></a><span data-ttu-id="8fd68-175">Zařazení sestavení do fronty</span><span class="sxs-lookup"><span data-stu-id="8fd68-175">Queue a Build</span></span>

<span data-ttu-id="8fd68-176">V tomto okamžiku jste vytvořili alespoň jednu novou definici sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-176">At this point, you have created at least one new build definition.</span></span> <span data-ttu-id="8fd68-177">Proces sestavení, který jste definovali, se nyní spustí podle triggerů, které jste zadali v definici sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-177">The build process you defined will now run according to the triggers you specified in the build definition.</span></span>

<span data-ttu-id="8fd68-178">Pokud jste nakonfigurovali definici sestavení tak, aby používala CI, můžete otestovat definici sestavení dvěma způsoby:</span><span class="sxs-lookup"><span data-stu-id="8fd68-178">If you've configured your build definition to use CI, you can test your build definition in two ways:</span></span>

- <span data-ttu-id="8fd68-179">Vrátit se změnami obsah do týmového projektu, který spustí automatické sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-179">Check in some content to the team project to trigger an automatic build.</span></span>
- <span data-ttu-id="8fd68-180">Zařadí sestavení do fronty ručně.</span><span class="sxs-lookup"><span data-stu-id="8fd68-180">Queue a build manually.</span></span>

<span data-ttu-id="8fd68-181">**Ruční zařazení sestavení do fronty**</span><span class="sxs-lookup"><span data-stu-id="8fd68-181">**To queue a build manually**</span></span>

1. <span data-ttu-id="8fd68-182">V okně **Team Explorer** klikněte pravým tlačítkem myši na definici sestavení a potom klikněte na příkaz **zařadit nové sestavení do fronty**.</span><span class="sxs-lookup"><span data-stu-id="8fd68-182">In the **Team Explorer** window, right-click the build definition, and then click **Queue New Build**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image9.png)
2. <span data-ttu-id="8fd68-183">V dialogovém okně **sestavení fronty** zkontrolujte vlastnosti sestavení a pak klikněte na **fronta**.</span><span class="sxs-lookup"><span data-stu-id="8fd68-183">In the **Queue Build** dialog box, review the build properties, and then click **Queue**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image10.png)

<span data-ttu-id="8fd68-184">Chcete-li zkontrolovat průběh a výsledek sestavení&#x2014;bez ohledu na to, zda byly aktivovány ručně nebo automaticky&#x2014;dvakrát klikněte na definici sestavení v okně **Team Explorer** .</span><span class="sxs-lookup"><span data-stu-id="8fd68-184">To review the progress and the outcome of a build&#x2014;regardless of whether it was triggered manually or automatically&#x2014;double-click the build definition in the **Team Explorer** window.</span></span> <span data-ttu-id="8fd68-185">Tím se otevře karta **Průzkumník sestavení** .</span><span class="sxs-lookup"><span data-stu-id="8fd68-185">This will open a **Build Explorer** tab.</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image11.png)

<span data-ttu-id="8fd68-186">Z tohoto místa můžete řešit problémy s neúspěšnými sestaveními.</span><span class="sxs-lookup"><span data-stu-id="8fd68-186">From here, you can troubleshoot failed builds.</span></span> <span data-ttu-id="8fd68-187">Pokud dvakrát kliknete na jednotlivé sestavení, můžete zobrazit souhrnné informace a kliknout na podrobné soubory protokolu.</span><span class="sxs-lookup"><span data-stu-id="8fd68-187">If you double-click an individual build, you can view summary information and click through to detailed log files.</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image12.png)

<span data-ttu-id="8fd68-188">Tyto informace můžete použít k řešení neúspěšných sestavení a vyřešení všech problémů předtím, než se pokusíte o další sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-188">You can use this information to troubleshoot failed builds and address any problems before you attempt another build.</span></span>

> [!NOTE]
> <span data-ttu-id="8fd68-189">Sestavení, která spouštějí logiku nasazení, budou pravděpodobně neúspěšná, dokud neudělíte serveru sestavení žádná oprávnění požadovaná v cílovém prostředí.</span><span class="sxs-lookup"><span data-stu-id="8fd68-189">Builds that execute deployment logic are likely to fail until you have granted the build server any permissions required in the destination environment.</span></span> <span data-ttu-id="8fd68-190">Další informace najdete v tématu [Konfigurace oprávnění pro nasazení týmového sestavení](configuring-permissions-for-team-build-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="8fd68-190">For more information, see [Configuring Permissions for Team Build Deployment](configuring-permissions-for-team-build-deployment.md).</span></span>

## <a name="monitor-the-build-process"></a><span data-ttu-id="8fd68-191">Monitorování procesu sestavení</span><span class="sxs-lookup"><span data-stu-id="8fd68-191">Monitor the Build Process</span></span>

<span data-ttu-id="8fd68-192">TFS nabízí širokou škálu funkcí, které vám pomůžou monitorovat proces sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-192">TFS provides a broad range of functionality to help you monitor the build process.</span></span> <span data-ttu-id="8fd68-193">TFS například může poslat e-mail nebo zobrazit výstrahy v oznamovací oblasti hlavního panelu po dokončení sestavení.</span><span class="sxs-lookup"><span data-stu-id="8fd68-193">For example, TFS can send you an email or display alerts in your taskbar notification area when a build has completed.</span></span> <span data-ttu-id="8fd68-194">Další informace naleznete v tématu [Run and monitor Builds](https://msdn.microsoft.com/library/ms181721.aspx).</span><span class="sxs-lookup"><span data-stu-id="8fd68-194">For more information, see [Run and Monitor Builds](https://msdn.microsoft.com/library/ms181721.aspx).</span></span>

## <a name="conclusion"></a><span data-ttu-id="8fd68-195">Závěr</span><span class="sxs-lookup"><span data-stu-id="8fd68-195">Conclusion</span></span>

<span data-ttu-id="8fd68-196">Toto téma popisuje, jak vytvořit definici sestavení v sadě TFS.</span><span class="sxs-lookup"><span data-stu-id="8fd68-196">This topic described how to create a build definition in TFS.</span></span> <span data-ttu-id="8fd68-197">Definice sestavení je nakonfigurována pro CI, takže proces sestavení se spustí pokaždé, když vývojář vrátí obsah do týmového projektu.</span><span class="sxs-lookup"><span data-stu-id="8fd68-197">The build definition is configured for CI, so the build process runs whenever a developer checks in content to the team project.</span></span> <span data-ttu-id="8fd68-198">Definice sestavení spustí vlastní soubor projektu MSBuild pro nasazení webových balíčků a databázových skriptů do cílového serverového prostředí.</span><span class="sxs-lookup"><span data-stu-id="8fd68-198">The build definition executes a custom MSBuild project file to deploy web packages and database scripts to a target server environment.</span></span>

<span data-ttu-id="8fd68-199">Aby bylo automatizované nasazení v rámci procesu sestavení úspěšné, je nutné udělit příslušné oprávnění k účtu sestavovací služby na cílových webových serverech a cílovém databázovém serveru.</span><span class="sxs-lookup"><span data-stu-id="8fd68-199">In order for an automated deployment to succeed as part of a build process, you'll need to grant appropriate permissions to the build service account on the target web servers and the target database server.</span></span> <span data-ttu-id="8fd68-200">Poslední téma v tomto kurzu, [Konfigurace oprávnění pro nasazení týmového sestavení](configuring-permissions-for-team-build-deployment.md), popisuje, jak identifikovat a nakonfigurovat oprávnění požadovaná pro automatizované nasazení ze serveru sestavení týmu.</span><span class="sxs-lookup"><span data-stu-id="8fd68-200">The final topic in this tutorial, [Configuring Permissions for Team Build Deployment](configuring-permissions-for-team-build-deployment.md), describes how to identify and configure the permissions required for automated deployment from a Team Build server.</span></span>

## <a name="further-reading"></a><span data-ttu-id="8fd68-201">Další čtení</span><span class="sxs-lookup"><span data-stu-id="8fd68-201">Further Reading</span></span>

<span data-ttu-id="8fd68-202">Další informace o vytváření definic sestavení naleznete v tématu [Vytvoření základní definice sestavení](https://msdn.microsoft.com/library/ms181716.aspx) a [Definování procesu sestavení](https://msdn.microsoft.com/library/ms181715.aspx).</span><span class="sxs-lookup"><span data-stu-id="8fd68-202">For more information on creating build definitions, see [Create a Basic Build Definition](https://msdn.microsoft.com/library/ms181716.aspx) and [Define Your Build Process](https://msdn.microsoft.com/library/ms181715.aspx).</span></span> <span data-ttu-id="8fd68-203">Další informace o sestaveních služby Řízení front najdete v tématu [zařazení sestavení do fronty](https://msdn.microsoft.com/library/ms181722.aspx).</span><span class="sxs-lookup"><span data-stu-id="8fd68-203">For more guidance on queuing builds, see [Queue a Build](https://msdn.microsoft.com/library/ms181722.aspx).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="8fd68-204">[Předchozí](configuring-a-tfs-build-server-for-web-deployment.md)
> [Další](deploying-a-specific-build.md)</span><span class="sxs-lookup"><span data-stu-id="8fd68-204">[Previous](configuring-a-tfs-build-server-for-web-deployment.md)
[Next](deploying-a-specific-build.md)</span></span>
