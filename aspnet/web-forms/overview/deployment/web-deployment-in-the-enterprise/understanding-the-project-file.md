---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-project-file
title: Porozumění souboru projektu | Microsoft Docs
author: jrjlee
description: Soubory projektu Microsoft Build Engine (MSBuild) leží na srdce procesu sestavení a nasazení. Toto téma začíná koncepčním přehledem nástroje MSBuild...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 07978d9d-341c-4524-bcba-62976f390f77
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-project-file
msc.type: authoredcontent
ms.openlocfilehash: 419fe51aaf65bddcc2c50380f099f842a8d9439c
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78626229"
---
# <a name="understanding-the-project-file"></a><span data-ttu-id="40dfa-104">Porozumění souboru projektu</span><span class="sxs-lookup"><span data-stu-id="40dfa-104">Understanding the project file</span></span>

<span data-ttu-id="40dfa-105">od [Jason Novák](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="40dfa-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="40dfa-106">Stáhnout PDF</span><span class="sxs-lookup"><span data-stu-id="40dfa-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="40dfa-107">Soubory projektu Microsoft Build Engine (MSBuild) leží na srdce procesu sestavení a nasazení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-107">Microsoft Build Engine (MSBuild) project files lie at the heart of the build and deployment process.</span></span> <span data-ttu-id="40dfa-108">Toto téma začíná koncepčním přehledem nástroje MSBuild a souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-108">This topic starts with a conceptual overview of MSBuild and the project file.</span></span> <span data-ttu-id="40dfa-109">Popisuje klíčové komponenty, které se budou nacházet při práci se soubory projektu, a funguje jako příklad, jak můžete použít soubory projektu k nasazení reálných aplikací.</span><span class="sxs-lookup"><span data-stu-id="40dfa-109">It describes the key components you'll come across when you work with project files, and it works through an example of how you can use project files to deploy real-world applications.</span></span>
> 
> <span data-ttu-id="40dfa-110">Naučíte se:</span><span class="sxs-lookup"><span data-stu-id="40dfa-110">What you'll learn:</span></span>
> 
> - <span data-ttu-id="40dfa-111">Jak nástroj MSBuild používá soubory projektu MSBuild k sestavení projektů.</span><span class="sxs-lookup"><span data-stu-id="40dfa-111">How MSBuild uses MSBuild project files to build projects.</span></span>
> - <span data-ttu-id="40dfa-112">Jak se MSBuild integruje s technologiemi nasazení, jako je třeba nástroj pro nasazení webu Internetová informační služba (IIS) (Nasazení webu).</span><span class="sxs-lookup"><span data-stu-id="40dfa-112">How MSBuild integrates with deployment technologies, like the Internet Information Services (IIS) Web Deployment Tool (Web Deploy).</span></span>
> - <span data-ttu-id="40dfa-113">Jak pochopit klíčové součásti souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-113">How to understand the key components of a project file.</span></span>
> - <span data-ttu-id="40dfa-114">Jak lze použít soubory projektu k sestavení a nasazení komplexních aplikací.</span><span class="sxs-lookup"><span data-stu-id="40dfa-114">How you can use project files to build and deploy complex applications.</span></span>

## <a name="msbuild-and-the-project-file"></a><span data-ttu-id="40dfa-115">MSBuild a soubor projektu</span><span class="sxs-lookup"><span data-stu-id="40dfa-115">MSBuild and the Project File</span></span>

<span data-ttu-id="40dfa-116">Při vytváření a sestavování řešení v aplikaci Visual Studio používá Visual Studio nástroj MSBuild k sestavení každého projektu ve vašem řešení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-116">When you create and build solutions in Visual Studio, Visual Studio uses MSBuild to build each project in your solution.</span></span> <span data-ttu-id="40dfa-117">Každý projekt sady Visual Studio obsahuje soubor projektu MSBuild s příponou souboru, který odráží typ projektu&#x2014;, například C# projekt (. csproj), projekt Visual Basic.NET (. vbproj) nebo databázový projekt (. dbproj).</span><span class="sxs-lookup"><span data-stu-id="40dfa-117">Every Visual Studio project includes an MSBuild project file, with a file extension that reflects the type of project&#x2014;for example, a C# project (.csproj), a Visual Basic.NET project (.vbproj), or a database project (.dbproj).</span></span> <span data-ttu-id="40dfa-118">Aby bylo možné sestavit projekt, MSBuild musí zpracovat soubor projektu přidružený k projektu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-118">In order to build a project, MSBuild must process the project file associated with the project.</span></span> <span data-ttu-id="40dfa-119">Soubor projektu je dokument XML, který obsahuje všechny informace a pokyny, které nástroj MSBuild potřebuje k sestavení projektu, jako je například obsah, který se má zahrnout, požadavky na platformu, informace o verzi, nastavení webového serveru nebo databázového serveru a úlohy, které je třeba provést.</span><span class="sxs-lookup"><span data-stu-id="40dfa-119">The project file is an XML document that contains all the information and instructions that MSBuild needs in order to build your project, like the content to include, the platform requirements, versioning information, web server or database server settings, and the tasks that must be performed.</span></span>

<span data-ttu-id="40dfa-120">Soubory projektu MSBuild jsou založené na [schématu XML MSBuild](/visualstudio/msbuild/msbuild-project-file-schema-reference)a v důsledku toho je proces sestavení zcela otevřený a transparentní.</span><span class="sxs-lookup"><span data-stu-id="40dfa-120">MSBuild project files are based on the [MSBuild XML schema](/visualstudio/msbuild/msbuild-project-file-schema-reference), and as a result the build process is entirely open and transparent.</span></span> <span data-ttu-id="40dfa-121">Kromě toho není nutné instalovat sadu Visual Studio, aby bylo možné použít modul&#x2014;MSBuild. spustitelný soubor MSBuild. exe je součástí .NET Framework a lze jej spustit z příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="40dfa-121">In addition, you don't need to install Visual Studio in order to use the MSBuild engine&#x2014;the MSBuild.exe executable is part of the .NET Framework, and you can run it from a command prompt.</span></span> <span data-ttu-id="40dfa-122">Jako vývojář můžete vytvořit vlastní soubory projektu MSBuild pomocí schématu XML pro MSBuild, aby bylo možné nasazovat sofistikovanou a jemně odstupňovanou kontrolu nad tím, jak jsou vaše projekty sestaveny a nasazeny.</span><span class="sxs-lookup"><span data-stu-id="40dfa-122">As a developer, you can craft your own MSBuild project files, using the MSBuild XML schema, to impose sophisticated and fine-grained control over how your projects are built and deployed.</span></span> <span data-ttu-id="40dfa-123">Tyto vlastní soubory projektu fungují přesně stejným způsobem jako soubory projektu, které aplikace Visual Studio generuje automaticky.</span><span class="sxs-lookup"><span data-stu-id="40dfa-123">These custom project files work in exactly the same way as the project files that Visual Studio generates automatically.</span></span>

> [!NOTE]
> <span data-ttu-id="40dfa-124">Můžete také použít soubory projektu MSBuild se službou Team Build Service v Team Foundation Server (TFS).</span><span class="sxs-lookup"><span data-stu-id="40dfa-124">You can also use MSBuild project files with the Team Build service in Team Foundation Server (TFS).</span></span> <span data-ttu-id="40dfa-125">Můžete například použít soubory projektu ve scénářích průběžné integrace (CI) k automatizaci nasazení do testovacího prostředí, když je nový kód vrácen se změnami.</span><span class="sxs-lookup"><span data-stu-id="40dfa-125">For example, you can use project files in continuous integration (CI) scenarios to automate deployment to a test environment when new code is checked in.</span></span> <span data-ttu-id="40dfa-126">Další informace najdete v tématu [konfigurace Team Foundation Server pro automatizované nasazení webu](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="40dfa-126">For more information, see [Configuring Team Foundation Server for Automated Web Deployment](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md).</span></span>

### <a name="project-file-naming-conventions"></a><span data-ttu-id="40dfa-127">Zásady vytváření názvů souborů projektu</span><span class="sxs-lookup"><span data-stu-id="40dfa-127">Project File Naming Conventions</span></span>

<span data-ttu-id="40dfa-128">Když vytváříte vlastní soubory projektu, můžete použít jakoukoli příponu souboru, kterou chcete.</span><span class="sxs-lookup"><span data-stu-id="40dfa-128">When you create your own project files, you can use any file extension you like.</span></span> <span data-ttu-id="40dfa-129">Pokud ale chcete, aby vaše řešení bylo snazší pochopit, měli byste použít tyto běžné konvence:</span><span class="sxs-lookup"><span data-stu-id="40dfa-129">However, to make your solutions easier for others to understand, you should use these common conventions:</span></span>

- <span data-ttu-id="40dfa-130">Použijte rozšíření. proj při vytváření souboru projektu, který vytváří projekty.</span><span class="sxs-lookup"><span data-stu-id="40dfa-130">Use the .proj extension when you create a project file that builds projects.</span></span>
- <span data-ttu-id="40dfa-131">Použijte rozšíření. targets při vytváření opakovaně použitelného souboru projektu pro import do jiných souborů projektu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-131">Use the .targets extension when you create a reusable project file to import into other project files.</span></span> <span data-ttu-id="40dfa-132">Soubory s příponou. targets obvykle sestavují sám sebe, jednoduše obsahují pokyny, které lze importovat do souborů. proj.</span><span class="sxs-lookup"><span data-stu-id="40dfa-132">Files with a .targets extension typically don't build anything themselves, they simply contain instructions that you can import into your .proj files.</span></span>

### <a name="integration-with-deployment-technologies"></a><span data-ttu-id="40dfa-133">Integrace s technologiemi nasazení</span><span class="sxs-lookup"><span data-stu-id="40dfa-133">Integration with Deployment Technologies</span></span>

<span data-ttu-id="40dfa-134">Pokud jste pracovali s projekty webové aplikace v aplikaci Visual Studio 2010, jako jsou webové aplikace ASP.NET a webové aplikace ASP.NET MVC, budete si vědomi, že tyto projekty obsahují integrovanou podporu pro balení a nasazení webové aplikace do cílového prostředí.</span><span class="sxs-lookup"><span data-stu-id="40dfa-134">If you've worked with web application projects in Visual Studio 2010, like ASP.NET web applications and ASP.NET MVC web applications, you'll know that these projects include built-in support for packaging and deploying the web application to a target environment.</span></span> <span data-ttu-id="40dfa-135">Stránky **vlastností** pro tyto projekty zahrnují **Balení/publikování webu** a **Balení/publikování SQL** karet, které můžete použít ke konfiguraci způsobu, jakým jsou komponenty vaší aplikace zabaleny a nasazeny.</span><span class="sxs-lookup"><span data-stu-id="40dfa-135">The **Properties** pages for these projects include **Package/Publish Web** and **Package/Publish SQL** tabs that you can use to configure how the components of your application are packaged and deployed.</span></span> <span data-ttu-id="40dfa-136">Tím se zobrazí karta **Balení/publikování webu** :</span><span class="sxs-lookup"><span data-stu-id="40dfa-136">This shows the **Package/Publish Web** tab:</span></span>

![](understanding-the-project-file/_static/image1.png)

<span data-ttu-id="40dfa-137">Základní technologie za těmito možnostmi je známá jako kanál publikování na webu (WPP).</span><span class="sxs-lookup"><span data-stu-id="40dfa-137">The underlying technology behind these capabilities is known as the Web Publishing Pipeline (WPP).</span></span> <span data-ttu-id="40dfa-138">Rozhraní WPP v podstatě přináší Nástroj MSBuild a [nasazení webu](https://go.microsoft.com/?linkid=9805122) dohromady, aby poskytovala kompletní proces sestavení, balíčku a nasazení pro vaše webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="40dfa-138">The WPP essentially brings MSBuild and [Web Deploy](https://go.microsoft.com/?linkid=9805122) together to provide a complete build, package, and deployment process for your web applications.</span></span>

<span data-ttu-id="40dfa-139">Dobrá zpráva vám umožní využít integrační body, které poskytuje WPP při vytváření vlastních souborů projektu pro webové projekty.</span><span class="sxs-lookup"><span data-stu-id="40dfa-139">The good news is that you can take advantage of the integration points that the WPP provides when you create custom project files for web projects.</span></span> <span data-ttu-id="40dfa-140">Do souboru projektu můžete zahrnout pokyny pro nasazení, které vám umožňují sestavovat projekty, vytvářet balíčky pro nasazení webu a instalovat tyto balíčky na vzdálených serverech prostřednictvím jediného souboru projektu a jediného volání MSBuild.</span><span class="sxs-lookup"><span data-stu-id="40dfa-140">You can include deployment instructions in your project file, which allows you to build your projects, create web deployment packages, and install these packages on remote servers through a single project file and a single call to MSBuild.</span></span> <span data-ttu-id="40dfa-141">Můžete také volat jakékoli jiné spustitelné soubory jako součást procesu sestavení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-141">You can also call any other executables as part of your build process.</span></span> <span data-ttu-id="40dfa-142">Například můžete spustit nástroj příkazového řádku VSDBCMD. exe, který nasadí databázi ze souboru schématu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-142">For example, you can run the VSDBCMD.exe command-line tool to deploy a database from a schema file.</span></span> <span data-ttu-id="40dfa-143">V průběhu tohoto tématu se dozvíte, jak můžete využít tyto možnosti pro splnění požadavků vašich scénářů podnikového nasazení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-143">Over the course of this topic, you'll see how you can take advantage of these capabilities to meet the requirements of your enterprise deployment scenarios.</span></span>

> [!NOTE]
> <span data-ttu-id="40dfa-144">Další informace o tom, jak funguje proces nasazení webové aplikace, najdete v tématu [Přehled nasazení projektu webové aplikace ASP.NET](https://msdn.microsoft.com/library/dd394698.aspx).</span><span class="sxs-lookup"><span data-stu-id="40dfa-144">For more information on how the web application deployment process works, see [ASP.NET Web Application Project Deployment Overview](https://msdn.microsoft.com/library/dd394698.aspx).</span></span>

## <a name="the-anatomy-of-a-project-file"></a><span data-ttu-id="40dfa-145">Anatomie souboru projektu</span><span class="sxs-lookup"><span data-stu-id="40dfa-145">The Anatomy of a Project File</span></span>

<span data-ttu-id="40dfa-146">Předtím, než se podíváte na proces sestavení podrobněji, se vám postará o seznámení se základní strukturou souboru projektu MSBuild.</span><span class="sxs-lookup"><span data-stu-id="40dfa-146">Before you look at the build process in more detail, it's worth taking a few moments to familiarize yourself with the basic structure of an MSBuild project file.</span></span> <span data-ttu-id="40dfa-147">V této části najdete přehled častých prvků, které se zobrazí při kontrole, úpravách nebo vytváření souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-147">This section provides an overview of the more common elements that you'll encounter when you review, edit, or create a project file.</span></span> <span data-ttu-id="40dfa-148">Konkrétně se naučíte:</span><span class="sxs-lookup"><span data-stu-id="40dfa-148">In particular, you'll learn:</span></span>

- <span data-ttu-id="40dfa-149">Jak používat *vlastnosti* pro správu proměnných pro proces sestavení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-149">How to use *properties* to manage variables for the build process.</span></span>
- <span data-ttu-id="40dfa-150">Jak použít *položky* k identifikaci vstupů do procesu sestavení, jako jsou soubory kódu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-150">How to use *items* to identify the inputs to the build process, like code files.</span></span>
- <span data-ttu-id="40dfa-151">Jak používat *cíle* a *úkoly* k poskytnutí instrukcí pro provádění nástroje MSBuild pomocí *vlastností* a *položek* definovaných jinde v souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-151">How to use *targets* and *tasks* to provide execution instructions to MSBuild, using *properties* and *items* defined elsewhere in the project file.</span></span>

<span data-ttu-id="40dfa-152">Zobrazuje vztah mezi klíčovými elementy v souboru projektu MSBuild:</span><span class="sxs-lookup"><span data-stu-id="40dfa-152">This shows the relationship between the key elements in an MSBuild project file:</span></span>

![](understanding-the-project-file/_static/image2.png)

### <a name="the-project-element"></a><span data-ttu-id="40dfa-153">Prvek projektu</span><span class="sxs-lookup"><span data-stu-id="40dfa-153">The Project Element</span></span>

<span data-ttu-id="40dfa-154">Prvek [projektu](https://msdn.microsoft.com/library/bcxfsh87.aspx) je kořenovým prvkem každého souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-154">The [Project](https://msdn.microsoft.com/library/bcxfsh87.aspx) element is the root element of every project file.</span></span> <span data-ttu-id="40dfa-155">Kromě určení schématu XML pro soubor projektu může prvek **projektu** obsahovat atributy pro určení vstupních bodů pro proces sestavení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-155">In addition to identifying the XML schema for the project file, the **Project** element can include attributes to specify the entry points for the build process.</span></span> <span data-ttu-id="40dfa-156">Například v [ukázkovém řešení Contact Manager](the-contact-manager-solution.md)určuje soubor *Publish. proj* , že sestavení má začít voláním cíle s názvem **FullPublish**.</span><span class="sxs-lookup"><span data-stu-id="40dfa-156">For example, in the [Contact Manager sample solution](the-contact-manager-solution.md), the *Publish.proj* file specifies that the build should start by calling the target named **FullPublish**.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample1.xml)]

### <a name="properties-and-conditions"></a><span data-ttu-id="40dfa-157">Vlastnosti a podmínky</span><span class="sxs-lookup"><span data-stu-id="40dfa-157">Properties and Conditions</span></span>

<span data-ttu-id="40dfa-158">Soubor projektu obvykle potřebuje poskytnout spoustu různých informací, aby bylo možné úspěšně sestavit a nasadit vaše projekty.</span><span class="sxs-lookup"><span data-stu-id="40dfa-158">A project file typically needs to provide lots of different pieces of information in order to successfully build and deploy your projects.</span></span> <span data-ttu-id="40dfa-159">Tyto informace mohou zahrnovat názvy serverů, připojovací řetězce, přihlašovací údaje, konfigurace sestavení, cesty ke zdrojovým a cílovým souborům a jakékoli další informace, které chcete zahrnout do přizpůsobení podpory.</span><span class="sxs-lookup"><span data-stu-id="40dfa-159">These pieces of information could include server names, connection strings, credentials, build configurations, source and destination file paths, and any other information you want to include to support customization.</span></span> <span data-ttu-id="40dfa-160">V souboru projektu musí být vlastnosti definovány v rámci elementu [Property](https://msdn.microsoft.com/library/t4w159bs.aspx) .</span><span class="sxs-lookup"><span data-stu-id="40dfa-160">In a project file, properties must be defined within a [PropertyGroup](https://msdn.microsoft.com/library/t4w159bs.aspx) element.</span></span> <span data-ttu-id="40dfa-161">Vlastnosti nástroje MSBuild se skládají z párů klíč-hodnota.</span><span class="sxs-lookup"><span data-stu-id="40dfa-161">MSBuild properties consist of key-value pairs.</span></span> <span data-ttu-id="40dfa-162">V rámci elementu **Property** element název elementu definuje klíč vlastnosti a obsah elementu definuje hodnotu vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="40dfa-162">Within the **PropertyGroup** element, the element name defines the property key and the content of the element defines the property value.</span></span> <span data-ttu-id="40dfa-163">Můžete například definovat vlastnosti s názvem **servername** a **ConnectionString** k uložení názvu statického serveru a připojovacího řetězce.</span><span class="sxs-lookup"><span data-stu-id="40dfa-163">For example, you could define properties named **ServerName** and **ConnectionString** to store a static server name and connection string.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample2.xml)]

<span data-ttu-id="40dfa-164">Chcete-li načíst hodnotu vlastnosti, použijte formát *$ (propertyName)* .</span><span class="sxs-lookup"><span data-stu-id="40dfa-164">To retrieve a property value, use the format *$(PropertyName)*.</span></span> <span data-ttu-id="40dfa-165">Pokud například chcete načíst hodnotu vlastnosti **servername** , zadejte:</span><span class="sxs-lookup"><span data-stu-id="40dfa-165">For example, to retrieve the value of the **ServerName** property, you would type:</span></span>

[!code-powershell[Main](understanding-the-project-file/samples/sample3.ps1)]

> [!NOTE]
> <span data-ttu-id="40dfa-166">V tomto tématu se zobrazí příklady a kdy použít hodnoty vlastností dále.</span><span class="sxs-lookup"><span data-stu-id="40dfa-166">You'll see examples of how and when to use property values later in this topic.</span></span>

<span data-ttu-id="40dfa-167">Vložení informací jako statických vlastností v souboru projektu není vždy ideálním přístupem ke správě procesu sestavení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-167">Embedding information as static properties in a project file is not always the ideal approach to managing the build process.</span></span> <span data-ttu-id="40dfa-168">V mnoha scénářích budete chtít získat informace z jiných zdrojů nebo uživateli poskytnout informace z příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="40dfa-168">In a lot of scenarios, you'll want to obtain the information from other sources or empower the user to provide the information from the command prompt.</span></span> <span data-ttu-id="40dfa-169">Nástroj MSBuild umožňuje zadat jakoukoli hodnotu vlastnosti jako parametr příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="40dfa-169">MSBuild allows you to specify any property value as a command-line parameter.</span></span> <span data-ttu-id="40dfa-170">Například uživatel může zadat hodnotu **servername** , když spustí soubor MSBuild. exe z příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="40dfa-170">For example, the user could provide a value for **ServerName** when he or she runs MSBuild.exe from the command line.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample4.cmd)]

> [!NOTE]
> <span data-ttu-id="40dfa-171">Další informace o argumentech a přepínačích, které lze použít s nástrojem MSBuild. exe, naleznete v tématu [Reference k příkazovému řádku MSBuild](https://msdn.microsoft.com/library/ms164311.aspx).</span><span class="sxs-lookup"><span data-stu-id="40dfa-171">For more information on the arguments and switches you can use with MSBuild.exe, see [MSBuild Command Line Reference](https://msdn.microsoft.com/library/ms164311.aspx).</span></span>

<span data-ttu-id="40dfa-172">Můžete použít stejnou syntaxi vlastnosti pro získání hodnot proměnných prostředí a integrovaných vlastností projektu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-172">You can use the same property syntax to obtain the values of environment variables and built-in project properties.</span></span> <span data-ttu-id="40dfa-173">Pro vás jsou definovány spousty běžně používaných vlastností a můžete je použít v souborech projektu včetně příslušného názvu parametru.</span><span class="sxs-lookup"><span data-stu-id="40dfa-173">Lots of commonly used properties are defined for you, and you can use them in your project files by including the relevant parameter name.</span></span> <span data-ttu-id="40dfa-174">&#x2014;Chcete-li například načíst aktuální platformu projektu, například **x86** nebo **AnyCpu**&#x2014;, můžete do souboru projektu zahrnout odkaz na vlastnost **$ (Platform)** .</span><span class="sxs-lookup"><span data-stu-id="40dfa-174">For example, to retrieve the current project platform&#x2014;for example, **x86** or **AnyCpu**&#x2014;you can include the **$(Platform)** property reference in your project file.</span></span> <span data-ttu-id="40dfa-175">Další informace naleznete v tématu [makra pro příkazy a vlastnosti sestavení](https://msdn.microsoft.com/library/c02as0cs.aspx), [běžné vlastnosti projektu MSBuild](https://msdn.microsoft.com/library/bb629394.aspx)a [vyhrazené vlastnosti](https://msdn.microsoft.com/library/ms164309.aspx).</span><span class="sxs-lookup"><span data-stu-id="40dfa-175">For more information, see [Macros for Build Commands and Properties](https://msdn.microsoft.com/library/c02as0cs.aspx), [Common MSBuild Project Properties](https://msdn.microsoft.com/library/bb629394.aspx), and [Reserved Properties](https://msdn.microsoft.com/library/ms164309.aspx).</span></span>

<span data-ttu-id="40dfa-176">Vlastnosti se často používají ve spojení s *podmínkami*.</span><span class="sxs-lookup"><span data-stu-id="40dfa-176">Properties are often used in conjunction with *conditions*.</span></span> <span data-ttu-id="40dfa-177">Většina elementů MSBuild podporuje atribut **Condition** , který umožňuje zadat kritéria, na základě kterých má MSBuild prvek vyhodnotit.</span><span class="sxs-lookup"><span data-stu-id="40dfa-177">Most MSBuild elements support the **Condition** attribute, which lets you specify the criteria upon which MSBuild should evaluate the element.</span></span> <span data-ttu-id="40dfa-178">Zvažte například tuto definici vlastnosti:</span><span class="sxs-lookup"><span data-stu-id="40dfa-178">For example, consider this property definition:</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample5.xml)]

<span data-ttu-id="40dfa-179">Když nástroj MSBuild zpracuje tuto definici vlastnosti, nejprve zkontroluje, zda je k dispozici hodnota vlastnosti **$ (OutputRoot)** .</span><span class="sxs-lookup"><span data-stu-id="40dfa-179">When MSBuild processes this property definition, it first checks to see whether an **$(OutputRoot)** property value is available.</span></span> <span data-ttu-id="40dfa-180">Pokud je hodnota vlastnosti prázdná&#x2014;, uživateli se pro tuto vlastnost&#x2014;nezadala hodnota, podmínka se vyhodnotí jako **true** a hodnota vlastnosti je nastavená na **... \Publish\Out**. Pokud uživatel zadal hodnotu pro tuto vlastnost, podmínka se vyhodnotí jako **false** a hodnota statické vlastnosti se nepoužije.</span><span class="sxs-lookup"><span data-stu-id="40dfa-180">If the property value is blank&#x2014;in other words, the user hasn't provided a value for this property&#x2014;the condition evaluates to **true** and the property value is set to **..\Publish\Out**. If the user has provided a value for this property, the condition evaluates to **false** and the static property value is not used.</span></span>

<span data-ttu-id="40dfa-181">Další informace o různých způsobech, jak můžete zadat podmínky, najdete v tématu [podmínky nástroje MSBuild](https://msdn.microsoft.com/library/7szfhaft.aspx).</span><span class="sxs-lookup"><span data-stu-id="40dfa-181">For more information on the different ways in which you can specify conditions, see [MSBuild Conditions](https://msdn.microsoft.com/library/7szfhaft.aspx).</span></span>

### <a name="items-and-item-groups"></a><span data-ttu-id="40dfa-182">Položky a skupiny položek</span><span class="sxs-lookup"><span data-stu-id="40dfa-182">Items and Item Groups</span></span>

<span data-ttu-id="40dfa-183">Jednou z důležitých rolí souboru projektu je definování vstupů pro proces sestavení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-183">One of the important roles of the project file is to define the inputs to the build process.</span></span> <span data-ttu-id="40dfa-184">Obvykle tyto vstupy jsou soubory&#x2014;kódu, konfigurační soubory, soubory příkazů a všechny další soubory, které potřebujete pro zpracování nebo kopírování v rámci procesu sestavení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-184">Typically, these inputs are files&#x2014;code files, configuration files, command files, and any other files that you need to process or copy as part of the build process.</span></span> <span data-ttu-id="40dfa-185">Ve schématu projektu MSBuild jsou tyto vstupy reprezentovány prvky [Item](https://msdn.microsoft.com/library/ms164283.aspx) .</span><span class="sxs-lookup"><span data-stu-id="40dfa-185">In the MSBuild project schema, these inputs are represented by [Item](https://msdn.microsoft.com/library/ms164283.aspx) elements.</span></span> <span data-ttu-id="40dfa-186">V souboru projektu musí být položky definovány v rámci elementu [Item](https://msdn.microsoft.com/library/646dk05y.aspx) .</span><span class="sxs-lookup"><span data-stu-id="40dfa-186">In a project file, items must be defined within an [ItemGroup](https://msdn.microsoft.com/library/646dk05y.aspx) element.</span></span> <span data-ttu-id="40dfa-187">Stejně jako prvky **vlastností** můžete pojmenovat prvek **položky** , například.</span><span class="sxs-lookup"><span data-stu-id="40dfa-187">Just like **Property** elements, you can name an **Item** element however you like.</span></span> <span data-ttu-id="40dfa-188">Je však nutné zadat atribut **include** k identifikaci souboru nebo zástupného znaku, který položka představuje.</span><span class="sxs-lookup"><span data-stu-id="40dfa-188">However, you must specify an **Include** attribute to identify the file or wildcard that the item represents.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample6.xml)]

<span data-ttu-id="40dfa-189">Zadáním více prvků **položky** se stejným názvem efektivně vytvoříte pojmenovaný seznam prostředků.</span><span class="sxs-lookup"><span data-stu-id="40dfa-189">By specifying multiple **Item** elements with the same name, you're effectively creating a named list of resources.</span></span> <span data-ttu-id="40dfa-190">Dobrým způsobem, jak to zobrazit v akci, je prohlédnout si jeden ze souborů projektu, které Visual Studio vytvoří.</span><span class="sxs-lookup"><span data-stu-id="40dfa-190">A good way to see this in action is to take a look inside one of the project files that Visual Studio creates.</span></span> <span data-ttu-id="40dfa-191">Například soubor *ContactManager. Mvc. csproj* v ukázkovém řešení obsahuje mnoho skupin položek, z nichž každý má několik identicky pojmenovaných prvků **Item** .</span><span class="sxs-lookup"><span data-stu-id="40dfa-191">For example, the *ContactManager.Mvc.csproj* file in the sample solution includes a lot of item groups, each with several identically named **Item** elements.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample7.xml)]

<span data-ttu-id="40dfa-192">Tímto způsobem soubor projektu instruuje nástroj MSBuild, aby vytvořil seznam souborů, které je třeba zpracovat stejným&#x2014;způsobem jako **odkaz** obsahuje sestavení, která musí být určena pro úspěšné sestavení, seznam **kompilací** obsahuje soubory kódu, které musí být zkompilovány, a seznam **obsahu** obsahuje prostředky, které je nutné zkopírovat beze změny.</span><span class="sxs-lookup"><span data-stu-id="40dfa-192">In this way, the project file is instructing MSBuild to construct lists of files that need to be processed in the same way&#x2014;the **Reference** list includes assemblies that must be in place for a successful build, the **Compile** list includes code files that must be compiled, and the **Content** list includes resources that must be copied unaltered.</span></span> <span data-ttu-id="40dfa-193">Podíváme se na to, jak proces sestavení odkazuje a používá tyto položky dále v tomto tématu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-193">We'll look at how the build process references and uses these items later in this topic.</span></span>

<span data-ttu-id="40dfa-194">Prvky položky mohou také zahrnovat podřízené elementy [ItemMetadata –](https://msdn.microsoft.com/library/ms164284.aspx) .</span><span class="sxs-lookup"><span data-stu-id="40dfa-194">Item elements can also include [ItemMetadata](https://msdn.microsoft.com/library/ms164284.aspx) child elements.</span></span> <span data-ttu-id="40dfa-195">Jsou to uživatelsky definované páry klíč-hodnota a v podstatě představují vlastnosti, které jsou specifické pro danou položku.</span><span class="sxs-lookup"><span data-stu-id="40dfa-195">These are user-defined key-value pairs and essentially represent properties that are specific to that item.</span></span> <span data-ttu-id="40dfa-196">Například velké množství prvků položky **kompilace** v souboru projektu zahrnuje podřízené elementy **DependentUpon** .</span><span class="sxs-lookup"><span data-stu-id="40dfa-196">For example, a lot of the **Compile** item elements in the project file include **DependentUpon** child elements.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample8.xml)]

> [!NOTE]
> <span data-ttu-id="40dfa-197">Kromě metadat položek vytvořených uživatelem jsou všechny položky při vytváření přiřazeny k různým běžným metadatům.</span><span class="sxs-lookup"><span data-stu-id="40dfa-197">In addition to user-created item metadata, all items are assigned various common metadata on creation.</span></span> <span data-ttu-id="40dfa-198">Další informace najdete v tématu [známá metadata položek](https://msdn.microsoft.com/library/ms164313.aspx).</span><span class="sxs-lookup"><span data-stu-id="40dfa-198">For more information, see [Well-known Item Metadata](https://msdn.microsoft.com/library/ms164313.aspx).</span></span>

<span data-ttu-id="40dfa-199">Můžete vytvořit prvky **Item** v rámci elementu **projektu** na kořenové úrovni nebo v rámci specifických **cílových** elementů.</span><span class="sxs-lookup"><span data-stu-id="40dfa-199">You can create **ItemGroup** elements within the root-level **Project** element or within specific **Target** elements.</span></span> <span data-ttu-id="40dfa-200">**Prvky pole** také podporují atributy **podmínky** , které umožňují přizpůsobit vstupy procesu sestavení podle podmínek, jako je například konfigurace projektu nebo platforma.</span><span class="sxs-lookup"><span data-stu-id="40dfa-200">**ItemGroup** elements also support **Condition** attributes, which lets you tailor the inputs to the build process according to conditions like the project configuration or platform.</span></span>

### <a name="targets-and-tasks"></a><span data-ttu-id="40dfa-201">Cíle a úkoly</span><span class="sxs-lookup"><span data-stu-id="40dfa-201">Targets and Tasks</span></span>

<span data-ttu-id="40dfa-202">Ve schématu MSBuild element [Task](https://msdn.microsoft.com/library/77f2hx1s.aspx) představuje individuální instrukci sestavení (nebo úkol).</span><span class="sxs-lookup"><span data-stu-id="40dfa-202">In the MSBuild schema, a [Task](https://msdn.microsoft.com/library/77f2hx1s.aspx) element represents an individual build instruction (or task).</span></span> <span data-ttu-id="40dfa-203">Nástroj MSBuild obsahuje velké množství předdefinovaných úloh.</span><span class="sxs-lookup"><span data-stu-id="40dfa-203">MSBuild includes a multitude of predefined tasks.</span></span> <span data-ttu-id="40dfa-204">Příklad:</span><span class="sxs-lookup"><span data-stu-id="40dfa-204">For example:</span></span>

- <span data-ttu-id="40dfa-205">Úloha **kopírování** kopíruje soubory do nového umístění.</span><span class="sxs-lookup"><span data-stu-id="40dfa-205">The **Copy** task copies files to a new location.</span></span>
- <span data-ttu-id="40dfa-206">Úloha **CSC** vyvolá kompilátor vizuálu C# .</span><span class="sxs-lookup"><span data-stu-id="40dfa-206">The **Csc** task invokes the Visual C# compiler.</span></span>
- <span data-ttu-id="40dfa-207">Úloha **Vbc** vyvolá kompilátor Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="40dfa-207">The **Vbc** task invokes the Visual Basic compiler.</span></span>
- <span data-ttu-id="40dfa-208">Úloha **exec** spustí zadaný program.</span><span class="sxs-lookup"><span data-stu-id="40dfa-208">The **Exec** task runs a specified program.</span></span>
- <span data-ttu-id="40dfa-209">Úloha **zprávy** zapíše zprávu do protokolovacího nástroje.</span><span class="sxs-lookup"><span data-stu-id="40dfa-209">The **Message** task writes a message to a logger.</span></span>

> [!NOTE]
> <span data-ttu-id="40dfa-210">Úplné podrobnosti o úkolech, které jsou k dispozici v poli, naleznete v tématu [Reference k úloze MSBuild](https://msdn.microsoft.com/library/7z253716.aspx).</span><span class="sxs-lookup"><span data-stu-id="40dfa-210">For full details of the tasks that are available out of the box, see [MSBuild Task Reference](https://msdn.microsoft.com/library/7z253716.aspx).</span></span> <span data-ttu-id="40dfa-211">Další informace o úlohách, včetně toho, jak vytvořit vlastní úkoly, najdete v tématu [úlohy nástroje MSBuild](https://msdn.microsoft.com/library/ms171466.aspx).</span><span class="sxs-lookup"><span data-stu-id="40dfa-211">For more information on tasks, including how to create your own custom tasks, see [MSBuild Tasks](https://msdn.microsoft.com/library/ms171466.aspx).</span></span>

<span data-ttu-id="40dfa-212">Úkoly musí být vždy obsaženy v rámci [cílových](https://msdn.microsoft.com/library/t50z2hka.aspx) elementů.</span><span class="sxs-lookup"><span data-stu-id="40dfa-212">Tasks must always be contained within [Target](https://msdn.microsoft.com/library/t50z2hka.aspx) elements.</span></span> <span data-ttu-id="40dfa-213">**Cílový** element je sada jednoho nebo více úloh, které jsou spouštěny sekvenčně a soubor projektu může obsahovat více cílů.</span><span class="sxs-lookup"><span data-stu-id="40dfa-213">A **Target** element is a set of one or more tasks that are executed sequentially, and a project file can contain multiple targets.</span></span> <span data-ttu-id="40dfa-214">Pokud chcete spustit úlohu nebo sadu úkolů, vyvoláte cíl, který je obsahuje.</span><span class="sxs-lookup"><span data-stu-id="40dfa-214">When you want to run a task, or a set of tasks, you invoke the target that contains them.</span></span> <span data-ttu-id="40dfa-215">Předpokládejme například, že máte jednoduchý soubor projektu, který zaznamená zprávu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-215">For example, suppose you have a simple project file that logs a message.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample9.xml)]

<span data-ttu-id="40dfa-216">Cíl můžete vyvolat z příkazového řádku pomocí přepínače **/t** pro určení cíle.</span><span class="sxs-lookup"><span data-stu-id="40dfa-216">You can invoke the target from the command line, by using the **/t** switch to specify the target.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample10.cmd)]

<span data-ttu-id="40dfa-217">Alternativně můžete přidat atribut **DefaultTargets –** do prvku **projektu** , chcete-li určit cíle, které chcete vyvolat.</span><span class="sxs-lookup"><span data-stu-id="40dfa-217">Alternatively, you can add a **DefaultTargets** attribute to the **Project** element, to specify the targets that you want to invoke.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample11.xml)]

<span data-ttu-id="40dfa-218">V takovém případě nemusíte zadávat cíl z příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="40dfa-218">In this case, you don't need to specify the target from the command line.</span></span> <span data-ttu-id="40dfa-219">Můžete jednoduše zadat soubor projektu a nástroj MSBuild vyvolá cíl **FullPublish** za vás.</span><span class="sxs-lookup"><span data-stu-id="40dfa-219">You can simply specify the project file, and MSBuild will invoke the **FullPublish** target for you.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample12.cmd)]

<span data-ttu-id="40dfa-220">Atributy **podmínky** můžou zahrnovat i cíle i úkoly.</span><span class="sxs-lookup"><span data-stu-id="40dfa-220">Both targets and tasks can include **Condition** attributes.</span></span> <span data-ttu-id="40dfa-221">V takovém případě můžete zvolit, že chcete vynechat všechny cíle nebo jednotlivé úkoly, pokud jsou splněny určité podmínky.</span><span class="sxs-lookup"><span data-stu-id="40dfa-221">As such, you can choose to omit entire targets or individual tasks if certain conditions are met.</span></span>

<span data-ttu-id="40dfa-222">Obecně řečeno, když vytváříte užitečné úlohy a cíle, budete muset odkazovat na vlastnosti a položky, které jste definovali jinde v souboru projektu:</span><span class="sxs-lookup"><span data-stu-id="40dfa-222">Generally speaking, when you create useful tasks and targets, you'll need to refer to the properties and items that you've defined elsewhere in the project file:</span></span>

- <span data-ttu-id="40dfa-223">Chcete-li použít hodnotu vlastnosti, zadejte **$ (***PropertyName***)** , kde *PropertyName* je název elementu **vlastnosti** nebo název parametru.</span><span class="sxs-lookup"><span data-stu-id="40dfa-223">To use a property value, type **$(***PropertyName***)**, where *PropertyName* is the name of the **Property** element or the name of the parameter.</span></span>
- <span data-ttu-id="40dfa-224">Chcete-li použít položku, zadejte **@ (***Item***)** , kde *Item* je název elementu **Item** .</span><span class="sxs-lookup"><span data-stu-id="40dfa-224">To use an item, type **@(***ItemName***)**, where *ItemName* is the name of the **Item** element.</span></span>

> [!NOTE]
> <span data-ttu-id="40dfa-225">Pamatujte, že pokud vytvoříte více položek se stejným názvem, vytváříte seznam.</span><span class="sxs-lookup"><span data-stu-id="40dfa-225">Remember that if you create multiple items with the same name, you're building a list.</span></span> <span data-ttu-id="40dfa-226">Naopak pokud vytvoříte více vlastností se stejným názvem, přepíše hodnota poslední vlastnosti, kterou poskytnete, všechny předchozí vlastnosti se stejným názvem&#x2014;. vlastnost může obsahovat pouze jednu hodnotu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-226">In contrast, if you create multiple properties with the same name, the last property value you provide will overwrite any previous properties with the same name&#x2014;a property can only contain a single value.</span></span>

<span data-ttu-id="40dfa-227">Například v souboru *Publish. proj* v ukázkovém řešení si prohlédněte cíl **BuildProjects** .</span><span class="sxs-lookup"><span data-stu-id="40dfa-227">For example, in the *Publish.proj* file in the sample solution, take a look at the **BuildProjects** target.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample13.xml)]

<span data-ttu-id="40dfa-228">V této ukázce můžete sledovat tyto klíčové body:</span><span class="sxs-lookup"><span data-stu-id="40dfa-228">In this sample, you can observe these key points:</span></span>

- <span data-ttu-id="40dfa-229">Pokud je zadán parametr **BuildingInTeamBuild** a má hodnotu **true**, nebude provedena žádná z úloh v tomto cíli.</span><span class="sxs-lookup"><span data-stu-id="40dfa-229">If the **BuildingInTeamBuild** parameter is specified and has a value of **true**, none of the tasks within this target will be executed.</span></span>
- <span data-ttu-id="40dfa-230">Cíl obsahuje jednu instanci úlohy [MSBuild](https://msdn.microsoft.com/library/z7f65y0d.aspx) .</span><span class="sxs-lookup"><span data-stu-id="40dfa-230">The target contains a single instance of the [MSBuild](https://msdn.microsoft.com/library/z7f65y0d.aspx) task.</span></span> <span data-ttu-id="40dfa-231">Tato úloha umožňuje sestavit další projekty MSBuild.</span><span class="sxs-lookup"><span data-stu-id="40dfa-231">This task lets you build other MSBuild projects.</span></span>
- <span data-ttu-id="40dfa-232">Položka **ProjectsToBuild** je předána úkolu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-232">The **ProjectsToBuild** item is passed to the task.</span></span> <span data-ttu-id="40dfa-233">Tato položka může představovat seznam souborů projektu nebo řešení, které jsou definovány elementy **ProjectsToBuild** Item v rámci skupiny položek.</span><span class="sxs-lookup"><span data-stu-id="40dfa-233">This item could represent a list of project or solution files, all defined by **ProjectsToBuild** item elements within an item group.</span></span> <span data-ttu-id="40dfa-234">V tomto případě položka **ProjectsToBuild** odkazuje na jeden soubor řešení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-234">In this case, the **ProjectsToBuild** item refers to a single solution file.</span></span>

    [!code-xml[Main](understanding-the-project-file/samples/sample14.xml)]
- <span data-ttu-id="40dfa-235">Hodnoty vlastností předané do úlohy **MSBuild** obsahují parametry s názvem **OutputRoot** a **Konfigurace**.</span><span class="sxs-lookup"><span data-stu-id="40dfa-235">The property values passed to the **MSBuild** task include parameters named **OutputRoot** and **Configuration**.</span></span> <span data-ttu-id="40dfa-236">Ty jsou nastaveny na hodnoty parametrů, pokud jsou k dispozici, nebo hodnoty statických vlastností, pokud nejsou.</span><span class="sxs-lookup"><span data-stu-id="40dfa-236">These are set to parameter values if they are provided, or static property values if they are not.</span></span>

    [!code-xml[Main](understanding-the-project-file/samples/sample15.xml)]

<span data-ttu-id="40dfa-237">Můžete také zjistit, že úloha **MSBuild** vyvolá cíl s názvem **Build**.</span><span class="sxs-lookup"><span data-stu-id="40dfa-237">You can also see that the **MSBuild** task invokes a target named **Build**.</span></span> <span data-ttu-id="40dfa-238">Toto je jeden z několika předdefinovaných cílů, které se běžně používají v souborech projektu sady Visual Studio a jsou k dispozici ve vlastních souborech projektu, jako je **sestavení**, **Vyčištění**, **opětovné sestavení**a **publikování**.</span><span class="sxs-lookup"><span data-stu-id="40dfa-238">This is one of several built-in targets that are widely used in Visual Studio project files and are available to you in your custom project files, like **Build**, **Clean**, **Rebuild**, and **Publish**.</span></span> <span data-ttu-id="40dfa-239">Přečtěte si další informace o použití cílů a úloh pro řízení procesu sestavení a o tom, co je potřeba pro úlohu **MSBuild** zejména v tomto tématu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-239">You'll learn more about using targets and tasks to control the build process, and about the **MSBuild** task in particular, later in this topic.</span></span>

> [!NOTE]
> <span data-ttu-id="40dfa-240">Další informace o cílech naleznete v tématu [cíle nástroje MSBuild](https://msdn.microsoft.com/library/ms171462.aspx).</span><span class="sxs-lookup"><span data-stu-id="40dfa-240">For more information on targets, see [MSBuild Targets](https://msdn.microsoft.com/library/ms171462.aspx).</span></span>

## <a name="splitting-project-files-to-support-multiple-environments"></a><span data-ttu-id="40dfa-241">Rozdělování souborů projektu pro podporu více prostředí</span><span class="sxs-lookup"><span data-stu-id="40dfa-241">Splitting Project Files to Support Multiple Environments</span></span>

<span data-ttu-id="40dfa-242">Předpokládejme, že chcete být schopni nasadit řešení do více prostředí, jako jsou testovací servery, pracovní platformy a produkční prostředí.</span><span class="sxs-lookup"><span data-stu-id="40dfa-242">Suppose you want to be able to deploy a solution to multiple environments, like test servers, staging platforms, and production environments.</span></span> <span data-ttu-id="40dfa-243">Konfigurace se může podstatně lišit mezi těmito prostředími&#x2014;, a to nejen z hlediska názvů serverů, připojovacích řetězců atd., ale také potenciálně z hlediska přihlašovacích údajů, nastavení zabezpečení a spousty dalších faktorů.</span><span class="sxs-lookup"><span data-stu-id="40dfa-243">The configuration may vary substantially between these environments&#x2014;not just in terms of server names, connection strings, and so on, but also potentially in terms of credentials, security settings, and lots of other factors.</span></span> <span data-ttu-id="40dfa-244">Pokud to potřebujete udělat pravidelně, není ve skutečnosti vhodné upravovat více vlastností v souboru projektu pokaždé, když přepínáte cílové prostředí.</span><span class="sxs-lookup"><span data-stu-id="40dfa-244">If you need to do this regularly, it's not really expedient to edit multiple properties in your project file every time you switch the target environment.</span></span> <span data-ttu-id="40dfa-245">Ani to není ideální řešení pro vyžadování nekonečné seznamu hodnot vlastností, které mají být poskytnuty procesu sestavení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-245">Nor is it an ideal solution to require an endless list of property values to be provided to the build process.</span></span>

<span data-ttu-id="40dfa-246">Naštěstí existuje alternativa.</span><span class="sxs-lookup"><span data-stu-id="40dfa-246">Fortunately there is an alternative.</span></span> <span data-ttu-id="40dfa-247">Nástroj MSBuild umožňuje rozdělit konfiguraci sestavení napříč více soubory projektu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-247">MSBuild lets you split your build configuration across multiple project files.</span></span> <span data-ttu-id="40dfa-248">Chcete-li zjistit, jak to funguje, v ukázkovém řešení si všimněte, že existují dva vlastní soubory projektu:</span><span class="sxs-lookup"><span data-stu-id="40dfa-248">To see how this works, in the sample solution, notice that there are two custom project files:</span></span>

- <span data-ttu-id="40dfa-249">*Publish. proj*, který obsahuje vlastnosti, položky a cíle, které jsou společné pro všechna prostředí.</span><span class="sxs-lookup"><span data-stu-id="40dfa-249">*Publish.proj*, which contains properties, items, and targets that are common to all environments.</span></span>
- <span data-ttu-id="40dfa-250">*ENV-dev. proj*obsahující vlastnosti, které jsou specifické pro vývojářské prostředí.</span><span class="sxs-lookup"><span data-stu-id="40dfa-250">*Env-Dev.proj*, which contains properties that are specific to a developer environment.</span></span>

<span data-ttu-id="40dfa-251">Nyní si všimněte, že soubor *Publish. proj* obsahuje prvek [Import](https://msdn.microsoft.com/library/92x05xfs.aspx) , který je bezprostředně pod otevírací značkou **projektu** .</span><span class="sxs-lookup"><span data-stu-id="40dfa-251">Now notice that the *Publish.proj* file includes an [Import](https://msdn.microsoft.com/library/92x05xfs.aspx) element, immediately beneath the opening **Project** tag.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample16.xml)]

<span data-ttu-id="40dfa-252">Element **Import** slouží k importu obsahu jiného souboru projektu MSBuild do aktuálního souboru projektu MSBuild.</span><span class="sxs-lookup"><span data-stu-id="40dfa-252">The **Import** element is used to import the contents of another MSBuild project file into the current MSBuild project file.</span></span> <span data-ttu-id="40dfa-253">V tomto případě parametr **TargetEnvPropsFile** poskytuje název souboru projektu, který chcete importovat.</span><span class="sxs-lookup"><span data-stu-id="40dfa-253">In this case, the **TargetEnvPropsFile** parameter provides the filename of the project file you want to import.</span></span> <span data-ttu-id="40dfa-254">Můžete zadat hodnotu pro tento parametr při spuštění nástroje MSBuild.</span><span class="sxs-lookup"><span data-stu-id="40dfa-254">You can provide a value for this parameter when you run MSBuild.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample17.cmd)]

<span data-ttu-id="40dfa-255">Tím se efektivně sloučí obsah těchto dvou souborů do jediného souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-255">This effectively merges the contents of the two files into a single project file.</span></span> <span data-ttu-id="40dfa-256">Pomocí tohoto přístupu můžete vytvořit jeden soubor projektu obsahující konfiguraci univerzálního sestavení a více doplňkových souborů projektu obsahující vlastnosti specifické pro prostředí.</span><span class="sxs-lookup"><span data-stu-id="40dfa-256">Using this approach, you can create one project file containing your universal build configuration and multiple supplementary project files containing environment-specific properties.</span></span> <span data-ttu-id="40dfa-257">V důsledku toho stačí spustit příkaz s jinou hodnotou parametru, který umožňuje nasazení řešení do jiného prostředí.</span><span class="sxs-lookup"><span data-stu-id="40dfa-257">As a result, simply running a command with a different parameter value lets you deploy your solution to a different environment.</span></span>

![](understanding-the-project-file/_static/image3.png)

<span data-ttu-id="40dfa-258">Rozdělení souborů projektu tímto způsobem je dobrý postup.</span><span class="sxs-lookup"><span data-stu-id="40dfa-258">Splitting your project files in this way is a good practice to follow.</span></span> <span data-ttu-id="40dfa-259">Umožňuje vývojářům nasazovat do více prostředí spuštěním jediného příkazu, přičemž se vyhnete duplikování vlastností univerzálního sestavení napříč více soubory projektu.</span><span class="sxs-lookup"><span data-stu-id="40dfa-259">It allows developers to deploy to multiple environments by running a single command, while avoiding the duplication of universal build properties across multiple project files.</span></span>

> [!NOTE]
> <span data-ttu-id="40dfa-260">Pokyny k přizpůsobení souborů projektu specifických pro prostředí pro vlastní serverová prostředí najdete v tématu [Konfigurace vlastností nasazení pro cílové prostředí](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).</span><span class="sxs-lookup"><span data-stu-id="40dfa-260">For guidance on how to customize the environment-specific project files for your own server environments, see [Configuring Deployment Properties for a Target Environment](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="40dfa-261">Závěr</span><span class="sxs-lookup"><span data-stu-id="40dfa-261">Conclusion</span></span>

<span data-ttu-id="40dfa-262">Toto téma poskytuje obecné informace o souborech projektu MSBuild a vysvětluje, jak můžete vytvořit vlastní soubory projektu pro řízení procesu sestavení.</span><span class="sxs-lookup"><span data-stu-id="40dfa-262">This topic provided a general introduction to MSBuild project files and explained how you can create your own custom project files to control the build process.</span></span> <span data-ttu-id="40dfa-263">Představil také koncept rozdělení souborů projektu na pokyny pro univerzální sestavení a vlastnosti sestavení specifické pro prostředí, které usnadňují sestavování a nasazování projektů do více cílů.</span><span class="sxs-lookup"><span data-stu-id="40dfa-263">It also introduced the concept of splitting project files into universal build instructions and environment-specific build properties, to make it easy to build and deploy projects to multiple destinations.</span></span>

<span data-ttu-id="40dfa-264">V dalším tématu [Principy procesu sestavení](understanding-the-build-process.md)poskytujeme další informace o tom, jak můžete použít soubory projektu k řízení sestavení a nasazení, a Projděte si nasazení řešení s realistickým stupněm složitosti.</span><span class="sxs-lookup"><span data-stu-id="40dfa-264">The next topic, [Understanding the Build Process](understanding-the-build-process.md), provides more insight into how you can use project files to control build and deployment by walking you through the deployment of a solution with a realistic level of complexity.</span></span>

## <a name="further-reading"></a><span data-ttu-id="40dfa-265">Další čtení</span><span class="sxs-lookup"><span data-stu-id="40dfa-265">Further Reading</span></span>

<span data-ttu-id="40dfa-266">Podrobné seznámení se soubory projektu a WPP naleznete v části [uvnitř Microsoft Build Engine: použití nástroje MSBuild a Team Foundation Build](http://amzn.com/0735645248) podle Sayed Ibrahim Hashimi a William Bartholomew, ISBN: 978-0-7356-4524-0.</span><span class="sxs-lookup"><span data-stu-id="40dfa-266">For a more in-depth introduction to project files and the WPP, see [Inside the Microsoft Build Engine: Using MSBuild and Team Foundation Build](http://amzn.com/0735645248) by Sayed Ibrahim Hashimi and William Bartholomew, ISBN: 978-0-7356-4524-0.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="40dfa-267">[Předchozí](setting-up-the-contact-manager-solution.md)
> [Další](understanding-the-build-process.md)</span><span class="sxs-lookup"><span data-stu-id="40dfa-267">[Previous](setting-up-the-contact-manager-solution.md)
[Next](understanding-the-build-process.md)</span></span>
