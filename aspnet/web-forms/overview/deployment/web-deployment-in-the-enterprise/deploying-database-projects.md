---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-database-projects
title: Nasazení projektu databáze | Dokumentace Microsoftu
author: jrjlee
description: 'Poznámka: V mnoha scénářích nasazení enterprise potřebujete mít možnost publikovat přírůstkové aktualizace nasazené databáze. Alternativou je znovu vytvořit...'
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 832f226a-1aa3-4093-8c29-ce4196793259
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-database-projects
msc.type: authoredcontent
ms.openlocfilehash: f5b7cecdd1a8dbd9be1bd781cec31c53c9096546
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/09/2019
ms.locfileid: "59383216"
---
# <a name="deploying-database-projects"></a><span data-ttu-id="ca804-104">Nasazení databázových projektů</span><span class="sxs-lookup"><span data-stu-id="ca804-104">Deploying Database Projects</span></span>

<span data-ttu-id="ca804-105">podle [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="ca804-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="ca804-106">Stáhnout PDF</span><span class="sxs-lookup"><span data-stu-id="ca804-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> [!NOTE]
> <span data-ttu-id="ca804-107">V mnoha scénářích nasazení enterprise potřebujete mít možnost publikovat přírůstkové aktualizace nasazené databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-107">In lots of enterprise deployment scenarios, you need the ability to publish incremental updates to a deployed database.</span></span> <span data-ttu-id="ca804-108">Alternativou je znovu vytvořit databázi na každé nasazení, což znamená, že ztratíte všechna data v existující databázi.</span><span class="sxs-lookup"><span data-stu-id="ca804-108">The alternative is to recreate the database on every deployment, which means you lose any data in the existing database.</span></span> <span data-ttu-id="ca804-109">Pokud pracujete se sadou Visual Studio 2010, pomocí VSDBCMD je doporučený postup pro přírůstkové publikování databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-109">When you work with Visual Studio 2010, using VSDBCMD is the recommended approach to incremental database publishing.</span></span> <span data-ttu-id="ca804-110">Další verze sady Visual Studio a webové publikování kanálu (WPP) však bude obsahovat nástroje, které podporuje přírůstkové publikování přímo.</span><span class="sxs-lookup"><span data-stu-id="ca804-110">However, the next version of Visual Studio and the Web Publishing Pipeline (WPP) will include tooling that supports incremental publishing directly.</span></span>


<span data-ttu-id="ca804-111">Pokud otevřete ukázkové řešení Správce kontaktů v sadě Visual Studio 2010, uvidíte, že databázový projekt obsahuje vlastnosti složky, která obsahuje čtyři soubory.</span><span class="sxs-lookup"><span data-stu-id="ca804-111">If you open the Contact Manager sample solution in Visual Studio 2010, you'll see that the database project includes a Properties folder that contains four files.</span></span>

![](deploying-database-projects/_static/image1.png)

<span data-ttu-id="ca804-112">Spolu s souboru projektu (*ContactManager.Database.dbproj* v tomto případě), tyto soubory určují různé aspekty procesu sestavení a nasazení:</span><span class="sxs-lookup"><span data-stu-id="ca804-112">Together with the project file (*ContactManager.Database.dbproj* in this case), these files control various aspects of the build and deployment process:</span></span>

- <span data-ttu-id="ca804-113">*Database.sqlcmdvars* soubor obsahuje hodnoty pro všechny proměnné SQLCMD používat při nasazování projektu.</span><span class="sxs-lookup"><span data-stu-id="ca804-113">The *Database.sqlcmdvars* file provides values for any SQLCMD variables you use when you deploy the project.</span></span> <span data-ttu-id="ca804-114">Každé konfigurace řešení (například debug a release) můžete určit různé .sqlcmdvars souboru.</span><span class="sxs-lookup"><span data-stu-id="ca804-114">Each solution configuration (for example, debug and release) can specify a different .sqlcmdvars file.</span></span>
- <span data-ttu-id="ca804-115">*Database.sqldeployment* soubor obsahuje nastavení specifické pro nasazení, například, jestli se má používat kolaci definovaný v projektu nebo kolaci cílovém serveru, jestli se má znovu vytvořit cílové databáze každých čas nebo jednoduše změnit existující databázi a přenést až do data a tak dále.</span><span class="sxs-lookup"><span data-stu-id="ca804-115">The *Database.sqldeployment* file provides deployment-specific settings, like whether to use the collation defined in your project or the collation of the destination server, whether to recreate the destination database every time or simply amend the existing database to bring it up to date, and so on.</span></span> <span data-ttu-id="ca804-116">Každé konfigurace řešení můžete určit různé .sqldeployment souboru.</span><span class="sxs-lookup"><span data-stu-id="ca804-116">Each solution configuration can specify a different .sqldeployment file.</span></span>
- <span data-ttu-id="ca804-117">*Database.sqlpermissions* soubor je dokument XML, který můžete použít k definování všechna oprávnění, které chcete přidat do cílové databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-117">The *Database.sqlpermissions* file is an XML document that you can use to define any permissions you want to add to the target database.</span></span> <span data-ttu-id="ca804-118">Všechny konfigurace řešení sdílet stejný soubor .sqlpermissions.</span><span class="sxs-lookup"><span data-stu-id="ca804-118">All solution configurations share the same .sqlpermissions file.</span></span>
- <span data-ttu-id="ca804-119">*Database.sqlsettings* soubor Určuje vlastnosti databáze pro použití při vytváření databáze, jako je kolaci na použití chování operátory porovnání a tak dále.</span><span class="sxs-lookup"><span data-stu-id="ca804-119">The *Database.sqlsettings* file specifies the database-level properties to use when creating the database, like the collation to use, the behavior of comparison operators, and so on.</span></span> <span data-ttu-id="ca804-120">Všechny konfigurace řešení sdílet stejný soubor .sqlsettings.</span><span class="sxs-lookup"><span data-stu-id="ca804-120">All solution configurations share the same .sqlsettings file.</span></span>

<span data-ttu-id="ca804-121">Je které stojí za to, že si tyto soubory lze otevřít v sadě Visual Studio a seznamte se s obsahem.</span><span class="sxs-lookup"><span data-stu-id="ca804-121">It's worth taking a moment to open these files in Visual Studio and familiarize yourself with the contents.</span></span>

<span data-ttu-id="ca804-122">Když vytvoříte projekt databáze, proces sestavení vytvoří dva soubory:</span><span class="sxs-lookup"><span data-stu-id="ca804-122">When you build a database project, the build process creates two files:</span></span>

- <span data-ttu-id="ca804-123">A *schéma databáze* (.dbschema souboru).</span><span class="sxs-lookup"><span data-stu-id="ca804-123">A *database schema* (.dbschema file).</span></span> <span data-ttu-id="ca804-124">Popisuje schéma databáze, kterou chcete vytvořit ve formátu XML.</span><span class="sxs-lookup"><span data-stu-id="ca804-124">This describes the schema of the database you want to create in XML format.</span></span>
- <span data-ttu-id="ca804-125">A *manifest nasazení* (.deploymanifest souboru).</span><span class="sxs-lookup"><span data-stu-id="ca804-125">A *deployment manifest* (.deploymanifest file).</span></span> <span data-ttu-id="ca804-126">Tato položka obsahuje všechny informace potřebné k vytvoření a nasazení vaší databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-126">This contains all the information required to create and deploy your database.</span></span> <span data-ttu-id="ca804-127">Odkazuje na soubor .dbschema společně s další prostředky, jako jsou pokyny k nasazení (souboru .sqldeployment) a skripty SQL před nasazením nebo po nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-127">It references the .dbschema file along with other resources, like the deployment instructions (the .sqldeployment file) and any pre-deployment or post-deployment SQL scripts.</span></span>

<span data-ttu-id="ca804-128">To znázorňuje vztah mezi tyto prostředky:</span><span class="sxs-lookup"><span data-stu-id="ca804-128">This shows the relationship between these resources:</span></span>

![](deploying-database-projects/_static/image2.png)

<span data-ttu-id="ca804-129">Jak je vidět, .sqlsettings soubor a soubor .sqlpermissions jsou vstupy do procesu sestavení.</span><span class="sxs-lookup"><span data-stu-id="ca804-129">As you can see, the .sqlsettings file and the .sqlpermissions file are inputs to the build process.</span></span> <span data-ttu-id="ca804-130">Chcete se souborem projektu databáze tyto soubory se používají k vytvoření souboru schématu databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-130">Along with the database project file, these files are used to create the database schema file.</span></span> <span data-ttu-id="ca804-131">.Sqldeployment soubor a soubor .sqlcmdvars prochází proces sestavení beze změny.</span><span class="sxs-lookup"><span data-stu-id="ca804-131">The .sqldeployment file and the .sqlcmdvars file pass through the build process unchanged.</span></span> <span data-ttu-id="ca804-132">Manifest nasazení označuje umístění schématu databáze, .sqldeployment souboru, soubor .sqlcmdvars a skripty SQL před nasazením nebo po nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-132">The deployment manifest indicates the location of the database schema, the .sqldeployment file, the .sqlcmdvars file, and any pre-deployment or post-deployment SQL scripts.</span></span>

## <a name="why-use-vsdbcmd-to-deploy-a-database-project"></a><span data-ttu-id="ca804-133">Proč používat VSDBCMD nasadit projekt databáze?</span><span class="sxs-lookup"><span data-stu-id="ca804-133">Why Use VSDBCMD to Deploy a Database Project?</span></span>

<span data-ttu-id="ca804-134">Existují různé různé přístupy k nasazení projektu databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-134">There are various different approaches to deploying database projects.</span></span> <span data-ttu-id="ca804-135">Ale ne všechny jsou vhodné pro nasazení projektu databáze na vzdálené servery v podnikovém prostředí.</span><span class="sxs-lookup"><span data-stu-id="ca804-135">However, not all of them are suitable for deploying a database project to remote servers in an enterprise environment.</span></span> <span data-ttu-id="ca804-136">Zvažte, co chcete z nasazení projektu databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-136">Consider what you want from a database project deployment.</span></span> <span data-ttu-id="ca804-137">V podnikových scénářích nasazení které budete pravděpodobně vhodné:</span><span class="sxs-lookup"><span data-stu-id="ca804-137">In enterprise deployment scenarios, you're likely to want:</span></span>

- <span data-ttu-id="ca804-138">Možnost nasadit projekt databáze ze vzdáleného umístění.</span><span class="sxs-lookup"><span data-stu-id="ca804-138">The ability to deploy the database project from a remote location.</span></span>
- <span data-ttu-id="ca804-139">Možnost provádět přírůstkové aktualizace existující databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-139">The ability to make incremental updates to an existing database.</span></span>
- <span data-ttu-id="ca804-140">O schopnost zahrnovat skripty před nasazením nebo skripty po nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-140">The ability to include pre-deployment scripts or post-deployment scripts.</span></span>
- <span data-ttu-id="ca804-141">Schopnost přizpůsobit nasazení do různých cílové prostředí.</span><span class="sxs-lookup"><span data-stu-id="ca804-141">The ability to tailor the deployment to multiple destination environments.</span></span>
- <span data-ttu-id="ca804-142">Možnost nasadit projekt databáze v rámci větší, obvykle skripty, krokování řešení nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-142">The ability to deploy the database project as part of a larger, typically scripted, single-step solution deployment.</span></span>

<span data-ttu-id="ca804-143">Existují tři hlavní přístupy, které lze použít k nasazení projektu databáze:</span><span class="sxs-lookup"><span data-stu-id="ca804-143">There are three main approaches you can use to deploy a database project:</span></span>

- <span data-ttu-id="ca804-144">Nasazení funkce můžete použít s typem databáze projektu v sadě Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="ca804-144">You can use the deployment functionality with the database project type in Visual Studio 2010.</span></span> <span data-ttu-id="ca804-145">Při vytváření a nasazování databázový projekt v sadě Visual Studio 2010, procesu nasazení používá ke generování specifické pro konfiguraci sestavení nasazení na základě SQL souboru manifest nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-145">When you build and deploy a database project in Visual Studio 2010, the deployment process uses the deployment manifest to generate a SQL-based deployment file specific to the build configuration.</span></span> <span data-ttu-id="ca804-146">Tím se vytvoří databáze, pokud není již existuje nebo proveďte potřebné změny do databáze, pokud již existuje.</span><span class="sxs-lookup"><span data-stu-id="ca804-146">This will create the database if it doesn't already exist or make any necessary changes to the database if it does already exist.</span></span> <span data-ttu-id="ca804-147">Vám pomůže SQLCMD.exe spusťte tento soubor na cílový server, nebo můžete nastavit Visual Studio k vytvoření a spuštění souboru.</span><span class="sxs-lookup"><span data-stu-id="ca804-147">You can use SQLCMD.exe to run this file on your destination server, or you can set Visual Studio to create and run the file.</span></span> <span data-ttu-id="ca804-148">Nevýhody tohoto přístupu je, že máte jenom omezenou kontrolu přes nastavení nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-148">The disadvantage of this approach is that you have only limited control over the deployment settings.</span></span> <span data-ttu-id="ca804-149">Často také budete muset upravit soubor nasazení SQL k poskytování hodnot proměnných pro konkrétní prostředí.</span><span class="sxs-lookup"><span data-stu-id="ca804-149">You may often also need to modify the SQL deployment file to provide environment-specific variable values.</span></span> <span data-ttu-id="ca804-150">Můžete použít pouze tento přístup z počítače se sadou Visual Studio 2010 nainstalovaný a vývojář potřebuje vědět a zadejte připojovací řetězce a přihlašovací údaje pro všechny cílové prostředí.</span><span class="sxs-lookup"><span data-stu-id="ca804-150">You can only use this approach from a computer with Visual Studio 2010 installed, and the developer would need to know and provide connection strings and credentials for all destination environments.</span></span>
- <span data-ttu-id="ca804-151">Vám pomůže nástroj pro nasazení Internetové informační služby (IIS) webu (nasazení webu) [nasadit databázi projektu webové aplikace v rámci](https://msdn.microsoft.com/library/dd465343.aspx).</span><span class="sxs-lookup"><span data-stu-id="ca804-151">You can use the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to [deploy a database as part of a web application project](https://msdn.microsoft.com/library/dd465343.aspx).</span></span> <span data-ttu-id="ca804-152">Tento přístup je však mnohem složitější, pokud chcete nasadit projekt databáze, spíše než replikovat stávající místní databázi na cílovém serveru.</span><span class="sxs-lookup"><span data-stu-id="ca804-152">However, this approach is a lot more complex if you want to deploy a database project rather than simply replicate an existing local database on a destination server.</span></span> <span data-ttu-id="ca804-153">Můžete nakonfigurovat nasazení webu pro spuštění skriptu pro nasazení SQL, který generuje databázového projektu, ale pokud to chcete udělat, je potřeba vytvořit vlastní soubor cílů WPP pro váš projekt webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="ca804-153">You can configure Web Deploy to run the SQL deployment script that the database project generates, but in order to do this, you need to create a custom WPP targets file for your web application project.</span></span> <span data-ttu-id="ca804-154">Tento postup přidá vyžadovat značné množství složitost procesu nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-154">This adds a substantial amount of complexity to the deployment process.</span></span> <span data-ttu-id="ca804-155">Kromě toho Web Deploy přímo nepodporuje přírůstkové aktualizace na stávajících databází.</span><span class="sxs-lookup"><span data-stu-id="ca804-155">In addition, Web Deploy does not directly support incremental updates to existing databases.</span></span> <span data-ttu-id="ca804-156">Další informace o tomto přístupu najdete v tématu [rozšíření Web Publishing Pipeline na databázový projekt balíčku nasazeného souboru SQL](https://go.microsoft.com/?linkid=9805121).</span><span class="sxs-lookup"><span data-stu-id="ca804-156">For more information on this approach, see [Extending the Web Publishing Pipeline to package database project deployed SQL file](https://go.microsoft.com/?linkid=9805121).</span></span>
- <span data-ttu-id="ca804-157">Nástroj VSDBCMD můžete použít k nasazení databáze pomocí schématu databáze nebo manifest nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-157">You can use the VSDBCMD utility to deploy the database, using either the database schema or the deployment manifest.</span></span> <span data-ttu-id="ca804-158">VSDBCMD.exe můžete volat z cíle nástroje MSBuild, který umožňuje publikování databáze jako součást procesu větší a skriptované nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-158">You can call VSDBCMD.exe from an MSBuild target, which lets you publish databases as part of a larger, scripted deployment process.</span></span> <span data-ttu-id="ca804-159">Proměnné v souboru .sqlcmdvars a spoustu dalších vlastností databáze z VSDBCMD příkaz, který vám umožní přizpůsobit nasazení pro různá prostředí bez vytvoření několika konfiguracích sestavení můžete přepsat.</span><span class="sxs-lookup"><span data-stu-id="ca804-159">You can override the variables in your .sqlcmdvars file and lots of other database properties from a VSDBCMD command, which allows you to customize your deployment for different environments without creating multiple build configurations.</span></span> <span data-ttu-id="ca804-160">VSDBCMD poskytuje funkce rozlišení, což znamená, že se provede pouze nezbytné změny zarovnání cílové databáze se schéma vaší databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-160">VSDBCMD provides differentiation functionality, which means it will make only the necessary changes to align a destination database with your database schema.</span></span> <span data-ttu-id="ca804-161">VSDBCMD také nabízí širokou škálu možnosti příkazového řádku, které vám poskytnou přesnou kontrolu nad procesu nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-161">VSDBCMD also offers a wide range of command-line options, which give you fine-grained control over the deployment process.</span></span>

<span data-ttu-id="ca804-162">Z tohoto přehledu uvidíte, že pomocí nástroje MSBuild VSDBCMD je nejvhodnější pro typické podnikové scénáře nasazení:</span><span class="sxs-lookup"><span data-stu-id="ca804-162">From this overview, you can see that using VSDBCMD with MSBuild is the approach best suited to a typical enterprise deployment scenario:</span></span>

|  | <span data-ttu-id="ca804-163">Visual Studio 2010</span><span class="sxs-lookup"><span data-stu-id="ca804-163">Visual Studio 2010</span></span> | <span data-ttu-id="ca804-164">Web Deploy 2.0</span><span class="sxs-lookup"><span data-stu-id="ca804-164">Web Deploy 2.0</span></span> | <span data-ttu-id="ca804-165">VSDBCMD.exe</span><span class="sxs-lookup"><span data-stu-id="ca804-165">VSDBCMD.exe</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="ca804-166">Podporuje vzdálené nasazení?</span><span class="sxs-lookup"><span data-stu-id="ca804-166">Supports remote deployment?</span></span> | <span data-ttu-id="ca804-167">Ano</span><span class="sxs-lookup"><span data-stu-id="ca804-167">Yes</span></span> | <span data-ttu-id="ca804-168">Ano</span><span class="sxs-lookup"><span data-stu-id="ca804-168">Yes</span></span> | <span data-ttu-id="ca804-169">Ano</span><span class="sxs-lookup"><span data-stu-id="ca804-169">Yes</span></span> |
| <span data-ttu-id="ca804-170">Podporuje přírůstkové aktualizace?</span><span class="sxs-lookup"><span data-stu-id="ca804-170">Supports incremental updates?</span></span> | <span data-ttu-id="ca804-171">Ano</span><span class="sxs-lookup"><span data-stu-id="ca804-171">Yes</span></span> | <span data-ttu-id="ca804-172">Ne</span><span class="sxs-lookup"><span data-stu-id="ca804-172">No</span></span> | <span data-ttu-id="ca804-173">Ano</span><span class="sxs-lookup"><span data-stu-id="ca804-173">Yes</span></span> |
| <span data-ttu-id="ca804-174">Podporuje skripty před/po-deployment?</span><span class="sxs-lookup"><span data-stu-id="ca804-174">Supports pre/post-deployment scripts?</span></span> | <span data-ttu-id="ca804-175">Ano</span><span class="sxs-lookup"><span data-stu-id="ca804-175">Yes</span></span> | <span data-ttu-id="ca804-176">Ano</span><span class="sxs-lookup"><span data-stu-id="ca804-176">Yes</span></span> | <span data-ttu-id="ca804-177">Ano</span><span class="sxs-lookup"><span data-stu-id="ca804-177">Yes</span></span> |
| <span data-ttu-id="ca804-178">Podporuje nasazení více prostředí?</span><span class="sxs-lookup"><span data-stu-id="ca804-178">Supports multi-environment deployment?</span></span> | <span data-ttu-id="ca804-179">Limited</span><span class="sxs-lookup"><span data-stu-id="ca804-179">Limited</span></span> | <span data-ttu-id="ca804-180">Limited</span><span class="sxs-lookup"><span data-stu-id="ca804-180">Limited</span></span> | <span data-ttu-id="ca804-181">Ano</span><span class="sxs-lookup"><span data-stu-id="ca804-181">Yes</span></span> |
| <span data-ttu-id="ca804-182">Podporuje nasazení?</span><span class="sxs-lookup"><span data-stu-id="ca804-182">Supports scripted deployment?</span></span> | <span data-ttu-id="ca804-183">Limited</span><span class="sxs-lookup"><span data-stu-id="ca804-183">Limited</span></span> | <span data-ttu-id="ca804-184">Ano</span><span class="sxs-lookup"><span data-stu-id="ca804-184">Yes</span></span> | <span data-ttu-id="ca804-185">Ano</span><span class="sxs-lookup"><span data-stu-id="ca804-185">Yes</span></span> |

<span data-ttu-id="ca804-186">Zbývající část tohoto tématu popisuje použití VSDBCMD pomocí nástroje MSBuild k nasazení databázové projekty.</span><span class="sxs-lookup"><span data-stu-id="ca804-186">The remainder of this topic describes the use of VSDBCMD with MSBuild to deploy database projects.</span></span>

## <a name="understanding-the-deployment-process"></a><span data-ttu-id="ca804-187">Principy procesu nasazení</span><span class="sxs-lookup"><span data-stu-id="ca804-187">Understanding the Deployment Process</span></span>

<span data-ttu-id="ca804-188">Nástroj VSDBCMD vám umožní nasadit databázi pomocí schéma databáze (soubor .dbschema) nebo manifestu nasazení (souboru .deploymanifest).</span><span class="sxs-lookup"><span data-stu-id="ca804-188">The VSDBCMD utility lets you deploy a database using either the database schema (the .dbschema file) or the deployment manifest (the .deploymanifest file).</span></span> <span data-ttu-id="ca804-189">V praxi téměř vždy použijete manifestu nasazení, protože manifest nasazení umožňuje zadat výchozí hodnoty pro různé vlastnosti nasazení a identifikovat všechny skripty SQL před nasazením nebo po nasazení, které chcete spustit.</span><span class="sxs-lookup"><span data-stu-id="ca804-189">In practice, you'll almost always use the deployment manifest, as the deployment manifest lets you provide default values for various deployment properties and identify any pre-deployment or post-deployment SQL scripts you want to run.</span></span> <span data-ttu-id="ca804-190">Třeba tento příkaz VSDBCMD slouží k nasazování **ContactManager** databáze pro databázový server v testovacím prostředí:</span><span class="sxs-lookup"><span data-stu-id="ca804-190">For example, this VSDBCMD command is used to deploy the **ContactManager** database to a database server in a test environment:</span></span>


[!code-console[Main](deploying-database-projects/samples/sample1.cmd)]


<span data-ttu-id="ca804-191">V tomto případě:</span><span class="sxs-lookup"><span data-stu-id="ca804-191">In this case:</span></span>

- <span data-ttu-id="ca804-192">**/A** (nebo **/Action**) přepínač určuje, co chcete VSDBCMD udělat.</span><span class="sxs-lookup"><span data-stu-id="ca804-192">The **/a** (or **/Action**) switch specifies what you want VSDBCMD to do.</span></span> <span data-ttu-id="ca804-193">Tento parametr můžete nastavit **Import** nebo **nasadit**.</span><span class="sxs-lookup"><span data-stu-id="ca804-193">You can set this to **Import** or **Deploy**.</span></span> <span data-ttu-id="ca804-194">**Import** možnost se používá ke generování souboru .dbschema z existující databáze a **nasadit** možnost se používá k nasazení souboru .dbschema do cílové databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-194">The **Import** option is used to generate a .dbschema file from an existing database, and the **Deploy** option is used to deploy a .dbschema file to a target database.</span></span>
- <span data-ttu-id="ca804-195">**/Manifest** (nebo **manifestfile**) identifikuje přepínač .deploymanifest soubor, který chcete nasadit.</span><span class="sxs-lookup"><span data-stu-id="ca804-195">The **/manifest** (or **/ManifestFile**) switch identifies the .deploymanifest file you want to deploy.</span></span> <span data-ttu-id="ca804-196">Pokud chcete místo toho použijte soubor .dbschema, můžete využít **/model** (nebo **/ModelFile**) přepnutí.</span><span class="sxs-lookup"><span data-stu-id="ca804-196">If you wanted to use the .dbschema file instead, you'd use the **/model** (or **/ModelFile**) switch.</span></span>
- <span data-ttu-id="ca804-197">**Protokolovacímu** (nebo **/ConnectionString**) přepínač obsahuje připojovací řetězec pro cílový server databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-197">The **/cs** (or **/ConnectionString**) switch provides the connection string for the target database server.</span></span> <span data-ttu-id="ca804-198">Všimněte si, že to nebude obsahovat název databáze&#x2014;VSDBCMD potřebuje pro připojení k serveru a vytvořte databázi. není nutné se připojit k jednotlivé databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-198">Note that this doesn't include the name of the database&#x2014;VSDBCMD needs to connect to the server to create the database; it doesn't need to connect to an individual database.</span></span> <span data-ttu-id="ca804-199">Pokud váš soubor .deploymanifest obsahuje připojovací řetězec, můžete vynechat tento přepínač.</span><span class="sxs-lookup"><span data-stu-id="ca804-199">If your .deploymanifest file includes a connection string, you can omit this switch.</span></span> <span data-ttu-id="ca804-200">Pokud je i přesto použít přepínač, hodnota přepínače přepíše .deploymanifest hodnotu.</span><span class="sxs-lookup"><span data-stu-id="ca804-200">If you use the switch anyway, the switch value will override the .deploymanifest value.</span></span>
- <span data-ttu-id="ca804-201"><strong>/P:TargetDatabase</strong> vlastnosti obsahuje název, kterou chcete přiřadit k cílové databázi vytvoření.</span><span class="sxs-lookup"><span data-stu-id="ca804-201">The <strong>/p:TargetDatabase</strong> property provides the name you want to assign to the target database on creation.</span></span> <span data-ttu-id="ca804-202">Tím se přepíše hodnotu <strong>TargetDatabase</strong> vlastnost v souboru .deploymanifest.</span><span class="sxs-lookup"><span data-stu-id="ca804-202">This overrides the value of the <strong>TargetDatabase</strong> property in the .deploymanifest file.</span></span> <span data-ttu-id="ca804-203">Můžete použít <strong>/p:</strong> <em>[název vlastnosti]</em>řiďte se syntaxí nastavit celou řadu vlastností nasazení k přepsání proměnných SQLCMD deklarované v souboru .sqlcmdvars.</span><span class="sxs-lookup"><span data-stu-id="ca804-203">You can use the <strong>/p:</strong> <em>[property name]</em>syntax to set a wide variety of deployment properties and to override any SQLCMD variables declared in your .sqlcmdvars file.</span></span>
- <span data-ttu-id="ca804-204">**/Dd+** (nebo **/DeployToDatabase+**) přepínač označuje, že chcete nasazení taky můžete vytvořit a nasadit ho do cílového prostředí.</span><span class="sxs-lookup"><span data-stu-id="ca804-204">The **/dd+** (or **/DeployToDatabase+**) switch indicates that you want to create a deployment and deploy it to the target environment.</span></span> <span data-ttu-id="ca804-205">Pokud zadáte **/dd-**, nebo vynechejte přepínač, VSDBCMD bude generovat skript nasazení, ale nebudou ji nasadit do cílového prostředí.</span><span class="sxs-lookup"><span data-stu-id="ca804-205">If you specify **/dd-**, or omit the switch, VSDBCMD will generate a deployment script but will not deploy it to the target environment.</span></span> <span data-ttu-id="ca804-206">Tento přepínač je často zdroji záměny a je vysvětlené podrobněji v další části.</span><span class="sxs-lookup"><span data-stu-id="ca804-206">This switch is often the source of confusion and is explained in more detail in the next section.</span></span>
- <span data-ttu-id="ca804-207">**/Script** (nebo **/DeploymentScriptFile**) přepínač určuje, ve které chcete generovat skript nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-207">The **/script** (or **/DeploymentScriptFile**) switch specifies where you want to generate the deployment script.</span></span> <span data-ttu-id="ca804-208">Tato hodnota nemá vliv na proces nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-208">This value does not affect the deployment process.</span></span>

<span data-ttu-id="ca804-209">Další informace o VSDBCMD najdete v tématu [Reference k příkazovému řádku pro VSDBCMD. Soubor EXE (nasazení a Import schématu)](https://msdn.microsoft.com/library/dd193283.aspx) a [jak: Příprava databáze pro nasazení z příkazového řádku s použitím VSDBCMD. Soubor EXE](https://msdn.microsoft.com/library/dd193258.aspx).</span><span class="sxs-lookup"><span data-stu-id="ca804-209">For more information on VSDBCMD, see [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx) and [How to: Prepare a Database for Deployment From a Command Prompt by Using VSDBCMD.EXE](https://msdn.microsoft.com/library/dd193258.aspx).</span></span>

<span data-ttu-id="ca804-210">Příklad použití VSDBCMD ze souboru projektu MSBuild, naleznete v tématu [Principy procesu sestavení](understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="ca804-210">For an example of how you can use VSDBCMD from an MSBuild project file, see [Understanding the Build Process](understanding-the-build-process.md).</span></span> <span data-ttu-id="ca804-211">Příklady, jak nakonfigurovat nastavení nasazení databáze pro více prostředí, najdete v článku [přizpůsobení nasazené databáze pro více prostředí](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="ca804-211">For examples of how to configure database deployment settings for multiple environments, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span>

## <a name="understanding-the-deploytodatabase-switch"></a><span data-ttu-id="ca804-212">Principy DeployToDatabase přepínače</span><span class="sxs-lookup"><span data-stu-id="ca804-212">Understanding the DeployToDatabase Switch</span></span>

<span data-ttu-id="ca804-213">Chování **/dd** nebo **/DeployToDatabase** přepínač závisí na tom, jestli používáte VSDBCMD s .dbschema soubor nebo soubor .deploymanifest.</span><span class="sxs-lookup"><span data-stu-id="ca804-213">The behavior of the **/dd** or **/DeployToDatabase** switch depends on whether you're using VSDBCMD with a .dbschema file or a .deploymanifest file.</span></span> <span data-ttu-id="ca804-214">Pokud používáte soubor .dbschema, je poměrně jednoduché chování:</span><span class="sxs-lookup"><span data-stu-id="ca804-214">If you're using a .dbschema file, the behavior is fairly straightforward:</span></span>

- <span data-ttu-id="ca804-215">Pokud zadáte **/dd+** nebo **/dd**, VSDBCMD vygenerovat skript nasazení a nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-215">If you specify **/dd+** or **/dd**, VSDBCMD will generate a deployment script and deploy the database.</span></span>
- <span data-ttu-id="ca804-216">Pokud zadáte **/dd-** nebo vynechejte přepínač, VSDBCMD vygeneruje jenom skript nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-216">If you specify **/dd-** or omit the switch, VSDBCMD will generate a deployment script only.</span></span>

<span data-ttu-id="ca804-217">Pokud používáte soubor .deploymanifest, chování je mnohem složitější.</span><span class="sxs-lookup"><span data-stu-id="ca804-217">If you're using a .deploymanifest file, the behavior is a lot more complicated.</span></span> <span data-ttu-id="ca804-218">Důvodem je, že soubor .deploymanifest obsahuje název vlastnosti **DeployToDatabase** , která také určuje, zda je nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-218">This is because the .deploymanifest file contains a property name **DeployToDatabase** that also determines whether the database is deployed.</span></span>


[!code-xml[Main](deploying-database-projects/samples/sample2.xml)]


<span data-ttu-id="ca804-219">Hodnota této vlastnosti je nastavena podle vlastnosti projektu databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-219">The value of this property is set according to the properties of the database project.</span></span> <span data-ttu-id="ca804-220">Pokud nastavíte **nasazení akce** k **vytvořit nasazení skriptů (.sql)**, bude hodnota **False**.</span><span class="sxs-lookup"><span data-stu-id="ca804-220">If you set the **Deploy action** to **Create a deployment script (.sql)**, the value will be **False**.</span></span> <span data-ttu-id="ca804-221">Pokud nastavíte **nasazení akce** k **nasazení skriptů (.sql) vytvořit a nasadit do databáze**, bude hodnota **True**.</span><span class="sxs-lookup"><span data-stu-id="ca804-221">If you set the **Deploy action** to **Create a deployment script (.sql) and deploy to the database**, the value will be **True**.</span></span>

> [!NOTE]
> <span data-ttu-id="ca804-222">Tato nastavení jsou spojeny s konkrétní sestavení konfigurace a platforma.</span><span class="sxs-lookup"><span data-stu-id="ca804-222">These settings are associated with a specific build configuration and platform.</span></span> <span data-ttu-id="ca804-223">Například, pokud nakonfigurujete nastavení **ladění** konfigurace a potom publikovat pomocí **vydání** konfigurace, nastavení se nepoužijí.</span><span class="sxs-lookup"><span data-stu-id="ca804-223">For example, if you configure settings for the **Debug** configuration and then publish using the **Release** configuration, your settings will not be used.</span></span>


![](deploying-database-projects/_static/image3.png)

> [!NOTE]
> <span data-ttu-id="ca804-224">V tomto scénáři **nasazení akce** by měla být vždy nastavená na **vytvořit nasazení skriptů (.sql)**, protože nechcete, aby Visual Studio 2010 pro nasazení vaší databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-224">In this scenario, the **Deploy action** should always be set to **Create a deployment script (.sql)**, because you don't want Visual Studio 2010 to deploy your database.</span></span> <span data-ttu-id="ca804-225">Jinými slovy **DeployToDatabase** vlastnost by měla být vždy **False**.</span><span class="sxs-lookup"><span data-stu-id="ca804-225">In other words, the **DeployToDatabase** property should always be **False**.</span></span>


<span data-ttu-id="ca804-226">Když **DeployToDatabase** je zadána vlastnost, **/dd** přepínači pouze přepíše vlastnost, pokud je hodnota vlastnosti **false**:</span><span class="sxs-lookup"><span data-stu-id="ca804-226">When a **DeployToDatabase** property is specified, the **/dd** switch will only override the property if the property value is **false**:</span></span>

- <span data-ttu-id="ca804-227">Pokud **DeployToDatabase** je vlastnost **False**, a zadáte **/dd+** nebo **/dd**, přepíše VSDBCMD  **DeployToDatabase** vlastnost a nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-227">If the **DeployToDatabase** property is **False**, and you specify **/dd+** or **/dd**, VSDBCMD will override the **DeployToDatabase** property and deploy the database.</span></span>
- <span data-ttu-id="ca804-228">Pokud **DeployToDatabase** vlastnost **False**, a zadáte **/dd-** nebo vynechejte přepínač, VSDBCMD nenasadí databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-228">If the **DeployToDatabase** property is **False**, and you specify **/dd-** or omit the switch, VSDBCMD will not deploy the database.</span></span>
- <span data-ttu-id="ca804-229">Pokud **DeployToDatabase** vlastnost **True**, VSDBCMD bude ignorovat přepínač a nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="ca804-229">If the **DeployToDatabase** property is **True**, VSDBCMD will ignore the switch and deploy the database.</span></span>
- <span data-ttu-id="ca804-230">V každém případě bez ohledu na to, jestli nasazujete databáze také se vygeneruje skript nasazení.</span><span class="sxs-lookup"><span data-stu-id="ca804-230">A deployment script is generated in each case, regardless of whether you're deploying the database as well.</span></span>

## <a name="conclusion"></a><span data-ttu-id="ca804-231">Závěr</span><span class="sxs-lookup"><span data-stu-id="ca804-231">Conclusion</span></span>

<span data-ttu-id="ca804-232">Toto téma poskytuje přehled o procesu sestavení a nasazení pro databázové projekty v sadě Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="ca804-232">This topic provided an overview of the build and deployment process for database projects in Visual Studio 2010.</span></span> <span data-ttu-id="ca804-233">Také popsáno, jak můžete VSDBCMD.exe pomocí nástroje MSBuild pro podporu nasazení databáze celého podniku.</span><span class="sxs-lookup"><span data-stu-id="ca804-233">It also described how you can use VSDBCMD.exe with MSBuild to support enterprise-scale database deployment.</span></span>

<span data-ttu-id="ca804-234">Další informace o tom, jak to funguje v praxi, najdete v části [přizpůsobení nasazené databáze pro více prostředí](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="ca804-234">For more information on how this works in practice, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span>

## <a name="further-reading"></a><span data-ttu-id="ca804-235">Další čtení</span><span class="sxs-lookup"><span data-stu-id="ca804-235">Further Reading</span></span>

<span data-ttu-id="ca804-236">Informace o tom, jak přizpůsobit tak, že vytvoříte konfigurační soubor samostatného nasazení pro jednotlivá prostředí nasazení databází najdete v tématu [přizpůsobení nasazené databáze pro více prostředí](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="ca804-236">For information on how to customize database deployments by creating a separate deployment configuration file for each environment, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span> <span data-ttu-id="ca804-237">Pokyny ke konfiguraci členství v databázových rolích spuštěním skriptu po nasazení najdete v tématu [nasazení členstvím v databázových rolích do testovacího prostředí](../advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments.md).</span><span class="sxs-lookup"><span data-stu-id="ca804-237">For guidance on how to configure database role memberships by running a post-deployment script, see [Deploying Database Role Memberships to Test Environments](../advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments.md).</span></span> <span data-ttu-id="ca804-238">Pokyny týkající se správy některé jedinečné výzvy členství databáze uložit naleznete v tématu [nasazení databází členství do podnikových prostředí](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).</span><span class="sxs-lookup"><span data-stu-id="ca804-238">For guidance on managing some of the unique challenges that membership databases impose, see [Deploying Membership Databases to Enterprise Environments](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).</span></span>

<span data-ttu-id="ca804-239">Tato témata na webu MSDN poskytují širší pokyny a základní informace o databázových projektů sady Visual Studio a proces nasazení databáze:</span><span class="sxs-lookup"><span data-stu-id="ca804-239">These topics on MSDN provide broader guidance and background information on Visual Studio database projects and the database deployment process:</span></span>

- [<span data-ttu-id="ca804-240">Visual Studio 2010 Server projekty databází systému SQL</span><span class="sxs-lookup"><span data-stu-id="ca804-240">Visual Studio 2010 SQL Server Database Projects</span></span>](https://msdn.microsoft.com/library/ff678491.aspx)
- [<span data-ttu-id="ca804-241">Správa změn databáze</span><span class="sxs-lookup"><span data-stu-id="ca804-241">Managing Database Change</span></span>](https://msdn.microsoft.com/library/aa833404.aspx)
- [<span data-ttu-id="ca804-242">Postupy: Příprava databáze pro nasazení z příkazového řádku s použitím VSDBCMD. SOUBOR EXE</span><span class="sxs-lookup"><span data-stu-id="ca804-242">How to: Prepare a Database for Deployment From a Command Prompt by Using VSDBCMD.EXE</span></span>](https://msdn.microsoft.com/library/dd193258.aspx)
- [<span data-ttu-id="ca804-243">Přehled databáze sestavení a nasazení</span><span class="sxs-lookup"><span data-stu-id="ca804-243">An Overview of Database Build and Deployment</span></span>](https://msdn.microsoft.com/library/aa833165.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="ca804-244">[Předchozí](deploying-web-packages.md)
> [další](creating-and-running-a-deployment-command-file.md)</span><span class="sxs-lookup"><span data-stu-id="ca804-244">[Previous](deploying-web-packages.md)
[Next](creating-and-running-a-deployment-command-file.md)</span></span>
