---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-database-projects
title: Nasazení databázových projektů | Microsoft Docs
author: jrjlee
description: 'Poznámka: v mnoha scénářích podnikového nasazení potřebujete možnost publikovat přírůstkové aktualizace do nasazené databáze. Alternativou je znovu vytvořit...'
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 832f226a-1aa3-4093-8c29-ce4196793259
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-database-projects
msc.type: authoredcontent
ms.openlocfilehash: 221808758492aedb8e8329364e511df28fd11105
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78634265"
---
# <a name="deploying-database-projects"></a><span data-ttu-id="45b7f-104">Nasazení databázových projektů</span><span class="sxs-lookup"><span data-stu-id="45b7f-104">Deploying Database Projects</span></span>

<span data-ttu-id="45b7f-105">od [Jason Novák](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="45b7f-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="45b7f-106">Stáhnout PDF</span><span class="sxs-lookup"><span data-stu-id="45b7f-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> [!NOTE]
> <span data-ttu-id="45b7f-107">V mnoha scénářích podnikového nasazení potřebujete možnost publikovat přírůstkové aktualizace do nasazené databáze.</span><span class="sxs-lookup"><span data-stu-id="45b7f-107">In lots of enterprise deployment scenarios, you need the ability to publish incremental updates to a deployed database.</span></span> <span data-ttu-id="45b7f-108">Alternativou je opětovné vytvoření databáze při každém nasazení, což znamená, že ztratíte jakákoli data ve stávající databázi.</span><span class="sxs-lookup"><span data-stu-id="45b7f-108">The alternative is to recreate the database on every deployment, which means you lose any data in the existing database.</span></span> <span data-ttu-id="45b7f-109">Při práci se sadou Visual Studio 2010 je doporučený postup pro přírůstkové publikování databáze pomocí VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="45b7f-109">When you work with Visual Studio 2010, using VSDBCMD is the recommended approach to incremental database publishing.</span></span> <span data-ttu-id="45b7f-110">Další verze sady Visual Studio a kanál pro publikování na webu (WPP) ale budou obsahovat nástroje, které přímo podporují přírůstkové publikování.</span><span class="sxs-lookup"><span data-stu-id="45b7f-110">However, the next version of Visual Studio and the Web Publishing Pipeline (WPP) will include tooling that supports incremental publishing directly.</span></span>

<span data-ttu-id="45b7f-111">Pokud otevřete ukázkové řešení Contact Manageru v aplikaci Visual Studio 2010, bude se vám zobrazit, že databázový projekt obsahuje složku vlastností, která obsahuje čtyři soubory.</span><span class="sxs-lookup"><span data-stu-id="45b7f-111">If you open the Contact Manager sample solution in Visual Studio 2010, you'll see that the database project includes a Properties folder that contains four files.</span></span>

![](deploying-database-projects/_static/image1.png)

<span data-ttu-id="45b7f-112">Společně se souborem projektu (*ContactManager. Database. dbproj* v tomto případě) řídí tyto soubory různé aspekty procesu sestavení a nasazení:</span><span class="sxs-lookup"><span data-stu-id="45b7f-112">Together with the project file (*ContactManager.Database.dbproj* in this case), these files control various aspects of the build and deployment process:</span></span>

- <span data-ttu-id="45b7f-113">Soubor *Database. sqlcmdvars* poskytuje hodnoty pro všechny proměnné sqlcmd, které používáte při nasazení projektu.</span><span class="sxs-lookup"><span data-stu-id="45b7f-113">The *Database.sqlcmdvars* file provides values for any SQLCMD variables you use when you deploy the project.</span></span> <span data-ttu-id="45b7f-114">Každá konfigurace řešení (například ladit a vydaná verze) může určovat jiný soubor. sqlcmdvars.</span><span class="sxs-lookup"><span data-stu-id="45b7f-114">Each solution configuration (for example, debug and release) can specify a different .sqlcmdvars file.</span></span>
- <span data-ttu-id="45b7f-115">Soubor *Database. SqlDeployment* poskytuje nastavení specifická pro nasazení, jako je třeba použití kolace definované v projektu nebo kolaci cílového serveru, bez ohledu na to, jestli se má cílová databáze znovu vytvořit pokaždé, nebo jednoduše změnit existující databázi, aby byla aktuální, a tak dále.</span><span class="sxs-lookup"><span data-stu-id="45b7f-115">The *Database.sqldeployment* file provides deployment-specific settings, like whether to use the collation defined in your project or the collation of the destination server, whether to recreate the destination database every time or simply amend the existing database to bring it up to date, and so on.</span></span> <span data-ttu-id="45b7f-116">Každé nastavení řešení může určovat jiný soubor. SqlDeployment.</span><span class="sxs-lookup"><span data-stu-id="45b7f-116">Each solution configuration can specify a different .sqldeployment file.</span></span>
- <span data-ttu-id="45b7f-117">Soubor *Database. sqlpermissions* je dokument XML, který můžete použít k definování libovolných oprávnění, která chcete přidat do cílové databáze.</span><span class="sxs-lookup"><span data-stu-id="45b7f-117">The *Database.sqlpermissions* file is an XML document that you can use to define any permissions you want to add to the target database.</span></span> <span data-ttu-id="45b7f-118">Všechny konfigurace řešení sdílejí stejný soubor. sqlpermissions.</span><span class="sxs-lookup"><span data-stu-id="45b7f-118">All solution configurations share the same .sqlpermissions file.</span></span>
- <span data-ttu-id="45b7f-119">Soubor *Database. sqlsettings* určuje vlastnosti na úrovni databáze, které budou použity při vytváření databáze, jako je kolace, která se má použít, chování operátorů porovnání a tak dále.</span><span class="sxs-lookup"><span data-stu-id="45b7f-119">The *Database.sqlsettings* file specifies the database-level properties to use when creating the database, like the collation to use, the behavior of comparison operators, and so on.</span></span> <span data-ttu-id="45b7f-120">Všechny konfigurace řešení sdílejí stejný soubor. sqlsettings.</span><span class="sxs-lookup"><span data-stu-id="45b7f-120">All solution configurations share the same .sqlsettings file.</span></span>

<span data-ttu-id="45b7f-121">Je to chvilku, než se otevřou tyto soubory v aplikaci Visual Studio a seznámení s obsahem.</span><span class="sxs-lookup"><span data-stu-id="45b7f-121">It's worth taking a moment to open these files in Visual Studio and familiarize yourself with the contents.</span></span>

<span data-ttu-id="45b7f-122">Při sestavování databázového projektu vytvoří proces sestavení dva soubory:</span><span class="sxs-lookup"><span data-stu-id="45b7f-122">When you build a database project, the build process creates two files:</span></span>

- <span data-ttu-id="45b7f-123">*Schéma databáze* (soubor. dbschema).</span><span class="sxs-lookup"><span data-stu-id="45b7f-123">A *database schema* (.dbschema file).</span></span> <span data-ttu-id="45b7f-124">V této části najdete popis schématu databáze, kterou chcete vytvořit ve formátu XML.</span><span class="sxs-lookup"><span data-stu-id="45b7f-124">This describes the schema of the database you want to create in XML format.</span></span>
- <span data-ttu-id="45b7f-125">*Manifest nasazení* (soubor. DeployManifest).</span><span class="sxs-lookup"><span data-stu-id="45b7f-125">A *deployment manifest* (.deploymanifest file).</span></span> <span data-ttu-id="45b7f-126">Obsahuje všechny informace potřebné k vytvoření a nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="45b7f-126">This contains all the information required to create and deploy your database.</span></span> <span data-ttu-id="45b7f-127">Odkazuje na soubor. dbschema spolu s dalšími prostředky, jako jsou pokyny pro nasazení (soubor. SqlDeployment) a všechny skripty SQL před nasazením nebo po nasazení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-127">It references the .dbschema file along with other resources, like the deployment instructions (the .sqldeployment file) and any pre-deployment or post-deployment SQL scripts.</span></span>

<span data-ttu-id="45b7f-128">Zobrazuje vztah mezi těmito prostředky:</span><span class="sxs-lookup"><span data-stu-id="45b7f-128">This shows the relationship between these resources:</span></span>

![](deploying-database-projects/_static/image2.png)

<span data-ttu-id="45b7f-129">Jak vidíte, soubor. sqlsettings a soubor. sqlpermissions jsou vstupy procesu sestavení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-129">As you can see, the .sqlsettings file and the .sqlpermissions file are inputs to the build process.</span></span> <span data-ttu-id="45b7f-130">Spolu se souborem databázového projektu jsou tyto soubory použity k vytvoření souboru schématu databáze.</span><span class="sxs-lookup"><span data-stu-id="45b7f-130">Along with the database project file, these files are used to create the database schema file.</span></span> <span data-ttu-id="45b7f-131">Soubor. SqlDeployment a soubor. sqlcmdvars projde procesem sestavení beze změny.</span><span class="sxs-lookup"><span data-stu-id="45b7f-131">The .sqldeployment file and the .sqlcmdvars file pass through the build process unchanged.</span></span> <span data-ttu-id="45b7f-132">Manifest nasazení označuje umístění schématu databáze, souboru. SqlDeployment, souboru. sqlcmdvars a všech skriptů SQL spouštěných před nasazením nebo po nasazení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-132">The deployment manifest indicates the location of the database schema, the .sqldeployment file, the .sqlcmdvars file, and any pre-deployment or post-deployment SQL scripts.</span></span>

## <a name="why-use-vsdbcmd-to-deploy-a-database-project"></a><span data-ttu-id="45b7f-133">Proč použít VSDBCMD k nasazení databázového projektu?</span><span class="sxs-lookup"><span data-stu-id="45b7f-133">Why Use VSDBCMD to Deploy a Database Project?</span></span>

<span data-ttu-id="45b7f-134">Existují různé přístupy k nasazení databázových projektů.</span><span class="sxs-lookup"><span data-stu-id="45b7f-134">There are various different approaches to deploying database projects.</span></span> <span data-ttu-id="45b7f-135">Některé z nich ale nejsou vhodné k nasazení databázového projektu na vzdálené servery v podnikovém prostředí.</span><span class="sxs-lookup"><span data-stu-id="45b7f-135">However, not all of them are suitable for deploying a database project to remote servers in an enterprise environment.</span></span> <span data-ttu-id="45b7f-136">Zvažte, co požadujete z nasazení databázového projektu.</span><span class="sxs-lookup"><span data-stu-id="45b7f-136">Consider what you want from a database project deployment.</span></span> <span data-ttu-id="45b7f-137">Ve scénářích podnikového nasazení budete pravděpodobně chtít:</span><span class="sxs-lookup"><span data-stu-id="45b7f-137">In enterprise deployment scenarios, you're likely to want:</span></span>

- <span data-ttu-id="45b7f-138">Možnost nasadit databázový projekt ze vzdáleného umístění.</span><span class="sxs-lookup"><span data-stu-id="45b7f-138">The ability to deploy the database project from a remote location.</span></span>
- <span data-ttu-id="45b7f-139">Možnost provádět přírůstkové aktualizace existující databáze.</span><span class="sxs-lookup"><span data-stu-id="45b7f-139">The ability to make incremental updates to an existing database.</span></span>
- <span data-ttu-id="45b7f-140">Možnost zahrnout skripty předběžného nasazení nebo skripty po nasazení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-140">The ability to include pre-deployment scripts or post-deployment scripts.</span></span>
- <span data-ttu-id="45b7f-141">Možnost přizpůsobit nasazení na více cílových prostředí.</span><span class="sxs-lookup"><span data-stu-id="45b7f-141">The ability to tailor the deployment to multiple destination environments.</span></span>
- <span data-ttu-id="45b7f-142">Možnost nasadit databázový projekt jako součást většího, obvykle spouštěného s jedním krokem nasazením řešení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-142">The ability to deploy the database project as part of a larger, typically scripted, single-step solution deployment.</span></span>

<span data-ttu-id="45b7f-143">Existují tři hlavní přístupy, které můžete použít k nasazení databázového projektu:</span><span class="sxs-lookup"><span data-stu-id="45b7f-143">There are three main approaches you can use to deploy a database project:</span></span>

- <span data-ttu-id="45b7f-144">Můžete použít funkci nasazení s typem databázového projektu v aplikaci Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="45b7f-144">You can use the deployment functionality with the database project type in Visual Studio 2010.</span></span> <span data-ttu-id="45b7f-145">Při sestavování a nasazování databázového projektu v aplikaci Visual Studio 2010 proces nasazení používá manifest nasazení ke generování souboru nasazení založeného na jazyce SQL specifického pro konfiguraci sestavení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-145">When you build and deploy a database project in Visual Studio 2010, the deployment process uses the deployment manifest to generate a SQL-based deployment file specific to the build configuration.</span></span> <span data-ttu-id="45b7f-146">Tím se vytvoří databáze, pokud ještě neexistuje, nebo pokud už existuje, proveďte potřebné změny v databázi.</span><span class="sxs-lookup"><span data-stu-id="45b7f-146">This will create the database if it doesn't already exist or make any necessary changes to the database if it does already exist.</span></span> <span data-ttu-id="45b7f-147">Nástroj SQLCMD. exe můžete použít ke spuštění tohoto souboru na cílovém serveru, nebo můžete nastavit sadu Visual Studio pro vytvoření a spuštění souboru.</span><span class="sxs-lookup"><span data-stu-id="45b7f-147">You can use SQLCMD.exe to run this file on your destination server, or you can set Visual Studio to create and run the file.</span></span> <span data-ttu-id="45b7f-148">Nevýhodou tohoto přístupu je, že máte pouze omezené řízení pro nastavení nasazení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-148">The disadvantage of this approach is that you have only limited control over the deployment settings.</span></span> <span data-ttu-id="45b7f-149">Často je také nutné upravit soubor nasazení SQL tak, aby poskytoval hodnoty proměnných specifických pro prostředí.</span><span class="sxs-lookup"><span data-stu-id="45b7f-149">You may often also need to modify the SQL deployment file to provide environment-specific variable values.</span></span> <span data-ttu-id="45b7f-150">Tento přístup můžete použít jenom z počítače s nainstalovanou sadou Visual Studio 2010 a vývojář by musel znát a poskytovat připojovací řetězce a přihlašovací údaje pro všechna cílová prostředí.</span><span class="sxs-lookup"><span data-stu-id="45b7f-150">You can only use this approach from a computer with Visual Studio 2010 installed, and the developer would need to know and provide connection strings and credentials for all destination environments.</span></span>
- <span data-ttu-id="45b7f-151">K [nasazení databáze jako součásti projektu webové aplikace](https://msdn.microsoft.com/library/dd465343.aspx)můžete použít nástroj pro nasazení webu Internetová informační služba (IIS) (nasazení webu).</span><span class="sxs-lookup"><span data-stu-id="45b7f-151">You can use the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to [deploy a database as part of a web application project](https://msdn.microsoft.com/library/dd465343.aspx).</span></span> <span data-ttu-id="45b7f-152">Tento přístup je ale složitější, pokud chcete nasadit projekt databáze místo pouhého replikování existující místní databáze na cílovém serveru.</span><span class="sxs-lookup"><span data-stu-id="45b7f-152">However, this approach is a lot more complex if you want to deploy a database project rather than simply replicate an existing local database on a destination server.</span></span> <span data-ttu-id="45b7f-153">Můžete nakonfigurovat Nasazení webu pro spuštění skriptu pro nasazení systému SQL, který databázový projekt vygeneruje, ale aby to bylo možné, musíte pro svůj projekt webové aplikace vytvořit vlastní soubor cílů WPP.</span><span class="sxs-lookup"><span data-stu-id="45b7f-153">You can configure Web Deploy to run the SQL deployment script that the database project generates, but in order to do this, you need to create a custom WPP targets file for your web application project.</span></span> <span data-ttu-id="45b7f-154">Tím se do procesu nasazení přidá značná část složitosti.</span><span class="sxs-lookup"><span data-stu-id="45b7f-154">This adds a substantial amount of complexity to the deployment process.</span></span> <span data-ttu-id="45b7f-155">Nasazení webu navíc přímo nepodporuje přírůstkové aktualizace stávajících databází.</span><span class="sxs-lookup"><span data-stu-id="45b7f-155">In addition, Web Deploy does not directly support incremental updates to existing databases.</span></span> <span data-ttu-id="45b7f-156">Další informace o tomto přístupu najdete v tématu [rozšíření kanálu publikování na webu do souboru SQL nasazeného projektu databáze](https://go.microsoft.com/?linkid=9805121).</span><span class="sxs-lookup"><span data-stu-id="45b7f-156">For more information on this approach, see [Extending the Web Publishing Pipeline to package database project deployed SQL file](https://go.microsoft.com/?linkid=9805121).</span></span>
- <span data-ttu-id="45b7f-157">K nasazení databáze pomocí nástroje VSDBCMD můžete použít buď schéma databáze, nebo manifest nasazení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-157">You can use the VSDBCMD utility to deploy the database, using either the database schema or the deployment manifest.</span></span> <span data-ttu-id="45b7f-158">Můžete volat VSDBCMD. exe z cíle MSBuild, který umožňuje publikovat databáze jako součást rozsáhlejšího skriptu nasazení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-158">You can call VSDBCMD.exe from an MSBuild target, which lets you publish databases as part of a larger, scripted deployment process.</span></span> <span data-ttu-id="45b7f-159">Můžete přepsat proměnné v souboru. sqlcmdvars a spoustě dalších vlastností databáze z příkazu VSDBCMD, který umožňuje přizpůsobení nasazení pro různá prostředí, aniž by bylo nutné vytvářet více konfigurací sestavení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-159">You can override the variables in your .sqlcmdvars file and lots of other database properties from a VSDBCMD command, which allows you to customize your deployment for different environments without creating multiple build configurations.</span></span> <span data-ttu-id="45b7f-160">VSDBCMD poskytuje funkce pro odlišení, což znamená, že bude provádět pouze nezbytné změny pro zarovnávání cílové databáze se schématem databáze.</span><span class="sxs-lookup"><span data-stu-id="45b7f-160">VSDBCMD provides differentiation functionality, which means it will make only the necessary changes to align a destination database with your database schema.</span></span> <span data-ttu-id="45b7f-161">VSDBCMD také nabízí široké spektrum možností příkazového řádku, které vám poskytnou jemně odstupňovanou kontrolu nad procesem nasazení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-161">VSDBCMD also offers a wide range of command-line options, which give you fine-grained control over the deployment process.</span></span>

<span data-ttu-id="45b7f-162">Z tohoto přehledu vidíte, že použití VSDBCMD s nástrojem MSBuild je to nejlepší způsob, který nejlépe vyhovuje typickému scénáři podnikového nasazení:</span><span class="sxs-lookup"><span data-stu-id="45b7f-162">From this overview, you can see that using VSDBCMD with MSBuild is the approach best suited to a typical enterprise deployment scenario:</span></span>

|  | <span data-ttu-id="45b7f-163">Visual Studio 2010</span><span class="sxs-lookup"><span data-stu-id="45b7f-163">Visual Studio 2010</span></span> | <span data-ttu-id="45b7f-164">Nasazení webu 2.0</span><span class="sxs-lookup"><span data-stu-id="45b7f-164">Web Deploy 2.0</span></span> | <span data-ttu-id="45b7f-165">VSDBCMD.exe</span><span class="sxs-lookup"><span data-stu-id="45b7f-165">VSDBCMD.exe</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="45b7f-166">Podporuje vzdálené nasazení?</span><span class="sxs-lookup"><span data-stu-id="45b7f-166">Supports remote deployment?</span></span> | <span data-ttu-id="45b7f-167">Ano</span><span class="sxs-lookup"><span data-stu-id="45b7f-167">Yes</span></span> | <span data-ttu-id="45b7f-168">Ano</span><span class="sxs-lookup"><span data-stu-id="45b7f-168">Yes</span></span> | <span data-ttu-id="45b7f-169">Ano</span><span class="sxs-lookup"><span data-stu-id="45b7f-169">Yes</span></span> |
| <span data-ttu-id="45b7f-170">Podporuje přírůstkové aktualizace?</span><span class="sxs-lookup"><span data-stu-id="45b7f-170">Supports incremental updates?</span></span> | <span data-ttu-id="45b7f-171">Ano</span><span class="sxs-lookup"><span data-stu-id="45b7f-171">Yes</span></span> | <span data-ttu-id="45b7f-172">Ne</span><span class="sxs-lookup"><span data-stu-id="45b7f-172">No</span></span> | <span data-ttu-id="45b7f-173">Ano</span><span class="sxs-lookup"><span data-stu-id="45b7f-173">Yes</span></span> |
| <span data-ttu-id="45b7f-174">Podporuje skripty předběžného nebo po nasazení?</span><span class="sxs-lookup"><span data-stu-id="45b7f-174">Supports pre/post-deployment scripts?</span></span> | <span data-ttu-id="45b7f-175">Ano</span><span class="sxs-lookup"><span data-stu-id="45b7f-175">Yes</span></span> | <span data-ttu-id="45b7f-176">Ano</span><span class="sxs-lookup"><span data-stu-id="45b7f-176">Yes</span></span> | <span data-ttu-id="45b7f-177">Ano</span><span class="sxs-lookup"><span data-stu-id="45b7f-177">Yes</span></span> |
| <span data-ttu-id="45b7f-178">Podporuje nasazení ve více prostředích?</span><span class="sxs-lookup"><span data-stu-id="45b7f-178">Supports multi-environment deployment?</span></span> | <span data-ttu-id="45b7f-179">Limitovan</span><span class="sxs-lookup"><span data-stu-id="45b7f-179">Limited</span></span> | <span data-ttu-id="45b7f-180">Limitovan</span><span class="sxs-lookup"><span data-stu-id="45b7f-180">Limited</span></span> | <span data-ttu-id="45b7f-181">Ano</span><span class="sxs-lookup"><span data-stu-id="45b7f-181">Yes</span></span> |
| <span data-ttu-id="45b7f-182">Podporuje skriptované nasazení?</span><span class="sxs-lookup"><span data-stu-id="45b7f-182">Supports scripted deployment?</span></span> | <span data-ttu-id="45b7f-183">Limitovan</span><span class="sxs-lookup"><span data-stu-id="45b7f-183">Limited</span></span> | <span data-ttu-id="45b7f-184">Ano</span><span class="sxs-lookup"><span data-stu-id="45b7f-184">Yes</span></span> | <span data-ttu-id="45b7f-185">Ano</span><span class="sxs-lookup"><span data-stu-id="45b7f-185">Yes</span></span> |

<span data-ttu-id="45b7f-186">Zbývající část tohoto tématu popisuje použití VSDBCMD s nástrojem MSBuild k nasazení databázových projektů.</span><span class="sxs-lookup"><span data-stu-id="45b7f-186">The remainder of this topic describes the use of VSDBCMD with MSBuild to deploy database projects.</span></span>

## <a name="understanding-the-deployment-process"></a><span data-ttu-id="45b7f-187">Princip procesu nasazení</span><span class="sxs-lookup"><span data-stu-id="45b7f-187">Understanding the Deployment Process</span></span>

<span data-ttu-id="45b7f-188">Nástroj VSDBCMD umožňuje nasadit databázi buď pomocí schématu databáze (soubor. dbschema), nebo manifestu nasazení (soubor. DeployManifest).</span><span class="sxs-lookup"><span data-stu-id="45b7f-188">The VSDBCMD utility lets you deploy a database using either the database schema (the .dbschema file) or the deployment manifest (the .deploymanifest file).</span></span> <span data-ttu-id="45b7f-189">V praxi skoro vždy použijete manifest nasazení, protože manifest nasazení umožňuje zadat výchozí hodnoty pro různé vlastnosti nasazení a identifikovat všechny skripty SQL před nasazením nebo po nasazení, které chcete spustit.</span><span class="sxs-lookup"><span data-stu-id="45b7f-189">In practice, you'll almost always use the deployment manifest, as the deployment manifest lets you provide default values for various deployment properties and identify any pre-deployment or post-deployment SQL scripts you want to run.</span></span> <span data-ttu-id="45b7f-190">Například tento příkaz VSDBCMD slouží k nasazení databáze **ContactManager** do databázového serveru v testovacím prostředí:</span><span class="sxs-lookup"><span data-stu-id="45b7f-190">For example, this VSDBCMD command is used to deploy the **ContactManager** database to a database server in a test environment:</span></span>

[!code-console[Main](deploying-database-projects/samples/sample1.cmd)]

<span data-ttu-id="45b7f-191">V tomto případě:</span><span class="sxs-lookup"><span data-stu-id="45b7f-191">In this case:</span></span>

- <span data-ttu-id="45b7f-192">Přepínač **/a** (nebo **za akci**) určuje, co má VSDBCMD dělat.</span><span class="sxs-lookup"><span data-stu-id="45b7f-192">The **/a** (or **/Action**) switch specifies what you want VSDBCMD to do.</span></span> <span data-ttu-id="45b7f-193">Tuto možnost můžete nastavit pro **Import** nebo **nasazení**.</span><span class="sxs-lookup"><span data-stu-id="45b7f-193">You can set this to **Import** or **Deploy**.</span></span> <span data-ttu-id="45b7f-194">Možnost **Import** slouží k vygenerování souboru. dbschema z existující databáze a možnost **nasazení** se používá k nasazení souboru. dbschema do cílové databáze.</span><span class="sxs-lookup"><span data-stu-id="45b7f-194">The **Import** option is used to generate a .dbschema file from an existing database, and the **Deploy** option is used to deploy a .dbschema file to a target database.</span></span>
- <span data-ttu-id="45b7f-195">Přepínač **/manifest** (nebo **/MANIFESTFILE**) identifikuje soubor. DeployManifest, který chcete nasadit.</span><span class="sxs-lookup"><span data-stu-id="45b7f-195">The **/manifest** (or **/ManifestFile**) switch identifies the .deploymanifest file you want to deploy.</span></span> <span data-ttu-id="45b7f-196">Pokud jste místo toho chtěli použít soubor. dbschema, použijte přepínač **/model** (nebo **/ModelFile**).</span><span class="sxs-lookup"><span data-stu-id="45b7f-196">If you wanted to use the .dbschema file instead, you'd use the **/model** (or **/ModelFile**) switch.</span></span>
- <span data-ttu-id="45b7f-197">Přepínač **/cs** (nebo **/ConnectionString**) poskytuje připojovací řetězec pro cílový databázový server.</span><span class="sxs-lookup"><span data-stu-id="45b7f-197">The **/cs** (or **/ConnectionString**) switch provides the connection string for the target database server.</span></span> <span data-ttu-id="45b7f-198">Všimněte si, že to nezahrnuje název databáze&#x2014;VSDBCMD se musí připojit k serveru, aby se vytvořila databáze. není nutné se připojit k individuální databázi.</span><span class="sxs-lookup"><span data-stu-id="45b7f-198">Note that this doesn't include the name of the database&#x2014;VSDBCMD needs to connect to the server to create the database; it doesn't need to connect to an individual database.</span></span> <span data-ttu-id="45b7f-199">Pokud soubor. DeployManifest obsahuje připojovací řetězec, můžete tento přepínač vynechat.</span><span class="sxs-lookup"><span data-stu-id="45b7f-199">If your .deploymanifest file includes a connection string, you can omit this switch.</span></span> <span data-ttu-id="45b7f-200">Pokud použijete přepínač, přepíše hodnota switch hodnotu. DeployManifest.</span><span class="sxs-lookup"><span data-stu-id="45b7f-200">If you use the switch anyway, the switch value will override the .deploymanifest value.</span></span>
- <span data-ttu-id="45b7f-201">Vlastnost <strong>/p: TargetDatabase</strong> poskytuje název, který chcete přiřadit cílové databázi při vytváření.</span><span class="sxs-lookup"><span data-stu-id="45b7f-201">The <strong>/p:TargetDatabase</strong> property provides the name you want to assign to the target database on creation.</span></span> <span data-ttu-id="45b7f-202">Tím se přepíše hodnota vlastnosti <strong>TargetDatabase</strong> v souboru. DeployManifest.</span><span class="sxs-lookup"><span data-stu-id="45b7f-202">This overrides the value of the <strong>TargetDatabase</strong> property in the .deploymanifest file.</span></span> <span data-ttu-id="45b7f-203">Syntaxi <strong>/p:</strong> <em>[vlastnost name]</em>můžete použít k nastavení široké škály vlastností nasazení a k přepsání všech proměnných Sqlcmd deklarovaných v souboru. sqlcmdvars.</span><span class="sxs-lookup"><span data-stu-id="45b7f-203">You can use the <strong>/p:</strong> <em>[property name]</em>syntax to set a wide variety of deployment properties and to override any SQLCMD variables declared in your .sqlcmdvars file.</span></span>
- <span data-ttu-id="45b7f-204">Přepínač **/DD +** (nebo **/DeployToDatabase +** ) označuje, že chcete vytvořit nasazení a nasadit ho do cílového prostředí.</span><span class="sxs-lookup"><span data-stu-id="45b7f-204">The **/dd+** (or **/DeployToDatabase+**) switch indicates that you want to create a deployment and deploy it to the target environment.</span></span> <span data-ttu-id="45b7f-205">Pokud zadáte **/DD-** nebo přepínač vynecháte, VSDBCMD vygeneruje skript nasazení, ale neprovede nasazení do cílového prostředí.</span><span class="sxs-lookup"><span data-stu-id="45b7f-205">If you specify **/dd-**, or omit the switch, VSDBCMD will generate a deployment script but will not deploy it to the target environment.</span></span> <span data-ttu-id="45b7f-206">Tento přepínač je často zdrojem nejasností a je podrobněji vysvětlen v další části.</span><span class="sxs-lookup"><span data-stu-id="45b7f-206">This switch is often the source of confusion and is explained in more detail in the next section.</span></span>
- <span data-ttu-id="45b7f-207">Přepínač **/Script** (nebo **/DeploymentScriptFile**) určuje, kde chcete vygenerovat skript nasazení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-207">The **/script** (or **/DeploymentScriptFile**) switch specifies where you want to generate the deployment script.</span></span> <span data-ttu-id="45b7f-208">Tato hodnota nemá vliv na proces nasazení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-208">This value does not affect the deployment process.</span></span>

<span data-ttu-id="45b7f-209">Další informace o VSDBCMD najdete v tématu [Reference k příkazovému řádku pro VSDBCMD. EXE (nasazení a import schématu)](https://msdn.microsoft.com/library/dd193283.aspx) a [Postupy: příprava databáze pro nasazení z příkazového řádku pomocí VSDBCMD. EXE](https://msdn.microsoft.com/library/dd193258.aspx).</span><span class="sxs-lookup"><span data-stu-id="45b7f-209">For more information on VSDBCMD, see [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx) and [How to: Prepare a Database for Deployment From a Command Prompt by Using VSDBCMD.EXE](https://msdn.microsoft.com/library/dd193258.aspx).</span></span>

<span data-ttu-id="45b7f-210">Příklad toho, jak lze použít VSDBCMD ze souboru projektu MSBuild, naleznete v tématu [Principy procesu sestavení](understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="45b7f-210">For an example of how you can use VSDBCMD from an MSBuild project file, see [Understanding the Build Process](understanding-the-build-process.md).</span></span> <span data-ttu-id="45b7f-211">Příklady, jak nakonfigurovat nastavení nasazení databáze pro více prostředí, najdete v tématu [přizpůsobení nasazení databáze pro více prostředí](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="45b7f-211">For examples of how to configure database deployment settings for multiple environments, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span>

## <a name="understanding-the-deploytodatabase-switch"></a><span data-ttu-id="45b7f-212">Princip přepínače DeployToDatabase</span><span class="sxs-lookup"><span data-stu-id="45b7f-212">Understanding the DeployToDatabase Switch</span></span>

<span data-ttu-id="45b7f-213">Chování přepínače **/DD** nebo **/DeployToDatabase** závisí na tom, zda používáte VSDBCMD se souborem. dbschema nebo souborem. DeployManifest.</span><span class="sxs-lookup"><span data-stu-id="45b7f-213">The behavior of the **/dd** or **/DeployToDatabase** switch depends on whether you're using VSDBCMD with a .dbschema file or a .deploymanifest file.</span></span> <span data-ttu-id="45b7f-214">Pokud používáte soubor. dbschema, chování je poměrně jasné:</span><span class="sxs-lookup"><span data-stu-id="45b7f-214">If you're using a .dbschema file, the behavior is fairly straightforward:</span></span>

- <span data-ttu-id="45b7f-215">Pokud zadáte **/DD +** nebo **/DD**, VSDBCMD vygeneruje skript nasazení a nasadí databázi.</span><span class="sxs-lookup"><span data-stu-id="45b7f-215">If you specify **/dd+** or **/dd**, VSDBCMD will generate a deployment script and deploy the database.</span></span>
- <span data-ttu-id="45b7f-216">Pokud zadáte **/DD-** nebo vynecháte přepínač, vytvoří VSDBCMD pouze skript nasazení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-216">If you specify **/dd-** or omit the switch, VSDBCMD will generate a deployment script only.</span></span>

<span data-ttu-id="45b7f-217">Pokud používáte soubor. DeployManifest, je chování mnohem složitější.</span><span class="sxs-lookup"><span data-stu-id="45b7f-217">If you're using a .deploymanifest file, the behavior is a lot more complicated.</span></span> <span data-ttu-id="45b7f-218">Důvodem je, že soubor. DeployManifest obsahuje název vlastnosti **DeployToDatabase** , který také určuje, zda je databáze nasazena.</span><span class="sxs-lookup"><span data-stu-id="45b7f-218">This is because the .deploymanifest file contains a property name **DeployToDatabase** that also determines whether the database is deployed.</span></span>

[!code-xml[Main](deploying-database-projects/samples/sample2.xml)]

<span data-ttu-id="45b7f-219">Hodnota této vlastnosti je nastavena podle vlastností databázového projektu.</span><span class="sxs-lookup"><span data-stu-id="45b7f-219">The value of this property is set according to the properties of the database project.</span></span> <span data-ttu-id="45b7f-220">Nastavíte-li **akci nasadit** pro **Vytvoření skriptu nasazení (. SQL)** , bude hodnota **false**.</span><span class="sxs-lookup"><span data-stu-id="45b7f-220">If you set the **Deploy action** to **Create a deployment script (.sql)**, the value will be **False**.</span></span> <span data-ttu-id="45b7f-221">Nastavíte-li **akci nasadit** pro **Vytvoření skriptu nasazení (. SQL) a nasazení do databáze**, bude hodnota **true**.</span><span class="sxs-lookup"><span data-stu-id="45b7f-221">If you set the **Deploy action** to **Create a deployment script (.sql) and deploy to the database**, the value will be **True**.</span></span>

> [!NOTE]
> <span data-ttu-id="45b7f-222">Tato nastavení jsou spojena s konkrétní konfigurací a platformou sestavení.</span><span class="sxs-lookup"><span data-stu-id="45b7f-222">These settings are associated with a specific build configuration and platform.</span></span> <span data-ttu-id="45b7f-223">Pokud například nakonfigurujete nastavení pro konfiguraci **ladění** a pak publikujete pomocí konfigurace **vydané verze** , vaše nastavení se nepoužijí.</span><span class="sxs-lookup"><span data-stu-id="45b7f-223">For example, if you configure settings for the **Debug** configuration and then publish using the **Release** configuration, your settings will not be used.</span></span>

![](deploying-database-projects/_static/image3.png)

> [!NOTE]
> <span data-ttu-id="45b7f-224">V tomto scénáři by měla být **Akce nasadit** vždy nastavena na **Vytvoření skriptu nasazení (. SQL)** , protože nechcete, aby sada Visual Studio 2010 nasadila vaši databázi.</span><span class="sxs-lookup"><span data-stu-id="45b7f-224">In this scenario, the **Deploy action** should always be set to **Create a deployment script (.sql)**, because you don't want Visual Studio 2010 to deploy your database.</span></span> <span data-ttu-id="45b7f-225">Jinými slovy, vlastnost **DeployToDatabase** by měla být vždy **false**.</span><span class="sxs-lookup"><span data-stu-id="45b7f-225">In other words, the **DeployToDatabase** property should always be **False**.</span></span>

<span data-ttu-id="45b7f-226">Pokud je zadána vlastnost **DeployToDatabase** , přepínač **/DD** přepíše pouze vlastnost, pokud je hodnota vlastnosti **false**:</span><span class="sxs-lookup"><span data-stu-id="45b7f-226">When a **DeployToDatabase** property is specified, the **/dd** switch will only override the property if the property value is **false**:</span></span>

- <span data-ttu-id="45b7f-227">Pokud má vlastnost **DeployToDatabase** **hodnotu false**a zadáte **/DD +** nebo **/DD**, VSDBCMD přepíše vlastnost **DeployToDatabase** a nasadí databázi.</span><span class="sxs-lookup"><span data-stu-id="45b7f-227">If the **DeployToDatabase** property is **False**, and you specify **/dd+** or **/dd**, VSDBCMD will override the **DeployToDatabase** property and deploy the database.</span></span>
- <span data-ttu-id="45b7f-228">Pokud má vlastnost **DeployToDatabase** **hodnotu false**a zadáte **/DD-** nebo vynecháte přepínač, VSDBCMD neprovede nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="45b7f-228">If the **DeployToDatabase** property is **False**, and you specify **/dd-** or omit the switch, VSDBCMD will not deploy the database.</span></span>
- <span data-ttu-id="45b7f-229">Pokud má vlastnost **DeployToDatabase** **hodnotu true**, VSDBCMD přepínač přeskočí a nasadí databázi.</span><span class="sxs-lookup"><span data-stu-id="45b7f-229">If the **DeployToDatabase** property is **True**, VSDBCMD will ignore the switch and deploy the database.</span></span>
- <span data-ttu-id="45b7f-230">Skript nasazení se vygeneruje v každém případě bez ohledu na to, jestli nasazujete i databázi.</span><span class="sxs-lookup"><span data-stu-id="45b7f-230">A deployment script is generated in each case, regardless of whether you're deploying the database as well.</span></span>

## <a name="conclusion"></a><span data-ttu-id="45b7f-231">Závěr</span><span class="sxs-lookup"><span data-stu-id="45b7f-231">Conclusion</span></span>

<span data-ttu-id="45b7f-232">Toto téma poskytuje přehled procesu sestavení a nasazení pro databázové projekty v aplikaci Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="45b7f-232">This topic provided an overview of the build and deployment process for database projects in Visual Studio 2010.</span></span> <span data-ttu-id="45b7f-233">Také popisuje, jak můžete pomocí nástroje VSDBCMD. exe s nástrojem MSBuild podporovat nasazení databáze na podnikové úrovni.</span><span class="sxs-lookup"><span data-stu-id="45b7f-233">It also described how you can use VSDBCMD.exe with MSBuild to support enterprise-scale database deployment.</span></span>

<span data-ttu-id="45b7f-234">Další informace o tom, jak funguje v praxi, najdete v tématu [přizpůsobení nasazení databáze pro více prostředí](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="45b7f-234">For more information on how this works in practice, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span>

## <a name="further-reading"></a><span data-ttu-id="45b7f-235">Další čtení</span><span class="sxs-lookup"><span data-stu-id="45b7f-235">Further Reading</span></span>

<span data-ttu-id="45b7f-236">Informace o tom, jak přizpůsobit nasazení databáze vytvořením samostatného konfiguračního souboru nasazení pro každé prostředí, najdete v tématu [přizpůsobení nasazení databáze pro více prostředí](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="45b7f-236">For information on how to customize database deployments by creating a separate deployment configuration file for each environment, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span> <span data-ttu-id="45b7f-237">Pokyny ke konfiguraci členství v databázových rolích spuštěním skriptu po nasazení najdete v tématu [nasazení členství databázové role do testovacích prostředí](../advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments.md).</span><span class="sxs-lookup"><span data-stu-id="45b7f-237">For guidance on how to configure database role memberships by running a post-deployment script, see [Deploying Database Role Memberships to Test Environments](../advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments.md).</span></span> <span data-ttu-id="45b7f-238">Pokyny ke správě některých jedinečných výzev, které databáze členství ukládají, najdete v tématu [nasazení databází členství v podnikových prostředích](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).</span><span class="sxs-lookup"><span data-stu-id="45b7f-238">For guidance on managing some of the unique challenges that membership databases impose, see [Deploying Membership Databases to Enterprise Environments](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).</span></span>

<span data-ttu-id="45b7f-239">Tato témata na webu MSDN poskytují širší doprovodné materiály a základní informace o projektech databáze sady Visual Studio a procesu nasazení databáze:</span><span class="sxs-lookup"><span data-stu-id="45b7f-239">These topics on MSDN provide broader guidance and background information on Visual Studio database projects and the database deployment process:</span></span>

- [<span data-ttu-id="45b7f-240">Projekty databáze sady Visual Studio 2010 SQL Server</span><span class="sxs-lookup"><span data-stu-id="45b7f-240">Visual Studio 2010 SQL Server Database Projects</span></span>](https://msdn.microsoft.com/library/ff678491.aspx)
- [<span data-ttu-id="45b7f-241">Správa změny databáze</span><span class="sxs-lookup"><span data-stu-id="45b7f-241">Managing Database Change</span></span>](https://msdn.microsoft.com/library/aa833404.aspx)
- [<span data-ttu-id="45b7f-242">Postupy: příprava databáze pro nasazení z příkazového řádku pomocí VSDBCMD. PROGRAMU</span><span class="sxs-lookup"><span data-stu-id="45b7f-242">How to: Prepare a Database for Deployment From a Command Prompt by Using VSDBCMD.EXE</span></span>](https://msdn.microsoft.com/library/dd193258.aspx)
- [<span data-ttu-id="45b7f-243">Přehled Build and Deployment databáze</span><span class="sxs-lookup"><span data-stu-id="45b7f-243">An Overview of Database Build and Deployment</span></span>](https://msdn.microsoft.com/library/aa833165.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="45b7f-244">[Předchozí](deploying-web-packages.md)
> [Další](creating-and-running-a-deployment-command-file.md)</span><span class="sxs-lookup"><span data-stu-id="45b7f-244">[Previous](deploying-web-packages.md)
[Next](creating-and-running-a-deployment-command-file.md)</span></span>
