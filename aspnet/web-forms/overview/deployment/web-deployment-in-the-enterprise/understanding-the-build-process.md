---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-build-process
title: Princip procesu sestavení | Microsoft Docs
author: jrjlee
description: Toto téma poskytuje návod pro proces sestavení a nasazení na podnikové úrovni. Přístup popsaný v tomto tématu používá vlastní Microsoft Build Engin...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 5b982451-547b-4a2f-a5dc-79bc64d84d40
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-build-process
msc.type: authoredcontent
ms.openlocfilehash: 802d93f7ca987d018967275bae68b8c56d883a25
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78641139"
---
# <a name="understanding-the-build-process"></a><span data-ttu-id="e55f1-104">Vysvětlení procesu sestavení</span><span class="sxs-lookup"><span data-stu-id="e55f1-104">Understanding the Build Process</span></span>

<span data-ttu-id="e55f1-105">od [Jason Novák](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="e55f1-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="e55f1-106">Stáhnout PDF</span><span class="sxs-lookup"><span data-stu-id="e55f1-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="e55f1-107">Toto téma poskytuje návod pro proces sestavení a nasazení na podnikové úrovni.</span><span class="sxs-lookup"><span data-stu-id="e55f1-107">This topic provides a walkthrough of an enterprise-scale build and deployment process.</span></span> <span data-ttu-id="e55f1-108">Přístup popsaný v tomto tématu používá vlastní soubory projektu Microsoft Build Engine (MSBuild) k zajištění jemně odstupňované kontroly nad všemi aspekty procesu.</span><span class="sxs-lookup"><span data-stu-id="e55f1-108">The approach described in this topic uses custom Microsoft Build Engine (MSBuild) project files to provide fine-grained control over every aspect of the process.</span></span> <span data-ttu-id="e55f1-109">V rámci souborů projektu se vlastní cíle MSBuild používají ke spouštění nástrojů pro nasazení, jako je nástroj pro nasazení webu Internetová informační služba (IIS) a nástroj pro nasazení databáze VSDBCMD. exe.</span><span class="sxs-lookup"><span data-stu-id="e55f1-109">Within the project files, custom MSBuild targets are used to run deployment utilities like the Internet Information Services (IIS) Web Deployment Tool (MSDeploy.exe) and the database deployment utility VSDBCMD.exe.</span></span>
> 
> > [!NOTE]
> > <span data-ttu-id="e55f1-110">Předchozí téma [porozumění souboru projektu](understanding-the-project-file.md), popisuje klíčové komponenty souboru projektu MSBuild a zavádí koncept rozdělených souborů projektu pro podporu nasazení do více cílových prostředí.</span><span class="sxs-lookup"><span data-stu-id="e55f1-110">The previous topic, [Understanding the Project File](understanding-the-project-file.md), described the key components of an MSBuild project file and introduced the concept of split project files to support deployment to multiple target environments.</span></span> <span data-ttu-id="e55f1-111">Pokud jste ještě tyto koncepty nepoužívali, měli byste před zahájením práce s tímto tématem zkontrolovat [porozumění souboru projektu](understanding-the-project-file.md) .</span><span class="sxs-lookup"><span data-stu-id="e55f1-111">If you're not already familiar with these concepts, you should review [Understanding the Project File](understanding-the-project-file.md) before you work through this topic.</span></span>

<span data-ttu-id="e55f1-112">Toto téma je součástí série kurzů založených na požadavcích podnikového nasazení fiktivní společnosti s názvem Fabrikam, Inc. Tato série kurzů používá ukázkové řešení&#x2014;, pomocí kterého [řešení](the-contact-manager-solution.md)&#x2014;správce kontaktů představuje webovou aplikaci s realistickou úrovní složitosti, včetně aplikace ASP.NET MVC 3, služby Windows Communication Foundation (WCF) a databázového projektu.</span><span class="sxs-lookup"><span data-stu-id="e55f1-112">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="e55f1-113">Metoda nasazení na srdce těchto kurzů je založena na způsobu rozdělení souborů projektu popsaných v tématu [Principy souboru projektu](understanding-the-project-file.md), ve kterém je proces sestavení řízen dvěma soubory&#x2014;projektu jeden, který obsahuje pokyny pro sestavení, které platí pro každé cílové prostředí, a jedno obsahující nastavení sestavení a nasazení specifické pro konkrétní prostředí.</span><span class="sxs-lookup"><span data-stu-id="e55f1-113">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="e55f1-114">V době sestavení je soubor projektu specifický pro prostředí sloučen do souboru projektu prostředí – nezávislá a vytvoří kompletní sadu instrukcí pro sestavení.</span><span class="sxs-lookup"><span data-stu-id="e55f1-114">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="build-and-deployment-overview"></a><span data-ttu-id="e55f1-115">Přehled Build and Deployment</span><span class="sxs-lookup"><span data-stu-id="e55f1-115">Build and Deployment Overview</span></span>

<span data-ttu-id="e55f1-116">V [řešení Správce kontaktů](the-contact-manager-solution.md)tři soubory řídí proces sestavení a nasazení:</span><span class="sxs-lookup"><span data-stu-id="e55f1-116">In the [Contact Manager solution](the-contact-manager-solution.md), three files control the build and deployment process:</span></span>

- <span data-ttu-id="e55f1-117">*Soubor univerzálního projektu* (*Publish. proj*).</span><span class="sxs-lookup"><span data-stu-id="e55f1-117">A *universal project file* (*Publish.proj*).</span></span> <span data-ttu-id="e55f1-118">Obsahuje pokyny pro sestavení a nasazení, které se mezi cílovými prostředími nemění.</span><span class="sxs-lookup"><span data-stu-id="e55f1-118">This contains build and deployment instructions that do not change between destination environments.</span></span>
- <span data-ttu-id="e55f1-119">*Soubor projektu specifický pro prostředí* (*ENV-dev. proj*).</span><span class="sxs-lookup"><span data-stu-id="e55f1-119">An *environment-specific project file* (*Env-Dev.proj*).</span></span> <span data-ttu-id="e55f1-120">Obsahuje nastavení sestavení a nasazení, která jsou specifická pro konkrétní cílové prostředí.</span><span class="sxs-lookup"><span data-stu-id="e55f1-120">This contains build and deployment settings that are specific to a particular destination environment.</span></span> <span data-ttu-id="e55f1-121">Například můžete použít soubor *ENV-dev. proj* k poskytnutí nastavení pro vývojové nebo testovací prostředí a vytvoření alternativního souboru s názvem *ENV-Stage. proj* k poskytnutí nastavení pro přípravný prostředí.</span><span class="sxs-lookup"><span data-stu-id="e55f1-121">For example, you could use the *Env-Dev.proj* file to provide settings for a developer or test environment and create an alternative file named *Env-Stage.proj* to provide settings for a staging environment.</span></span>
- <span data-ttu-id="e55f1-122">*Soubor příkazů* (*Publish-dev. cmd*).</span><span class="sxs-lookup"><span data-stu-id="e55f1-122">A *command file* (*Publish-Dev.cmd*).</span></span> <span data-ttu-id="e55f1-123">Obsahuje příkaz MSBuild. exe, který určuje, které soubory projektu chcete spustit.</span><span class="sxs-lookup"><span data-stu-id="e55f1-123">This contains an MSBuild.exe command that specifies which project files you want to execute.</span></span> <span data-ttu-id="e55f1-124">Můžete vytvořit soubor příkazů pro každé cílové prostředí, kde každý soubor obsahuje příkaz MSBuild. exe, který určuje jiný soubor projektu specifický pro prostředí.</span><span class="sxs-lookup"><span data-stu-id="e55f1-124">You can create a command file for every destination environment, where each file contains an MSBuild.exe command that specifies a different environment-specific project file.</span></span> <span data-ttu-id="e55f1-125">To umožňuje vývojáři nasadit do různých prostředí jednoduše tak, že spustí příslušný soubor příkazů.</span><span class="sxs-lookup"><span data-stu-id="e55f1-125">This lets the developer deploy to different environments simply by running the appropriate command file.</span></span>

<span data-ttu-id="e55f1-126">V ukázkovém řešení najdete tyto tři soubory ve složce řešení publikování.</span><span class="sxs-lookup"><span data-stu-id="e55f1-126">In the sample solution, you can find these three files in the Publish solution folder.</span></span>

![](understanding-the-build-process/_static/image1.png)

<span data-ttu-id="e55f1-127">Předtím, než se podíváte na tyto soubory podrobněji, se podívejme na to, jak celkový proces sestavení funguje při použití tohoto přístupu.</span><span class="sxs-lookup"><span data-stu-id="e55f1-127">Before you look at these files in more detail, let's take a look at how the overall build process works when you use this approach.</span></span> <span data-ttu-id="e55f1-128">Na vysoké úrovni proces sestavení a nasazení vypadá takto:</span><span class="sxs-lookup"><span data-stu-id="e55f1-128">At a high level, the build and deployment process looks like this:</span></span>

![](understanding-the-build-process/_static/image2.png)

<span data-ttu-id="e55f1-129">První věc, ke které dojde, je, že dva&#x2014;soubory projektu, které obsahují obecné pokyny pro sestavení a nasazení a které obsahují nastavení&#x2014;specifické pro prostředí, jsou sloučeny do jediného souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="e55f1-129">The first thing that happens is that the two project files&#x2014;one containing universal build and deployment instructions, and one containing environment-specific settings&#x2014;are merged into a single project file.</span></span> <span data-ttu-id="e55f1-130">Nástroj MSBuild potom funguje podle pokynů v souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="e55f1-130">MSBuild then works through the instructions in the project file.</span></span> <span data-ttu-id="e55f1-131">Vytvoří každý z projektů v řešení pomocí souboru projektu pro každý projekt.</span><span class="sxs-lookup"><span data-stu-id="e55f1-131">It builds each of the projects in the solution, using the project file for each project.</span></span> <span data-ttu-id="e55f1-132">Pak volá jiné nástroje, například Nasazení webu (MSDeploy. exe) a nástroj VSDBCMD k nasazení webového obsahu a databází do cílového prostředí.</span><span class="sxs-lookup"><span data-stu-id="e55f1-132">It then calls out to other tools, like Web Deploy (MSDeploy.exe) and the VSDBCMD utility to deploy your web content and databases to the target environment.</span></span>

<span data-ttu-id="e55f1-133">Od začátku do konce se proces sestavení a nasazení provádí tyto úlohy:</span><span class="sxs-lookup"><span data-stu-id="e55f1-133">From start to finish, the build and deployment process performs these tasks:</span></span>

1. <span data-ttu-id="e55f1-134">Odstraní obsah výstupního adresáře při přípravě na nové sestavení.</span><span class="sxs-lookup"><span data-stu-id="e55f1-134">It deletes the contents of the output directory, in preparation for a fresh build.</span></span>
2. <span data-ttu-id="e55f1-135">Vytváří každý projekt v řešení:</span><span class="sxs-lookup"><span data-stu-id="e55f1-135">It builds each project in the solution:</span></span>

    1. <span data-ttu-id="e55f1-136">Pro webové projekty&#x2014;v tomto případě webová aplikace ASP.NET MVC a webová služba&#x2014;WCF vytvoří proces sestavení balíček pro nasazení webu pro každý projekt.</span><span class="sxs-lookup"><span data-stu-id="e55f1-136">For web projects&#x2014;in this case, an ASP.NET MVC web application and a WCF web service&#x2014;the build process creates a web deployment package for each project.</span></span>
    2. <span data-ttu-id="e55f1-137">Pro databázové projekty vytvoří proces sestavení manifest nasazení (soubor. DeployManifest) pro každý projekt.</span><span class="sxs-lookup"><span data-stu-id="e55f1-137">For database projects, the build process creates a deployment manifest (.deploymanifest file) for each project.</span></span>
3. <span data-ttu-id="e55f1-138">Používá nástroj VSDBCMD. exe k nasazení jednotlivých databázových projektů v řešení pomocí různých vlastností ze souborů&#x2014;projektu cílový připojovací řetězec a název&#x2014;databáze společně se souborem. DeployManifest.</span><span class="sxs-lookup"><span data-stu-id="e55f1-138">It uses the VSDBCMD.exe utility to deploy each database project in the solution, using various properties from the project files&#x2014;a target connection string and a database name&#x2014;together with the .deploymanifest file.</span></span>
4. <span data-ttu-id="e55f1-139">Používá nástroj MSDeploy. exe k nasazení každého webového projektu v řešení pomocí různých vlastností ze souborů projektu pro řízení procesu nasazení.</span><span class="sxs-lookup"><span data-stu-id="e55f1-139">It uses the MSDeploy.exe utility to deploy each web project in the solution, using various properties from the project files to control the deployment process.</span></span>

<span data-ttu-id="e55f1-140">Pomocí ukázkového řešení můžete tento proces sledovat podrobněji.</span><span class="sxs-lookup"><span data-stu-id="e55f1-140">You can use the sample solution to trace this process in more detail.</span></span>

> [!NOTE]
> <span data-ttu-id="e55f1-141">Pokyny k přizpůsobení souborů projektu specifických pro prostředí pro vlastní serverová prostředí najdete v tématu [Konfigurace vlastností nasazení pro cílové prostředí](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).</span><span class="sxs-lookup"><span data-stu-id="e55f1-141">For guidance on how to customize the environment-specific project files for your own server environments, see [Configure Deployment Properties for a Target Environment](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).</span></span>

## <a name="invoking-the-build-and-deployment-process"></a><span data-ttu-id="e55f1-142">Vyvolává se proces Build and Deployment.</span><span class="sxs-lookup"><span data-stu-id="e55f1-142">Invoking the Build and Deployment Process</span></span>

<span data-ttu-id="e55f1-143">Pro nasazení řešení Contact Manageru do testovacího prostředí Vývojář spustí vývojář soubor příkazů *Publish-dev. cmd* .</span><span class="sxs-lookup"><span data-stu-id="e55f1-143">To deploy the Contact Manager solution to a developer test environment, the developer runs the *Publish-Dev.cmd* command file.</span></span> <span data-ttu-id="e55f1-144">Tím se vyvolá MSBuild. exe, zadáním příkazu *Publish. proj* jako souboru projektu pro provedení a *env. proj* jako hodnoty parametru.</span><span class="sxs-lookup"><span data-stu-id="e55f1-144">This invokes MSBuild.exe, specifying *Publish.proj* as the project file to execute and *Env-Dev.proj* as a parameter value.</span></span>

[!code-console[Main](understanding-the-build-process/samples/sample1.cmd)]

> [!NOTE]
> <span data-ttu-id="e55f1-145">Přepínač **/FL** (krátký pro **/FileLogger**) zapíše výstup sestavení do souboru s názvem *MSBuild. log* v aktuálním adresáři.</span><span class="sxs-lookup"><span data-stu-id="e55f1-145">The **/fl** switch (short for **/fileLogger**) logs the build output to a file named *msbuild.log* in the current directory.</span></span> <span data-ttu-id="e55f1-146">Další informace naleznete v tématu [Reference k příkazovému řádku MSBuild](https://msdn.microsoft.com/library/ms164311.aspx).</span><span class="sxs-lookup"><span data-stu-id="e55f1-146">For more information, see the [MSBuild Command Line Reference](https://msdn.microsoft.com/library/ms164311.aspx).</span></span>

<span data-ttu-id="e55f1-147">V tomto okamžiku spustí nástroj MSBuild spuštěný, načte soubor *Publish. proj* a spustí zpracování pokynů v něm.</span><span class="sxs-lookup"><span data-stu-id="e55f1-147">At this point, MSBuild starts running, loads the *Publish.proj* file, and starts processing the instructions within it.</span></span> <span data-ttu-id="e55f1-148">První instrukce instruuje nástroj MSBuild, aby naimportoval soubor projektu, který určuje parametr **TargetEnvPropsFile** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-148">The first instruction tells MSBuild to import the project file that the **TargetEnvPropsFile** parameter specifies.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample2.xml)]

<span data-ttu-id="e55f1-149">Parametr **TargetEnvPropsFile** určuje soubor *ENV-dev. proj* , takže nástroj MSBuild sloučí obsah souboru *ENV-dev. proj* do souboru *Publish. proj* .</span><span class="sxs-lookup"><span data-stu-id="e55f1-149">The **TargetEnvPropsFile** parameter specifies the *Env-Dev.proj* file, so MSBuild merges the contents of the *Env-Dev.proj* file into the *Publish.proj* file.</span></span>

<span data-ttu-id="e55f1-150">Další prvky, které nástroj MSBuild nalezne ve sloučeném souboru projektu, jsou skupiny vlastností.</span><span class="sxs-lookup"><span data-stu-id="e55f1-150">The next elements that MSBuild encounters in the merged project file are property groups.</span></span> <span data-ttu-id="e55f1-151">Vlastnosti jsou zpracovávány v pořadí, ve kterém jsou uvedeny v souboru.</span><span class="sxs-lookup"><span data-stu-id="e55f1-151">Properties are processed in the order in which they appear in the file.</span></span> <span data-ttu-id="e55f1-152">Nástroj MSBuild vytvoří dvojici klíč-hodnota pro každou vlastnost a zajistí splnění všech zadaných podmínek.</span><span class="sxs-lookup"><span data-stu-id="e55f1-152">MSBuild creates a key-value pair for each property, providing that any specified conditions are met.</span></span> <span data-ttu-id="e55f1-153">Vlastnosti definované později v souboru přepíšou všechny vlastnosti se stejným názvem definovaným dříve v souboru.</span><span class="sxs-lookup"><span data-stu-id="e55f1-153">Properties defined later in the file will overwrite any properties with the same name defined earlier in the file.</span></span> <span data-ttu-id="e55f1-154">Zvažte například vlastnosti **OutputRoot** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-154">For example, consider the **OutputRoot** properties.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample3.xml)]

<span data-ttu-id="e55f1-155">Když nástroj MSBuild zpracuje první element **OutputRoot** , neposkytne se podobný parametr s podobným názvem, nastaví hodnotu vlastnosti **OutputRoot** na **.. \Publish\Out**. Když dojde k druhému prvku **OutputRoot** , pokud je podmínka vyhodnocena jako **true**, přepíše hodnotu vlastnosti **OutputRoot** hodnotou parametru **OutDir** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-155">When MSBuild processes the first **OutputRoot** element, providing a similarly named parameter has not been provided, it sets the value of the **OutputRoot** property to **..\Publish\Out**. When it encounters the second **OutputRoot** element, if the condition evaluates to **true**, it will overwrite the value of the **OutputRoot** property with the value of the **OutDir** parameter.</span></span>

<span data-ttu-id="e55f1-156">Další prvek, který MSBuild narazí, je jediná skupina položek obsahující položku s názvem **ProjectsToBuild**.</span><span class="sxs-lookup"><span data-stu-id="e55f1-156">The next element that MSBuild encounters is a single item group, containing an item named **ProjectsToBuild**.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample4.xml)]

<span data-ttu-id="e55f1-157">Nástroj MSBuild zpracovává tuto instrukci vytvořením seznamu položek s názvem **ProjectsToBuild**.</span><span class="sxs-lookup"><span data-stu-id="e55f1-157">MSBuild processes this instruction by building an item list named **ProjectsToBuild**.</span></span> <span data-ttu-id="e55f1-158">V tomto případě obsahuje seznam položek jednu hodnotu&#x2014;cesta a název souboru řešení.</span><span class="sxs-lookup"><span data-stu-id="e55f1-158">In this case, the item list contains a single value&#x2014;the path and filename of the solution file.</span></span>

<span data-ttu-id="e55f1-159">V tomto okamžiku jsou zbývající prvky cíli.</span><span class="sxs-lookup"><span data-stu-id="e55f1-159">At this point, the remaining elements are targets.</span></span> <span data-ttu-id="e55f1-160">Cíle jsou zpracovávány jinak než z vlastností&#x2014;a položek v podstatě, cíle nejsou zpracovávány, pokud nejsou explicitně zadány uživatelem nebo vyvolány jinou konstrukcí v rámci souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="e55f1-160">Targets are processed differently from properties and items&#x2014;essentially, targets are not processed unless they are either explicitly specified by the user or invoked by another construct within the project file.</span></span> <span data-ttu-id="e55f1-161">Odvolat, že otevírací značka **projektu** obsahuje atribut **DefaultTargets –** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-161">Recall that the opening **Project** tag includes a **DefaultTargets** attribute.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample5.xml)]

<span data-ttu-id="e55f1-162">Nástroj MSBuild dá pokyn k vyvolání cíle **FullPublish** , nejsou-li při vyvolání nástroje MSBuild. exe určeny cíle.</span><span class="sxs-lookup"><span data-stu-id="e55f1-162">This instructs MSBuild to invoke the **FullPublish** target, if targets are not specified when MSBuild.exe is invoked.</span></span> <span data-ttu-id="e55f1-163">Cíl **FullPublish** neobsahuje žádné úlohy. místo toho určuje pouze seznam závislostí.</span><span class="sxs-lookup"><span data-stu-id="e55f1-163">The **FullPublish** target doesn't contain any tasks; instead it simply specifies a list of dependencies.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample6.xml)]

<span data-ttu-id="e55f1-164">Tato závislost oznamuje nástroji MSBuild, že má spustit cíl **FullPublish** , musí vyvolat tento seznam cílů v zadaném pořadí:</span><span class="sxs-lookup"><span data-stu-id="e55f1-164">This dependency tells MSBuild that in order to execute the **FullPublish** target, it needs to invoke this list of targets in the order provided:</span></span>

1. <span data-ttu-id="e55f1-165">Musí vyvolat **čistý** cíl.</span><span class="sxs-lookup"><span data-stu-id="e55f1-165">It must invoke the **Clean** target.</span></span>
2. <span data-ttu-id="e55f1-166">Musí vyvolat cíl **BuildProjects** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-166">It must invoke the **BuildProjects** target.</span></span>
3. <span data-ttu-id="e55f1-167">Musí vyvolat cíl **GatherPackagesForPublishing** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-167">It must invoke the **GatherPackagesForPublishing** target.</span></span>
4. <span data-ttu-id="e55f1-168">Musí vyvolat cíl **PublishDbPackages** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-168">It must invoke the **PublishDbPackages** target.</span></span>
5. <span data-ttu-id="e55f1-169">Musí vyvolat cíl **PublishWebPackages** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-169">It must invoke the **PublishWebPackages** target.</span></span>

### <a name="the-clean-target"></a><span data-ttu-id="e55f1-170">Cíl vyčištění</span><span class="sxs-lookup"><span data-stu-id="e55f1-170">The Clean Target</span></span>

<span data-ttu-id="e55f1-171">**Čistý** cíl v podstatě odstraní výstupní adresář a veškerý jeho obsah jako přípravu pro nové sestavení.</span><span class="sxs-lookup"><span data-stu-id="e55f1-171">The **Clean** target basically deletes the output directory and all its contents, as preparation for a fresh build.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample7.xml)]

<span data-ttu-id="e55f1-172">Všimněte si, že cíl zahrnuje prvek **Item** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-172">Notice that the target includes an **ItemGroup** element.</span></span> <span data-ttu-id="e55f1-173">Při definování vlastností nebo položek v rámci **cílového** prvku vytváříte *dynamické* vlastnosti a položky.</span><span class="sxs-lookup"><span data-stu-id="e55f1-173">When you define properties or items within a **Target** element, you're creating *dynamic* properties and items.</span></span> <span data-ttu-id="e55f1-174">Jinými slovy, vlastnosti nebo položky nejsou zpracovány, dokud není proveden cíl.</span><span class="sxs-lookup"><span data-stu-id="e55f1-174">In other words, the properties or items aren't processed until the target is executed.</span></span> <span data-ttu-id="e55f1-175">Výstupní adresář možná neexistuje nebo obsahuje žádné soubory, dokud proces sestavení nezačne, takže nemůžete sestavit **\_FilesToDelete** seznamu jako statickou položku; musíte počkat, až bude prováděno provádění.</span><span class="sxs-lookup"><span data-stu-id="e55f1-175">The output directory might not exist or contain any files until the build process begins, so you can't build the **\_FilesToDelete** list as a static item; you have to wait until execution is underway.</span></span> <span data-ttu-id="e55f1-176">V takovém případě sestavíte seznam jako dynamickou položku v rámci cíle.</span><span class="sxs-lookup"><span data-stu-id="e55f1-176">As such, you build the list as a dynamic item within the target.</span></span>

> [!NOTE]
> <span data-ttu-id="e55f1-177">V takovém případě, protože **čistý** cíl je první spuštění, není nutné používat dynamickou skupinu položek.</span><span class="sxs-lookup"><span data-stu-id="e55f1-177">In this case, because the **Clean** target is the first to be executed, there's no real need to use a dynamic item group.</span></span> <span data-ttu-id="e55f1-178">V tomto typu scénáře je však vhodné použít dynamické vlastnosti a položky, protože v určitém okamžiku můžete chtít provést cíle v jiném pořadí.</span><span class="sxs-lookup"><span data-stu-id="e55f1-178">However, it's good practice to use dynamic properties and items in this type of scenario, as you might want to execute targets in a different order at some point.</span></span>  
> <span data-ttu-id="e55f1-179">Měli byste se také zaměřit, aby nedošlo k deklarování položek, které nikdy nebudou použity.</span><span class="sxs-lookup"><span data-stu-id="e55f1-179">You should also aim to avoid declaring items that will never be used.</span></span> <span data-ttu-id="e55f1-180">Pokud máte položky, které bude používat jenom konkrétní cíl, zvažte jejich umístění uvnitř cíle, aby se odstranila veškerá nepotřebná režie na proces sestavení.</span><span class="sxs-lookup"><span data-stu-id="e55f1-180">If you have items that will only be used by a specific target, consider placing them inside the target to remove any unnecessary overhead on the build process.</span></span>

<span data-ttu-id="e55f1-181">Mimo jiné dynamické položky je **čistý** cíl poměrně jednoduchý a využívá předdefinované **zprávy**, **odstraňování**a **RemoveDir –** úkoly:</span><span class="sxs-lookup"><span data-stu-id="e55f1-181">Dynamic items aside, the **Clean** target is fairly straightforward and makes use of the built-in **Message**, **Delete**, and **RemoveDir** tasks to:</span></span>

1. <span data-ttu-id="e55f1-182">Odeslat zprávu do protokolovacího nástroje.</span><span class="sxs-lookup"><span data-stu-id="e55f1-182">Send a message to the logger.</span></span>
2. <span data-ttu-id="e55f1-183">Sestavte seznam souborů, které chcete odstranit.</span><span class="sxs-lookup"><span data-stu-id="e55f1-183">Build a list of files to delete.</span></span>
3. <span data-ttu-id="e55f1-184">Odstraňte soubory.</span><span class="sxs-lookup"><span data-stu-id="e55f1-184">Delete the files.</span></span>
4. <span data-ttu-id="e55f1-185">Odeberte výstupní adresář.</span><span class="sxs-lookup"><span data-stu-id="e55f1-185">Remove the output directory.</span></span>

### <a name="the-buildprojects-target"></a><span data-ttu-id="e55f1-186">Cíl BuildProjects</span><span class="sxs-lookup"><span data-stu-id="e55f1-186">The BuildProjects Target</span></span>

<span data-ttu-id="e55f1-187">Cíl **BuildProjects** v podstatě sestaví všechny projekty v ukázkovém řešení.</span><span class="sxs-lookup"><span data-stu-id="e55f1-187">The **BuildProjects** target basically builds all the projects in the sample solution.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample8.xml)]

<span data-ttu-id="e55f1-188">Tento cíl byl podrobněji popsán v předchozím tématu, [porozumění souboru projektu](understanding-the-project-file.md)pro ilustraci, jakým způsobem jsou úkoly a cíle odkazovat na vlastnosti a položky.</span><span class="sxs-lookup"><span data-stu-id="e55f1-188">This target was described in some detail in the previous topic, [Understanding the Project File](understanding-the-project-file.md), to illustrate how tasks and targets reference properties and items.</span></span> <span data-ttu-id="e55f1-189">V tuto chvíli vás zajímá hlavně úlohu **MSBuild** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-189">At this point, you're mainly interested in the **MSBuild** task.</span></span> <span data-ttu-id="e55f1-190">Tuto úlohu můžete použít k sestavení více projektů.</span><span class="sxs-lookup"><span data-stu-id="e55f1-190">You can use this task to build multiple projects.</span></span> <span data-ttu-id="e55f1-191">Úloha nevytváří novou instanci nástroje MSBuild. exe; používá aktuální spuštěnou instanci pro sestavení jednotlivých projektů.</span><span class="sxs-lookup"><span data-stu-id="e55f1-191">The task does not create a new instance of MSBuild.exe; it uses the current running instance to build each project.</span></span> <span data-ttu-id="e55f1-192">Klíčové body zájmu v tomto příkladu jsou vlastnosti nasazení:</span><span class="sxs-lookup"><span data-stu-id="e55f1-192">The key points of interest in this example are the deployment properties:</span></span>

- <span data-ttu-id="e55f1-193">Vlastnost **DeployOnBuild** instruuje nástroj MSBuild, aby po dokončení sestavení každého projektu spouštěla jakékoli pokyny k nasazení v nastavení projektu.</span><span class="sxs-lookup"><span data-stu-id="e55f1-193">The **DeployOnBuild** property instructs MSBuild to run any deployment instructions in the project settings when the build of each project is complete.</span></span>
- <span data-ttu-id="e55f1-194">Vlastnost **DeployTarget** identifikuje cíl, který chcete vyvolat po sestavení projektu.</span><span class="sxs-lookup"><span data-stu-id="e55f1-194">The **DeployTarget** property identifies the target that you want to invoke after the project is built.</span></span> <span data-ttu-id="e55f1-195">V tomto případě cílový **balíček** sestaví výstup projektu do nasazeného webového balíčku.</span><span class="sxs-lookup"><span data-stu-id="e55f1-195">In this case, the **Package** target builds the project output into a deployable web package.</span></span>

> [!NOTE]
> <span data-ttu-id="e55f1-196">Cíl **balíčku** vyvolá kanál publikování na webu (WPP), který poskytuje integraci mezi msbuildem a nasazení webu.</span><span class="sxs-lookup"><span data-stu-id="e55f1-196">The **Package** target invokes the Web Publishing Pipeline (WPP), which provides integration between MSBuild and Web Deploy.</span></span> <span data-ttu-id="e55f1-197">Pokud se chcete podívat na předdefinované cíle, které poskytuje WPP, zkontrolujte soubor *Microsoft. Web. Publishing. targets* ve složce% ProgramFiles (x86)% \ MSBuild\Microsoft\VisualStudio\v10.0\Web.</span><span class="sxs-lookup"><span data-stu-id="e55f1-197">If you want to take a look at the built-in targets that the WPP provides, review the *Microsoft.Web.Publishing.targets* file in the %PROGRAMFILES(x86)%\MSBuild\Microsoft\VisualStudio\v10.0\Web folder.</span></span>

### <a name="the-gatherpackagesforpublishing-target"></a><span data-ttu-id="e55f1-198">Cíl GatherPackagesForPublishing</span><span class="sxs-lookup"><span data-stu-id="e55f1-198">The GatherPackagesForPublishing Target</span></span>

<span data-ttu-id="e55f1-199">Pokud zkoumáte cíl **GatherPackagesForPublishing** , všimnete si, že ve skutečnosti neobsahují žádné úkoly.</span><span class="sxs-lookup"><span data-stu-id="e55f1-199">If you study the **GatherPackagesForPublishing** target, you'll notice that it doesn't actually contain any tasks.</span></span> <span data-ttu-id="e55f1-200">Místo toho obsahuje jednu skupinu položek, která definuje tři dynamické položky.</span><span class="sxs-lookup"><span data-stu-id="e55f1-200">Instead, it contains a single item group that defines three dynamic items.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample9.xml)]

<span data-ttu-id="e55f1-201">Tyto položky odkazují na balíčky pro nasazení, které byly vytvořeny při spuštění cíle **BuildProjects** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-201">These items refer to the deployment packages that were created when the **BuildProjects** target was executed.</span></span> <span data-ttu-id="e55f1-202">Tyto položky nelze definovat staticky v souboru projektu, protože soubory, na které položky odkazují, neexistují, dokud není proveden cíl **BuildProjects** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-202">You couldn't define these items statically in the project file, because the files to which the items refer don't exist until the **BuildProjects** target is executed.</span></span> <span data-ttu-id="e55f1-203">Místo toho musí být položky definovány dynamicky v rámci cíle, který není vyvolán až po provedení cíle **BuildProjects** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-203">Instead, the items must be defined dynamically within a target that is not invoked until after the **BuildProjects** target is executed.</span></span>

<span data-ttu-id="e55f1-204">Tyto položky se v tomto cíli&#x2014;nepoužívají. Tento cíl jednoduše sestaví položky a Metadata přidružená k jednotlivým hodnotám položek.</span><span class="sxs-lookup"><span data-stu-id="e55f1-204">The items are not used within this target&#x2014;this target simply builds the items and the metadata associated with each item value.</span></span> <span data-ttu-id="e55f1-205">Po zpracování těchto prvků bude položka **PublishPackages** obsahovat dvě hodnoty, cestu k souboru *ContactManager. Mvc. deploy. cmd* a cestu k souboru *ContactManager. Service. deploy. cmd* .</span><span class="sxs-lookup"><span data-stu-id="e55f1-205">Once these elements are processed, the **PublishPackages** item will contain two values, the path to the *ContactManager.Mvc.deploy.cmd* file and the path to the *ContactManager.Service.deploy.cmd* file.</span></span> <span data-ttu-id="e55f1-206">Nasazení webu vytvoří tyto soubory jako součást webového balíčku pro každý projekt a jedná se o soubory, které je nutné vyvolat na cílovém serveru, aby bylo možné balíčky nasadit.</span><span class="sxs-lookup"><span data-stu-id="e55f1-206">Web Deploy creates these files as part of the web package for each project, and these are the files that you must invoke on the destination server in order to deploy the packages.</span></span> <span data-ttu-id="e55f1-207">Otevřete-li jeden z těchto souborů, bude v podstatě zobrazen příkaz MSDeploy. exe s různými hodnotami parametrů specifických pro sestavení.</span><span class="sxs-lookup"><span data-stu-id="e55f1-207">If you open up one of these files, you'll basically see an MSDeploy.exe command with various build-specific parameter values.</span></span>

<span data-ttu-id="e55f1-208">Položka **DbPublishPackages** bude obsahovat jednu hodnotu, cestu k souboru *ContactManager. Database. DeployManifest* .</span><span class="sxs-lookup"><span data-stu-id="e55f1-208">The **DbPublishPackages** item will contain a single value, the path to the *ContactManager.Database.deploymanifest* file.</span></span>

> [!NOTE]
> <span data-ttu-id="e55f1-209">Soubor. DeployManifest je generován při vytváření databázového projektu a používá stejné schéma jako soubor projektu MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e55f1-209">A .deploymanifest file is generated when you build a database project, and it uses the same schema as an MSBuild project file.</span></span> <span data-ttu-id="e55f1-210">Obsahuje všechny informace potřebné k nasazení databáze včetně umístění schématu databáze (. dbschema) a podrobností všech skriptů před nasazením a po nasazení.</span><span class="sxs-lookup"><span data-stu-id="e55f1-210">It contains all the information required to deploy a database, including the location of the database schema (.dbschema) and details of any pre-deployment and post-deployment scripts.</span></span> <span data-ttu-id="e55f1-211">Další informace najdete v tématu [přehled Build and Deployment databáze](https://msdn.microsoft.com/library/aa833165.aspx).</span><span class="sxs-lookup"><span data-stu-id="e55f1-211">For more information, see [An Overview of Database Build and Deployment](https://msdn.microsoft.com/library/aa833165.aspx).</span></span>

<span data-ttu-id="e55f1-212">Dozvíte se víc o tom, jak se vytvářejí a používají balíčky pro nasazení a manifesty nasazení databáze při [sestavování a zabalení projektů webových aplikací](building-and-packaging-web-application-projects.md) a [nasazení databázových projektů](deploying-database-projects.md).</span><span class="sxs-lookup"><span data-stu-id="e55f1-212">You'll learn more about how deployment packages and database deployment manifests are created and used in [Building and Packaging Web Application Projects](building-and-packaging-web-application-projects.md) and [Deploying Database Projects](deploying-database-projects.md).</span></span>

### <a name="the-publishdbpackages-target"></a><span data-ttu-id="e55f1-213">Cíl PublishDbPackages</span><span class="sxs-lookup"><span data-stu-id="e55f1-213">The PublishDbPackages Target</span></span>

<span data-ttu-id="e55f1-214">Krátce řečeno, cíl **PublishDbPackages** VYVOLÁ nástroj VSDBCMD pro nasazení databáze **ContactManager** do cílového prostředí.</span><span class="sxs-lookup"><span data-stu-id="e55f1-214">Briefly speaking, the **PublishDbPackages** target invokes the VSDBCMD utility to deploy the **ContactManager** database to a target environment.</span></span> <span data-ttu-id="e55f1-215">Konfigurace nasazení databáze zahrnuje spoustu rozhodnutí a drobné odlišnosti a další informace o tomto postupu najdete v části [nasazení databázových projektů](deploying-database-projects.md) a [přizpůsobení nasazení databáze pro více prostředí](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="e55f1-215">Configuring database deployment involves lots of decisions and nuances, and you'll learn more about this in [Deploying Database Projects](deploying-database-projects.md) and [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span> <span data-ttu-id="e55f1-216">V tomto tématu se zaměříme na to, jak tento cíl skutečně funguje.</span><span class="sxs-lookup"><span data-stu-id="e55f1-216">In this topic, we'll focus on how this target actually functions.</span></span>

<span data-ttu-id="e55f1-217">Nejprve si všimněte, že počáteční značka obsahuje atribut **výstupy** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-217">First, notice that the opening tag includes an **Outputs** attribute.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample10.xml)]

<span data-ttu-id="e55f1-218">Toto je příklad *cílového dávkování*.</span><span class="sxs-lookup"><span data-stu-id="e55f1-218">This is an example of *target batching*.</span></span> <span data-ttu-id="e55f1-219">V souborech projektu MSBuild je dávkování metodou pro iteraci kolekce.</span><span class="sxs-lookup"><span data-stu-id="e55f1-219">In MSBuild project files, batching is a technique for iterating over collections.</span></span> <span data-ttu-id="e55f1-220">Hodnota atributu Outputs ( **výstups** **) "% (DbPublishPackages. identity)"** odkazuje na vlastnost metadata **identity** seznamu položek **DbPublishPackages** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-220">The value of the **Outputs** attribute, **"%(DbPublishPackages.Identity)"**, refers to the **Identity** metadata property of the **DbPublishPackages** item list.</span></span> <span data-ttu-id="e55f1-221">Tento zápis \**výstupy =% \* \* \* (ITEMLIST. ItemMetaDataName)* je přeložen jako:</span><span class="sxs-lookup"><span data-stu-id="e55f1-221">This notation, \**Outputs=%\*\*\*(ItemList.ItemMetadataName)*, is translated as:</span></span>

- <span data-ttu-id="e55f1-222">Rozdělte položky v **DbPublishPackages** na dávky položek, které obsahují stejnou hodnotu metadat **identity** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-222">Split the items in **DbPublishPackages** into batches of items that contain the same **Identity** metadata value.</span></span>
- <span data-ttu-id="e55f1-223">Spustí cíl na dávce.</span><span class="sxs-lookup"><span data-stu-id="e55f1-223">Execute the target once per batch.</span></span>

> [!NOTE]
> <span data-ttu-id="e55f1-224">**Identita** je jedna z [vestavěných hodnot metadat](https://msdn.microsoft.com/library/ms164313.aspx) , která je přiřazena ke každé položce při vytváření.</span><span class="sxs-lookup"><span data-stu-id="e55f1-224">**Identity** is one of the [built-in metadata values](https://msdn.microsoft.com/library/ms164313.aspx) that is assigned to every item on creation.</span></span> <span data-ttu-id="e55f1-225">Odkazuje na hodnotu atributu **include** v prvku&#x2014; **Item** jinými slovy, cestu a název souboru položky.</span><span class="sxs-lookup"><span data-stu-id="e55f1-225">It refers to the value of the **Include** attribute in the **Item** element&#x2014;in other words, the path and filename of the item.</span></span>

<span data-ttu-id="e55f1-226">V takovém případě, protože by nikdy neměla existovat více než jedna položka se stejnou cestou a názvem souboru, budeme v podstatě pracovat se velikostmi dávek.</span><span class="sxs-lookup"><span data-stu-id="e55f1-226">In this case, because there should never be more than one item with the same path and filename, we're essentially working with batch sizes of one.</span></span> <span data-ttu-id="e55f1-227">Cíl se spustí jednou pro každý databázový balíček.</span><span class="sxs-lookup"><span data-stu-id="e55f1-227">The target is executed once for every database package.</span></span>

<span data-ttu-id="e55f1-228">Podobný zápis můžete zobrazit ve vlastnosti **\_cmd** , která vytvoří příkaz VSDBCMD s příslušnými přepínači.</span><span class="sxs-lookup"><span data-stu-id="e55f1-228">You can see a similar notation in the **\_Cmd** property, which builds a VSDBCMD command with the appropriate switches.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample11.xml)]

<span data-ttu-id="e55f1-229">V tomto případě: **% (DbPublishPackages. DatabaseConnectionString)** , **% (DbPublishPackages. TargetDatabase)** a **% (DbPublishPackages. FullPath)** odkazuje na hodnoty metadat kolekce položek **DbPublishPackages** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-229">In this case, **%(DbPublishPackages.DatabaseConnectionString)**, **%(DbPublishPackages.TargetDatabase)**, and **%(DbPublishPackages.FullPath)** all refer to metadata values of the **DbPublishPackages** item collection.</span></span> <span data-ttu-id="e55f1-230">Vlastnost **\_cmd** je používána úlohou **exec** , která vyvolá příkaz.</span><span class="sxs-lookup"><span data-stu-id="e55f1-230">The **\_Cmd** property is used by the **Exec** task, which invokes the command.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample12.xml)]

<span data-ttu-id="e55f1-231">V důsledku tohoto zápisu úloha **exec** vytvoří dávky na základě jedinečných kombinací hodnot metadat **DatabaseConnectionString**, **TargetDatabase**a **FullPath** a úloha se spustí jednou pro každou dávku.</span><span class="sxs-lookup"><span data-stu-id="e55f1-231">As a result of this notation, the **Exec** task will create batches based on unique combinations of the **DatabaseConnectionString**, **TargetDatabase**, and **FullPath** metadata values, and the task will execute once for each batch.</span></span> <span data-ttu-id="e55f1-232">Toto je příklad *dávkového zpracování úloh*.</span><span class="sxs-lookup"><span data-stu-id="e55f1-232">This is an example of *task batching*.</span></span> <span data-ttu-id="e55f1-233">Vzhledem k tomu, že dávkování na úrovni cíle již dělí kolekci položek na dávky s jednou položkou, úloha **exec** se spustí jednou a pouze jednou pro každou iteraci cíle.</span><span class="sxs-lookup"><span data-stu-id="e55f1-233">However, because the target-level batching has already divided our item collection into single-item batches, the **Exec** task will run once and only once for each iteration of the target.</span></span> <span data-ttu-id="e55f1-234">Jinými slovy Tato úloha vyvolá nástroj VSDBCMD jednou pro každý balíček databáze v řešení.</span><span class="sxs-lookup"><span data-stu-id="e55f1-234">In other words, this task invokes the VSDBCMD utility once for each database package in the solution.</span></span>

> [!NOTE]
> <span data-ttu-id="e55f1-235">Další informace o cíli a dávkování úloh najdete v tématech [dávkování](https://msdn.microsoft.com/library/ms171473.aspx)nástroje MSBuild, [metadata položky v cílové dávce](https://msdn.microsoft.com/library/ms228229.aspx)a [Metadata položek v dávkování úloh](https://msdn.microsoft.com/library/ms171474.aspx).</span><span class="sxs-lookup"><span data-stu-id="e55f1-235">For more information on target and task batching, see MSBuild [Batching](https://msdn.microsoft.com/library/ms171473.aspx), [Item Metadata in Target Batching](https://msdn.microsoft.com/library/ms228229.aspx), and [Item Metadata in Task Batching](https://msdn.microsoft.com/library/ms171474.aspx).</span></span>

### <a name="the-publishwebpackages-target"></a><span data-ttu-id="e55f1-236">Cíl PublishWebPackages</span><span class="sxs-lookup"><span data-stu-id="e55f1-236">The PublishWebPackages Target</span></span>

<span data-ttu-id="e55f1-237">Od tohoto okamžiku jste vyvolali cíl **BuildProjects** , který generuje balíček pro nasazení webu pro každý projekt v ukázkovém řešení.</span><span class="sxs-lookup"><span data-stu-id="e55f1-237">By this point, you've invoked the **BuildProjects** target, which generates a web deployment package for each project in the sample solution.</span></span> <span data-ttu-id="e55f1-238">Každý balíček je přiložen k souboru *Deploy. cmd* , který obsahuje příkazy MSDeploy. exe vyžadované k nasazení balíčku do cílového prostředí a soubor *SetParameters. XML* , který určuje nezbytné podrobnosti o cílovém prostředí.</span><span class="sxs-lookup"><span data-stu-id="e55f1-238">Accompanying each package is a *deploy.cmd* file, which contains the MSDeploy.exe commands required to deploy the package to the target environment, and a *SetParameters.xml* file, which specifies the necessary details of the target environment.</span></span> <span data-ttu-id="e55f1-239">Vyvolali jste také cíl **GatherPackagesForPublishing** , který generuje kolekci položek obsahující soubory *Deploy. cmd* , které vás zajímají.</span><span class="sxs-lookup"><span data-stu-id="e55f1-239">You've also invoked the **GatherPackagesForPublishing** target, which generates an item collection containing the *deploy.cmd* files you're interested in.</span></span> <span data-ttu-id="e55f1-240">Cíl **PublishWebPackages** v podstatě provádí tyto funkce:</span><span class="sxs-lookup"><span data-stu-id="e55f1-240">Essentially, the **PublishWebPackages** target performs these functions:</span></span>

- <span data-ttu-id="e55f1-241">Zpracovává soubor *SetParameters. XML* pro každý balíček, aby obsahoval správné podrobnosti pro cílové prostředí pomocí úlohy **XmlPoke –** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-241">It manipulates the *SetParameters.xml* file for each package to include the correct details for the target environment, using the **XmlPoke** task.</span></span>
- <span data-ttu-id="e55f1-242">Vyvolá soubor *Deploy. cmd* pro každý balíček pomocí příslušných přepínačů.</span><span class="sxs-lookup"><span data-stu-id="e55f1-242">It invokes the *deploy.cmd* file for each package, using the appropriate switches.</span></span>

<span data-ttu-id="e55f1-243">Podobně jako v cíli **PublishDbPackages** používá cíl **PublishWebPackages** cílové dávkování, aby se zajistilo, že se cíl spustí jednou pro každý webový balíček.</span><span class="sxs-lookup"><span data-stu-id="e55f1-243">Just like the **PublishDbPackages** target, the **PublishWebPackages** target uses target batching to ensure that the target is executed once for each web package.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample13.xml)]

<span data-ttu-id="e55f1-244">V rámci cíle se ke spuštění souboru *Deploy. cmd* pro každý webový balíček používá úloha **exec** .</span><span class="sxs-lookup"><span data-stu-id="e55f1-244">Within the target, the **Exec** task is used to run the *deploy.cmd* file for each web package.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample14.xml)]

<span data-ttu-id="e55f1-245">Další informace o konfiguraci nasazení webových balíčků naleznete v tématu [sestavování a balení projektů webových aplikací](building-and-packaging-web-application-projects.md).</span><span class="sxs-lookup"><span data-stu-id="e55f1-245">For more information on configuring the deployment of web packages, see [Building and Packaging Web Application Projects](building-and-packaging-web-application-projects.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="e55f1-246">Závěr</span><span class="sxs-lookup"><span data-stu-id="e55f1-246">Conclusion</span></span>

<span data-ttu-id="e55f1-247">Toto téma poskytuje návod, jak použít rozdělené soubory projektu k řízení procesu sestavení a nasazení od začátku do konce pro ukázkové řešení Contact Manageru.</span><span class="sxs-lookup"><span data-stu-id="e55f1-247">This topic provided a walkthrough of how split project files are used to control the build and deployment process from start to finish for the Contact Manager sample solution.</span></span> <span data-ttu-id="e55f1-248">Použití tohoto přístupu vám umožní spouštět složitá nasazení na podnikové úrovni v jednom kroku s možností opakování pouhým spuštěním souboru příkazů specifických pro konkrétní prostředí.</span><span class="sxs-lookup"><span data-stu-id="e55f1-248">Using this approach lets you run complex, enterprise-scale deployments in a single, repeatable step, simply by running an environment-specific command file.</span></span>

## <a name="further-reading"></a><span data-ttu-id="e55f1-249">Další čtení</span><span class="sxs-lookup"><span data-stu-id="e55f1-249">Further Reading</span></span>

<span data-ttu-id="e55f1-250">Podrobné seznámení se soubory projektu a WPP naleznete v části [uvnitř Microsoft Build Engine: použití nástroje MSBuild a Team Foundation Build](http://amzn.com/0735645248) podle Sayed Ibrahim Hashimi a William Bartholomew, ISBN: 978-0-7356-4524-0.</span><span class="sxs-lookup"><span data-stu-id="e55f1-250">For a more in-depth introduction to project files and the WPP, see [Inside the Microsoft Build Engine: Using MSBuild and Team Foundation Build](http://amzn.com/0735645248) by Sayed Ibrahim Hashimi and William Bartholomew, ISBN: 978-0-7356-4524-0.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e55f1-251">[Předchozí](understanding-the-project-file.md)
> [Další](building-and-packaging-web-application-projects.md)</span><span class="sxs-lookup"><span data-stu-id="e55f1-251">[Previous](understanding-the-project-file.md)
[Next](building-and-packaging-web-application-projects.md)</span></span>
