---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/create_the_data_access_layer
title: Vytvoření vrstvy přístupu k datům | Microsoft Docs
author: Erikre
description: V této sérii kurzů se seznámíte se základy vytváření aplikací webových formulářů ASP.NET pomocí ASP.NET 4,5 a Microsoft Visual Studio Express 2013 pro My...
ms.author: riande
ms.date: 09/08/2014
ms.assetid: 0bbf7a6e-d7eb-4091-91e4-fff892777f32
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/create_the_data_access_layer
msc.type: authoredcontent
ms.openlocfilehash: 0fcf050474a57be9ed53ec0783a6d6b7dde2bf4c
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78544924"
---
# <a name="create-the-data-access-layer"></a><span data-ttu-id="50950-103">Vytvoření vrstvy přístupu k datům</span><span class="sxs-lookup"><span data-stu-id="50950-103">Create the Data Access Layer</span></span>

<span data-ttu-id="50950-104">od [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="50950-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="50950-105">[Stáhnout vzorový projekt Wingtip Toys (C#)](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) nebo [Stáhnout elektronickou knihu (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="50950-105">[Download Wingtip Toys Sample Project (C#)](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="50950-106">V této sérii kurzů se naučíte základy vytváření webových formulářů ASP.NET pomocí ASP.NET 4,5 a Microsoft Visual Studio Express 2013 pro web.</span><span class="sxs-lookup"><span data-stu-id="50950-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="50950-107">K dispozici je Visual Studio 2013 [projekt se C# zdrojovým kódem](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) , který se doprovází v této sérii kurzů.</span><span class="sxs-lookup"><span data-stu-id="50950-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>

<span data-ttu-id="50950-108">V tomto kurzu se dozvíte, jak vytvořit, získat přístup a zkontrolovat data z databáze pomocí webových formulářů ASP.NET a Code First Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="50950-108">This tutorial describes how to create, access, and review data from a database using ASP.NET Web Forms and Entity Framework Code First.</span></span> <span data-ttu-id="50950-109">Tento kurz sestaví v předchozím kurzu "vytvořit projekt" a je součástí série kurzů pro společnost Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="50950-109">This tutorial builds on the previous tutorial "Create the Project" and is part of the Wingtip Toy Store tutorial series.</span></span> <span data-ttu-id="50950-110">Po dokončení tohoto kurzu budete mít vytvořenou skupinu tříd pro přístup k datům, které jsou ve složce *modely* projektu.</span><span class="sxs-lookup"><span data-stu-id="50950-110">When you've completed this tutorial, you will have built a group of data-access classes that are in the *Models* folder of the project.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="50950-111">Naučíte se:</span><span class="sxs-lookup"><span data-stu-id="50950-111">What you'll learn:</span></span>

- <span data-ttu-id="50950-112">Jak vytvořit datové modely.</span><span class="sxs-lookup"><span data-stu-id="50950-112">How to create the data models.</span></span>
- <span data-ttu-id="50950-113">Jak inicializovat a ohlašovat databázi.</span><span class="sxs-lookup"><span data-stu-id="50950-113">How to initialize and seed the database.</span></span>
- <span data-ttu-id="50950-114">Jak aktualizovat a nakonfigurovat aplikaci, aby podporovala databázi.</span><span class="sxs-lookup"><span data-stu-id="50950-114">How to update and configure the application to support the database.</span></span>

### <a name="these-are-the-features-introduced-in-the-tutorial"></a><span data-ttu-id="50950-115">Tyto funkce jsou představené v tomto kurzu:</span><span class="sxs-lookup"><span data-stu-id="50950-115">These are the features introduced in the tutorial:</span></span>

- <span data-ttu-id="50950-116">Entity Framework Code First</span><span class="sxs-lookup"><span data-stu-id="50950-116">Entity Framework Code First</span></span>
- <span data-ttu-id="50950-117">LocalDB</span><span class="sxs-lookup"><span data-stu-id="50950-117">LocalDB</span></span>
- <span data-ttu-id="50950-118">Datové poznámky</span><span class="sxs-lookup"><span data-stu-id="50950-118">Data Annotations</span></span>

## <a name="creating-the-data-models"></a><span data-ttu-id="50950-119">Vytváření datových modelů</span><span class="sxs-lookup"><span data-stu-id="50950-119">Creating the Data Models</span></span>

<span data-ttu-id="50950-120">[Entity Framework](https://msdn.microsoft.com/data/aa937723) je rozhraní pro mapování relačních objektů (ORM).</span><span class="sxs-lookup"><span data-stu-id="50950-120">[Entity Framework](https://msdn.microsoft.com/data/aa937723) is an object-relational mapping (ORM) framework.</span></span> <span data-ttu-id="50950-121">Umožňuje pracovat s relačními daty jako objekty a eliminovat většinu kódu přístupu k datům, který byste obvykle museli psát.</span><span class="sxs-lookup"><span data-stu-id="50950-121">It lets you work with relational data as objects, eliminating most of the data-access code that you'd usually need to write.</span></span> <span data-ttu-id="50950-122">Pomocí Entity Framework můžete vydávat dotazy pomocí [LINQ](https://msdn.microsoft.com/library/bb397926.aspx), načítat a manipulovat s daty jako objekty silného typu.</span><span class="sxs-lookup"><span data-stu-id="50950-122">Using Entity Framework, you can issue queries using [LINQ](https://msdn.microsoft.com/library/bb397926.aspx), then retrieve and manipulate data as strongly typed objects.</span></span> <span data-ttu-id="50950-123">LINQ poskytuje vzory pro dotazování a aktualizaci dat.</span><span class="sxs-lookup"><span data-stu-id="50950-123">LINQ provides patterns for querying and updating data.</span></span> <span data-ttu-id="50950-124">Použití Entity Framework vám umožní soustředit se na vytvoření zbytku aplikace a nemusíte se zaměřit na základy přístupu k datům.</span><span class="sxs-lookup"><span data-stu-id="50950-124">Using Entity Framework allows you to focus on creating the rest of your application, rather than focusing on the data access fundamentals.</span></span> <span data-ttu-id="50950-125">Později v této sérii kurzů vám ukážeme, jak používat data k naplnění navigace a dotazů na produkt.</span><span class="sxs-lookup"><span data-stu-id="50950-125">Later in this tutorial series, we'll show you how to use the data to populate navigation and product queries.</span></span>

<span data-ttu-id="50950-126">Entity Framework podporuje vývojové paradigma nazvané *Code First*.</span><span class="sxs-lookup"><span data-stu-id="50950-126">Entity Framework supports a development paradigm called *Code First*.</span></span> <span data-ttu-id="50950-127">Code First umožňuje definovat datové modely pomocí tříd.</span><span class="sxs-lookup"><span data-stu-id="50950-127">Code First lets you define your data models using classes.</span></span> <span data-ttu-id="50950-128">Třída je konstrukce, která umožňuje vytvořit vlastní typy seskupením proměnných jiných typů, metod a událostí.</span><span class="sxs-lookup"><span data-stu-id="50950-128">A class is a construct that enables you to create your own custom types by grouping together variables of other types, methods and events.</span></span> <span data-ttu-id="50950-129">Můžete mapovat třídy na existující databázi nebo je použít k vygenerování databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-129">You can map classes to an existing database or use them to generate a database.</span></span> <span data-ttu-id="50950-130">V tomto kurzu vytvoříte datové modely pomocí zápisu tříd datového modelu.</span><span class="sxs-lookup"><span data-stu-id="50950-130">In this tutorial, you'll create the data models by writing data model classes.</span></span> <span data-ttu-id="50950-131">Pak z těchto nových tříd umožníte Entity Framework vytvořit databázi průběžně.</span><span class="sxs-lookup"><span data-stu-id="50950-131">Then, you'll let Entity Framework create the database on the fly from these new classes.</span></span>

<span data-ttu-id="50950-132">Začnete vytvořením tříd entit, které definují datové modely pro aplikaci webových formulářů.</span><span class="sxs-lookup"><span data-stu-id="50950-132">You will begin by creating the entity classes that define the data models for the Web Forms application.</span></span> <span data-ttu-id="50950-133">Pak vytvoříte kontextovou třídu, která bude spravovat třídy entit a poskytuje přístup k datům databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-133">Then you will create a context class that manages the entity classes and provides data access to the database.</span></span> <span data-ttu-id="50950-134">Vytvoří se také Třída inicializátoru, kterou použijete k naplnění databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-134">You will also create an initializer class that you will use to populate the database.</span></span>

### <a name="entity-framework-and-references"></a><span data-ttu-id="50950-135">Entity Framework a odkazy</span><span class="sxs-lookup"><span data-stu-id="50950-135">Entity Framework and References</span></span>

<span data-ttu-id="50950-136">Ve výchozím nastavení je Entity Framework k dispozici při vytváření nové **webové aplikace ASP.NET** pomocí šablony **webových formulářů** .</span><span class="sxs-lookup"><span data-stu-id="50950-136">By default, Entity Framework is included when you create a new **ASP.NET Web Application** using the **Web Forms** template.</span></span> <span data-ttu-id="50950-137">Entity Framework může být nainstalováno, odinstalováno a aktualizováno jako balíček NuGet.</span><span class="sxs-lookup"><span data-stu-id="50950-137">Entity Framework can be installed, uninstalled, and updated as a NuGet package.</span></span>

<span data-ttu-id="50950-138">Tento balíček NuGet obsahuje následující sestavení **modulu runtime** v rámci projektu:</span><span class="sxs-lookup"><span data-stu-id="50950-138">This NuGet package includes the following **runtime** assemblies within your project:</span></span>

- <span data-ttu-id="50950-139">EntityFramework. dll – všechen Společný běhový kód používaný Entity Framework</span><span class="sxs-lookup"><span data-stu-id="50950-139">EntityFramework.dll – All the common runtime code used by Entity Framework</span></span>
- <span data-ttu-id="50950-140">EntityFramework. SqlServer. dll – poskytovatel Microsoft SQL Server pro Entity Framework</span><span class="sxs-lookup"><span data-stu-id="50950-140">EntityFramework.SqlServer.dll – The Microsoft SQL Server provider for Entity Framework</span></span>

### <a name="entity-classes"></a><span data-ttu-id="50950-141">Třídy entit</span><span class="sxs-lookup"><span data-stu-id="50950-141">Entity Classes</span></span>

<span data-ttu-id="50950-142">Třídy, které vytvoříte pro definování schématu dat, se nazývají třídy entit.</span><span class="sxs-lookup"><span data-stu-id="50950-142">The classes you create to define the schema of the data are called entity classes.</span></span> <span data-ttu-id="50950-143">Pokud s návrhem databází začínáte, můžete třídy entit představit jako definice tabulek v databázi.</span><span class="sxs-lookup"><span data-stu-id="50950-143">If you're new to database design, think of the entity classes as table definitions of a database.</span></span> <span data-ttu-id="50950-144">Každá vlastnost ve třídě Určuje sloupec v tabulce databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-144">Each property in the class specifies a column in the table of the database.</span></span> <span data-ttu-id="50950-145">Tyto třídy poskytují odlehčené objektově-relační rozhraní mezi objektově orientovaným kódem a strukturou relační tabulky databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-145">These classes provide a lightweight, object-relational interface between object-oriented code and the relational table structure of the database.</span></span>

<span data-ttu-id="50950-146">V tomto kurzu začnete přidáním jednoduchých tříd entit, které představují schémata pro produkty a kategorie.</span><span class="sxs-lookup"><span data-stu-id="50950-146">In this tutorial, you'll start out by adding simple entity classes representing the schemas for products and categories.</span></span> <span data-ttu-id="50950-147">Třída Products bude obsahovat definice pro každý produkt.</span><span class="sxs-lookup"><span data-stu-id="50950-147">The products class will contain definitions for each product.</span></span> <span data-ttu-id="50950-148">Název každého člena třídy produktu bude `ProductID`, `ProductName`, `Description`, `ImagePath`, `UnitPrice`, `CategoryID`a `Category`.</span><span class="sxs-lookup"><span data-stu-id="50950-148">The name of each of the members of the product class will be `ProductID`, `ProductName`, `Description`, `ImagePath`, `UnitPrice`, `CategoryID`, and `Category`.</span></span> <span data-ttu-id="50950-149">Třída Category bude obsahovat definice pro každou kategorii, do které může produkt patřit, jako je auto, člun nebo rovina.</span><span class="sxs-lookup"><span data-stu-id="50950-149">The category class will contain definitions for each category that a product can belong to, such as Car, Boat, or Plane.</span></span> <span data-ttu-id="50950-150">Název každého člena třídy Category bude `CategoryID`, `CategoryName`, `Description`a `Products`.</span><span class="sxs-lookup"><span data-stu-id="50950-150">The name of each of the members of the category class will be `CategoryID`, `CategoryName`, `Description`, and `Products`.</span></span> <span data-ttu-id="50950-151">Každý produkt bude patřit do jedné z kategorií.</span><span class="sxs-lookup"><span data-stu-id="50950-151">Each product will belong to one of the categories.</span></span> <span data-ttu-id="50950-152">Tyto třídy entit budou přidány do existující složky *modelů* projektu.</span><span class="sxs-lookup"><span data-stu-id="50950-152">These entity classes will be added to the project's existing *Models* folder.</span></span>

1. <span data-ttu-id="50950-153">V **Průzkumník řešení**klikněte pravým tlačítkem na složku *modely* a pak vyberte **Přidat** -&gt; **Nová položka**.</span><span class="sxs-lookup"><span data-stu-id="50950-153">In **Solution Explorer**, right-click the *Models* folder and then select **Add** -&gt; **New Item**.</span></span> 

    ![Vytvoření nabídky Data Access Layer-New Item](create_the_data_access_layer/_static/image1.png)

   <span data-ttu-id="50950-155">Zobrazí se dialogové okno **Přidat novou položku** .</span><span class="sxs-lookup"><span data-stu-id="50950-155">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="50950-156">V **části C# vizuál** z **nainstalovaného** podokna na levé straně vyberte **kód**.</span><span class="sxs-lookup"><span data-stu-id="50950-156">Under **Visual C#** from the **Installed** pane on the left, select **Code**.</span></span> 

    ![Vytvoření nabídky Data Access Layer-New Item](create_the_data_access_layer/_static/image2.png)
3. <span data-ttu-id="50950-158">V prostředním podokně vyberte **Třída** a pojmenujte tuto novou třídu *Product.cs*.</span><span class="sxs-lookup"><span data-stu-id="50950-158">Select **Class** from the middle pane and name this new class *Product.cs*.</span></span>
4. <span data-ttu-id="50950-159">Klikněte na **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="50950-159">Click **Add**.</span></span>  
   <span data-ttu-id="50950-160">V editoru se zobrazí nový soubor třídy.</span><span class="sxs-lookup"><span data-stu-id="50950-160">The new class file is displayed in the editor.</span></span>
5. <span data-ttu-id="50950-161">Nahraďte výchozí kód následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="50950-161">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample1.cs)]
6. <span data-ttu-id="50950-162">Vytvořte další třídu opakováním kroků 1 až 4, ale pojmenujte novou třídu *Category.cs* a nahraďte výchozí kód následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="50950-162">Create another class by repeating steps 1 through 4, however, name the new class *Category.cs* and replace the default code with the following code:</span></span>  

    [!code-csharp[Main](create_the_data_access_layer/samples/sample2.cs)]

<span data-ttu-id="50950-163">Jak už jsme uvedli, třída `Category` představuje typ produktu, který je navržený pro prodej (například <a id="a"></a>&quot;auta&quot;, &quot;čluny&quot;, &quot;Rockets&quot;atd.), a třída `Product` představuje jednotlivé produkty (hračky) v databázi.</span><span class="sxs-lookup"><span data-stu-id="50950-163">As previously mentioned, the `Category` class represents the type of product that the application is designed to sell (such as <a id="a"></a>&quot;Cars&quot;, &quot;Boats&quot;, &quot;Rockets&quot;, and so on), and the `Product` class represents the individual products (toys) in the database.</span></span> <span data-ttu-id="50950-164">Každá instance `Product` objektu bude odpovídat řádku v relační tabulce databáze a každá vlastnost třídy produkt bude namapována na sloupec v tabulce relační databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-164">Each instance of a `Product` object will correspond to a row within a relational database table, and each property of the Product class will map to a column in the relational database table.</span></span> <span data-ttu-id="50950-165">Později v tomto kurzu zkontrolujete data produktu obsažená v databázi.</span><span class="sxs-lookup"><span data-stu-id="50950-165">Later in this tutorial, you'll review the product data contained in the database.</span></span>

### <a name="data-annotations"></a><span data-ttu-id="50950-166">Datové poznámky</span><span class="sxs-lookup"><span data-stu-id="50950-166">Data Annotations</span></span>

<span data-ttu-id="50950-167">Možná jste si všimli, že někteří členové tříd mají atributy, které určují podrobnosti o členu, například `[ScaffoldColumn(false)]`.</span><span class="sxs-lookup"><span data-stu-id="50950-167">You may have noticed that certain members of the classes have attributes specifying details about the member, such as `[ScaffoldColumn(false)]`.</span></span> <span data-ttu-id="50950-168">Jedná se o *datové poznámky*.</span><span class="sxs-lookup"><span data-stu-id="50950-168">These are *data annotations*.</span></span> <span data-ttu-id="50950-169">Atributy poznámky k datům mohou popsány, jak ověřit vstup uživatele pro daného člena, zadat jeho formátování a určit, jak se má modelovat při vytvoření databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-169">The data annotation attributes can describe how to validate user input for that member, to specify formatting for it, and to specify how it is modeled when the database is created.</span></span>

### <a name="context-class"></a><span data-ttu-id="50950-170">Context – třída</span><span class="sxs-lookup"><span data-stu-id="50950-170">Context Class</span></span>

<span data-ttu-id="50950-171">Chcete-li začít používat třídy pro přístup k datům, je nutné definovat třídu kontextu.</span><span class="sxs-lookup"><span data-stu-id="50950-171">To start using the classes for data access, you must define a context class.</span></span> <span data-ttu-id="50950-172">Jak bylo zmíněno dříve, Třída Context spravuje třídy entit (například třídu `Product` a třídu `Category`) a poskytuje přístup k datům databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-172">As mentioned previously, the context class manages the entity classes (such as the `Product` class and the `Category` class) and provides data access to the database.</span></span>

<span data-ttu-id="50950-173">Tento postup přidá novou C# kontextovou třídu do složky *modely* .</span><span class="sxs-lookup"><span data-stu-id="50950-173">This procedure adds a new C# context class to the *Models* folder.</span></span>

1. <span data-ttu-id="50950-174">Klikněte pravým tlačítkem na složku *modely* a pak vyberte **Přidat** -&gt; **Nová položka**.</span><span class="sxs-lookup"><span data-stu-id="50950-174">Right-click the *Models* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="50950-175">Zobrazí se dialogové okno **Přidat novou položku** .</span><span class="sxs-lookup"><span data-stu-id="50950-175">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="50950-176">V prostředním podokně vyberte **Třída** , pojmenujte ji *ProductContext.cs* a klikněte na **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="50950-176">Select **Class** from the middle pane, name it *ProductContext.cs* and click **Add**.</span></span>
3. <span data-ttu-id="50950-177">Nahraďte výchozí kód obsažený ve třídě následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="50950-177">Replace the default code contained in the class with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample3.cs)]

<span data-ttu-id="50950-178">Tento kód přidá obor názvů `System.Data.Entity`, abyste měli přístup ke všem základním funkcím Entity Framework, které zahrnují možnost dotazování, vkládání, aktualizaci a odstraňování dat pomocí objektů se silnými typy.</span><span class="sxs-lookup"><span data-stu-id="50950-178">This code adds the `System.Data.Entity` namespace so that you have access to all the core functionality of Entity Framework, which includes the capability to query, insert, update, and delete data by working with strongly typed objects.</span></span>

<span data-ttu-id="50950-179">Třída `ProductContext` představuje kontext databáze Entity Framework produktu, který zpracovává načítání, ukládání a aktualizaci instancí tříd `Product` v databázi.</span><span class="sxs-lookup"><span data-stu-id="50950-179">The `ProductContext` class represents Entity Framework product database context, which handles fetching, storing, and updating `Product` class instances in the database.</span></span> <span data-ttu-id="50950-180">Třída `ProductContext` je odvozena od `DbContext` základní třídy poskytované Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="50950-180">The `ProductContext` class derives from the `DbContext` base class provided by Entity Framework.</span></span>

### <a name="initializer-class"></a><span data-ttu-id="50950-181">Inicializátor – třída</span><span class="sxs-lookup"><span data-stu-id="50950-181">Initializer Class</span></span>

<span data-ttu-id="50950-182">Při prvním použití kontextu bude nutné spustit určitou vlastní logiku pro inicializaci databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-182">You will need to run some custom logic to initialize the database the first time the context is used.</span></span> <span data-ttu-id="50950-183">Tím umožníte přidání počátečních dat do databáze, abyste mohli hned Zobrazit produkty a kategorie.</span><span class="sxs-lookup"><span data-stu-id="50950-183">This will allow seed data to be added to the database so that you can immediately display products and categories.</span></span>

<span data-ttu-id="50950-184">Tento postup přidá do složky C# *modely* novou třídu inicializátoru.</span><span class="sxs-lookup"><span data-stu-id="50950-184">This procedure adds a new C# initializer class to the *Models* folder.</span></span>

1. <span data-ttu-id="50950-185">Vytvořte další `Class` ve složce *modely* a pojmenujte ji *ProductDatabaseInitializer.cs*.</span><span class="sxs-lookup"><span data-stu-id="50950-185">Create another `Class` in the *Models* folder and name it *ProductDatabaseInitializer.cs*.</span></span>
2. <span data-ttu-id="50950-186">Nahraďte výchozí kód obsažený ve třídě následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="50950-186">Replace the default code contained in the class with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample4.cs)]

<span data-ttu-id="50950-187">Jak vidíte z výše uvedeného kódu, při vytvoření a inicializaci databáze je vlastnost `Seed` přepsána a nastavena.</span><span class="sxs-lookup"><span data-stu-id="50950-187">As you can see from the above code, when the database is created and initialized, the `Seed` property is overridden and set.</span></span> <span data-ttu-id="50950-188">Při nastavení vlastnosti `Seed` se k naplnění databáze použijí hodnoty z kategorií a produktů.</span><span class="sxs-lookup"><span data-stu-id="50950-188">When the `Seed` property is set, the values from the categories and products are used to populate the database.</span></span> <span data-ttu-id="50950-189">Pokud se pokusíte aktualizovat počáteční data úpravou výše uvedeného kódu po vytvoření databáze, při spuštění webové aplikace se nezobrazí žádné aktualizace.</span><span class="sxs-lookup"><span data-stu-id="50950-189">If you attempt to update the seed data by modifying the above code after the database has been created, you won't see any updates when you run the Web application.</span></span> <span data-ttu-id="50950-190">Důvodem je, že výše uvedený kód používá implementaci třídy `DropCreateDatabaseIfModelChanges` k rozpoznání, zda byl model (schéma) změněn před resetováním počátečních dat.</span><span class="sxs-lookup"><span data-stu-id="50950-190">The reason is the above code uses an implementation of the `DropCreateDatabaseIfModelChanges` class to recognize if the model (schema) has changed before resetting the seed data.</span></span> <span data-ttu-id="50950-191">Pokud nejsou provedeny žádné změny `Category` a `Product` třídy entit, databáze nebude znovu inicializována daty počáteční hodnoty.</span><span class="sxs-lookup"><span data-stu-id="50950-191">If no changes are made to the `Category` and `Product` entity classes, the database will not be reinitialized with the seed data.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="50950-192">Pokud jste chtěli, aby se databáze znovu nevytvořila při každém spuštění aplikace, můžete místo `DropCreateDatabaseIfModelChanges` třídy použít třídu `DropCreateDatabaseAlways`.</span><span class="sxs-lookup"><span data-stu-id="50950-192">If you wanted the database to be recreated every time you ran the application, you could use the `DropCreateDatabaseAlways` class instead of the `DropCreateDatabaseIfModelChanges` class.</span></span> <span data-ttu-id="50950-193">Pro tuto řadu kurzů ale použijte třídu `DropCreateDatabaseIfModelChanges`.</span><span class="sxs-lookup"><span data-stu-id="50950-193">However for this tutorial series, use the `DropCreateDatabaseIfModelChanges` class.</span></span>

<span data-ttu-id="50950-194">V tomto okamžiku v tomto kurzu budete mít složku *modelů* se čtyřmi novými třídami a jednu výchozí třídou:</span><span class="sxs-lookup"><span data-stu-id="50950-194">At this point in this tutorial, you will have a *Models* folder with four new classes and one default class:</span></span>

![Vytvoření složky modelů pro přístup k datům](create_the_data_access_layer/_static/image3.png)

### <a name="configuring-the-application-to-use-the-data-model"></a><span data-ttu-id="50950-196">Konfigurace aplikace pro použití datového modelu</span><span class="sxs-lookup"><span data-stu-id="50950-196">Configuring the Application to Use the Data Model</span></span>

<span data-ttu-id="50950-197">Nyní, když jste vytvořili třídy, které reprezentují data, je nutné nakonfigurovat aplikaci tak, aby používala třídy.</span><span class="sxs-lookup"><span data-stu-id="50950-197">Now that you've created the classes that represent the data, you must configure the application to use the classes.</span></span> <span data-ttu-id="50950-198">V souboru *Global. asax* přidáte kód, který inicializuje model.</span><span class="sxs-lookup"><span data-stu-id="50950-198">In the *Global.asax* file, you add code that initializes the model.</span></span> <span data-ttu-id="50950-199">V souboru *Web. config* přidáte informace, které aplikaci sdělují, jakou databázi budete používat k ukládání dat reprezentovaných novými datovými třídami.</span><span class="sxs-lookup"><span data-stu-id="50950-199">In the *Web.config* file you add information that tells the application what database you'll use to store the data that's represented by the new data classes.</span></span> <span data-ttu-id="50950-200">Soubor *Global. asax* lze použít ke zpracování událostí nebo metod aplikace.</span><span class="sxs-lookup"><span data-stu-id="50950-200">The *Global.asax* file can be used to handle application events or methods.</span></span> <span data-ttu-id="50950-201">Soubor *Web. config* umožňuje řídit konfiguraci webové aplikace v ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="50950-201">The *Web.config* file allows you to control the configuration of your ASP.NET web application.</span></span>

#### <a name="updating-the-globalasax-file"></a><span data-ttu-id="50950-202">Aktualizace souboru Global. asax</span><span class="sxs-lookup"><span data-stu-id="50950-202">Updating the Global.asax file</span></span>

<span data-ttu-id="50950-203">Chcete-li inicializovat datové modely při spuštění aplikace, aktualizujte obslužnou rutinu `Application_Start` v souboru *Global.asax.cs* .</span><span class="sxs-lookup"><span data-stu-id="50950-203">To initialize the data models when the application starts, you will update the `Application_Start` handler in the *Global.asax.cs* file.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="50950-204">V Průzkumník řešení můžete pro úpravu souboru *Global.asax.cs* vybrat soubor *Global. asax* nebo soubor *Global.asax.cs* .</span><span class="sxs-lookup"><span data-stu-id="50950-204">In Solution Explorer, you can select either the *Global.asax* file or the *Global.asax.cs* file to edit the *Global.asax.cs* file.</span></span>

1. <span data-ttu-id="50950-205">Přidejte následující kód zvýrazněný žlutě do metody `Application_Start` v souboru *Global.asax.cs* .</span><span class="sxs-lookup"><span data-stu-id="50950-205">Add the following code highlighted in yellow to the `Application_Start` method in the *Global.asax.cs* file.</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample5.cs?highlight=9-10,22-23)]

> [!NOTE] 
> 
> <span data-ttu-id="50950-206">Aby mohl váš prohlížeč zobrazit kód zvýrazněný žlutě při zobrazení této série kurzů v prohlížeči, musí podporovat HTML5.</span><span class="sxs-lookup"><span data-stu-id="50950-206">Your browser must support HTML5 to view the code highlighted in yellow when viewing this tutorial series in a browser.</span></span>

<span data-ttu-id="50950-207">Jak je znázorněno ve výše uvedeném kódu, aplikace při spuštění aplikace určuje inicializátor, který se spustí při prvním otevření dat.</span><span class="sxs-lookup"><span data-stu-id="50950-207">As shown in the above code, when the application starts, the application specifies the initializer that will run during the first time the data is accessed.</span></span> <span data-ttu-id="50950-208">Pro přístup k objektu `Database` a objektu `ProductDatabaseInitializer` jsou vyžadovány dva další obory názvů.</span><span class="sxs-lookup"><span data-stu-id="50950-208">The two additional namespaces are required to access the `Database` object and the `ProductDatabaseInitializer` object.</span></span>

 <span data-ttu-id="50950-209">Úprava souboru Web. config</span><span class="sxs-lookup"><span data-stu-id="50950-209">Modifying the Web.Config File</span></span> 

<span data-ttu-id="50950-210">I když Entity Framework Code First vygeneruje databázi pro vás ve výchozím umístění v případě, že je databáze naplněná daty o základech, přidání vlastních informací o připojení do vaší aplikace vám umožní řídit umístění databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-210">Although Entity Framework Code First will generate a database for you in a default location when the database is populated with seed data, adding your own connection information to your application gives you control of the database location.</span></span> <span data-ttu-id="50950-211">Toto připojení k databázi zadáte pomocí připojovacího řetězce v souboru *Web. config* aplikace v kořenovém adresáři projektu.</span><span class="sxs-lookup"><span data-stu-id="50950-211">You specify this database connection using a connection string in the application's *Web.config* file at the root of the project.</span></span> <span data-ttu-id="50950-212">Přidáním nového připojovacího řetězce můžete směrovat umístění databáze (*wingtiptoys. mdf*), aby byla sestavena v datovém adresáři aplikace (*data aplikace\_* ), nikoli ve výchozím umístění.</span><span class="sxs-lookup"><span data-stu-id="50950-212">By adding a new connection string, you can direct the location of the database (*wingtiptoys.mdf*) to be built in the application's data directory (*App\_Data*), rather than its default location.</span></span> <span data-ttu-id="50950-213">Tato změna vám umožní vyhledat a prozkoumat databázový soubor později v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="50950-213">Making this change will allow you to find and inspect the database file later in this tutorial.</span></span>

1. <span data-ttu-id="50950-214">V **Průzkumník řešení**vyhledejte a otevřete soubor *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="50950-214">In **Solution Explorer**, find and open the *Web.config* file.</span></span>
2. <span data-ttu-id="50950-215">Přidejte připojovací řetězec zvýrazněný žlutě do části `<connectionStrings>` souboru *Web. config* následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="50950-215">Add the connection string highlighted in yellow to the `<connectionStrings>` section of the *Web.config* file as follows:</span></span>  

    [!code-xml[Main](create_the_data_access_layer/samples/sample6.xml?highlight=4-7)]

<span data-ttu-id="50950-216">Při prvním spuštění aplikace bude databáze sestavena v umístění určeném připojovacím řetězcem.</span><span class="sxs-lookup"><span data-stu-id="50950-216">When the application is run for the first time, it will build the database at the location specified by the connection string.</span></span> <span data-ttu-id="50950-217">Ale před spuštěním aplikace si ji nejdřív sestavíme.</span><span class="sxs-lookup"><span data-stu-id="50950-217">But before running the application, let's build it first.</span></span>

## <a name="building-the-application"></a><span data-ttu-id="50950-218">Sestavení aplikace</span><span class="sxs-lookup"><span data-stu-id="50950-218">Building the Application</span></span>

<span data-ttu-id="50950-219">Chcete-li zajistit, aby všechny třídy a změny fungovaly v rámci vaší webové aplikace, měli byste sestavit aplikaci.</span><span class="sxs-lookup"><span data-stu-id="50950-219">To make sure that all the classes and changes to your Web application work, you should build the application.</span></span>

1. <span data-ttu-id="50950-220">V nabídce **ladění** vyberte **sestavení WingtipToys**.</span><span class="sxs-lookup"><span data-stu-id="50950-220">From the **Debug** menu, select **Build WingtipToys**.</span></span>  
 <span data-ttu-id="50950-221">Zobrazí se okno **výstup** a pokud se všechno objevilo správně, zobrazí se zpráva o *úspěšném* dokončení.</span><span class="sxs-lookup"><span data-stu-id="50950-221">The **Output** window is displayed, and if all went well, you see a *succeeded* message.</span></span>  

    ![Vytvoření výstupních oken vrstvy přístupu k datům](create_the_data_access_layer/_static/image4.png)

<span data-ttu-id="50950-223">Pokud narazíte na chybu, znovu proveďte kontrolu výše uvedených kroků.</span><span class="sxs-lookup"><span data-stu-id="50950-223">If you run into an error, re-check the above steps.</span></span> <span data-ttu-id="50950-224">Informace v okně **výstup** označují, který soubor má problém a kde je požadováno změny v souboru.</span><span class="sxs-lookup"><span data-stu-id="50950-224">The information in the **Output** window will indicate which file has a problem and where in the file a change is required.</span></span> <span data-ttu-id="50950-225">Tyto informace vám umožní určit, jakou část výše uvedených kroků je potřeba zkontrolovat a opravit v projektu.</span><span class="sxs-lookup"><span data-stu-id="50950-225">This information will enable you to determine what part of the above steps need to be reviewed and fixed in your project.</span></span>

## <a name="summary"></a><span data-ttu-id="50950-226">Souhrn</span><span class="sxs-lookup"><span data-stu-id="50950-226">Summary</span></span>

<span data-ttu-id="50950-227">V tomto kurzu řady, kterou jste vytvořili datový model, a také přidejte kód, který bude použit k inicializaci a osazení databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-227">In this tutorial of the series you have created the data model, as well as, added the code that will be used to initialize and seed the database.</span></span> <span data-ttu-id="50950-228">Aplikaci jste také nakonfigurovali tak, aby používala datové modely při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="50950-228">You have also configured the application to use the data models when the application is run.</span></span>

<span data-ttu-id="50950-229">V dalším kurzu aktualizujete uživatelské rozhraní, přidáte navigaci a načtete data z databáze.</span><span class="sxs-lookup"><span data-stu-id="50950-229">In the next tutorial, you'll update the UI, add navigation, and retrieve data from the database.</span></span> <span data-ttu-id="50950-230">Výsledkem bude, že se databáze automaticky vytvoří na základě tříd entit, které jste vytvořili v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="50950-230">This will result in the database being automatically created based on the entity classes that you created in this tutorial.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="50950-231">Další prostředky</span><span class="sxs-lookup"><span data-stu-id="50950-231">Additional Resources</span></span>

<span data-ttu-id="50950-232">[Přehled Entity Framework](https://msdn.microsoft.com/library/bb399567.aspx) </span><span class="sxs-lookup"><span data-stu-id="50950-232">[Entity Framework Overview](https://msdn.microsoft.com/library/bb399567.aspx) </span></span>  
<span data-ttu-id="50950-233">[Příručka pro začátečníky k ADO.NET Entity Framework](https://msdn.microsoft.com/data/ee712907) </span><span class="sxs-lookup"><span data-stu-id="50950-233">[Beginner's Guide to the ADO.NET Entity Framework](https://msdn.microsoft.com/data/ee712907) </span></span>  
<span data-ttu-id="50950-234">[Code First vývoj s](http://www.msteched.com/2010/Europe/DEV212) využitím Entity Framework (video)</span><span class="sxs-lookup"><span data-stu-id="50950-234">[Code First Development with Entity Framework](http://www.msteched.com/2010/Europe/DEV212) (video)</span></span>   
<span data-ttu-id="50950-235">[Code First vztahů – rozhraní API Fluent](https://msdn.microsoft.com/data/hh134698) </span><span class="sxs-lookup"><span data-stu-id="50950-235">[Code First Relationships Fluent API](https://msdn.microsoft.com/data/hh134698) </span></span>  
[<span data-ttu-id="50950-236">Code First datové poznámky</span><span class="sxs-lookup"><span data-stu-id="50950-236">Code First Data Annotations</span></span>](https://msdn.microsoft.com/data/gg193958)  
[<span data-ttu-id="50950-237">Vylepšení produktivity Entity Framework</span><span class="sxs-lookup"><span data-stu-id="50950-237">Productivity Improvements for the Entity Framework</span></span>](https://blogs.msdn.com/b/efdesign/archive/2010/06/21/productivity-improvements-for-the-entity-framework.aspx?wa=wsignin1.0)

> [!div class="step-by-step"]
> <span data-ttu-id="50950-238">[Předchozí](create-the-project.md)
> [Další](ui_and_navigation.md)</span><span class="sxs-lookup"><span data-stu-id="50950-238">[Previous](create-the-project.md)
[Next](ui_and_navigation.md)</span></span>
