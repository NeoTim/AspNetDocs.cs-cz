---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/create_the_data_access_layer
title: Vytvoření vrstvy přístupu k datům | Dokumentace Microsoftu
author: Erikre
description: V této sérii kurzů se seznámíte se základy vytváření aplikace webových formulářů ASP.NET pomocí technologie ASP.NET 4.5 a službu Microsoft Visual Studio Express 2013 pro jsme...
ms.author: riande
ms.date: 09/08/2014
ms.assetid: 0bbf7a6e-d7eb-4091-91e4-fff892777f32
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/create_the_data_access_layer
msc.type: authoredcontent
ms.openlocfilehash: 61a9dae22efed9cb7e8957a8c131396cbdeea3c9
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/06/2019
ms.locfileid: "65131355"
---
# <a name="create-the-data-access-layer"></a><span data-ttu-id="8c12e-103">Vytvoření vrstvy přístupu k datům</span><span class="sxs-lookup"><span data-stu-id="8c12e-103">Create the Data Access Layer</span></span>

<span data-ttu-id="8c12e-104">by [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="8c12e-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="8c12e-105">[Stáhněte si ukázkový projekt Wingtip Toys (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) nebo [stáhnout elektronickou knihu (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="8c12e-105">[Download Wingtip Toys Sample Project (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="8c12e-106">V této sérii kurzů se seznámíte se základy vytváření aplikace webových formulářů ASP.NET pomocí technologie ASP.NET 4.5 a službu Microsoft Visual Studio Express 2013 for Web.</span><span class="sxs-lookup"><span data-stu-id="8c12e-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="8c12e-107">Visual Studio 2013 [projektu se zdrojovým kódem jazyka C#](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) je k dispozici v této sérii kurzů.</span><span class="sxs-lookup"><span data-stu-id="8c12e-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>

<span data-ttu-id="8c12e-108">Tento kurz popisuje, jak vytvořit, přístup a zkontrolujte data v databázi pomocí webových formulářů ASP.NET a Entity Framework Code First.</span><span class="sxs-lookup"><span data-stu-id="8c12e-108">This tutorial describes how to create, access, and review data from a database using ASP.NET Web Forms and Entity Framework Code First.</span></span> <span data-ttu-id="8c12e-109">V tomto kurzu vychází z předchozí kurz o službě "Vytvořit projekt" a je součástí série kurzů Wingtip Slonovi Store.</span><span class="sxs-lookup"><span data-stu-id="8c12e-109">This tutorial builds on the previous tutorial "Create the Project" and is part of the Wingtip Toy Store tutorial series.</span></span> <span data-ttu-id="8c12e-110">Po dokončení tohoto kurzu, který bude jste vytvořili skupinu tříd přístup k datům, které jsou v *modely* složky projektu.</span><span class="sxs-lookup"><span data-stu-id="8c12e-110">When you've completed this tutorial, you will have built a group of data-access classes that are in the *Models* folder of the project.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="8c12e-111">Co se dozvíte:</span><span class="sxs-lookup"><span data-stu-id="8c12e-111">What you'll learn:</span></span>

- <span data-ttu-id="8c12e-112">Postup vytvoření datové modely.</span><span class="sxs-lookup"><span data-stu-id="8c12e-112">How to create the data models.</span></span>
- <span data-ttu-id="8c12e-113">Jak k inicializaci a přidání dat do databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-113">How to initialize and seed the database.</span></span>
- <span data-ttu-id="8c12e-114">Jak aktualizovat a nakonfigurovat aplikaci, aby podporovala databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-114">How to update and configure the application to support the database.</span></span>

### <a name="these-are-the-features-introduced-in-the-tutorial"></a><span data-ttu-id="8c12e-115">Toto jsou vlastnosti představené v tomto kurzu:</span><span class="sxs-lookup"><span data-stu-id="8c12e-115">These are the features introduced in the tutorial:</span></span>

- <span data-ttu-id="8c12e-116">Entity Framework Code First</span><span class="sxs-lookup"><span data-stu-id="8c12e-116">Entity Framework Code First</span></span>
- <span data-ttu-id="8c12e-117">LocalDB</span><span class="sxs-lookup"><span data-stu-id="8c12e-117">LocalDB</span></span>
- <span data-ttu-id="8c12e-118">Datové poznámky</span><span class="sxs-lookup"><span data-stu-id="8c12e-118">Data Annotations</span></span>

## <a name="creating-the-data-models"></a><span data-ttu-id="8c12e-119">Vytváření datových modelů</span><span class="sxs-lookup"><span data-stu-id="8c12e-119">Creating the Data Models</span></span>

<span data-ttu-id="8c12e-120">[Entity Framework](https://msdn.microsoft.com/data/aa937723) je objektově relační mapování (ORM) rozhraní.</span><span class="sxs-lookup"><span data-stu-id="8c12e-120">[Entity Framework](https://msdn.microsoft.com/data/aa937723) is an object-relational mapping (ORM) framework.</span></span> <span data-ttu-id="8c12e-121">To vám umožní pracovat s relačními daty, jako objekty, což eliminuje většinu kódu přístup k datům, která obvykle byste museli napsat.</span><span class="sxs-lookup"><span data-stu-id="8c12e-121">It lets you work with relational data as objects, eliminating most of the data-access code that you'd usually need to write.</span></span> <span data-ttu-id="8c12e-122">Používá nástroj Entity Framework, můžete zadávat dotazy pomocí [LINQ](https://msdn.microsoft.com/library/bb397926.aspx), načítání a manipulaci s daty jako objektů se silným typem.</span><span class="sxs-lookup"><span data-stu-id="8c12e-122">Using Entity Framework, you can issue queries using [LINQ](https://msdn.microsoft.com/library/bb397926.aspx), then retrieve and manipulate data as strongly typed objects.</span></span> <span data-ttu-id="8c12e-123">LINQ poskytuje vzory pro dotazování a aktualizace dat.</span><span class="sxs-lookup"><span data-stu-id="8c12e-123">LINQ provides patterns for querying and updating data.</span></span> <span data-ttu-id="8c12e-124">Používá nástroj Entity Framework umožňuje zaměřit se na vytváření zbývající části aplikace, místo zaměření na data základy přístup.</span><span class="sxs-lookup"><span data-stu-id="8c12e-124">Using Entity Framework allows you to focus on creating the rest of your application, rather than focusing on the data access fundamentals.</span></span> <span data-ttu-id="8c12e-125">Dále v této sérii vám ukážeme, jak používat data k naplnění dotazy navigace a produktu.</span><span class="sxs-lookup"><span data-stu-id="8c12e-125">Later in this tutorial series, we'll show you how to use the data to populate navigation and product queries.</span></span>

<span data-ttu-id="8c12e-126">Entity Framework podporuje vývoj paradigma volá *Code First*.</span><span class="sxs-lookup"><span data-stu-id="8c12e-126">Entity Framework supports a development paradigm called *Code First*.</span></span> <span data-ttu-id="8c12e-127">Kód nejprve umožňuje definovat pomocí třídy.</span><span class="sxs-lookup"><span data-stu-id="8c12e-127">Code First lets you define your data models using classes.</span></span> <span data-ttu-id="8c12e-128">Třída je konstrukce, která umožňuje vytvořit vlastní typy prostřednictvím seskupování proměnné jiné typy, metody a události.</span><span class="sxs-lookup"><span data-stu-id="8c12e-128">A class is a construct that enables you to create your own custom types by grouping together variables of other types, methods and events.</span></span> <span data-ttu-id="8c12e-129">Můžete mapování tříd k existující databázi nebo použít ke generování databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-129">You can map classes to an existing database or use them to generate a database.</span></span> <span data-ttu-id="8c12e-130">V tomto kurzu vytvoříte datových modelů napsáním tříd datových modelů.</span><span class="sxs-lookup"><span data-stu-id="8c12e-130">In this tutorial, you'll create the data models by writing data model classes.</span></span> <span data-ttu-id="8c12e-131">Potom dáme vám Entity Framework vytvořit databázi v reálném čase z těchto nových tříd.</span><span class="sxs-lookup"><span data-stu-id="8c12e-131">Then, you'll let Entity Framework create the database on the fly from these new classes.</span></span>

<span data-ttu-id="8c12e-132">Začnete vytvořením tříd entit, které definují datových modelů pro aplikaci webových formulářů.</span><span class="sxs-lookup"><span data-stu-id="8c12e-132">You will begin by creating the entity classes that define the data models for the Web Forms application.</span></span> <span data-ttu-id="8c12e-133">Pak vytvoříte kontextu třídu, která spravuje tříd entit a poskytuje přístup k datům v databázi.</span><span class="sxs-lookup"><span data-stu-id="8c12e-133">Then you will create a context class that manages the entity classes and provides data access to the database.</span></span> <span data-ttu-id="8c12e-134">Vytvoříte také inicializátor třídy, který budete používat k naplnění databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-134">You will also create an initializer class that you will use to populate the database.</span></span>

### <a name="entity-framework-and-references"></a><span data-ttu-id="8c12e-135">Entity Framework a odkazy</span><span class="sxs-lookup"><span data-stu-id="8c12e-135">Entity Framework and References</span></span>

<span data-ttu-id="8c12e-136">Ve výchozím nastavení, Entity Framework je součástí vytvoříte nový **webová aplikace ASP.NET** pomocí **webových formulářů** šablony.</span><span class="sxs-lookup"><span data-stu-id="8c12e-136">By default, Entity Framework is included when you create a new **ASP.NET Web Application** using the **Web Forms** template.</span></span> <span data-ttu-id="8c12e-137">Entity Framework můžete nainstalovaná, odinstaluje a aktualizovat jako balíček NuGet.</span><span class="sxs-lookup"><span data-stu-id="8c12e-137">Entity Framework can be installed, uninstalled, and updated as a NuGet package.</span></span>

<span data-ttu-id="8c12e-138">Tento balíček NuGet. obsahuje následující **runtime** sestavení v rámci svého projektu:</span><span class="sxs-lookup"><span data-stu-id="8c12e-138">This NuGet package includes the following **runtime** assemblies within your project:</span></span>

- <span data-ttu-id="8c12e-139">EntityFramework.dll – všechny běžné runtime kód používá Entity Framework</span><span class="sxs-lookup"><span data-stu-id="8c12e-139">EntityFramework.dll – All the common runtime code used by Entity Framework</span></span>
- <span data-ttu-id="8c12e-140">EntityFramework.SqlServer.dll – Microsoft SQL Server zprostředkovatele pro Entity Framework</span><span class="sxs-lookup"><span data-stu-id="8c12e-140">EntityFramework.SqlServer.dll – The Microsoft SQL Server provider for Entity Framework</span></span>

### <a name="entity-classes"></a><span data-ttu-id="8c12e-141">Tříd entit</span><span class="sxs-lookup"><span data-stu-id="8c12e-141">Entity Classes</span></span>

<span data-ttu-id="8c12e-142">Třídy vytvoříte pro definování schématu dat se nazývají tříd entit.</span><span class="sxs-lookup"><span data-stu-id="8c12e-142">The classes you create to define the schema of the data are called entity classes.</span></span> <span data-ttu-id="8c12e-143">Pokud jste nový návrh databáze, představit jako definice tabulky databáze tříd entit.</span><span class="sxs-lookup"><span data-stu-id="8c12e-143">If you're new to database design, think of the entity classes as table definitions of a database.</span></span> <span data-ttu-id="8c12e-144">Každou vlastnost v třídě určuje sloupec v tabulce databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-144">Each property in the class specifies a column in the table of the database.</span></span> <span data-ttu-id="8c12e-145">Tyto třídy poskytují jednoduchý, objektově relační rozhraní mezi kódem objektově orientované a struktura tabulky relační databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-145">These classes provide a lightweight, object-relational interface between object-oriented code and the relational table structure of the database.</span></span>

<span data-ttu-id="8c12e-146">V tomto kurzu budete Začněte přidáním jednoduché entity třídy představující schémata pro produkty a kategorie.</span><span class="sxs-lookup"><span data-stu-id="8c12e-146">In this tutorial, you'll start out by adding simple entity classes representing the schemas for products and categories.</span></span> <span data-ttu-id="8c12e-147">Třída produkty budou obsahovat definice pro každý produkt.</span><span class="sxs-lookup"><span data-stu-id="8c12e-147">The products class will contain definitions for each product.</span></span> <span data-ttu-id="8c12e-148">Název každého člena třídy produkt bude `ProductID`, `ProductName`, `Description`, `ImagePath`, `UnitPrice`, `CategoryID`, a `Category`.</span><span class="sxs-lookup"><span data-stu-id="8c12e-148">The name of each of the members of the product class will be `ProductID`, `ProductName`, `Description`, `ImagePath`, `UnitPrice`, `CategoryID`, and `Category`.</span></span> <span data-ttu-id="8c12e-149">Kategorie třídy bude obsahovat definice pro každou kategorii, který produkt může patřit do, jako jsou auta, loď nebo roviny.</span><span class="sxs-lookup"><span data-stu-id="8c12e-149">The category class will contain definitions for each category that a product can belong to, such as Car, Boat, or Plane.</span></span> <span data-ttu-id="8c12e-150">Název každého člena třídy kategorie bude `CategoryID`, `CategoryName`, `Description`, a `Products`.</span><span class="sxs-lookup"><span data-stu-id="8c12e-150">The name of each of the members of the category class will be `CategoryID`, `CategoryName`, `Description`, and `Products`.</span></span> <span data-ttu-id="8c12e-151">Každý produkt bude patřit do jedné kategorie.</span><span class="sxs-lookup"><span data-stu-id="8c12e-151">Each product will belong to one of the categories.</span></span> <span data-ttu-id="8c12e-152">Tyto entity třídy se přidá k existujícím projektu *modely* složky.</span><span class="sxs-lookup"><span data-stu-id="8c12e-152">These entity classes will be added to the project's existing *Models* folder.</span></span>

1. <span data-ttu-id="8c12e-153">V **Průzkumníku řešení**, klikněte pravým tlačítkem myši *modely* složku a pak vyberte **přidat**  - &gt; **nová položka**.</span><span class="sxs-lookup"><span data-stu-id="8c12e-153">In **Solution Explorer**, right-click the *Models* folder and then select **Add** -&gt; **New Item**.</span></span> 

    ![Vytvoření vrstvy přístupu k datům – nové položky nabídky](create_the_data_access_layer/_static/image1.png)

   <span data-ttu-id="8c12e-155">**Přidat novou položku** se zobrazí dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="8c12e-155">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="8c12e-156">V části **Visual C#** z **nainstalováno** podokna na levé straně vyberte **kód**.</span><span class="sxs-lookup"><span data-stu-id="8c12e-156">Under **Visual C#** from the **Installed** pane on the left, select **Code**.</span></span> 

    ![Vytvoření vrstvy přístupu k datům – nové položky nabídky](create_the_data_access_layer/_static/image2.png)
3. <span data-ttu-id="8c12e-158">Vyberte **třídy** z podokna uprostřed a názvem Tato nová třída *Product.cs*.</span><span class="sxs-lookup"><span data-stu-id="8c12e-158">Select **Class** from the middle pane and name this new class *Product.cs*.</span></span>
4. <span data-ttu-id="8c12e-159">Klikněte na **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="8c12e-159">Click **Add**.</span></span>  
   <span data-ttu-id="8c12e-160">Nový soubor třídy se zobrazí v editoru.</span><span class="sxs-lookup"><span data-stu-id="8c12e-160">The new class file is displayed in the editor.</span></span>
5. <span data-ttu-id="8c12e-161">Nahraďte kód následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="8c12e-161">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample1.cs)]
6. <span data-ttu-id="8c12e-162">Vytvořit jiné třídy opakováním kroků 1 až 4, ale pojmenujte novou třídu *Category.cs* a nahraďte kód následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="8c12e-162">Create another class by repeating steps 1 through 4, however, name the new class *Category.cs* and replace the default code with the following code:</span></span>  

    [!code-csharp[Main](create_the_data_access_layer/samples/sample2.cs)]

<span data-ttu-id="8c12e-163">Jak už jsme zmínili, `Category` třídy představuje typ produktu, které aplikace je navržen tak, aby je prodal (například <a id="a"> </a> &quot;auta&quot;, &quot;lodě&quot;, &quot;Rockets&quot;, a tak dále) a `Product` třída představuje jednotlivé produkty (toys) v databázi.</span><span class="sxs-lookup"><span data-stu-id="8c12e-163">As previously mentioned, the `Category` class represents the type of product that the application is designed to sell (such as <a id="a"></a>&quot;Cars&quot;, &quot;Boats&quot;, &quot;Rockets&quot;, and so on), and the `Product` class represents the individual products (toys) in the database.</span></span> <span data-ttu-id="8c12e-164">Každá instance `Product` objektu, budou odpovídat na řádek v tabulce relačních databází a každá vlastnost třídy produkt bude mapovat na sloupec v tabulce relační databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-164">Each instance of a `Product` object will correspond to a row within a relational database table, and each property of the Product class will map to a column in the relational database table.</span></span> <span data-ttu-id="8c12e-165">Později v tomto kurzu zkontrolujete produktu data obsažená v databázi.</span><span class="sxs-lookup"><span data-stu-id="8c12e-165">Later in this tutorial, you'll review the product data contained in the database.</span></span>

### <a name="data-annotations"></a><span data-ttu-id="8c12e-166">Datové poznámky</span><span class="sxs-lookup"><span data-stu-id="8c12e-166">Data Annotations</span></span>

<span data-ttu-id="8c12e-167">Mohli jste si všimnout, že některé členy třídy mají atributy zadání podrobností o členu, například `[ScaffoldColumn(false)]`.</span><span class="sxs-lookup"><span data-stu-id="8c12e-167">You may have noticed that certain members of the classes have attributes specifying details about the member, such as `[ScaffoldColumn(false)]`.</span></span> <span data-ttu-id="8c12e-168">Jedná se o *anotacemi dat*.</span><span class="sxs-lookup"><span data-stu-id="8c12e-168">These are *data annotations*.</span></span> <span data-ttu-id="8c12e-169">Atributy datového poznámky můžete popisují, jak ověření vstupu uživatele pro tento člen, můžete určit formátování a určete, jak je modelovaná při vytvoření databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-169">The data annotation attributes can describe how to validate user input for that member, to specify formatting for it, and to specify how it is modeled when the database is created.</span></span>

### <a name="context-class"></a><span data-ttu-id="8c12e-170">Context – třída</span><span class="sxs-lookup"><span data-stu-id="8c12e-170">Context Class</span></span>

<span data-ttu-id="8c12e-171">Pokud chcete začít používat tříd pro přístup k datům, musí definovat třídu kontextu.</span><span class="sxs-lookup"><span data-stu-id="8c12e-171">To start using the classes for data access, you must define a context class.</span></span> <span data-ttu-id="8c12e-172">Jak už bylo zmíněno dříve, třídy kontextu spravuje tříd entit (například `Product` třídy a `Category` třídy) a poskytuje přístup k datům v databázi.</span><span class="sxs-lookup"><span data-stu-id="8c12e-172">As mentioned previously, the context class manages the entity classes (such as the `Product` class and the `Category` class) and provides data access to the database.</span></span>

<span data-ttu-id="8c12e-173">Tento postup přidá nové třídy C# kontext k *modely* složky.</span><span class="sxs-lookup"><span data-stu-id="8c12e-173">This procedure adds a new C# context class to the *Models* folder.</span></span>

1. <span data-ttu-id="8c12e-174">Klikněte pravým tlačítkem myši *modely* složku a pak vyberte **přidat**  - &gt; **nová položka**.</span><span class="sxs-lookup"><span data-stu-id="8c12e-174">Right-click the *Models* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="8c12e-175">**Přidat novou položku** se zobrazí dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="8c12e-175">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="8c12e-176">Vyberte **třídy** v prostředním podokně, pojmenujte ho *ProductContext.cs* a klikněte na tlačítko **přidat**.</span><span class="sxs-lookup"><span data-stu-id="8c12e-176">Select **Class** from the middle pane, name it *ProductContext.cs* and click **Add**.</span></span>
3. <span data-ttu-id="8c12e-177">Nahraďte výchozí kód obsažený ve třídě s následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="8c12e-177">Replace the default code contained in the class with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample3.cs)]

<span data-ttu-id="8c12e-178">Tento kód přidá `System.Data.Entity` obor názvů, abyste měli přístup ke všem funkcím základní Entity Framework, která zahrnuje možnost dotazu, vložit, aktualizovat a odstraňovat data ve spolupráci s objektů se silným typem.</span><span class="sxs-lookup"><span data-stu-id="8c12e-178">This code adds the `System.Data.Entity` namespace so that you have access to all the core functionality of Entity Framework, which includes the capability to query, insert, update, and delete data by working with strongly typed objects.</span></span>

<span data-ttu-id="8c12e-179">`ProductContext` Třída reprezentuje kontext databáze produktu Entity Framework, která zpracovává načítání, ukládání a aktualizaci `Product` třídy instancí v databázi.</span><span class="sxs-lookup"><span data-stu-id="8c12e-179">The `ProductContext` class represents Entity Framework product database context, which handles fetching, storing, and updating `Product` class instances in the database.</span></span> <span data-ttu-id="8c12e-180">`ProductContext` Třída odvozena z `DbContext` základní třída poskytované rozhraním Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8c12e-180">The `ProductContext` class derives from the `DbContext` base class provided by Entity Framework.</span></span>

### <a name="initializer-class"></a><span data-ttu-id="8c12e-181">Inicializátor třídy</span><span class="sxs-lookup"><span data-stu-id="8c12e-181">Initializer Class</span></span>

<span data-ttu-id="8c12e-182">Je potřeba spustit některé vlastní logiku inicializace databáze první čas, který se používá kontextu.</span><span class="sxs-lookup"><span data-stu-id="8c12e-182">You will need to run some custom logic to initialize the database the first time the context is used.</span></span> <span data-ttu-id="8c12e-183">To vám umožní počáteční data mají být přidány do databáze, tak, aby si můžete okamžitě prohlédnout produktů a kategorie.</span><span class="sxs-lookup"><span data-stu-id="8c12e-183">This will allow seed data to be added to the database so that you can immediately display products and categories.</span></span>

<span data-ttu-id="8c12e-184">Tento postup přidá nové třídy C# inicializátor pro *modely* složky.</span><span class="sxs-lookup"><span data-stu-id="8c12e-184">This procedure adds a new C# initializer class to the *Models* folder.</span></span>

1. <span data-ttu-id="8c12e-185">Vytvořte další `Class` v *modely* složku a pojmenujte ho *ProductDatabaseInitializer.cs*.</span><span class="sxs-lookup"><span data-stu-id="8c12e-185">Create another `Class` in the *Models* folder and name it *ProductDatabaseInitializer.cs*.</span></span>
2. <span data-ttu-id="8c12e-186">Nahraďte výchozí kód obsažený ve třídě s následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="8c12e-186">Replace the default code contained in the class with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample4.cs)]

<span data-ttu-id="8c12e-187">Jak je vidět ve výše uvedeném kódu, když je vytvořen a inicializován, databáze `Seed` vlastnost je přepsat a nastavit.</span><span class="sxs-lookup"><span data-stu-id="8c12e-187">As you can see from the above code, when the database is created and initialized, the `Seed` property is overridden and set.</span></span> <span data-ttu-id="8c12e-188">Když `Seed` je hodnota nastavena, hodnoty z kategorie a produkty, které se používají k naplnění databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-188">When the `Seed` property is set, the values from the categories and products are used to populate the database.</span></span> <span data-ttu-id="8c12e-189">Pokud se pokusíte k aktualizaci dat počáteční hodnoty tak, že upravíte výše uvedený kód po vytvoření databáze, neuvidíte žádné aktualizace při spuštění webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="8c12e-189">If you attempt to update the seed data by modifying the above code after the database has been created, you won't see any updates when you run the Web application.</span></span> <span data-ttu-id="8c12e-190">Důvodem je to výše uvedený kód používá provádění `DropCreateDatabaseIfModelChanges` třídy rozpoznat, pokud model (schéma) byl změněn před obnovením dat počáteční hodnoty.</span><span class="sxs-lookup"><span data-stu-id="8c12e-190">The reason is the above code uses an implementation of the `DropCreateDatabaseIfModelChanges` class to recognize if the model (schema) has changed before resetting the seed data.</span></span> <span data-ttu-id="8c12e-191">Pokud jsou provedeny žádné změny `Category` a `Product` tříd entit, databáze nebude opakování inicializace odběrů pomocí dat počáteční hodnoty.</span><span class="sxs-lookup"><span data-stu-id="8c12e-191">If no changes are made to the `Category` and `Product` entity classes, the database will not be reinitialized with the seed data.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="8c12e-192">Pokud byste chtěli databáze, kterou chcete znovu vytvořit pokaždé, když byla aplikace spuštěná, můžete použít `DropCreateDatabaseAlways` místo na třídě `DropCreateDatabaseIfModelChanges` třídy.</span><span class="sxs-lookup"><span data-stu-id="8c12e-192">If you wanted the database to be recreated every time you ran the application, you could use the `DropCreateDatabaseAlways` class instead of the `DropCreateDatabaseIfModelChanges` class.</span></span> <span data-ttu-id="8c12e-193">Ale pro tuto řadu kurzů použít `DropCreateDatabaseIfModelChanges` třídy.</span><span class="sxs-lookup"><span data-stu-id="8c12e-193">However for this tutorial series, use the `DropCreateDatabaseIfModelChanges` class.</span></span>

<span data-ttu-id="8c12e-194">V tuto chvíli v tomto kurzu budete mít *modely* složky čtyři nové třídy a jednu výchozí třídu:</span><span class="sxs-lookup"><span data-stu-id="8c12e-194">At this point in this tutorial, you will have a *Models* folder with four new classes and one default class:</span></span>

![Vytvoření vrstvy přístupu k datům – složku modely](create_the_data_access_layer/_static/image3.png)

### <a name="configuring-the-application-to-use-the-data-model"></a><span data-ttu-id="8c12e-196">Konfigurace aplikace pro použití datového modelu</span><span class="sxs-lookup"><span data-stu-id="8c12e-196">Configuring the Application to Use the Data Model</span></span>

<span data-ttu-id="8c12e-197">Teď, když jste vytvořili třídy, které představují data, musíte nakonfigurovat aplikaci pro použití třídy.</span><span class="sxs-lookup"><span data-stu-id="8c12e-197">Now that you've created the classes that represent the data, you must configure the application to use the classes.</span></span> <span data-ttu-id="8c12e-198">V *Global.asax* souboru, přidejte kód, který inicializuje model.</span><span class="sxs-lookup"><span data-stu-id="8c12e-198">In the *Global.asax* file, you add code that initializes the model.</span></span> <span data-ttu-id="8c12e-199">V *Web.config* přidat informace, které se říká aplikace co databázi, kterou budete používat k ukládání dat, která je reprezentována nové třídy datového souboru.</span><span class="sxs-lookup"><span data-stu-id="8c12e-199">In the *Web.config* file you add information that tells the application what database you'll use to store the data that's represented by the new data classes.</span></span> <span data-ttu-id="8c12e-200">*Global.asax* soubor lze použít ke zpracování událostí aplikace nebo metody.</span><span class="sxs-lookup"><span data-stu-id="8c12e-200">The *Global.asax* file can be used to handle application events or methods.</span></span> <span data-ttu-id="8c12e-201">*Web.config* souboru umožňuje řídit konfiguraci webové aplikace ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8c12e-201">The *Web.config* file allows you to control the configuration of your ASP.NET web application.</span></span>

#### <a name="updating-the-globalasax-file"></a><span data-ttu-id="8c12e-202">Aktualizuje se soubor Global.asax</span><span class="sxs-lookup"><span data-stu-id="8c12e-202">Updating the Global.asax file</span></span>

<span data-ttu-id="8c12e-203">Inicializovat datové modely při spuštění aplikace, budete aktualizovat `Application_Start` obslužné rutiny v *Global.asax.cs* souboru.</span><span class="sxs-lookup"><span data-stu-id="8c12e-203">To initialize the data models when the application starts, you will update the `Application_Start` handler in the *Global.asax.cs* file.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="8c12e-204">V Průzkumníku řešení, můžete vybrat, zda *Global.asax* souboru nebo *Global.asax.cs* soubor pro úpravu *Global.asax.cs* souboru.</span><span class="sxs-lookup"><span data-stu-id="8c12e-204">In Solution Explorer, you can select either the *Global.asax* file or the *Global.asax.cs* file to edit the *Global.asax.cs* file.</span></span>

1. <span data-ttu-id="8c12e-205">Přidejte následující kód zvýrazněné žlutou barvou na `Application_Start` metodu *Global.asax.cs* souboru.</span><span class="sxs-lookup"><span data-stu-id="8c12e-205">Add the following code highlighted in yellow to the `Application_Start` method in the *Global.asax.cs* file.</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample5.cs?highlight=9-10,22-23)]

> [!NOTE] 
> 
> <span data-ttu-id="8c12e-206">Váš prohlížeč musí podporovat HTML5, chcete-li zobrazit kód zvýrazněn žlutě při prohlížení v této sérii kurzů v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="8c12e-206">Your browser must support HTML5 to view the code highlighted in yellow when viewing this tutorial series in a browser.</span></span>

<span data-ttu-id="8c12e-207">Jak je znázorněno výše uvedený kód při spuštění aplikace, aplikace určuje, že je přístupná inicializátoru, který se spustí při prvním spuštění data.</span><span class="sxs-lookup"><span data-stu-id="8c12e-207">As shown in the above code, when the application starts, the application specifies the initializer that will run during the first time the data is accessed.</span></span> <span data-ttu-id="8c12e-208">Dva další obory názvů jsou nutné pro přístup k `Database` objektu a `ProductDatabaseInitializer` objektu.</span><span class="sxs-lookup"><span data-stu-id="8c12e-208">The two additional namespaces are required to access the `Database` object and the `ProductDatabaseInitializer` object.</span></span>

 <span data-ttu-id="8c12e-209">Úprava souboru Web.Config.</span><span class="sxs-lookup"><span data-stu-id="8c12e-209">Modifying the Web.Config File</span></span> 

<span data-ttu-id="8c12e-210">Ačkoli Entity Framework Code First databáze za vás ve výchozím umístění při vygeneruje počáteční data se načtou databáze, přidání své vlastní informace o připojení k vaší aplikaci nabízí kontrolu nad umístění databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-210">Although Entity Framework Code First will generate a database for you in a default location when the database is populated with seed data, adding your own connection information to your application gives you control of the database location.</span></span> <span data-ttu-id="8c12e-211">Zadejte toto připojení k databázi pomocí připojovacího řetězce v aplikačním *Web.config* souboru v kořenovém adresáři projektu.</span><span class="sxs-lookup"><span data-stu-id="8c12e-211">You specify this database connection using a connection string in the application's *Web.config* file at the root of the project.</span></span> <span data-ttu-id="8c12e-212">Když přidáte nový připojovací řetězec, můžete nastavit umístění databáze (*wingtiptoys.mdf*) má být sestaven v adresáři aplikace data (*aplikace\_Data*), místo jeho výchozí umístění.</span><span class="sxs-lookup"><span data-stu-id="8c12e-212">By adding a new connection string, you can direct the location of the database (*wingtiptoys.mdf*) to be built in the application's data directory (*App\_Data*), rather than its default location.</span></span> <span data-ttu-id="8c12e-213">Tato změna vám umožní vyhledat a zkontrolujte soubor databáze dále v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="8c12e-213">Making this change will allow you to find and inspect the database file later in this tutorial.</span></span>

1. <span data-ttu-id="8c12e-214">V **Průzkumníka řešení**, najít a otevřít *Web.config* souboru.</span><span class="sxs-lookup"><span data-stu-id="8c12e-214">In **Solution Explorer**, find and open the *Web.config* file.</span></span>
2. <span data-ttu-id="8c12e-215">Přidat připojovací řetězec, který je zvýrazněn žlutě, aby `<connectionStrings>` část *Web.config* to následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="8c12e-215">Add the connection string highlighted in yellow to the `<connectionStrings>` section of the *Web.config* file as follows:</span></span>  

    [!code-xml[Main](create_the_data_access_layer/samples/sample6.xml?highlight=4-7)]

<span data-ttu-id="8c12e-216">Při prvním spuštění aplikace, sestaví databáze v umístění zadaném připojovacím řetězcem.</span><span class="sxs-lookup"><span data-stu-id="8c12e-216">When the application is run for the first time, it will build the database at the location specified by the connection string.</span></span> <span data-ttu-id="8c12e-217">Ale před spuštěním aplikace, můžeme ji nejdřív sestavit.</span><span class="sxs-lookup"><span data-stu-id="8c12e-217">But before running the application, let's build it first.</span></span>

## <a name="building-the-application"></a><span data-ttu-id="8c12e-218">Sestavení aplikace</span><span class="sxs-lookup"><span data-stu-id="8c12e-218">Building the Application</span></span>

<span data-ttu-id="8c12e-219">Pokud chcete mít jistotu, že všechny třídy a změny do vaší webové aplikace fungovat, měli byste vytvořit aplikaci.</span><span class="sxs-lookup"><span data-stu-id="8c12e-219">To make sure that all the classes and changes to your Web application work, you should build the application.</span></span>

1. <span data-ttu-id="8c12e-220">Z **ladění** nabídce vyberte možnost **sestavení Northwind**.</span><span class="sxs-lookup"><span data-stu-id="8c12e-220">From the **Debug** menu, select **Build WingtipToys**.</span></span>  
 <span data-ttu-id="8c12e-221">**Výstup** se zobrazí okno, a pokud všechny se podařilo, zobrazí se *úspěšné* zprávy.</span><span class="sxs-lookup"><span data-stu-id="8c12e-221">The **Output** window is displayed, and if all went well, you see a *succeeded* message.</span></span>  

    ![Vytvoření vrstvy přístupu k datům – výstupní Windows](create_the_data_access_layer/_static/image4.png)

<span data-ttu-id="8c12e-223">Pokud narazíte na chybu, zkontrolujte znovu proveďte následující kroky.</span><span class="sxs-lookup"><span data-stu-id="8c12e-223">If you run into an error, re-check the above steps.</span></span> <span data-ttu-id="8c12e-224">Informace v **výstup** okno označí soubor, který problém, kde v souboru je požadována změna.</span><span class="sxs-lookup"><span data-stu-id="8c12e-224">The information in the **Output** window will indicate which file has a problem and where in the file a change is required.</span></span> <span data-ttu-id="8c12e-225">Tyto informace vám umožní určit, jaká část výše uvedené kroky potřeba zkontrolovali a opravili ve vašem projektu.</span><span class="sxs-lookup"><span data-stu-id="8c12e-225">This information will enable you to determine what part of the above steps need to be reviewed and fixed in your project.</span></span>

## <a name="summary"></a><span data-ttu-id="8c12e-226">Souhrn</span><span class="sxs-lookup"><span data-stu-id="8c12e-226">Summary</span></span>

<span data-ttu-id="8c12e-227">V tomto kurzu této série budete mít vytvoření datového modelu, jakož i, přidat kód, který se použije k inicializaci a přidání dat do databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-227">In this tutorial of the series you have created the data model, as well as, added the code that will be used to initialize and seed the database.</span></span> <span data-ttu-id="8c12e-228">Také jste nakonfigurovali aplikaci, aby používala datové modely při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="8c12e-228">You have also configured the application to use the data models when the application is run.</span></span>

<span data-ttu-id="8c12e-229">V dalším kurzu budete aktualizaci uživatelského rozhraní, přidání navigace a načtení dat z databáze.</span><span class="sxs-lookup"><span data-stu-id="8c12e-229">In the next tutorial, you'll update the UI, add navigation, and retrieve data from the database.</span></span> <span data-ttu-id="8c12e-230">Výsledkem bude databáze se automaticky vytvoří podle tříd entit, které jste vytvořili v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="8c12e-230">This will result in the database being automatically created based on the entity classes that you created in this tutorial.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="8c12e-231">Další prostředky</span><span class="sxs-lookup"><span data-stu-id="8c12e-231">Additional Resources</span></span>

<span data-ttu-id="8c12e-232">[Přehled Entity Framework](https://msdn.microsoft.com/library/bb399567.aspx) </span><span class="sxs-lookup"><span data-stu-id="8c12e-232">[Entity Framework Overview](https://msdn.microsoft.com/library/bb399567.aspx) </span></span>  
<span data-ttu-id="8c12e-233">[Průvodce pro začátečníky ADO.NET Entity Framework](https://msdn.microsoft.com/data/ee712907) </span><span class="sxs-lookup"><span data-stu-id="8c12e-233">[Beginner's Guide to the ADO.NET Entity Framework](https://msdn.microsoft.com/data/ee712907) </span></span>  
<span data-ttu-id="8c12e-234">[První vývoj pomocí rozhraní Entity Framework Code](http://www.msteched.com/2010/Europe/DEV212) (video)</span><span class="sxs-lookup"><span data-stu-id="8c12e-234">[Code First Development with Entity Framework](http://www.msteched.com/2010/Europe/DEV212) (video)</span></span>   
<span data-ttu-id="8c12e-235">[Kód první vztahy Fluent API](https://msdn.microsoft.com/data/hh134698) </span><span class="sxs-lookup"><span data-stu-id="8c12e-235">[Code First Relationships Fluent API](https://msdn.microsoft.com/data/hh134698) </span></span>  
[<span data-ttu-id="8c12e-236">Kód první datové poznámky</span><span class="sxs-lookup"><span data-stu-id="8c12e-236">Code First Data Annotations</span></span>](https://msdn.microsoft.com/data/gg193958)  
[<span data-ttu-id="8c12e-237">Vylepšení produktivity pro Entity Framework</span><span class="sxs-lookup"><span data-stu-id="8c12e-237">Productivity Improvements for the Entity Framework</span></span>](https://blogs.msdn.com/b/efdesign/archive/2010/06/21/productivity-improvements-for-the-entity-framework.aspx?wa=wsignin1.0)

> [!div class="step-by-step"]
> <span data-ttu-id="8c12e-238">[Předchozí](create-the-project.md)
> [další](ui_and_navigation.md)</span><span class="sxs-lookup"><span data-stu-id="8c12e-238">[Previous](create-the-project.md)
[Next](ui_and_navigation.md)</span></span>
