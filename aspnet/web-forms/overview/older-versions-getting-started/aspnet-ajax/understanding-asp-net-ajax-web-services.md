---
uid: web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-web-services
title: Porozumění webovým službám ASP.NET AJAX | Microsoft Docs
author: scottcate
description: Webové služby jsou nedílnou součástí rozhraní .NET Framework, které poskytuje řešení pro různé platformy pro výměnu dat mezi distribuovanými systémy. Přestože Web...
ms.author: riande
ms.date: 03/28/2008
ms.assetid: 3332d6e7-e2e1-4144-b805-e71d51e7e415
msc.legacyurl: /web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-web-services
msc.type: authoredcontent
ms.openlocfilehash: eac3d53fd871d0cb5a2870488ce752c057cc5b1a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "86162777"
---
# <a name="understanding-aspnet-ajax-web-services"></a><span data-ttu-id="deb01-104">Principy webových služeb technologie ASP.NET AJAX</span><span class="sxs-lookup"><span data-stu-id="deb01-104">Understanding ASP.NET AJAX Web Services</span></span>

<span data-ttu-id="deb01-105">[Scott Cate](https://github.com/scottcate)</span><span class="sxs-lookup"><span data-stu-id="deb01-105">by [Scott Cate](https://github.com/scottcate)</span></span>

[<span data-ttu-id="deb01-106">Stáhnout PDF</span><span class="sxs-lookup"><span data-stu-id="deb01-106">Download PDF</span></span>](https://download.microsoft.com/download/C/1/9/C19A3451-1D14-477C-B703-54EF22E197EE/AJAX_tutorial05_Web_Services_with_MS_Ajax_cs.pdf)

> <span data-ttu-id="deb01-107">Webové služby jsou nedílnou součástí rozhraní .NET Framework, které poskytuje řešení pro různé platformy pro výměnu dat mezi distribuovanými systémy.</span><span class="sxs-lookup"><span data-stu-id="deb01-107">Web Services are an integral part of the .NET framework that provide a cross-platform solution for exchanging data between distributed systems.</span></span> <span data-ttu-id="deb01-108">I když se webové služby používají obvykle k tomu, aby pro posílání a přijímání dat používaly různé operační systémy, objektové modely a programovací jazyky, můžou se také použít k dynamickému vkládání dat na stránku ASP.NET AJAX nebo posílání dat ze stránky do back-endového systému.</span><span class="sxs-lookup"><span data-stu-id="deb01-108">Although Web Services are normally used to allow different operating systems, object models and programming languages to send and receive data, they can also be used to dynamically inject data into an ASP.NET AJAX page or send data from a page to a back-end system.</span></span> <span data-ttu-id="deb01-109">Vše lze provést bez nutnosti provádět operace zpětného odeslání.</span><span class="sxs-lookup"><span data-stu-id="deb01-109">All of this can be done without resorting to postback operations.</span></span>

## <a name="calling-web-services-with-aspnet-ajax"></a><span data-ttu-id="deb01-110">Volání webových služeb pomocí ASP.NET AJAX</span><span class="sxs-lookup"><span data-stu-id="deb01-110">Calling Web Services with ASP.NET AJAX</span></span>

<span data-ttu-id="deb01-111">Dan Wahlin</span><span class="sxs-lookup"><span data-stu-id="deb01-111">Dan Wahlin</span></span>

<span data-ttu-id="deb01-112">Webové služby jsou nedílnou součástí rozhraní .NET Framework, které poskytuje řešení pro různé platformy pro výměnu dat mezi distribuovanými systémy.</span><span class="sxs-lookup"><span data-stu-id="deb01-112">Web Services are an integral part of the .NET framework that provide a cross-platform solution for exchanging data between distributed systems.</span></span> <span data-ttu-id="deb01-113">I když se webové služby používají obvykle k tomu, aby pro posílání a přijímání dat používaly různé operační systémy, objektové modely a programovací jazyky, můžou se také použít k dynamickému vkládání dat na stránku ASP.NET AJAX nebo posílání dat ze stránky do back-endového systému.</span><span class="sxs-lookup"><span data-stu-id="deb01-113">Although Web Services are normally used to allow different operating systems, object models and programming languages to send and receive data, they can also be used to dynamically inject data into an ASP.NET AJAX page or send data from a page to a back-end system.</span></span> <span data-ttu-id="deb01-114">Vše lze provést bez nutnosti provádět operace zpětného odeslání.</span><span class="sxs-lookup"><span data-stu-id="deb01-114">All of this can be done without resorting to postback operations.</span></span>

<span data-ttu-id="deb01-115">I když ovládací prvek UpdatePanel ASP.NET AJAX poskytuje jednoduchý způsob, jak AJAX povolit jakoukoli stránku ASP.NET, mohou nastat situace, kdy potřebujete dynamicky přistupovat k datům na serveru bez použití prvku UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="deb01-115">While the ASP.NET AJAX UpdatePanel control provides a simple way to AJAX enable any ASP.NET page, there may be times when you need to dynamically access data on the server without using an UpdatePanel.</span></span> <span data-ttu-id="deb01-116">V tomto článku se dozvíte, jak toho dosáhnout vytvořením a použitím webových služeb v rámci stránek ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="deb01-116">In this article you'll see how to accomplish this by creating and consuming Web Services within ASP.NET AJAX pages.</span></span>

<span data-ttu-id="deb01-117">Tento článek se zaměřuje na funkce, které jsou dostupné v základních rozšířeních ASP.NET AJAX, a také na ovládacím prvku s povolenými webovými službami v sadě ASP.NET AJAX Toolkit s názvem AutoCompleteExtender.</span><span class="sxs-lookup"><span data-stu-id="deb01-117">This article will focus on functionality available in the core ASP.NET AJAX Extensions as well as a Web Service enabled control in the ASP.NET AJAX Toolkit called the AutoCompleteExtender.</span></span> <span data-ttu-id="deb01-118">Mezi zahrnutá témata patří definování webových služeb s podporou jazyka AJAX, vytváření proxy serverů klientů a volání webových služeb pomocí JavaScriptu.</span><span class="sxs-lookup"><span data-stu-id="deb01-118">Topics covered include defining AJAX-enabled Web Services, creating client proxies and calling Web Services with JavaScript.</span></span> <span data-ttu-id="deb01-119">Také se dozvíte, jak lze volání webové služby provést přímo na ASP.NET metody stránky.</span><span class="sxs-lookup"><span data-stu-id="deb01-119">You'll also see how Web Service calls can be made directly to ASP.NET page methods.</span></span>

## <a name="web-services-configuration"></a><span data-ttu-id="deb01-120">Konfigurace webových služeb</span><span class="sxs-lookup"><span data-stu-id="deb01-120">Web Services Configuration</span></span>

<span data-ttu-id="deb01-121">Když je v aplikaci Visual Studio 2008 vytvořen nový projekt webu, web.config soubor obsahuje řadu nových dodatků, které mohou být pro uživatele předchozích verzí sady Visual Studio neobeznámeny.</span><span class="sxs-lookup"><span data-stu-id="deb01-121">When a new Web Site project is created with Visual Studio 2008, the web.config file has a number of new additions that may be unfamiliar to users of previous versions of Visual Studio.</span></span> <span data-ttu-id="deb01-122">Některé z těchto změn mapují prefix "ASP" na ASP.NET AJAX Controls, aby bylo možné je použít na stránkách, zatímco jiné definují požadované HttpHandlers a httpModules.</span><span class="sxs-lookup"><span data-stu-id="deb01-122">Some of these modifications map the "asp" prefix to ASP.NET AJAX controls so they can be used in pages while others define required HttpHandlers and HttpModules.</span></span> <span data-ttu-id="deb01-123">Výpis 1 zobrazuje změny `<httpHandlers>` elementu v web.config, které ovlivňují volání webové služby.</span><span class="sxs-lookup"><span data-stu-id="deb01-123">Listing 1 shows modifications made to the `<httpHandlers>` element in web.config that affects Web Service calls.</span></span> <span data-ttu-id="deb01-124">Výchozí hodnota HttpHandlers použitá pro zpracování volání. asmx je odebrána a nahrazena třídou ScriptHandlerFactory umístěnou v sestavení System.Web.Extensions.dll.</span><span class="sxs-lookup"><span data-stu-id="deb01-124">The default HttpHandler used to process .asmx calls is removed and replaced with a ScriptHandlerFactory class located in the System.Web.Extensions.dll assembly.</span></span> <span data-ttu-id="deb01-125">System.Web.Extensions.dll obsahuje všechny základní funkce, které používá ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="deb01-125">System.Web.Extensions.dll contains all of the core functionality used by ASP.NET AJAX.</span></span>

<span data-ttu-id="deb01-126">**Výpis 1. Konfigurace obslužných rutin webové služby ASP.NET AJAX**</span><span class="sxs-lookup"><span data-stu-id="deb01-126">**Listing 1. ASP.NET AJAX Web Service Handler Configuration**</span></span>

[!code-xml[Main](understanding-asp-net-ajax-web-services/samples/sample1.xml)]

<span data-ttu-id="deb01-127">Tato náhrada HttpHandlers je provedena, aby bylo možné provést volání JavaScript Object Notation (JSON) ze stránek AJAX ASP.NET do webových služeb .NET pomocí proxy webové služby jazyka JavaScript.</span><span class="sxs-lookup"><span data-stu-id="deb01-127">This HttpHandler replacement is made in order to allow JavaScript Object Notation (JSON) calls to be made from ASP.NET AJAX pages to .NET Web Services using a JavaScript Web Service proxy.</span></span> <span data-ttu-id="deb01-128">ASP.NET AJAX odesílá zprávy JSON webovým službám na rozdíl od standardních volání protokolu SOAP (Simple Object Access Protocol), která jsou obvykle přidružena k webovým službám.</span><span class="sxs-lookup"><span data-stu-id="deb01-128">ASP.NET AJAX sends JSON messages to Web Services as opposed to the standard Simple Object Access Protocol (SOAP) calls typically associated with Web Services.</span></span> <span data-ttu-id="deb01-129">Výsledkem je menší zpráva žádosti a odpovědi.</span><span class="sxs-lookup"><span data-stu-id="deb01-129">This results in smaller request and response messages overall.</span></span> <span data-ttu-id="deb01-130">Umožňuje taky efektivnější zpracování dat na straně klienta, protože knihovna JavaScript ASP.NET AJAX je optimalizovaná pro práci s objekty JSON.</span><span class="sxs-lookup"><span data-stu-id="deb01-130">It also allows for more efficient client-side processing of data since the ASP.NET AJAX JavaScript library is optimized to work with JSON objects.</span></span> <span data-ttu-id="deb01-131">Výpis 2 a výpis 3 zobrazí příklady požadavků webové služby a zpráv odpovědí serializovaných do formátu JSON.</span><span class="sxs-lookup"><span data-stu-id="deb01-131">Listing 2 and Listing 3 show examples of Web Service request and response messages serialized to JSON format.</span></span> <span data-ttu-id="deb01-132">Zpráva požadavku uvedená v seznamu 2 předá parametr země s hodnotou "Belgie", zatímco zpráva s odpovědí v seznamu 3 předá pole zákaznických objektů a jejich přidružených vlastností.</span><span class="sxs-lookup"><span data-stu-id="deb01-132">The request message shown in Listing 2 passes a country parameter with a value of "Belgium" while the response message in Listing 3 passes an array of Customer objects and their associated properties.</span></span>

<span data-ttu-id="deb01-133">**Výpis 2. Zpráva žádosti webové služby serializovaná do formátu JSON**</span><span class="sxs-lookup"><span data-stu-id="deb01-133">**Listing 2. Web Service Request Message Serialized to JSON**</span></span>

[!code-json[Main](understanding-asp-net-ajax-web-services/samples/sample2.json)]

> <span data-ttu-id="deb01-134">*>[!NOTE]název operace je definován jako součást adresy URL webové služby. Kromě toho se zprávy požadavku neodesílají vždy prostřednictvím formátu JSON. Webové služby mohou využívat atribut ScriptMethod s parametrem UseHttpGet nastaveným na hodnotu true, což způsobí, že parametry budou předány prostřednictvím parametrů řetězce dotazu.*</span><span class="sxs-lookup"><span data-stu-id="deb01-134">*> [!NOTE] the operation name is defined as part of the URL to the web service; additionally, request messages are not always submitted via JSON. Web Services can utilize the ScriptMethod attribute with the UseHttpGet parameter set to true, which causes parameters to be passed via a the query string parameters.*</span></span>

<span data-ttu-id="deb01-135">**Výpis 3. Zpráva odpovědi webové služby serializovaná na JSON**</span><span class="sxs-lookup"><span data-stu-id="deb01-135">**Listing 3. Web Service Response Message Serialized to JSON**</span></span>

[!code-json[Main](understanding-asp-net-ajax-web-services/samples/sample3.json)]

<span data-ttu-id="deb01-136">V další části se dozvíte, jak vytvořit webové služby, které umožňují zpracovávat zprávy s požadavky JSON a reagovat jak na jednoduché, tak i komplexní typy.</span><span class="sxs-lookup"><span data-stu-id="deb01-136">In the next section you'll see how to create Web Services capable of handling JSON request messages and responding with both simple and complex types.</span></span>

## <a name="creating-ajax-enabled-web-services"></a><span data-ttu-id="deb01-137">Vytváření webových služeb s podporou jazyka AJAX</span><span class="sxs-lookup"><span data-stu-id="deb01-137">Creating AJAX-Enabled Web Services</span></span>

<span data-ttu-id="deb01-138">Rozhraní ASP.NET AJAX poskytuje několik různých způsobů, jak volat webové služby.</span><span class="sxs-lookup"><span data-stu-id="deb01-138">The ASP.NET AJAX framework provides several different ways to call Web Services.</span></span> <span data-ttu-id="deb01-139">Můžete použít ovládací prvek AutoCompleteExtender (dostupný v ASP.NET toolkitu AJAX) nebo v JavaScriptu.</span><span class="sxs-lookup"><span data-stu-id="deb01-139">You can use the AutoCompleteExtender control (available in the ASP.NET AJAX Toolkit) or JavaScript.</span></span> <span data-ttu-id="deb01-140">Nicméně před voláním služby, kterou máte v AJAX, povolte ji tak, aby ji mohl volat kód klientského skriptu.</span><span class="sxs-lookup"><span data-stu-id="deb01-140">However, before calling a service you have to AJAX-enable it so that it can be called by client-script code.</span></span>

<span data-ttu-id="deb01-141">Bez ohledu na to, jestli nejste u webových služeb ASP.NET, můžete jednoduše vytvořit služby a povolit služby AJAX.</span><span class="sxs-lookup"><span data-stu-id="deb01-141">Whether or not you're new to ASP.NET Web Services, you'll find it straightforward to create and AJAX-enable services.</span></span> <span data-ttu-id="deb01-142">Rozhraní .NET Framework podporuje vytváření webových služeb ASP.NET od počáteční verze v 2002 a rozšíření ASP.NET AJAX poskytují další funkce AJAX, které jsou založeny na výchozí sadě funkcí rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="deb01-142">The .NET framework has supported the creation of ASP.NET Web Services since its initial release in 2002 and the ASP.NET AJAX Extensions provide additional AJAX functionality that builds upon the .NET framework's default set of features.</span></span> <span data-ttu-id="deb01-143">Visual Studio .NET 2008 Beta 2 obsahuje integrovanou podporu pro vytváření souborů webové služby. asmx a automaticky odvozuje přidružený kód vedle tříd z třídy System. Web. Services. WebService.</span><span class="sxs-lookup"><span data-stu-id="deb01-143">Visual Studio .NET 2008 Beta 2 has built-in support for creating .asmx Web Service files and automatically derives associated code beside classes from the System.Web.Services.WebService class.</span></span> <span data-ttu-id="deb01-144">Při přidávání metod do třídy je nutné použít atribut WebMethod, aby bylo možné je volat příjemci webové služby.</span><span class="sxs-lookup"><span data-stu-id="deb01-144">As you add methods into the class you must apply the WebMethod attribute in order for them to be called by Web Service consumers.</span></span>

<span data-ttu-id="deb01-145">Výpis 4 ukazuje příklad použití atributu WebMethod na metodu s názvem GetCustomersByCountry ().</span><span class="sxs-lookup"><span data-stu-id="deb01-145">Listing 4 shows an example of applying the WebMethod attribute to a method named GetCustomersByCountry().</span></span>

<span data-ttu-id="deb01-146">**Výpis 4. Použití atributu WebMethod ve webové službě**</span><span class="sxs-lookup"><span data-stu-id="deb01-146">**Listing 4. Using the WebMethod Attribute in a Web Service**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample4.cs)]

<span data-ttu-id="deb01-147">Metoda GetCustomersByCountry () přijímá parametr země a vrací pole zákaznického objektu.</span><span class="sxs-lookup"><span data-stu-id="deb01-147">The GetCustomersByCountry() method accepts a country parameter and returns a Customer object array.</span></span> <span data-ttu-id="deb01-148">Hodnota země předaná metodě je předána třídě obchodní vrstvy, která zase volá třídu datové vrstvy, aby načetla data z databáze, vyplní vlastnosti objektu zákazníka daty a vrátí pole.</span><span class="sxs-lookup"><span data-stu-id="deb01-148">The country value passed into the method is forwarded to a business layer class which in turn calls a data layer class to retrieve the data from the database, fill the Customer object properties with data and return the array.</span></span>

## <a name="using-the-scriptservice-attribute"></a><span data-ttu-id="deb01-149">Použití atributu ScriptService</span><span class="sxs-lookup"><span data-stu-id="deb01-149">Using the ScriptService Attribute</span></span>

<span data-ttu-id="deb01-150">Při přidání atributu WebMethod umožníte volání metody GetCustomersByCountry () klientům, kteří odesílají standardní zprávy protokolu SOAP do webové služby, nedovolují volání JSON z aplikací ASP.NET AJAX z okna.</span><span class="sxs-lookup"><span data-stu-id="deb01-150">While adding the WebMethod attribute allows the GetCustomersByCountry() method to be called by clients that send standard SOAP messages to the Web Service, it doesn't allow JSON calls to be made from ASP.NET AJAX applications out of the box.</span></span> <span data-ttu-id="deb01-151">Aby bylo možné provést volání JSON, je nutné použít atribut rozšíření ASP.NET AJAX `ScriptService` pro třídu webové služby.</span><span class="sxs-lookup"><span data-stu-id="deb01-151">To allow JSON calls to be made you have to apply the ASP.NET AJAX Extension's `ScriptService` attribute to the Web Service class.</span></span> <span data-ttu-id="deb01-152">Díky tomu může webová služba odesílat zprávy odpovědi formátované pomocí JSON a umožňuje skriptu na straně klienta volat službu posíláním zpráv JSON.</span><span class="sxs-lookup"><span data-stu-id="deb01-152">This enables a Web Service to send response messages formatted using JSON and allows client-side script to call a service by sending JSON messages.</span></span>

<span data-ttu-id="deb01-153">Výpis 5 ukazuje příklad použití atributu ScriptService na třídu webové služby s názvem CustomersService.</span><span class="sxs-lookup"><span data-stu-id="deb01-153">Listing 5 shows an example of applying the ScriptService attribute to a Web Service class named CustomersService.</span></span>

<span data-ttu-id="deb01-154">**Výpis 5. Použití atributu ScriptService pro AJAX – povolení webové služby**</span><span class="sxs-lookup"><span data-stu-id="deb01-154">**Listing 5. Using the ScriptService Attribute to AJAX-enable a Web Service**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample5.cs)]

<span data-ttu-id="deb01-155">Atribut ScriptService funguje jako značka, která označuje, že je možné ji volat z kódu skriptu AJAX.</span><span class="sxs-lookup"><span data-stu-id="deb01-155">The ScriptService attribute acts as a marker that indicates it can be called from AJAX script code.</span></span> <span data-ttu-id="deb01-156">Ve skutečnosti nezpracovává žádné úlohy serializace JSON nebo deserializace, ke kterým dochází na pozadí.</span><span class="sxs-lookup"><span data-stu-id="deb01-156">It doesn't actually handle any of the JSON serialization or deserialization tasks that occur behind the scenes.</span></span> <span data-ttu-id="deb01-157">ScriptHandlerFactory (nakonfigurovaný v web.config) a další související třídy jsou hromadné zpracování JSON.</span><span class="sxs-lookup"><span data-stu-id="deb01-157">The ScriptHandlerFactory (configured in web.config) and other related classes do the bulk of JSON processing.</span></span>

## <a name="using-the-scriptmethod-attribute"></a><span data-ttu-id="deb01-158">Použití atributu ScriptMethod</span><span class="sxs-lookup"><span data-stu-id="deb01-158">Using the ScriptMethod Attribute</span></span>

<span data-ttu-id="deb01-159">Atribut ScriptService je jediný atribut ASP.NET AJAX, který musí být definován ve webové službě .NET, aby jej bylo možné používat na stránkách ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="deb01-159">The ScriptService attribute is the only ASP.NET AJAX attribute that has to be defined in a .NET Web Service in order for it to be used by ASP.NET AJAX pages.</span></span> <span data-ttu-id="deb01-160">Nicméně jiný atribut s názvem ScriptMethod lze také použít přímo na webové metody v rámci služby.</span><span class="sxs-lookup"><span data-stu-id="deb01-160">However, another attribute named ScriptMethod can also be applied directly to Web Methods in a service.</span></span> <span data-ttu-id="deb01-161">ScriptMethod definuje tři vlastnosti `UseHttpGet` , včetně, `ResponseFormat` a `XmlSerializeString` .</span><span class="sxs-lookup"><span data-stu-id="deb01-161">ScriptMethod defines three properties including `UseHttpGet`, `ResponseFormat` and `XmlSerializeString`.</span></span> <span data-ttu-id="deb01-162">Změna hodnot těchto vlastností může být užitečná v případech, kdy je třeba změnit typ požadavku akceptovaného webovou metodou, pokud webová metoda potřebuje vracet nezpracovaná data XML ve formě `XmlDocument` `XmlElement` objektu nebo nebo když data vrácená ze služby by měla být vždy serializována jako XML namísto JSON.</span><span class="sxs-lookup"><span data-stu-id="deb01-162">Changing the values of these properties can be useful in cases where the type of request accepted by a Web Method needs to be changed to GET, when a Web Method needs to return raw XML data in the form of an `XmlDocument` or `XmlElement` object or when data returned from a service should always be serialized as XML instead of JSON.</span></span>

<span data-ttu-id="deb01-163">Vlastnost UseHttpGet lze použít, pokud webová metoda by měla přijímat požadavky GET na rozdíl od požadavků POST.</span><span class="sxs-lookup"><span data-stu-id="deb01-163">The UseHttpGet property can be used when a Web Method should accept GET requests as opposed to POST requests.</span></span> <span data-ttu-id="deb01-164">Žádosti se odesílají pomocí adresy URL se vstupními parametry webové metody, které jsou převedené na parametry QueryString.</span><span class="sxs-lookup"><span data-stu-id="deb01-164">Requests are sent using a URL with Web Method input parameters converted to QueryString parameters.</span></span> <span data-ttu-id="deb01-165">Vlastnost UseHttpGet je nastavena na hodnotu false a měla by být nastavena pouze na to, `true` kdy jsou operace známé jako bezpečné a když nejsou citlivá data předávána webové službě.</span><span class="sxs-lookup"><span data-stu-id="deb01-165">The UseHttpGet property defaults to false and should only be set to `true` when operations are known to be safe and when sensitive data is not passed to a Web Service.</span></span> <span data-ttu-id="deb01-166">Výpis 6 ukazuje příklad použití atributu ScriptMethod s vlastností UseHttpGet.</span><span class="sxs-lookup"><span data-stu-id="deb01-166">Listing 6 shows an example of using the ScriptMethod attribute with the UseHttpGet property.</span></span>

<span data-ttu-id="deb01-167">**Výpis 6. Pomocí atributu ScriptMethod s vlastností UseHttpGet.**</span><span class="sxs-lookup"><span data-stu-id="deb01-167">**Listing 6. Using the ScriptMethod attribute with the UseHttpGet property.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample6.cs)]

<span data-ttu-id="deb01-168">Příklad záhlaví odeslaných při volání webové metody HttpGetEcho, která je uvedena v seznamu 6, se zobrazí jako další:</span><span class="sxs-lookup"><span data-stu-id="deb01-168">An example of the headers sent when the HttpGetEcho Web Method shown in Listing 6 is called are shown next:</span></span>

`GET /CustomerViewer/DemoService.asmx/HttpGetEcho?input=%22Input Value%22 HTTP/1.1`

<span data-ttu-id="deb01-169">Kromě povolení, aby webové metody přijímaly požadavky HTTP GET, lze atribut ScriptMethod použít také v případě, že je nutné vrátit odpovědi XML ze služby spíše než pomocí formátu JSON.</span><span class="sxs-lookup"><span data-stu-id="deb01-169">In addition to allowing Web Methods to accept HTTP GET requests, the ScriptMethod attribute can also be used when XML responses need to be returned from a service rather than JSON.</span></span> <span data-ttu-id="deb01-170">Webová služba může například načíst informační kanál RSS ze vzdáleného webu a vrátit jej jako objekt XmlDocument nebo XmlElement.</span><span class="sxs-lookup"><span data-stu-id="deb01-170">For example, a Web Service may retrieve an RSS feed from a remote site and return it as an XmlDocument or XmlElement object.</span></span> <span data-ttu-id="deb01-171">Zpracování dat XML může následně probíhat na klientovi.</span><span class="sxs-lookup"><span data-stu-id="deb01-171">Processing of the XML data can then occur on the client.</span></span>

<span data-ttu-id="deb01-172">Výpis 7 ukazuje příklad použití vlastnosti ResponseFormat k určení, že by měla být vrácena data XML z webové metody.</span><span class="sxs-lookup"><span data-stu-id="deb01-172">Listing 7 shows an example of using the ResponseFormat property to specify that XML data should be returned from a Web Method.</span></span>

<span data-ttu-id="deb01-173">**Výpis 7. Pomocí atributu ScriptMethod s vlastností ResponseFormat.**</span><span class="sxs-lookup"><span data-stu-id="deb01-173">**Listing 7. Using the ScriptMethod attribute with the ResponseFormat property.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample7.cs)]

<span data-ttu-id="deb01-174">Vlastnost ResponseFormat lze také použít společně s vlastností XmlSerializeString.</span><span class="sxs-lookup"><span data-stu-id="deb01-174">The ResponseFormat property can also be used along with the XmlSerializeString property.</span></span> <span data-ttu-id="deb01-175">Vlastnost XmlSerializeString má výchozí hodnotu false, což znamená, že všechny návratové typy s výjimkou řetězců vrácených z webové metody jsou serializovány jako XML, pokud `ResponseFormat` je vlastnost nastavena na `ResponseFormat.Xml` .</span><span class="sxs-lookup"><span data-stu-id="deb01-175">The XmlSerializeString property has a default value of false which means that all return types except strings returned from a Web Method are serialized as XML when the `ResponseFormat` property is set to `ResponseFormat.Xml`.</span></span> <span data-ttu-id="deb01-176">`XmlSerializeString`Je-li nastavena na hodnotu `true` , všechny typy vrácené z webové metody jsou serializovány jako XML včetně typů řetězců.</span><span class="sxs-lookup"><span data-stu-id="deb01-176">When `XmlSerializeString` is set to `true`, all types returned from a Web Method are serialized as XML including string types.</span></span> <span data-ttu-id="deb01-177">Pokud má vlastnost ResponseFormat hodnotu `ResponseFormat.Json` vlastnosti XmlSerializeString, bude ignorována.</span><span class="sxs-lookup"><span data-stu-id="deb01-177">If the ResponseFormat property has a value of `ResponseFormat.Json` the XmlSerializeString property is ignored.</span></span>

<span data-ttu-id="deb01-178">Výpis 8 ukazuje příklad použití vlastnosti XmlSerializeString k vynucení řetězců, které mají být serializovány jako XML.</span><span class="sxs-lookup"><span data-stu-id="deb01-178">Listing 8 shows an example of using the XmlSerializeString property to force strings to be serialized as XML.</span></span>

<span data-ttu-id="deb01-179">**Výpis 8. Použití atributu ScriptMethod s vlastností XmlSerializeString**</span><span class="sxs-lookup"><span data-stu-id="deb01-179">**Listing 8. Using the ScriptMethod attribute with the XmlSerializeString property**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample8.cs)]

<span data-ttu-id="deb01-180">Hodnota vrácená voláním webové metody GetXmlString zobrazené v seznamu 8 je uvedena dále:</span><span class="sxs-lookup"><span data-stu-id="deb01-180">The value returned from calling the GetXmlString Web Method shown in Listing 8 is shown next:</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample9.cs)]

<span data-ttu-id="deb01-181">I když výchozí formát JSON minimalizuje celkovou velikost zpráv požadavků a odpovědí a je snadněji využíván klienty ASP.NET AJAX v různých prohlížečích, lze vlastnosti ResponseFormat a XmlSerializeString využít, když klientské aplikace, jako je například aplikace Internet Explorer 5 nebo vyšší, očekávají vrácení dat XML z webové metody.</span><span class="sxs-lookup"><span data-stu-id="deb01-181">Although the default JSON format minimizes the overall size of request and response messages and is more readily consumed by ASP.NET AJAX clients in a cross-browser manner, the ResponseFormat and XmlSerializeString properties can be utilized when client applications such as Internet Explorer 5 or higher expect XML data to be returned from a Web Method.</span></span>

## <a name="working-with-complex-types"></a><span data-ttu-id="deb01-182">Práce se složitými typy</span><span class="sxs-lookup"><span data-stu-id="deb01-182">Working with Complex Types</span></span>

<span data-ttu-id="deb01-183">Výpis 5 ukázal příklad vrácení komplexního typu s názvem zákazník z webové služby.</span><span class="sxs-lookup"><span data-stu-id="deb01-183">Listing 5 showed an example of returning a complex type named Customer from a Web Service.</span></span> <span data-ttu-id="deb01-184">Třída Customer definuje několik různých jednoduchých typů interně jako vlastnosti jako FirstName a LastName.</span><span class="sxs-lookup"><span data-stu-id="deb01-184">The Customer class defines several different simple types internally as properties such as FirstName and LastName.</span></span> <span data-ttu-id="deb01-185">Komplexní typy používané jako vstupní parametr nebo návratový typ u webové metody s podporou jazyka AJAX jsou automaticky serializovány do formátu JSON před odesláním na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="deb01-185">Complex types used as an input parameter or return type on an AJAX-enabled Web Method are automatically serialized into JSON before being sent to the client-side.</span></span> <span data-ttu-id="deb01-186">Vnořené komplexní typy (které jsou definovány interně v rámci jiného typu) však nebudou klientovi k dispozici jako samostatné objekty ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="deb01-186">However, nested complex types (those defined internally within another type) are not made available to the client as standalone objects by default.</span></span>

<span data-ttu-id="deb01-187">V případech, kdy se na stránce klienta musí použít vnořený komplexní typ používaný webovou službou, lze do webové služby přidat atribut ASP.NET AJAX GenerateScriptType.</span><span class="sxs-lookup"><span data-stu-id="deb01-187">In cases where a nested complex type used by a Web Service must also be used in a client page, the ASP.NET AJAX GenerateScriptType attribute can be added to the Web Service.</span></span> <span data-ttu-id="deb01-188">Například třída CustomerDetails zobrazená v seznamu 9 obsahuje vlastnosti adresa a pohlaví, které ***reprezentují vnořené komplexní typy.***</span><span class="sxs-lookup"><span data-stu-id="deb01-188">For example, the CustomerDetails class shown in Listing 9 contains Address and Gender properties which ***represent nested complex types.***</span></span>

<span data-ttu-id="deb01-189">**Výpis 9. Zde uvedená třída CustomerDetails obsahuje dva vnořené komplexní typy.**</span><span class="sxs-lookup"><span data-stu-id="deb01-189">**Listing 9. The CustomerDetails class shown here contains two nested complex types.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample10.cs)]

<span data-ttu-id="deb01-190">Objekty adresy a pohlaví definované v rámci třídy CustomerDetails zobrazené v seznamu 9 nebudou automaticky dostupné pro použití na straně klienta prostřednictvím JavaScriptu, protože jsou vnořené typy (adresa je třída a pohlaví je výčet).</span><span class="sxs-lookup"><span data-stu-id="deb01-190">The Address and Gender objects defined within the CustomerDetails class shown in Listing 9 won't automatically be made available for use on the client-side via JavaScript since they are nested types (Address is a class and Gender is an enumeration).</span></span> <span data-ttu-id="deb01-191">V situacích, kdy musí být vnořený typ použitý v rámci webové služby dostupný na straně klienta, lze použít atribut GenerateScriptType uvedený výše (viz výpis 10).</span><span class="sxs-lookup"><span data-stu-id="deb01-191">In situations where a nested type used within a Web Service must be available on the client-side, the GenerateScriptType attribute mentioned earlier can be used (see Listing 10).</span></span> <span data-ttu-id="deb01-192">Tento atribut lze přidat několikrát v případech, kdy je ze služby vrácena jiná vnořená komplexní typ.</span><span class="sxs-lookup"><span data-stu-id="deb01-192">This attribute can be added multiple times in cases where different nested complex types are returned from a service.</span></span> <span data-ttu-id="deb01-193">Dá se použít přímo na třídu webové služby nebo nad konkrétní webové metody.</span><span class="sxs-lookup"><span data-stu-id="deb01-193">It can be applied directly to the Web Service class or above specific Web Methods.</span></span>

<span data-ttu-id="deb01-194">**Výpis 10. Pomocí atributu GenerateScriptService definujte vnořené typy, které by měly být k dispozici klientovi.**</span><span class="sxs-lookup"><span data-stu-id="deb01-194">**Listing 10. Using the GenerateScriptService attribute to define nested types that should be available to the client.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample11.cs)]

<span data-ttu-id="deb01-195">Použitím `GenerateScriptType` atributu pro webovou službu budou automaticky zpřístupněny typy adresa a pohlaví pro použití kódem javascriptu ASP.NET AJAX na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="deb01-195">By applying the `GenerateScriptType` attribute to the Web Service, the Address and Gender types will automatically be made available for use by client-side ASP.NET AJAX JavaScript code.</span></span> <span data-ttu-id="deb01-196">Příkladem JavaScriptu, který se automaticky vygeneroval a pošle klientovi přidáním atributu GenerateScriptType ve webové službě, se zobrazí v seznamu 11.</span><span class="sxs-lookup"><span data-stu-id="deb01-196">An example of the JavaScript that is automatically generated and sent to the client by adding the GenerateScriptType attribute on a Web Service is shown in Listing 11.</span></span> <span data-ttu-id="deb01-197">Později v článku se dozvíte, jak používat vnořené komplexní typy.</span><span class="sxs-lookup"><span data-stu-id="deb01-197">You'll see how to use nested complex types later in the article.</span></span>

<span data-ttu-id="deb01-198">**Výpis 11. Vnořené komplexní typy zpřístupněné stránce ASP.NET AJAX.**</span><span class="sxs-lookup"><span data-stu-id="deb01-198">**Listing 11. Nested complex types made available to an ASP.NET AJAX page.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample12.cs)]

<span data-ttu-id="deb01-199">Teď, když jste viděli, jak vytvořit webové služby a zpřístupnit je pro ASP.NET stránky AJAX, si se podíváme na to, jak vytvořit a používat JavaScriptové proxy, aby se data mohla načíst nebo odeslat webovým službám.</span><span class="sxs-lookup"><span data-stu-id="deb01-199">Now that you've seen how to create Web Services and make them accessible to ASP.NET AJAX pages, let's take a look at how to create and use JavaScript proxies so that data can be retrieved or sent to Web Services.</span></span>

## <a name="creating-javascript-proxies"></a><span data-ttu-id="deb01-200">Vytváření proxy serverů JavaScript</span><span class="sxs-lookup"><span data-stu-id="deb01-200">Creating JavaScript Proxies</span></span>

<span data-ttu-id="deb01-201">Volání standardní webové služby (.NET nebo jiné platformy) obvykle zahrnuje vytvoření proxy objektu, který vás chrání před složitou složitostí odesílání požadavků SOAP a zpráv odpovědí.</span><span class="sxs-lookup"><span data-stu-id="deb01-201">Calling a standard Web Service (.NET or another platform) typically involves creating a proxy object that shields you from the complexities of sending SOAP request and response messages.</span></span> <span data-ttu-id="deb01-202">Pomocí volání webové služby ASP.NET AJAX lze vytvořit a použít proxy servery JavaScriptu pro snadné volání služeb bez obav o serializaci a deserializaci zpráv JSON.</span><span class="sxs-lookup"><span data-stu-id="deb01-202">With ASP.NET AJAX Web Service calls, JavaScript proxies can be created and used to easily call services without worrying about serializing and deserializing JSON messages.</span></span> <span data-ttu-id="deb01-203">Proxy servery JavaScriptu lze automaticky generovat pomocí ovládacího prvku ASP.NET AJAX ScriptManager.</span><span class="sxs-lookup"><span data-stu-id="deb01-203">JavaScript proxies can be automatically generated by using the ASP.NET AJAX ScriptManager control.</span></span>

<span data-ttu-id="deb01-204">Vytvoření proxy serveru JavaScriptu, který může volat webové služby, se docílí pomocí vlastnosti služeb ovládacího prvku ScriptManager.</span><span class="sxs-lookup"><span data-stu-id="deb01-204">Creating a JavaScript proxy that can call Web Services is accomplished by using the ScriptManager's Services property.</span></span> <span data-ttu-id="deb01-205">Tato vlastnost umožňuje definovat jednu nebo více služeb, které může stránka ASP.NET AJAX volat asynchronně, aby odesílala nebo přijímala data, aniž by bylo nutné provádět operace zpětného odeslání.</span><span class="sxs-lookup"><span data-stu-id="deb01-205">This property allows you to define one or more services that an ASP.NET AJAX page can call asynchronously to send or receive data without requiring postback operations.</span></span> <span data-ttu-id="deb01-206">Službu definujete pomocí `ServiceReference` ovládacího prvku ASP.NET AJAX a přiřazujete adresu URL webové služby vlastnosti ovládacího prvku `Path` .</span><span class="sxs-lookup"><span data-stu-id="deb01-206">You define a service by using the ASP.NET AJAX `ServiceReference` control and assigning the Web Service URL to the control's `Path` property.</span></span> <span data-ttu-id="deb01-207">Výpis 12 ukazuje příklad odkazování na službu s názvem CustomersService. asmx.</span><span class="sxs-lookup"><span data-stu-id="deb01-207">Listing 12 shows an example of referencing a service named CustomersService.asmx.</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample13.aspx)]

<span data-ttu-id="deb01-208">**Výpis 12. Definování webové služby použité na stránce ASP.NET AJAX.**</span><span class="sxs-lookup"><span data-stu-id="deb01-208">**Listing 12. Defining a Web Service used in an ASP.NET AJAX page.**</span></span>

<span data-ttu-id="deb01-209">Přidání odkazu na CustomersService. asmx prostřednictvím ovládacího prvku ScriptManager způsobí, že se proxy server JavaScriptu dynamicky vygeneruje a odkazuje na stránku.</span><span class="sxs-lookup"><span data-stu-id="deb01-209">Adding a reference to the CustomersService.asmx through the ScriptManager control causes a JavaScript proxy to be dynamically generated and referenced by the page.</span></span> <span data-ttu-id="deb01-210">Proxy je vložený pomocí &lt; &gt; značky Script a dynamicky načtený voláním souboru CustomersService. asmx a připojením/js na konec.</span><span class="sxs-lookup"><span data-stu-id="deb01-210">The proxy is embedded by using the &lt;script&gt; tag and dynamically loaded by calling the CustomersService.asmx file and appending /js to the end of it.</span></span> <span data-ttu-id="deb01-211">Následující příklad ukazuje, jak je JavaScriptový proxy server vložený na stránce, když je ladění v web.config zakázané:</span><span class="sxs-lookup"><span data-stu-id="deb01-211">The following example shows how the JavaScript proxy is embedded in the page when debugging is disabled in web.config:</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample14.html)]

> <span data-ttu-id="deb01-212">*>[!NOTE]Pokud chcete vidět skutečný javascriptový kód, který je vygenerován, můžete zadat adresu URL požadované webové služby .NET do pole Adresa v aplikaci Internet Explorer a připojit/js k konci.*</span><span class="sxs-lookup"><span data-stu-id="deb01-212">*> [!NOTE] If you'd like to see the actual JavaScript proxy code that is generated you can type the URL to the desired .NET Web Service into Internet Explorer's address box and append /js to the end of it.*</span></span>

<span data-ttu-id="deb01-213">Pokud je ladění povoleno v web.config ladicí verze JavaScriptového proxy serveru bude vložena na stránku, jak je uvedeno dále:</span><span class="sxs-lookup"><span data-stu-id="deb01-213">If debugging is enabled in web.config a debug version of the JavaScript proxy will be embedded in the page as shown next:</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample15.html)]

<span data-ttu-id="deb01-214">JavaScriptový proxy vytvořený pomocí ovládacího prvku ScriptManager může být také vložen přímo na stránku namísto odkazování pomocí &lt; &gt; atributu SRC značky skriptu.</span><span class="sxs-lookup"><span data-stu-id="deb01-214">The JavaScript proxy created by the ScriptManager can also be embedded directly into the page rather than referenced using the &lt;script&gt; tag's src attribute.</span></span> <span data-ttu-id="deb01-215">To lze provést nastavením vlastnosti InlineScript ovládacího prvku ServiceReference na hodnotu true (výchozí hodnota je false).</span><span class="sxs-lookup"><span data-stu-id="deb01-215">This can be done by setting the ServiceReference control's InlineScript property to true (the default is false).</span></span> <span data-ttu-id="deb01-216">To může být užitečné, když se proxy server nesdílí mezi několika stránkami a pokud chcete snížit počet síťových volání provedených na serveru.</span><span class="sxs-lookup"><span data-stu-id="deb01-216">This can be useful when a proxy isn't shared across multiple pages and when you'd like to reduce the number of network calls made to the server.</span></span> <span data-ttu-id="deb01-217">Pokud je InlineScript nastavené na hodnotu true, nebude prohlížeč ukládat do mezipaměti skript, takže výchozí hodnota false se doporučuje v případech, kdy se proxy používá na více stránkách aplikace ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="deb01-217">When InlineScript is set to true the proxy script won't be cached by the browser so the default value of false is recommended in cases where the proxy is used by multiple pages in an ASP.NET AJAX application.</span></span> <span data-ttu-id="deb01-218">Příklad použití vlastnosti InlineScript se zobrazí jako další:</span><span class="sxs-lookup"><span data-stu-id="deb01-218">An example of using the InlineScript property is shown next:</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample16.aspx)]

## <a name="using-javascript-proxies"></a><span data-ttu-id="deb01-219">Používání proxy serverů JavaScript</span><span class="sxs-lookup"><span data-stu-id="deb01-219">Using JavaScript Proxies</span></span>

<span data-ttu-id="deb01-220">Jakmile je webová služba odkazována stránkou ASP.NET AJAX pomocí ovládacího prvku ScriptManager, je možné provést volání webové služby a vrácená data lze zpracovat pomocí funkcí zpětného volání.</span><span class="sxs-lookup"><span data-stu-id="deb01-220">Once a Web Service is referenced by an ASP.NET AJAX page using the ScriptManager control, a call can be made to the Web Service and the returned data can be handled using callback functions.</span></span> <span data-ttu-id="deb01-221">Webová služba je volána odkazem na svůj obor názvů (pokud existuje), názvem třídy a názvem webové metody.</span><span class="sxs-lookup"><span data-stu-id="deb01-221">A Web Service is called by referencing its namespace (if one exists), class name and Web Method name.</span></span> <span data-ttu-id="deb01-222">Všechny parametry předané webové službě lze definovat společně s funkcí zpětného volání, která zpracovává vrácená data.</span><span class="sxs-lookup"><span data-stu-id="deb01-222">Any parameters passed to the Web Service can be defined along with a callback function that handles the returned data.</span></span>

<span data-ttu-id="deb01-223">Příklad použití proxy serveru JavaScriptu k volání webové metody s názvem GetCustomersByCountry () je uveden v seznamu 13.</span><span class="sxs-lookup"><span data-stu-id="deb01-223">An example of using a JavaScript proxy to call a Web Method named GetCustomersByCountry() is shown in Listing 13.</span></span> <span data-ttu-id="deb01-224">Funkce GetCustomersByCountry () se volá, když koncový uživatel klikne na tlačítko na stránce.</span><span class="sxs-lookup"><span data-stu-id="deb01-224">The GetCustomersByCountry() function is called when an end user clicks a button on the page.</span></span>

<span data-ttu-id="deb01-225">**Výpis 13. Volání webové služby s JavaScriptovým proxy serverem.**</span><span class="sxs-lookup"><span data-stu-id="deb01-225">**Listing 13. Calling a Web Service with a JavaScript proxy.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample17.js)]

<span data-ttu-id="deb01-226">Toto volání odkazuje na obor názvů InterfaceTraining, webovou metodu CustomersService třídy a GetCustomersByCountry, která je definována ve službě.</span><span class="sxs-lookup"><span data-stu-id="deb01-226">This call references the InterfaceTraining namespace, CustomersService class and GetCustomersByCountry Web Method defined in the service.</span></span> <span data-ttu-id="deb01-227">Předá hodnotu země získanou z textového pole a také funkce zpětného volání s názvem OnWSRequestComplete, které by měly být vyvolány při vrácení volání asynchronní webové služby.</span><span class="sxs-lookup"><span data-stu-id="deb01-227">It passes a country value obtained from a textbox as well as a callback function named OnWSRequestComplete that should be invoked when the asynchronous Web Service call returns.</span></span> <span data-ttu-id="deb01-228">OnWSRequestComplete zpracovává pole zákaznických objektů vrácených službou a převede je na tabulku, která se zobrazí na stránce.</span><span class="sxs-lookup"><span data-stu-id="deb01-228">OnWSRequestComplete handles the array of Customer objects returned from the service and converts them into a table that is displayed in the page.</span></span> <span data-ttu-id="deb01-229">Výstup vygenerovaný z volání je znázorněn na obrázku 1.</span><span class="sxs-lookup"><span data-stu-id="deb01-229">The output generated from the call is shown in Figure 1.</span></span>

<span data-ttu-id="deb01-230">[![Vázání dat získaných vytvořením asynchronního volání AJAX webové službě.](understanding-asp-net-ajax-web-services/_static/image2.png)](understanding-asp-net-ajax-web-services/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="deb01-230">[![Binding data obtained by making an asynchronous AJAX call to a Web Service.](understanding-asp-net-ajax-web-services/_static/image2.png)](understanding-asp-net-ajax-web-services/_static/image1.png)</span></span>

<span data-ttu-id="deb01-231">**Obrázek 1**: vazba dat získaná vytvořením asynchronního volání AJAX do webové služby.</span><span class="sxs-lookup"><span data-stu-id="deb01-231">**Figure 1**: Binding data obtained by making an asynchronous AJAX call to a Web Service.</span></span>  <span data-ttu-id="deb01-232">([Kliknutím zobrazíte obrázek v plné velikosti.](understanding-asp-net-ajax-web-services/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="deb01-232">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image3.png))</span></span>

<span data-ttu-id="deb01-233">Proxy servery JavaScript mohou také volat jednosměrná volání webových služeb v případech, kdy by měla být volána Webová metoda, ale proxy server by neměl čekat na odpověď.</span><span class="sxs-lookup"><span data-stu-id="deb01-233">JavaScript proxies can also make one-way calls to Web Services in cases where a Web Method should be called but the proxy shouldn't wait for a response.</span></span> <span data-ttu-id="deb01-234">Například můžete chtít zavolat webovou službu, která spustí proces, jako je například pracovní tok, ale nečeká na návratovou hodnotu ze služby.</span><span class="sxs-lookup"><span data-stu-id="deb01-234">For example, you may want to call a Web Service to start a process such as a work-flow but not wait for a return value from the service.</span></span> <span data-ttu-id="deb01-235">V případech, kdy je třeba provést jednosměrné volání ke službě, může být funkce zpětného volání zobrazená v seznamu 13 jednoduše vynechána.</span><span class="sxs-lookup"><span data-stu-id="deb01-235">In cases where a one-way call needs to be made to a service, the callback function shown in Listing 13 can simply be omitted.</span></span> <span data-ttu-id="deb01-236">Vzhledem k tomu, že není definována žádná funkce zpětného volání, nebude objekt proxy čekat, než webová služba vrátí data.</span><span class="sxs-lookup"><span data-stu-id="deb01-236">Since no callback function is defined the proxy object will not wait for the Web Service to return data.</span></span>

## <a name="handling-errors"></a><span data-ttu-id="deb01-237">Zpracování chyb</span><span class="sxs-lookup"><span data-stu-id="deb01-237">Handling Errors</span></span>

<span data-ttu-id="deb01-238">Asynchronní zpětné volání webové služby může narazit na různé typy chyb, jako je síť, která je mimo provoz, Webová služba není k dispozici nebo se vrátí výjimka.</span><span class="sxs-lookup"><span data-stu-id="deb01-238">Asynchronous callbacks to Web Services can encounter different types of errors such as the network being down, the Web Service being unavailable or an exception being returned.</span></span> <span data-ttu-id="deb01-239">Naštěstí proxy objekty JavaScriptu generované nástrojem ScriptManager umožňují definovat více zpětných volání, aby bylo možné zpracovávat chyby a chyby kromě zpětného volání, které se zobrazilo dříve.</span><span class="sxs-lookup"><span data-stu-id="deb01-239">Fortunately, JavaScript proxy objects generated by the ScriptManager allow multiple callbacks to be defined to handle errors and failures in addition to the success callback shown earlier.</span></span> <span data-ttu-id="deb01-240">Funkce zpětného volání chyby může být definována hned po standardní funkci zpětného volání ve volání webové metody, jak je znázorněno v seznamu 14.</span><span class="sxs-lookup"><span data-stu-id="deb01-240">An error callback function can be defined immediately after the standard callback function in the call to the Web Method as shown in Listing 14.</span></span>

<span data-ttu-id="deb01-241">**Výpis 14. Definování funkce zpětného volání chyb a zobrazování chyb.**</span><span class="sxs-lookup"><span data-stu-id="deb01-241">**Listing 14. Defining an error callback function and displaying errors.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample18.js)]

<span data-ttu-id="deb01-242">Všechny chyby, ke kterým dojde při volání webové služby, spustí funkci zpětného volání OnWSRequestFailed (), která přijímá objekt představující chybu jako parametr.</span><span class="sxs-lookup"><span data-stu-id="deb01-242">Any errors that occur when the Web Service is called will trigger the OnWSRequestFailed() callback function to be called which accepts an object representing the error as a parameter.</span></span> <span data-ttu-id="deb01-243">Objekt Error zpřístupňuje několik různých funkcí, které určují příčinu chyby, a také to, jestli vypršel časový limit volání. Výpis 14 ukazuje příklad použití různých chybových funkcí a obrázek 2 ukazuje příklad výstupu generovaného funkcemi.</span><span class="sxs-lookup"><span data-stu-id="deb01-243">The error object exposes several different functions to determine the cause of the error as well as whether or not the call timed out. Listing 14 shows an example of using the different error functions and Figure 2 shows an example of the output generated by the functions.</span></span>

<span data-ttu-id="deb01-244">[![Výstup generovaný při volání funkcí ASP.NET AJAX.](understanding-asp-net-ajax-web-services/_static/image5.png)](understanding-asp-net-ajax-web-services/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="deb01-244">[![Output generated by calling ASP.NET AJAX error functions.](understanding-asp-net-ajax-web-services/_static/image5.png)](understanding-asp-net-ajax-web-services/_static/image4.png)</span></span>

<span data-ttu-id="deb01-245">**Obrázek 2**: výstup generovaný při volání funkcí ASP.NET AJAX</span><span class="sxs-lookup"><span data-stu-id="deb01-245">**Figure 2**: Output generated by calling ASP.NET AJAX error functions.</span></span>  <span data-ttu-id="deb01-246">([Kliknutím zobrazíte obrázek v plné velikosti.](understanding-asp-net-ajax-web-services/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="deb01-246">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image6.png))</span></span>

## <a name="handling-xml-data-returned-from-a-web-service"></a><span data-ttu-id="deb01-247">Zpracování dat XML vrácených z webové služby</span><span class="sxs-lookup"><span data-stu-id="deb01-247">Handling XML Data Returned from a Web Service</span></span>

<span data-ttu-id="deb01-248">Dříve jste viděli, jak může webová metoda vracet nezpracovaná data XML pomocí atributu ScriptMethod spolu s vlastností ResponseFormat.</span><span class="sxs-lookup"><span data-stu-id="deb01-248">Earlier you saw how a Web Method could return raw XML data by using the ScriptMethod attribute along with its ResponseFormat property.</span></span> <span data-ttu-id="deb01-249">Pokud je ResponseFormat nastaveno na ResponseFormat.Xml, data vrácená z webové služby jsou serializována jako XML místo JSON.</span><span class="sxs-lookup"><span data-stu-id="deb01-249">When ResponseFormat is set to ResponseFormat.Xml, data returned from the Web Service is serialized as XML rather than JSON.</span></span> <span data-ttu-id="deb01-250">To může být užitečné, pokud data XML musí být předána přímo klientovi ke zpracování pomocí JavaScriptu nebo XSLT.</span><span class="sxs-lookup"><span data-stu-id="deb01-250">This can be useful when XML data needs to be passed directly to the client for processing using JavaScript or XSLT.</span></span> <span data-ttu-id="deb01-251">V současné době Internet Explorer 5 nebo vyšší poskytuje nejlepší objektový model na straně klienta pro analýzu a filtrování dat XML z důvodu integrované podpory MSXML.</span><span class="sxs-lookup"><span data-stu-id="deb01-251">At the current time, Internet Explorer 5 or higher provides the best client-side object model for parsing and filtering XML data due to its built-in support for MSXML.</span></span>

<span data-ttu-id="deb01-252">Načítání dat XML z webové služby se neliší od načtení jiných datových typů.</span><span class="sxs-lookup"><span data-stu-id="deb01-252">Retrieving XML data from a Web Service is no different than retrieving other data types.</span></span> <span data-ttu-id="deb01-253">Začněte vyvoláním proxy JavaScriptu pro volání příslušné funkce a definování funkce zpětného volání.</span><span class="sxs-lookup"><span data-stu-id="deb01-253">Start by invoking the JavaScript proxy to call the appropriate function and define a callback function.</span></span> <span data-ttu-id="deb01-254">Jakmile volání vrátí, můžete zpracovat data ve funkci zpětného volání.</span><span class="sxs-lookup"><span data-stu-id="deb01-254">Once the call returns you can then process the data in the callback function.</span></span>

<span data-ttu-id="deb01-255">Výpis 15 ukazuje příklad volání webové metody s názvem GetRssFeed (), která vrací objekt XmlElement.</span><span class="sxs-lookup"><span data-stu-id="deb01-255">Listing 15 shows an example of calling a Web Method named GetRssFeed() that returns an XmlElement object.</span></span> <span data-ttu-id="deb01-256">GetRssFeed () přijímá jeden parametr představující adresu URL informačního kanálu RSS, který se má načíst.</span><span class="sxs-lookup"><span data-stu-id="deb01-256">GetRssFeed() accepts a single parameter representing the URL for the RSS feed to retrieve.</span></span>

<span data-ttu-id="deb01-257">**Výpis 15. Práce s daty XML vrácenými z webové služby.**</span><span class="sxs-lookup"><span data-stu-id="deb01-257">**Listing 15. Working with XML data returned from a Web Service.**</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample19.html)]

<span data-ttu-id="deb01-258">Tento příklad předá adresu URL informačního kanálu RSS a zpracovává vrácená data XML ve funkci OnWSRequestComplete ().</span><span class="sxs-lookup"><span data-stu-id="deb01-258">This example passes a URL to an RSS feed and processes the returned XML data in the OnWSRequestComplete() function.</span></span> <span data-ttu-id="deb01-259">OnWSRequestComplete () nejprve zkontroluje, zda je prohlížeč Internet Explorer, aby bylo možné zjistit, zda je analyzátor MSXML k dispozici.</span><span class="sxs-lookup"><span data-stu-id="deb01-259">OnWSRequestComplete() first checks to see if the browser is Internet Explorer to know whether or not the MSXML parser is available.</span></span> <span data-ttu-id="deb01-260">Pokud je, použije se k vyhledání všech &lt; &gt; značek položek v informačním kanálu RSS příkaz XPath.</span><span class="sxs-lookup"><span data-stu-id="deb01-260">If it is, an XPath statement is used to locate all &lt;item&gt; tags within the RSS feed.</span></span> <span data-ttu-id="deb01-261">Každá položka se pak prochází pomocí a &lt; &gt; &lt; &gt; jsou umístěné a zpracovávané přidružené značky title a Link pro zobrazení dat jednotlivých položek.</span><span class="sxs-lookup"><span data-stu-id="deb01-261">Each item is then iterated through and the associated &lt;title&gt; and &lt;link&gt; tags are located and processed to display each item's data.</span></span> <span data-ttu-id="deb01-262">Obrázek 3 ukazuje příklad výstupu generovaného z ASP.NET volání AJAX prostřednictvím proxy JavaScriptu na webovou metodu GetRssFeed ().</span><span class="sxs-lookup"><span data-stu-id="deb01-262">Figure 3 shows an example of the output generated from making an ASP.NET AJAX call through a JavaScript proxy to the GetRssFeed() Web Method.</span></span>

## <a name="handling-complex-types"></a><span data-ttu-id="deb01-263">Zpracování komplexních typů</span><span class="sxs-lookup"><span data-stu-id="deb01-263">Handling Complex Types</span></span>

<span data-ttu-id="deb01-264">Komplexní typy přijaté nebo vrácené webovou službou se automaticky zveřejňují prostřednictvím proxy JavaScriptu.</span><span class="sxs-lookup"><span data-stu-id="deb01-264">Complex types accepted or returned by a Web Service are automatically exposed through a JavaScript proxy.</span></span> <span data-ttu-id="deb01-265">Vnořené komplexní typy však nejsou přímo přístupné na straně klienta, pokud atribut GenerateScriptType se na službu nepoužívá, jak je popsáno výše.</span><span class="sxs-lookup"><span data-stu-id="deb01-265">However, nested complex types are not directly accessible on the client-side unless the GenerateScriptType attribute is applied to the service as discussed earlier.</span></span> <span data-ttu-id="deb01-266">Proč byste chtěli použít vnořený komplexní typ na straně klienta?</span><span class="sxs-lookup"><span data-stu-id="deb01-266">Why would you want to use a nested complex type on the client-side?</span></span>

<span data-ttu-id="deb01-267">Pro zodpovězení této otázky Předpokládejme, že stránka ASP.NET AJAX zobrazuje zákaznická data a umožňuje koncovým uživatelům aktualizovat adresu zákazníka.</span><span class="sxs-lookup"><span data-stu-id="deb01-267">To answer this question, assume that an ASP.NET AJAX page displays customer data and allows end users to update a customer's address.</span></span> <span data-ttu-id="deb01-268">Pokud webová služba Určuje, že typ adresy (komplexní typ definovaný v rámci třídy CustomerDetails) může být odeslán klientovi, pak může být proces aktualizace rozdělen na samostatné funkce pro lepší opakované použití kódu.</span><span class="sxs-lookup"><span data-stu-id="deb01-268">If the Web Service specifies that the Address type (a complex type defined within a CustomerDetails class) can be sent to the client then the update process can be divided into separate functions for better code re-use.</span></span>

<span data-ttu-id="deb01-269">[![Výstup vytvoření z volání webové služby, která vrací data RSS.](understanding-asp-net-ajax-web-services/_static/image8.png)](understanding-asp-net-ajax-web-services/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="deb01-269">[![Output creating from calling a Web Service that returns RSS data.](understanding-asp-net-ajax-web-services/_static/image8.png)](understanding-asp-net-ajax-web-services/_static/image7.png)</span></span>

<span data-ttu-id="deb01-270">**Obrázek 3**: vytváření výstupu z volání webové služby, která vrací data RSS.</span><span class="sxs-lookup"><span data-stu-id="deb01-270">**Figure 3**: Output creating from calling a Web Service that returns RSS data.</span></span>  <span data-ttu-id="deb01-271">([Kliknutím zobrazíte obrázek v plné velikosti.](understanding-asp-net-ajax-web-services/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="deb01-271">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image9.png))</span></span>

<span data-ttu-id="deb01-272">Výpis 16 ukazuje příklad kódu na straně klienta, který vyvolá objekt adresy definovaný v oboru názvů modelu, vyplní aktualizované údaje a přiřadí je vlastnosti Adresa objektu CustomerDetails.</span><span class="sxs-lookup"><span data-stu-id="deb01-272">Listing 16 shows an example of client-side code that invokes an Address object defined in a Model namespace, fills it with updated data and assigns it to a CustomerDetails object's Address property.</span></span> <span data-ttu-id="deb01-273">Objekt CustomerDetails se pak předává webové službě ke zpracování.</span><span class="sxs-lookup"><span data-stu-id="deb01-273">The CustomerDetails object is then passed to the Web Service for processing.</span></span>

<span data-ttu-id="deb01-274">**Výpis 16. Použití vnořených komplexních typů**</span><span class="sxs-lookup"><span data-stu-id="deb01-274">**Listing 16. Using nested complex types**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample20.js)]

## <a name="creating-and-using-page-methods"></a><span data-ttu-id="deb01-275">Vytváření a používání metod stránky</span><span class="sxs-lookup"><span data-stu-id="deb01-275">Creating and Using Page Methods</span></span>

<span data-ttu-id="deb01-276">Webové služby poskytují skvělý způsob, jak vystavit opakované služby pro celou řadu klientů, včetně stránek ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="deb01-276">Web Services provide an excellent way to expose re-useable services to a variety of clients including ASP.NET AJAX pages.</span></span> <span data-ttu-id="deb01-277">Mohou však nastat případy, kdy stránka potřebuje načíst data, která nikdy nebudou použita nebo sdílena jinými stránkami.</span><span class="sxs-lookup"><span data-stu-id="deb01-277">However, there may be cases where a page needs to retrieve data that won't ever be used or shared by other pages.</span></span> <span data-ttu-id="deb01-278">V takovém případě může být soubor. asmx, který umožňuje stránku přístup k datům, vypadat jako přehnaně důkladné, protože služba je používána pouze jednou stránkou.</span><span class="sxs-lookup"><span data-stu-id="deb01-278">In this case, making an .asmx file to allow the page to access the data may seem like overkill since the service is only used by a single page.</span></span>

<span data-ttu-id="deb01-279">ASP.NET AJAX poskytuje další mechanismus pro volání na základě webové služby bez vytváření samostatných souborů. asmx.</span><span class="sxs-lookup"><span data-stu-id="deb01-279">ASP.NET AJAX provides another mechanism for making Web Service-like calls without creating standalone .asmx files.</span></span> <span data-ttu-id="deb01-280">To se provádí pomocí techniky, která je označována jako "metody stránky".</span><span class="sxs-lookup"><span data-stu-id="deb01-280">This is done by using a technique referred to as "page methods".</span></span> <span data-ttu-id="deb01-281">Metody stránky jsou statické metody (sdílené v VB.NET) vložené přímo do stránky nebo souboru s kódem vedle kódu, který má atribut WebMethod použit pro ně.</span><span class="sxs-lookup"><span data-stu-id="deb01-281">Page methods are static (shared in VB.NET) methods embedded directly in a page or code-beside file that have the WebMethod attribute applied to them.</span></span> <span data-ttu-id="deb01-282">Použitím atributu WebMethod lze volat pomocí speciálního objektu jazyka JavaScript s názvem PageMethods, který se dynamicky vytvoří za běhu.</span><span class="sxs-lookup"><span data-stu-id="deb01-282">By applying the WebMethod attribute they can be called using a special JavaScript object named PageMethods that gets dynamically created at runtime.</span></span> <span data-ttu-id="deb01-283">Objekt PageMethods funguje jako proxy, který vás chrání před procesem serializace/deserializace JSON.</span><span class="sxs-lookup"><span data-stu-id="deb01-283">The PageMethods object acts as a proxy that shields you from the JSON serialization/deserialization process.</span></span> <span data-ttu-id="deb01-284">Všimněte si, že aby bylo možné použít objekt PageMethods, musíte nastavit vlastnost EnablePageMethods ovládacího prvku ScriptManager na hodnotu true.</span><span class="sxs-lookup"><span data-stu-id="deb01-284">Note that in order to use the PageMethods object you must set the ScriptManager's EnablePageMethods property to true.</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample21.aspx)]

<span data-ttu-id="deb01-285">Výpis 17 ukazuje příklad definování dvou metod stránky ve třídě ASP.NET (vedle kódu).</span><span class="sxs-lookup"><span data-stu-id="deb01-285">Listing 17 shows an example of defining two page methods in an ASP.NET code-beside class.</span></span> <span data-ttu-id="deb01-286">Tyto metody načítají data z třídy obchodní vrstvy, která se nachází ve \_ složce s kódem aplikace na webu.</span><span class="sxs-lookup"><span data-stu-id="deb01-286">These methods retrieve data from a business layer class located in the App\_Code folder of the Website.</span></span>

<span data-ttu-id="deb01-287">**Výpis 17. Definování metod stránky.**</span><span class="sxs-lookup"><span data-stu-id="deb01-287">**Listing 17. Defining page methods.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample22.cs)]

<span data-ttu-id="deb01-288">Když ScriptManager zjistí přítomnost webových metod na stránce, vygeneruje dynamický odkaz na objekt PageMethods zmíněný výše.</span><span class="sxs-lookup"><span data-stu-id="deb01-288">When ScriptManager detects the presence of Web Methods in the page it generates a dynamic reference to the PageMethods object mentioned earlier.</span></span> <span data-ttu-id="deb01-289">Volání webové metody je provedeno odkazem na třídu PageMethods následovanou názvem metody a všemi potřebnými daty parametrů, které by měly být předány.</span><span class="sxs-lookup"><span data-stu-id="deb01-289">Calling a Web Method is accomplished by referencing the PageMethods class followed by the name of the method and any necessary parameter data that should be passed.</span></span> <span data-ttu-id="deb01-290">Výpis 18 ukazuje příklady volání dvou výše uvedených metod stránky.</span><span class="sxs-lookup"><span data-stu-id="deb01-290">Listing 18 shows examples of calling the two page methods shown earlier.</span></span>

<span data-ttu-id="deb01-291">**Výpis 18. Volání metod stránky s objektem JavaScript PageMethods**</span><span class="sxs-lookup"><span data-stu-id="deb01-291">**Listing 18. Calling page methods with the PageMethods JavaScript object.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample23.js)]

<span data-ttu-id="deb01-292">Použití objektu PageMethods je velmi podobné použití JavaScriptového objektu JavaScript.</span><span class="sxs-lookup"><span data-stu-id="deb01-292">Using the PageMethods object is very similar to using a JavaScript proxy object.</span></span> <span data-ttu-id="deb01-293">Nejprve zadáte všechna data parametrů, která by měla být předána metodě stránky a poté definovat funkci zpětného volání, která by měla být volána, když se vrátí asynchronní volání.</span><span class="sxs-lookup"><span data-stu-id="deb01-293">You first specify all of the parameter data that should be passed to the page method and then define the callback function that should be called when the asynchronous call returns.</span></span> <span data-ttu-id="deb01-294">Lze také zadat zpětné volání při selhání (pro příklad selhání zpracování se podívejte na výpis 14).</span><span class="sxs-lookup"><span data-stu-id="deb01-294">A failure callback can also be specified (refer to Listing 14 for an example of handling failures).</span></span>

## <a name="the-autocompleteextender-and-the-aspnet-ajax-toolkit"></a><span data-ttu-id="deb01-295">AutoCompleteExtender a ASP.NET Toolkit AJAX</span><span class="sxs-lookup"><span data-stu-id="deb01-295">The AutoCompleteExtender and the ASP.NET AJAX Toolkit</span></span>

<span data-ttu-id="deb01-296">ASP.NET AJAX Toolkit (dostupný z [http://ajax.asp.net](http://ajax.asp.net) ) nabízí několik ovládacích prvků, které lze použít pro přístup k webovým službám.</span><span class="sxs-lookup"><span data-stu-id="deb01-296">The ASP.NET AJAX Toolkit (available from [http://ajax.asp.net](http://ajax.asp.net)) offers several controls that can be used to access Web Services.</span></span> <span data-ttu-id="deb01-297">Konkrétně sada nástrojů obsahuje užitečný ovládací prvek s názvem `AutoCompleteExtender` , který lze použít k volání webových služeb a zobrazení dat na stránkách bez nutnosti psaní jakéhokoli kódu JavaScriptu.</span><span class="sxs-lookup"><span data-stu-id="deb01-297">Specifically, the toolkit contains a useful control named `AutoCompleteExtender` that can be used to call Web Services and show data in pages without writing any JavaScript code at all.</span></span>

<span data-ttu-id="deb01-298">Ovládací prvek AutoCompleteExtender se dá použít k rozšiřování existujících funkcí textového pole a snadnějšímu vyhledávání dat, která hledají uživatelé.</span><span class="sxs-lookup"><span data-stu-id="deb01-298">The AutoCompleteExtender control can be used to extend existing functionality of a textbox and help users more easily locate data they're looking for.</span></span> <span data-ttu-id="deb01-299">Při zadávání do textového pole lze ovládací prvek použít k dotazování webové služby a k dynamickému zobrazení výsledků pod textovým polem.</span><span class="sxs-lookup"><span data-stu-id="deb01-299">As they type into a textbox the control can be used to query a Web Service and shows results below the textbox dynamically.</span></span> <span data-ttu-id="deb01-300">Obrázek 4 ukazuje příklad použití ovládacího prvku AutoCompleteExtender k zobrazení ID zákazníků pro aplikaci podpory.</span><span class="sxs-lookup"><span data-stu-id="deb01-300">Figure 4 shows an example of using the AutoCompleteExtender control to display customer ids for a support application.</span></span> <span data-ttu-id="deb01-301">Vzhledem k tomu, že uživatel zadá různé znaky do textového pole, budou na základě jeho vstupu zobrazeny různé položky.</span><span class="sxs-lookup"><span data-stu-id="deb01-301">As the user types different characters into the textbox, different items will be shown below it based upon their input.</span></span> <span data-ttu-id="deb01-302">Uživatelé pak mohou vybrat požadované ID zákazníka.</span><span class="sxs-lookup"><span data-stu-id="deb01-302">Users can then select the desired customer id.</span></span>

<span data-ttu-id="deb01-303">Použití AutoCompleteExtender v rámci stránky ASP.NET AJAX vyžaduje, aby bylo sestavení AjaxControlToolkit.dll přidáno do složky Bin webu.</span><span class="sxs-lookup"><span data-stu-id="deb01-303">Using the AutoCompleteExtender within an ASP.NET AJAX page requires that the AjaxControlToolkit.dll assembly be added to the Website's bin folder.</span></span> <span data-ttu-id="deb01-304">Po přidání sestavení sady Toolkit je vhodné na něj odkazovat v web.config tak, aby ovládací prvky, které obsahuje, byly k dispozici pro všechny stránky v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="deb01-304">Once the toolkit assembly has been added, you'll want to reference it in web.config so that the controls it contains are available to all pages in an application.</span></span> <span data-ttu-id="deb01-305">To lze provést přidáním následující značky v rámci &lt; značky ovládacích prvků web.config &gt; :</span><span class="sxs-lookup"><span data-stu-id="deb01-305">This can be done by adding the following tag within web.config's &lt;controls&gt; tag:</span></span>

[!code-xml[Main](understanding-asp-net-ajax-web-services/samples/sample24.xml)]

<span data-ttu-id="deb01-306">V případech, kdy je třeba použít pouze ovládací prvek na konkrétní stránce, můžete na něj odkazovat přidáním direktivy Reference do horní části stránky, jak je uvedeno dále, nikoli aktualizací web.config:</span><span class="sxs-lookup"><span data-stu-id="deb01-306">In cases where you only need to use the control in a specific page you can reference it by adding the Reference directive to the top of a page as shown next rather than updating web.config:</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample25.aspx)]

<span data-ttu-id="deb01-307">[![Použití ovládacího prvku AutoCompleteExtender](understanding-asp-net-ajax-web-services/_static/image11.png)](understanding-asp-net-ajax-web-services/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="deb01-307">[![Using the AutoCompleteExtender control.](understanding-asp-net-ajax-web-services/_static/image11.png)](understanding-asp-net-ajax-web-services/_static/image10.png)</span></span>

<span data-ttu-id="deb01-308">**Obrázek 4**: použití ovládacího prvku AutoCompleteExtender</span><span class="sxs-lookup"><span data-stu-id="deb01-308">**Figure 4**: Using the AutoCompleteExtender control.</span></span>  <span data-ttu-id="deb01-309">([Kliknutím zobrazíte obrázek v plné velikosti.](understanding-asp-net-ajax-web-services/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="deb01-309">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image12.png))</span></span>

<span data-ttu-id="deb01-310">Po nakonfigurování webu pro použití nástroje ASP.NET AJAX Toolkit lze přidat ovládací prvek AutoCompleteExtender do stránky podobně jako byste přidali běžný ovládací prvek ASP.NET serveru.</span><span class="sxs-lookup"><span data-stu-id="deb01-310">Once the Website has been configured to use the ASP.NET AJAX Toolkit, an AutoCompleteExtender control can be added into the page much like you'd add a regular ASP.NET server control.</span></span> <span data-ttu-id="deb01-311">Výpis 19 ukazuje příklad použití ovládacího prvku pro volání webové služby.</span><span class="sxs-lookup"><span data-stu-id="deb01-311">Listing 19 shows an example of using the control to call a Web Service.</span></span>

<span data-ttu-id="deb01-312">**Výpis 19. Pomocí ovládacího prvku ASP.NET AJAX Toolkit AutoCompleteExtender.**</span><span class="sxs-lookup"><span data-stu-id="deb01-312">**Listing 19. Using the ASP.NET AJAX Toolkit AutoCompleteExtender control.**</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample26.aspx)]

<span data-ttu-id="deb01-313">AutoCompleteExtender má několik různých vlastností, včetně standardního ID a vlastností runat nalezených na serverových ovládacích prvcích.</span><span class="sxs-lookup"><span data-stu-id="deb01-313">The AutoCompleteExtender has several different properties including the standard ID and runat properties found on server controls.</span></span> <span data-ttu-id="deb01-314">Kromě toho vám umožňuje definovat, kolik znaků typ koncového uživatele před dotazováním webové služby na data.</span><span class="sxs-lookup"><span data-stu-id="deb01-314">In addition to these, it allows you to define how many characters an end user types before the Web Service is queried for data.</span></span> <span data-ttu-id="deb01-315">Vlastnost MinimumPrefixLength uvedená v seznamu 19 způsobí, že se služba zavolá pokaždé, když se do textového pole zadá znak.</span><span class="sxs-lookup"><span data-stu-id="deb01-315">The MinimumPrefixLength property shown in Listing 19 causes the service to be called each time a character is typed into the textbox.</span></span> <span data-ttu-id="deb01-316">Tuto hodnotu budete muset pečlivě nastavit, protože pokaždé, když uživatel zadá znak, který bude volat webová služba, vyhledá hodnoty, které odpovídají znakům v textovém poli.</span><span class="sxs-lookup"><span data-stu-id="deb01-316">You'll want to be careful setting this value since each time the user types a character the Web Service will be called to search for values that match the characters in the textbox.</span></span> <span data-ttu-id="deb01-317">Webová služba, která se má volat, stejně jako cílová webová metoda je definována pomocí vlastností ServicePath a ServiceMethod v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="deb01-317">The Web Service to call as well as the target Web Method are defined using the ServicePath and ServiceMethod properties respectively.</span></span> <span data-ttu-id="deb01-318">Nakonec vlastnost vlastnost TargetControlID prvku určuje, které textové pole má připojovat ovládací prvek AutoCompleteExtender.</span><span class="sxs-lookup"><span data-stu-id="deb01-318">Finally, the TargetControlID property identifies which textbox to hook the AutoCompleteExtender control to.</span></span>

<span data-ttu-id="deb01-319">Volaná webová služba musí mít atribut ScriptService použit jak je popsáno výše a cílová webová metoda musí přijmout dva parametry s názvem prefixText a Count.</span><span class="sxs-lookup"><span data-stu-id="deb01-319">The Web Service being called must have the ScriptService attribute applied as discussed earlier and the target Web Method must accept two parameters named prefixText and count.</span></span> <span data-ttu-id="deb01-320">Parametr prefixText představuje znaky zadané koncovým uživatelem a parametr Count představuje počet položek, které se mají vrátit (výchozí hodnota je 10).</span><span class="sxs-lookup"><span data-stu-id="deb01-320">The prefixText parameter represents the characters typed by the end user and the count parameter represents how many items to return (the default is 10).</span></span> <span data-ttu-id="deb01-321">Výpis 20 ukazuje příklad webové metody getkódzákazníkas volané ovládacím prvkem AutoCompleteExtender, který je uveden výše v seznamu 19.</span><span class="sxs-lookup"><span data-stu-id="deb01-321">Listing 20 shows an example of the GetCustomerIDs Web Method called by the AutoCompleteExtender control shown earlier in Listing 19.</span></span> <span data-ttu-id="deb01-322">Metoda web volá metodu obchodní vrstvy, která zase volá metodu datové vrstvy, která zpracovává filtrování dat a vrací odpovídající výsledky.</span><span class="sxs-lookup"><span data-stu-id="deb01-322">The Web Method calls a business layer method that in turn calls a data layer method that handles filtering the data and returning the matching results.</span></span> <span data-ttu-id="deb01-323">Kód pro metodu datové vrstvy je zobrazen v seznamu 21.</span><span class="sxs-lookup"><span data-stu-id="deb01-323">The code for the data layer method is shown in Listing 21.</span></span>

<span data-ttu-id="deb01-324">**Výpis 20. Filtrování dat odeslaných z ovládacího prvku AutoCompleteExtender.**</span><span class="sxs-lookup"><span data-stu-id="deb01-324">**Listing 20. Filtering data sent from the AutoCompleteExtender control.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample27.cs)]

<span data-ttu-id="deb01-325">**Výpis 21. Filtrování výsledků na základě vstupu koncového uživatele.**</span><span class="sxs-lookup"><span data-stu-id="deb01-325">**Listing 21. Filtering results based upon end user input.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample28.cs)]

## <a name="conclusion"></a><span data-ttu-id="deb01-326">Závěr</span><span class="sxs-lookup"><span data-stu-id="deb01-326">Conclusion</span></span>

<span data-ttu-id="deb01-327">ASP.NET AJAX poskytuje skvělou podporu pro volání webových služeb, aniž by bylo potřeba psát spoustu vlastních kódů JavaScriptu pro zpracování žádostí a zpráv odpovědí.</span><span class="sxs-lookup"><span data-stu-id="deb01-327">ASP.NET AJAX provides excellent support for calling Web Services without writing a lot of custom JavaScript code to handle the request and response messages.</span></span> <span data-ttu-id="deb01-328">V tomto článku jste se naučili, jak AJAX povolit webové služby .NET, aby mohly zpracovávat zprávy JSON a jak definovat proxy JavaScripty pomocí ovládacího prvku ScriptManager.</span><span class="sxs-lookup"><span data-stu-id="deb01-328">In this article you've seen how to AJAX-enable .NET Web Services to enable them to process JSON messages and how to define JavaScript proxies using the ScriptManager control.</span></span> <span data-ttu-id="deb01-329">Viděli jste také, jak můžou být proxy servery jazyka JavaScript použity pro volání webových služeb, zpracování jednoduchých a složitých typů a řešení chyb.</span><span class="sxs-lookup"><span data-stu-id="deb01-329">You've also seen how JavaScript proxies can be used to call Web Services, handle simple and complex types and deal with failures.</span></span> <span data-ttu-id="deb01-330">Nakonec jste viděli, jak lze metody stránky použít ke zjednodušení procesu vytváření a provádění volání webové služby a způsobu, jakým může ovládací prvek AutoCompleteExtender poskytnout uživatelům při psaní lepší informace pro koncové uživatele.</span><span class="sxs-lookup"><span data-stu-id="deb01-330">Finally, you've seen how page methods can be used to simplify the process of creating and making Web Service calls and how the AutoCompleteExtender control can provide help to end users as they type.</span></span> <span data-ttu-id="deb01-331">I když je ovládací prvek UpdatePanel dostupný v ASP.NET AJAX v důsledku jednoduchosti kontrolou volby pro mnoho programátorů AJAX, je důležité vědět, jak volat webové služby prostřednictvím proxy serverů JavaScriptu může být užitečné v mnoha aplikacích.</span><span class="sxs-lookup"><span data-stu-id="deb01-331">Although the UpdatePanel available in ASP.NET AJAX will certainly be the control of choice for many AJAX programmers due to its simplicity, knowing how to call Web Services through JavaScript proxies can be useful in many applications.</span></span>

## <a name="bio"></a><span data-ttu-id="deb01-332">Dostupnost</span><span class="sxs-lookup"><span data-stu-id="deb01-332">Bio</span></span>

<span data-ttu-id="deb01-333">Dan Wahlin (Microsoft nejvíc Professional for ASP.NET and XML Web Services) je instruktor pro vývoj a architekturu pro vývoj rozhraní .NET na úrovni technického školení ( [http://www.interfacett.com](http://www.interfacett.com) ).</span><span class="sxs-lookup"><span data-stu-id="deb01-333">Dan Wahlin (Microsoft Most Valuable Professional for ASP.NET and XML Web Services) is a .NET development instructor and architecture consultant at Interface Technical Training ([http://www.interfacett.com](http://www.interfacett.com)).</span></span> <span data-ttu-id="deb01-334">Daň ze sady XML for ASP.NET Developers web ([www.XMLforASP.NET](http://www.XMLforASP.NET)) se nachází v kanceláři mluvčího v INETA a mluví na několika konferencích.</span><span class="sxs-lookup"><span data-stu-id="deb01-334">Dan founded the XML for ASP.NET Developers Web site ([www.XMLforASP.NET](http://www.XMLforASP.NET)), is on the INETA Speaker's Bureau and speaks at several conferences.</span></span> <span data-ttu-id="deb01-335">Specialista na spolupracovníka Windows DNA (Wrox), ASP.NET: tipy, kurzy a Code (Sams), ASP.NET 1,1 řešení Insider, Professional ASP.NET 2,0 AJAX (Wrox), ASP.NET 2,0 MVP Hackatony a vytvořil XML pro vývojáře ASP.NET (Sams).</span><span class="sxs-lookup"><span data-stu-id="deb01-335">Dan co-authored Professional Windows DNA (Wrox), ASP.NET: Tips, Tutorials and Code (Sams), ASP.NET 1.1 Insider Solutions, Professional ASP.NET 2.0 AJAX (Wrox), ASP.NET 2.0 MVP Hacks and authored XML for ASP.NET Developers (Sams).</span></span> <span data-ttu-id="deb01-336">Když není psaní kódu, článků nebo knih, Dan, požívá psaní a zaznamenávání hudby a hraní Golfů a basketbalový s jeho manželkou a dětem.</span><span class="sxs-lookup"><span data-stu-id="deb01-336">When he's not writing code, articles or books, Dan enjoys writing and recording music and playing golf and basketball with his wife and kids.</span></span>

<span data-ttu-id="deb01-337">Scott Cate spolupracuje s webovými technologiemi Microsoftu od 1997 a je prezidentem myKB.com ([www.myKB.com](http://www.myKB.com)), kde se specializuje při psaní aplikací založených na ASP.NET zaměřené na softwarová řešení ve znalostní bázi Knowledge Base.</span><span class="sxs-lookup"><span data-stu-id="deb01-337">Scott Cate has been working with Microsoft Web technologies since 1997 and is the President of myKB.com ([www.myKB.com](http://www.myKB.com)) where he specializes in writing ASP.NET based applications focused on Knowledge Base Software solutions.</span></span> <span data-ttu-id="deb01-338">Scott se dá kontaktovat e-mailem na [scott.cate@myKB.com](mailto:scott.cate@myKB.com) blogu nebo jeho blogu na adrese [ScottCate.com](http://ScottCate.com) .</span><span class="sxs-lookup"><span data-stu-id="deb01-338">Scott can be contacted via email at [scott.cate@myKB.com](mailto:scott.cate@myKB.com) or his blog at [ScottCate.com](http://ScottCate.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="deb01-339">[Předchozí](understanding-asp-net-ajax-localization.md) 
>  [Další](understanding-asp-net-ajax-debugging-capabilities.md)</span><span class="sxs-lookup"><span data-stu-id="deb01-339">[Previous](understanding-asp-net-ajax-localization.md)
[Next](understanding-asp-net-ajax-debugging-capabilities.md)</span></span>
