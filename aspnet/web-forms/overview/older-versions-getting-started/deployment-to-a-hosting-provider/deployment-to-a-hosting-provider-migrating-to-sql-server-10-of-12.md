---
uid: web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12
title: 'Nasazení webové aplikace v ASP.NET pomocí SQL Server Compact sady Visual Studio nebo Visual Web Developer: migrace na SQL Server-10 z 12 | Microsoft Docs'
author: tdykstra
description: V této sérii kurzů se dozvíte, jak nasadit (publikovat) projekt webové aplikace ASP.NET, který obsahuje databázi SQL Server Compact pomocí sady Visual Stu...
ms.author: riande
ms.date: 11/17/2011
ms.assetid: a89d6f32-b71b-4036-8ff7-5f8ac2a6eca8
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12
msc.type: authoredcontent
ms.openlocfilehash: c5281a42596d95e725b32e652c75785abe0fd64e
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/28/2019
ms.locfileid: "74640587"
---
# <a name="deploying-an-aspnet-web-application-with-sql-server-compact-using-visual-studio-or-visual-web-developer-migrating-to-sql-server---10-of-12"></a><span data-ttu-id="a6e0f-103">Nasazení webové aplikace v ASP.NET pomocí SQL Server Compact sady Visual Studio nebo Visual Web Developer: migrace na SQL Server-10 z 12</span><span class="sxs-lookup"><span data-stu-id="a6e0f-103">Deploying an ASP.NET Web Application with SQL Server Compact using Visual Studio or Visual Web Developer: Migrating to SQL Server - 10 of 12</span></span>

<span data-ttu-id="a6e0f-104">tím, že [Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="a6e0f-105">Stáhnout počáteční projekt</span><span class="sxs-lookup"><span data-stu-id="a6e0f-105">Download Starter Project</span></span>](https://code.msdn.microsoft.com/Deploying-an-ASPNET-Web-4e31366b)

> <span data-ttu-id="a6e0f-106">V této sérii kurzů se dozvíte, jak nasadit (publikovat) projekt webové aplikace ASP.NET, který obsahuje databázi SQL Server Compact pomocí sady Visual Studio 2012 RC nebo Visual Studio Express 2012 RC pro web.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-106">This series of tutorials shows you how to deploy (publish) an ASP.NET web application project that includes a SQL Server Compact database by using Visual Studio 2012 RC or Visual Studio Express 2012 RC for Web.</span></span> <span data-ttu-id="a6e0f-107">Můžete také použít Visual Studio 2010, pokud nainstalujete aktualizaci publikování na webu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-107">You can also use Visual Studio 2010 if you install the Web Publish Update.</span></span> <span data-ttu-id="a6e0f-108">Úvod k řadě najdete v [prvním kurzu v řadě](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="a6e0f-108">For an introduction to the series, see [the first tutorial in the series](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span></span>
> 
> <span data-ttu-id="a6e0f-109">Kurz, který ukazuje funkce nasazení představené po vydání RC sady Visual Studio 2012, ukazuje, jak nasadit SQL Server edice jiné než SQL Server Compact a ukazuje, jak nasadit na Azure App Service Web Apps, v tématu [nasazení webu ASP.NET pomocí sady Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span><span class="sxs-lookup"><span data-stu-id="a6e0f-109">For a tutorial that shows deployment features introduced after the RC release of Visual Studio 2012, shows how to deploy SQL Server editions other than SQL Server Compact, and shows how to deploy to Azure App Service Web Apps, see [ASP.NET Web Deployment using Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span></span>

## <a name="overview"></a><span data-ttu-id="a6e0f-110">Přehled</span><span class="sxs-lookup"><span data-stu-id="a6e0f-110">Overview</span></span>

<span data-ttu-id="a6e0f-111">V tomto kurzu se dozvíte, jak migrovat z SQL Server Compact na SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-111">This tutorial shows you how to migrate from SQL Server Compact to SQL Server.</span></span> <span data-ttu-id="a6e0f-112">Jedním z důvodů, které byste mohli chtít udělat, je využití funkcí SQL Server, které SQL Server Compact nepodporuje, jako jsou uložené procedury, triggery, zobrazení nebo replikace.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-112">One reason you might want to do that is to take advantage of SQL Server features that SQL Server Compact does not support, such as stored procedures, triggers, views, or replication.</span></span> <span data-ttu-id="a6e0f-113">Další informace o rozdílech mezi SQL Server Compact a SQL Server najdete v kurzu [nasazení SQL Server Compact](deployment-to-a-hosting-provider-deploying-sql-server-compact-databases-2-of-12.md) .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-113">For more information about the differences between SQL Server Compact and SQL Server, see the [Deploying SQL Server Compact](deployment-to-a-hosting-provider-deploying-sql-server-compact-databases-2-of-12.md) tutorial.</span></span>

### <a name="sql-server-express-versus-full-sql-server-for-development"></a><span data-ttu-id="a6e0f-114">SQL Server Express versus úplný SQL Server pro vývoj</span><span class="sxs-lookup"><span data-stu-id="a6e0f-114">SQL Server Express versus full SQL Server for Development</span></span>

<span data-ttu-id="a6e0f-115">Až se rozhodnete upgradovat na SQL Server, můžete ve svém vývojovém a testovacím prostředí používat SQL Server nebo SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-115">Once you've decided to upgrade to SQL Server, you might want to use SQL Server or SQL Server Express in your development and test environments.</span></span> <span data-ttu-id="a6e0f-116">Kromě rozdílů v podpoře nástrojů a funkcích databázového stroje existují rozdíly mezi implementacemi poskytovatele mezi SQL Server Compact a dalšími verzemi SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-116">In addition to the differences in tool support and in database engine features, there are differences in provider implementations between SQL Server Compact and other versions of SQL Server.</span></span> <span data-ttu-id="a6e0f-117">Tyto rozdíly mohou způsobit, že stejný kód generuje různé výsledky.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-117">These differences can cause the same code to generate different results.</span></span> <span data-ttu-id="a6e0f-118">Proto pokud se rozhodnete zachovat SQL Server Compact jako vývojovou databázi, měli byste web důkladně otestovat v SQL Server nebo SQL Server Express v testovacím prostředí před každým nasazením do produkčního prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-118">Therefore, if you decide to keep SQL Server Compact as your development database, you should thoroughly test your site in SQL Server or SQL Server Express in a test environment before each deployment to production.</span></span>

<span data-ttu-id="a6e0f-119">Na rozdíl od SQL Server Compact SQL Server Express je v podstatě stejný databázový stroj a používá stejného poskytovatele .NET jako úplný SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-119">Unlike SQL Server Compact, SQL Server Express is essentially the same database engine and uses the same .NET provider as full SQL Server.</span></span> <span data-ttu-id="a6e0f-120">Při testování pomocí SQL Server Express si můžete být jistí, že budete mít stejné výsledky jako v SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-120">When you test with SQL Server Express, you can be confident of getting the same results as you will with SQL Server.</span></span> <span data-ttu-id="a6e0f-121">Většinu stejných databázových nástrojů můžete používat s SQL Server Express, které můžete použít s SQL Server (významnou výjimkou [SQL Server Profiler](https://msdn.microsoft.com/library/ms181091.aspx)), a podporuje další funkce SQL Server, jako jsou uložené procedury, zobrazení, aktivační události a replikace.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-121">You can use most of the same database tools with SQL Server Express that you can use with SQL Server (a notable exception being [SQL Server Profiler](https://msdn.microsoft.com/library/ms181091.aspx)), and it supports other features of SQL Server like stored procedures, views, triggers, and replication.</span></span> <span data-ttu-id="a6e0f-122">(Na produkčním webu ale obvykle musíte použít úplnou SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-122">(You typically have to use full SQL Server in a production website, however.</span></span> <span data-ttu-id="a6e0f-123">SQL Server Express lze spustit ve sdíleném hostitelském prostředí, ale není pro něj navrženo a mnoho poskytovatelů hostingu je nepodporuje.)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-123">SQL Server Express can run in a shared hosting environment, but it was not designed for that, and many hosting providers do not support it.)</span></span>

<span data-ttu-id="a6e0f-124">Pokud používáte Visual Studio 2012, obvykle pro vývojové prostředí zvolíte SQL Server Express LocalDB, protože to je to, co je ve výchozím nastavení nainstalováno v aplikaci Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-124">If you are using Visual Studio 2012, you typically choose SQL Server Express LocalDB for your development environment because that is what is installed by default with Visual Studio.</span></span> <span data-ttu-id="a6e0f-125">LocalDB ale ve službě IIS nefunguje, takže pro vaše testovací prostředí musíte použít buď SQL Server, nebo SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-125">However, LocalDB does not work in IIS, so for your test environment you have to use either SQL Server or SQL Server Express.</span></span>

### <a name="combining-databases-versus-keeping-them-separate"></a><span data-ttu-id="a6e0f-126">Kombinování databází a jejich oddělené zachování</span><span class="sxs-lookup"><span data-stu-id="a6e0f-126">Combining Databases versus Keeping Them Separate</span></span>

<span data-ttu-id="a6e0f-127">Aplikace Contoso University má dvě databáze SQL Server Compact: databáze členství (*ASPNET. sdf*) a aplikační databáze (*School. sdf*).</span><span class="sxs-lookup"><span data-stu-id="a6e0f-127">The Contoso University application has two SQL Server Compact databases: the membership database (*aspnet.sdf*) and the application database (*School.sdf*).</span></span> <span data-ttu-id="a6e0f-128">Při migraci můžete tyto databáze migrovat do dvou samostatných databází nebo do jediné databáze.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-128">When you migrate, you can migrate these databases to two separate databases or to a single database.</span></span> <span data-ttu-id="a6e0f-129">Možná je budete chtít kombinovat, aby bylo možné mezi databází aplikace a databází členství usnadnit spojení s databázemi.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-129">You might want to combine them in order to facilitate database joins between your application database and your membership database.</span></span> <span data-ttu-id="a6e0f-130">Váš plán hostování může také poskytnout důvod, jak je kombinovat.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-130">Your hosting plan might also provide a reason to combine them.</span></span> <span data-ttu-id="a6e0f-131">Poskytovatel hostingu může například účtovat více databází více nebo nemusí dokonce umožňovat více než jednu databázi.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-131">For example, the hosting provider might charge more for multiple databases or might not even allow more than one database.</span></span> <span data-ttu-id="a6e0f-132">V tomto případě se jedná o hostitelský účet Cytanium Lite, který se používá pro tento kurz, který umožňuje pouze jednu databázi SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-132">That's the case with the Cytanium Lite hosting account that's used for this tutorial, which allows only a single SQL Server database.</span></span>

<span data-ttu-id="a6e0f-133">V tomto kurzu migrujete své dvě databáze tímto způsobem:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-133">In this tutorial, you'll migrate your two databases this way:</span></span>

- <span data-ttu-id="a6e0f-134">Migrujte na dvě databáze LocalDB ve vývojovém prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-134">Migrate to two LocalDB databases in the development environment.</span></span>
- <span data-ttu-id="a6e0f-135">Migrujte do dvou SQL Server Express databází v testovacím prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-135">Migrate to two SQL Server Express databases in the test environment.</span></span>
- <span data-ttu-id="a6e0f-136">Migrujte do jedné kombinované úplné SQL Server databáze v produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-136">Migrate to one combined full SQL Server database in the production environment.</span></span>

<span data-ttu-id="a6e0f-137">Připomenutí: Pokud se zobrazí chybová zpráva nebo něco nefunguje při procházení tohoto kurzu, zkontrolujte [stránku řešení potíží](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="a6e0f-137">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the [troubleshooting page](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span></span>

## <a name="installing-sql-server-express"></a><span data-ttu-id="a6e0f-138">Instalace SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="a6e0f-138">Installing SQL Server Express</span></span>

<span data-ttu-id="a6e0f-139">Ve výchozím nastavení je SQL Server Express automaticky nainstalován v aplikaci Visual Studio 2010, ale ve výchozím nastavení není nainstalována společně se sadou Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-139">SQL Server Express is automatically installed by default with Visual Studio 2010, but by default it is not installed with Visual Studio 2012.</span></span> <span data-ttu-id="a6e0f-140">Pokud chcete nainstalovat SQL Server 2012 Express, klikněte na následující odkaz.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-140">To install SQL Server 2012 Express, click the following link</span></span>

- [<span data-ttu-id="a6e0f-141">SQL Server Express 2012</span><span class="sxs-lookup"><span data-stu-id="a6e0f-141">SQL Server Express 2012</span></span>](https://www.microsoft.com/download/details.aspx?id=29062)

<span data-ttu-id="a6e0f-142">Vyberte možnost *CSY/x64/SQLEXPR\_x64\_CSY. exe* nebo *CSY/x86/SQLEXPR\_x86\_CSY. exe*a v Průvodci instalací přijměte výchozí nastavení.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-142">Choose *ENU/x64/SQLEXPR\_x64\_ENU.exe* or *ENU/x86/SQLEXPR\_x86\_ENU.exe*, and in the installation wizard accept the default settings.</span></span> <span data-ttu-id="a6e0f-143">Další informace o možnostech instalace najdete v tématu [instalace SQL Server 2012 v Průvodci instalací (nastavení)](https://msdn.microsoft.com/library/ms143219.aspx).</span><span class="sxs-lookup"><span data-stu-id="a6e0f-143">For more information about installation options, see [Install SQL Server 2012 from the Installation Wizard (Setup)](https://msdn.microsoft.com/library/ms143219.aspx).</span></span>

## <a name="creating-sql-server-express-databases-for-the-test-environment"></a><span data-ttu-id="a6e0f-144">Vytváření databází SQL Server Express pro testovací prostředí</span><span class="sxs-lookup"><span data-stu-id="a6e0f-144">Creating SQL Server Express Databases for the Test Environment</span></span>

<span data-ttu-id="a6e0f-145">Dalším krokem je vytvoření databáze členství v ASP.NET a školních databází.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-145">The next step is to create the ASP.NET membership and School databases.</span></span>

<span data-ttu-id="a6e0f-146">V nabídce **zobrazení** vyberte **Průzkumník serveru** (**Průzkumník databáze** ve Visual Web Developer) a pak klikněte pravým tlačítkem na **datová připojení** a vyberte **vytvořit novou databázi SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-146">From the **View** menu select **Server Explorer** (**Database Explorer** in Visual Web Developer), and then right-click **Data Connections** and select **Create New SQL Server Database**.</span></span>

![Selecting_Create_New_SQL_Server_Database](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image1.png)

<span data-ttu-id="a6e0f-148">V dialogovém okně **vytvořit novou databázi SQL Server** do pole **název serveru** zadejte ".\SQLEXPRESS" a do pole název **nového databáze** zadejte "ASPNET-test" a pak klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-148">In the **Create New SQL Server Database** dialog box, enter ".\SQLExpress" in the **Server name** box and "aspnet-Test" in the **New database name** box, then click **OK**.</span></span>

![Create_New_SQL_Server_Database_aspnet](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image2.png)

<span data-ttu-id="a6e0f-150">Použijte stejný postup k vytvoření nové databáze SQL Server Express School s názvem "School-test".</span><span class="sxs-lookup"><span data-stu-id="a6e0f-150">Follow the same procedure to create a new SQL Server Express School database named "School-Test".</span></span>

<span data-ttu-id="a6e0f-151">(K těmto názvům databází připojujete "test", protože později vytvoříte další instanci každé databáze pro vývojové prostředí a potřebujete být schopni odlišit tyto dvě sady databází.)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-151">(You're appending "Test" to these database names because later you'll create an additional instance of each database for the development environment, and you need to be able to differentiate the two sets of databases.)</span></span>

<span data-ttu-id="a6e0f-152">**Průzkumník serveru** nyní zobrazuje dvě nové databáze.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-152">**Server Explorer** now shows the two new databases.</span></span>

![New_databases_in_Server_Explorer](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image3.png)

## <a name="creating-a-grant-script-for-the-new-databases"></a><span data-ttu-id="a6e0f-154">Vytvoření skriptu pro udělení pro nové databáze</span><span class="sxs-lookup"><span data-stu-id="a6e0f-154">Creating a Grant Script for the New Databases</span></span>

<span data-ttu-id="a6e0f-155">Když aplikace běží ve službě IIS na vývojovém počítači, aplikace přistupuje k databázi pomocí výchozích přihlašovacích údajů fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-155">When the application runs in IIS on your development computer, the application accesses the database by using the default application pool's credentials.</span></span> <span data-ttu-id="a6e0f-156">Ve výchozím nastavení ale identita fondu aplikací nemá oprávnění k otevření databází.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-156">However, by default, the application pool identity does not have permission to open the databases.</span></span> <span data-ttu-id="a6e0f-157">Proto je nutné spustit skript pro udělení tohoto oprávnění.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-157">So you have to run a script to grant that permission.</span></span> <span data-ttu-id="a6e0f-158">V této části vytvoříte skript, který později spustíte, abyste se ujistili, že aplikace může otevírat databáze při spuštění ve službě IIS.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-158">In this section you create the script that you'll run later to make sure that the application can open the databases when it runs in IIS.</span></span>

<span data-ttu-id="a6e0f-159">Ve složce *SolutionFiles* řešení, kterou jste vytvořili v kurzu [nasazení do provozního prostředí](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) , vytvořte nový soubor SQL s názvem *grant. SQL*.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-159">In the solution's *SolutionFiles* folder that you created in the [Deploying to the Production Environment](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) tutorial, create a new SQL file named *Grant.sql*.</span></span> <span data-ttu-id="a6e0f-160">Zkopírujte následující příkazy SQL do souboru a pak soubor uložte a zavřete:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-160">Copy the following SQL commands into the file, and then save and close the file:</span></span>

[!code-sql[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample1.sql)]

> [!NOTE]
> <span data-ttu-id="a6e0f-161">Tento skript je navržený tak, aby fungoval s SQL Server 2008 a s nastavením služby IIS v systému Windows 7, jak jsou uvedeny v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-161">This script is designed to work with SQL Server 2008 and with the IIS settings in Windows 7 as they are specified in this tutorial.</span></span> <span data-ttu-id="a6e0f-162">Pokud používáte jinou verzi SQL Server nebo Windows nebo pokud jste v počítači nastavili službu IIS odlišně, může se stát, že se budou vyžadovat změny v tomto skriptu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-162">If you're using a different version of SQL Server or of Windows, or if you set up IIS on your computer differently, changes to this script might be required.</span></span> <span data-ttu-id="a6e0f-163">Další informace o SQL Server skriptů naleznete v tématu [SQL Server Books Online](https://go.microsoft.com/fwlink/?LinkId=132511).</span><span class="sxs-lookup"><span data-stu-id="a6e0f-163">For more information about SQL Server scripts, see [SQL Server Books Online](https://go.microsoft.com/fwlink/?LinkId=132511).</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="a6e0f-164">**Poznámka k zabezpečení** Tento skript uděluje uživateli oprávnění\_oprávnění vlastníka, který přistupuje k databázi v době běhu, což je to, co budete mít v produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-164">**Security Note** This script gives db\_owner permissions to the user that accesses the database at run time, which is what you'll have in the production environment.</span></span> <span data-ttu-id="a6e0f-165">V některých případech můžete chtít zadat uživatele, který má úplná oprávnění aktualizace schématu databáze jenom pro nasazení, a určit dobu běhu jiného uživatele, který má oprávnění jenom pro čtení a zápis dat.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-165">In some scenarios you might want to specify a user that has full database schema update permissions only for deployment, and specify for run time a different user that has permissions only to read and write data.</span></span> <span data-ttu-id="a6e0f-166">Další informace najdete v tématu **Kontrola automatických změn souboru Web. config pro migrace Code First** při [nasazení do služby IIS jako testovací prostředí](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="a6e0f-166">For more information, see **Reviewing the Automatic Web.config Changes for Code First Migrations** in [Deploying to IIS as a Test Environment](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12.md).</span></span>

## <a name="configuring-database-deployment-for-the-test-environment"></a><span data-ttu-id="a6e0f-167">Konfigurace nasazení databáze pro testovací prostředí</span><span class="sxs-lookup"><span data-stu-id="a6e0f-167">Configuring Database Deployment for the Test Environment</span></span>

<span data-ttu-id="a6e0f-168">Dále nakonfigurujete aplikaci Visual Studio tak, aby provede následující úlohy pro každou databázi:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-168">Next, you'll configure Visual Studio so that it will do the following tasks for each database:</span></span>

- <span data-ttu-id="a6e0f-169">Vygenerujte skript SQL, který vytvoří strukturu zdrojové databáze (tabulky, sloupce, omezení atd.) v cílové databázi.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-169">Generate a SQL script that creates the source database's structure (tables, columns, constraints, etc.) in the destination database.</span></span>
- <span data-ttu-id="a6e0f-170">Vygenerujte skript SQL, který vloží data zdrojové databáze do tabulek v cílové databázi.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-170">Generate a SQL script that inserts the source database's data into the tables in the destination database.</span></span>
- <span data-ttu-id="a6e0f-171">V cílové databázi spusťte vygenerované skripty a vytvořený skript pro udělení.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-171">Run the generated scripts, and the Grant script that you created, in the destination database.</span></span>

<span data-ttu-id="a6e0f-172">Otevřete okno **Vlastnosti projektu** a vyberte kartu **balíček/publikovat SQL** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-172">Open the **Project Properties** window and select the **Package/Publish SQL** tab.</span></span>

<span data-ttu-id="a6e0f-173">Ujistěte se, že je v rozevíracím seznamu **Konfigurace** vybraná možnost **aktivní (vydaná verze)** nebo **vydaná verze** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-173">Make sure that **Active (Release)** or **Release** is selected in the **Configuration** drop-down list.</span></span>

<span data-ttu-id="a6e0f-174">Klikněte na **Povolit tuto stránku**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-174">Click **Enable this Page**.</span></span>

![Package_Publish_SQL_tab_Enable_This_page](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image4.png)

<span data-ttu-id="a6e0f-176">Karta **Balení/publikování kódu SQL** je obvykle zakázaná, protože specifikuje starší metodu nasazení.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-176">The **Package/Publish SQL** tab is normally disabled because it specifies a legacy deployment method.</span></span> <span data-ttu-id="a6e0f-177">Ve většině scénářů byste měli nakonfigurovat nasazení databáze v průvodci **publikování webu** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-177">For most scenarios, you should configure database deployment in the **Publish Web** wizard.</span></span> <span data-ttu-id="a6e0f-178">Migrace z SQL Server Compact na SQL Server nebo SQL Server Express je zvláštní případ, pro který je tato metoda dobrá volbou.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-178">Migrating from SQL Server Compact to SQL Server or SQL Server Express is a special case for which this method is a good choice.</span></span>

<span data-ttu-id="a6e0f-179">Klikněte na **Importovat ze souboru Web. config**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-179">Click **Import from Web.config**.</span></span>

![Selecting_Import_from_Web. config](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image5.png)

<span data-ttu-id="a6e0f-181">Visual Studio hledá připojovací řetězce v souboru *Web. config* , najde jednu pro databázi členství a jednu pro databázi školy a přidá do tabulky **databázových záznamů** řádek odpovídající každému připojovacímu řetězci.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-181">Visual Studio looks for connection strings in the *Web.config* file, finds one for the membership database and one for the School database, and adds a row corresponding to each connection string in the **Database Entries** table.</span></span> <span data-ttu-id="a6e0f-182">Připojovací řetězce, které najde, jsou pro existující databáze SQL Server Compact a vaším dalším krokem bude nakonfigurovat, jak a kde tyto databáze nasadit.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-182">The connection strings it finds are for the existing SQL Server Compact databases, and your next step will be to configure how and where to deploy these databases.</span></span>

<span data-ttu-id="a6e0f-183">Nastavení nasazení databáze zadáte v části **Podrobnosti o položce databáze** pod tabulkou **položky databáze** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-183">You enter database deployment settings in the **Database Entry Details** section below the **Database Entries** table.</span></span> <span data-ttu-id="a6e0f-184">Nastavení zobrazená v části **Podrobnosti o položce databáze** se vztahuje na každý řádek v tabulce **databázové položky** , jak je znázorněno na následujícím obrázku.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-184">The settings shown in the **Database Entry Details** section pertain to whichever row in the **Database Entries** table is selected, as shown in the following illustration.</span></span>

![Database_Entry_Details_section_of_Package_Publish_SQL_tab](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image6.png)

### <a name="configuring-deployment-settings-for-the-membership-database"></a><span data-ttu-id="a6e0f-186">Konfigurace nastavení nasazení pro databázi členství</span><span class="sxs-lookup"><span data-stu-id="a6e0f-186">Configuring Deployment Settings for the Membership Database</span></span>

<span data-ttu-id="a6e0f-187">V tabulce **položky databáze** vyberte řádek **DefaultConnection-Deployment** , abyste mohli konfigurovat nastavení, která se vztahují na databázi členství.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-187">Select the **DefaultConnection-Deployment** row in the **Database Entries** table in order to configure settings that apply to the membership database.</span></span>

<span data-ttu-id="a6e0f-188">Do pole **připojovací řetězec pro cílovou databázi**zadejte připojovací řetězec, který odkazuje na novou SQL Server Express databázi členství.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-188">In **Connection string for destination database**, enter a connection string that points to the new SQL Server Express membership database.</span></span> <span data-ttu-id="a6e0f-189">Připojovací řetězec, který potřebujete, můžete získat z **Průzkumník serveru**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-189">You can get the connection string you need from **Server Explorer**.</span></span> <span data-ttu-id="a6e0f-190">V **Průzkumník serveru**rozbalte položku **datová připojení** a vyberte databázi **AspnetTest** a potom v okně **vlastnosti** Zkopírujte hodnotu **připojovacího řetězce** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-190">In **Server Explorer**, expand **Data Connections** and select the **aspnetTest** database, then from the **Properties** window copy the **Connection String** value.</span></span>

![aspnet_connection_string_in_Server_Explorer](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image7.png)

<span data-ttu-id="a6e0f-192">Do této části se vytvoří stejný připojovací řetězec:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-192">The same connection string is reproduced here:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample2.cmd)]

<span data-ttu-id="a6e0f-193">Tento připojovací řetězec zkopírujte a vložte do **připojovacího řetězce pro cílovou databázi** na kartě **Package/Publish SQL** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-193">Copy and paste this connection string into **Connection string for destination database** in the **Package/Publish SQL** tab.</span></span>

<span data-ttu-id="a6e0f-194">Ujistěte se, že je vybraná možnost **načíst data nebo schéma z existující databáze** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-194">Make sure that **Pull data and/or schema from an existing database** is selected.</span></span> <span data-ttu-id="a6e0f-195">To způsobuje, že se skripty SQL automaticky vygenerovaly a spustí v cílové databázi.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-195">This is what causes SQL scripts to be automatically generated and run in the destination database.</span></span>

<span data-ttu-id="a6e0f-196">**Připojovací řetězec pro hodnotu zdrojové databáze** je extrahován ze souboru *Web. config* a odkazuje na databázi vývoje SQL Server Compact.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-196">The **Connection string for the source database** value is extracted from the *Web.config* file and points to the development SQL Server Compact database.</span></span> <span data-ttu-id="a6e0f-197">Jedná se o zdrojovou databázi, která se použije ke generování skriptů, které se spustí později v cílové databázi.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-197">This is the source database that will be used to generate the scripts that will run later in the destination database.</span></span> <span data-ttu-id="a6e0f-198">Vzhledem k tomu, že chcete nasadit produkční verzi databáze, změňte "aspnet-Dev. sdf" na "aspnet-Prod. sdf".</span><span class="sxs-lookup"><span data-stu-id="a6e0f-198">Since you want to deploy the production version of the database, change "aspnet-Dev.sdf" to "aspnet-Prod.sdf".</span></span>

<span data-ttu-id="a6e0f-199">Změna **možností skriptování databáze** z **schématu pouze** na **schéma a data**, protože chcete kopírovat data (uživatelské účty a role) i strukturu databáze.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-199">Change **Database scripting options** from **Schema Only** to **Schema and data**, since you want to copy your data (user accounts and roles) as well as the database structure.</span></span>

<span data-ttu-id="a6e0f-200">Pokud chcete nakonfigurovat nasazení tak, aby se spouštěly skripty pro udělení, které jste vytvořili dříve, musíte je přidat do oddílu **databázové skripty** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-200">To configure deployment to run the grant scripts that you created earlier, you have to add them to the **Database Scripts** section.</span></span> <span data-ttu-id="a6e0f-201">Klikněte na **Přidat skript**a v dialogovém okně **přidat skripty SQL** přejděte do složky, kam jste uložili skript pro udělení oprávnění (Jedná se o složku, která obsahuje soubor řešení).</span><span class="sxs-lookup"><span data-stu-id="a6e0f-201">Click **Add Script**, and in the **Add SQL Scripts** dialog box, navigate to the folder where you stored the grant script (this is the folder that contains your solution file).</span></span> <span data-ttu-id="a6e0f-202">Vyberte soubor s názvem *grant. SQL*a klikněte na tlačítko **otevřít**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-202">Select the file named *Grant.sql*, and click **Open**.</span></span>

<span data-ttu-id="a6e0f-203">[![Select_File_dialog_box_grant_script](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image9.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-203">[![Select_File_dialog_box_grant_script](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image9.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image8.png)</span></span>

<span data-ttu-id="a6e0f-204">Nastavení řádku **DefaultConnection-Deployment** v **položkách databáze** teď vypadá jako na následujícím obrázku:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-204">The settings for the **DefaultConnection-Deployment** row in **Database Entries** now look like the following illustration:</span></span>

![Database_Entry_Details_for_DefaultConnection_Test](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image10.png)

### <a name="configuring-deployment-settings-for-the-school-database"></a><span data-ttu-id="a6e0f-206">Konfigurace nastavení nasazení pro školní databázi</span><span class="sxs-lookup"><span data-stu-id="a6e0f-206">Configuring Deployment Settings for the School Database</span></span>

<span data-ttu-id="a6e0f-207">V dalším kroku vyberte řádek **SchoolContext-Deployment** v tabulce **položky databáze** , aby se nakonfigurovali nastavení nasazení pro školní databázi.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-207">Next, select the **SchoolContext-Deployment** row in the **Database Entries** table in order to configure deployment settings for the School database.</span></span>

<span data-ttu-id="a6e0f-208">K získání připojovacího řetězce pro novou SQL Server Express databázi můžete použít stejnou metodu, kterou jste použili dříve.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-208">You can use the same method you used earlier to get the connection string for the new SQL Server Express database.</span></span> <span data-ttu-id="a6e0f-209">Zkopírujte tento připojovací řetězec do **připojovacího řetězce pro cílovou databázi** na kartě **Package/Publish SQL** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-209">Copy this connection string into **Connection string for destination database** in the **Package/Publish SQL** tab.</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample3.cmd)]

<span data-ttu-id="a6e0f-210">Ujistěte se, že je vybraná možnost **načíst data nebo schéma z existující databáze** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-210">Make sure that **Pull data and/or schema from an existing database** is selected.</span></span>

<span data-ttu-id="a6e0f-211">**Připojovací řetězec pro hodnotu zdrojové databáze** je extrahován ze souboru *Web. config* a odkazuje na databázi vývoje SQL Server Compact.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-211">The **Connection string for the source database** value is extracted from the *Web.config* file and points to the development SQL Server Compact database.</span></span> <span data-ttu-id="a6e0f-212">Pokud chcete nasadit produkční verzi databáze, změňte "School-Dev. sdf" na "School-Prod. sdf".</span><span class="sxs-lookup"><span data-stu-id="a6e0f-212">Change "School-Dev.sdf" to "School-Prod.sdf" to deploy the production version of the database.</span></span> <span data-ttu-id="a6e0f-213">(Soubor School-Prod. SDF se ve složce App\_data nikdy nevytvořil, takže tento soubor zkopírujete z testovacího prostředí do složky aplikace\_data ve složce projektu ContosoUniversity později.)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-213">(You never created a School-Prod.sdf file in the App\_Data folder, so you'll copy that file from the test environment to the App\_Data folder in the ContosoUniversity project folder later.)</span></span>

<span data-ttu-id="a6e0f-214">Změna **možností skriptování databáze** na **schéma a data**</span><span class="sxs-lookup"><span data-stu-id="a6e0f-214">Change **Database scripting options** to **Schema and data**.</span></span>

<span data-ttu-id="a6e0f-215">Chcete také spustit skript, který uděluje oprávnění ke čtení a zápisu této databáze k identitě fondu aplikací, proto přidejte soubor skriptu *grant. SQL* jako u databáze členství.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-215">You also want to run the script to grant read and write permission for this database to the application pool identity, so add the *Grant.sql* script file as you did for the membership database.</span></span>

<span data-ttu-id="a6e0f-216">Až skončíte, nastavení řádku **SchoolContext-Deployment** v **položkách databáze** budou vypadat jako na následujícím obrázku:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-216">When you're done, the settings for the **SchoolContext-Deployment** row in **Database Entries** look like the following illustration:</span></span>

![Database_Entry_Details_for_SchoolContext_Test](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image11.png)

<span data-ttu-id="a6e0f-218">Uložte změny na kartě **Package/PUBLISH SQL** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-218">Save the changes to the **Package/Publish SQL** tab.</span></span>

<span data-ttu-id="a6e0f-219">Zkopírujte soubor *School-prod. sdf* z složky *c:\inetpub\wwwroot\ContosoUniversity\App\_dat* do složky *App\_data* v projektu ContosoUniversity.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-219">Copy the *School-Prod.sdf* file from the *c:\inetpub\wwwroot\ContosoUniversity\App\_Data* folder to the *App\_Data* folder in the ContosoUniversity project.</span></span>

### <a name="specifying-transacted-mode-for-the-grant-script"></a><span data-ttu-id="a6e0f-220">Určení transakčního režimu pro skript udělení</span><span class="sxs-lookup"><span data-stu-id="a6e0f-220">Specifying Transacted Mode for the Grant Script</span></span>

<span data-ttu-id="a6e0f-221">Proces nasazení generuje skripty, které nasazují schéma databáze a data.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-221">The deployment process generates scripts that deploy the database schema and data.</span></span> <span data-ttu-id="a6e0f-222">Ve výchozím nastavení se tyto skripty spouštějí v transakci.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-222">By default, these scripts run in a transaction.</span></span> <span data-ttu-id="a6e0f-223">Vlastní skripty (jako skripty pro udělení) ale ve výchozím nastavení neběží v transakci.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-223">However, custom scripts (like the grant scripts) by default do not run in a transaction.</span></span> <span data-ttu-id="a6e0f-224">Pokud proces nasazení smíchá režimy transakce, může při spuštění skriptu při nasazení dojít k chybě časového limitu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-224">If the deployment process mixes transaction modes, you might get a timeout error when the scripts run during deployment.</span></span> <span data-ttu-id="a6e0f-225">V této části upravíte soubor projektu, aby bylo možné nakonfigurovat vlastní skripty pro spuštění v transakci.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-225">In this section, you edit the project file in order to configure the custom scripts to run in a transaction.</span></span>

<span data-ttu-id="a6e0f-226">V **Průzkumník řešení**klikněte pravým tlačítkem myši na projekt **ContosoUniversity** a vyberte **Uvolnit projekt**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-226">In **Solution Explorer**, right-click the **ContosoUniversity** project and select **Unload Project**.</span></span>

![Unload_Project_in_Solution_Explorer](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image12.png)

<span data-ttu-id="a6e0f-228">Pak znovu klikněte pravým tlačítkem na projekt a vyberte **Upravit ContosoUniversity. csproj**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-228">Then right-click the project again and select **Edit ContosoUniversity.csproj**.</span></span>

![Edit_Project_in_Solution_Explorer](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image13.png)

<span data-ttu-id="a6e0f-230">Editor sady Visual Studio zobrazuje obsah XML souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-230">The Visual Studio editor shows you the XML content of the project file.</span></span> <span data-ttu-id="a6e0f-231">Všimněte si, že existuje několik prvků `PropertyGroup`.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-231">Notice that there are several `PropertyGroup` elements.</span></span> <span data-ttu-id="a6e0f-232">(V imagi byl obsah prvků `PropertyGroup` vynechán.)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-232">(In the image, the contents of the `PropertyGroup` elements have been omitted.)</span></span>

![Okno editoru souboru projektu](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image15.png)

<span data-ttu-id="a6e0f-234">První z nich, který nemá atribut `Condition`, je pro nastavení, která platí bez ohledu na konfiguraci sestavení.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-234">The first one, which has no `Condition` attribute, is for settings that apply regardless of build configuration.</span></span> <span data-ttu-id="a6e0f-235">Jeden `PropertyGroup` element se vztahuje pouze na konfiguraci sestavení ladění (Všimněte si, že atribut `Condition`), jedna se vztahuje pouze na konfiguraci sestavení pro vydání a jedna se vztahuje pouze na konfiguraci sestavení testu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-235">One `PropertyGroup` element applies only to the Debug build configuration (note the `Condition` attribute), one applies only to the Release build configuration, and one applies only to the Test build configuration.</span></span> <span data-ttu-id="a6e0f-236">V elementu `PropertyGroup` pro konfiguraci sestavení pro vydání se zobrazí `PublishDatabaseSettings` prvek, který obsahuje nastavení, která jste zadali na kartě **Package/PUBLISH SQL** karta. Existuje `Object` element, který odpovídá jednotlivým zadaným skriptům udělení (Všimněte si dvou instancí "Grant. SQL").</span><span class="sxs-lookup"><span data-stu-id="a6e0f-236">Within the `PropertyGroup` element for the Release build configuration, you'll see a `PublishDatabaseSettings` element that contains the settings you entered on the **Package/Publish SQL** tab. There is an `Object` element that corresponds to each of the grant scripts you specified (notice the two instances of "Grant.sql").</span></span> <span data-ttu-id="a6e0f-237">Ve výchozím nastavení je `Transacted` atribut `Source` elementu pro každý skript pro udělení `False`.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-237">By default, the `Transacted` attribute of the `Source` element for each grant script is `False`.</span></span>

![Transacted_false](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image16.png)

<span data-ttu-id="a6e0f-239">Změňte hodnotu atributu `Transacted` elementu `Source` na `True`.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-239">Change the value of the `Transacted` attribute of the `Source` element to `True`.</span></span>

![Transacted_true](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image17.png)

<span data-ttu-id="a6e0f-241">Uložte a zavřete soubor projektu a pak klikněte pravým tlačítkem na projekt v **Průzkumník řešení** a vyberte **znovu načíst projekt**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-241">Save and close the project file, and then right-click the project in **Solution Explorer** and select **Reload Project**.</span></span>

![Reload_project](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image18.png)

## <a name="setting-up-webconfig-transformations-for-the-connection-strings"></a><span data-ttu-id="a6e0f-243">Nastavení transformací Web. config pro připojovací řetězce</span><span class="sxs-lookup"><span data-stu-id="a6e0f-243">Setting up Web.Config Transformations for the Connection Strings</span></span>

<span data-ttu-id="a6e0f-244">Připojovací řetězce pro nové databáze SQL Express, které jste zadali na kartě **Balení/publikování kódu SQL** , jsou používány nasazení webu pouze pro aktualizaci cílové databáze během nasazení.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-244">The connection strings for the new SQL Express databases that you entered on the **Package/Publish SQL** tab are used by Web Deploy only for updating the destination database during deployment.</span></span> <span data-ttu-id="a6e0f-245">Je stále nutné nastavit transformace *souboru Web. config* tak, aby připojovací řetězce v nasazeném souboru *Web. config* odkazovaly na nové databáze SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-245">You still have to set up *Web.config* transformations so that the connection strings in the deployed *Web.config* file point to the new SQL Server Express databases.</span></span> <span data-ttu-id="a6e0f-246">(Při použití karty **balíček/publikovat SQL** nemůžete konfigurovat připojovací řetězce v profilu publikování.)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-246">(When you use the **Package/Publish SQL** tab, you can't configure connection strings in the publish profile.)</span></span>

<span data-ttu-id="a6e0f-247">Otevřete *Web. test. config* a v následujícím příkladu nahraďte element `connectionStrings` prvkem `connectionStrings`.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-247">Open *Web.Test.config* and replace the `connectionStrings` element with the `connectionStrings` element in the following example.</span></span> <span data-ttu-id="a6e0f-248">(Nezapomeňte zkopírovat pouze Element connectionStrings, nikoli okolní kód, který je zde zobrazen, aby poskytoval kontext.)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-248">(Make sure you only copy the connectionStrings element, not the surrounding code that is shown here to provide context.)</span></span>

[!code-xml[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample4.xml?highlight=2-11)]

<span data-ttu-id="a6e0f-249">Tento kód způsobí, že atributy `connectionString` a `providerName` každého elementu `add` budou nahrazeny v nasazeném souboru *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-249">This code causes the `connectionString` and `providerName` attributes of each `add` element to be replaced in the deployed *Web.config* file.</span></span> <span data-ttu-id="a6e0f-250">Tyto připojovací řetězce nejsou totožné s těmi, které jste zadali na kartě **Package/PUBLISH SQL** karta. Nastavení "MultipleActiveResultSets = True" bylo přidáno do těchto, protože je vyžadováno pro Entity Framework a univerzálním poskytovatelům.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-250">These connection strings are not identical to the ones you entered in the **Package/Publish SQL** tab. The setting "MultipleActiveResultSets=True" has been added to them because it's required for the Entity Framework and the Universal Providers.</span></span>

## <a name="installing-sql-server-compact"></a><span data-ttu-id="a6e0f-251">Instalace SQL Server Compact</span><span class="sxs-lookup"><span data-stu-id="a6e0f-251">Installing SQL Server Compact</span></span>

<span data-ttu-id="a6e0f-252">Balíček NuGet SqlServerCompact SQL Server Compact poskytuje sestavení databázového stroje pro aplikaci Contoso University.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-252">The SqlServerCompact NuGet package provides the SQL Server Compact database engine assemblies for the Contoso University application.</span></span> <span data-ttu-id="a6e0f-253">Nyní ale nejedná se o aplikaci, ale Nasazení webu, která musí být schopna číst databáze SQL Server Compact, aby bylo možné vytvářet skripty pro spuštění v databázích SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-253">But now it is not the application but Web Deploy that must be able to read the SQL Server Compact databases, in order to create scripts to run in the SQL Server databases.</span></span> <span data-ttu-id="a6e0f-254">Pokud chcete povolit Nasazení webu čtení SQL Server Compact databází, nainstalujte SQL Server Compact na vývojovém počítači pomocí následujícího odkazu: [Microsoft SQL Server Compact 4,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=15F7C9B3-A150-4AD2-823E-E4E0DCF85DF6).</span><span class="sxs-lookup"><span data-stu-id="a6e0f-254">To enable Web Deploy to read SQL Server Compact databases, install SQL Server Compact on the development computer by using the following link: [Microsoft SQL Server Compact 4.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=15F7C9B3-A150-4AD2-823E-E4E0DCF85DF6).</span></span>

## <a name="deploying-to-the-test-environment"></a><span data-ttu-id="a6e0f-255">Nasazení do testovacího prostředí</span><span class="sxs-lookup"><span data-stu-id="a6e0f-255">Deploying to the Test Environment</span></span>

<span data-ttu-id="a6e0f-256">Aby bylo možné publikovat do testovacího prostředí, je nutné vytvořit profil publikování, který je nakonfigurován tak, aby používal kartu **Package/PUBLISH SQL** pro publikování databáze místo nastavení databáze profilu publikování.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-256">In order to publish to the Test environment, you have to create a publish profile that is configured to use the **Package/Publish SQL** tab for database publishing instead of the publish profile database settings.</span></span>

<span data-ttu-id="a6e0f-257">Nejprve odstraňte existující testovací profil.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-257">First, delete the existing Test profile.</span></span>

<span data-ttu-id="a6e0f-258">V **Průzkumník řešení**klikněte pravým tlačítkem na projekt ContosoUniversity a klikněte na **publikovat**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-258">In **Solution Explorer**, right-click the ContosoUniversity project, and click **Publish**.</span></span>

<span data-ttu-id="a6e0f-259">Vyberte kartu **profil** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-259">Select the **Profile** tab.</span></span>

<span data-ttu-id="a6e0f-260">Klikněte na **Spravovat profily**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-260">Click **Manage Profiles**.</span></span>

<span data-ttu-id="a6e0f-261">Vyberte **test**, klikněte na **Odebrat**a pak klikněte na **Zavřít**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-261">Select **Test**, click **Remove**, and then click **Close**.</span></span>

<span data-ttu-id="a6e0f-262">Zavřete průvodce **publikováním webu** a uložte tuto změnu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-262">Close the **Publish Web** wizard to save this change.</span></span>

<span data-ttu-id="a6e0f-263">Potom vytvořte nový profil testu a použijte ho k publikování projektu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-263">Next, create a new Test profile and use it to publish the project.</span></span>

<span data-ttu-id="a6e0f-264">V **Průzkumník řešení**klikněte pravým tlačítkem na projekt ContosoUniversity a klikněte na **publikovat**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-264">In **Solution Explorer**, right-click the ContosoUniversity project, and click **Publish**.</span></span>

<span data-ttu-id="a6e0f-265">Vyberte kartu **profil** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-265">Select the **Profile** tab.</span></span>

<span data-ttu-id="a6e0f-266">V rozevíracím seznamu vyberte **&lt;nový...&gt;** a jako název profilu zadejte "test".</span><span class="sxs-lookup"><span data-stu-id="a6e0f-266">Select **&lt;New...&gt;** from the drop-down list, and enter "Test" as the profile name.</span></span>

<span data-ttu-id="a6e0f-267">Do pole **Adresa URL služby** zadejte *localhost*.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-267">In the **Service URL** box, enter *localhost*.</span></span>

<span data-ttu-id="a6e0f-268">Do pole **Web/aplikace** zadejte *Default Web site/ContosoUniversity*.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-268">In the **Site/application** box, enter *Default Web Site/ContosoUniversity*.</span></span>

<span data-ttu-id="a6e0f-269">Do pole **cílová adresa URL** zadejte `http://localhost/ContosoUniversity/`.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-269">In the **Destination URL** box, enter `http://localhost/ContosoUniversity/`.</span></span>

<span data-ttu-id="a6e0f-270">Klikněte na tlačítko **Další**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-270">Click **Next**.</span></span>

<span data-ttu-id="a6e0f-271">Karta **Nastavení** vás upozorní na to, že byla nakonfigurovaná karta **balíček/publikování SQL** , a získáte možnost je přepsat kliknutím na Povolit nová vylepšení publikování databáze.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-271">The **Settings** tab warns you that the **Package/Publish SQL** tab has been configured, and it gives you an opportunity to override them by clicking enable the new database publishing improvements.</span></span> <span data-ttu-id="a6e0f-272">Pro toto nasazení nechcete přepsat nastavení karty pro **Balení/publikování SQL** , takže stačí kliknout na **Další**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-272">For this deployment you don't want to override the **Package/Publish SQL** tab settings, so just click **Next**.</span></span>

![Publish_Web_wizard_Settings_tab_Migrate](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image19.png)

<span data-ttu-id="a6e0f-274">Zpráva na kartě **Preview** označuje, že **nejsou vybrány žádné databáze pro publikování**, ale to znamená, že publikování databáze není konfigurováno v profilu publikování.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-274">A message on the **Preview** tab indicates that **No databases are selected to publish**, but this only means that database publishing is not configured in the publish profile.</span></span>

<span data-ttu-id="a6e0f-275">Klikněte na **publikovat**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-275">Click **Publish**.</span></span>

![Publish_Web_wizard_Preview_tab_Migrate](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image20.png)

<span data-ttu-id="a6e0f-277">Visual Studio nasadí aplikaci a otevře prohlížeč na domovské stránce webu v testovacím prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-277">Visual Studio deploys the application and opens the browser to the home page of the site in the test environment.</span></span> <span data-ttu-id="a6e0f-278">Spuštěním stránky instruktory zjistíte, že se zobrazí stejná data, která jste viděli dříve.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-278">Run the Instructors page to see that it displays the same data that you saw earlier.</span></span> <span data-ttu-id="a6e0f-279">Spusťte stránku **Přidat studenty** , přidejte nového studenta a pak na stránce **Students** Zobrazte nového studenta.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-279">Run the **Add Students** page, add a new student, and then view the new student in the **Students** page.</span></span> <span data-ttu-id="a6e0f-280">Tím ověříte, že můžete databázi aktualizovat.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-280">This verifies that the you can update the database.</span></span> <span data-ttu-id="a6e0f-281">Vyberte stránku **aktualizovat kredity** (budete se muset přihlásit) a ověřte, jestli je databáze členství nasazená a máte k ní přístup.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-281">Select the **Update Credits** page (you'll need to log in) to verify that the membership database was deployed and you have access to it.</span></span>

## <a name="creating-a-sql-server-database-for-the-production-environment"></a><span data-ttu-id="a6e0f-282">Vytvoření databáze SQL Server pro produkční prostředí</span><span class="sxs-lookup"><span data-stu-id="a6e0f-282">Creating a SQL Server Database for the Production Environment</span></span>

<span data-ttu-id="a6e0f-283">Teď, když jste nasadili do testovacího prostředí, jste připraveni nastavit nasazení do produkčního prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-283">Now that you've deployed to the test environment, you're ready to set up deployment to production.</span></span> <span data-ttu-id="a6e0f-284">V rámci testovacího prostředí začínáte tím, že vytvoříte databázi, do které se nasadíte.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-284">You begin as you did for the test environment, by creating a database to deploy to.</span></span> <span data-ttu-id="a6e0f-285">Při odvolání z přehledu je plán hostování Cytanium Lite možné pouze pro jednu databázi SQL Server, takže nastavíte pouze jednu databázi, ne dvě.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-285">As you recall from the Overview, the Cytanium Lite hosting plan only allows a single SQL Server database, so you will set up only one database, not two.</span></span> <span data-ttu-id="a6e0f-286">Všechny tabulky a data z členství a školních SQL Server Compact databází budou nasazeny do jedné databáze SQL Server v produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-286">All of the tables and data from the membership and School SQL Server Compact databases will be deployed into one SQL Server database in production.</span></span>

<span data-ttu-id="a6e0f-287">V [http://panel.cytanium.com](http://panel.cytanium.com)na ovládacím panelu Cytanium.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-287">Go to the Cytanium control panel at [http://panel.cytanium.com](http://panel.cytanium.com).</span></span> <span data-ttu-id="a6e0f-288">Podržte myš nad **databázemi** a pak klikněte **SQL Server 2008**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-288">Hold the mouse over **Databases** and then click **SQL Server 2008**.</span></span>

<span data-ttu-id="a6e0f-289">[![Selecting_Databases_in_Control_Panel](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image22.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-289">[![Selecting_Databases_in_Control_Panel](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image22.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image21.png)</span></span>

<span data-ttu-id="a6e0f-290">Na stránce **SQL Server 2008** klikněte na **vytvořit databázi**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-290">In the **SQL Server 2008** page, click **Create Database**.</span></span>

<span data-ttu-id="a6e0f-291">[![Selecting_Create_Database](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image24.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-291">[![Selecting_Create_Database](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image24.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image23.png)</span></span>

<span data-ttu-id="a6e0f-292">Pojmenujte databázi "School" a klikněte na **Uložit**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-292">Name the database "School" and click **Save**.</span></span> <span data-ttu-id="a6e0f-293">(Stránka automaticky přidá předponu "contoso", takže platný název bude "contosouSchool".)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-293">(The page automatically adds the prefix "contosou", so the effective name will be "contosouSchool".)</span></span>

<span data-ttu-id="a6e0f-294">[![Naming_the_database](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image26.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-294">[![Naming_the_database](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image26.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image25.png)</span></span>

<span data-ttu-id="a6e0f-295">Na stejné stránce klikněte na **vytvořit uživatele**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-295">On the same page, click **Create User**.</span></span> <span data-ttu-id="a6e0f-296">Na serverech Cytanium se místo použití integrovaného zabezpečení systému Windows a umožnění, aby identita fondu aplikací otevřela vaši databázi, vytvoříte uživatele, který má oprávnění k otevření vaší databáze.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-296">On Cytanium's servers, rather than using integrated Windows security and letting the application pool identity open your database, you'll create a user that has authority to open your database.</span></span> <span data-ttu-id="a6e0f-297">Přidáte přihlašovací údaje uživatele do připojovacích řetězců, které se nacházejí v produkčním souboru *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-297">You'll add the user's credentials to the connection strings that go in the production *Web.config* file.</span></span> <span data-ttu-id="a6e0f-298">V tomto kroku vytvoříte tyto přihlašovací údaje.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-298">In this step you create those credentials.</span></span>

<span data-ttu-id="a6e0f-299">[![Creating_a_database_user](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image28.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-299">[![Creating_a_database_user](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image28.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image27.png)</span></span>

<span data-ttu-id="a6e0f-300">Vyplňte požadovaná pole na stránce **vlastností uživatele SQL** :</span><span class="sxs-lookup"><span data-stu-id="a6e0f-300">Fill in the required fields in the **SQL User Properties** page:</span></span>

- <span data-ttu-id="a6e0f-301">Jako název zadejte "ContosoUniversityUser".</span><span class="sxs-lookup"><span data-stu-id="a6e0f-301">Enter "ContosoUniversityUser" as the name.</span></span>
- <span data-ttu-id="a6e0f-302">Zadejte heslo.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-302">Enter a password.</span></span>
- <span data-ttu-id="a6e0f-303">Jako výchozí databázi vyberte **contosouSchool** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-303">Select **contosouSchool** as the default database.</span></span>
- <span data-ttu-id="a6e0f-304">Zaškrtněte políčko **contosouSchool** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-304">Select the **contosouSchool** check box.</span></span>

<span data-ttu-id="a6e0f-305">[![SQL_User_Properties_page](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image30.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-305">[![SQL_User_Properties_page](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image30.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image29.png)</span></span>

## <a name="configuring-database-deployment-for-the-production-environment"></a><span data-ttu-id="a6e0f-306">Konfigurace nasazení databáze pro produkční prostředí</span><span class="sxs-lookup"><span data-stu-id="a6e0f-306">Configuring Database Deployment for the Production Environment</span></span>

<span data-ttu-id="a6e0f-307">Teď jste připraveni nastavit nastavení nasazení databáze na kartě **Package/PUBLISH SQL** , stejně jako jste to předtím pro testovací prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-307">Now you're ready to set up database deployment settings in the **Package/Publish SQL** tab, as you did earlier for the test environment.</span></span>

<span data-ttu-id="a6e0f-308">Otevřete okno **Vlastnosti projektu** , vyberte kartu **Balení/publikování kódu SQL** a ujistěte se, že je v rozevíracím seznamu **Konfigurace** vybrána možnost **aktivní (verze)** nebo **vydaná verze** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-308">Open the **Project Properties** window, select the **Package/Publish SQL** tab, and make sure that **Active (Release)** or **Release** is selected in the **Configuration** drop-down list.</span></span>

<span data-ttu-id="a6e0f-309">Když nakonfigurujete nastavení nasazení pro každou databázi, je důležité rozdíl mezi tím, co v produkčním prostředí a testovacím prostředím provádíte při konfiguraci připojovacích řetězců.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-309">When you configure deployment settings for each database, the key difference between what you do for production and test environments is in how you configure connection strings.</span></span> <span data-ttu-id="a6e0f-310">V testovacím prostředí jste zadali jiné připojovací řetězce cílové databáze, ale v produkčním prostředí bude cílový připojovací řetězec pro obě databáze stejný.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-310">For the test environment you entered different destination database connection strings, but for the production environment the destination connection string will be the same for both databases.</span></span> <span data-ttu-id="a6e0f-311">Důvodem je to, že nasazujete obě databáze do jedné databáze v produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-311">This is because you are deploying both databases to one database in production.</span></span>

### <a name="configuring-deployment-settings-for-the-membership-database"></a><span data-ttu-id="a6e0f-312">Konfigurace nastavení nasazení pro databázi členství</span><span class="sxs-lookup"><span data-stu-id="a6e0f-312">Configuring Deployment Settings for the Membership Database</span></span>

<span data-ttu-id="a6e0f-313">Chcete-li konfigurovat nastavení, která se vztahují na databázi členství, vyberte řádek **DefaultConnection-Deployment** v tabulce **položky databáze** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-313">To configure settings that apply to the membership database, select the **DefaultConnection-Deployment** row in the **Database Entries** table.</span></span>

<span data-ttu-id="a6e0f-314">Do pole **připojovací řetězec pro cílovou databázi**zadejte připojovací řetězec, který odkazuje na novou produkční SQL Server databázi, kterou jste právě vytvořili.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-314">In **Connection string for destination database**, enter a connection string that points to the new production SQL Server database that you just created.</span></span> <span data-ttu-id="a6e0f-315">Připojovací řetězec můžete získat z uvítacího e-mailu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-315">You can get the connection string from your welcome email.</span></span> <span data-ttu-id="a6e0f-316">Relevantní část e-mailu obsahuje následující vzorový připojovací řetězec:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-316">The relevant part of the email contains the following sample connection string:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample5.cmd)]

<span data-ttu-id="a6e0f-317">Po nahrazení tří proměnných bude připojovací řetězec, který potřebujete, vypadat jako v tomto příkladu:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-317">After you replace the three variables, the connection string you need looks like this example:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample6.cmd)]

<span data-ttu-id="a6e0f-318">Tento připojovací řetězec zkopírujte a vložte do **připojovacího řetězce pro cílovou databázi** na kartě **Package/Publish SQL** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-318">Copy and paste this connection string into **Connection string for destination database** in the **Package/Publish SQL** tab.</span></span>

<span data-ttu-id="a6e0f-319">Ujistěte se, že je stále vybraná možnost **načíst data a schéma z existující databáze** a že **možnosti skriptování databáze** jsou stále **schémat a data**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-319">Make sure that **Pull data and/or schema from an existing database** is still selected, and that **Database scripting options** is still **Schema and Data**.</span></span>

<span data-ttu-id="a6e0f-320">V poli **databázové skripty** zrušte zaškrtnutí políčka vedle skriptu grant. SQL.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-320">In the **Database Scripts** box, clear the check box next to the Grant.sql script.</span></span>

![Disable_Grant_script](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image31.png)

### <a name="configuring-deployment-settings-for-the-school-database"></a><span data-ttu-id="a6e0f-322">Konfigurace nastavení nasazení pro školní databázi</span><span class="sxs-lookup"><span data-stu-id="a6e0f-322">Configuring Deployment Settings for the School Database</span></span>

<span data-ttu-id="a6e0f-323">V dalším kroku vyberte řádek **SchoolContext-Deployment** v tabulce **položky databáze** , aby se nakonfigurovali nastavení školní databáze.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-323">Next, select the **SchoolContext-Deployment** row in the **Database Entries** table in order to configure the School database settings.</span></span>

<span data-ttu-id="a6e0f-324">Zkopírujte stejný připojovací řetězec do **připojovacího řetězce pro cílovou databázi** , kterou jste zkopírovali do tohoto pole pro databázi členství.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-324">Copy the same connection string into **Connection string for destination database** that you copied into that field for the membership database.</span></span>

<span data-ttu-id="a6e0f-325">Ujistěte se, že je stále vybraná možnost **načíst data a schéma z existující databáze** a že **možnosti skriptování databáze** jsou stále **schémat a data**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-325">Make sure that **Pull data and/or schema from an existing database** is still selected, and that **Database scripting options** is still **Schema and Data**.</span></span>

<span data-ttu-id="a6e0f-326">V poli **databázové skripty** zrušte zaškrtnutí políčka vedle skriptu grant. SQL.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-326">In the **Database Scripts** box, clear the check box next to the Grant.sql script.</span></span>

<span data-ttu-id="a6e0f-327">Uložte změny na kartě **Package/PUBLISH SQL** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-327">Save the changes to the **Package/Publish SQL** tab.</span></span>

## <a name="setting-up-webconfig-transforms-for-the-connection-strings-to-production-databases"></a><span data-ttu-id="a6e0f-328">Nastavení transformací Web. config pro připojovací řetězce na provozní databáze</span><span class="sxs-lookup"><span data-stu-id="a6e0f-328">Setting Up Web.Config Transforms for the Connection Strings to Production Databases</span></span>

<span data-ttu-id="a6e0f-329">Dále nastavíte transformace *Web. config* tak, aby připojovací řetězce v nasazeném souboru *Web. config* odkazovaly na novou provozní databázi.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-329">Next, you'll set up *Web.config* transformations so that the connection strings in the deployed *Web.config* file to point to the new production database.</span></span> <span data-ttu-id="a6e0f-330">Připojovací řetězec, který jste zadali na kartě **Balení/publikování SQL** pro nasazení webu, který se má použít, je stejný jako aplikace, kterou je třeba použít, s výjimkou přidání možnosti `MultipleResultSets`.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-330">The connection string that you entered on the **Package/Publish SQL** tab for Web Deploy to use is the same as the one the application needs to use, except for the addition of the `MultipleResultSets` option.</span></span>

<span data-ttu-id="a6e0f-331">Otevřete *Web. produkční. config* a nahraďte `connectionStrings` element prvkem `connectionStrings`, který vypadá podobně jako v následujícím příkladu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-331">Open *Web.Production.config* and replace the `connectionStrings` element with a `connectionStrings` element that looks like the following example.</span></span> <span data-ttu-id="a6e0f-332">(Zkopírujte pouze element `connectionStrings`, nikoli okolní značky, které jsou k dispozici pro zobrazení kontextu.)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-332">(Only copy the `connectionStrings` element, not the surrounding tags that are provided to show the context.)</span></span>

[!code-xml[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample7.xml?highlight=2-11)]

<span data-ttu-id="a6e0f-333">Někdy vidíte Rady, které vám pomohou při každém zašifrování připojovacích řetězců v souboru *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-333">You sometimes see advice that tells you to always encrypt connection strings in the *Web.config* file.</span></span> <span data-ttu-id="a6e0f-334">To může být vhodné, pokud nasazujete na servery ve vaší vlastní podnikové síti.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-334">This might be appropriate if you were deploying to servers on your own company's network.</span></span> <span data-ttu-id="a6e0f-335">Pokud nasazujete do sdíleného hostitelského prostředí, ale důvěřujete bezpečnostním postupům poskytovatele hostingu a není nutné nebo praktické šifrovat připojovací řetězce.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-335">When you are deploying to a shared hosting environment, though, you're trusting the security practices of the hosting provider, and it's not necessary or practical to encrypt the connection strings.</span></span>

## <a name="deploying-to-the-production-environment"></a><span data-ttu-id="a6e0f-336">Nasazení do produkčního prostředí</span><span class="sxs-lookup"><span data-stu-id="a6e0f-336">Deploying to the Production Environment</span></span>

<span data-ttu-id="a6e0f-337">Teď jste připraveni na nasazení do produkčního prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-337">Now you're ready to deploy to production.</span></span> <span data-ttu-id="a6e0f-338">Nasazení webu načte databáze SQL Server Compact ve složce *aplikace projektu\_data* a znovu vytvoří všechny své tabulky a data v provozní SQL Server databázi.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-338">Web Deploy will read the SQL Server Compact databases in your project's *App\_Data* folder and re-create all of their tables and data in the production SQL Server database.</span></span> <span data-ttu-id="a6e0f-339">Aby bylo možné publikovat pomocí nastavení karty **balíček/publikovat web** , je nutné vytvořit nový profil publikování pro produkční prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-339">In order to publish by using the **Package/Publish Web** tab settings, you have to create a new publish profile for production.</span></span>

<span data-ttu-id="a6e0f-340">Nejdřív odstraňte existující provozní profil, protože jste předtím profil testu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-340">First, delete the existing Production profile as you did the Test profile earlier.</span></span>

<span data-ttu-id="a6e0f-341">V **Průzkumník řešení**klikněte pravým tlačítkem na projekt ContosoUniversity a klikněte na **publikovat**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-341">In **Solution Explorer**, right-click the ContosoUniversity project, and click **Publish**.</span></span>

<span data-ttu-id="a6e0f-342">Vyberte kartu **profil** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-342">Select the **Profile** tab.</span></span>

<span data-ttu-id="a6e0f-343">Klikněte na **Spravovat profily**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-343">Click **Manage Profiles**.</span></span>

<span data-ttu-id="a6e0f-344">Vyberte možnost **Výroba**, klikněte na tlačítko **Odebrat**a pak klikněte na tlačítko **Zavřít**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-344">Select **Production**, click **Remove**, and then click **Close**.</span></span>

<span data-ttu-id="a6e0f-345">Zavřete průvodce **publikováním webu** a uložte tuto změnu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-345">Close the **Publish Web** wizard to save this change.</span></span>

<span data-ttu-id="a6e0f-346">Potom vytvořte nový provozní profil a použijte ho k publikování projektu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-346">Next, create a new Production profile and use it to publish the project.</span></span>

<span data-ttu-id="a6e0f-347">V **Průzkumník řešení**klikněte pravým tlačítkem na projekt ContosoUniversity a klikněte na **publikovat**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-347">In **Solution Explorer**, right-click the ContosoUniversity project, and click **Publish**.</span></span>

<span data-ttu-id="a6e0f-348">Vyberte kartu **profil** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-348">Select the **Profile** tab.</span></span>

<span data-ttu-id="a6e0f-349">Klikněte na **importovat**a vyberte soubor. publishsettings, který jste předtím stáhli.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-349">Click **Import**, and select the .publishsettings file that you downloaded earlier.</span></span>

<span data-ttu-id="a6e0f-350">Na kartě **připojení** změňte **cílovou adresu URL** na správnou dočasnou adresu URL, která je v tomto příkladu http://contosouniversity.com.vserver01.cytanium.com.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-350">On the **Connection** tab, change the **Destination URL** to the correct temporary URL, which in this example is http://contosouniversity.com.vserver01.cytanium.com.</span></span>

<span data-ttu-id="a6e0f-351">Přejmenujte profil na produkční prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-351">Rename the profile to Production.</span></span> <span data-ttu-id="a6e0f-352">(Vyberte kartu **profil** a klikněte na **Spravovat profily** k tomu).</span><span class="sxs-lookup"><span data-stu-id="a6e0f-352">(Select the **Profile** tab and click **Manage Profiles** to do that).</span></span>

<span data-ttu-id="a6e0f-353">Zavřete průvodce **publikováním webu** a uložte provedené změny.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-353">Close the **Publish Web** wizard to save your changes.</span></span>

<span data-ttu-id="a6e0f-354">V reálné aplikaci, ve které se databáze aktualizovala v produkčním prostředí, byste teď měli před publikováním udělat ještě dva další kroky:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-354">In a real application in which the database was being updated in production, you would do two additional steps now before you publish:</span></span>

1. <span data-ttu-id="a6e0f-355">Nahrajte *aplikaci\_offline. htm*, jak je znázorněno v kurzu [nasazení do provozního prostředí](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-355">Upload *app\_offline.htm*, as shown in the [Deploying to the Production Environment](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) tutorial.</span></span>
2. <span data-ttu-id="a6e0f-356">Pomocí funkce **Správce souborů** v Ovládacích panelech Cytanium zkopírujte soubory *ASPNET-prod. sdf* a *School-prod. sdf* z produkčního webu do složky *dat aplikace\_* projektu ContosoUniversity.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-356">Use the **File Manager** feature of the Cytanium control panel to copy the *aspnet-Prod.sdf* and *School-Prod.sdf* files from the production site to the *App\_Data* folder of the ContosoUniversity project.</span></span> <span data-ttu-id="a6e0f-357">Tím se zajistí, že data, která nasazujete do nové databáze SQL Server, obsahují nejnovější aktualizace provedené vaším provozním webem.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-357">This ensures that the data you're deploying to the new SQL Server database includes the latest updates made by your production website.</span></span>

<span data-ttu-id="a6e0f-358">Na panelu nástrojů **publikování webu jedním kliknutím** ověřte, že je vybraný **produkční** profil, a pak klikněte na **publikovat**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-358">In the **Web One Click Publish** toolbar, make sure that the **Production** profile is selected, and then click **Publish**.</span></span>

<span data-ttu-id="a6e0f-359">Pokud jste před publikováním nahráli <em>aplikaci\_offline. htm</em> , je nutné použít nástroj <strong>Správce souborů</strong> v ovládacím panelu Cytanium k odstranění <em>aplikace\_offline.</em> htm před testováním.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-359">If you uploaded <em>app\_offline.htm</em> before publishing, you have to use the <strong>File Manager</strong> utility in the Cytanium control panel to delete <em>app\_offline.</em>htm before you test.</span></span> <span data-ttu-id="a6e0f-360">Zároveň můžete odstranit soubory <em>. sdf</em> ze složky <em>App\_data</em> .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-360">You can also at the same time delete the <em>.sdf</em> files from the <em>App\_Data</em> folder.</span></span>

<span data-ttu-id="a6e0f-361">Nyní můžete otevřít prohlížeč a přejít na adresu URL vašeho veřejného webu a otestovat aplikaci stejným způsobem jako po nasazení do testovacího prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-361">You can now open a browser and go to the URL of your public site to test the application the same way you did after deploying to the test environment.</span></span>

## <a name="switching-to-sql-server-express-localdb-in-development"></a><span data-ttu-id="a6e0f-362">Přechod na SQL Server Express LocalDB ve vývoji</span><span class="sxs-lookup"><span data-stu-id="a6e0f-362">Switching to SQL Server Express LocalDB in Development</span></span>

<span data-ttu-id="a6e0f-363">Jak bylo vysvětleno v přehledu, je obecně vhodné použít stejný databázový stroj ve vývoji, který používáte v testování a produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-363">As was explained in the Overview, it's generally best to use the same database engine in development that you use in test and production.</span></span> <span data-ttu-id="a6e0f-364">(Mějte na paměti, že výhodou použití SQL Server Express ve vývoji je to, že databáze bude fungovat stejně ve vývojovém, testovacím a produkčním prostředí.) V této části nastavíte projekt ContosoUniversity tak, aby používal SQL Server Express LocalDB při spuštění aplikace ze sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-364">(Remember that the advantage to using SQL Server Express in development is that the database will work the same in your development, test, and production environments.) In this section you'll set up the ContosoUniversity project to use SQL Server Express LocalDB when you run the application from Visual Studio.</span></span>

<span data-ttu-id="a6e0f-365">Nejjednodušší způsob, jak provést tuto migraci, je umožnit Code First a systém členství pro vás vytvoří nové vývojové databáze.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-365">The simplest way to perform this migration is to let Code First and the membership system create both new development databases for you.</span></span> <span data-ttu-id="a6e0f-366">Použití této metody k migraci vyžaduje tři kroky:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-366">Using this method to migrate requires three steps:</span></span>

1. <span data-ttu-id="a6e0f-367">Změnou připojovacích řetězců určete nové databáze SQL Express LocalDB.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-367">Change the connection strings to specify new SQL Express LocalDB databases.</span></span>
2. <span data-ttu-id="a6e0f-368">Spusťte nástroj pro správu webu a vytvořte uživatele s oprávněními správce.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-368">Run the Web Site Administration Tool to create an administrator user.</span></span> <span data-ttu-id="a6e0f-369">Tím se vytvoří databáze členství.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-369">This creates the membership database.</span></span>
3. <span data-ttu-id="a6e0f-370">K vytvoření a implementaci databáze aplikace použijte příkaz Migrace Code First Update-Database.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-370">Use the Code First Migrations update-database command to create and seed the application database.</span></span>

### <a name="updating-connection-strings-in-the-webconfig-file"></a><span data-ttu-id="a6e0f-371">Aktualizace připojovacích řetězců v souboru Web. config</span><span class="sxs-lookup"><span data-stu-id="a6e0f-371">Updating Connection Strings in the Web.config file</span></span>

<span data-ttu-id="a6e0f-372">Otevřete soubor *Web. config* a nahraďte `connectionStrings` element následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-372">Open the *Web.config* file and replace the `connectionStrings` element with the following code:</span></span>

[!code-xml[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample8.xml)]

### <a name="creating-the-membership-database"></a><span data-ttu-id="a6e0f-373">Vytváření databáze členství</span><span class="sxs-lookup"><span data-stu-id="a6e0f-373">Creating the Membership Database</span></span>

<span data-ttu-id="a6e0f-374">V **Průzkumník řešení**vyberte projekt ContosoUniversity a potom v nabídce **projekt** klikněte na **Konfigurace ASP.NET** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-374">In **Solution Explorer**, select the ContosoUniversity project, and then click **ASP.NET Configuration** in the **Project** menu.</span></span>

<span data-ttu-id="a6e0f-375">Vyberte kartu Zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-375">Select the Security tab.</span></span>

<span data-ttu-id="a6e0f-376">Klikněte na **vytvořit nebo spravovat role**a pak vytvořte roli **správce** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-376">Click **Create or Manage Roles**, and then create an **Administrator** role.</span></span>

<span data-ttu-id="a6e0f-377">Vraťte se na kartu zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-377">Return to the Security tab.</span></span>

<span data-ttu-id="a6e0f-378">Klikněte na **vytvořit uživatele**a potom zaškrtněte políčko **správce** a vytvořte uživatele s názvem admin.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-378">Click **Create user**, and then select the **Administrator** check box and create a user named admin.</span></span>

<span data-ttu-id="a6e0f-379">Zavřete **Nástroj pro správu**webu.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-379">Close the **Web Site Administration Tool**.</span></span>

### <a name="creating-the-school-database"></a><span data-ttu-id="a6e0f-380">Vytvoření školní databáze</span><span class="sxs-lookup"><span data-stu-id="a6e0f-380">Creating the School Database</span></span>

<span data-ttu-id="a6e0f-381">Otevřete okno konzoly Správce balíčků.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-381">Open the Package Manager Console window.</span></span>

<span data-ttu-id="a6e0f-382">V rozevíracím seznamu **výchozí projekt** vyberte projekt CONTOSOUNIVERSITY. dal.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-382">In the **Default project** drop-down list, select the ContosoUniversity.DAL project.</span></span>

<span data-ttu-id="a6e0f-383">Zadejte následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="a6e0f-383">Enter the following command:</span></span>

[!code-powershell[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample9.ps1)]

<span data-ttu-id="a6e0f-384">Migrace Code First aplikuje počáteční migraci, která vytvoří databázi, a pak použije migraci AddBirthDate, potom spustí metodu osazení.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-384">Code First Migrations applies the Initial migration that creates the database and then applies the AddBirthDate migration, then it runs the Seed method.</span></span>

<span data-ttu-id="a6e0f-385">Spusťte web stisknutím CTRL + F5.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-385">Run the site by pressing Control-F5.</span></span> <span data-ttu-id="a6e0f-386">Stejně jako u testovacích a produkčních prostředí můžete spustit stránku **Přidat studenty** , přidat nového studenta a pak zobrazit nového studenta na stránce **Students** .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-386">As you did for the test and production environments, run the **Add Students** page, add a new student, and then view the new student in the **Students** page.</span></span> <span data-ttu-id="a6e0f-387">Tím se ověří, že se vytvořila a inicializuje školní databáze a že k ní máte přístup pro čtení a zápis.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-387">This verifies that the School database was created and initialized and that you have read and write access to it.</span></span>

<span data-ttu-id="a6e0f-388">Vyberte stránku **aktualizovat kredity** a přihlaste se, abyste ověřili, jestli je databáze členství nasazená a jestli k ní máte přístup.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-388">Select the **Update Credits** page and log in to verify that the membership database was deployed and that you have access to it.</span></span> <span data-ttu-id="a6e0f-389">Pokud jste nemigrovali své uživatelské účty, vytvořte účet správce a pak vyberte stránku **aktualizovat kredity** , abyste ověřili, že funguje.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-389">If you did not migrate your user accounts, create an administrator account and then select the **Update Credits** page to verify that it works.</span></span>

## <a name="cleaning-up-sql-server-compact-files"></a><span data-ttu-id="a6e0f-390">Čištění SQL Server Compactch souborů</span><span class="sxs-lookup"><span data-stu-id="a6e0f-390">Cleaning Up SQL Server Compact Files</span></span>

<span data-ttu-id="a6e0f-391">Už nepotřebujete soubory a balíčky NuGet, které byly zahrnuté pro podporu SQL Server Compact.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-391">You no longer need files and NuGet packages that were included to support SQL Server Compact.</span></span> <span data-ttu-id="a6e0f-392">Pokud chcete (Tento krok není nutný), můžete vyčistit nepotřebné soubory a odkazy.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-392">If you want (this step is not required), you can clean up unneeded files and references.</span></span>

<span data-ttu-id="a6e0f-393">V **Průzkumník řešení**odstraňte soubory *. sdf* ze složky *App\_data* a ze složky z *přihrádky* *amd64* a *x86* .</span><span class="sxs-lookup"><span data-stu-id="a6e0f-393">In **Solution Explorer**, delete the *.sdf* files from the *App\_Data* folder and the *amd64* and *x86* folders from the *bin* folder.</span></span>

<span data-ttu-id="a6e0f-394">V **Průzkumník řešení**klikněte pravým tlačítkem na řešení (ne na jeden z projektů) a pak klikněte na **Spravovat balíčky NuGet pro řešení**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-394">In **Solution Explorer**, right-click the solution (not one of the projects), and then click **Manage NuGet Packages for Solution**.</span></span>

<span data-ttu-id="a6e0f-395">V levém podokně dialogového okna **Spravovat balíčky NuGet** vyberte **nainstalované balíčky**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-395">In the left pane of the **Manage NuGet Packages** dialog box, select **Installed packages**.</span></span>

<span data-ttu-id="a6e0f-396">Vyberte balíček **EntityFramework. SqlServerCompact** a klikněte na **Spravovat**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-396">Select the **EntityFramework.SqlServerCompact** package and click **Manage**.</span></span>

<span data-ttu-id="a6e0f-397">V dialogovém okně **Vybrat projekty** jsou vybrány oba projekty.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-397">In the **Select Projects** dialog box, both projects are selected.</span></span> <span data-ttu-id="a6e0f-398">Chcete-li balíček odinstalovat v obou projektech, zrušte zaškrtnutí políček a pak klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-398">To uninstall the package in both projects, clear both check boxes, then click **OK**.</span></span>

<span data-ttu-id="a6e0f-399">V dialogovém okně s dotazem, zda chcete odinstalovat závislé balíčky, klikněte na tlačítko Ne.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-399">In the dialog box that asks if you want to uninstall the dependent packages also, click No.</span></span> <span data-ttu-id="a6e0f-400">Jedním z nich je balíček Entity Framework, který je třeba zachovat.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-400">One of these is the Entity Framework package that you have to keep.</span></span>

<span data-ttu-id="a6e0f-401">K odinstalaci balíčku **SqlServerCompact** použijte stejný postup.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-401">Follow the same procedure to uninstall the **SqlServerCompact** package.</span></span> <span data-ttu-id="a6e0f-402">(Balíčky musí být v tomto pořadí odinstalovány, protože balíček **EntityFramework. SqlServerCompact** závisí na balíčku **SqlServerCompact** .)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-402">(The packages must be uninstalled in this order because the **EntityFramework.SqlServerCompact** package depends on the **SqlServerCompact** package.)</span></span>

<span data-ttu-id="a6e0f-403">Úspěšně jste migrovali SQL Server Express a plný SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-403">You have now successfully migrated to SQL Server Express and full SQL Server.</span></span> <span data-ttu-id="a6e0f-404">V dalším kurzu provedete změnu další databáze a uvidíte, jak nasadit změny databáze, když testovací a provozní databáze používají SQL Server Express a úplné SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a6e0f-404">In the next tutorial you'll make another database change, and you'll see how to deploy database changes when your test and production databases use SQL Server Express and full SQL Server.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a6e0f-405">[Předchozí](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12.md)
> [Další](deployment-to-a-hosting-provider-deploying-a-sql-server-database-update-11-of-12.md)</span><span class="sxs-lookup"><span data-stu-id="a6e0f-405">[Previous](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12.md)
[Next](deployment-to-a-hosting-provider-deploying-a-sql-server-database-update-11-of-12.md)</span></span>
