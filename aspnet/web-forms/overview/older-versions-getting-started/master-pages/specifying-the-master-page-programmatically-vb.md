---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
title: Programové určení stránky předlohy (VB) | Microsoft Docs
author: rick-anderson
description: Vyhledá stránku předlohy stránky obsahu programově prostřednictvím obslužné rutiny události před inicializací.
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 0edcd653-f24a-41aa-aef4-75f868fe5ac2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
msc.type: authoredcontent
ms.openlocfilehash: 3b039b22bef38ae6ebf80be070820dc1638f87f4
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78567009"
---
# <a name="specifying-the-master-page-programmatically-vb"></a><span data-ttu-id="f0bc2-103">Programové určení stránky předlohy (VB)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-103">Specifying the Master Page Programmatically (VB)</span></span>

<span data-ttu-id="f0bc2-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f0bc2-105">[Stažení kódu](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) nebo [stažení PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-105">[Download Code](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) or [Download PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span></span>

> <span data-ttu-id="f0bc2-106">Vyhledá stránku předlohy stránky obsahu programově prostřednictvím obslužné rutiny události před inicializací.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-106">Looks at setting the content page's master page programmatically via the PreInit event handler.</span></span>

## <a name="introduction"></a><span data-ttu-id="f0bc2-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="f0bc2-107">Introduction</span></span>

<span data-ttu-id="f0bc2-108">Vzhledem k tomu, že konference příklad [*vytváření rozložení celého webu pomocí stránek předlohy*](creating-a-site-wide-layout-using-master-pages-vb.md), všechny stránky obsahu odkazovaly na svou hlavní stránku deklarativně prostřednictvím atributu `MasterPageFile` v direktivě `@Page`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-108">Since the inaugural example in [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md), all content pages have referenced their master page declaratively via the `MasterPageFile` attribute in the `@Page` directive.</span></span> <span data-ttu-id="f0bc2-109">Například následující direktiva `@Page` propojuje stránku obsahu se stránkou předlohy `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-109">For example, the following `@Page` directive links the content page to the master page `Site.master`:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample1.aspx)]

<span data-ttu-id="f0bc2-110">[Třída`Page`](https://msdn.microsoft.com/library/system.web.ui.page.aspx) v oboru názvů `System.Web.UI` obsahuje [vlastnost`MasterPageFile`](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) , která vrací cestu k hlavní stránce stránky obsahu. Tato vlastnost je nastavena pomocí direktivy `@Page`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-110">The [`Page` class](https://msdn.microsoft.com/library/system.web.ui.page.aspx) in the `System.Web.UI` namespace includes a [`MasterPageFile` property](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) that returns the path to the content page's master page; it is this property that is set by the `@Page` directive.</span></span> <span data-ttu-id="f0bc2-111">Tato vlastnost se dá také použít k programovému určení stránky předlohy stránky obsahu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-111">This property can also be used to programmatically specify the content page's master page.</span></span> <span data-ttu-id="f0bc2-112">Tento přístup je užitečný, pokud chcete dynamicky přiřazovat hlavní stránku na základě externích faktorů, jako je například uživatel, který stránku navštívil.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-112">This approach is useful if you want to dynamically assign the master page based on external factors, such as the user visiting the page.</span></span>

<span data-ttu-id="f0bc2-113">V tomto kurzu přidáme na náš web druhou stránku předlohy a dynamicky se rozhodnete, kterou hlavní stránku použít za běhu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-113">In this tutorial we add a second master page to our website and dynamically decide which master page to use at runtime.</span></span>

## <a name="step-1-a-look-at-the-page-lifecycle"></a><span data-ttu-id="f0bc2-114">Krok 1: Prohlédněte si životní cyklus stránky</span><span class="sxs-lookup"><span data-stu-id="f0bc2-114">Step 1: A Look at the Page Lifecycle</span></span>

<span data-ttu-id="f0bc2-115">Pokaždé, když žádost dorazí na webový server pro stránku ASP.NET, která je stránkou obsahu, musí modul ASP.NET pořídit ovládací prvky obsahu stránky do odpovídajících ovládacích prvků ContentPlaceHolder stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-115">Whenever a request arrives at the web server for an ASP.NET page that is a content page, the ASP.NET engine must fuse the page's Content controls into the master page's corresponding ContentPlaceHolder controls.</span></span> <span data-ttu-id="f0bc2-116">Tato syntéza vytvoří jednu hierarchii ovládacích prvků, která pak může pokračovat v běžném životním cyklu stránky.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-116">This fusion creates a single control hierarchy that can then proceed through the typical page lifecycle.</span></span>

<span data-ttu-id="f0bc2-117">Tato syntéza je znázorněna na obrázku 1.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-117">Figure 1 illustrates this fusion.</span></span> <span data-ttu-id="f0bc2-118">Krok 1 na obrázku 1 ukazuje počáteční obsah a hierarchie ovládacích prvků stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-118">Step 1 in Figure 1 shows the initial content and master page control hierarchies.</span></span> <span data-ttu-id="f0bc2-119">Na konci fáze předinicializace jsou ovládací prvky obsahu na stránce přidány do odpovídajících prvků ContentPlaceHolder na stránce předlohy (krok 2).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-119">At the tail end of the PreInit stage the Content controls in the page are added to the corresponding ContentPlaceHolders in the master page (Step 2).</span></span> <span data-ttu-id="f0bc2-120">Po této syntézě stránka předlohy slouží jako kořen v kontrolní hierarchii.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-120">After this fusion, the master page serves as the root of the fused control hierarchy.</span></span> <span data-ttu-id="f0bc2-121">Tato kontrolní hierarchie je pak přidána na stránku, aby vytvořila finální hierarchii řízení (krok 3).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-121">This fused control hierarchy is then added to the page to produce the finalized control hierarchy (Step 3).</span></span> <span data-ttu-id="f0bc2-122">Výsledkem je, že hierarchie ovládacích prvků stránky obsahuje pojistou hierarchii řízení.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-122">The net result is that the page's control hierarchy includes the fused control hierarchy.</span></span>

<span data-ttu-id="f0bc2-123">[![při fázi předinicializačního sestavování hierarchií ovládacího prvku stránky předlohy a stránky obsahu.](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-123">[![The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span></span>

<span data-ttu-id="f0bc2-124">**Obrázek 01**: hierarchie ovládacích prvků stránky předlohy a stránky obsahu se během fáze předinicializačního sestavují společně ([kliknutím zobrazíte obrázek v plné velikosti).](specifying-the-master-page-programmatically-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-124">**Figure 01**: The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image3.png))</span></span>

## <a name="step-2-setting-themasterpagefileproperty-from-code"></a><span data-ttu-id="f0bc2-125">Krok 2: nastavení vlastnosti`MasterPageFile`z kódu</span><span class="sxs-lookup"><span data-stu-id="f0bc2-125">Step 2: Setting the`MasterPageFile`Property from Code</span></span>

<span data-ttu-id="f0bc2-126">Jakou stránku předlohy partakes v této fusion závisí na hodnotě vlastnosti `MasterPageFile` objektu `Page`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-126">What master page partakes in this fusion depends on the value of the `Page` object's `MasterPageFile` property.</span></span> <span data-ttu-id="f0bc2-127">Nastavení atributu `MasterPageFile` v direktivě `@Page` má netto účinek přiřazení vlastnosti `MasterPageFile` `Page`během inicializační fáze, což je velmi první fáze životního cyklu stránky.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-127">Setting the `MasterPageFile` attribute in the `@Page` directive has the net effect of assigning the `Page`'s `MasterPageFile` property during the Initialization stage, which is the very first stage of the page's lifecycle.</span></span> <span data-ttu-id="f0bc2-128">Tuto vlastnost můžeme případně nastavit programově.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-128">We can alternatively set this property programmatically.</span></span> <span data-ttu-id="f0bc2-129">Je však nutné, aby byla tato vlastnost nastavena před tím, než dojde k fúze na obrázku 1.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-129">However, it is imperative that this property be set before the fusion in Figure 1 takes place.</span></span>

<span data-ttu-id="f0bc2-130">Na začátku předinicializační fáze `Page` objekt vyvolá [událost`PreInit`](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) a zavolá jeho [metodu`OnPreInit`](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-130">At the start of the PreInit stage the `Page` object raises its [`PreInit` event](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) and calls its [`OnPreInit` method](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span></span> <span data-ttu-id="f0bc2-131">Chcete-li nastavit hlavní stránku programově, můžeme buď vytvořit obslužnou rutinu události pro událost `PreInit`, nebo přepsat metodu `OnPreInit`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-131">To set the master page programmatically, then, we can either create an event handler for the `PreInit` event or override the `OnPreInit` method.</span></span> <span data-ttu-id="f0bc2-132">Pojďme se podívat na oba přístupy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-132">Let's look at both approaches.</span></span>

<span data-ttu-id="f0bc2-133">Začněte tím, že otevřete `Default.aspx.vb`, soubor třídy na pozadí pro domovskou stránku webu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-133">Start by opening `Default.aspx.vb`, the code-behind class file for our site's homepage.</span></span> <span data-ttu-id="f0bc2-134">Přidejte obslužnou rutinu události pro událost `PreInit` stránky zadáním následujícího kódu:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-134">Add an event handler for the page's `PreInit` event by typing in the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample2.vb)]

<span data-ttu-id="f0bc2-135">Odtud můžete nastavit vlastnost `MasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-135">From here we can set the `MasterPageFile` property.</span></span> <span data-ttu-id="f0bc2-136">Aktualizujte kód tak, aby přiřadí hodnotu "~/site.Master" do vlastnosti `MasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-136">Update the code so that it assigns the value "~/Site.master" to the `MasterPageFile` property.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample3.vb)]

<span data-ttu-id="f0bc2-137">Pokud nastavíte zarážku a začnete s laděním, uvidíte, že pokaždé, když se stránka `Default.aspx` navštíví nebo když na této stránce provedete postback, spustí se obslužná rutina `Page_PreInit` události a vlastnost `MasterPageFile` je přiřazena k souboru ~/site.Master.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-137">If you set a breakpoint and start with debugging you'll see that whenever the `Default.aspx` page is visited or whenever there's a postback to this page, the `Page_PreInit` event handler executes and the `MasterPageFile` property is assigned to "~/Site.master".</span></span>

<span data-ttu-id="f0bc2-138">Alternativně můžete přepsat `OnPreInit` metodu `Page` třídy a nastavit vlastnost `MasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-138">Alternatively, you can override the `Page` class's `OnPreInit` method and set the `MasterPageFile` property there.</span></span> <span data-ttu-id="f0bc2-139">V tomto příkladu není nastavena stránka předlohy na konkrétní stránce, ale místo `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-139">For this example, let's not set the master page in a particular page, but rather from `BasePage`.</span></span> <span data-ttu-id="f0bc2-140">Odvolání, že jsme vytvořili vlastní třídu základní stránky (`BasePage`) zpátky v kurzu [*zadání nadpisu, meta značek a dalších hlaviček HTML v kurzu hlavní stránky*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="f0bc2-140">Recall that we created a custom base page class (`BasePage`) back in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial.</span></span> <span data-ttu-id="f0bc2-141">V současné době `BasePage` přepisuje metodu `OnLoadComplete` `Page` třídy, kde nastaví vlastnost `Title` stránky na základě dat mapy webu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-141">Currently `BasePage` overrides the `Page` class's `OnLoadComplete` method, where it sets the page's `Title` property based on the site map data.</span></span> <span data-ttu-id="f0bc2-142">Pojďme aktualizovat `BasePage` pro přepsání `OnPreInit` metody pro programové určení stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-142">Let's update `BasePage` to also override the `OnPreInit` method to programmatically specify the master page.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample4.vb)]

<span data-ttu-id="f0bc2-143">Vzhledem k tomu, že všechny naše stránky obsahu jsou odvozeny od `BasePage`, všechny z nich nyní mají přiřazenou stránku předlohy programově.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-143">Because all our content pages derive from `BasePage`, all of them now have their master page programmatically assigned.</span></span> <span data-ttu-id="f0bc2-144">V tomto okamžiku je `PreInit` obslužná rutina události v `Default.aspx.vb` nadbytečných; Nebojte se ji odebrat.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-144">At this point the `PreInit` event handler in `Default.aspx.vb` is superfluous; feel free to remove it.</span></span>

### <a name="what-about-thepagedirective"></a><span data-ttu-id="f0bc2-145">Co je direktiva`@Page`?</span><span class="sxs-lookup"><span data-stu-id="f0bc2-145">What About the`@Page`Directive?</span></span>

<span data-ttu-id="f0bc2-146">To může být trochu matoucí, protože `MasterPageFile` vlastnosti stránky obsahu jsou nyní zadány na dvou místech: programově v `OnPreInit` metodě `BasePage` třídy a také prostřednictvím atributu `MasterPageFile` v direktivě `@Page` stránky obsahu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-146">What may be a little confusing is that the content pages' `MasterPageFile` properties are now being specified in two places: programmatically in the `BasePage` class's `OnPreInit` method as well as through the `MasterPageFile` attribute in each content page's `@Page` directive.</span></span>

<span data-ttu-id="f0bc2-147">První fází životního cyklu stránky je fáze inicializace.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-147">The first stage in the page lifecycle is the Initialization stage.</span></span> <span data-ttu-id="f0bc2-148">Během této fáze je vlastnost objektu `Page` `MasterPageFile` přiřazena hodnotě atributu `MasterPageFile` v direktivě `@Page` (Pokud je k dispozici).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-148">During this stage the `Page` object's `MasterPageFile` property is assigned the value of the `MasterPageFile` attribute in the `@Page` directive (if it is provided).</span></span> <span data-ttu-id="f0bc2-149">Fáze předinicializačního nástroje následuje po inicializační fázi a tady je, kde programově nastavili vlastnost `MasterPageFile` objektu `Page`, čímž se přepíše hodnota přiřazená direktivou `@Page`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-149">The PreInit stage follows the Initialization stage, and it is here where we programmatically set the `Page` object's `MasterPageFile` property, thereby overwriting the value assigned from the `@Page` directive.</span></span> <span data-ttu-id="f0bc2-150">Vzhledem k tomu, že nastavujeme vlastnost `MasterPageFile` objektu `Page` programově, mohli bychom z direktivy `@Page` odebrat atribut `MasterPageFile`, aniž by to ovlivnilo činnost koncového uživatele.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-150">Because we are setting the `Page` object's `MasterPageFile` property programmatically, we could remove the `MasterPageFile` attribute from the `@Page` directive without affecting the end user's experience.</span></span> <span data-ttu-id="f0bc2-151">Pokud to chcete přesvědčit, pokračujte a odeberte atribut `MasterPageFile` z direktivy `@Page` v `Default.aspx` a potom navštivte stránku pomocí prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-151">To convince yourself of this, go ahead and remove the `MasterPageFile` attribute from the `@Page` directive in `Default.aspx` and then visit the page through a browser.</span></span> <span data-ttu-id="f0bc2-152">Stejně jako byste očekávali, výstup bude stejný jako před odebráním atributu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-152">As you would expect, the output is the same as before the attribute was removed.</span></span>

<span data-ttu-id="f0bc2-153">Určuje, zda je vlastnost `MasterPageFile` nastavena prostřednictvím direktivy `@Page` nebo programově bezvýznamnými na činnost koncového uživatele.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-153">Whether the `MasterPageFile` property is set via the `@Page` directive or programmatically is inconsequential to the end user's experience.</span></span> <span data-ttu-id="f0bc2-154">Atribut `MasterPageFile` v direktivě `@Page` však používá Visual Studio během návrhu k vytvoření zobrazení WYSIWYG v návrháři.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-154">However, the `MasterPageFile` attribute in the `@Page` directive is used by Visual Studio during design-time to produce the WYSIWYG view in the Designer.</span></span> <span data-ttu-id="f0bc2-155">Pokud se vrátíte k `Default.aspx` v aplikaci Visual Studio a přejdete k návrháři, zobrazí se zpráva "Chyba stránky předlohy: stránka obsahuje ovládací prvky, které vyžadují odkaz na hlavní stránku, ale žádná není zadaná" (viz obrázek 2).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-155">If you return to `Default.aspx` in Visual Studio and navigate to the Designer you'll see the message, "Master Page error: The page has controls that require a Master Page reference, but none is specified" (see Figure 2).</span></span>

<span data-ttu-id="f0bc2-156">V krátkém případě je nutné ponechat atribut `MasterPageFile` v direktivě `@Page`, aby v nástroji Visual Studio pracovalo s bohatou funkcí pro práci s časem návrhu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-156">In short, you need to leave the `MasterPageFile` attribute in the `@Page` directive to enjoy a rich design-time experience in Visual Studio.</span></span>

<span data-ttu-id="f0bc2-157">[![Visual Studio používá k vykreslení návrhového zobrazení atribut MasterPageFile direktivy @Page](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-157">[![Visual Studio Uses the @Page Directive's MasterPageFile Attribute to Render the Design View](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span></span>

<span data-ttu-id="f0bc2-158">**Obrázek 02**: Visual Studio používá atribut `MasterPageFile` direktivy `@Page` k vykreslení zobrazení návrhu ([kliknutím zobrazíte obrázek v plné velikosti](specifying-the-master-page-programmatically-vb/_static/image6.png)).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-158">**Figure 02**: Visual Studio Uses the `@Page` Directive's `MasterPageFile` Attribute to Render the Design View  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image6.png))</span></span>

## <a name="step-3-creating-an-alternative-master-page"></a><span data-ttu-id="f0bc2-159">Krok 3: vytvoření alternativní stránky předlohy</span><span class="sxs-lookup"><span data-stu-id="f0bc2-159">Step 3: Creating an Alternative Master Page</span></span>

<span data-ttu-id="f0bc2-160">Vzhledem k tomu, že stránku předlohy stránky obsahu lze nastavit programově za běhu, je možné dynamicky načíst konkrétní hlavní stránku na základě některých externích kritérií.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-160">Because a content page's master page can be set programmatically at runtime it's possible to dynamically load a particular master page based on some external criteria.</span></span> <span data-ttu-id="f0bc2-161">Tato funkce může být užitečná v situacích, kdy se rozložení lokality musí měnit v závislosti na uživateli.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-161">This functionality can be useful in situations where the site's layout needs to vary based on the user.</span></span> <span data-ttu-id="f0bc2-162">Například webová aplikace v modulu blogu může uživatelům dovolit zvolit rozložení pro svůj blog, kde je každé rozložení přidruženo k jiné stránce předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-162">For instance, a blog engine web application may allow its users to choose a layout for their blog, where each layout is associated with a different master page.</span></span> <span data-ttu-id="f0bc2-163">Když se v době běhu návštěvník zobrazuje na blogu uživatele, Webová aplikace by musela určit rozložení blogu a dynamicky přidružit odpovídající stránku předlohy k obsahu stránky.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-163">At runtime, when a visitor is viewing a user's blog, the web application would need to determine the blog's layout and dynamically associate the corresponding master page with the content page.</span></span>

<span data-ttu-id="f0bc2-164">Pojďme se podívat, jak dynamicky načíst hlavní stránku za běhu na základě některých externích kritérií.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-164">Let's examine how to dynamically load a master page at runtime based on some external criteria.</span></span> <span data-ttu-id="f0bc2-165">Náš web aktuálně obsahuje jenom jednu stránku předlohy (`Site.master`).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-165">Our website currently contains just one master page (`Site.master`).</span></span> <span data-ttu-id="f0bc2-166">K ilustraci výběru stránky předlohy za běhu potřebujeme další stránku předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-166">We need another master page to illustrate choosing a master page at runtime.</span></span> <span data-ttu-id="f0bc2-167">Tento krok se zaměřuje na vytvoření a konfiguraci nové stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-167">This step focuses on creating and configuring the new master page.</span></span> <span data-ttu-id="f0bc2-168">Krok 4 se zabývá určením, jakou stránku předlohy použít za běhu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-168">Step 4 looks at determining what master page to use at runtime.</span></span>

<span data-ttu-id="f0bc2-169">Vytvořte novou stránku předlohy v kořenové složce s názvem `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-169">Create a new master page in the root folder named `Alternate.master`.</span></span> <span data-ttu-id="f0bc2-170">Přidejte také novou šablonu stylů na web s názvem `AlternateStyles.css`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-170">Also add a new style sheet to the website named `AlternateStyles.css`.</span></span>

<span data-ttu-id="f0bc2-171">[![přidat další stránku předlohy a soubor CSS na web](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-171">[![Add Another Master Page and CSS File to the Website](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span></span>

<span data-ttu-id="f0bc2-172">**Obrázek 03**: Přidání další stránky předlohy a souboru CSS na web ([kliknutím zobrazíte obrázek v plné velikosti](specifying-the-master-page-programmatically-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="f0bc2-172">**Figure 03**: Add Another Master Page and CSS File to the Website  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image9.png))</span></span>

<span data-ttu-id="f0bc2-173">Navrhl (a) `Alternate.master` stránku předlohy, aby se název zobrazoval v horní části stránky, na střed a na pozadí námořnická modrá.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-173">I've designed the `Alternate.master` master page to have the title displayed at the top of the page, centered and on a navy background.</span></span> <span data-ttu-id="f0bc2-174">Vyzkoušel (a) jsem z levého sloupce a přesunuli jsme tento obsah pod ovládací prvek `MainContent` ContentPlaceHolder, který teď pokrývá celou šířku stránky.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-174">I've dispensed of the left column and moved that content beneath the `MainContent` ContentPlaceHolder control, which now spans the entire width of the page.</span></span> <span data-ttu-id="f0bc2-175">Kromě toho nixed seznam neuspořádaných lekcí a nahradili ho vodorovným seznamem nad `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-175">Furthermore, I nixed the unordered Lessons list and replaced it with a horizontal list above `MainContent`.</span></span> <span data-ttu-id="f0bc2-176">Také jsem aktualizoval písma a barvy používané stránkou předlohy (a podle přípony, jejích stránek obsahu).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-176">I also updated the fonts and colors used by the master page (and, by extension, its content pages).</span></span> <span data-ttu-id="f0bc2-177">Obrázek 4 ukazuje `Default.aspx` při použití `Alternate.master` stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-177">Figure 4 shows `Default.aspx` when using the `Alternate.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="f0bc2-178">ASP.NET zahrnuje možnost definovat *motivy*.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-178">ASP.NET includes the ability to define *Themes*.</span></span> <span data-ttu-id="f0bc2-179">Motiv je kolekce obrázků, souborů CSS a nastavení vlastností ovládacích prvků webového ovládacího prvku, která lze použít na stránku za běhu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-179">A Theme is a collection of images, CSS files, and style-related Web control property settings that can be applied to a page at runtime.</span></span> <span data-ttu-id="f0bc2-180">Motivy slouží jako způsob, jak jít, pokud se rozložení vaší lokality liší pouze v zobrazených obrázcích a jejich pravidly CSS.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-180">Themes are the way to go if your site's layouts differ only in the images displayed and by their CSS rules.</span></span> <span data-ttu-id="f0bc2-181">Pokud se rozložení liší v podstatě, jako je například použití různých webových ovládacích prvků nebo oddálení různých rozložení, bude nutné použít samostatné stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-181">If the layouts differ more substantially, such as using different Web controls or having a radically different layout, then you will need to use separate master pages.</span></span> <span data-ttu-id="f0bc2-182">Další informace o motivech najdete v části věnované dalšímu čtení na konci tohoto kurzu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-182">Consult the Further Reading section at the end of this tutorial for more information on Themes.</span></span>

<span data-ttu-id="f0bc2-183">[![naší stránky obsahu teď můžou používat nový vzhled a chování.](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-183">[![Our Content Pages Can Now Use a New Look and Feel](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span></span>

<span data-ttu-id="f0bc2-184">**Obrázek 04**: naše stránky obsahu teď můžou používat nový vzhled a chování ([kliknutím zobrazíte obrázek v plné velikosti).](specifying-the-master-page-programmatically-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-184">**Figure 04**: Our Content Pages Can Now Use a New Look and Feel ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image12.png))</span></span>

<span data-ttu-id="f0bc2-185">Když jsou značky hlavního prvku a stránky obsahu pokryty, třída `MasterPage` kontroluje, zda všechny ovládací prvky obsahu na stránce obsahu odkazují na prvky ContentPlaceHolder na stránce předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-185">When the master and content pages' markup are fused, the `MasterPage` class checks to ensure that every Content control in the content page references a ContentPlaceHolder in the master page.</span></span> <span data-ttu-id="f0bc2-186">Výjimka je vyvolána, pokud je nalezen ovládací prvek obsahu, který odkazuje na neexistující prvek ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-186">An exception is thrown if a Content control that references a non-existent ContentPlaceHolder is found.</span></span> <span data-ttu-id="f0bc2-187">Jinými slovy, je nezbytné, aby hlavní stránka, která je přiřazena stránce obsahu, měla prvek ContentPlaceHolder pro každý ovládací prvek obsahu na stránce obsahu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-187">In other words, it is imperative that the master page being assigned to the content page have a ContentPlaceHolder for each Content control in the content page.</span></span>

<span data-ttu-id="f0bc2-188">`Site.master` hlavní stránka obsahuje čtyři ovládací prvky ContentPlaceHolder:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-188">The `Site.master` master page includes four ContentPlaceHolder controls:</span></span>

- `head`
- `MainContent`
- `QuickLoginUI`
- `LeftColumnContent`

<span data-ttu-id="f0bc2-189">Některé stránky obsahu na našem webu obsahují jenom jeden nebo dva ovládací prvky obsahu. Další součástí jsou ovládací prvky obsahu pro každý z dostupných prvků ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-189">Some of the content pages in our website include just one or two Content controls; others include a Content control for each of the available ContentPlaceHolders.</span></span> <span data-ttu-id="f0bc2-190">Pokud by naše nová stránka předlohy (`Alternate.master`) mohla být někdy přiřazena k těmto stránkám obsahu, které mají ovládací prvky obsahu pro všechny prvky ContentPlaceHolder v `Site.master` pak je nezbytné, aby `Alternate.master` také zahrnovaly stejné ovládací prvky ContentPlaceHolder jako `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-190">If our new master page (`Alternate.master`) may ever be assigned to those content pages that have Content controls for all of the ContentPlaceHolders in `Site.master` then it is essential that `Alternate.master` also include the same ContentPlaceHolder controls as `Site.master`.</span></span>

<span data-ttu-id="f0bc2-191">Chcete-li, aby stránka předlohy `Alternate.master` vypadala podobně jako v mikroformátu (viz obrázek 4), začněte definováním stylů stránky předlohy v `AlternateStyles.css` šabloně stylů.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-191">To get your `Alternate.master` master page to look similar to mine (see Figure 4), start by defining the master page's styles in the `AlternateStyles.css` style sheet.</span></span> <span data-ttu-id="f0bc2-192">Do `AlternateStyles.css`přidejte následující pravidla:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-192">Add the following rules into `AlternateStyles.css`:</span></span>

[!code-css[Main](specifying-the-master-page-programmatically-vb/samples/sample5.css)]

<span data-ttu-id="f0bc2-193">Dále přidejte následující deklarativní označení do `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-193">Next, add the following declarative markup to `Alternate.master`.</span></span> <span data-ttu-id="f0bc2-194">Jak vidíte, `Alternate.master` obsahuje čtyři ovládací prvky ContentPlaceHolder se stejnými `ID` hodnotami jako ovládací prvky ContentPlaceHolder v `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-194">As you can see, `Alternate.master` contains four ContentPlaceHolder controls with the same `ID` values as the ContentPlaceHolder controls in `Site.master`.</span></span> <span data-ttu-id="f0bc2-195">Kromě toho obsahuje ovládací prvek ScriptManager, který je nezbytný pro tyto stránky na našem webu, které používají architekturu ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-195">Moreover, it includes a ScriptManager control, which is necessary for those pages in our website that use the ASP.NET AJAX framework.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample6.aspx)]

### <a name="testing-the-new-master-page"></a><span data-ttu-id="f0bc2-196">Testování nové stránky předlohy</span><span class="sxs-lookup"><span data-stu-id="f0bc2-196">Testing the New Master Page</span></span>

<span data-ttu-id="f0bc2-197">Chcete-li otestovat tuto novou stránku předlohy, aktualizujte metodu `OnPreInit` `BasePage` třídy tak, aby vlastnost `MasterPageFile` byla přiřazena `"~/Alternate.maser"` hodnotě a poté návštěvě webu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-197">To test this new master page update the `BasePage` class's `OnPreInit` method so that the `MasterPageFile` property is assigned the value `"~/Alternate.maser"` and then visit the website.</span></span> <span data-ttu-id="f0bc2-198">Každá stránka by měla fungovat bez chyby kromě dvou: `~/Admin/AddProduct.aspx` a `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-198">Every page should function without error except for two: `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="f0bc2-199">Přidání produktu do ovládacího prvku DetailsView v `~/Admin/AddProduct.aspx` má za následek `NullReferenceException` z řádku kódu, který se pokusí nastavit vlastnost `GridMessageText` stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-199">Adding a product to the DetailsView in `~/Admin/AddProduct.aspx` results in a `NullReferenceException` from the line of code that attempts to set the master page's `GridMessageText` property.</span></span> <span data-ttu-id="f0bc2-200">Při návštěvě `~/Admin/Products.aspx` se při načítání stránky vyvolala `InvalidCastException` zpráva: "nelze přetypovat objekt typu ' ASP. alternativní\_Master ' na typ ' ASP. Web\_Master '.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-200">When visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown on page load with the message: "Unable to cast object of type 'ASP.alternate\_master' to type 'ASP.site\_master'."</span></span>

<span data-ttu-id="f0bc2-201">K těmto chybám dochází, protože třída `Site.master` kódu na pozadí obsahuje veřejné události, vlastnosti a metody, které nejsou definovány v `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-201">These errors occur because the `Site.master` code-behind class includes public events, properties, and methods that are not defined in `Alternate.master`.</span></span> <span data-ttu-id="f0bc2-202">Část s označením těchto dvou stránek obsahuje direktivu `@MasterType`, která odkazuje na stránku předlohy `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-202">The markup portion of these two pages have a `@MasterType` directive that references the `Site.master` master page.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample7.aspx)]

<span data-ttu-id="f0bc2-203">Také obslužná rutina události `ItemInserted` ovládacího prvku DetailsView v `~/Admin/AddProduct.aspx` obsahuje kód, který přesměruje vlastnost `Page.Master` volného typu na objekt typu `Site`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-203">Also, the DetailsView's `ItemInserted` event handler in `~/Admin/AddProduct.aspx` includes code that casts the loosely-typed `Page.Master` property to an object of type `Site`.</span></span> <span data-ttu-id="f0bc2-204">Direktiva `@MasterType` (používá se tímto způsobem) a přetypování v obslužné rutině události `ItemInserted` těsně Couples `~/Admin/AddProduct.aspx` a `~/Admin/Products.aspx` stránky na stránku předlohy `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-204">The `@MasterType` directive (used this way) and the cast in the `ItemInserted` event handler tightly couples the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to the `Site.master` master page.</span></span>

<span data-ttu-id="f0bc2-205">Pro přerušení tohoto těsného propojení můžeme mít `Site.master` a `Alternate.master` odvozovat ze společné základní třídy, která obsahuje definice pro veřejné členy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-205">To break this tight coupling we can have `Site.master` and `Alternate.master` derive from a common base class that contains definitions for the public members.</span></span> <span data-ttu-id="f0bc2-206">Za tímto účelem můžeme aktualizovat direktivu `@MasterType`, aby odkazovala na tento běžný základní typ.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-206">Following that, we can update the `@MasterType` directive to reference this common base type.</span></span>

### <a name="creating-a-custom-base-master-page-class"></a><span data-ttu-id="f0bc2-207">Vytvoření vlastní třídy základní stránky předlohy</span><span class="sxs-lookup"><span data-stu-id="f0bc2-207">Creating a Custom Base Master Page Class</span></span>

<span data-ttu-id="f0bc2-208">Přidejte nový soubor třídy do složky `App_Code` s názvem `BaseMasterPage.vb` a odvodit z `System.Web.UI.MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-208">Add a new class file to the `App_Code` folder named `BaseMasterPage.vb` and have it derive from `System.Web.UI.MasterPage`.</span></span> <span data-ttu-id="f0bc2-209">Musíme v `BaseMasterPage`definovat metodu `RefreshRecentProductsGrid` a vlastnost `GridMessageText`, ale nemůžeme je jednoduše přesunout ze `Site.master`, protože tito členové pracují s webovými ovládacími prvky, které jsou specifické pro `Site.master` stránku předlohy (`RecentProducts` prvek GridView a `GridMessage` Label).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-209">We need to define the `RefreshRecentProductsGrid` method and the `GridMessageText` property in `BaseMasterPage`, but we can't simply move them there from `Site.master` because these members work with Web controls that are specific to the `Site.master` master page (the `RecentProducts` GridView and `GridMessage` Label).</span></span>

<span data-ttu-id="f0bc2-210">To, co musíme udělat, je nakonfigurovat `BaseMasterPage` takovým způsobem, že jsou tyto členy definovány, ale jsou skutečně implementovány pomocí odvozených tříd `BaseMasterPage`(`Site.master` a `Alternate.master`).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-210">What we need to do is configure `BaseMasterPage` in such a way that these members are defined there, but are actually implemented by `BaseMasterPage`'s derived classes (`Site.master` and `Alternate.master`).</span></span> <span data-ttu-id="f0bc2-211">Tento typ dědičnosti je možné tím, že označíte třídu jako `MustInherit` a její členy jako `MustOverride`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-211">This type of inheritance is possible by marking the class as `MustInherit` and its members as `MustOverride`.</span></span> <span data-ttu-id="f0bc2-212">V krátkém případě přidání těchto klíčových slov do třídy a její dva členy oznámí, že `BaseMasterPage` neimplementuje `RefreshRecentProductsGrid` a `GridMessageText`, ale že jeho odvozené třídy budou.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-212">In short, adding these keywords to the class and its two members announces that `BaseMasterPage` hasn't implemented `RefreshRecentProductsGrid` and `GridMessageText`, but that its derived classes will.</span></span>

<span data-ttu-id="f0bc2-213">Také je potřeba definovat událost `PricesDoubled` v `BaseMasterPage` a poskytnout odvozené třídy pro vyvolání události.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-213">We also need to define the `PricesDoubled` event in `BaseMasterPage` and provide a means by the derived classes to raise the event.</span></span> <span data-ttu-id="f0bc2-214">Vzor použitý v .NET Framework k usnadnění tohoto chování je vytvořit veřejnou událost v základní třídě a přidat chráněnou, Overridable metodu s názvem `OnEventName`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-214">The pattern used in the .NET Framework to facilitate this behavior is to create a public event in the base class and add a protected, overridable method named `OnEventName`.</span></span> <span data-ttu-id="f0bc2-215">Odvozené třídy mohou následně volat tuto metodu pro vyvolání události nebo mohou přepsat pro spuštění kódu bezprostředně před nebo po vyvolání události.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-215">Derived classes can then call this method to raise the event or can override it to execute code immediately before or after the event is raised.</span></span>

<span data-ttu-id="f0bc2-216">Aktualizujte třídu `BaseMasterPage` tak, aby obsahovala následující kód:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-216">Update your `BaseMasterPage` class so that it contains the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample8.vb)]

<span data-ttu-id="f0bc2-217">V dalším kroku přejdete na třídu `Site.master` kódu na pozadí a ponecháte ji odvozovat z `BaseMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-217">Next, go to the `Site.master` code-behind class and have it derive from `BaseMasterPage`.</span></span> <span data-ttu-id="f0bc2-218">Vzhledem k tomu, že `BaseMasterPage` obsahuje členy označené `MustOverride` potřebujeme tyto členy přepsat v `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-218">Because `BaseMasterPage` contains members marked `MustOverride` we need to override those members here in `Site.master`.</span></span> <span data-ttu-id="f0bc2-219">Přidejte klíčové slovo `Overrides` do definice metody a vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-219">Add the `Overrides` keyword to the method and property definitions.</span></span> <span data-ttu-id="f0bc2-220">Aktualizujte také kód, který vyvolává událost `PricesDoubled` v obslužné rutině události `DoublePrice` tlačítka `Click` voláním metody `OnPricesDoubled` základní třídy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-220">Also update the code that raises the `PricesDoubled` event in the `DoublePrice` Button's `Click` event handler with a call to the base class's `OnPricesDoubled` method.</span></span>

<span data-ttu-id="f0bc2-221">Po těchto změnách by třída `Site.master` kódu na pozadí měla obsahovat následující kód:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-221">After these modifications the `Site.master` code-behind class should contain the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample9.vb)]

<span data-ttu-id="f0bc2-222">Také je potřeba aktualizovat třídu kódu na pozadí `Alternate.master`pro odvození od `BaseMasterPage` a přepsat dva členy `MustOverride`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-222">We also need to update `Alternate.master`'s code-behind class to derive from `BaseMasterPage` and override the two `MustOverride` members.</span></span> <span data-ttu-id="f0bc2-223">Vzhledem k tomu, že `Alternate.master` neobsahuje prvek GridView, který obsahuje seznam nejaktuálnějších produktů, ani popisek, který zobrazí zprávu po přidání nového produktu do databáze, nemusí tyto metody provádět žádné akce.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-223">But because `Alternate.master` does not contain a GridView that lists the most recent products nor a Label that displays a message after a new product is added to the database, these methods do not need to do anything.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample10.vb)]

### <a name="referencing-the-base-master-page-class"></a><span data-ttu-id="f0bc2-224">Odkazování na základní třídu stránky předlohy</span><span class="sxs-lookup"><span data-stu-id="f0bc2-224">Referencing the Base Master Page Class</span></span>

<span data-ttu-id="f0bc2-225">Teď, když jsme dokončili třídu `BaseMasterPage` a máme dvě stránky předlohy, náš poslední krok je aktualizovat `~/Admin/AddProduct.aspx` a `~/Admin/Products.aspx` stránky, aby odkazovaly na tento společný typ.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-225">Now that we have completed the `BaseMasterPage` class and have our two master pages extending it, our final step is to update the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to refer to this common type.</span></span> <span data-ttu-id="f0bc2-226">Začněte změnou direktivy `@MasterType` na obou stránkách z:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-226">Start by changing the `@MasterType` directive in both pages from:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample11.aspx)]

<span data-ttu-id="f0bc2-227">Komu:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-227">To:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample12.aspx)]

<span data-ttu-id="f0bc2-228">Namísto odkazování na cestu k souboru teď vlastnost `@MasterType` odkazuje na základní typ (`BaseMasterPage`).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-228">Rather than referencing a file path, the `@MasterType` property now references the base type (`BaseMasterPage`).</span></span> <span data-ttu-id="f0bc2-229">V důsledku toho je vlastnost silně typovaného `Master` použitá na obou stránkách třídy kódu na pozadí nyní typu `BaseMasterPage` (namísto typu `Site`).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-229">Consequently, the strongly-typed `Master` property used in both pages' code-behind classes is now of type `BaseMasterPage` (instead of type `Site`).</span></span> <span data-ttu-id="f0bc2-230">Tato změna se provádí znovu `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-230">With this change in place revisit `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="f0bc2-231">Dřív to vedlo k chybě při přetypování, protože stránka je nakonfigurovaná tak, aby používala `Alternate.master` stránku předlohy, ale direktiva `@MasterType` odkazovala na `Site.master` soubor.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-231">Previously, this resulted in a casting error because the page is configured to use the `Alternate.master` master page, but the `@MasterType` directive referenced the `Site.master` file.</span></span> <span data-ttu-id="f0bc2-232">Ale teď se stránka vykreslí bez chyby.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-232">But now the page renders without error.</span></span> <span data-ttu-id="f0bc2-233">Je to proto, že `Alternate.master` hlavní stránku lze přetypovat na objekt typu `BaseMasterPage` (od jeho rozšíření).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-233">This is because the `Alternate.master` master page can be cast to an object of type `BaseMasterPage` (since it extends it).</span></span>

<span data-ttu-id="f0bc2-234">Existuje jedna malá změna, kterou je třeba udělat v `~/Admin/AddProduct.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-234">There's one small change that needs to be made in `~/Admin/AddProduct.aspx`.</span></span> <span data-ttu-id="f0bc2-235">Obslužná rutina události `ItemInserted` ovládacího prvku DetailsView používá vlastnost `Master` silného typu a vlastnost s volným typem `Page.Master`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-235">The DetailsView control's `ItemInserted` event handler uses both the strongly-typed `Master` property and the loosely-typed `Page.Master` property.</span></span> <span data-ttu-id="f0bc2-236">Po aktualizaci direktivy `@MasterType` jsme opravili odkaz silného typu, ale pořád potřebujeme aktualizovat volně typované odkazy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-236">We fixed the strongly-typed reference when we updated the `@MasterType` directive, but we still need to update the loosely-typed reference.</span></span> <span data-ttu-id="f0bc2-237">Nahraďte následující řádek kódu:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-237">Replace the following line of code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample13.vb)]

<span data-ttu-id="f0bc2-238">Následující příkaz, který přetypování `Page.Master` na základní typ:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-238">With the following, which casts `Page.Master` to the base type:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample14.vb)]

## <a name="step-4-determining-what-master-page-to-bind-to-the-content-pages"></a><span data-ttu-id="f0bc2-239">Krok 4: určení stránky předlohy, která se má navazovat na stránky obsahu</span><span class="sxs-lookup"><span data-stu-id="f0bc2-239">Step 4: Determining What Master Page to Bind to the Content Pages</span></span>

<span data-ttu-id="f0bc2-240">Naše `BasePage` Třída aktuálně nastavuje všechny vlastnosti stránky obsahu `MasterPageFile` na pevně zakódované hodnoty ve fázi předinicializačního životního cyklu stránky.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-240">Our `BasePage` class currently sets all content pages' `MasterPageFile` properties to a hard-coded value in the PreInit stage of the page lifecycle.</span></span> <span data-ttu-id="f0bc2-241">Tento kód můžeme aktualizovat tak, aby hlavní stránka na některém externím faktoru byla základem.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-241">We can update this code to base the master page on some external factor.</span></span> <span data-ttu-id="f0bc2-242">Možná se stránka předlohy načte, záleží na preferencích aktuálně přihlášeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-242">Perhaps the master page to load depends on the preferences of the currently logged on user.</span></span> <span data-ttu-id="f0bc2-243">V takovém případě musíme napsat kód v metodě `OnPreInit` v `BasePage`, který vyhledá předvolby hlavní stránky aktuálně navštíveného uživatele.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-243">In that case, we'd need to write code in the `OnPreInit` method in `BasePage` that looks up the currently visiting user's master page preferences.</span></span>

<span data-ttu-id="f0bc2-244">Pojďme vytvořit webovou stránku, která umožňuje uživateli zvolit, kterou hlavní stránku použít-`Site.master` nebo `Alternate.master`-a uložit tuto volbu do proměnné relace.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-244">Let's create a web page that allows the user to choose which master page to use - `Site.master` or `Alternate.master` - and save this choice in a Session variable.</span></span> <span data-ttu-id="f0bc2-245">Začněte vytvořením nové webové stránky v kořenovém adresáři s názvem `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-245">Start by creating a new web page in the root directory named `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="f0bc2-246">Při vytváření této stránky (nebo jakékoli jiné stránky obsahu) ji nemusíte navazovat na vzorovou stránku, protože stránka předlohy je nastavena programově v `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-246">When creating this page (or any other content pages henceforth) you don't need to bind it to a master page because the master page is set programmatically in `BasePage`.</span></span> <span data-ttu-id="f0bc2-247">Pokud však novou stránku nesvážete s hlavní stránkou, bude výchozí deklarativní označení nové stránky obsahovat webový formulář a další obsah poskytnutý stránkou předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-247">However, if you do not bind the new page to a master page then the new page's default declarative markup contains a Web Form and other content supplied by the master page.</span></span> <span data-ttu-id="f0bc2-248">Tento kód bude nutné ručně nahradit odpovídajícími ovládacími prvky obsahu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-248">You'll need to manually replace this markup with the appropriate Content controls.</span></span> <span data-ttu-id="f0bc2-249">Z tohoto důvodu je snazší vytvořit novou stránku ASP.NET s hlavní stránkou.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-249">For that reason, I find it easier to bind the new ASP.NET page to a master page.</span></span>

> [!NOTE]
> <span data-ttu-id="f0bc2-250">Vzhledem k tomu, že `Site.master` a `Alternate.master` mají stejnou sadu ovládacích prvků ContentPlaceHolder, nezáleží na tom, jakou stránku předlohy jste si zvolili při vytváření nové stránky obsahu.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-250">Because `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls it doesn't matter what master page you choose when creating the new content page.</span></span> <span data-ttu-id="f0bc2-251">V případě konzistence doporučujeme použít `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-251">For consistency, I'd suggest using `Site.master`.</span></span>

<span data-ttu-id="f0bc2-252">[![přidání nové stránky obsahu na web](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-252">[![Add a New Content Page to the Website](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span></span>

<span data-ttu-id="f0bc2-253">**Obrázek 05**: Přidání nové stránky obsahu na web ([kliknutím zobrazíte obrázek v plné velikosti](specifying-the-master-page-programmatically-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="f0bc2-253">**Figure 05**: Add a New Content Page to the Website ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image15.png))</span></span>

<span data-ttu-id="f0bc2-254">Aktualizujte soubor `Web.sitemap` tak, aby obsahoval položku pro tuto lekci.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-254">Update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="f0bc2-255">Přidejte následující kód pod `<siteMapNode>` pro stránku předlohy a lekci ASP.NET AJAX:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-255">Add the following markup beneath the `<siteMapNode>` for the Master Pages and ASP.NET AJAX lesson:</span></span>

[!code-xml[Main](specifying-the-master-page-programmatically-vb/samples/sample15.xml)]

<span data-ttu-id="f0bc2-256">Před přidáním jakéhokoli obsahu na stránku `ChooseMasterPage.aspx` chvíli aktualizujte třídu kódu na pozadí stránky tak, aby byla odvozena z `BasePage` (místo `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-256">Before adding any content to the `ChooseMasterPage.aspx` page take a moment to update the page's code-behind class so that it derives from `BasePage` (rather than `System.Web.UI.Page`).</span></span> <span data-ttu-id="f0bc2-257">Dále přidejte ovládací prvek DropDownList na stránku, nastavte jeho vlastnost `ID` na `MasterPageChoice`a přidejte dvě položky ListItems s hodnotami `Text` ~/site.Master a ~/Alternate.Master.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-257">Next, add a DropDownList control to the page, set its `ID` property to `MasterPageChoice`, and add two ListItems with the `Text` values of "~/Site.master" and "~/Alternate.master".</span></span>

<span data-ttu-id="f0bc2-258">Přidejte na stránku webový ovládací prvek tlačítko a nastavte jeho `ID` a vlastnosti `Text` na `SaveLayout` a "Uložit výběr rozložení" v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-258">Add a Button Web control to the page and set its `ID` and `Text` properties to `SaveLayout` and "Save Layout Choice", respectively.</span></span> <span data-ttu-id="f0bc2-259">V tomto okamžiku by deklarativní označení stránky mělo vypadat podobně jako v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-259">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample16.aspx)]

<span data-ttu-id="f0bc2-260">Při prvním navštívení stránky musíme zobrazit aktuálně vybranou volbu hlavní stránky uživatele.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-260">When the page is first visited we need to display the user's currently selected master page choice.</span></span> <span data-ttu-id="f0bc2-261">Vytvořte obslužnou rutinu události `Page_Load` a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-261">Create a `Page_Load` event handler and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample17.vb)]

<span data-ttu-id="f0bc2-262">Výše uvedený kód se spustí pouze na první stránce (a ne při následném postbacku).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-262">The above code executes only on the first page visit (and not on subsequent postbacks).</span></span> <span data-ttu-id="f0bc2-263">Nejprve zkontroluje, zda `MyMasterPage` existuje proměnná relace.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-263">It first checks to see if the Session variable `MyMasterPage` exists.</span></span> <span data-ttu-id="f0bc2-264">Pokud k tomu dojde, pokusí se najít shodu ListItem v `MasterPageChoice` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-264">If it does, it attempts to find the matching ListItem in the `MasterPageChoice` DropDownList.</span></span> <span data-ttu-id="f0bc2-265">Pokud je nalezen odpovídající ListItem, vlastnost `Selected` je nastavena na hodnotu `True`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-265">If a matching ListItem is found, its `Selected` property is set to `True`.</span></span>

<span data-ttu-id="f0bc2-266">Potřebujeme také kód, který uloží volbu uživatele do proměnné `MyMasterPage` relace.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-266">We also need code that saves the user's choice into the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="f0bc2-267">Vytvořte obslužnou rutinu události pro událost `Click` `SaveLayout`ho tlačítka a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-267">Create an event handler for the `SaveLayout` Button's `Click` event and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample18.vb)]

> [!NOTE]
> <span data-ttu-id="f0bc2-268">V době, kdy se obslužná rutina události `Click` spustí při zpětném volání, již byla vybrána stránka předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-268">By the time the `Click` event handler executes on postback, the master page has already been selected.</span></span> <span data-ttu-id="f0bc2-269">Proto výběr rozevíracího seznamu uživatele nebude platit, dokud další stránka nenavštíví.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-269">Therefore, the user's drop-down list selection won't be in effect until the next page visit.</span></span> <span data-ttu-id="f0bc2-270">`Response.Redirect` vynutí, aby prohlížeč znovu vyžádal `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-270">The `Response.Redirect` forces the browser to re-request `ChooseMasterPage.aspx`.</span></span>

<span data-ttu-id="f0bc2-271">Po dokončení stránky `ChooseMasterPage.aspx` má náš konečný úkol, aby se vlastnost `MasterPageFile` přiřadila `BasePage` na základě hodnoty proměnné relace `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-271">With the `ChooseMasterPage.aspx` page complete, our final task is to have `BasePage` assign the `MasterPageFile` property based on the value of the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="f0bc2-272">Pokud není nastavená proměnná relace, `BasePage` výchozí `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-272">If the Session variable is not set have `BasePage` default to `Site.master`.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample19.vb)]

> [!NOTE]
> <span data-ttu-id="f0bc2-273">Přesunuli jsme kód, který přiřadí vlastnost `MasterPageFile` `Page` objektu z obslužné rutiny události `OnPreInit` a do dvou samostatných metod.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-273">I moved the code that assigns the `Page` object's `MasterPageFile` property out of the `OnPreInit` event handler and into two separate methods.</span></span> <span data-ttu-id="f0bc2-274">Tato první metoda, `SetMasterPageFile`, přiřadí vlastnost `MasterPageFile` hodnotě vrácené druhou metodou `GetMasterPageFileFromSession`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-274">This first method, `SetMasterPageFile`, assigns the `MasterPageFile` property to the value returned by the second method, `GetMasterPageFileFromSession`.</span></span> <span data-ttu-id="f0bc2-275">Označil (a) metodu `SetMasterPageFile` `Overridable` tak, aby budoucí třídy, které přesahují `BasePage`, mohly případně přepsat, aby v případě potřeby implementovaly vlastní logiku.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-275">I marked the `SetMasterPageFile` method `Overridable` so that future classes that extend `BasePage` can optionally override it to implement custom logic, if needed.</span></span> <span data-ttu-id="f0bc2-276">V dalším kurzu se zobrazí příklad přepsání `SetMasterPageFile` vlastnosti `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-276">We'll see an example of overriding `BasePage`'s `SetMasterPageFile` property in the next tutorial.</span></span>

<span data-ttu-id="f0bc2-277">S tímto kódem je místo na stránce `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-277">With this code in place, visit the `ChooseMasterPage.aspx` page.</span></span> <span data-ttu-id="f0bc2-278">Zpočátku je vybraná stránka předlohy `Site.master` (viz obrázek 6), ale uživatel může z rozevíracího seznamu vybrat jinou stránku předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-278">Initially, the `Site.master` master page is selected (see Figure 6), but the user can pick a different master page from the drop-down list.</span></span>

<span data-ttu-id="f0bc2-279">[![stránky obsahu se zobrazí pomocí stránky site. master master.](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-279">[![Content Pages are Displayed Using the Site.master Master Page](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span></span>

<span data-ttu-id="f0bc2-280">**Obrázek 6**: stránky obsahu se zobrazují pomocí `Site.master` stránky předlohy ([kliknutím zobrazíte obrázek v plné velikosti).](specifying-the-master-page-programmatically-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-280">**Figure 06**: Content Pages are Displayed Using the `Site.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image18.png))</span></span>

<span data-ttu-id="f0bc2-281">[![stránky obsahu se nyní zobrazují pomocí alternativní stránky. Hlavní stránka předlohy.](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-281">[![Content Pages are Now Displayed Using the Alternate.master Master Page](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span></span>

<span data-ttu-id="f0bc2-282">**Obrázek 7**: stránky obsahu se nyní zobrazují pomocí `Alternate.master` stránky předlohy ([kliknutím zobrazíte obrázek v plné velikosti).](specifying-the-master-page-programmatically-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-282">**Figure 07**: Content Pages are Now Displayed Using the `Alternate.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image21.png))</span></span>

## <a name="summary"></a><span data-ttu-id="f0bc2-283">Souhrn</span><span class="sxs-lookup"><span data-stu-id="f0bc2-283">Summary</span></span>

<span data-ttu-id="f0bc2-284">Po navštívení stránky obsahu jsou ovládací prvky tohoto obsahu poopatřeny ovládacími prvky ContentPlaceHolder stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-284">When a content page is visited, its Content controls are fused with its master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="f0bc2-285">Stránka předlohy stránky obsahu je označena vlastností `MasterPageFile` třídy `Page`, která je přiřazena k atributu `MasterPageFile` direktivy `@Page` během inicializační fáze.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-285">The content page's master page is denoted by the `Page` class's `MasterPageFile` property, which is assigned to the `@Page` directive's `MasterPageFile` attribute during the Initialization stage.</span></span> <span data-ttu-id="f0bc2-286">Jak je znázorněno v tomto kurzu, můžeme přiřadit hodnotu vlastnosti `MasterPageFile`, pokud to uděláte před koncem fáze předinicializace.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-286">As this tutorial showed, we can assign a value to the `MasterPageFile` property as long as we do so before the end of the PreInit stage.</span></span> <span data-ttu-id="f0bc2-287">Schopnost programově určit stránku předlohy otevře dvířka pro pokročilejší scénáře, jako je například dynamická vazba stránky obsahu na hlavní stránku na základě externích faktorů.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-287">Being able to programmatically specify the master page opens the door for more advanced scenarios, such as dynamically binding a content page to a master page based on external factors.</span></span>

<span data-ttu-id="f0bc2-288">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="f0bc2-288">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="f0bc2-289">Další čtení</span><span class="sxs-lookup"><span data-stu-id="f0bc2-289">Further Reading</span></span>

<span data-ttu-id="f0bc2-290">Další informace o tématech popsaných v tomto kurzu najdete v následujících zdrojích informací:</span><span class="sxs-lookup"><span data-stu-id="f0bc2-290">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f0bc2-291">Diagram životního cyklu stránky ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f0bc2-291">ASP.NET Page Lifecycle Diagram</span></span>](http://emanish.googlepages.com/Asp.Net2.0Lifecycle.PNG)
- [<span data-ttu-id="f0bc2-292">ASP.NET – přehled životního cyklu stránky</span><span class="sxs-lookup"><span data-stu-id="f0bc2-292">ASP.NET Page Lifecycle Overview</span></span>](https://msdn.microsoft.com/library/ms178472.aspx)
- [<span data-ttu-id="f0bc2-293">Přehled motivů a vzhledů ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f0bc2-293">ASP.NET Themes and Skins Overview</span></span>](https://msdn.microsoft.com/library/ykzx33wh.aspx)
- [<span data-ttu-id="f0bc2-294">Stránky předlohy: tipy, triky a depeše</span><span class="sxs-lookup"><span data-stu-id="f0bc2-294">Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="f0bc2-295">Motivy v ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f0bc2-295">Themes in ASP.NET</span></span>](http://www.odetocode.com/articles/423.aspx)

### <a name="about-the-author"></a><span data-ttu-id="f0bc2-296">O autorovi</span><span class="sxs-lookup"><span data-stu-id="f0bc2-296">About the Author</span></span>

<span data-ttu-id="f0bc2-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor několika stránek ASP/ASP. NET Books a zakladatel of 4GuysFromRolla.com, pracoval s webovými technologiemi microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f0bc2-298">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-298">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f0bc2-299">Nejnovější kniha je [*Sams naučit se ASP.NET 3,5 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-299">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="f0bc2-300">Scott se dá kontaktovat [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) nebo prostřednictvím svého blogu na [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="f0bc2-300">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="f0bc2-301">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="f0bc2-301">Special Thanks To</span></span>

<span data-ttu-id="f0bc2-302">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-302">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f0bc2-303">Vedoucí recenzent pro tento kurz byl takový Banerjee.</span><span class="sxs-lookup"><span data-stu-id="f0bc2-303">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="f0bc2-304">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="f0bc2-304">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f0bc2-305">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-305">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f0bc2-306">[Předchozí](master-pages-and-asp-net-ajax-vb.md)
> [Další](nested-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f0bc2-306">[Previous](master-pages-and-asp-net-ajax-vb.md)
[Next](nested-master-pages-vb.md)</span></span>
