---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
title: Začínáme s Entity Framework 4,0 Database First a webovými formuláři ASP.NET 4 – část 7 | Microsoft Docs
author: tdykstra
description: Ukázková webová aplikace společnosti Contoso University ukazuje, jak pomocí Entity Framework vytvořit aplikace webových formulářů ASP.NET. Ukázková aplikace je...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: f8afb245-b705-419c-8790-0b295e90d5e2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
msc.type: authoredcontent
ms.openlocfilehash: 18d4b44c5e23fd6942c3adf48a33a5602e6df6d0
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78603430"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-7"></a><span data-ttu-id="ae275-104">Začínáme s Entity Framework 4,0 Database First a webovými formuláři ASP.NET 4 – část 7</span><span class="sxs-lookup"><span data-stu-id="ae275-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 7</span></span>

<span data-ttu-id="ae275-105">tím, že [Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="ae275-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="ae275-106">Ukázková webová aplikace společnosti Contoso University ukazuje, jak pomocí Entity Framework 4,0 a sady Visual Studio 2010 vytvářet aplikace webových formulářů ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="ae275-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="ae275-107">Informace o řadě kurzů najdete v [prvním kurzu v řadě](the-entity-framework-and-aspnet-getting-started-part-1.md) .</span><span class="sxs-lookup"><span data-stu-id="ae275-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="using-stored-procedures"></a><span data-ttu-id="ae275-108">Použití uložených procedur</span><span class="sxs-lookup"><span data-stu-id="ae275-108">Using Stored Procedures</span></span>

<span data-ttu-id="ae275-109">V předchozím kurzu jste implementovali vzor dědičnosti tabulky na hierarchii.</span><span class="sxs-lookup"><span data-stu-id="ae275-109">In the previous tutorial you implemented a table-per-hierarchy inheritance pattern.</span></span> <span data-ttu-id="ae275-110">V tomto kurzu se dozvíte, jak pomocí uložených procedur získat větší kontrolu nad přístupem k databázi.</span><span class="sxs-lookup"><span data-stu-id="ae275-110">This tutorial will show you how to use stored procedures to gain more control over database access.</span></span>

<span data-ttu-id="ae275-111">Entity Framework vám umožní určit, že má používat uložené procedury pro přístup k databázi.</span><span class="sxs-lookup"><span data-stu-id="ae275-111">The Entity Framework lets you specify that it should use stored procedures for database access.</span></span> <span data-ttu-id="ae275-112">Pro libovolný typ entity můžete zadat uloženou proceduru, která se má použít k vytvoření, aktualizaci nebo odstranění entit daného typu.</span><span class="sxs-lookup"><span data-stu-id="ae275-112">For any entity type, you can specify a stored procedure to use for creating, updating, or deleting entities of that type.</span></span> <span data-ttu-id="ae275-113">V datovém modelu pak můžete přidat odkazy na uložené procedury, které lze použít k provádění úloh, jako je například načítání sad entit.</span><span class="sxs-lookup"><span data-stu-id="ae275-113">Then in the data model you can add references to stored procedures that you can use to perform tasks such as retrieving sets of entities.</span></span>

<span data-ttu-id="ae275-114">Použití uložených procedur je běžným požadavkem pro přístup k databázi.</span><span class="sxs-lookup"><span data-stu-id="ae275-114">Using stored procedures is a common requirement for database access.</span></span> <span data-ttu-id="ae275-115">V některých případech může správce databáze vyžadovat, aby všechny přístupy k databázi procházely prostřednictvím uložených procedur z bezpečnostních důvodů.</span><span class="sxs-lookup"><span data-stu-id="ae275-115">In some cases a database administrator may require that all database access go through stored procedures for security reasons.</span></span> <span data-ttu-id="ae275-116">V jiných případech může být vhodné vytvořit obchodní logiku do některých procesů, které Entity Framework používá při aktualizaci databáze.</span><span class="sxs-lookup"><span data-stu-id="ae275-116">In other cases you may want to build business logic into some of the processes that the Entity Framework uses when it updates the database.</span></span> <span data-ttu-id="ae275-117">Například pokaždé, když se odstraní entita, může být vhodné ji zkopírovat do archivní databáze.</span><span class="sxs-lookup"><span data-stu-id="ae275-117">For example, whenever an entity is deleted you might want to copy it to an archive database.</span></span> <span data-ttu-id="ae275-118">Nebo kdykoli je řádek aktualizován, může být vhodné zapsat řádek do tabulky protokolování, která zaznamenává, kdo provedl změnu.</span><span class="sxs-lookup"><span data-stu-id="ae275-118">Or whenever a row is updated you might want to write a row to a logging table that records who made the change.</span></span> <span data-ttu-id="ae275-119">Tyto typy úloh můžete provádět v uložené proceduře, která je volána vždy, když Entity Framework odstraní entitu nebo aktualizuje entitu.</span><span class="sxs-lookup"><span data-stu-id="ae275-119">You can perform these kinds of tasks in a stored procedure that's called whenever the Entity Framework deletes an entity or updates an entity.</span></span>

<span data-ttu-id="ae275-120">Stejně jako v předchozím kurzu nebudete vytvářet žádné nové stránky.</span><span class="sxs-lookup"><span data-stu-id="ae275-120">As in the previous tutorial, you'll not create any new pages.</span></span> <span data-ttu-id="ae275-121">Místo toho změníte způsob, jakým Entity Framework přistupuje k databázi pro některé stránky, které jste už vytvořili.</span><span class="sxs-lookup"><span data-stu-id="ae275-121">Instead, you'll change the way the Entity Framework accesses the database for some of the pages you already created.</span></span>

<span data-ttu-id="ae275-122">V tomto kurzu vytvoříte uložené procedury v databázi pro vkládání entit `Student` a `Instructor`.</span><span class="sxs-lookup"><span data-stu-id="ae275-122">In this tutorial you'll create stored procedures in the database for inserting `Student` and `Instructor` entities.</span></span> <span data-ttu-id="ae275-123">Přidáte je do datového modelu a určíte, že Entity Framework by je měli použít pro přidání `Student` a `Instructor` entit do databáze.</span><span class="sxs-lookup"><span data-stu-id="ae275-123">You'll add them to the data model, and you'll specify that the Entity Framework should use them for adding `Student` and `Instructor` entities to the database.</span></span> <span data-ttu-id="ae275-124">Vytvoříte také uloženou proceduru, kterou můžete použít k načtení entit `Course`.</span><span class="sxs-lookup"><span data-stu-id="ae275-124">You'll also create a stored procedure that you can use to retrieve `Course` entities.</span></span>

## <a name="creating-stored-procedures-in-the-database"></a><span data-ttu-id="ae275-125">Vytváření uložených procedur v databázi</span><span class="sxs-lookup"><span data-stu-id="ae275-125">Creating Stored Procedures in the Database</span></span>

<span data-ttu-id="ae275-126">(Pokud používáte soubor *School. mdf* z projektu, který je k dispozici ke stažení v tomto kurzu, můžete tento oddíl přeskočit, protože uložené procedury již existují.)</span><span class="sxs-lookup"><span data-stu-id="ae275-126">(If you're using the *School.mdf* file from the project available for download with this tutorial, you can skip this section because the stored procedures already exist.)</span></span>

<span data-ttu-id="ae275-127">V **Průzkumník serveru**rozbalte *School. mdf*, klikněte pravým tlačítkem na **uložené procedury**a vyberte **Přidat novou uloženou proceduru**.</span><span class="sxs-lookup"><span data-stu-id="ae275-127">In **Server Explorer**, expand *School.mdf*, right-click **Stored Procedures**, and select **Add New Stored Procedure**.</span></span>

<span data-ttu-id="ae275-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span></span>

<span data-ttu-id="ae275-129">Zkopírujte následující příkazy SQL a vložte je do okna uložené procedury, kde nahradíte kostru uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="ae275-129">Copy the following SQL statements and paste them into the stored procedure window, replacing the skeleton stored procedure.</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample1.sql)]

<span data-ttu-id="ae275-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span></span>

<span data-ttu-id="ae275-131">`Student` entit mají čtyři vlastnosti: `PersonID`, `LastName`, `FirstName`a `EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="ae275-131">`Student` entities have four properties: `PersonID`, `LastName`, `FirstName`, and `EnrollmentDate`.</span></span> <span data-ttu-id="ae275-132">Databáze automaticky vygeneruje hodnotu ID a uložená procedura akceptuje parametry pro ostatní tři.</span><span class="sxs-lookup"><span data-stu-id="ae275-132">The database generates the ID value automatically, and the stored procedure accepts parameters for the other three.</span></span> <span data-ttu-id="ae275-133">Uložená procedura vrátí hodnotu klíče záznamu nového řádku, aby Entity Framework mohl sledovat to, co je ve verzi entity, kterou udržuje v paměti.</span><span class="sxs-lookup"><span data-stu-id="ae275-133">The stored procedure returns the value of the new row's record key so that the Entity Framework can keep track of that in the version of the entity it keeps in memory.</span></span>

<span data-ttu-id="ae275-134">Uložte a zavřete okno uložená procedura.</span><span class="sxs-lookup"><span data-stu-id="ae275-134">Save and close the stored procedure window.</span></span>

<span data-ttu-id="ae275-135">Vytvořte `InsertInstructor` uloženou proceduru stejným způsobem pomocí následujících příkazů SQL:</span><span class="sxs-lookup"><span data-stu-id="ae275-135">Create an `InsertInstructor` stored procedure in the same manner, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample2.sql)]

<span data-ttu-id="ae275-136">Vytváření `Update` uložených procedur pro `Student` a `Instructor` entit.</span><span class="sxs-lookup"><span data-stu-id="ae275-136">Create `Update` stored procedures for `Student` and `Instructor` entities also.</span></span> <span data-ttu-id="ae275-137">(Databáze již obsahuje `DeletePerson` uloženou proceduru, která bude fungovat pro `Instructor` a `Student` entit.)</span><span class="sxs-lookup"><span data-stu-id="ae275-137">(The database already has a `DeletePerson` stored procedure which will work for both `Instructor` and `Student` entities.)</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample3.sql)]

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample4.sql)]

<span data-ttu-id="ae275-138">V tomto kurzu namapujete všechny tři funkce--INSERT, Update a DELETE – pro každý typ entity.</span><span class="sxs-lookup"><span data-stu-id="ae275-138">In this tutorial you'll map all three functions -- insert, update, and delete -- for each entity type.</span></span> <span data-ttu-id="ae275-139">Entity Framework verze 4 umožňuje mapovat pouze jednu nebo dvě z těchto funkcí na uložené procedury bez mapování ostatních, s jednou výjimkou: Pokud namapujete funkci Update, ale ne funkci odstranit, Entity Framework vyvolá výjimku při pokus o odstranění entity</span><span class="sxs-lookup"><span data-stu-id="ae275-139">The Entity Framework version 4 allows you to map just one or two of these functions to stored procedures without mapping the others, with one exception: if you map the update function but not the delete function, the Entity Framework will throw an exception when you attempt to delete an entity.</span></span> <span data-ttu-id="ae275-140">V Entity Framework verze 3,5 jste v rámci mapování uložených procedur neměli velkou flexibilitu: Pokud jste namapovali jednu funkci, kterou jste museli namapovat na všechny tři.</span><span class="sxs-lookup"><span data-stu-id="ae275-140">In the Entity Framework version 3.5, you did not have this much flexibility in mapping stored procedures: if you mapped one function you were required to map all three.</span></span>

<span data-ttu-id="ae275-141">Chcete-li vytvořit uloženou proceduru, která místo aktualizací dat načítá data, vytvořte ji, která vybere všechny `Course` entit pomocí následujících příkazů SQL:</span><span class="sxs-lookup"><span data-stu-id="ae275-141">To create a stored procedure that reads rather than updates data, create one that selects all `Course` entities, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample5.sql)]

## <a name="adding-the-stored-procedures-to-the-data-model"></a><span data-ttu-id="ae275-142">Přidání uložených procedur do datového modelu</span><span class="sxs-lookup"><span data-stu-id="ae275-142">Adding the Stored Procedures to the Data Model</span></span>

<span data-ttu-id="ae275-143">Uložené procedury jsou nyní definovány v databázi, ale musí být přidány do datového modelu, aby byly k dispozici pro Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="ae275-143">The stored procedures are now defined in the database, but they must be added to the data model to make them available to the Entity Framework.</span></span> <span data-ttu-id="ae275-144">Otevřete *SchoolModel. edmx*, klikněte pravým tlačítkem myši na návrhovou plochu a vyberte **aktualizovat model z databáze**.</span><span class="sxs-lookup"><span data-stu-id="ae275-144">Open *SchoolModel.edmx*, right-click the design surface, and select **Update Model from Database**.</span></span> <span data-ttu-id="ae275-145">Na kartě **Přidat** dialogového okna **zvolit objekty databáze** rozbalte **uložené procedury**, vyberte nově vytvořené uložené procedury a uloženou proceduru `DeletePerson` a pak klikněte na **Dokončit**.</span><span class="sxs-lookup"><span data-stu-id="ae275-145">In the **Add** tab of the **Choose Your Database Objects** dialog box, expand **Stored Procedures**, select the newly created stored procedures and the `DeletePerson` stored procedure, and then click **Finish**.</span></span>

<span data-ttu-id="ae275-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span></span>

## <a name="mapping-the-stored-procedures"></a><span data-ttu-id="ae275-147">Mapování uložených procedur</span><span class="sxs-lookup"><span data-stu-id="ae275-147">Mapping the Stored Procedures</span></span>

<span data-ttu-id="ae275-148">V návrháři datového modelu klikněte pravým tlačítkem na entitu `Student` a vyberte možnost **mapování uložených procedur**.</span><span class="sxs-lookup"><span data-stu-id="ae275-148">In the data model designer, right-click the `Student` entity and select **Stored Procedure Mapping**.</span></span>

<span data-ttu-id="ae275-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span></span>

<span data-ttu-id="ae275-150">Zobrazí se okno **Podrobnosti mapování** , ve kterém můžete zadat uložené procedury, které má Entity Framework použít pro vkládání, aktualizaci a odstraňování entit tohoto typu.</span><span class="sxs-lookup"><span data-stu-id="ae275-150">The **Mapping Details** window appears, in which you can specify stored procedures that the Entity Framework should use for inserting, updating, and deleting entities of this type.</span></span>

<span data-ttu-id="ae275-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span></span>

<span data-ttu-id="ae275-152">Nastavte funkci **INSERT** na **InsertStudent**.</span><span class="sxs-lookup"><span data-stu-id="ae275-152">Set the **Insert** function to **InsertStudent**.</span></span> <span data-ttu-id="ae275-153">V okně se zobrazí seznam parametrů uložených procedur, z nichž každá musí být namapována na vlastnost entity.</span><span class="sxs-lookup"><span data-stu-id="ae275-153">The window shows a list of stored procedure parameters, each of which must be mapped to an entity property.</span></span> <span data-ttu-id="ae275-154">Dvě z nich jsou namapovány automaticky, protože názvy jsou stejné.</span><span class="sxs-lookup"><span data-stu-id="ae275-154">Two of these are mapped automatically because the names are the same.</span></span> <span data-ttu-id="ae275-155">Neexistuje žádná vlastnost entity s názvem `FirstName`, takže musíte ručně vybrat `FirstMidName` z rozevíracího seznamu, který zobrazuje dostupné vlastnosti entity.</span><span class="sxs-lookup"><span data-stu-id="ae275-155">There's no entity property named `FirstName`, so you must manually select `FirstMidName` from a drop-down list that shows available entity properties.</span></span> <span data-ttu-id="ae275-156">(To je proto, že jste změnili název vlastnosti `FirstName` na `FirstMidName` v prvním kurzu.)</span><span class="sxs-lookup"><span data-stu-id="ae275-156">(This is because you changed the name of the `FirstName` property to `FirstMidName` in the first tutorial.)</span></span>

<span data-ttu-id="ae275-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span></span>

<span data-ttu-id="ae275-158">Ve stejném okně **podrobností mapování** namapujte funkci `Update` na `UpdateStudent` uloženou proceduru (Ujistěte se, že jste zadali `FirstMidName` jako hodnotu parametru pro `FirstName`, jako jste byli pro `Insert` uloženou proceduru) a `Delete` funkcí do uložené procedury `DeletePerson`.</span><span class="sxs-lookup"><span data-stu-id="ae275-158">In the same **Mapping Details** window, map the `Update` function to the `UpdateStudent` stored procedure (make sure you specify `FirstMidName` as the parameter value for `FirstName`, as you did for the `Insert` stored procedure) and the `Delete` function to the `DeletePerson` stored procedure.</span></span>

<span data-ttu-id="ae275-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span></span>

<span data-ttu-id="ae275-160">Použijte stejný postup k namapování uložených procedur vložení, aktualizace a odstranění pro instruktory na `Instructor` entitu.</span><span class="sxs-lookup"><span data-stu-id="ae275-160">Follow the same procedure to map the insert, update, and delete stored procedures for instructors to the `Instructor` entity.</span></span>

<span data-ttu-id="ae275-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span></span>

<span data-ttu-id="ae275-162">U uložených procedur, které jsou čteny namísto aktualizací dat, použijete okno **prohlížeče modelů** k namapování úložné procedury na typ entity, kterou vrátí.</span><span class="sxs-lookup"><span data-stu-id="ae275-162">For stored procedures that read rather than update data, you use the **Model Browser** window to map the stored procedure to the entity type it returns.</span></span> <span data-ttu-id="ae275-163">V návrháři datového modelu klikněte pravým tlačítkem myši na návrhovou plochu a vyberte možnost **prohlížeč modelů**.</span><span class="sxs-lookup"><span data-stu-id="ae275-163">In the data model designer, right-click the design surface and select **Model Browser**.</span></span> <span data-ttu-id="ae275-164">Otevřete uzel **SchoolModel. Store** a pak otevřete uzel **uložené procedury** .</span><span class="sxs-lookup"><span data-stu-id="ae275-164">Open the **SchoolModel.Store** node and then open the **Stored Procedures** node.</span></span> <span data-ttu-id="ae275-165">Pak klikněte pravým tlačítkem na uloženou proceduru `GetCourses` a vyberte **Přidat import funkce**.</span><span class="sxs-lookup"><span data-stu-id="ae275-165">Then right-click the `GetCourses` stored procedure and select **Add Function Import**.</span></span>

<span data-ttu-id="ae275-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span></span>

<span data-ttu-id="ae275-167">V dialogovém okně **Přidat import funkce** v části **vrátí kolekci** vybraných **entit**a vyberte možnost `Course` jako typ entity vráceno.</span><span class="sxs-lookup"><span data-stu-id="ae275-167">In the **Add Function Import** dialog box, under **Returns a Collection Of** select **Entities**, and then select `Course` as the entity type returned.</span></span> <span data-ttu-id="ae275-168">Až to budete mít, klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="ae275-168">When you're done, click **OK**.</span></span> <span data-ttu-id="ae275-169">Uložte a zavřete soubor *. edmx* .</span><span class="sxs-lookup"><span data-stu-id="ae275-169">Save and close the *.edmx* file.</span></span>

<span data-ttu-id="ae275-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span></span>

## <a name="using-insert-update-and-delete-stored-procedures"></a><span data-ttu-id="ae275-171">Použití uložených procedur INSERT, Update a DELETE</span><span class="sxs-lookup"><span data-stu-id="ae275-171">Using Insert, Update, and Delete Stored Procedures</span></span>

<span data-ttu-id="ae275-172">Uložené procedury pro vkládání, aktualizaci a odstraňování dat jsou Entity Framework automaticky používány po jejich přidání do datového modelu a namapovány na příslušné entity.</span><span class="sxs-lookup"><span data-stu-id="ae275-172">Stored procedures to insert, update, and delete data are used by the Entity Framework automatically after you've added them to the data model and mapped them to the appropriate entities.</span></span> <span data-ttu-id="ae275-173">Nyní můžete spustit stránku *StudentsAdd. aspx* a pokaždé, když vytvoříte nového studenta, Entity Framework použijí uloženou proceduru `InsertStudent` k přidání nového řádku do tabulky `Student`.</span><span class="sxs-lookup"><span data-stu-id="ae275-173">You can now run the *StudentsAdd.aspx* page, and every time you create a new student, the Entity Framework will use the `InsertStudent` stored procedure to add the new row to the `Student` table.</span></span>

<span data-ttu-id="ae275-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span></span>

<span data-ttu-id="ae275-175">Spusťte stránku *students. aspx* a v seznamu se zobrazí nový student.</span><span class="sxs-lookup"><span data-stu-id="ae275-175">Run the *Students.aspx* page and the new student appears in the list.</span></span>

<span data-ttu-id="ae275-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span></span>

<span data-ttu-id="ae275-177">Změňte název, abyste ověřili, že funkce Update funguje a pak odstraňte studenta, abyste ověřili, že funkce Delete funguje.</span><span class="sxs-lookup"><span data-stu-id="ae275-177">Change the name to verify that the update function works, and then delete the student to verify that the delete function works.</span></span>

<span data-ttu-id="ae275-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ae275-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span></span>

## <a name="using-select-stored-procedures"></a><span data-ttu-id="ae275-179">Použití vybraných uložených procedur</span><span class="sxs-lookup"><span data-stu-id="ae275-179">Using Select Stored Procedures</span></span>

<span data-ttu-id="ae275-180">Entity Framework nespouští automaticky uložené procedury, jako je například `GetCourses`, a nelze je použít s ovládacím prvkem `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="ae275-180">The Entity Framework does not automatically run stored procedures such as `GetCourses`, and you cannot use them with the `EntityDataSource` control.</span></span> <span data-ttu-id="ae275-181">Pokud je chcete použít, zavolejte je z kódu.</span><span class="sxs-lookup"><span data-stu-id="ae275-181">To use them, you call them from code.</span></span>

<span data-ttu-id="ae275-182">Otevřete soubor *InstructorsCourses.aspx.cs* .</span><span class="sxs-lookup"><span data-stu-id="ae275-182">Open the *InstructorsCourses.aspx.cs* file.</span></span> <span data-ttu-id="ae275-183">Metoda `PopulateDropDownLists` používá dotaz LINQ to-Entities k načtení všech entit kurzu, aby mohla procházet seznam a zjistit, které z nich je k dis a které jsou nepřiřazené:</span><span class="sxs-lookup"><span data-stu-id="ae275-183">The `PopulateDropDownLists` method uses a LINQ-to-Entities query to retrieve all course entities so that it can loop through the list and determine which ones an instructor is assigned to and which ones are unassigned:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample6.cs)]

<span data-ttu-id="ae275-184">Nahraďte následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="ae275-184">Replace this with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample7.cs)]

<span data-ttu-id="ae275-185">Stránka teď používá uloženou proceduru `GetCourses` k načtení seznamu všech kurzů.</span><span class="sxs-lookup"><span data-stu-id="ae275-185">The page now uses the `GetCourses` stored procedure to retrieve the list of all courses.</span></span> <span data-ttu-id="ae275-186">Spusťte stránku, abyste ověřili, že funguje stejně jako dříve.</span><span class="sxs-lookup"><span data-stu-id="ae275-186">Run the page to verify that it works as it did before.</span></span>

<span data-ttu-id="ae275-187">(Navigační vlastnosti entit načtených uloženou procedurou nemusí být automaticky naplněny daty souvisejícími s těmito entitami v závislosti na `ObjectContext` výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="ae275-187">(Navigation properties of entities retrieved by a stored procedure might not be automatically populated with the data related to those entities, depending on `ObjectContext` default settings.</span></span> <span data-ttu-id="ae275-188">Další informace najdete v tématu [načítání souvisejících objektů](https://msdn.microsoft.com/library/bb896272.aspx) v knihovně MSDN.)</span><span class="sxs-lookup"><span data-stu-id="ae275-188">For more information, see [Loading Related Objects](https://msdn.microsoft.com/library/bb896272.aspx) in the MSDN Library.)</span></span>

<span data-ttu-id="ae275-189">V dalším kurzu se dozvíte, jak používat funkci dynamických dat, aby bylo snazší programovat a testovat formátování dat a pravidla ověřování.</span><span class="sxs-lookup"><span data-stu-id="ae275-189">In the next tutorial, you'll learn how to use Dynamic Data functionality to make it easier to program and test data formatting and validation rules.</span></span> <span data-ttu-id="ae275-190">Místo určení u každého pravidla webové stránky, jako jsou například řetězce formátu dat a zda je pole vyžadováno, můžete zadat taková pravidla v metadatech datového modelu a automaticky je použít na každé stránce.</span><span class="sxs-lookup"><span data-stu-id="ae275-190">Instead of specifying on each web page rules such as data format strings and whether or not a field is required, you can specify such rules in data model metadata and they're automatically applied on every page.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ae275-191">[Předchozí](the-entity-framework-and-aspnet-getting-started-part-6.md)
> [Další](the-entity-framework-and-aspnet-getting-started-part-8.md)</span><span class="sxs-lookup"><span data-stu-id="ae275-191">[Previous](the-entity-framework-and-aspnet-getting-started-part-6.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-8.md)</span></span>
