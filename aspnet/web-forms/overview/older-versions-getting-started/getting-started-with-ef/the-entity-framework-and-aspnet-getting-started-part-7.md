---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
title: Začínáme s Entity Framework 4.0 Database First a technologie ASP.NET 4 webových formulářů – 7. část | Dokumentace Microsoftu
author: tdykstra
description: Contoso University ukázkovou webovou aplikaci ukazuje, jak vytvořit aplikace webových formulářů ASP.NET pomocí Entity Frameworku. Ukázková aplikace je...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: f8afb245-b705-419c-8790-0b295e90d5e2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
msc.type: authoredcontent
ms.openlocfilehash: b976e8d611596f2cb58661a2e91b7a640ac04b9f
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/17/2019
ms.locfileid: "59416074"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-7"></a><span data-ttu-id="de963-104">Začínáme s Entity Framework 4.0 Database First a 4 webových formulářů ASP.NET – 7. část</span><span class="sxs-lookup"><span data-stu-id="de963-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 7</span></span>

<span data-ttu-id="de963-105">podle [Petr Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="de963-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="de963-106">Contoso University ukázkovou webovou aplikaci ukazuje, jak vytvořit aplikace webových formulářů ASP.NET pomocí Entity Framework 4.0 a Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="de963-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="de963-107">Informace o této sérii kurzů, naleznete v tématu [z prvního kurzu této série](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="de963-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>


## <a name="using-stored-procedures"></a><span data-ttu-id="de963-108">Použití uložených procedur</span><span class="sxs-lookup"><span data-stu-id="de963-108">Using Stored Procedures</span></span>

<span data-ttu-id="de963-109">V předchozím kurzu jste implementovali vzoru pro tabulky na hierarchii dědičnosti.</span><span class="sxs-lookup"><span data-stu-id="de963-109">In the previous tutorial you implemented a table-per-hierarchy inheritance pattern.</span></span> <span data-ttu-id="de963-110">Tomto kurzu se dozvíte, jak získat lepší kontrolu nad přístup k databázi pomocí uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="de963-110">This tutorial will show you how to use stored procedures to gain more control over database access.</span></span>

<span data-ttu-id="de963-111">Entity Framework umožňuje určit, že ji by měl používat uložené procedury pro přístup k databázi.</span><span class="sxs-lookup"><span data-stu-id="de963-111">The Entity Framework lets you specify that it should use stored procedures for database access.</span></span> <span data-ttu-id="de963-112">Pro každý typ entity můžete zadat uloženou proceduru pro vytvoření, aktualizace nebo odstranění entity daného typu.</span><span class="sxs-lookup"><span data-stu-id="de963-112">For any entity type, you can specify a stored procedure to use for creating, updating, or deleting entities of that type.</span></span> <span data-ttu-id="de963-113">Potom v datovém modelu můžete přidat odkazy na uložené procedury, které můžete použít k provedení úlohy, třeba načítání sady entit.</span><span class="sxs-lookup"><span data-stu-id="de963-113">Then in the data model you can add references to stored procedures that you can use to perform tasks such as retrieving sets of entities.</span></span>

<span data-ttu-id="de963-114">Použití uložených procedur je běžné požadavky pro přístup k databázi.</span><span class="sxs-lookup"><span data-stu-id="de963-114">Using stored procedures is a common requirement for database access.</span></span> <span data-ttu-id="de963-115">V některých případech správce databáze může vyžadovat, aby všechny přístup k databázi projít uložené procedury z bezpečnostních důvodů.</span><span class="sxs-lookup"><span data-stu-id="de963-115">In some cases a database administrator may require that all database access go through stored procedures for security reasons.</span></span> <span data-ttu-id="de963-116">V ostatních případech můžete chtít vytvořit obchodní logiky na některé procesy, které používá Entity Framework při aktualizaci databáze.</span><span class="sxs-lookup"><span data-stu-id="de963-116">In other cases you may want to build business logic into some of the processes that the Entity Framework uses when it updates the database.</span></span> <span data-ttu-id="de963-117">Například pokaždé, když se odstranění entity můžete zkopírovat do archivu databáze.</span><span class="sxs-lookup"><span data-stu-id="de963-117">For example, whenever an entity is deleted you might want to copy it to an archive database.</span></span> <span data-ttu-id="de963-118">Nebo pokaždé, když se aktualizuje řádek můžete zapsat řádek do tabulky protokolování, která zaznamenává, kteří provedli změnu.</span><span class="sxs-lookup"><span data-stu-id="de963-118">Or whenever a row is updated you might want to write a row to a logging table that records who made the change.</span></span> <span data-ttu-id="de963-119">Tyto druhy úloh můžete provádět v uloženou proceduru, která je volána pokaždé, když se odstraní entitu rozhraní Entity Framework nebo aktualizuje entitu.</span><span class="sxs-lookup"><span data-stu-id="de963-119">You can perform these kinds of tasks in a stored procedure that's called whenever the Entity Framework deletes an entity or updates an entity.</span></span>

<span data-ttu-id="de963-120">Stejně jako v předchozím kurzu vytvoříte nejsou žádné nové stránky.</span><span class="sxs-lookup"><span data-stu-id="de963-120">As in the previous tutorial, you'll not create any new pages.</span></span> <span data-ttu-id="de963-121">Místo toho změníte způsob, jak Entity Framework připojí se k databázi pro některý ze stránky, které jste už vytvořili.</span><span class="sxs-lookup"><span data-stu-id="de963-121">Instead, you'll change the way the Entity Framework accesses the database for some of the pages you already created.</span></span>

<span data-ttu-id="de963-122">V tomto kurzu vytvoříte uložené procedury v databázi pro vkládání `Student` a `Instructor` entity.</span><span class="sxs-lookup"><span data-stu-id="de963-122">In this tutorial you'll create stored procedures in the database for inserting `Student` and `Instructor` entities.</span></span> <span data-ttu-id="de963-123">Přidejte je do datového modelu, a specifikujete, že rozhraní Entity Framework by měl použít pro přidání `Student` a `Instructor` entity do databáze.</span><span class="sxs-lookup"><span data-stu-id="de963-123">You'll add them to the data model, and you'll specify that the Entity Framework should use them for adding `Student` and `Instructor` entities to the database.</span></span> <span data-ttu-id="de963-124">Také vytvoříte uloženou proceduru, která slouží k načtení `Course` entity.</span><span class="sxs-lookup"><span data-stu-id="de963-124">You'll also create a stored procedure that you can use to retrieve `Course` entities.</span></span>

## <a name="creating-stored-procedures-in-the-database"></a><span data-ttu-id="de963-125">Vytvoření uložené procedury v databázi</span><span class="sxs-lookup"><span data-stu-id="de963-125">Creating Stored Procedures in the Database</span></span>

<span data-ttu-id="de963-126">(Pokud používáte *School.mdf* soubor z projektu, které jsou k dispozici ke stažení v tomto kurzu, můžete tuto část přeskočit protože úložné procedury již neexistují.)</span><span class="sxs-lookup"><span data-stu-id="de963-126">(If you're using the *School.mdf* file from the project available for download with this tutorial, you can skip this section because the stored procedures already exist.)</span></span>

<span data-ttu-id="de963-127">V **Průzkumníka serveru**, rozbalte *School.mdf*, klikněte pravým tlačítkem na **uložené procedury**a vyberte **přidat novou uloženou proceduru**.</span><span class="sxs-lookup"><span data-stu-id="de963-127">In **Server Explorer**, expand *School.mdf*, right-click **Stored Procedures**, and select **Add New Stored Procedure**.</span></span>

<span data-ttu-id="de963-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="de963-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span></span>

<span data-ttu-id="de963-129">Zkopírujte následující příkazy SQL a vložte je do okna uloženou proceduru nahrazení kostru uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="de963-129">Copy the following SQL statements and paste them into the stored procedure window, replacing the skeleton stored procedure.</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample1.sql)]

<span data-ttu-id="de963-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="de963-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span></span>

<span data-ttu-id="de963-131">`Student` entity nemají čtyři vlastnosti: `PersonID`, `LastName`, `FirstName`, a `EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="de963-131">`Student` entities have four properties: `PersonID`, `LastName`, `FirstName`, and `EnrollmentDate`.</span></span> <span data-ttu-id="de963-132">Databáze automaticky generuje hodnotu ID a uložené procedury přijímá parametry pro další tři.</span><span class="sxs-lookup"><span data-stu-id="de963-132">The database generates the ID value automatically, and the stored procedure accepts parameters for the other three.</span></span> <span data-ttu-id="de963-133">Bude procedura vracet hodnoty klíče záznamu nový řádek tak, aby rozhraní Entity Framework můžete udržovat přehled o, který ve verzi entity, který udržuje v paměti.</span><span class="sxs-lookup"><span data-stu-id="de963-133">The stored procedure returns the value of the new row's record key so that the Entity Framework can keep track of that in the version of the entity it keeps in memory.</span></span>

<span data-ttu-id="de963-134">Uložte a zavřete okno uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="de963-134">Save and close the stored procedure window.</span></span>

<span data-ttu-id="de963-135">Vytvoření `InsertInstructor` uloženou proceduru stejným způsobem, pomocí následujících příkazů SQL:</span><span class="sxs-lookup"><span data-stu-id="de963-135">Create an `InsertInstructor` stored procedure in the same manner, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample2.sql)]

<span data-ttu-id="de963-136">Vytvoření `Update` uložené procedury pro `Student` a `Instructor` entity také.</span><span class="sxs-lookup"><span data-stu-id="de963-136">Create `Update` stored procedures for `Student` and `Instructor` entities also.</span></span> <span data-ttu-id="de963-137">(Databáze již obsahuje `DeletePerson` uloženou proceduru, která bude fungovat pro obě `Instructor` a `Student` entity.)</span><span class="sxs-lookup"><span data-stu-id="de963-137">(The database already has a `DeletePerson` stored procedure which will work for both `Instructor` and `Student` entities.)</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample3.sql)]

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample4.sql)]

<span data-ttu-id="de963-138">V tomto kurzu namapujete všechny tři funkce--insert, update a delete – pro každý typ entity.</span><span class="sxs-lookup"><span data-stu-id="de963-138">In this tutorial you'll map all three functions -- insert, update, and delete -- for each entity type.</span></span> <span data-ttu-id="de963-139">Rozhraní Entity Framework verze 4 umožňuje namapovat pouze jednu nebo dvě z nich fungovat tak, aby uložené procedury bez mapování jiné, s jednou výjimkou: Pokud namapujete funkce aktualizace, ale ne funkci odstranit, Entity Framework vyvolá výjimku při vám Pokus o odstranění entity.</span><span class="sxs-lookup"><span data-stu-id="de963-139">The Entity Framework version 4 allows you to map just one or two of these functions to stored procedures without mapping the others, with one exception: if you map the update function but not the delete function, the Entity Framework will throw an exception when you attempt to delete an entity.</span></span> <span data-ttu-id="de963-140">V rozhraní Entity Framework verze 3.5, neměl tolik flexibilitu při mapování uložené procedury: Pokud jste namapovali jednu funkci bylo nutné namapovat všechny tři.</span><span class="sxs-lookup"><span data-stu-id="de963-140">In the Entity Framework version 3.5, you did not have this much flexibility in mapping stored procedures: if you mapped one function you were required to map all three.</span></span>

<span data-ttu-id="de963-141">Vytvořit uloženou proceduru, která čte spíše než aktualizuje data, vytvořte ten, který vybere všechny `Course` entity, pomocí následujících příkazů SQL:</span><span class="sxs-lookup"><span data-stu-id="de963-141">To create a stored procedure that reads rather than updates data, create one that selects all `Course` entities, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample5.sql)]

## <a name="adding-the-stored-procedures-to-the-data-model"></a><span data-ttu-id="de963-142">Přidání uložených procedur do datového modelu</span><span class="sxs-lookup"><span data-stu-id="de963-142">Adding the Stored Procedures to the Data Model</span></span>

<span data-ttu-id="de963-143">Uložené procedury je nyní definována v databázi, ale musí být přidán do datového modelu, aby byly dostupné pro Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="de963-143">The stored procedures are now defined in the database, but they must be added to the data model to make them available to the Entity Framework.</span></span> <span data-ttu-id="de963-144">Otevřít *SchoolModel.edmx*, klikněte pravým tlačítkem na návrhové ploše a vyberte **aktualizace modelů z databáze**.</span><span class="sxs-lookup"><span data-stu-id="de963-144">Open *SchoolModel.edmx*, right-click the design surface, and select **Update Model from Database**.</span></span> <span data-ttu-id="de963-145">V **přidat** karty **zvolte vaše databázové objekty** dialogového okna rozbalte **uložené procedury**, vyberte nově vytvořený uložených procedur a `DeletePerson` uložené procedury a potom klikněte na tlačítko **Dokončit**.</span><span class="sxs-lookup"><span data-stu-id="de963-145">In the **Add** tab of the **Choose Your Database Objects** dialog box, expand **Stored Procedures**, select the newly created stored procedures and the `DeletePerson` stored procedure, and then click **Finish**.</span></span>

<span data-ttu-id="de963-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="de963-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span></span>

## <a name="mapping-the-stored-procedures"></a><span data-ttu-id="de963-147">Mapování uložené procedury</span><span class="sxs-lookup"><span data-stu-id="de963-147">Mapping the Stored Procedures</span></span>

<span data-ttu-id="de963-148">V Návrháři modelů dat, klikněte pravým tlačítkem myši `Student` entity a vyberte **mapování uložené procedury**.</span><span class="sxs-lookup"><span data-stu-id="de963-148">In the data model designer, right-click the `Student` entity and select **Stored Procedure Mapping**.</span></span>

<span data-ttu-id="de963-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="de963-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span></span>

<span data-ttu-id="de963-150">**Podrobnosti mapování** zobrazí se okno, ve kterém můžete zadat uložené procedury, které by měl používat Entity Framework pro vkládání, aktualizaci a odstraňování entit tohoto typu.</span><span class="sxs-lookup"><span data-stu-id="de963-150">The **Mapping Details** window appears, in which you can specify stored procedures that the Entity Framework should use for inserting, updating, and deleting entities of this type.</span></span>

<span data-ttu-id="de963-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="de963-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span></span>

<span data-ttu-id="de963-152">Nastavte **vložit** funkce **InsertStudent**.</span><span class="sxs-lookup"><span data-stu-id="de963-152">Set the **Insert** function to **InsertStudent**.</span></span> <span data-ttu-id="de963-153">V okně se seznamem parametrů uložené procedury, z nichž každý musí být namapována na vlastnost entity.</span><span class="sxs-lookup"><span data-stu-id="de963-153">The window shows a list of stored procedure parameters, each of which must be mapped to an entity property.</span></span> <span data-ttu-id="de963-154">Automaticky dvě z nich jsou mapovány názvy jsou stejné.</span><span class="sxs-lookup"><span data-stu-id="de963-154">Two of these are mapped automatically because the names are the same.</span></span> <span data-ttu-id="de963-155">Není žádná vlastnost entity s názvem `FirstName`, proto musíte ručně vybrat `FirstMidName` z rozevíracího seznamu, který zobrazuje vlastnosti dostupné entity.</span><span class="sxs-lookup"><span data-stu-id="de963-155">There's no entity property named `FirstName`, so you must manually select `FirstMidName` from a drop-down list that shows available entity properties.</span></span> <span data-ttu-id="de963-156">(Je to proto, že jste změnili název `FirstName` vlastnost `FirstMidName` v první kurz.)</span><span class="sxs-lookup"><span data-stu-id="de963-156">(This is because you changed the name of the `FirstName` property to `FirstMidName` in the first tutorial.)</span></span>

<span data-ttu-id="de963-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="de963-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span></span>

<span data-ttu-id="de963-158">Ve stejném **podrobnosti mapování** okna, mapování `Update` funkce `UpdateStudent` uložené procedury (ujistěte se, že zadáte `FirstMidName` jako hodnota parametru pro `FirstName`, jako jste to udělali `Insert` uložená procedura) a `Delete` funkce `DeletePerson` uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="de963-158">In the same **Mapping Details** window, map the `Update` function to the `UpdateStudent` stored procedure (make sure you specify `FirstMidName` as the parameter value for `FirstName`, as you did for the `Insert` stored procedure) and the `Delete` function to the `DeletePerson` stored procedure.</span></span>

<span data-ttu-id="de963-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="de963-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span></span>

<span data-ttu-id="de963-160">Použijte stejný postup k mapování insert, update a delete Instruktoři do uložených procedur `Instructor` entity.</span><span class="sxs-lookup"><span data-stu-id="de963-160">Follow the same procedure to map the insert, update, and delete stored procedures for instructors to the `Instructor` entity.</span></span>

<span data-ttu-id="de963-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="de963-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span></span>

<span data-ttu-id="de963-162">Pro uložené procedury, které čtou místo aktualizace dat, je použít **prohlížeč modelu** okna pro mapování na entitu uloženou proceduru zadejte jej vrátí.</span><span class="sxs-lookup"><span data-stu-id="de963-162">For stored procedures that read rather than update data, you use the **Model Browser** window to map the stored procedure to the entity type it returns.</span></span> <span data-ttu-id="de963-163">V Návrháři modelů dat, klikněte pravým tlačítkem na návrhové ploše a vyberte **prohlížeč modelu**.</span><span class="sxs-lookup"><span data-stu-id="de963-163">In the data model designer, right-click the design surface and select **Model Browser**.</span></span> <span data-ttu-id="de963-164">Otevřete **SchoolModel.Store** uzlu a pak otevřete **uložené procedury** uzlu.</span><span class="sxs-lookup"><span data-stu-id="de963-164">Open the **SchoolModel.Store** node and then open the **Stored Procedures** node.</span></span> <span data-ttu-id="de963-165">Klepněte pravým tlačítkem myši `GetCourses` uložené procedury a vyberte **přidání importované funkce**.</span><span class="sxs-lookup"><span data-stu-id="de963-165">Then right-click the `GetCourses` stored procedure and select **Add Function Import**.</span></span>

<span data-ttu-id="de963-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="de963-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span></span>

<span data-ttu-id="de963-167">V **přidání importované funkce** dialogovém okně **vrátí kolekce z** vyberte **entity**a pak vyberte `Course` vrácena jako typ entity.</span><span class="sxs-lookup"><span data-stu-id="de963-167">In the **Add Function Import** dialog box, under **Returns a Collection Of** select **Entities**, and then select `Course` as the entity type returned.</span></span> <span data-ttu-id="de963-168">Až to budete mít, klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="de963-168">When you're done, click **OK**.</span></span> <span data-ttu-id="de963-169">Uložte a zavřete *edmx* souboru.</span><span class="sxs-lookup"><span data-stu-id="de963-169">Save and close the *.edmx* file.</span></span>

<span data-ttu-id="de963-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="de963-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span></span>

## <a name="using-insert-update-and-delete-stored-procedures"></a><span data-ttu-id="de963-171">Pomocí vložení, aktualizace a odstranění uložených procedur</span><span class="sxs-lookup"><span data-stu-id="de963-171">Using Insert, Update, and Delete Stored Procedures</span></span>

<span data-ttu-id="de963-172">Uložené procedury pro vložení, aktualizace a odstranění dat se používají rozhraním Entity Framework automaticky po přidání do datového modelu a namapované na odpovídající entity.</span><span class="sxs-lookup"><span data-stu-id="de963-172">Stored procedures to insert, update, and delete data are used by the Entity Framework automatically after you've added them to the data model and mapped them to the appropriate entities.</span></span> <span data-ttu-id="de963-173">Teď můžete spustit *StudentsAdd.aspx* stránky, a při každém vytvoření nového objektu student používá Entity Framework `InsertStudent` uložené procedury, chcete-li přidat nový řádek `Student` tabulky.</span><span class="sxs-lookup"><span data-stu-id="de963-173">You can now run the *StudentsAdd.aspx* page, and every time you create a new student, the Entity Framework will use the `InsertStudent` stored procedure to add the new row to the `Student` table.</span></span>

<span data-ttu-id="de963-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="de963-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span></span>

<span data-ttu-id="de963-175">Spustit *Students.aspx* stránky a nového objektu student se zobrazí v seznamu.</span><span class="sxs-lookup"><span data-stu-id="de963-175">Run the *Students.aspx* page and the new student appears in the list.</span></span>

<span data-ttu-id="de963-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="de963-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span></span>

<span data-ttu-id="de963-177">Změnit název, který chcete ověřit, že aktualizace funkce funguje a pak odstraňte studenta ověřit fungování funkce odstranit.</span><span class="sxs-lookup"><span data-stu-id="de963-177">Change the name to verify that the update function works, and then delete the student to verify that the delete function works.</span></span>

<span data-ttu-id="de963-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="de963-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span></span>

## <a name="using-select-stored-procedures"></a><span data-ttu-id="de963-179">Použití uložených procedur Select</span><span class="sxs-lookup"><span data-stu-id="de963-179">Using Select Stored Procedures</span></span>

<span data-ttu-id="de963-180">Entity Framework nespustí automaticky uložené procedury jako `GetCourses`, a nelze je použít `EntityDataSource` ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="de963-180">The Entity Framework does not automatically run stored procedures such as `GetCourses`, and you cannot use them with the `EntityDataSource` control.</span></span> <span data-ttu-id="de963-181">K jejich použití, můžete je volat z kódu.</span><span class="sxs-lookup"><span data-stu-id="de963-181">To use them, you call them from code.</span></span>

<span data-ttu-id="de963-182">Otevřít *InstructorsCourses.aspx.cs* souboru.</span><span class="sxs-lookup"><span data-stu-id="de963-182">Open the *InstructorsCourses.aspx.cs* file.</span></span> <span data-ttu-id="de963-183">`PopulateDropDownLists` Metoda používá dotaz LINQ entity k načtení všech entit kurzu tak, aby můžete projít seznam a určit ty, které je přiřazeno instruktorem a ty, které nepřiřazené:</span><span class="sxs-lookup"><span data-stu-id="de963-183">The `PopulateDropDownLists` method uses a LINQ-to-Entities query to retrieve all course entities so that it can loop through the list and determine which ones an instructor is assigned to and which ones are unassigned:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample6.cs)]

<span data-ttu-id="de963-184">Nahraďte následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="de963-184">Replace this with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample7.cs)]

<span data-ttu-id="de963-185">Na stránce teď používá `GetCourses` uložené procedury k získání seznamu všech kurzů.</span><span class="sxs-lookup"><span data-stu-id="de963-185">The page now uses the `GetCourses` stored procedure to retrieve the list of all courses.</span></span> <span data-ttu-id="de963-186">Spuštění stránky a zkontrolujte, jestli funguje stejně jako dříve.</span><span class="sxs-lookup"><span data-stu-id="de963-186">Run the page to verify that it works as it did before.</span></span>

<span data-ttu-id="de963-187">(Vlastnosti navigace entit pomocí uložené procedury nemusí být automaticky vyplní data související s těmito entitami, v závislosti na `ObjectContext` výchozí nastavení.</span><span class="sxs-lookup"><span data-stu-id="de963-187">(Navigation properties of entities retrieved by a stored procedure might not be automatically populated with the data related to those entities, depending on `ObjectContext` default settings.</span></span> <span data-ttu-id="de963-188">Další informace najdete v tématu [načítání související objekty](https://msdn.microsoft.com/library/bb896272.aspx) v knihovně MSDN.)</span><span class="sxs-lookup"><span data-stu-id="de963-188">For more information, see [Loading Related Objects](https://msdn.microsoft.com/library/bb896272.aspx) in the MSDN Library.)</span></span>

<span data-ttu-id="de963-189">V dalším kurzu se naučíte jak usnadňují programu a test pravidla formátování i ověřování dat pomocí funkce Dynamická Data.</span><span class="sxs-lookup"><span data-stu-id="de963-189">In the next tutorial, you'll learn how to use Dynamic Data functionality to make it easier to program and test data formatting and validation rules.</span></span> <span data-ttu-id="de963-190">Místo zadání na každé webové stránky pravidla, jako jsou třeba řetězce formátu data a určuje, jestli pole je povinné, tato pravidla můžete zadat v metadatech datového modelu a automaticky se použijí na každé stránce.</span><span class="sxs-lookup"><span data-stu-id="de963-190">Instead of specifying on each web page rules such as data format strings and whether or not a field is required, you can specify such rules in data model metadata and they're automatically applied on every page.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="de963-191">[Předchozí](the-entity-framework-and-aspnet-getting-started-part-6.md)
> [další](the-entity-framework-and-aspnet-getting-started-part-8.md)</span><span class="sxs-lookup"><span data-stu-id="de963-191">[Previous](the-entity-framework-and-aspnet-getting-started-part-6.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-8.md)</span></span>
