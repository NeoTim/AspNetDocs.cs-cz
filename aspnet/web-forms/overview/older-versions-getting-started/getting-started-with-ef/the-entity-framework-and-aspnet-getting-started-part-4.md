---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-4
title: Začínáme s Entity Framework 4,0 Database First a webovými formuláři ASP.NET 4 – část 4 | Microsoft Docs
author: tdykstra
description: Ukázková webová aplikace společnosti Contoso University ukazuje, jak pomocí Entity Framework vytvořit aplikace webových formulářů ASP.NET. Ukázková aplikace je...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: ceb9e60f-957c-4d25-9331-cc527de96a33
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-4
msc.type: authoredcontent
ms.openlocfilehash: eb75a76038466bf30738387ed4739687de1df944
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78638164"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-4"></a><span data-ttu-id="4aef3-104">Začínáme s Entity Framework 4,0 Database First a webovými formuláři ASP.NET 4 – část 4</span><span class="sxs-lookup"><span data-stu-id="4aef3-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 4</span></span>

<span data-ttu-id="4aef3-105">tím, že [Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="4aef3-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="4aef3-106">Ukázková webová aplikace společnosti Contoso University ukazuje, jak pomocí Entity Framework 4,0 a sady Visual Studio 2010 vytvářet aplikace webových formulářů ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="4aef3-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="4aef3-107">Informace o řadě kurzů najdete v [prvním kurzu v řadě](the-entity-framework-and-aspnet-getting-started-part-1.md) .</span><span class="sxs-lookup"><span data-stu-id="4aef3-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="working-with-related-data"></a><span data-ttu-id="4aef3-108">Práce se souvisejícími daty</span><span class="sxs-lookup"><span data-stu-id="4aef3-108">Working with Related Data</span></span>

<span data-ttu-id="4aef3-109">V předchozím kurzu jste použili ovládací prvek `EntityDataSource` k filtrování, řazení a seskupování dat.</span><span class="sxs-lookup"><span data-stu-id="4aef3-109">In the previous tutorial you used the `EntityDataSource` control to filter, sort, and group data.</span></span> <span data-ttu-id="4aef3-110">V tomto kurzu zobrazíte a aktualizujete související data.</span><span class="sxs-lookup"><span data-stu-id="4aef3-110">In this tutorial you'll display and update related data.</span></span>

<span data-ttu-id="4aef3-111">Vytvoříte stránku instruktory, která zobrazuje seznam instruktorů.</span><span class="sxs-lookup"><span data-stu-id="4aef3-111">You'll create the Instructors page that shows a list of instructors.</span></span> <span data-ttu-id="4aef3-112">Když vyberete instruktora, zobrazí se seznam kurzů, které tento instruktor výukoval.</span><span class="sxs-lookup"><span data-stu-id="4aef3-112">When you select an instructor, you see a list of courses taught by that instructor.</span></span> <span data-ttu-id="4aef3-113">Když vyberete kurz, zobrazí se podrobnosti o kurzu a seznam studentů zaregistrovaných v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="4aef3-113">When you select a course, you see details for the course and a list of students enrolled in the course.</span></span> <span data-ttu-id="4aef3-114">Můžete upravit název instruktora, datum přijetí a přiřazení kanceláře.</span><span class="sxs-lookup"><span data-stu-id="4aef3-114">You can edit the instructor name, hire date, and office assignment.</span></span> <span data-ttu-id="4aef3-115">Přiřazení kanceláře je samostatná sada entit, ke které přistupujete prostřednictvím navigační vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="4aef3-115">The office assignment is a separate entity set that you access through a navigation property.</span></span>

<span data-ttu-id="4aef3-116">Můžete propojit hlavní data s podrobnostmi o datech v kódu nebo v kódu.</span><span class="sxs-lookup"><span data-stu-id="4aef3-116">You can link master data to detail data in markup or in code.</span></span> <span data-ttu-id="4aef3-117">V této části kurzu použijete obě metody.</span><span class="sxs-lookup"><span data-stu-id="4aef3-117">In this part of the tutorial, you'll use both methods.</span></span>

<span data-ttu-id="4aef3-118">[![Image01](the-entity-framework-and-aspnet-getting-started-part-4/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4aef3-118">[![Image01](the-entity-framework-and-aspnet-getting-started-part-4/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image1.png)</span></span>

## <a name="displaying-and-updating-related-entities-in-a-gridview-control"></a><span data-ttu-id="4aef3-119">Zobrazení a aktualizace souvisejících entit v ovládacím prvku GridView</span><span class="sxs-lookup"><span data-stu-id="4aef3-119">Displaying and Updating Related Entities in a GridView Control</span></span>

<span data-ttu-id="4aef3-120">Vytvořte novou webovou stránku s názvem *instruktors. aspx* , která používá hlavní stránku *Web. Master* , a přidejte následující kód do ovládacího prvku `Content` s názvem `Content2`:</span><span class="sxs-lookup"><span data-stu-id="4aef3-120">Create a new web page named *Instructors.aspx* that uses the *Site.Master* master page, and add the following markup to the `Content` control named `Content2`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample1.aspx)]

<span data-ttu-id="4aef3-121">Tento kód vytvoří ovládací prvek `EntityDataSource`, který vybere instruktory a povolí aktualizace.</span><span class="sxs-lookup"><span data-stu-id="4aef3-121">This markup creates an `EntityDataSource` control that selects instructors and enables updates.</span></span> <span data-ttu-id="4aef3-122">Element `div` konfiguruje značku pro vykreslení vlevo, takže můžete přidat sloupec hned později.</span><span class="sxs-lookup"><span data-stu-id="4aef3-122">The `div` element configures markup to render on the left so that you can add a column on the right later.</span></span>

<span data-ttu-id="4aef3-123">Mezi značkami `EntityDataSource` a uzavírací `</div>`ovou značkou přidejte následující kód, který vytvoří ovládací prvek `GridView` a ovládací prvek `Label`, který budete používat pro chybové zprávy:</span><span class="sxs-lookup"><span data-stu-id="4aef3-123">Between the `EntityDataSource` markup and the closing `</div>` tag, add the following markup that creates a `GridView` control and a `Label` control that you'll use for error messages:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample2.aspx)]

<span data-ttu-id="4aef3-124">Tento ovládací prvek `GridView` umožňuje výběr řádků, zvýrazní vybraný řádek barevnou šedou barvou pozadí a určí obslužné rutiny (které vytvoříte později) pro události `SelectedIndexChanged` a `Updating`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-124">This `GridView` control enables row selection, highlights the selected row with a light gray background color, and specifies handlers (which you'll create later) for the `SelectedIndexChanged` and `Updating` events.</span></span> <span data-ttu-id="4aef3-125">Určuje také `PersonID` pro vlastnost `DataKeyNames`, takže hodnota klíče vybraného řádku může být předána jinému ovládacímu prvku, který později přidáte.</span><span class="sxs-lookup"><span data-stu-id="4aef3-125">It also specifies `PersonID` for the `DataKeyNames` property, so that the key value of the selected row can be passed to another control that you'll add later.</span></span>

<span data-ttu-id="4aef3-126">Poslední sloupec obsahuje přiřazení kanceláře instruktora, které je uloženo v navigační vlastnosti entity `Person`, protože pochází z přidružené entity.</span><span class="sxs-lookup"><span data-stu-id="4aef3-126">The last column contains the instructor's office assignment, which is stored in a navigation property of the `Person` entity because it comes from an associated entity.</span></span> <span data-ttu-id="4aef3-127">Všimněte si, že prvek `EditItemTemplate` určuje `Eval` namísto `Bind`, protože ovládací prvek `GridView` nemůže přímo navazovat vazby na navigační vlastnosti, aby je bylo možné aktualizovat.</span><span class="sxs-lookup"><span data-stu-id="4aef3-127">Notice that the `EditItemTemplate` element specifies `Eval` instead of `Bind`, because the `GridView` control cannot directly bind to navigation properties in order to update them.</span></span> <span data-ttu-id="4aef3-128">V kódu aktualizujete přiřazení Office.</span><span class="sxs-lookup"><span data-stu-id="4aef3-128">You'll update the office assignment in code.</span></span> <span data-ttu-id="4aef3-129">Chcete-li to provést, budete potřebovat odkaz na ovládací prvek `TextBox` a získáte ho a uložíte v události `Init` ovládacího prvku `TextBox`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-129">To do that, you'll need a reference to the `TextBox` control, and you'll get and save that in the `TextBox` control's `Init` event.</span></span>

<span data-ttu-id="4aef3-130">Následujícím ovládacím prvkem `GridView` je `Label` ovládací prvek, který se používá pro chybové zprávy.</span><span class="sxs-lookup"><span data-stu-id="4aef3-130">Following the `GridView` control is a `Label` control that's used for error messages.</span></span> <span data-ttu-id="4aef3-131">Vlastnost `Visible` ovládacího prvku je `false`a stav zobrazení je vypnutý, takže popisek se zobrazí pouze v případě, že kód je viditelný v reakci na chybu.</span><span class="sxs-lookup"><span data-stu-id="4aef3-131">The control's `Visible` property is `false`, and view state is turned off, so that the label will appear only when code makes it visible in response to an error.</span></span>

<span data-ttu-id="4aef3-132">Otevřete soubor *Instructors.aspx.cs* a přidejte následující příkaz `using`:</span><span class="sxs-lookup"><span data-stu-id="4aef3-132">Open the *Instructors.aspx.cs* file and add the following `using` statement:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample3.cs)]

<span data-ttu-id="4aef3-133">Přidejte pole soukromé třídy hned po deklaraci názvu částečné třídy, aby obsahovalo odkaz na textové pole přiřazení sady Office.</span><span class="sxs-lookup"><span data-stu-id="4aef3-133">Add a private class field immediately after the partial-class name declaration to hold a reference to the office assignment text box.</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample4.cs)]

<span data-ttu-id="4aef3-134">Přidejte zástupnou proceduru pro obslužnou rutinu události `SelectedIndexChanged`, kterou přidáte pro pozdější kód.</span><span class="sxs-lookup"><span data-stu-id="4aef3-134">Add a stub for the `SelectedIndexChanged` event handler that you'll add code for later.</span></span> <span data-ttu-id="4aef3-135">Přidejte také obslužnou rutinu pro `Init` událost `TextBox` ovládacího prvku přiřazení sady Office, abyste mohli uložit odkaz na ovládací prvek `TextBox`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-135">Also add a handler for the office assignment `TextBox` control's `Init` event so that you can store a reference to the `TextBox` control.</span></span> <span data-ttu-id="4aef3-136">Tento odkaz použijete k získání hodnoty zadané uživatelem za účelem aktualizace entity přidružené k navigační vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="4aef3-136">You'll use this reference to get the value the user entered in order to update the entity associated with the navigation property.</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample5.cs)]

<span data-ttu-id="4aef3-137">Pomocí události `Updating` ovládacího prvku `GridView` můžete aktualizovat vlastnost `Location` přidružené entity `OfficeAssignment`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-137">You'll use the `GridView` control's `Updating` event to update the `Location` property of the associated `OfficeAssignment` entity.</span></span> <span data-ttu-id="4aef3-138">Přidejte následující obslužnou rutinu pro událost `Updating`:</span><span class="sxs-lookup"><span data-stu-id="4aef3-138">Add the following handler for the `Updating` event:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample6.cs)]

<span data-ttu-id="4aef3-139">Tento kód se spustí, když uživatel klikne na **aktualizovat** na řádku `GridView`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-139">This code is run when the user clicks **Update** in a `GridView` row.</span></span> <span data-ttu-id="4aef3-140">Kód používá LINQ to Entities k načtení `OfficeAssignment` entity, která je přidružena k aktuální `Person` entitě pomocí `PersonID` vybraného řádku z argumentu události.</span><span class="sxs-lookup"><span data-stu-id="4aef3-140">The code uses LINQ to Entities to retrieve the `OfficeAssignment` entity that's associated with the current `Person` entity, using the `PersonID` of the selected row from the event argument.</span></span>

<span data-ttu-id="4aef3-141">Kód pak provede jednu z následujících akcí v závislosti na hodnotě v ovládacím prvku `InstructorOfficeTextBox`:</span><span class="sxs-lookup"><span data-stu-id="4aef3-141">The code then takes one of the following actions depending on the value in the `InstructorOfficeTextBox` control:</span></span>

- <span data-ttu-id="4aef3-142">Pokud textové pole má hodnotu a neexistuje žádná `OfficeAssignment` entita, která by se měla aktualizovat, vytvoří se.</span><span class="sxs-lookup"><span data-stu-id="4aef3-142">If the text box has a value and there's no `OfficeAssignment` entity to update, it creates one.</span></span>
- <span data-ttu-id="4aef3-143">Pokud textové pole má hodnotu a existuje `OfficeAssignment` entita, aktualizuje hodnotu vlastnosti `Location`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-143">If the text box has a value and there's an `OfficeAssignment` entity, it updates the `Location` property value.</span></span>
- <span data-ttu-id="4aef3-144">Pokud je textové pole prázdné a existuje-`OfficeAssignment` entita, odstraní entitu.</span><span class="sxs-lookup"><span data-stu-id="4aef3-144">If the text box is empty and an `OfficeAssignment` entity exists, it deletes the entity.</span></span>

<span data-ttu-id="4aef3-145">Potom změny uloží do databáze.</span><span class="sxs-lookup"><span data-stu-id="4aef3-145">After this, it saves the changes to the database.</span></span> <span data-ttu-id="4aef3-146">Pokud dojde k výjimce, zobrazí se chybová zpráva.</span><span class="sxs-lookup"><span data-stu-id="4aef3-146">If an exception occurs, it displays an error message.</span></span>

<span data-ttu-id="4aef3-147">Spusťte stránku.</span><span class="sxs-lookup"><span data-stu-id="4aef3-147">Run the page.</span></span>

<span data-ttu-id="4aef3-148">[![Image02](the-entity-framework-and-aspnet-getting-started-part-4/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="4aef3-148">[![Image02](the-entity-framework-and-aspnet-getting-started-part-4/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image3.png)</span></span>

<span data-ttu-id="4aef3-149">Klikněte na tlačítko **Upravit** a všechna pole změnit na textová pole.</span><span class="sxs-lookup"><span data-stu-id="4aef3-149">Click **Edit** and all fields change to text boxes.</span></span>

<span data-ttu-id="4aef3-150">[![Image03](the-entity-framework-and-aspnet-getting-started-part-4/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="4aef3-150">[![Image03](the-entity-framework-and-aspnet-getting-started-part-4/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image5.png)</span></span>

<span data-ttu-id="4aef3-151">Změňte některou z těchto hodnot včetně **přiřazení Office**.</span><span class="sxs-lookup"><span data-stu-id="4aef3-151">Change any of these values, including **Office Assignment**.</span></span> <span data-ttu-id="4aef3-152">Klikněte na **aktualizovat** a zobrazí se změny v seznamu.</span><span class="sxs-lookup"><span data-stu-id="4aef3-152">Click **Update** and you'll see the changes reflected in the list.</span></span>

## <a name="displaying-related-entities-in-a-separate-control"></a><span data-ttu-id="4aef3-153">Zobrazení souvisejících entit v samostatném ovládacím prvku</span><span class="sxs-lookup"><span data-stu-id="4aef3-153">Displaying Related Entities in a Separate Control</span></span>

<span data-ttu-id="4aef3-154">Každý instruktor může vytvořit výuku jednoho nebo více kurzů, takže přidáte ovládací prvek `EntityDataSource` a ovládací prvek `GridView` k vypsání kurzů přidružených k určitému instruktorovi, který je vybrán v ovládacím prvku `GridView` instruktory.</span><span class="sxs-lookup"><span data-stu-id="4aef3-154">Each instructor can teach one or more courses, so you'll add an `EntityDataSource` control and a `GridView` control to list the courses associated with whichever instructor is selected in the instructors `GridView` control.</span></span> <span data-ttu-id="4aef3-155">Chcete-li vytvořit záhlaví a ovládací prvek `EntityDataSource` pro entity kurzů, přidejte následující kód mezi chybovou zprávu `Label` ovládací prvek a uzavírací `</div>` Značka:</span><span class="sxs-lookup"><span data-stu-id="4aef3-155">To create a heading and the `EntityDataSource` control for courses entities, add the following markup between the error message `Label` control and the closing `</div>` tag:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample7.aspx)]

<span data-ttu-id="4aef3-156">Parametr `Where` obsahuje hodnotu `PersonID` instruktora, jejíž řádek je vybrán v ovládacím prvku `InstructorsGridView`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-156">The `Where` parameter contains the value of the `PersonID` of the instructor whose row is selected in the `InstructorsGridView` control.</span></span> <span data-ttu-id="4aef3-157">Vlastnost `Where` obsahuje příkaz pro dílčí výběr, který získá všechny přidružené `Person` entity z vlastnosti navigace `People` `Course` entity a vybere entitu `Course`, pokud jedna z přidružených entit `Person` obsahuje vybranou `PersonID` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="4aef3-157">The `Where` property contains a subselect command that gets all associated `Person` entities from a `Course` entity's `People` navigation property and selects the `Course` entity only if one of the associated `Person` entities contains the selected `PersonID` value.</span></span>

<span data-ttu-id="4aef3-158">Chcete-li vytvořit ovládací prvek `GridView`. Přidejte následující značku hned za ovládací prvek `CoursesEntityDataSource` (před uzavírací značku `</div>`):</span><span class="sxs-lookup"><span data-stu-id="4aef3-158">To create the `GridView` control., add the following markup immediately following the `CoursesEntityDataSource` control (before the closing `</div>` tag):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample8.aspx)]

<span data-ttu-id="4aef3-159">Vzhledem k tomu, že se nezobrazí žádné kurzy, pokud není vybrán žádný instruktor, je zahrnut `EmptyDataTemplate` element.</span><span class="sxs-lookup"><span data-stu-id="4aef3-159">Because no courses will be displayed if no instructor is selected, an `EmptyDataTemplate` element is included.</span></span>

<span data-ttu-id="4aef3-160">Spusťte stránku.</span><span class="sxs-lookup"><span data-stu-id="4aef3-160">Run the page.</span></span>

<span data-ttu-id="4aef3-161">[![Image04](the-entity-framework-and-aspnet-getting-started-part-4/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="4aef3-161">[![Image04](the-entity-framework-and-aspnet-getting-started-part-4/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image7.png)</span></span>

<span data-ttu-id="4aef3-162">Vyberte instruktora s přiřazeným jedním nebo více kurzy a v seznamu se zobrazí kurz nebo kurzy.</span><span class="sxs-lookup"><span data-stu-id="4aef3-162">Select an instructor who has one or more courses assigned, and the course or courses appear in the list.</span></span> <span data-ttu-id="4aef3-163">(Poznámka: Přestože schéma databáze umožňuje více kurzů, v datech testu dodaných s databází nemá žádný instruktor více než jeden kurz.</span><span class="sxs-lookup"><span data-stu-id="4aef3-163">(Note: although the database schema allows multiple courses, in the test data supplied with the database no instructor actually has more than one course.</span></span> <span data-ttu-id="4aef3-164">Do databáze můžete přidat kurzy, a to pomocí okna **Průzkumník serveru** nebo stránky *CoursesAdd. aspx* , kterou přidáte v pozdějším kurzu.)</span><span class="sxs-lookup"><span data-stu-id="4aef3-164">You can add courses to the database yourself using the **Server Explorer** window or the *CoursesAdd.aspx* page, which you'll add in a later tutorial.)</span></span>

<span data-ttu-id="4aef3-165">[![Image05](the-entity-framework-and-aspnet-getting-started-part-4/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="4aef3-165">[![Image05](the-entity-framework-and-aspnet-getting-started-part-4/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image9.png)</span></span>

<span data-ttu-id="4aef3-166">Ovládací prvek `CoursesGridView` zobrazuje pouze několik polí kurzu.</span><span class="sxs-lookup"><span data-stu-id="4aef3-166">The `CoursesGridView` control shows only a few course fields.</span></span> <span data-ttu-id="4aef3-167">Chcete-li zobrazit všechny podrobnosti o kurzu, použijte ovládací prvek `DetailsView` pro kurz, který uživatel vybere.</span><span class="sxs-lookup"><span data-stu-id="4aef3-167">To display all the details for a course, you'll use a `DetailsView` control for the course that the user selects.</span></span> <span data-ttu-id="4aef3-168">V *instruktors. aspx*přidejte následující značky za uzavírací značku `</div>` (Nezapomeňte umístit toto označení **za** uzavírací značku div, nikoli před ní):</span><span class="sxs-lookup"><span data-stu-id="4aef3-168">In *Instructors.aspx*, add the following markup after the closing `</div>` tag (make sure you place this markup **after** the closing div tag, not before it):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample9.aspx)]

<span data-ttu-id="4aef3-169">Tento kód vytvoří ovládací prvek `EntityDataSource`, který je svázán se sadou entit `Courses`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-169">This markup creates an `EntityDataSource` control that's bound to the `Courses` entity set.</span></span> <span data-ttu-id="4aef3-170">Vlastnost `Where` vybere kurz pomocí `CourseID` hodnoty vybraného řádku v ovládacím prvku kurzy `GridView`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-170">The `Where` property selects a course using the `CourseID` value of the selected row in the courses `GridView` control.</span></span> <span data-ttu-id="4aef3-171">Značka určuje obslužnou rutinu pro událost `Selected`, kterou použijete později pro zobrazení studijních známek, což je další nižší úroveň v hierarchii.</span><span class="sxs-lookup"><span data-stu-id="4aef3-171">The markup specifies a handler for the `Selected` event, which you'll use later for displaying student grades, which is another level lower in the hierarchy.</span></span>

<span data-ttu-id="4aef3-172">V *Instructors.aspx.cs*vytvořte následující zástupnou proceduru pro metodu `CourseDetailsEntityDataSource_Selected`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-172">In *Instructors.aspx.cs*, create the following stub for the `CourseDetailsEntityDataSource_Selected` method.</span></span> <span data-ttu-id="4aef3-173">(Tento zástupný kód vyplníte později v tomto kurzu. zatím ho budete potřebovat, aby se stránka zkompiluje a spustí.)</span><span class="sxs-lookup"><span data-stu-id="4aef3-173">(You'll fill this stub out later in the tutorial; for now, you need it so that the page will compile and run.)</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample10.cs)]

<span data-ttu-id="4aef3-174">Spusťte stránku.</span><span class="sxs-lookup"><span data-stu-id="4aef3-174">Run the page.</span></span>

<span data-ttu-id="4aef3-175">[![Image06](the-entity-framework-and-aspnet-getting-started-part-4/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="4aef3-175">[![Image06](the-entity-framework-and-aspnet-getting-started-part-4/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image11.png)</span></span>

<span data-ttu-id="4aef3-176">Zpočátku neexistují žádné podrobnosti o kurzu, protože není vybraný žádný kurz.</span><span class="sxs-lookup"><span data-stu-id="4aef3-176">Initially there are no course details because no course is selected.</span></span> <span data-ttu-id="4aef3-177">Vyberte instruktora s přiřazeným kurzem a potom vyberte kurz, ve kterém se zobrazí podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="4aef3-177">Select an instructor who has a course assigned, and then select a course to see the details.</span></span>

<span data-ttu-id="4aef3-178">[![Image07](the-entity-framework-and-aspnet-getting-started-part-4/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="4aef3-178">[![Image07](the-entity-framework-and-aspnet-getting-started-part-4/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image13.png)</span></span>

## <a name="using-the-entitydatasource-selected-event-to-display-related-data"></a><span data-ttu-id="4aef3-179">Zobrazení souvisejících dat pomocí události "vybrané" v EntityDataSource</span><span class="sxs-lookup"><span data-stu-id="4aef3-179">Using the EntityDataSource "Selected" Event to Display Related Data</span></span>

<span data-ttu-id="4aef3-180">Nakonec chcete zobrazit všechny zaregistrované studenty a jejich třídy pro vybraný kurz.</span><span class="sxs-lookup"><span data-stu-id="4aef3-180">Finally, you want to show all of the enrolled students and their grades for the selected course.</span></span> <span data-ttu-id="4aef3-181">K tomu budete používat událost `Selected` ovládacího prvku `EntityDataSource` vázaného na `DetailsView`kurzu.</span><span class="sxs-lookup"><span data-stu-id="4aef3-181">To do this, you'll use the `Selected` event of the `EntityDataSource` control bound to the course `DetailsView`.</span></span>

<span data-ttu-id="4aef3-182">V *instruktors. aspx*přidejte následující značku za ovládací prvek `DetailsView`:</span><span class="sxs-lookup"><span data-stu-id="4aef3-182">In *Instructors.aspx*, add the following markup after the `DetailsView` control:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample11.aspx)]

<span data-ttu-id="4aef3-183">Tento kód vytvoří ovládací prvek `ListView`, který zobrazí seznam studentů a jejich třídy pro vybraný kurz.</span><span class="sxs-lookup"><span data-stu-id="4aef3-183">This markup creates a `ListView` control that displays a list of students and their grades for the selected course.</span></span> <span data-ttu-id="4aef3-184">Není zadán žádný zdroj dat, protože ovládací prvek bude svázán v kódu.</span><span class="sxs-lookup"><span data-stu-id="4aef3-184">No data source is specified because you'll databind the control in code.</span></span> <span data-ttu-id="4aef3-185">Element `EmptyDataTemplate` obsahuje zprávu, která se zobrazí, když není vybraný žádný kurz – v takovém případě se žádné studenty nemůžou zobrazit.</span><span class="sxs-lookup"><span data-stu-id="4aef3-185">The `EmptyDataTemplate` element provides a message to display when no course is selected—in that case, there are no students to display.</span></span> <span data-ttu-id="4aef3-186">Element `LayoutTemplate` vytvoří tabulku HTML pro zobrazení seznamu a `ItemTemplate` Určuje sloupce, které se mají zobrazit.</span><span class="sxs-lookup"><span data-stu-id="4aef3-186">The `LayoutTemplate` element creates an HTML table to display the list, and the `ItemTemplate` specifies the columns to display.</span></span> <span data-ttu-id="4aef3-187">ID studenta a stupeň studenta jsou z entity `StudentGrade` a jméno studenta pochází z `Person` entity, kterou Entity Framework zpřístupňuje v `Person` navigační vlastnosti entity `StudentGrade`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-187">The student ID and the student grade are from the `StudentGrade` entity, and the student name is from the `Person` entity that the Entity Framework makes available in the `Person` navigation property of the `StudentGrade` entity.</span></span>

<span data-ttu-id="4aef3-188">V *Instructors.aspx.cs*nahraďte metodu podložit-out `CourseDetailsEntityDataSource_Selected` následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="4aef3-188">In *Instructors.aspx.cs*, replace the stubbed-out `CourseDetailsEntityDataSource_Selected` method with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample12.cs)]

<span data-ttu-id="4aef3-189">Argument události pro tuto událost poskytuje vybraná data ve formě kolekce, která bude obsahovat nula položek, pokud není nic vybráno, nebo jednu položku, je-li vybrána entita `Course`.</span><span class="sxs-lookup"><span data-stu-id="4aef3-189">The event argument for this event provides the selected data in the form of a collection, which will have zero items if nothing is selected or one item if a `Course` entity is selected.</span></span> <span data-ttu-id="4aef3-190">Pokud je vybrána entita `Course`, kód používá metodu `First` k převedení kolekce na jeden objekt.</span><span class="sxs-lookup"><span data-stu-id="4aef3-190">If a `Course` entity is selected, the code uses the `First` method to convert the collection to a single object.</span></span> <span data-ttu-id="4aef3-191">Poté získá `StudentGrade` entit z navigační vlastnosti, převede je na kolekci a naváže ovládací prvek `GradesListView` na kolekci.</span><span class="sxs-lookup"><span data-stu-id="4aef3-191">It then gets `StudentGrade` entities from the navigation property, converts them to a collection, and binds the `GradesListView` control to the collection.</span></span>

<span data-ttu-id="4aef3-192">To je dostačující pro zobrazení stupňů, ale chcete se ujistit, že se při prvním zobrazení stránky zobrazí zpráva v prázdné šabloně a když není vybraný kurz.</span><span class="sxs-lookup"><span data-stu-id="4aef3-192">This is sufficient to display grades, but you want to make sure that the message in the empty data template is displayed the first time the page is displayed and whenever a course is not selected.</span></span> <span data-ttu-id="4aef3-193">Uděláte to tak, že vytvoříte následující metodu, kterou budete volat ze dvou míst:</span><span class="sxs-lookup"><span data-stu-id="4aef3-193">To do that, create the following method, which you'll call from two places:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample13.cs)]

<span data-ttu-id="4aef3-194">Zavolejte tuto novou metodu z metody `Page_Load` k zobrazení prázdné datové šablony při prvním zobrazení stránky.</span><span class="sxs-lookup"><span data-stu-id="4aef3-194">Call this new method from the `Page_Load` method to display the empty data template the first time the page is displayed.</span></span> <span data-ttu-id="4aef3-195">A zavolejte ji z metody `InstructorsGridView_SelectedIndexChanged`, protože tato událost je vyvolána, když je vybrán instruktor, což znamená, že nové kurzy jsou načteny do kurzů `GridView` řízení a ještě není vybráno žádné.</span><span class="sxs-lookup"><span data-stu-id="4aef3-195">And call it from the `InstructorsGridView_SelectedIndexChanged` method because that event is raised when an instructor is selected, which means new courses are loaded into the courses `GridView` control and none is selected yet.</span></span> <span data-ttu-id="4aef3-196">Toto jsou dvě volání:</span><span class="sxs-lookup"><span data-stu-id="4aef3-196">Here are the two calls:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample14.cs)]

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample15.cs)]

<span data-ttu-id="4aef3-197">Spusťte stránku.</span><span class="sxs-lookup"><span data-stu-id="4aef3-197">Run the page.</span></span>

<span data-ttu-id="4aef3-198">[![Image08](the-entity-framework-and-aspnet-getting-started-part-4/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="4aef3-198">[![Image08](the-entity-framework-and-aspnet-getting-started-part-4/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image15.png)</span></span>

<span data-ttu-id="4aef3-199">Vyberte instruktora s přiřazeným kurzem a potom vyberte kurz.</span><span class="sxs-lookup"><span data-stu-id="4aef3-199">Select an instructor that has a course assigned, and then select the course.</span></span>

<span data-ttu-id="4aef3-200">[![Image09](the-entity-framework-and-aspnet-getting-started-part-4/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="4aef3-200">[![Image09](the-entity-framework-and-aspnet-getting-started-part-4/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image17.png)</span></span>

<span data-ttu-id="4aef3-201">Teď jste viděli několik způsobů, jak pracovat se souvisejícími daty.</span><span class="sxs-lookup"><span data-stu-id="4aef3-201">You have now seen a few ways to work with related data.</span></span> <span data-ttu-id="4aef3-202">V následujícím kurzu se dozvíte, jak přidat relace mezi stávajícími entitami, jak odebrat relace a jak přidat novou entitu, která má relaci s existující entitou.</span><span class="sxs-lookup"><span data-stu-id="4aef3-202">In the following tutorial, you'll learn how to add relationships between existing entities, how to remove relationships, and how to add a new entity that has a relationship to an existing entity.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="4aef3-203">[Předchozí](the-entity-framework-and-aspnet-getting-started-part-3.md)
> [Další](the-entity-framework-and-aspnet-getting-started-part-5.md)</span><span class="sxs-lookup"><span data-stu-id="4aef3-203">[Previous](the-entity-framework-and-aspnet-getting-started-part-3.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-5.md)</span></span>
