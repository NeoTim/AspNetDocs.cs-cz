---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-2
title: Začínáme s Entity Framework 4,0 Database First a webovými formuláři ASP.NET 4 – část 2 | Microsoft Docs
author: tdykstra
description: Ukázková webová aplikace společnosti Contoso University ukazuje, jak pomocí Entity Framework vytvořit aplikace webových formulářů ASP.NET. Ukázková aplikace je...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: fb63a326-a4ae-4b0c-a4f5-412327197216
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-2
msc.type: authoredcontent
ms.openlocfilehash: bd6a2e29e6f0df04e39be29160e2e08cc99c4706
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78566008"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-2"></a><span data-ttu-id="e6d33-104">Začínáme s Entity Framework 4,0 Database First a webovými formuláři ASP.NET 4 – část 2</span><span class="sxs-lookup"><span data-stu-id="e6d33-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 2</span></span>

<span data-ttu-id="e6d33-105">tím, že [Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="e6d33-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="e6d33-106">Ukázková webová aplikace společnosti Contoso University ukazuje, jak pomocí Entity Framework 4,0 a sady Visual Studio 2010 vytvářet aplikace webových formulářů ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="e6d33-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="e6d33-107">Informace o řadě kurzů najdete v [prvním kurzu v řadě](the-entity-framework-and-aspnet-getting-started-part-1.md) .</span><span class="sxs-lookup"><span data-stu-id="e6d33-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="the-entitydatasource-control"></a><span data-ttu-id="e6d33-108">Ovládací prvek EntityDataSource</span><span class="sxs-lookup"><span data-stu-id="e6d33-108">The EntityDataSource Control</span></span>

<span data-ttu-id="e6d33-109">V předchozím kurzu jste vytvořili web, databázi a datový model.</span><span class="sxs-lookup"><span data-stu-id="e6d33-109">In the previous tutorial you created a web site, a database, and a data model.</span></span> <span data-ttu-id="e6d33-110">V tomto kurzu pracujete s ovládacím prvkem `EntityDataSource`, který ASP.NET poskytuje, aby bylo snazší pracovat s datovým modelem Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="e6d33-110">In this tutorial you work with the `EntityDataSource` control that ASP.NET provides in order to make it easy to work with an Entity Framework data model.</span></span> <span data-ttu-id="e6d33-111">Vytvoříte `GridView` ovládací prvek pro zobrazování a úpravu dat studentů, `DetailsView` řízení pro přidávání nových studentů a ovládací prvek `DropDownList` pro výběr oddělení (který budete používat později pro zobrazení přidružených kurzů).</span><span class="sxs-lookup"><span data-stu-id="e6d33-111">You'll create a `GridView` control for displaying and editing student data, a `DetailsView` control for adding new students, and a `DropDownList` control for selecting a department (which you'll use later for displaying associated courses).</span></span>

<span data-ttu-id="e6d33-112">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-112">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image1.png)</span></span>

<span data-ttu-id="e6d33-113">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-113">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image3.png)</span></span>

<span data-ttu-id="e6d33-114">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-114">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image5.png)</span></span>

<span data-ttu-id="e6d33-115">Všimněte si, že v této aplikaci nebudete přidáváni ověřování na stránky, které databázi aktualizují, a některé z zpracování chyb nebudou tak robustní, jak by bylo potřeba v produkční aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e6d33-115">Note that in this application you won't be adding input validation to pages that update the database, and some of the error handling will not be as robust as would be required in a production application.</span></span> <span data-ttu-id="e6d33-116">Tím se kurz neustále zaměřuje na Entity Framework a trvá příliš dlouho.</span><span class="sxs-lookup"><span data-stu-id="e6d33-116">That keeps the tutorial focused on the Entity Framework and keeps it from getting too long.</span></span> <span data-ttu-id="e6d33-117">Podrobnosti o tom, jak tyto funkce přidat do aplikace, najdete v tématu [ověřování vstupu uživatele na webových stránkách ASP.NET](https://msdn.microsoft.com/library/7kh55542.aspx) a [zpracování chyb na stránkách ASP.NET a aplikacích](https://msdn.microsoft.com/library/w16865z6.aspx).</span><span class="sxs-lookup"><span data-stu-id="e6d33-117">For details about how to add these features to your application, see [Validating User Input in ASP.NET Web Pages](https://msdn.microsoft.com/library/7kh55542.aspx) and [Error Handling in ASP.NET Pages and Applications](https://msdn.microsoft.com/library/w16865z6.aspx).</span></span>

## <a name="adding-and-configuring-the-entitydatasource-control"></a><span data-ttu-id="e6d33-118">Přidání a konfigurace ovládacího prvku EntityDataSource</span><span class="sxs-lookup"><span data-stu-id="e6d33-118">Adding and Configuring the EntityDataSource Control</span></span>

<span data-ttu-id="e6d33-119">Začnete konfigurací ovládacího prvku `EntityDataSource` ke čtení `Person` entit ze sady entit `People`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-119">You'll begin by configuring an `EntityDataSource` control to read `Person` entities from the `People` entity set.</span></span>

<span data-ttu-id="e6d33-120">Ujistěte se, že máte otevřenou aplikaci Visual Studio a že pracujete s projektem, který jste vytvořili v části 1.</span><span class="sxs-lookup"><span data-stu-id="e6d33-120">Make sure you have Visual Studio open and that you're working with the project you created in part 1.</span></span> <span data-ttu-id="e6d33-121">Pokud jste projekt nevytvořili, protože jste vytvořili datový model nebo když jste jeho poslední změnu provedli, sestavte projekt nyní.</span><span class="sxs-lookup"><span data-stu-id="e6d33-121">If you haven't built the project since you created the data model or since the last change you made to it, build the project now.</span></span> <span data-ttu-id="e6d33-122">Změny datového modelu nejsou zpřístupněny návrháři, dokud není projekt sestaven.</span><span class="sxs-lookup"><span data-stu-id="e6d33-122">Changes to the data model are not made available to the designer until the project is built.</span></span>

<span data-ttu-id="e6d33-123">Vytvořte novou webovou stránku pomocí **webového formuláře pomocí šablony stránky předlohy** a pojmenujte ji *students. aspx*.</span><span class="sxs-lookup"><span data-stu-id="e6d33-123">Create a new web page using the **Web Form using Master Page** template, and name it *Students.aspx*.</span></span>

<span data-ttu-id="e6d33-124">[![Image23](the-entity-framework-and-aspnet-getting-started-part-2/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-124">[![Image23](the-entity-framework-and-aspnet-getting-started-part-2/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image7.png)</span></span>

<span data-ttu-id="e6d33-125">Zadejte *Web. Master* jako stránku předlohy.</span><span class="sxs-lookup"><span data-stu-id="e6d33-125">Specify *Site.Master* as the master page.</span></span> <span data-ttu-id="e6d33-126">Všechny stránky, které vytvoříte pro tyto kurzy, budou používat tuto stránku předlohy.</span><span class="sxs-lookup"><span data-stu-id="e6d33-126">All of the pages you create for these tutorials will use this master page.</span></span>

<span data-ttu-id="e6d33-127">[![Image24](the-entity-framework-and-aspnet-getting-started-part-2/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-127">[![Image24](the-entity-framework-and-aspnet-getting-started-part-2/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image9.png)</span></span>

<span data-ttu-id="e6d33-128">V zobrazení **zdroj** přidejte `h2` záhlaví k ovládacímu prvku `Content` s názvem `Content2`, jak je znázorněno v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="e6d33-128">In **Source** view, add an `h2` heading to the `Content` control named `Content2`, as shown in the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample1.aspx)]

<span data-ttu-id="e6d33-129">Na kartě **data** na **panelu nástrojů**přetáhněte ovládací prvek `EntityDataSource` na stránku, přetáhněte ho pod záhlavím a změňte ID na `StudentsEntityDataSource`:</span><span class="sxs-lookup"><span data-stu-id="e6d33-129">From the **Data** tab of the **Toolbox**, drag an `EntityDataSource` control to the page, drop it below the heading, and change the ID to `StudentsEntityDataSource`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample2.aspx)]

<span data-ttu-id="e6d33-130">Přepněte do zobrazení **Návrh** , klikněte na inteligentní značku ovládacího prvku zdroje dat a potom kliknutím na **Konfigurovat zdroj dat** spusťte průvodce **konfigurací zdroje dat** .</span><span class="sxs-lookup"><span data-stu-id="e6d33-130">Switch to **Design** view, click the data source control's smart tag, and then click **Configure Data Source** to launch the **Configure Data Source** wizard.</span></span>

<span data-ttu-id="e6d33-131">[![Image01](the-entity-framework-and-aspnet-getting-started-part-2/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-131">[![Image01](the-entity-framework-and-aspnet-getting-started-part-2/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image11.png)</span></span>

<span data-ttu-id="e6d33-132">V kroku průvodce **konfigurací objektu ObjectContext** vyberte **SchoolEntities** jako hodnotu pro **pojmenované připojení**a jako hodnotu **DefaultContainerName** vyberte **SchoolEntities** .</span><span class="sxs-lookup"><span data-stu-id="e6d33-132">In the **Configure ObjectContext** wizard step, select **SchoolEntities** as the value for **Named Connection**, and select **SchoolEntities** as the **DefaultContainerName** value.</span></span> <span data-ttu-id="e6d33-133">Pak klikněte na tlačítko **Další**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-133">Then click **Next**.</span></span>

<span data-ttu-id="e6d33-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-2/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-2/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image13.png)</span></span>

<span data-ttu-id="e6d33-135">Poznámka: Pokud se v tomto okamžiku zobrazí následující dialogové okno, je třeba projekt sestavit, aby bylo možné pokračovat.</span><span class="sxs-lookup"><span data-stu-id="e6d33-135">Note: If you get the following dialog box at this point, you have to build the project before proceeding.</span></span>

<span data-ttu-id="e6d33-136">[![Image25](the-entity-framework-and-aspnet-getting-started-part-2/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-136">[![Image25](the-entity-framework-and-aspnet-getting-started-part-2/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image15.png)</span></span>

<span data-ttu-id="e6d33-137">V kroku **Konfigurace výběru dat** vyberte možnost **lidé** jako hodnotu pro **EntitySetName**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-137">In the **Configure Data Selection** step, select **People** as the value for **EntitySetName**.</span></span> <span data-ttu-id="e6d33-138">V části **Vybrat**se ujistěte, že je zaškrtnuté políčko **Vyberte** vše.</span><span class="sxs-lookup"><span data-stu-id="e6d33-138">Under **Select**, make sure the **Select A** ll check box is selected.</span></span> <span data-ttu-id="e6d33-139">Pak vyberte možnosti pro povolení aktualizace a odstranění.</span><span class="sxs-lookup"><span data-stu-id="e6d33-139">Then select the options to enable update and delete.</span></span> <span data-ttu-id="e6d33-140">Až skončíte, klikněte na **Dokončit**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-140">When you're done, click **Finish**.</span></span>

<span data-ttu-id="e6d33-141">[![Image03](the-entity-framework-and-aspnet-getting-started-part-2/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-141">[![Image03](the-entity-framework-and-aspnet-getting-started-part-2/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image17.png)</span></span>

## <a name="configuring-database-rules-to-allow-deletion"></a><span data-ttu-id="e6d33-142">Konfigurace databázových pravidel pro povolení odstranění</span><span class="sxs-lookup"><span data-stu-id="e6d33-142">Configuring Database Rules to Allow Deletion</span></span>

<span data-ttu-id="e6d33-143">Vytvoříte stránku, která umožní uživatelům odstraňovat studenty z `Person` tabulky, která má tři relace s jinými tabulkami (`Course`, `StudentGrade`a `OfficeAssignment`).</span><span class="sxs-lookup"><span data-stu-id="e6d33-143">You'll be creating a page that lets users delete students from the `Person` table, which has three relationships with other tables (`Course`, `StudentGrade`, and `OfficeAssignment`).</span></span> <span data-ttu-id="e6d33-144">Ve výchozím nastavení vám databáze zabrání v odstranění řádku v `Person`, pokud v jedné z ostatních tabulek existují související řádky.</span><span class="sxs-lookup"><span data-stu-id="e6d33-144">By default, the database will prevent you from deleting a row in `Person` if there are related rows in one of the other tables.</span></span> <span data-ttu-id="e6d33-145">Nejprve můžete související řádky odstranit, nebo můžete databázi nakonfigurovat tak, aby se automaticky odstranila při odstranění `Person`ho řádku.</span><span class="sxs-lookup"><span data-stu-id="e6d33-145">You can manually delete the related rows first, or you can configure the database to delete them automatically when you delete a `Person` row.</span></span> <span data-ttu-id="e6d33-146">V případě záznamů studenta v tomto kurzu nakonfigurujete databázi, aby automaticky odstranila související data.</span><span class="sxs-lookup"><span data-stu-id="e6d33-146">For student records in this tutorial, you'll configure the database to delete the related data automatically.</span></span> <span data-ttu-id="e6d33-147">Vzhledem k tomu, že studenti mohou mít v tabulce `StudentGrade` pouze související řádky, je nutné nakonfigurovat pouze jednu ze tří vztahů.</span><span class="sxs-lookup"><span data-stu-id="e6d33-147">Because students can have related rows only in the `StudentGrade` table, you need to configure only one of the three relationships.</span></span>

<span data-ttu-id="e6d33-148">Pokud používáte soubor *School. mdf* , který jste stáhli z projektu, který je součástí tohoto kurzu, můžete tuto část přeskočit, protože tyto změny konfigurace již byly provedeny.</span><span class="sxs-lookup"><span data-stu-id="e6d33-148">If you're using the *School.mdf* file that you downloaded from the project that goes with this tutorial, you can skip this section because these configuration changes have already been done.</span></span> <span data-ttu-id="e6d33-149">Pokud jste databázi vytvořili spuštěním skriptu, nakonfigurujte databázi pomocí následujících postupů.</span><span class="sxs-lookup"><span data-stu-id="e6d33-149">If you created the database by running a script, configure the database by performing the following procedures.</span></span>

<span data-ttu-id="e6d33-150">V **Průzkumník serveru**otevřete databázový diagram, který jste vytvořili v části 1.</span><span class="sxs-lookup"><span data-stu-id="e6d33-150">In **Server Explorer**, open the database diagram that you created in part 1.</span></span> <span data-ttu-id="e6d33-151">Klikněte pravým tlačítkem na vztah mezi `Person` a `StudentGrade` (čára mezi tabulkami) a pak vyberte **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-151">Right-click the relationship between `Person` and `StudentGrade` (the line between tables), and then select **Properties**.</span></span>

<span data-ttu-id="e6d33-152">[![Image04](the-entity-framework-and-aspnet-getting-started-part-2/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-152">[![Image04](the-entity-framework-and-aspnet-getting-started-part-2/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image19.png)</span></span>

<span data-ttu-id="e6d33-153">V okně **vlastnosti** rozbalte položku **Vložit a aktualizovat specifikaci** a nastavte vlastnost **DeleteRule** na hodnotu **Cascade**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-153">In the **Properties** window, expand **INSERT and UPDATE Specification** and set the **DeleteRule** property to **Cascade**.</span></span>

<span data-ttu-id="e6d33-154">[![Image05](the-entity-framework-and-aspnet-getting-started-part-2/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-154">[![Image05](the-entity-framework-and-aspnet-getting-started-part-2/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image21.png)</span></span>

<span data-ttu-id="e6d33-155">Uložte a zavřete diagram.</span><span class="sxs-lookup"><span data-stu-id="e6d33-155">Save and close the diagram.</span></span> <span data-ttu-id="e6d33-156">Pokud se zobrazí dotaz, zda chcete databázi aktualizovat, klikněte na tlačítko **Ano**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-156">If you're asked whether you want to update the database, click **Yes**.</span></span>

<span data-ttu-id="e6d33-157">Abyste se ujistili, že model udržuje entity, které jsou v paměti synchronizované s tím, co databáze dělá, musíte v datovém modelu nastavit odpovídající pravidla.</span><span class="sxs-lookup"><span data-stu-id="e6d33-157">To make sure that the model keeps entities that are in memory in sync with what the database is doing, you must set corresponding rules in the data model.</span></span> <span data-ttu-id="e6d33-158">Otevřete *SchoolModel. edmx*, klikněte pravým tlačítkem myši na čáru přidružení mezi `Person` a `StudentGrade`a pak vyberte **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-158">Open *SchoolModel.edmx*, right-click the association line between `Person` and `StudentGrade`, and then select **Properties**.</span></span>

<span data-ttu-id="e6d33-159">[![Image21](the-entity-framework-and-aspnet-getting-started-part-2/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-159">[![Image21](the-entity-framework-and-aspnet-getting-started-part-2/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image23.png)</span></span>

<span data-ttu-id="e6d33-160">V okně **vlastnosti** nastavte End1- **Delete** na **Cascade**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-160">In the **Properties** window, set **End1 OnDelete** to **Cascade**.</span></span>

<span data-ttu-id="e6d33-161">[![Image22](the-entity-framework-and-aspnet-getting-started-part-2/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-161">[![Image22](the-entity-framework-and-aspnet-getting-started-part-2/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image25.png)</span></span>

<span data-ttu-id="e6d33-162">Uložte a zavřete soubor *SchoolModel. edmx* a pak znovu sestavte projekt.</span><span class="sxs-lookup"><span data-stu-id="e6d33-162">Save and close the *SchoolModel.edmx* file, and then rebuild the project.</span></span>

<span data-ttu-id="e6d33-163">Obecně platí, že když se databáze změní, máte několik možností, jak synchronizovat model:</span><span class="sxs-lookup"><span data-stu-id="e6d33-163">In general, when the database changes, you have several choices for how to sync up the model:</span></span>

- <span data-ttu-id="e6d33-164">U určitých druhů změn (například přidávání nebo obnovování tabulek, zobrazení nebo uložených procedur), klikněte pravým tlačítkem myši v návrháři a vyberte **aktualizovat model z databáze** , aby se tento Návrhář automaticky provedl.</span><span class="sxs-lookup"><span data-stu-id="e6d33-164">For certain kinds of changes (such as adding or refreshing tables, views, or stored procedures), right-click in the designer and select **Update Model from Database** to have the designer make the changes automatically.</span></span>
- <span data-ttu-id="e6d33-165">Znovu vygenerujte datový model.</span><span class="sxs-lookup"><span data-stu-id="e6d33-165">Regenerate the data model.</span></span>
- <span data-ttu-id="e6d33-166">Proveďte ruční aktualizace, jako je tato.</span><span class="sxs-lookup"><span data-stu-id="e6d33-166">Make manual updates like this one.</span></span>

<span data-ttu-id="e6d33-167">V tomto případě jste mohli model znovu vygenerovat nebo aktualizovat tabulky ovlivněné změnou vztahu, ale pak byste museli změnit název pole-název (od `FirstName` do `FirstMidName`).</span><span class="sxs-lookup"><span data-stu-id="e6d33-167">In this case, you could have regenerated the model or refreshed the tables affected by the relationship change, but then you'd have to make the field-name change again (from `FirstName` to `FirstMidName`).</span></span>

## <a name="using-a-gridview-control-to-read-and-update-entities"></a><span data-ttu-id="e6d33-168">Použití ovládacího prvku GridView ke čtení a aktualizaci entit</span><span class="sxs-lookup"><span data-stu-id="e6d33-168">Using a GridView Control to Read and Update Entities</span></span>

<span data-ttu-id="e6d33-169">V této části použijete `GridView` ovládací prvek pro zobrazení, aktualizaci nebo odstranění studentů.</span><span class="sxs-lookup"><span data-stu-id="e6d33-169">In this section you'll use a `GridView` control to display, update, or delete students.</span></span>

<span data-ttu-id="e6d33-170">Otevřete nebo přejděte na *studenty. aspx* a přepněte se do zobrazení **Návrh** .</span><span class="sxs-lookup"><span data-stu-id="e6d33-170">Open or switch to *Students.aspx* and switch to **Design** view.</span></span> <span data-ttu-id="e6d33-171">Na kartě **data** na **panelu nástrojů**přetáhněte ovládací prvek `GridView` napravo od ovládacího prvku `EntityDataSource`, pojmenujte jej `StudentsGridView`, klikněte na inteligentní značku a pak jako zdroj dat vyberte **StudentsEntityDataSource** .</span><span class="sxs-lookup"><span data-stu-id="e6d33-171">From the **Data** tab of the **Toolbox**, drag a `GridView` control to the right of the `EntityDataSource` control, name it `StudentsGridView`, click the smart tag, and then select **StudentsEntityDataSource** as the data source.</span></span>

<span data-ttu-id="e6d33-172">[![Image06](the-entity-framework-and-aspnet-getting-started-part-2/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-172">[![Image06](the-entity-framework-and-aspnet-getting-started-part-2/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image27.png)</span></span>

<span data-ttu-id="e6d33-173">Klikněte na **Aktualizovat schéma** (Pokud se zobrazí výzva k potvrzení), klikněte na tlačítko **Ano** , pak na **Povolit stránkování**, povolit **řazení**, **Povolit úpravy**a **Povolit odstranění**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-173">Click **Refresh Schema** (click **Yes** if you're prompted to confirm), then click **Enable Paging**, **Enable Sorting**, **Enable Editing**, and **Enable Deleting**.</span></span>

<span data-ttu-id="e6d33-174">Klikněte na tlačítko **Upravit sloupce**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-174">Click **Edit Columns**.</span></span>

<span data-ttu-id="e6d33-175">[![Image10](the-entity-framework-and-aspnet-getting-started-part-2/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-175">[![Image10](the-entity-framework-and-aspnet-getting-started-part-2/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image29.png)</span></span>

<span data-ttu-id="e6d33-176">V poli **Vybraná pole** odstraňte **PersonID**, **LastName**a **HireDate**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-176">In the **Selected fields** box, delete **PersonID**, **LastName**, and **HireDate**.</span></span> <span data-ttu-id="e6d33-177">Obvykle nezobrazujete klíč záznamu uživatelům, datum přijetí není relevantní pro studenty a do jednoho pole umístíte obě části názvu, takže budete potřebovat jenom jedno z polí s názvem.)</span><span class="sxs-lookup"><span data-stu-id="e6d33-177">You typically don't display a record key to users, hire date is not relevant to students, and you'll put both parts of the name in one field, so you only need one of the name fields.)</span></span>

<span data-ttu-id="e6d33-178">[![Image11](the-entity-framework-and-aspnet-getting-started-part-2/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-178">[![Image11](the-entity-framework-and-aspnet-getting-started-part-2/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image31.png)</span></span>

<span data-ttu-id="e6d33-179">Vyberte pole **FirstMidName** a pak klikněte na **převést toto pole na TemplateField**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-179">Select the **FirstMidName** field and then click **Convert this field into a TemplateField**.</span></span>

<span data-ttu-id="e6d33-180">Totéž udělejte pro **EnrollmentDate**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-180">Do the same for **EnrollmentDate**.</span></span>

<span data-ttu-id="e6d33-181">[![Image13](the-entity-framework-and-aspnet-getting-started-part-2/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-181">[![Image13](the-entity-framework-and-aspnet-getting-started-part-2/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image33.png)</span></span>

<span data-ttu-id="e6d33-182">Klikněte na **OK** a pak přepněte do zobrazení **zdroje** .</span><span class="sxs-lookup"><span data-stu-id="e6d33-182">Click **OK** and then switch to **Source** view.</span></span> <span data-ttu-id="e6d33-183">Zbývající změny budou snazší přímo v kódu.</span><span class="sxs-lookup"><span data-stu-id="e6d33-183">The remaining changes will be easier to do directly in markup.</span></span> <span data-ttu-id="e6d33-184">Značka ovládacího prvku `GridView` nyní vypadá jako v následujícím příkladu.</span><span class="sxs-lookup"><span data-stu-id="e6d33-184">The `GridView` control markup now looks like the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample3.aspx)]

<span data-ttu-id="e6d33-185">První sloupec za polem příkazu je pole šablony, ve kterém se aktuálně zobrazuje křestní jméno.</span><span class="sxs-lookup"><span data-stu-id="e6d33-185">The first column after the command field is a template field that currently displays the first name.</span></span> <span data-ttu-id="e6d33-186">Změňte označení pro toto pole šablony tak, aby vypadalo jako v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="e6d33-186">Change the markup for this template field to look like the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample4.aspx)]

<span data-ttu-id="e6d33-187">V režimu zobrazení se dva ovládací prvky `Label` zobrazují jako jméno a příjmení.</span><span class="sxs-lookup"><span data-stu-id="e6d33-187">In display mode, two `Label` controls display the first and last name.</span></span> <span data-ttu-id="e6d33-188">V režimu úprav jsou k dispozici dvě textová pole, abyste mohli změnit jméno a příjmení.</span><span class="sxs-lookup"><span data-stu-id="e6d33-188">In edit mode, two text boxes are provided so you can change the first and last name.</span></span> <span data-ttu-id="e6d33-189">Stejně jako u ovládacích prvků `Label` v režimu zobrazení používáte `Bind` a `Eval` výrazy přesně tak, jak byste měli ASP.NET ovládací prvky zdroje dat, které se připojují přímo k databázím.</span><span class="sxs-lookup"><span data-stu-id="e6d33-189">As with the `Label` controls in display mode, you use `Bind` and `Eval` expressions exactly as you would with ASP.NET data source controls that connect directly to databases.</span></span> <span data-ttu-id="e6d33-190">Jediným rozdílem je, že zadáváte vlastnosti entity místo databázových sloupců.</span><span class="sxs-lookup"><span data-stu-id="e6d33-190">The only difference is that you're specifying entity properties instead of database columns.</span></span>

<span data-ttu-id="e6d33-191">Poslední sloupec je pole šablony, které zobrazuje datum zápisu.</span><span class="sxs-lookup"><span data-stu-id="e6d33-191">The last column is a template field that displays the enrollment date.</span></span> <span data-ttu-id="e6d33-192">Změňte označení tohoto pole tak, aby vypadalo jako v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="e6d33-192">Change the markup for this field to look like the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample5.aspx)]

<span data-ttu-id="e6d33-193">V režimu zobrazení i úprav formátový řetězec {0, d} způsobí, že se datum zobrazí ve formátu "short data".</span><span class="sxs-lookup"><span data-stu-id="e6d33-193">In both display and edit mode, the format string "{0,d}" causes the date to be displayed in the "short date" format.</span></span> <span data-ttu-id="e6d33-194">(Váš počítač může být nakonfigurovaný tak, aby se tento formát zobrazoval jinak než obrázky obrazovky zobrazené v tomto kurzu.)</span><span class="sxs-lookup"><span data-stu-id="e6d33-194">(Your computer might be configured to display this format differently from the screen images shown in this tutorial.)</span></span>

<span data-ttu-id="e6d33-195">Všimněte si, že v každé z těchto polí šablony Návrhář ve výchozím nastavení použil výraz `Bind`, ale změnili jste jej na výraz `Eval` v elementech `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-195">Notice that in each of these template fields, the designer used a `Bind` expression by default, but you've changed that to an `Eval` expression in the `ItemTemplate` elements.</span></span> <span data-ttu-id="e6d33-196">Výraz `Bind` zpřístupňuje dostupná data v `GridView` vlastnosti ovládacího prvku pro případ, že budete potřebovat přístup k datům v kódu.</span><span class="sxs-lookup"><span data-stu-id="e6d33-196">The `Bind` expression makes the data available in `GridView` control properties in case you need to access the data in code.</span></span> <span data-ttu-id="e6d33-197">Na této stránce nepotřebujete přístup k těmto datům v kódu, takže můžete použít `Eval`, což je efektivnější.</span><span class="sxs-lookup"><span data-stu-id="e6d33-197">In this page you don't need to access this data in code, so you can use `Eval`, which is more efficient.</span></span> <span data-ttu-id="e6d33-198">Další informace najdete v tématu věnovaném [získání dat z ovládacích prvků pro](https://weblogs.asp.net/davidfowler/archive/2008/12/12/getting-your-data-out-of-the-data-controls.aspx)data.</span><span class="sxs-lookup"><span data-stu-id="e6d33-198">For more information, see [Getting your data out of the data controls](https://weblogs.asp.net/davidfowler/archive/2008/12/12/getting-your-data-out-of-the-data-controls.aspx).</span></span>

## <a name="revising-entitydatasource-control-markup-to-improve-performance"></a><span data-ttu-id="e6d33-199">Revize značek ovládacího prvku EntityDataSource pro zlepšení výkonu</span><span class="sxs-lookup"><span data-stu-id="e6d33-199">Revising EntityDataSource Control Markup to Improve Performance</span></span>

<span data-ttu-id="e6d33-200">V označení ovládacího prvku `EntityDataSource` odeberte atributy `ConnectionString` a `DefaultContainerName` a nahraďte je atributem `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-200">In the markup for the `EntityDataSource` control, remove the `ConnectionString` and `DefaultContainerName` attributes and replace them with a `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="e6d33-201">Toto je změna, kterou byste měli udělat při každém vytvoření ovládacího prvku `EntityDataSource`, pokud nepotřebujete použít připojení, které se liší od toho, který je pevně kódovaný ve třídě kontextu objektu.</span><span class="sxs-lookup"><span data-stu-id="e6d33-201">This is a change you should make every time you create an `EntityDataSource` control, unless you need to use a connection that is different from the one that's hard-coded in the object context class.</span></span> <span data-ttu-id="e6d33-202">Použití atributu `ContextTypeName` přináší následující výhody:</span><span class="sxs-lookup"><span data-stu-id="e6d33-202">Using the `ContextTypeName` attribute provides the following benefits:</span></span>

- <span data-ttu-id="e6d33-203">Lepší výkon.</span><span class="sxs-lookup"><span data-stu-id="e6d33-203">Better performance.</span></span> <span data-ttu-id="e6d33-204">Když ovládací prvek `EntityDataSource` inicializuje datový model pomocí atributů `ConnectionString` a `DefaultContainerName`, provede další práci pro načtení metadat pro každý požadavek.</span><span class="sxs-lookup"><span data-stu-id="e6d33-204">When the `EntityDataSource` control initializes the data model using the `ConnectionString` and `DefaultContainerName` attributes, it performs additional work to load metadata on every request.</span></span> <span data-ttu-id="e6d33-205">To není nutné, pokud zadáte atribut `ContextTypeName`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-205">This isn't necessary if you specify the `ContextTypeName` attribute.</span></span>
- <span data-ttu-id="e6d33-206">Opožděné načítání je ve výchozím nastavení zapnuté v třídách kontextu generovaných objektů (například `SchoolEntities` v tomto kurzu) v Entity Framework 4,0.</span><span class="sxs-lookup"><span data-stu-id="e6d33-206">Lazy loading is turned on by default in generated object context classes (such as `SchoolEntities` in this tutorial) in Entity Framework 4.0.</span></span> <span data-ttu-id="e6d33-207">To znamená, že navigační vlastnosti jsou v případě potřeby načítány se souvisejícími daty automaticky.</span><span class="sxs-lookup"><span data-stu-id="e6d33-207">This means that navigation properties are loaded with related data automatically right when you need it.</span></span> <span data-ttu-id="e6d33-208">Opožděné načítání je podrobněji vysvětleno dále v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="e6d33-208">Lazy loading is explained in more detail later in this tutorial.</span></span>
- <span data-ttu-id="e6d33-209">Všechna vlastní nastavení, která jste použili u třídy kontextu objektu (v tomto případě `SchoolEntities` třídy), budou k dispozici pro ovládací prvky, které používají ovládací prvek `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-209">Any customizations that you've applied to the object context class (in this case, the `SchoolEntities` class) will be available to controls that use the `EntityDataSource` control.</span></span> <span data-ttu-id="e6d33-210">Přizpůsobení třídy kontextu objektu je pokročilé téma, které není zahrnuto v této sérii kurzů.</span><span class="sxs-lookup"><span data-stu-id="e6d33-210">Customizing the object context class is an advanced topic that is not covered in this tutorial series.</span></span> <span data-ttu-id="e6d33-211">Další informace naleznete v tématu [rozšíření Entity Framework generovaných typů](https://msdn.microsoft.com/library/dd456844.aspx).</span><span class="sxs-lookup"><span data-stu-id="e6d33-211">For more information, see [Extending Entity Framework Generated Types](https://msdn.microsoft.com/library/dd456844.aspx).</span></span>

<span data-ttu-id="e6d33-212">Značka se teď bude podobat následujícímu příkladu (pořadí vlastností se může lišit):</span><span class="sxs-lookup"><span data-stu-id="e6d33-212">The markup will now resemble the following example (the order of the properties might be different):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample6.aspx)]

<span data-ttu-id="e6d33-213">Atribut `EnableFlattening` odkazuje na funkci, která byla vyžadována v dřívějších verzích Entity Framework, protože sloupce cizího klíče nebyly zveřejněny jako vlastnosti entity.</span><span class="sxs-lookup"><span data-stu-id="e6d33-213">The `EnableFlattening` attribute refers to a feature that was needed in earlier versions of the Entity Framework because foreign key columns were not exposed as entity properties.</span></span> <span data-ttu-id="e6d33-214">Aktuální verze umožňuje použít *přidružení cizího klíče*, což znamená, že vlastnosti cizího klíče jsou zpřístupněny pro všechna přiřazení, ale u přidružení typu m:n.</span><span class="sxs-lookup"><span data-stu-id="e6d33-214">The current version makes it possible to use *foreign key associations*, which means foreign key properties are exposed for all but many-to-many associations.</span></span> <span data-ttu-id="e6d33-215">Pokud vaše Entity obsahují vlastnosti cizího klíče a žádné [komplexní typy](https://msdn.microsoft.com/library/bb738472.aspx), můžete ponechat tento atribut nastavený na `False`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-215">If your entities have foreign key properties and no [complex types](https://msdn.microsoft.com/library/bb738472.aspx), you can leave this attribute set to `False`.</span></span> <span data-ttu-id="e6d33-216">Neodstraňujte atribut ze značky, protože výchozí hodnota je `True`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-216">Don't remove the attribute from the markup, because the default value is `True`.</span></span> <span data-ttu-id="e6d33-217">Další informace najdete v tématu věnovaném [sloučení objektů (EntityDataSource)](https://msdn.microsoft.com/library/ee404746.aspx).</span><span class="sxs-lookup"><span data-stu-id="e6d33-217">For more information, see [Flattening Objects (EntityDataSource)](https://msdn.microsoft.com/library/ee404746.aspx).</span></span>

<span data-ttu-id="e6d33-218">Spusťte stránku a zobrazí se seznam studentů a zaměstnanců (v dalším kurzu budete filtrovat jenom studenty).</span><span class="sxs-lookup"><span data-stu-id="e6d33-218">Run the page and you see a list of students and employees (you'll filter for just students in the next tutorial).</span></span> <span data-ttu-id="e6d33-219">Křestní jméno a příjmení se zobrazí společně.</span><span class="sxs-lookup"><span data-stu-id="e6d33-219">The first name and last name are displayed together.</span></span>

<span data-ttu-id="e6d33-220">[![Image07](the-entity-framework-and-aspnet-getting-started-part-2/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-220">[![Image07](the-entity-framework-and-aspnet-getting-started-part-2/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image35.png)</span></span>

<span data-ttu-id="e6d33-221">Pokud chcete zobrazení seřadit, klikněte na název sloupce.</span><span class="sxs-lookup"><span data-stu-id="e6d33-221">To sort the display, click a column name.</span></span>

<span data-ttu-id="e6d33-222">V libovolném řádku klikněte na **Upravit** .</span><span class="sxs-lookup"><span data-stu-id="e6d33-222">Click **Edit** in any row.</span></span> <span data-ttu-id="e6d33-223">Textová pole se zobrazí, kde můžete změnit jméno a příjmení.</span><span class="sxs-lookup"><span data-stu-id="e6d33-223">Text boxes are displayed where you can change the first and last name.</span></span>

<span data-ttu-id="e6d33-224">[![Image08](the-entity-framework-and-aspnet-getting-started-part-2/_static/image38.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-224">[![Image08](the-entity-framework-and-aspnet-getting-started-part-2/_static/image38.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image37.png)</span></span>

<span data-ttu-id="e6d33-225">Tlačítko **Odstranit** také funguje.</span><span class="sxs-lookup"><span data-stu-id="e6d33-225">The **Delete** button also works.</span></span> <span data-ttu-id="e6d33-226">Klikněte na tlačítko Odstranit pro řádek, který má datum registrace, a řádek zmizí.</span><span class="sxs-lookup"><span data-stu-id="e6d33-226">Click delete for a row that has an enrollment date and the row disappears.</span></span> <span data-ttu-id="e6d33-227">(Řádky bez data registrace reprezentují instruktory a může se zobrazit chyba referenční integrity.</span><span class="sxs-lookup"><span data-stu-id="e6d33-227">(Rows without an enrollment date represent instructors and you may get a referential integrity error.</span></span> <span data-ttu-id="e6d33-228">V dalším kurzu tento seznam vyfiltrujete tak, aby zahrnoval jenom studenty.)</span><span class="sxs-lookup"><span data-stu-id="e6d33-228">In the next tutorial you'll filter this list to include just students.)</span></span>

## <a name="displaying-data-from-a-navigation-property"></a><span data-ttu-id="e6d33-229">Zobrazení dat z navigační vlastnosti</span><span class="sxs-lookup"><span data-stu-id="e6d33-229">Displaying Data from a Navigation Property</span></span>

<span data-ttu-id="e6d33-230">Nyní předpokládejme, že chcete zjistit, kolik kurzů má každý student zaregistrovaný.</span><span class="sxs-lookup"><span data-stu-id="e6d33-230">Now suppose you want to know how many courses each student is enrolled in.</span></span> <span data-ttu-id="e6d33-231">Entity Framework poskytuje tyto informace v `StudentGrades` navigační vlastnosti entity `Person`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-231">The Entity Framework provides that information in the `StudentGrades` navigation property of the `Person` entity.</span></span> <span data-ttu-id="e6d33-232">Vzhledem k tomu, že návrh databáze neumožňuje, aby se student zaregistroval v rámci kurzu, aniž by se mu přiřadila vaše třídy, můžete předpokládat, že řádek v řádku `StudentGrade` tabulky, který je spojený s kurzem, je stejný jako zápis do kurzu.</span><span class="sxs-lookup"><span data-stu-id="e6d33-232">Because the database design does not allow a student to be enrolled in a course without having a grade assigned, for this tutorial you can assume that having a row in the `StudentGrade` table row that is associated with a course is the same as being enrolled in the course.</span></span> <span data-ttu-id="e6d33-233">(Navigační vlastnost `Courses` je určena pouze pro instruktory.)</span><span class="sxs-lookup"><span data-stu-id="e6d33-233">(The `Courses` navigation property is only for instructors.)</span></span>

<span data-ttu-id="e6d33-234">Použijete-li atribut `ContextTypeName` ovládacího prvku `EntityDataSource`, Entity Framework při přístupu k této vlastnosti automaticky načte informace pro navigační vlastnost.</span><span class="sxs-lookup"><span data-stu-id="e6d33-234">When you use the `ContextTypeName` attribute of the `EntityDataSource` control, the Entity Framework automatically retrieves information for a navigation property when you access that property.</span></span> <span data-ttu-id="e6d33-235">Tato metoda se nazývá *opožděné načítání*.</span><span class="sxs-lookup"><span data-stu-id="e6d33-235">This is called *lazy loading*.</span></span> <span data-ttu-id="e6d33-236">To však může být neefektivní, protože má za následek samostatné volání databáze pokaždé, když jsou potřeba další informace.</span><span class="sxs-lookup"><span data-stu-id="e6d33-236">However, this can be inefficient, because it results in a separate call to the database each time additional information is needed.</span></span> <span data-ttu-id="e6d33-237">Pokud potřebujete data z vlastnosti navigace pro každou entitu vrácenou ovládacím prvkem `EntityDataSource`, je efektivnější načíst související data společně s entitou v jednom volání do databáze.</span><span class="sxs-lookup"><span data-stu-id="e6d33-237">If you need data from the navigation property for every entity returned by the `EntityDataSource` control, it's more efficient to retrieve the related data along with the entity itself in a single call to the database.</span></span> <span data-ttu-id="e6d33-238">To se říká *Eager načítání*a zadáte Eager načítání pro navigační vlastnost nastavením vlastnosti `Include` ovládacího prvku `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-238">This is called *eager loading*, and you specify eager loading for a navigation property by setting the `Include` property of the `EntityDataSource` control.</span></span>

<span data-ttu-id="e6d33-239">Ve službě *students. aspx*chcete zobrazit počet kurzů pro každého studenta, takže Eager načítání je nejlepší volbou.</span><span class="sxs-lookup"><span data-stu-id="e6d33-239">In *Students.aspx*, you want to show the number of courses for every student, so eager loading is the best choice.</span></span> <span data-ttu-id="e6d33-240">Pokud jste zobrazili všechny studenty, ale zobrazuje se počet kurzů jenom pro několik z nich (což by vyžadovalo psaní kódu navíc k označení), může být opožděné načítání lepší volbou.</span><span class="sxs-lookup"><span data-stu-id="e6d33-240">If you were displaying all students but showing the number of courses only for a few of them (which would require writing some code in addition to the markup), lazy loading might be a better choice.</span></span>

<span data-ttu-id="e6d33-241">Otevřete nebo přejděte na *studenty. aspx*, přepněte do zobrazení **návrh** , vyberte `StudentsEntityDataSource`a v okně **vlastnosti** nastavte vlastnost **include** na **StudentGrades**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-241">Open or switch to *Students.aspx*, switch to **Design** view, select `StudentsEntityDataSource`, and in the **Properties** window set the **Include** property to **StudentGrades**.</span></span> <span data-ttu-id="e6d33-242">(Pokud jste chtěli získat více vlastností navigace, mohli byste zadat jejich názvy oddělené čárkami, například **StudentGrades, kurzy**).</span><span class="sxs-lookup"><span data-stu-id="e6d33-242">(If you wanted to get multiple navigation properties, you could specify their names separated by commas — for example, **StudentGrades, Courses**.)</span></span>

<span data-ttu-id="e6d33-243">[![Image19](the-entity-framework-and-aspnet-getting-started-part-2/_static/image40.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-243">[![Image19](the-entity-framework-and-aspnet-getting-started-part-2/_static/image40.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image39.png)</span></span>

<span data-ttu-id="e6d33-244">Přepněte do zobrazení **zdroje** .</span><span class="sxs-lookup"><span data-stu-id="e6d33-244">Switch to **Source** view.</span></span> <span data-ttu-id="e6d33-245">V ovládacím prvku `StudentsGridView` za poslední prvek `asp:TemplateField` přidejte následující nové pole šablony:</span><span class="sxs-lookup"><span data-stu-id="e6d33-245">In the `StudentsGridView` control, after the last `asp:TemplateField` element, add the following new template field:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample7.aspx)]

<span data-ttu-id="e6d33-246">Ve výrazu `Eval` můžete odkazovat na vlastnost navigace `StudentGrades`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-246">In the `Eval` expression, you can reference the navigation property `StudentGrades`.</span></span> <span data-ttu-id="e6d33-247">Vzhledem k tomu, že tato vlastnost obsahuje kolekci, má vlastnost `Count`, kterou můžete použít k zobrazení počtu kurzů, ve kterých je student zaregistrovaný.</span><span class="sxs-lookup"><span data-stu-id="e6d33-247">Because this property contains a collection, it has a `Count` property that you can use to display the number of courses in which the student is enrolled.</span></span> <span data-ttu-id="e6d33-248">V pozdějším kurzu uvidíte, jak zobrazit data z navigačních vlastností, které obsahují jednotlivé entity místo kolekcí.</span><span class="sxs-lookup"><span data-stu-id="e6d33-248">In a later tutorial you'll see how to display data from navigation properties that contain single entities instead of collections.</span></span> <span data-ttu-id="e6d33-249">(Všimněte si, že nemůžete použít prvky `BoundField` k zobrazení dat z vlastností navigace.)</span><span class="sxs-lookup"><span data-stu-id="e6d33-249">(Note that you cannot use `BoundField` elements to display data from navigation properties.)</span></span>

<span data-ttu-id="e6d33-250">Spusťte stránku a teď uvidíte, kolik kurzů jednotlivého studenta jsou zaregistrované v.</span><span class="sxs-lookup"><span data-stu-id="e6d33-250">Run the page and you now see how many courses each student is enrolled in.</span></span>

<span data-ttu-id="e6d33-251">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image42.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-251">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image42.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image41.png)</span></span>

## <a name="using-a-detailsview-control-to-insert-entities"></a><span data-ttu-id="e6d33-252">Použití ovládacího prvku DetailsView pro vložení entit</span><span class="sxs-lookup"><span data-stu-id="e6d33-252">Using a DetailsView Control to Insert Entities</span></span>

<span data-ttu-id="e6d33-253">Dalším krokem je vytvoření stránky s `DetailsView` ovládacím prvkem, který vám umožní přidat nové studenty.</span><span class="sxs-lookup"><span data-stu-id="e6d33-253">The next step is to create a page that has a `DetailsView` control that will let you add new students.</span></span> <span data-ttu-id="e6d33-254">Zavřete prohlížeč a pak vytvořte novou webovou stránku pomocí stránky předlohy *Web. Master* .</span><span class="sxs-lookup"><span data-stu-id="e6d33-254">Close the browser and then create a new web page using the *Site.Master* master page.</span></span> <span data-ttu-id="e6d33-255">Pojmenujte stránku *StudentsAdd. aspx*a pak přepněte do zobrazení **zdroje** .</span><span class="sxs-lookup"><span data-stu-id="e6d33-255">Name the page *StudentsAdd.aspx*, and then switch to **Source** view.</span></span>

<span data-ttu-id="e6d33-256">Přidejte následující kód, který nahradí existující značku ovládacího prvku `Content` s názvem `Content2`:</span><span class="sxs-lookup"><span data-stu-id="e6d33-256">Add the following markup to replace the existing markup for the `Content` control named `Content2`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample8.aspx)]

<span data-ttu-id="e6d33-257">Tento kód vytvoří ovládací prvek `EntityDataSource`, který se podobá tomu, který jste vytvořili ve službě *students. aspx*, s výjimkou toho, že umožňuje vkládání.</span><span class="sxs-lookup"><span data-stu-id="e6d33-257">This markup creates an `EntityDataSource` control that is similar to the one you created in *Students.aspx*, except it enables insertion.</span></span> <span data-ttu-id="e6d33-258">Stejně jako u ovládacího prvku `GridView` jsou vázaná pole ovládacího prvku `DetailsView` kódována přesně stejně, jako by byla pro ovládací prvek dat, který se připojuje přímo k databázi, s výjimkou toho, že odkazují na vlastnosti entit.</span><span class="sxs-lookup"><span data-stu-id="e6d33-258">As with the `GridView` control, the bound fields of the `DetailsView` control are coded exactly as they would be for a data control that connects directly to a database, except that they reference entity properties.</span></span> <span data-ttu-id="e6d33-259">V tomto případě se `DetailsView` ovládací prvek používá pouze pro vložení řádků, takže jste nastavili výchozí režim na `Insert`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-259">In this case, the `DetailsView` control is used only for inserting rows, so you have set the default mode to `Insert`.</span></span>

<span data-ttu-id="e6d33-260">Spusťte stránku a přidejte nového studenta.</span><span class="sxs-lookup"><span data-stu-id="e6d33-260">Run the page and add a new student.</span></span>

<span data-ttu-id="e6d33-261">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image44.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-261">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image44.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image43.png)</span></span>

<span data-ttu-id="e6d33-262">Po vložení nového studenta se nic nestane, ale pokud teď spustíte *studenty. aspx*, zobrazí se informace o novém studentovi.</span><span class="sxs-lookup"><span data-stu-id="e6d33-262">Nothing will happen after you insert a new student, but if you now run *Students.aspx*, you'll see the new student information.</span></span>

## <a name="displaying-data-in-a-drop-down-list"></a><span data-ttu-id="e6d33-263">Zobrazení dat v rozevíracím seznamu</span><span class="sxs-lookup"><span data-stu-id="e6d33-263">Displaying Data in a Drop-Down List</span></span>

<span data-ttu-id="e6d33-264">V následujících krocích provedete vázání ovládacího prvku `DropDownList` do sady entit pomocí ovládacího prvku `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-264">In the following steps you'll databind a `DropDownList` control to an entity set using an `EntityDataSource` control.</span></span> <span data-ttu-id="e6d33-265">V této části kurzu nebudete s tímto seznamem mnohem dělat.</span><span class="sxs-lookup"><span data-stu-id="e6d33-265">In this part of the tutorial, you won't do much with this list.</span></span> <span data-ttu-id="e6d33-266">V následujících částech ale pomocí seznamu umožníte uživatelům vybrat oddělení k zobrazení kurzů přidružených k danému oddělení.</span><span class="sxs-lookup"><span data-stu-id="e6d33-266">In subsequent parts, though, you'll use the list to let users select a department to display courses associated with the department.</span></span>

<span data-ttu-id="e6d33-267">Vytvořte novou webovou stránku s názvem *kurzy. aspx*.</span><span class="sxs-lookup"><span data-stu-id="e6d33-267">Create a new web page named *Courses.aspx*.</span></span> <span data-ttu-id="e6d33-268">V zobrazení **zdroj** přidejte záhlaví do ovládacího prvku `Content` s názvem `Content2`:</span><span class="sxs-lookup"><span data-stu-id="e6d33-268">In **Source** view, add a heading to the `Content` control that's named `Content2`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample9.aspx)]

<span data-ttu-id="e6d33-269">V zobrazení **Návrh** přidejte ovládací prvek `EntityDataSource` do stránky stejně jako předtím, s výjimkou tohoto názvu `DepartmentsEntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-269">In **Design** view, add an `EntityDataSource` control to the page as you did before, except this time name it `DepartmentsEntityDataSource`.</span></span> <span data-ttu-id="e6d33-270">Jako hodnotu **EntitySetName** vyberte **oddělení** a vyberte jenom vlastnosti **DepartmentID** a **Name** .</span><span class="sxs-lookup"><span data-stu-id="e6d33-270">Select **Departments** as the **EntitySetName** value, and select only the **DepartmentID** and **Name** properties.</span></span>

<span data-ttu-id="e6d33-271">[![Image15](the-entity-framework-and-aspnet-getting-started-part-2/_static/image46.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-271">[![Image15](the-entity-framework-and-aspnet-getting-started-part-2/_static/image46.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image45.png)</span></span>

<span data-ttu-id="e6d33-272">Z karty **standardní** na **panelu nástrojů**přetáhněte ovládací prvek `DropDownList` na stránku, pojmenujte ho `DepartmentsDropDownList`, klikněte na inteligentní značku a výběrem **Možnosti zvolit zdroj dat** spusťte **Průvodce konfigurací zdroje**dat.</span><span class="sxs-lookup"><span data-stu-id="e6d33-272">From the **Standard** tab of the **Toolbox**, drag a `DropDownList` control to the page, name it `DepartmentsDropDownList`, click the smart tag, and select **Choose Data Source** to start the **DataSource Configuration Wizard**.</span></span>

<span data-ttu-id="e6d33-273">[![Image16](the-entity-framework-and-aspnet-getting-started-part-2/_static/image48.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-273">[![Image16](the-entity-framework-and-aspnet-getting-started-part-2/_static/image48.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image47.png)</span></span>

<span data-ttu-id="e6d33-274">V kroku **Zvolte zdroj dat** vyberte **DepartmentsEntityDataSource** jako zdroj dat, klikněte na **Aktualizovat schéma**a pak vyberte **název** jako datové pole, které chcete zobrazit a **DepartmentID** jako pole data hodnoty.</span><span class="sxs-lookup"><span data-stu-id="e6d33-274">In the **Choose a Data Source** step, select **DepartmentsEntityDataSource** as the data source, click **Refresh Schema**, and then select **Name** as the data field to display and **DepartmentID** as the value data field.</span></span> <span data-ttu-id="e6d33-275">Klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="e6d33-275">Click **OK**.</span></span>

<span data-ttu-id="e6d33-276">[![Image17](the-entity-framework-and-aspnet-getting-started-part-2/_static/image50.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-276">[![Image17](the-entity-framework-and-aspnet-getting-started-part-2/_static/image50.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image49.png)</span></span>

<span data-ttu-id="e6d33-277">Metoda, kterou použijete k vázání ovládacího prvku pomocí Entity Framework, je stejná jako u jiných ovládacích prvků zdroje dat ASP.NET s výjimkou, že zadáváte vlastnosti entit a entit.</span><span class="sxs-lookup"><span data-stu-id="e6d33-277">The method you use to databind the control using the Entity Framework is the same as with other ASP.NET data source controls except you're specifying entities and entity properties.</span></span>

<span data-ttu-id="e6d33-278">Přepněte do zobrazení **zdroje** a přidejte "vybrat oddělení:" těsně před ovládací prvek `DropDownList`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-278">Switch to **Source** view and add "Select a department:" immediately before the `DropDownList` control.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample10.aspx)]

<span data-ttu-id="e6d33-279">Jako připomenutí změňte značku ovládacího prvku `EntityDataSource` v tomto okamžiku nahrazením atributů `ConnectionString` a `DefaultContainerName` atributem `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-279">As a reminder, change the markup for the `EntityDataSource` control at this point by replacing the `ConnectionString` and `DefaultContainerName` attributes with a `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="e6d33-280">Je často vhodné počkat až po vytvoření ovládacího prvku vázaného na data, který je propojen s ovládacím prvkem zdroje dat před změnou značky ovládacího prvku `EntityDataSource`, protože po provedení změny Návrhář neposkytne možnost **Aktualizovat schéma** v ovládacím prvku vázaného na data.</span><span class="sxs-lookup"><span data-stu-id="e6d33-280">It's often best to wait until after you've created the data-bound control that is linked to the data source control before you change the `EntityDataSource` control markup, because after you make the change, the designer will not provide you with a **Refresh Schema** option in the data-bound control.</span></span>

<span data-ttu-id="e6d33-281">Spusťte stránku a v rozevíracím seznamu můžete vybrat oddělení.</span><span class="sxs-lookup"><span data-stu-id="e6d33-281">Run the page and you can select a department from the drop-down list.</span></span>

<span data-ttu-id="e6d33-282">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image52.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image51.png)</span><span class="sxs-lookup"><span data-stu-id="e6d33-282">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image52.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image51.png)</span></span>

<span data-ttu-id="e6d33-283">Tím se dokončí Úvod k použití ovládacího prvku `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="e6d33-283">This completes the introduction to using the `EntityDataSource` control.</span></span> <span data-ttu-id="e6d33-284">Práce s tímto ovládacím prvkem se obecně neliší od práce s jinými ovládacími prvky zdroje dat ASP.NET s tím rozdílem, že místo tabulek a sloupců odkazujete na entity a vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="e6d33-284">Working with this control is generally no different from working with other ASP.NET data source controls, except that you reference entities and properties instead of tables and columns.</span></span> <span data-ttu-id="e6d33-285">Jedinou výjimkou je, když chcete získat přístup k vlastnostem navigace.</span><span class="sxs-lookup"><span data-stu-id="e6d33-285">The only exception is when you want to access navigation properties.</span></span> <span data-ttu-id="e6d33-286">V dalším kurzu uvidíte, že syntaxe, kterou používáte s ovládacím prvkem `EntityDataSource`, se může lišit od jiných ovládacích prvků zdroje dat při filtrování, seskupování a řazení dat.</span><span class="sxs-lookup"><span data-stu-id="e6d33-286">In the next tutorial you'll see that the syntax you use with `EntityDataSource` control might also differ from other data source controls when you filter, group, and order data.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e6d33-287">[Předchozí](the-entity-framework-and-aspnet-getting-started-part-1.md)
> [Další](the-entity-framework-and-aspnet-getting-started-part-3.md)</span><span class="sxs-lookup"><span data-stu-id="e6d33-287">[Previous](the-entity-framework-and-aspnet-getting-started-part-1.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-3.md)</span></span>
