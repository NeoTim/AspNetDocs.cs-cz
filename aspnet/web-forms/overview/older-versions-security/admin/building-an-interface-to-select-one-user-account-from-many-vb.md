---
uid: web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
title: Sestavení rozhraní pro výběr jednoho uživatelského účtu z mnoha (VB) | Microsoft Docs
author: rick-anderson
description: V tomto kurzu sestavíme uživatelské rozhraní se stránkou, kterou filtrovatelné mřížky. Zejména naše uživatelské rozhraní se bude skládat z řady LinkButtons pro...
ms.author: riande
ms.date: 04/01/2008
ms.assetid: da53380c-a16b-41c7-a20d-24343c735c52
msc.legacyurl: /web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
msc.type: authoredcontent
ms.openlocfilehash: 6c711cdaab113d589d9c2535cb1b422de3f38103
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78637541"
---
# <a name="building-an-interface-to-select-one-user-account-from-many-vb"></a><span data-ttu-id="af48c-104">Vytvoření rozhraní pro výběr jednoho uživatelského účtu z mnoha (VB)</span><span class="sxs-lookup"><span data-stu-id="af48c-104">Building an Interface to Select One User Account from Many (VB)</span></span>

<span data-ttu-id="af48c-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="af48c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="af48c-106">[Stažení kódu](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.12.zip) nebo [stažení PDF](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="af48c-106">[Download Code](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.12.zip) or [Download PDF](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_vb.pdf)</span></span>

> <span data-ttu-id="af48c-107">V tomto kurzu sestavíme uživatelské rozhraní se stránkou, kterou filtrovatelné mřížky.</span><span class="sxs-lookup"><span data-stu-id="af48c-107">In this tutorial we will build a user interface with a paged, filterable grid.</span></span> <span data-ttu-id="af48c-108">Zejména naše uživatelské rozhraní se bude skládat z řady prvků LinkButtons pro filtrování výsledků na základě počátečního písmene uživatelského jména a ovládacího prvku GridView pro zobrazení vyhovujících uživatelů.</span><span class="sxs-lookup"><span data-stu-id="af48c-108">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="af48c-109">Začneme výpisem všech uživatelských účtů v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="af48c-109">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="af48c-110">V kroku 3 potom přidáme filtr LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="af48c-110">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="af48c-111">Krok 4 vyhledá filtrované výsledky na stránkování.</span><span class="sxs-lookup"><span data-stu-id="af48c-111">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="af48c-112">Rozhraní vytvořené v krocích 2 až 4 se použije v následujících kurzech k provádění úloh správy pro konkrétní uživatelský účet.</span><span class="sxs-lookup"><span data-stu-id="af48c-112">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

## <a name="introduction"></a><span data-ttu-id="af48c-113">Úvod</span><span class="sxs-lookup"><span data-stu-id="af48c-113">Introduction</span></span>

<span data-ttu-id="af48c-114"><a id="_msoanchor_1"> </a>V kurzu [*přiřazování rolí k uživatelům*](../roles/assigning-roles-to-users-vb.md) jsme vytvořili rozhraní základní, ve kterém může správce vybrat uživatele a spravovat jeho role.</span><span class="sxs-lookup"><span data-stu-id="af48c-114">In the <a id="_msoanchor_1"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-vb.md) tutorial, we created a rudimentary interface for an administrator to select a user and manage her roles.</span></span> <span data-ttu-id="af48c-115">Konkrétně rozhraní prezentuje správce s rozevíracím seznamem všech uživatelů.</span><span class="sxs-lookup"><span data-stu-id="af48c-115">Specifically, the interface presented the administrator with a drop-down list of all of the users.</span></span> <span data-ttu-id="af48c-116">Toto rozhraní je vhodné v případě, že existují i desítkové uživatelské účty, ale je nepraktický pro weby se stovkami nebo tisíci účtů.</span><span class="sxs-lookup"><span data-stu-id="af48c-116">Such an interface is suitable when there are but a dozen or so user accounts, but is unwieldy for sites with hundreds or thousands of accounts.</span></span> <span data-ttu-id="af48c-117">Stránkovaná tabulka, která se filtruje, je vhodnějším uživatelským rozhraním pro weby s velkými základy uživatelů.</span><span class="sxs-lookup"><span data-stu-id="af48c-117">A paged, filterable grid is more suitable user interface for websites with large user bases.</span></span>

<span data-ttu-id="af48c-118">V tomto kurzu vytvoříme takové uživatelské rozhraní.</span><span class="sxs-lookup"><span data-stu-id="af48c-118">In this tutorial we will build such a user interface.</span></span> <span data-ttu-id="af48c-119">Zejména naše uživatelské rozhraní se bude skládat z řady prvků LinkButtons pro filtrování výsledků na základě počátečního písmene uživatelského jména a ovládacího prvku GridView pro zobrazení vyhovujících uživatelů.</span><span class="sxs-lookup"><span data-stu-id="af48c-119">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="af48c-120">Začneme výpisem všech uživatelských účtů v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="af48c-120">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="af48c-121">V kroku 3 potom přidáme filtr LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="af48c-121">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="af48c-122">Krok 4 vyhledá filtrované výsledky na stránkování.</span><span class="sxs-lookup"><span data-stu-id="af48c-122">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="af48c-123">Rozhraní vytvořené v krocích 2 až 4 se použije v následujících kurzech k provádění úloh správy pro konkrétní uživatelský účet.</span><span class="sxs-lookup"><span data-stu-id="af48c-123">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

<span data-ttu-id="af48c-124">Pojďme začít!</span><span class="sxs-lookup"><span data-stu-id="af48c-124">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="af48c-125">Krok 1: přidání nových stránek ASP.NET</span><span class="sxs-lookup"><span data-stu-id="af48c-125">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="af48c-126">V tomto kurzu a dalších dvou budeme zkoumat různé funkce a možnosti související se správou.</span><span class="sxs-lookup"><span data-stu-id="af48c-126">In this tutorial and the next two we will be examining various administration-related functions and capabilities.</span></span> <span data-ttu-id="af48c-127">K implementaci témat prověřených v rámci těchto kurzů budeme potřebovat řadu ASP.NET stránek.</span><span class="sxs-lookup"><span data-stu-id="af48c-127">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="af48c-128">Pojďme vytvořit tyto stránky a aktualizovat mapu webu.</span><span class="sxs-lookup"><span data-stu-id="af48c-128">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="af48c-129">Začněte vytvořením nové složky v projektu s názvem `Administration`.</span><span class="sxs-lookup"><span data-stu-id="af48c-129">Start by creating a new folder in the project named `Administration`.</span></span> <span data-ttu-id="af48c-130">Dále přidejte do složky dvě nové stránky ASP.NET a propojíte každou stránku se stránkou předlohy `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="af48c-130">Next, add two new ASP.NET pages to the folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="af48c-131">Pojmenujte stránky:</span><span class="sxs-lookup"><span data-stu-id="af48c-131">Name the pages:</span></span>

- `ManageUsers.aspx`
- `UserInformation.aspx`

<span data-ttu-id="af48c-132">Přidejte také dvě stránky do kořenového adresáře webu: `ChangePassword.aspx` a `RecoverPassword.aspx`.</span><span class="sxs-lookup"><span data-stu-id="af48c-132">Also add two pages to the website's root directory: `ChangePassword.aspx` and `RecoverPassword.aspx`.</span></span>

<span data-ttu-id="af48c-133">Tyto čtyři stránky by měly mít v tomto okamžiku dva ovládací prvky obsahu, jednu pro každou z prvků ContentPlaceHolder: `MainContent` a `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="af48c-133">These four pages should, at this point, have two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample1.aspx)]

<span data-ttu-id="af48c-134">Pro tyto stránky chceme pro `LoginContent` ContentPlaceHolder zobrazit výchozí označení stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="af48c-134">We want to show the master page's default markup for the `LoginContent` ContentPlaceHolder for these pages.</span></span> <span data-ttu-id="af48c-135">Proto odeberte deklarativní označení pro ovládací prvek obsahu `Content2`.</span><span class="sxs-lookup"><span data-stu-id="af48c-135">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="af48c-136">Až to uděláte, značky Pages by měly obsahovat jenom jeden ovládací prvek obsahu.</span><span class="sxs-lookup"><span data-stu-id="af48c-136">After doing so, the pages' markup should contain just one Content control.</span></span>

<span data-ttu-id="af48c-137">Stránky ASP.NET ve složce `Administration` jsou určeny výhradně pro uživatele s právy pro správu.</span><span class="sxs-lookup"><span data-stu-id="af48c-137">The ASP.NET pages in the `Administration` folder are intended solely for administrative users.</span></span> <span data-ttu-id="af48c-138">Do systému jsme přidali roli správců v <a id="_msoanchor_2"> </a>kurzu [*vytváření a Správa rolí*](../roles/creating-and-managing-roles-vb.md) ; omezí přístup na tyto dvě stránky na tuto roli.</span><span class="sxs-lookup"><span data-stu-id="af48c-138">We added an Administrators role to the system in the <a id="_msoanchor_2"></a>[*Creating and Managing Roles*](../roles/creating-and-managing-roles-vb.md) tutorial; restrict access to these two pages to this role.</span></span> <span data-ttu-id="af48c-139">Chcete-li toho dosáhnout, přidejte `Web.config` souboru do složky `Administration` a nakonfigurujte jeho element `<authorization>`, aby bylo možné připustit uživatele v roli správců a Odepřít všechny ostatní.</span><span class="sxs-lookup"><span data-stu-id="af48c-139">To accomplish this, add a `Web.config` file to the `Administration` folder and configure its `<authorization>` element to admit users in the Administrators role and to deny all others.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample2.xml)]

<span data-ttu-id="af48c-140">V tomto okamžiku by Průzkumník řešení projektu vypadala podobně jako snímek obrazovky, který ukazuje obrázek 1.</span><span class="sxs-lookup"><span data-stu-id="af48c-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>

<span data-ttu-id="af48c-141">[na web se přidaly ![čtyři nové stránky a soubor Web. config.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-141">[![Four New Pages and a Web.config File Have Been Added to the Website](building-an-interface-to-select-one-user-account-from-many-vb/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image1.png)</span></span>

<span data-ttu-id="af48c-142">**Obrázek 1**: na web se přidaly čtyři nové stránky a `Web.config` soubor ([kliknutím zobrazíte obrázek v plné velikosti).](building-an-interface-to-select-one-user-account-from-many-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-142">**Figure 1**: Four New Pages and a `Web.config` File Have Been Added to the Website ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image3.png))</span></span>

<span data-ttu-id="af48c-143">Nakonec aktualizujte mapu webu (`Web.sitemap`) tak, aby obsahovala položku pro `ManageUsers.aspx` stránku.</span><span class="sxs-lookup"><span data-stu-id="af48c-143">Finally, update the site map (`Web.sitemap`) to include an entry to the `ManageUsers.aspx` page.</span></span> <span data-ttu-id="af48c-144">Po `<siteMapNode>`, kterou jsme přidali pro kurzy rolí, přidejte následující kód XML.</span><span class="sxs-lookup"><span data-stu-id="af48c-144">Add the following XML after the `<siteMapNode>` we added for the Roles tutorials.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample3.xml)]

<span data-ttu-id="af48c-145">Po aktualizaci mapy webu navštivte web prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="af48c-145">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="af48c-146">Jak ukazuje obrázek 2, navigace na levé straně teď obsahuje položky pro kurzy pro správu.</span><span class="sxs-lookup"><span data-stu-id="af48c-146">As Figure 2 shows, the navigation on the left now includes items for the Administration tutorials.</span></span>

<span data-ttu-id="af48c-147">[![mapa webu zahrnuje uzel s názvem Správa uživatelů](building-an-interface-to-select-one-user-account-from-many-vb/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-147">[![The Site Map Includes a Node Titled User Administration](building-an-interface-to-select-one-user-account-from-many-vb/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image4.png)</span></span>

<span data-ttu-id="af48c-148">**Obrázek 2**: Mapa webu obsahuje uzel s názvem Správa uživatele ([kliknutím zobrazíte obrázek v plné velikosti).](building-an-interface-to-select-one-user-account-from-many-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-148">**Figure 2**: The Site Map Includes a Node Titled User Administration ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image6.png))</span></span>

## <a name="step-2-listing-all-user-accounts-in-a-gridview"></a><span data-ttu-id="af48c-149">Krok 2: výpis všech uživatelských účtů v prvku GridView</span><span class="sxs-lookup"><span data-stu-id="af48c-149">Step 2: Listing All User Accounts in a GridView</span></span>

<span data-ttu-id="af48c-150">Naším koncovým cílem tohoto kurzu je vytvořit stránku, kterou lze filtrovat, pomocí které může správce vybrat uživatelský účet, který chcete spravovat.</span><span class="sxs-lookup"><span data-stu-id="af48c-150">Our end goal for this tutorial is to create a paged, filterable grid through which an administrator can select a user account to manage.</span></span> <span data-ttu-id="af48c-151">Pojďme začít výpisem *všech* uživatelů v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="af48c-151">Let's start by listing *all* users in a GridView.</span></span> <span data-ttu-id="af48c-152">Až to bude hotové, přidáme rozhraní a funkce pro filtrování a stránkování.</span><span class="sxs-lookup"><span data-stu-id="af48c-152">Once this is complete, we will add the filtering and paging interfaces and functionality.</span></span>

<span data-ttu-id="af48c-153">Otevřete stránku `ManageUsers.aspx` ve složce `Administration` a přidejte prvek GridView, nastavením jeho `ID` na `UserAccounts` za chvíli napíšeme kód pro svázání sady uživatelských účtů k prvku GridView pomocí `Membership` metody třídy `GetAllUsers`.</span><span class="sxs-lookup"><span data-stu-id="af48c-153">Open the `ManageUsers.aspx` page in the `Administration` folder and add a GridView, setting its `ID` to `UserAccounts` In a moment, we will write code to bind the set of user accounts to the GridView using the `Membership` class's `GetAllUsers` method.</span></span> <span data-ttu-id="af48c-154">Jak je popsáno v předchozích kurzech, metoda `GetAllUsers` vrátí objekt `MembershipUserCollection`, který je kolekcí objektů `MembershipUser`.</span><span class="sxs-lookup"><span data-stu-id="af48c-154">As discussed in earlier tutorials, the `GetAllUsers` method returns a `MembershipUserCollection` object, which is a collection of `MembershipUser` objects.</span></span> <span data-ttu-id="af48c-155">Každý `MembershipUser` v kolekci obsahuje vlastnosti, jako jsou `UserName`, `Email`, `IsApproved`a tak dále.</span><span class="sxs-lookup"><span data-stu-id="af48c-155">Each `MembershipUser` in the collection includes properties like `UserName`, `Email`, `IsApproved`, and so on.</span></span>

<span data-ttu-id="af48c-156">Chcete-li zobrazit informace o požadovaném uživatelském účtu v prvku GridView, nastavte vlastnost `AutoGenerateColumns` prvku GridView na hodnotu false a přidejte BoundFields pro `UserName`, `Email`a vlastnosti `Comment` a CheckBoxFields pro vlastnosti `IsApproved`, `IsLockedOut`a `IsOnline`.</span><span class="sxs-lookup"><span data-stu-id="af48c-156">In order to display the desired user account information in the GridView, set the GridView's `AutoGenerateColumns` property to False and add BoundFields for the `UserName`, `Email`, and `Comment` properties and CheckBoxFields for the `IsApproved`, `IsLockedOut`, and `IsOnline` properties.</span></span> <span data-ttu-id="af48c-157">Tuto konfiguraci lze použít prostřednictvím deklarativního kódu ovládacího prvku nebo pomocí dialogového okna pole.</span><span class="sxs-lookup"><span data-stu-id="af48c-157">This configuration can be applied through the control's declarative markup or via the Fields dialog box.</span></span> <span data-ttu-id="af48c-158">Obrázek 3 ukazuje snímek obrazovky dialogového okna pole po zrušení zaškrtnutí políčka automaticky generovat pole a přidání a nakonfigurování BoundFields a CheckBoxFields.</span><span class="sxs-lookup"><span data-stu-id="af48c-158">Figure 3 shows a screen shot of the Fields dialog box after the Auto-generate fields checkbox has been unchecked and the BoundFields and CheckBoxFields have been added and configured.</span></span>

<span data-ttu-id="af48c-159">[do prvku GridView ![přidat tři BoundFields a tři CheckBoxFields.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-159">[![Add Three BoundFields and Three CheckBoxFields to the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image7.png)</span></span>

<span data-ttu-id="af48c-160">**Obrázek 3**: přidejte do prvku GridView tři BoundFields a tři CheckBoxFields ([kliknutím zobrazíte obrázek v plné velikosti).](building-an-interface-to-select-one-user-account-from-many-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-160">**Figure 3**: Add Three BoundFields and Three CheckBoxFields to the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image9.png))</span></span>

<span data-ttu-id="af48c-161">Po nakonfigurování prvku GridView se ujistěte, že jeho deklarativní označení vypadá takto:</span><span class="sxs-lookup"><span data-stu-id="af48c-161">After configuring your GridView, ensure that its declarative markup resembles the following:</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample4.aspx)]

<span data-ttu-id="af48c-162">Dále je potřeba napsat kód, který váže uživatelské účty k prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="af48c-162">Next, we need to write code that binds the user accounts to the GridView.</span></span> <span data-ttu-id="af48c-163">Vytvořte metodu s názvem `BindUserAccounts` k provedení této úlohy a pak ji zavolejte z obslužné rutiny události `Page_Load` na první stránce.</span><span class="sxs-lookup"><span data-stu-id="af48c-163">Create a method named `BindUserAccounts` to perform this task and then call it from the `Page_Load` event handler on the first page visit.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample5.vb)]

<span data-ttu-id="af48c-164">Chvíli počkejte, než otestujete stránku pomocí prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="af48c-164">Take a moment to test the page through a browser.</span></span> <span data-ttu-id="af48c-165">Jak ukazuje obrázek 4, `UserAccounts` GridView zobrazuje uživatelské jméno, e-mailovou adresu a další informace o relevantním účtu pro všechny uživatele v systému.</span><span class="sxs-lookup"><span data-stu-id="af48c-165">As Figure 4 shows, the `UserAccounts` GridView lists the username, email address, and other pertinent account information for all users in the system.</span></span>

<span data-ttu-id="af48c-166">[![jsou uživatelské účty uvedeny v prvku GridView.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-166">[![The User Accounts are Listed in the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image10.png)</span></span>

<span data-ttu-id="af48c-167">**Obrázek 4**: uživatelské účty jsou uvedeny v prvku GridView ([kliknutím zobrazíte obrázek v plné velikosti](building-an-interface-to-select-one-user-account-from-many-vb/_static/image12.png)).</span><span class="sxs-lookup"><span data-stu-id="af48c-167">**Figure 4**: The User Accounts are Listed in the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image12.png))</span></span>

## <a name="step-3-filtering-the-results-by-the-first-letter-of-the-username"></a><span data-ttu-id="af48c-168">Krok 3: filtrování výsledků podle prvního písmene uživatelského jména</span><span class="sxs-lookup"><span data-stu-id="af48c-168">Step 3: Filtering the Results by the First Letter of the Username</span></span>

<span data-ttu-id="af48c-169">V současné době `UserAccounts` GridView zobrazuje *všechny* uživatelské účty.</span><span class="sxs-lookup"><span data-stu-id="af48c-169">Currently the `UserAccounts` GridView shows *all* of the user accounts.</span></span> <span data-ttu-id="af48c-170">Pro weby se stovkami nebo tisíci uživatelských účtů je nezbytné, aby uživatel mohl rychle zredukovali zobrazené účty.</span><span class="sxs-lookup"><span data-stu-id="af48c-170">For websites with hundreds or thousands of user accounts, it is imperative that user be able to quickly pare down the displayed accounts.</span></span> <span data-ttu-id="af48c-171">To lze provést přidáním filtru LinkButtons na stránku.</span><span class="sxs-lookup"><span data-stu-id="af48c-171">This can be accomplished by adding filtering LinkButtons to the page.</span></span> <span data-ttu-id="af48c-172">Přidejte na stránku 27 LinkButtons: jeden s názvem vše společně s jedním LinkButton pro každé písmeno abecedy.</span><span class="sxs-lookup"><span data-stu-id="af48c-172">Let's add 27 LinkButtons to the page: one titled All along with one LinkButton for each letter of the alphabet.</span></span> <span data-ttu-id="af48c-173">Pokud návštěvník klikne na vše, zobrazí se v prvku GridView všechny uživatele.</span><span class="sxs-lookup"><span data-stu-id="af48c-173">If a visitor clicks the All LinkButton, the GridView will show all of the users.</span></span> <span data-ttu-id="af48c-174">Pokud kliknete na konkrétní písmeno, zobrazí se jenom uživatelé, jejichž uživatelské jméno začíná s vybraným písmenem.</span><span class="sxs-lookup"><span data-stu-id="af48c-174">If they click a particular letter, only those users whose username starts with the selected letter will be displayed.</span></span>

<span data-ttu-id="af48c-175">Naším prvním úkolem je přidat do 27 ovládací prvky LinkButton.</span><span class="sxs-lookup"><span data-stu-id="af48c-175">Our first task is to add the 27 LinkButton controls.</span></span> <span data-ttu-id="af48c-176">Jednou z možností je vytvořit 27 LinkButtons deklarativně, jeden po druhém.</span><span class="sxs-lookup"><span data-stu-id="af48c-176">One option would be to create the 27 LinkButtons declaratively, one at a time.</span></span> <span data-ttu-id="af48c-177">Pružnější přístup je použití ovládacího prvku Repeater s `ItemTemplate`, který vykresluje LinkButton a následně váže možnosti filtrování na Repeater jako `String` pole.</span><span class="sxs-lookup"><span data-stu-id="af48c-177">A more flexible approach is to use a Repeater control with an `ItemTemplate` that renders a LinkButton and then binds the filtering options to the Repeater as a `String` array.</span></span>

<span data-ttu-id="af48c-178">Začněte přidáním ovládacího prvku Repeater na stránku nad `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="af48c-178">Start by adding a Repeater control to the page above the `UserAccounts` GridView.</span></span> <span data-ttu-id="af48c-179">Nastavte vlastnost Repeater `ID` na `FilteringUI` nakonfigurujte šablony opakování tak, aby jeho `ItemTemplate` vykreslí LinkButton, jehož `Text` a `CommandName` vlastnosti jsou svázány s aktuálním elementem pole.</span><span class="sxs-lookup"><span data-stu-id="af48c-179">Set the Repeater's `ID` property to `FilteringUI` Configure the Repeater's templates so that its `ItemTemplate` renders a LinkButton whose `Text` and `CommandName` properties are bound to the current array element.</span></span> <span data-ttu-id="af48c-180">Jak jsme viděli v <a id="_msoanchor_3"> </a>kurzu [*přiřazování rolí uživatelům*](../roles/assigning-roles-to-users-vb.md) , můžete to udělat pomocí `Container.DataItem` syntaxe datové vazby.</span><span class="sxs-lookup"><span data-stu-id="af48c-180">As we saw in the <a id="_msoanchor_3"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-vb.md) tutorial, this can be accomplished using the `Container.DataItem` databinding syntax.</span></span> <span data-ttu-id="af48c-181">K zobrazení svislé čáry mezi jednotlivými odkazy použijte `SeparatorTemplate` Repeater.</span><span class="sxs-lookup"><span data-stu-id="af48c-181">Use the Repeater's `SeparatorTemplate` to display a vertical line between each link.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample6.aspx)]

<span data-ttu-id="af48c-182">K naplnění tohoto opakovače pomocí požadovaných možností filtrování vytvořte metodu s názvem `BindFilteringUI`.</span><span class="sxs-lookup"><span data-stu-id="af48c-182">To populate this Repeater with the desired filtering options, create a method named `BindFilteringUI`.</span></span> <span data-ttu-id="af48c-183">Nezapomeňte zavolat tuto metodu z obslužné rutiny události `Page_Load` při prvním načtení stránky.</span><span class="sxs-lookup"><span data-stu-id="af48c-183">Be sure to call this method from the `Page_Load` event handler on the first page load.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample7.vb)]

<span data-ttu-id="af48c-184">Tato metoda určuje možnosti filtrování jako prvky v `String` pole `filterOptions` pro každý prvek v poli, Repeat vykreslí objekt LinkButton s jeho `Text` a `CommandName` vlastností přiřazených k hodnotě elementu pole.</span><span class="sxs-lookup"><span data-stu-id="af48c-184">This method specifies the filtering options as elements in the `String` array `filterOptions` For each element in the array, the Repeater will render a LinkButton with its `Text` and `CommandName` properties assigned to the value of the array element.</span></span>

<span data-ttu-id="af48c-185">Obrázek 5 zobrazuje stránku `ManageUsers.aspx` při prohlížení v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="af48c-185">Figure 5 shows the `ManageUsers.aspx` page when viewed through a browser.</span></span>

<span data-ttu-id="af48c-186">[![Repeater uvádí 27 filtrovacích LinkButtonů](building-an-interface-to-select-one-user-account-from-many-vb/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-186">[![The Repeater Lists 27 Filtering LinkButtons](building-an-interface-to-select-one-user-account-from-many-vb/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image13.png)</span></span>

<span data-ttu-id="af48c-187">**Obrázek 5**: Repeater obsahuje 27 filtrů LinkButtons ([kliknutím zobrazíte obrázek v plné velikosti](building-an-interface-to-select-one-user-account-from-many-vb/_static/image15.png)).</span><span class="sxs-lookup"><span data-stu-id="af48c-187">**Figure 5**: The Repeater Lists 27 Filtering LinkButtons ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image15.png))</span></span>

> [!NOTE]
> <span data-ttu-id="af48c-188">Uživatelská jména mohou začínat libovolným znakem, včetně čísel a interpunkce.</span><span class="sxs-lookup"><span data-stu-id="af48c-188">Usernames may start with any character, including numbers and punctuation.</span></span> <span data-ttu-id="af48c-189">Aby bylo možné zobrazit tyto účty, bude muset správce použít možnost všechny možnosti LinkButton.</span><span class="sxs-lookup"><span data-stu-id="af48c-189">In order to view these accounts, the administrator will have to use the All LinkButton option.</span></span> <span data-ttu-id="af48c-190">Alternativně můžete přidat LinkButton, který vrátí všechny uživatelské účty, které začínají číslem.</span><span class="sxs-lookup"><span data-stu-id="af48c-190">Alternatively, you could add a LinkButton to return all user accounts that start with a number.</span></span> <span data-ttu-id="af48c-191">Tuto funkci mám jako cvičení pro čtenáře.</span><span class="sxs-lookup"><span data-stu-id="af48c-191">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="af48c-192">Kliknutím na některý z filtrovacích LinkButtonů dojde k postbacku a dojde k vyvolání události `ItemCommand` opakování, ale v mřížce se nezměnila, protože ještě jsme napsali kód pro filtrování výsledků.</span><span class="sxs-lookup"><span data-stu-id="af48c-192">Clicking any of the filtering LinkButtons causes a postback and raises the Repeater's `ItemCommand` event, but there's no change in the grid because we've yet to write any code to filter the results.</span></span> <span data-ttu-id="af48c-193">Třída `Membership` obsahuje [metodu`FindUsersByName`](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) , která vrací tyto uživatelské účty, jejichž uživatelské jméno odpovídá zadanému vyhledávacímu vzoru.</span><span class="sxs-lookup"><span data-stu-id="af48c-193">The `Membership` class includes a [`FindUsersByName` method](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) that returns those user accounts whose username matches a specified search pattern.</span></span> <span data-ttu-id="af48c-194">Tuto metodu můžeme použít k načtení pouze těch uživatelských účtů, jejichž uživatelské jméno začíná písmenem určeným `CommandName` filtrovaného typu LinkButton, na který jste klikli.</span><span class="sxs-lookup"><span data-stu-id="af48c-194">We can use this method to retrieve just those user accounts whose usernames start with the letter specified by the `CommandName` of the filtered LinkButton that was clicked.</span></span>

<span data-ttu-id="af48c-195">Začněte aktualizací třídy kódu na pozadí `ManageUser.aspx` stránky tak, aby obsahovala vlastnost s názvem `UsernameToMatch` Tato vlastnost uchovává řetězec filtru uživatelského jména napříč zpětnými odesláními:</span><span class="sxs-lookup"><span data-stu-id="af48c-195">Start by updating the `ManageUser.aspx` page's code-behind class so that it includes a property named `UsernameToMatch` This property persists the username filter string across postbacks:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample8.vb)]

<span data-ttu-id="af48c-196">Vlastnost `UsernameToMatch` ukládá její hodnotu, která je přiřazena do kolekce `ViewState` pomocí Key UsernameToMatch.</span><span class="sxs-lookup"><span data-stu-id="af48c-196">The `UsernameToMatch` property stores its value it is assigned into the `ViewState` collection using the key �UsernameToMatch�.</span></span> <span data-ttu-id="af48c-197">Je-li hodnota této vlastnosti přečtena, zkontroluje, zda v kolekci `ViewState` existuje hodnota; Pokud ne, vrátí výchozí hodnotu prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="af48c-197">When this property's value is read, it checks to see if a value exists in the `ViewState` collection; if not, it returns the default value, an empty string.</span></span> <span data-ttu-id="af48c-198">Vlastnost `UsernameToMatch` vykazuje společný vzor, což znamená zachování hodnoty pro zobrazení stavu, aby všechny změny vlastnosti byly trvale v rámci zpětného odeslání.</span><span class="sxs-lookup"><span data-stu-id="af48c-198">The `UsernameToMatch` property exhibits a common pattern, namely persisting a value to view state so that any changes to the property are persisted across postbacks.</span></span> <span data-ttu-id="af48c-199">Další informace o tomto modelu najdete v tématu [Principy stavu zobrazení ASP.NET](https://msdn.microsoftn-us/library/ms972976.aspx).</span><span class="sxs-lookup"><span data-stu-id="af48c-199">For more information on this pattern, read [Understanding ASP.NET View State](https://msdn.microsoftn-us/library/ms972976.aspx).</span></span>

<span data-ttu-id="af48c-200">Dále aktualizujte metodu `BindUserAccounts` tak, aby místo volání `Membership.GetAllUsers`volala `Membership.FindUsersByName`předávala hodnotu `UsernameToMatch`, která je připojena se zástupným znakem SQL,%.</span><span class="sxs-lookup"><span data-stu-id="af48c-200">Next, update the `BindUserAccounts` method so that instead of calling `Membership.GetAllUsers`, it calls `Membership.FindUsersByName`, passing in the value of the `UsernameToMatch` property appended with the SQL wildcard character, %.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample9.vb)]

<span data-ttu-id="af48c-201">Chcete-li zobrazit pouze ty uživatele, jejichž uživatelské jméno začíná písmenem A, nastavte vlastnost `UsernameToMatch` na hodnotu a poté volání `BindUserAccounts`. výsledkem bude volání `Membership.FindUsersByName("A%")`, které vrátí všechny uživatele, jejichž uživatelské jméno začíná na. stejně tak, *aby vrátilo* všechny uživatele `UsernameToMatch`, aby metoda `BindUserAccounts` vyvolala `Membership.FindUsersByName("%")`, což vrátí všechny uživatelské účty.</span><span class="sxs-lookup"><span data-stu-id="af48c-201">To display just those users whose username starts with the letter A, set the `UsernameToMatch` property to A and then call `BindUserAccounts` This would result in a call to `Membership.FindUsersByName("A%")`, which will return all users whose username starts with A. Likewise, to return *all* users, assign an empty string to the `UsernameToMatch` property so that the `BindUserAccounts` method will invoke `Membership.FindUsersByName("%")`, thereby returning all user accounts.</span></span>

<span data-ttu-id="af48c-202">Vytvořte obslužnou rutinu události pro událost `ItemCommand` opakovače.</span><span class="sxs-lookup"><span data-stu-id="af48c-202">Create an event handler for the Repeater's `ItemCommand` event.</span></span> <span data-ttu-id="af48c-203">Tato událost se vyvolá vždy, když se klikne na jeden z filtrů LinkButtons; přechází se na `CommandName` hodnotu prvku LinkButton prostřednictvím objektu `RepeaterCommandEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="af48c-203">This event is raised whenever one of the filter LinkButtons is clicked; it is passed the clicked LinkButton's `CommandName` value through the `RepeaterCommandEventArgs` object.</span></span> <span data-ttu-id="af48c-204">Je potřeba přiřadit k vlastnosti `UsernameToMatch` příslušnou hodnotu a pak zavolat metodu `BindUserAccounts`.</span><span class="sxs-lookup"><span data-stu-id="af48c-204">We need to assign the appropriate value to the `UsernameToMatch` property and then call the `BindUserAccounts` method.</span></span> <span data-ttu-id="af48c-205">Pokud je `CommandName` vše, přiřaďte k `UsernameToMatch` prázdný řetězec, aby se zobrazily všechny uživatelské účty.</span><span class="sxs-lookup"><span data-stu-id="af48c-205">If the `CommandName` is All, assign an empty string to `UsernameToMatch` so that all user accounts are displayed.</span></span> <span data-ttu-id="af48c-206">V opačném případě přiřaďte hodnotu `CommandName` `UsernameToMatch`</span><span class="sxs-lookup"><span data-stu-id="af48c-206">Otherwise, assign the `CommandName` value to `UsernameToMatch`</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample10.vb)]

<span data-ttu-id="af48c-207">Když je tento kód na místě, otestujte funkce filtrování.</span><span class="sxs-lookup"><span data-stu-id="af48c-207">With this code in place, test out the filtering functionality.</span></span> <span data-ttu-id="af48c-208">Při prvním navštívení stránky se zobrazí všechny uživatelské účty (viz obrázek 5).</span><span class="sxs-lookup"><span data-stu-id="af48c-208">When the page is first visited, all user accounts are displayed (refer back to Figure 5).</span></span> <span data-ttu-id="af48c-209">Kliknutím na prvek LinkButton dojde k zpětnému odeslání a filtrování výsledků, zobrazení pouze těch uživatelských účtů, které začínají na.</span><span class="sxs-lookup"><span data-stu-id="af48c-209">Clicking the A LinkButton causes a postback and filters the results, displaying only those user accounts that start with A .</span></span>

<span data-ttu-id="af48c-210">[![použít filtr LinkButtons k zobrazení uživatelů, jejichž uživatelské jméno začíná určitým písmenem](building-an-interface-to-select-one-user-account-from-many-vb/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-210">[![Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter](building-an-interface-to-select-one-user-account-from-many-vb/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image16.png)</span></span>

<span data-ttu-id="af48c-211">**Obrázek 6**: pomocí filtrování LinkButtons zobrazíte uživatele, jejichž uživatelské jméno začíná určitým písmenem ([kliknutím zobrazíte obrázek v plné velikosti).](building-an-interface-to-select-one-user-account-from-many-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-211">**Figure 6**: Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image18.png))</span></span>

## <a name="step-4-updating-the-gridview-to-use-paging"></a><span data-ttu-id="af48c-212">Krok 4: aktualizace prvku GridView na použití stránkování</span><span class="sxs-lookup"><span data-stu-id="af48c-212">Step 4: Updating the GridView to Use Paging</span></span>

<span data-ttu-id="af48c-213">Prvek GridView zobrazený na obrázcích 5 a 6 zobrazí seznam všech záznamů vrácených z metody `FindUsersByName`.</span><span class="sxs-lookup"><span data-stu-id="af48c-213">The GridView shown in Figures 5 and 6 lists all of the records returned from the `FindUsersByName` method.</span></span> <span data-ttu-id="af48c-214">Pokud máte stovky nebo tisíce uživatelských účtů, může to vést k přetížení informací při zobrazení všech účtů (stejně jako případ při kliknutí na vše na webu nebo při počáteční návštěvě stránky).</span><span class="sxs-lookup"><span data-stu-id="af48c-214">If there are hundreds or thousands of user accounts this can lead to information overload when viewing all of the accounts (as is the case when clicking the All LinkButton or when initially visiting the page).</span></span> <span data-ttu-id="af48c-215">Chcete-li zobrazit uživatelské účty ve více spravovatelných blocích, nakonfigurujeme prvek GridView tak, aby zobrazoval 10 uživatelských účtů najednou.</span><span class="sxs-lookup"><span data-stu-id="af48c-215">To help present the user accounts in more manageable chunks, let's configure the GridView to display 10 user accounts at a time.</span></span>

<span data-ttu-id="af48c-216">Ovládací prvek GridView nabízí dva typy stránkování:</span><span class="sxs-lookup"><span data-stu-id="af48c-216">The GridView control offers two types of paging:</span></span>

- <span data-ttu-id="af48c-217">**Výchozí stránkování** – snadno se implementuje, ale neefektivně.</span><span class="sxs-lookup"><span data-stu-id="af48c-217">**Default paging** - easy to implement, but inefficient.</span></span> <span data-ttu-id="af48c-218">V kostce s výchozím stránkováním ovládací prvek GridView očekává *všechny* záznamy z jejího zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="af48c-218">In a nutshell, with default paging the GridView expects *all* of the records from its data source.</span></span> <span data-ttu-id="af48c-219">Pak zobrazí jenom odpovídající stránku záznamů.</span><span class="sxs-lookup"><span data-stu-id="af48c-219">It then only displays the appropriate page of records.</span></span>
- <span data-ttu-id="af48c-220">**Vlastní stránkování** – vyžaduje implementaci více práce, ale je efektivnější než výchozí stránkování, protože s vlastním stránkováním vrátí zdroj dat pouze přesnou sadu záznamů, které se mají zobrazit.</span><span class="sxs-lookup"><span data-stu-id="af48c-220">**Custom paging** - requires more work to implement, but is more efficient than default paging because with custom paging the data source returns only the precise set of records to display.</span></span>

<span data-ttu-id="af48c-221">Rozdíl mezi výchozím a vlastním stránkováním může být po stránkování v tisících záznamů poměrně podstatný.</span><span class="sxs-lookup"><span data-stu-id="af48c-221">The performance difference between default and custom paging can be quite substantial when paging through thousands of records.</span></span> <span data-ttu-id="af48c-222">Vzhledem k tomu, že toto rozhraní sestavíme za předpokladu, že se může jednat o stovky nebo tisíce uživatelských účtů, použijte vlastní stránkování.</span><span class="sxs-lookup"><span data-stu-id="af48c-222">Because we are building this interface assuming that there may be hundreds or thousands of user accounts, let's use custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="af48c-223">Podrobnější diskuzi o rozdílech mezi výchozím a vlastním stránkováním a také s problémy, které se týkají implementace vlastního stránkování, najdete v tématu [efektivní stránkování prostřednictvím velkých objemů dat](https://asp.net/learn/data-access/tutorial-25-vb.aspx).</span><span class="sxs-lookup"><span data-stu-id="af48c-223">For a more thorough discussion on the differences between default and custom paging, as well as the challenges involved in implementing custom paging, refer to [Efficiently Paging Through Large Amounts of Data](https://asp.net/learn/data-access/tutorial-25-vb.aspx).</span></span> <span data-ttu-id="af48c-224">Analýzu rozdílu výkonu mezi výchozími a vlastními stránkováními najdete v tématu [vlastní stránkování v ASP.NET s SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="af48c-224">For some analysis of the performance difference between default and custom paging, see [Custom Paging in ASP.NET with SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span></span>

<span data-ttu-id="af48c-225">K implementaci vlastního stránkování musíme nejdřív potřebovat nějaký mechanismus, pomocí kterého načtete přesnou podmnožinu záznamů, které se zobrazí v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="af48c-225">To implement custom paging we first need some mechanism by which to retrieve the precise subset of records being displayed by the GridView.</span></span> <span data-ttu-id="af48c-226">Dobrá zpráva je, že metoda `FindUsersByName` třídy `Membership` má přetížení, které nám umožňuje určit index stránky a velikost stránky a vrátí pouze takové uživatelské účty, které spadají do daného rozsahu záznamů.</span><span class="sxs-lookup"><span data-stu-id="af48c-226">The good news is that the `Membership` class's `FindUsersByName` method has an overload that allows us to specify the page index and page size, and returns only those user accounts that fall within that range of records.</span></span>

<span data-ttu-id="af48c-227">Konkrétně toto přetížení má následující signaturu: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span><span class="sxs-lookup"><span data-stu-id="af48c-227">In particular, this overload has the following signature: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span></span>

<span data-ttu-id="af48c-228">Parametr *pageIndex* Určuje stránku uživatelských účtů, které se mají vrátit. *PageSize* označuje počet záznamů, které se mají zobrazit na stránce.</span><span class="sxs-lookup"><span data-stu-id="af48c-228">The *pageIndex* parameter specifies the page of user accounts to return; *pageSize* indicates how many records to display per page.</span></span> <span data-ttu-id="af48c-229">Parametr *totalRecords* je parametr `ByRef`, který vrací celkový počet uživatelských účtů v úložišti uživatele.</span><span class="sxs-lookup"><span data-stu-id="af48c-229">The *totalRecords* parameter is a `ByRef` parameter that returns the number of total user accounts in the user store.</span></span>

> [!NOTE]
> <span data-ttu-id="af48c-230">Data vrácená `FindUsersByName` jsou seřazená podle uživatelského jména; kritéria řazení nelze přizpůsobit.</span><span class="sxs-lookup"><span data-stu-id="af48c-230">The data returned by `FindUsersByName` is sorted by username; the sort criteria cannot be customized.</span></span>

<span data-ttu-id="af48c-231">Prvek GridView lze nakonfigurovat tak, aby využíval vlastní stránkování, ale pouze v případě, že je svázán s ovládacím prvkem ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="af48c-231">The GridView can be configured to utilize custom paging, but only when bound to an ObjectDataSource control.</span></span> <span data-ttu-id="af48c-232">Pro ovládací prvek ObjectDataSource pro implementaci vlastního stránkování vyžaduje dvě metody: jeden, který je předán indexu počátečního řádku, a maximální počet zobrazených záznamů a vrací přesné podmnožiny záznamů, které spadají do daného rozsahu. a metodu, která vrátí celkový počet záznamů, které jsou stránkou.</span><span class="sxs-lookup"><span data-stu-id="af48c-232">For the ObjectDataSource control to implement custom paging, it requires two methods: one that is passed a start row index and the maximum number of records to display, and returns the precise subset of records that fall within that span; and a method that returns the total number of records being paged through.</span></span> <span data-ttu-id="af48c-233">Přetížení `FindUsersByName` akceptuje index stránky a velikost stránky a vrátí celkový počet záznamů prostřednictvím parametru `ByRef`.</span><span class="sxs-lookup"><span data-stu-id="af48c-233">The `FindUsersByName` overload accepts a page index and page size, and returns the total number of records through a `ByRef` parameter.</span></span> <span data-ttu-id="af48c-234">A tady je neshoda rozhraní.</span><span class="sxs-lookup"><span data-stu-id="af48c-234">So there is an interface mismatch here.</span></span>

<span data-ttu-id="af48c-235">Jednou z možností je vytvořit třídu proxy, která zpřístupňuje rozhraní, které prvek ObjectDataSource očekává, a poté interně zavolá metodu `FindUsersByName`.</span><span class="sxs-lookup"><span data-stu-id="af48c-235">One option would be to create a proxy class that exposes the interface the ObjectDataSource expects, and then internally calls the `FindUsersByName` method.</span></span> <span data-ttu-id="af48c-236">Další možnost – a ta, kterou budeme používat pro tento článek, je vytvořit vlastní rozhraní stránkování a použít ho místo předdefinovaného rozhraní stránkování prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="af48c-236">Another option - and the one we'll use for this article - is to create our own paging interface and use that instead of the GridView's built-in paging interface.</span></span>

### <a name="creating-a-first-previous-next-last-paging-interface"></a><span data-ttu-id="af48c-237">Vytvoření prvního, předchozího, následujícího, posledního stránkovacího rozhraní</span><span class="sxs-lookup"><span data-stu-id="af48c-237">Creating a First, Previous, Next, Last Paging Interface</span></span>

<span data-ttu-id="af48c-238">Pojďme sestavit rozhraní stránkování s prvními, předchozími, dalšími a posledními LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="af48c-238">Let's build a paging interface with First, Previous, Next, and Last LinkButtons.</span></span> <span data-ttu-id="af48c-239">První LinkButton, při kliknutí, převezme uživatele na první stránku dat, zatímco předchozí se vrátí na předchozí stránku.</span><span class="sxs-lookup"><span data-stu-id="af48c-239">The First LinkButton, when clicked, will take the user to the first page of data, whereas Previous will return him to the previous page.</span></span> <span data-ttu-id="af48c-240">Podobně, další a poslední přesune uživatele na další a poslední stránku v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="af48c-240">Likewise, Next and Last will move the user to the next and last page, respectively.</span></span> <span data-ttu-id="af48c-241">Přidejte čtyři ovládací prvky LinkButton pod `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="af48c-241">Add the four LinkButton controls beneath the `UserAccounts` GridView.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample11.aspx)]

<span data-ttu-id="af48c-242">Dále vytvořte obslužnou rutinu události pro každou z `Click`ch událostí LinkButton.</span><span class="sxs-lookup"><span data-stu-id="af48c-242">Next, create an event handler for each of the LinkButton's `Click` events.</span></span>

<span data-ttu-id="af48c-243">Obrázek 7 zobrazuje čtyři LinkButtony při zobrazení pomocí zobrazení Návrh aplikace Visual Web Developer.</span><span class="sxs-lookup"><span data-stu-id="af48c-243">Figure 7 shows the four LinkButtons when viewed through the Visual Web Developer Design view.</span></span>

<span data-ttu-id="af48c-244">[![přidat první, předchozí, další a poslední LinkButtons pod prvek GridView.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-244">[![Add First, Previous, Next, and Last LinkButtons Beneath the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image19.png)</span></span>

<span data-ttu-id="af48c-245">**Obrázek 7**: Přidání prvního, předchozího, následujícího a posledního prvku LinkButtons pod prvek GridView ([kliknutím zobrazíte obrázek v plné velikosti](building-an-interface-to-select-one-user-account-from-many-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="af48c-245">**Figure 7**: Add First, Previous, Next, and Last LinkButtons Beneath the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image21.png))</span></span>

### <a name="keeping-track-of-the-current-page-index"></a><span data-ttu-id="af48c-246">Udržování přehledu o aktuálním indexu stránky</span><span class="sxs-lookup"><span data-stu-id="af48c-246">Keeping Track of the Current Page Index</span></span>

<span data-ttu-id="af48c-247">Když uživatel poprvé navštíví stránku `ManageUsers.aspx` nebo klikne na jedno z filtrovacích tlačítek, chceme zobrazit první stránku dat v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="af48c-247">When a user first visits the `ManageUsers.aspx` page or clicks one of the filtering buttons, we want to display the first page of data in the GridView.</span></span> <span data-ttu-id="af48c-248">Když však uživatel klikne na jeden z navigačních LinkButtonů, musíme aktualizovat index stránky.</span><span class="sxs-lookup"><span data-stu-id="af48c-248">When the user clicks one of the navigation LinkButtons, however, we need to update the page index.</span></span> <span data-ttu-id="af48c-249">Chcete-li zachovat index stránky a počet záznamů, které se mají zobrazit na stránce, přidejte následující dvě vlastnosti do třídy kódu na pozadí stránky:</span><span class="sxs-lookup"><span data-stu-id="af48c-249">To maintain the page index and the number of records to display per page, add the following two properties to the page's code-behind class:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample12.vb)]

<span data-ttu-id="af48c-250">Podobně jako vlastnost `UsernameToMatch` přechovává vlastnost `PageIndex` svou hodnotu do stavu zobrazení.</span><span class="sxs-lookup"><span data-stu-id="af48c-250">Like the `UsernameToMatch` property, the `PageIndex` property persists its value to view state.</span></span> <span data-ttu-id="af48c-251">Vlastnost `PageSize` jen pro čtení vrací pevně zakódované hodnoty 10.</span><span class="sxs-lookup"><span data-stu-id="af48c-251">The read-only `PageSize` property returns a hard-coded value, 10.</span></span> <span data-ttu-id="af48c-252">Dám pozvánku ke stejnému čtecímu zařízení, aby aktualizovala tuto vlastnost, aby používala stejný vzor jako `PageIndex`, a potom rozstaví `ManageUsers.aspx` stránku tak, aby osoba, která navštívila stránku, mohla určit, kolik uživatelských účtů se má zobrazit na stránce.</span><span class="sxs-lookup"><span data-stu-id="af48c-252">I invite the interested reader to update this property to use the same pattern as `PageIndex`, and then to augment the `ManageUsers.aspx` page such that the person visiting the page can specify how many user accounts to display per page.</span></span>

### <a name="retrieving-just-the-current-pages-records-updating-the-page-index-and-enabling-and-disabling-the-paging-interface-linkbuttons"></a><span data-ttu-id="af48c-253">Načítání pouze záznamů aktuální stránky, aktualizace indexu stránky a povolení a zakázání stránkovacího rozhraní LinkButtons</span><span class="sxs-lookup"><span data-stu-id="af48c-253">Retrieving Just the Current Page's Records, Updating the Page Index, and Enabling and Disabling the Paging Interface LinkButtons</span></span>

<span data-ttu-id="af48c-254">Když je na místě stránkovací rozhraní a přidané vlastnosti `PageIndex` a `PageSize`, je připraveno aktualizovat metodu `BindUserAccounts`, aby používala příslušné `FindUsersByName` přetížení.</span><span class="sxs-lookup"><span data-stu-id="af48c-254">With the paging interface in place and the `PageIndex` and `PageSize` properties added, we are ready to update the `BindUserAccounts` method so that it uses the appropriate `FindUsersByName` overload.</span></span> <span data-ttu-id="af48c-255">Kromě toho musíme tuto metodu povolit nebo zakázat stránkování rozhraní v závislosti na tom, která stránka se zobrazuje.</span><span class="sxs-lookup"><span data-stu-id="af48c-255">Additionally, we need to have this method enable or disable the paging interface depending on what page is being displayed.</span></span> <span data-ttu-id="af48c-256">Při prohlížení první stránky dat by se měla vypnout první a předchozí propojení. Při prohlížení poslední stránky by měla být zakázána další a poslední.</span><span class="sxs-lookup"><span data-stu-id="af48c-256">When viewing the first page of data, the First and Previous links should be disabled; Next and Last should be disabled when viewing the last page.</span></span>

<span data-ttu-id="af48c-257">Aktualizujte `BindUserAccounts` metodu pomocí následujícího kódu:</span><span class="sxs-lookup"><span data-stu-id="af48c-257">Update the `BindUserAccounts` method with the following code:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample13.vb)]

<span data-ttu-id="af48c-258">Všimněte si, že celkový počet záznamů, které jsou stránkou, je určen posledním parametrem metody `FindUsersByName`.</span><span class="sxs-lookup"><span data-stu-id="af48c-258">Note that the total number of records being paged through is determined by the last parameter of the `FindUsersByName` method.</span></span> <span data-ttu-id="af48c-259">Po vrácení zadané stránky uživatelských účtů jsou čtyři LinkButtons buď povoleny, nebo zakázány v závislosti na tom, zda je zobrazena první nebo poslední stránka dat.</span><span class="sxs-lookup"><span data-stu-id="af48c-259">After the specified page of user accounts are returned, the four LinkButtons are either enabled or disabled, depending on whether the first or last page of data is being viewed.</span></span>

<span data-ttu-id="af48c-260">Posledním krokem je napsat kód pro čtyři obslužné rutiny událostí `Click` pro:</span><span class="sxs-lookup"><span data-stu-id="af48c-260">The last step is to write the code for the four LinkButtons' `Click` event handlers.</span></span> <span data-ttu-id="af48c-261">Tyto obslužné rutiny události musí aktualizovat vlastnost `PageIndex` a poté znovu navazovat data na prvek GridView prostřednictvím volání `BindUserAccounts` rutiny první, předchozí a další obslužné rutiny jsou velmi jednoduché.</span><span class="sxs-lookup"><span data-stu-id="af48c-261">These event handlers need to update the `PageIndex` property and then rebind the data to the GridView via a call to `BindUserAccounts` The First, Previous, and Next event handlers are very simple.</span></span> <span data-ttu-id="af48c-262">Obslužná rutina události `Click` pro poslední LinkButton je však trochu složitější, protože potřebujeme určit, kolik záznamů se zobrazuje, aby bylo možné určit poslední index stránky.</span><span class="sxs-lookup"><span data-stu-id="af48c-262">The `Click` event handler for the Last LinkButton, however, is a bit more complex because we need to determine how many records are being displayed in order to determine the last page index.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample14.vb)]

<span data-ttu-id="af48c-263">Obrázky 8 a 9 ukazují vlastní rozhraní stránkování v akci.</span><span class="sxs-lookup"><span data-stu-id="af48c-263">Figures 8 and 9 show the custom paging interface in action.</span></span> <span data-ttu-id="af48c-264">Obrázek 8 ukazuje stránku `ManageUsers.aspx` při prohlížení první stránky dat pro všechny uživatelské účty.</span><span class="sxs-lookup"><span data-stu-id="af48c-264">Figure 8 shows the `ManageUsers.aspx` page when viewing the first page of data for all user accounts.</span></span> <span data-ttu-id="af48c-265">Všimněte si, že se zobrazí pouze 10 účtů 13.</span><span class="sxs-lookup"><span data-stu-id="af48c-265">Note that only 10 of the 13 accounts are displayed.</span></span> <span data-ttu-id="af48c-266">Kliknutím na další nebo poslední odkaz dojde k postbacku, aktualizace `PageIndex` na 1 a naváže druhou stránku uživatelských účtů k mřížce (viz obrázek 9).</span><span class="sxs-lookup"><span data-stu-id="af48c-266">Clicking the Next or Last link causes a postback, updates the `PageIndex` to 1, and binds the second page of user accounts to the grid (see Figure 9).</span></span>

<span data-ttu-id="af48c-267">[![se zobrazí prvních 10 uživatelských účtů.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-267">[![The First 10 User Accounts are Displayed](building-an-interface-to-select-one-user-account-from-many-vb/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image22.png)</span></span>

<span data-ttu-id="af48c-268">**Obrázek 8**: zobrazí se prvních 10 uživatelských účtů ([kliknutím zobrazíte obrázek v plné velikosti](building-an-interface-to-select-one-user-account-from-many-vb/_static/image24.png)).</span><span class="sxs-lookup"><span data-stu-id="af48c-268">**Figure 8**: The First 10 User Accounts are Displayed ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image24.png))</span></span>

<span data-ttu-id="af48c-269">[![kliknutí na další odkaz zobrazí druhou stránku uživatelských účtů.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-269">[![Clicking the Next Link Displays the Second Page of User Accounts](building-an-interface-to-select-one-user-account-from-many-vb/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image25.png)</span></span>

<span data-ttu-id="af48c-270">**Obrázek 9**: kliknutí na další odkaz zobrazí druhou stránku uživatelských účtů ([kliknutím zobrazíte obrázek v plné velikosti).](building-an-interface-to-select-one-user-account-from-many-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="af48c-270">**Figure 9**: Clicking the Next Link Displays the Second Page of User Accounts ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image27.png))</span></span>

## <a name="summary"></a><span data-ttu-id="af48c-271">Souhrn</span><span class="sxs-lookup"><span data-stu-id="af48c-271">Summary</span></span>

<span data-ttu-id="af48c-272">Správci často potřebují vybrat uživatele ze seznamu účtů.</span><span class="sxs-lookup"><span data-stu-id="af48c-272">Administrators often need to select a user from the list of accounts.</span></span> <span data-ttu-id="af48c-273">V předchozích kurzech jsme se podívali na používání rozevíracího seznamu naplněný uživateli, ale tento postup se nedokáže dobře škálovat.</span><span class="sxs-lookup"><span data-stu-id="af48c-273">In previous tutorials we looked at using a drop-down list populated with the users, but this approach does not scale well.</span></span> <span data-ttu-id="af48c-274">V tomto kurzu jsme prozkoumali lepší alternativu: filtrovací rozhraní, jehož výsledky se zobrazují ve stránkovém prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="af48c-274">In this tutorial we explored a better alternative: a filterable interface whose results are displayed in a paged GridView.</span></span> <span data-ttu-id="af48c-275">Pomocí tohoto uživatelského rozhraní můžou správci rychle a efektivně najít a vybrat jeden uživatelský účet mezi tisíci.</span><span class="sxs-lookup"><span data-stu-id="af48c-275">With this user interface, administrators can quickly and efficiently locate and select one user account among thousands.</span></span>

<span data-ttu-id="af48c-276">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="af48c-276">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="af48c-277">Další čtení</span><span class="sxs-lookup"><span data-stu-id="af48c-277">Further Reading</span></span>

<span data-ttu-id="af48c-278">Další informace o tématech popsaných v tomto kurzu najdete v následujících zdrojích informací:</span><span class="sxs-lookup"><span data-stu-id="af48c-278">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="af48c-279">Vlastní stránkování v ASP.NET s SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="af48c-279">Custom Paging in ASP.NET with SQL Server 2005</span></span>](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)
- [<span data-ttu-id="af48c-280">Efektivní stránkování prostřednictvím velkých objemů dat</span><span class="sxs-lookup"><span data-stu-id="af48c-280">Efficiently Paging Through Large Amounts of Data</span></span>](https://asp.net/learn/data-access/tutorial-25-vb.aspx)
- [<span data-ttu-id="af48c-281">Postup při zavedení vlastního nástroje pro správu webu</span><span class="sxs-lookup"><span data-stu-id="af48c-281">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="af48c-282">O autorovi</span><span class="sxs-lookup"><span data-stu-id="af48c-282">About the Author</span></span>

<span data-ttu-id="af48c-283">Scott Mitchell, autor několika stránek ASP/ASP. NET Books a zakladatel of 4GuysFromRolla.com, pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="af48c-283">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="af48c-284">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="af48c-284">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="af48c-285">Nejnovější kniha je *[Sams naučit se ASP.NET 2,0 za 24 hodin](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="af48c-285">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="af48c-286">Scott se dá kontaktovat [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) nebo prostřednictvím svého blogu na [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="af48c-286">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="af48c-287">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="af48c-287">Special Thanks To</span></span>

<span data-ttu-id="af48c-288">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="af48c-288">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="af48c-289">Kontrolor pro tento kurz byl Alicja Maziarz.</span><span class="sxs-lookup"><span data-stu-id="af48c-289">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="af48c-290">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="af48c-290">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="af48c-291">Pokud ano, vyřaďte čáru na</span><span class="sxs-lookup"><span data-stu-id="af48c-291">If so, drop me a line at</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="af48c-292">[Předchozí](unlocking-and-approving-user-accounts-cs.md)
> [Další](recovering-and-changing-passwords-vb.md)</span><span class="sxs-lookup"><span data-stu-id="af48c-292">[Previous](unlocking-and-approving-user-accounts-cs.md)
[Next](recovering-and-changing-passwords-vb.md)</span></span>
