---
uid: web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-cs
title: Ověřování uživatelských přihlašovacích údajů proti uživatelskému úložišti členství (C#) | Microsoft Docs
author: rick-anderson
description: V tomto kurzu podíváme se, jak ověřit přihlašovací údaje uživatele proti úložišti uživatelů členství pomocí programových prostředků a přihlašovacího ovládacího prvku....
ms.author: riande
ms.date: 01/18/2008
ms.assetid: 61aa4e08-aa81-4aeb-8ebe-19ba7a65e04c
msc.legacyurl: /web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-cs
msc.type: authoredcontent
ms.openlocfilehash: fd50f4e63c75cf77eb21629d0c11a859da6b357d
ms.sourcegitcommit: 4e6d586faadbe4d9ef27122f86335ec9385134af
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/28/2020
ms.locfileid: "89045231"
---
# <a name="validating-user-credentials-against-the-membership-user-store-c"></a><span data-ttu-id="b712a-103">Ověření přihlašovacích údajů uživatele v úložišti uživatelů, kteří jsou členy (C#)</span><span class="sxs-lookup"><span data-stu-id="b712a-103">Validating User Credentials Against the Membership User Store (C#)</span></span>

<span data-ttu-id="b712a-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b712a-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b712a-105">[Stažení kódu](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_CS.zip) nebo [stažení PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="b712a-105">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_CS.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_cs.pdf)</span></span>

> <span data-ttu-id="b712a-106">V tomto kurzu podíváme se, jak ověřit přihlašovací údaje uživatele pro uživatelské úložiště členství pomocí programových prostředků a přihlašovacího ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="b712a-106">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="b712a-107">Také se podíváme na to, jak přizpůsobit vzhled a chování ovládacího prvku pro přihlášení.</span><span class="sxs-lookup"><span data-stu-id="b712a-107">We will also look at how to customize the login control's appearance and behavior.</span></span>

## <a name="introduction"></a><span data-ttu-id="b712a-108">Úvod</span><span class="sxs-lookup"><span data-stu-id="b712a-108">Introduction</span></span>

<span data-ttu-id="b712a-109">V <a id="Tutorial05"></a> [předchozím kurzu](creating-user-accounts-cs.md) jsme se podívali na postup vytvoření nového uživatelského účtu v rámci sady členství.</span><span class="sxs-lookup"><span data-stu-id="b712a-109">In the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-cs.md) we looked at how to create a new user account in the Membership framework.</span></span> <span data-ttu-id="b712a-110">Nejdříve jsme prohlédli programově vytváření uživatelských účtů prostřednictvím `Membership` metody třídy `CreateUser` a pak prozkoumali pomocí webového ovládacího prvku ovládacím CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="b712a-110">We first looked at programmatically creating user accounts via the `Membership` class's `CreateUser` method, and then examined using the CreateUserWizard Web control.</span></span> <span data-ttu-id="b712a-111">Přihlašovací stránka teď ale ověřuje zadané přihlašovací údaje proti pevně zakódovanému seznamu párů uživatelských jmen a hesel.</span><span class="sxs-lookup"><span data-stu-id="b712a-111">However, the login page currently validates the supplied credentials against a hard-coded list of username and password pairs.</span></span> <span data-ttu-id="b712a-112">Musíme aktualizovat logiku přihlašovací stránky tak, aby ověřovala přihlašovací údaje pro uživatelské úložiště v rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="b712a-112">We need to update the login page's logic so that it validates credentials against the Membership framework's user store.</span></span>

<span data-ttu-id="b712a-113">Podobně jako při vytváření uživatelských účtů lze přihlašovací údaje ověřit programově nebo deklarativně.</span><span class="sxs-lookup"><span data-stu-id="b712a-113">Much like with creating user accounts, credentials can be validated programmatically or declaratively.</span></span> <span data-ttu-id="b712a-114">Rozhraní API pro členství zahrnuje metodu pro programové ověření přihlašovacích údajů uživatele proti uživatelskému úložišti.</span><span class="sxs-lookup"><span data-stu-id="b712a-114">The Membership API includes a method for programmatically validating a user's credentials against the user store.</span></span> <span data-ttu-id="b712a-115">A ASP.NET se dodává s přihlašovacím webovým ovládacím prvkem, který vykreslí uživatelské rozhraní s textovým polem pro uživatelské jméno a heslo a tlačítko pro přihlášení.</span><span class="sxs-lookup"><span data-stu-id="b712a-115">And ASP.NET ships with the Login Web control, which renders a user interface with textboxes for the username and password and a button to log in.</span></span>

<span data-ttu-id="b712a-116">V tomto kurzu podíváme se, jak ověřit přihlašovací údaje uživatele pro uživatelské úložiště členství pomocí programových prostředků a přihlašovacího ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="b712a-116">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="b712a-117">Také se podíváme na to, jak přizpůsobit vzhled a chování ovládacího prvku pro přihlášení.</span><span class="sxs-lookup"><span data-stu-id="b712a-117">We will also look at how to customize the login control's appearance and behavior.</span></span> <span data-ttu-id="b712a-118">Pusťme se do toho.</span><span class="sxs-lookup"><span data-stu-id="b712a-118">Let's get started!</span></span>

## <a name="step-1-validating-credentials-against-the-membership-user-store"></a><span data-ttu-id="b712a-119">Krok 1: ověření přihlašovacích údajů proti uživatelskému úložišti členství</span><span class="sxs-lookup"><span data-stu-id="b712a-119">Step 1: Validating Credentials Against the Membership User Store</span></span>

<span data-ttu-id="b712a-120">Pro weby, které používají ověřování pomocí formulářů, se uživatel přihlašuje k webu návštěvou přihlašovací stránky a zadáním jejich přihlašovacích údajů.</span><span class="sxs-lookup"><span data-stu-id="b712a-120">For web sites that use forms authentication, a user logs on to the website by visiting a login page and entering their credentials.</span></span> <span data-ttu-id="b712a-121">Tyto přihlašovací údaje se pak porovnají s uživatelským úložištěm.</span><span class="sxs-lookup"><span data-stu-id="b712a-121">These credentials are then compared against the user store.</span></span> <span data-ttu-id="b712a-122">Pokud jsou platné, pak se uživateli udělí lístek ověřování pomocí formulářů, což je token zabezpečení, který označuje identitu a pravost návštěvníka.</span><span class="sxs-lookup"><span data-stu-id="b712a-122">If they are valid, then the user is granted a forms authentication ticket, which is a security token that indicates the identity and authenticity of the visitor.</span></span>

<span data-ttu-id="b712a-123">Chcete-li ověřit uživatele v rámci rozhraní členství, použijte `Membership` [ `ValidateUser` metodu](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx)třídy.</span><span class="sxs-lookup"><span data-stu-id="b712a-123">To validate a user against the Membership framework, use the `Membership` class's [`ValidateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span></span> <span data-ttu-id="b712a-124">`ValidateUser`Metoda přijímá dva vstupní parametry- *`username`* a *`password`* a vrátí logickou hodnotu, která označuje, zda byla pověření platná.</span><span class="sxs-lookup"><span data-stu-id="b712a-124">The `ValidateUser` method takes in two input parameters - *`username`* and *`password`* - and returns a Boolean value indicating whether the credentials were valid.</span></span> <span data-ttu-id="b712a-125">Podobně jako u `CreateUser` metody, kterou jsme prozkoumali v předchozím kurzu, `ValidateUser` Metoda deleguje skutečné ověření nakonfigurovanému zprostředkovateli členství.</span><span class="sxs-lookup"><span data-stu-id="b712a-125">Like with the `CreateUser` method we examined in the previous tutorial, the `ValidateUser` method delegates the actual validation to the configured Membership provider.</span></span>

<span data-ttu-id="b712a-126">`SqlMembershipProvider`Ověří zadané přihlašovací údaje tím, že získá heslo zadaného uživatele prostřednictvím `aspnet_Membership_GetPasswordWithFormat` uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="b712a-126">The `SqlMembershipProvider` validates the supplied credentials by obtaining the specified user's password via the `aspnet_Membership_GetPasswordWithFormat` stored procedure.</span></span> <span data-ttu-id="b712a-127">Zajistěte, aby `SqlMembershipProvider` ukládala hesla uživatelů pomocí jednoho ze tří formátů: Clear, Encrypted nebo hash.</span><span class="sxs-lookup"><span data-stu-id="b712a-127">Recall that the `SqlMembershipProvider` stores users' passwords using one of three formats: clear, encrypted, or hashed.</span></span> <span data-ttu-id="b712a-128">`aspnet_Membership_GetPasswordWithFormat`Uložená procedura vrátí heslo v nezpracovaném formátu.</span><span class="sxs-lookup"><span data-stu-id="b712a-128">The `aspnet_Membership_GetPasswordWithFormat` stored procedure returns the password in its raw format.</span></span> <span data-ttu-id="b712a-129">Pro šifrovaná hesla nebo hesla s algoritmem hash `SqlMembershipProvider` transformuje *`password`* hodnotu předanou do `ValidateUser` metody do jejího ekvivalentu nebo ve stavu hash a pak ji porovná s tím, co bylo vráceno z databáze.</span><span class="sxs-lookup"><span data-stu-id="b712a-129">For encrypted or hashed passwords, the `SqlMembershipProvider` transforms the *`password`* value passed into the `ValidateUser` method into its equivalent encrypted or hashed state and then compares it with what was returned from the database.</span></span> <span data-ttu-id="b712a-130">Pokud heslo uložené v databázi odpovídá formátovanému heslu zadanému uživatelem, přihlašovací údaje jsou platné.</span><span class="sxs-lookup"><span data-stu-id="b712a-130">If the password stored in the database matches the formatted password entered by the user, the credentials are valid.</span></span>

<span data-ttu-id="b712a-131">Pojďme aktualizovat přihlašovací stránku (~/ `Login.aspx` ), aby ověřila zadané přihlašovací údaje v úložišti uživatelů rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="b712a-131">Let's update our login page (~/`Login.aspx`) so that it validates the supplied credentials against the Membership framework user store.</span></span> <span data-ttu-id="b712a-132">Tuto přihlašovací stránku jsme vytvořili zpátky v <a id="Tutorial02"></a> [*přehledu kurzu ověřování pomocí formulářů*](../introduction/an-overview-of-forms-authentication-cs.md) , vytváření rozhraní se dvěma textboxy pro uživatelské jméno a heslo, zaškrtávací políčko pro zapamatování identity a přihlašovací tlačítko (viz obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="b712a-132">We created this login page back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, creating an interface with two TextBoxes for the username and password, a Remember Me checkbox, and a Login button (see Figure 1).</span></span> <span data-ttu-id="b712a-133">Kód ověří zadané přihlašovací údaje proti pevně zakódovanému seznamu párů uživatelského jména a hesla (Scott/Password, Jisun/Password a Sam/Password).</span><span class="sxs-lookup"><span data-stu-id="b712a-133">The code validates the entered credentials against a hard-coded list of username and password pairs (Scott/password, Jisun/password, and Sam/password).</span></span> <span data-ttu-id="b712a-134">V kurzu <a id="Tutorial03"></a> [*Konfigurace ověřování a Pokročilá témata*](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md) jsme aktualizovali kód přihlašovací stránky pro ukládání dalších informací do vlastnosti ověřovacího lístku formuláře `UserData` .</span><span class="sxs-lookup"><span data-stu-id="b712a-134">In the <a id="Tutorial03"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md) tutorial we updated the login page's code to store additional information in the forms authentication ticket's `UserData` property.</span></span>

<span data-ttu-id="b712a-135">[![Rozhraní přihlašovací stránky obsahuje dvě textová pole, CheckBoxList a tlačítko.](validating-user-credentials-against-the-membership-user-store-cs/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-135">[![The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button](validating-user-credentials-against-the-membership-user-store-cs/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image1.png)</span></span>

<span data-ttu-id="b712a-136">**Obrázek 1**: rozhraní přihlašovací stránky obsahuje dvě textová pole, CheckBoxList a tlačítko ([kliknutím zobrazíte obrázek v plné velikosti).](validating-user-credentials-against-the-membership-user-store-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-136">**Figure 1**: The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image3.png))</span></span>

<span data-ttu-id="b712a-137">Uživatelské rozhraní přihlašovací stránky může zůstat beze změny, ale musíme nahradit `Click` obslužnou rutinu události přihlašovacího tlačítka kódem, který ověřuje uživatele v úložišti uživatelů rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="b712a-137">The login page's user interface can remain unchanged, but we need to replace the Login button's `Click` event handler with code that validates the user against the Membership framework user store.</span></span> <span data-ttu-id="b712a-138">Aktualizujte obslužnou rutinu události tak, aby se její kód zobrazoval takto:</span><span class="sxs-lookup"><span data-stu-id="b712a-138">Update the event handler so that its code appears as follows:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample1.cs)]

<span data-ttu-id="b712a-139">Tento kód je výjimečně jednoduchý.</span><span class="sxs-lookup"><span data-stu-id="b712a-139">This code is remarkably simple.</span></span> <span data-ttu-id="b712a-140">Začneme voláním `Membership.ValidateUser` metody a předáním zadaného uživatelského jména a hesla.</span><span class="sxs-lookup"><span data-stu-id="b712a-140">We start by calling the `Membership.ValidateUser` method, passing in the supplied username and password.</span></span> <span data-ttu-id="b712a-141">Pokud tato metoda vrátí hodnotu true, pak je uživatel přihlášen k webu prostřednictvím `FormsAuthentication` metody RedirectFromLoginPage třídy.</span><span class="sxs-lookup"><span data-stu-id="b712a-141">If that method returns true, then the user is signed into the site via the `FormsAuthentication` class's RedirectFromLoginPage method.</span></span> <span data-ttu-id="b712a-142">(Jak je popsáno v části <a id="Tutorial2"></a> [*Přehled kurzu ověřování na základě formulářů*](../introduction/an-overview-of-forms-authentication-cs.md) `FormsAuthentication.RedirectFromLoginPage` vytvoří lístek ověřování formuláře a pak přesměruje uživatele na příslušnou stránku.) Pokud přihlašovací údaje nejsou platné, ale zobrazí se `InvalidCredentialsMessage` popisek, který uživatele informuje, že uživatelské jméno nebo heslo je nesprávné.</span><span class="sxs-lookup"><span data-stu-id="b712a-142">(As we discussed in the <a id="Tutorial2"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, the `FormsAuthentication.RedirectFromLoginPage` creates the forms authentication ticket and then redirects the user to the appropriate page.) If the credentials are invalid, however, the `InvalidCredentialsMessage` Label is displayed, informing the user that their username or password was incorrect.</span></span>

<span data-ttu-id="b712a-143">A je to!</span><span class="sxs-lookup"><span data-stu-id="b712a-143">That's all there is to it!</span></span>

<span data-ttu-id="b712a-144">Pokud chcete otestovat, jestli přihlašovací stránka funguje podle očekávání, zkuste se přihlásit pomocí jednoho z uživatelských účtů, které jste vytvořili v předchozím kurzu.</span><span class="sxs-lookup"><span data-stu-id="b712a-144">To test that the login page works as expected, attempt to login with one of the user accounts you created in the preceding tutorial.</span></span> <span data-ttu-id="b712a-145">Nebo, pokud jste ještě nevytvořili účet, pokračujte a vytvořte si ho ze `~/Membership/CreatingUserAccounts.aspx` stránky.</span><span class="sxs-lookup"><span data-stu-id="b712a-145">Or, if you have not yet created an account, go ahead and create one from the `~/Membership/CreatingUserAccounts.aspx` page.</span></span>

> [!NOTE]
> <span data-ttu-id="b712a-146">Když uživatel zadá své přihlašovací údaje a odešle formulář přihlašovací stránky, přihlašovací údaje, včetně jejího hesla, se přenáší přes Internet na webový server v *prostém textu*.</span><span class="sxs-lookup"><span data-stu-id="b712a-146">When the user enters her credentials and submits the login page form, the credentials, including her password, are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="b712a-147">To znamená, že uživatelské jméno a heslo může sledovat jakýkoli počítačový podvodník, který bude sledovat síťový provoz.</span><span class="sxs-lookup"><span data-stu-id="b712a-147">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="b712a-148">Aby k tomu nedocházelo, je nezbytné šifrovat síťový provoz pomocí [protokolu SSL (Secure Socket Layer)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span><span class="sxs-lookup"><span data-stu-id="b712a-148">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="b712a-149">Tím se zajistí, že přihlašovací údaje (stejně jako kód HTML celé stránky) budou šifrovány od okamžiku, kdy prohlížeč opustí, dokud je webový server neobdrží.</span><span class="sxs-lookup"><span data-stu-id="b712a-149">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>

### <a name="how-the-membership-framework-handles-invalid-login-attempts"></a><span data-ttu-id="b712a-150">Způsob, jakým rozhraní členství zpracovává neplatné pokusy o přihlášení</span><span class="sxs-lookup"><span data-stu-id="b712a-150">How the Membership Framework Handles Invalid Login Attempts</span></span>

<span data-ttu-id="b712a-151">Když návštěvník dostane přihlašovací stránku a odešle své přihlašovací údaje, prohlížeč vytvoří požadavek HTTP na přihlašovací stránku.</span><span class="sxs-lookup"><span data-stu-id="b712a-151">When a visitor reaches the login page and submits their credentials, their browser makes an HTTP request to the login page.</span></span> <span data-ttu-id="b712a-152">Pokud jsou přihlašovací údaje platné, odpověď protokolu HTTP zahrnuje ověřovací lístek do souboru cookie.</span><span class="sxs-lookup"><span data-stu-id="b712a-152">If the credentials are valid, the HTTP response includes the authentication ticket in a cookie.</span></span> <span data-ttu-id="b712a-153">Proto by počítačový podvodník pokoušející se o přemístění do vaší lokality mohl vytvořit program, který vyčerpá požadavky HTTP na přihlašovací stránku s platným uživatelským jménem a odhadem v hesle.</span><span class="sxs-lookup"><span data-stu-id="b712a-153">Therefore, a hacker attempting to break into your site could create a program that exhaustively sends HTTP requests to the login page with a valid username and a guess at the password.</span></span> <span data-ttu-id="b712a-154">Pokud je odhad hesla správný, přihlašovací stránka vrátí soubor cookie ověřovacího lístku, u kterého bude program vědět, že má stumbled na platný pár uživatelského jména a hesla.</span><span class="sxs-lookup"><span data-stu-id="b712a-154">If the password guess is correct, the login page will return the authentication ticket cookie, at which point the program knows it has stumbled upon a valid username/password pair.</span></span> <span data-ttu-id="b712a-155">Díky útokům hrubou silou může být takový program Stumble na heslo uživatele, zejména v případě, že je heslo slabé.</span><span class="sxs-lookup"><span data-stu-id="b712a-155">Through brute force, such a program might be able to stumble upon a user's password, especially if the password is weak.</span></span>

<span data-ttu-id="b712a-156">Aby nedocházelo k takovým útokům hrubou silou, rozhraní pro členství zamkne uživatele, pokud v určitém časovém období dojde k určitému počtu neúspěšných pokusů o přihlášení.</span><span class="sxs-lookup"><span data-stu-id="b712a-156">To prevent such brute force attacks, the Membership framework locks out a user if there are a certain number of unsuccessful login attempts within a certain period of time.</span></span> <span data-ttu-id="b712a-157">Přesné parametry lze konfigurovat prostřednictvím následujících dvou nastavení konfigurace zprostředkovatele členství:</span><span class="sxs-lookup"><span data-stu-id="b712a-157">The exact parameters are configurable through the following two Membership provider configuration settings:</span></span>

- <span data-ttu-id="b712a-158">`maxInvalidPasswordAttempts` – Určuje, kolik neplatných pokusů o zadání hesla pro uživatele v časovém období, než je účet uzamčen. Výchozí hodnota je 5.</span><span class="sxs-lookup"><span data-stu-id="b712a-158">`maxInvalidPasswordAttempts` - specifies how many invalid password attempts are allowed for the user within the time period before the account is locked out. The default value is 5.</span></span>
- <span data-ttu-id="b712a-159">`passwordAttemptWindow` – Určuje časové období v minutách, během kterého se zadaný počet neplatných pokusů o přihlášení pokusí o uzamčení účtu. Výchozí hodnota je 10.</span><span class="sxs-lookup"><span data-stu-id="b712a-159">`passwordAttemptWindow` - indicates the time period in minutes during which the specified number of invalid login attempts will cause the account to be locked out. The default value is 10.</span></span>

<span data-ttu-id="b712a-160">Pokud uživatel byl uzamčen, nemůže se přihlásit, dokud správce neodemkne svůj účet.</span><span class="sxs-lookup"><span data-stu-id="b712a-160">If a user has been locked out, she cannot login until an administrator unlocks her account.</span></span> <span data-ttu-id="b712a-161">Když je uživatel uzamčený, bude `ValidateUser` Metoda *vždycky* vracet `false` , i když jsou dodány platné přihlašovací údaje.</span><span class="sxs-lookup"><span data-stu-id="b712a-161">When a user is locked out, the `ValidateUser` method will *always* return `false`, even if valid credentials are supplied.</span></span> <span data-ttu-id="b712a-162">I když toto chování snižuje pravděpodobnost, že se hacker do vaší lokality přeruší prostřednictvím metod hrubou silou, může ukončit uzamykání platného uživatele, který jednoduše zapomene heslo, nebo neúmyslně má na začátku neplatný den zápisu.</span><span class="sxs-lookup"><span data-stu-id="b712a-162">While this behavior lessens the likelihood that a hacker will break into your site through brute force methods, it can end up locking out a valid user who has simply forgotten her password or accidentally has the Caps Lock on or is having a bad typing day.</span></span>

<span data-ttu-id="b712a-163">Bohužel není k dispozici žádný integrovaný nástroj pro odemknutí uživatelského účtu.</span><span class="sxs-lookup"><span data-stu-id="b712a-163">Unfortunately, there is no built-in tool for unlocking a user account.</span></span> <span data-ttu-id="b712a-164">Chcete-li odemknout účet, můžete databázi změnit přímo, změnit `IsLockedOut` pole v `aspnet_Membership` tabulce pro příslušný uživatelský účet – nebo vytvořit webové rozhraní se seznamem uzamčených účtů s možnostmi jejich odemknutí.</span><span class="sxs-lookup"><span data-stu-id="b712a-164">In order to unlock an account, you can modify the database directly - change the `IsLockedOut` field in the `aspnet_Membership` table for the appropriate user account - or create a web-based interface that lists locked out accounts with options to unlock them.</span></span> <span data-ttu-id="b712a-165">Podíváme se na vytváření rozhraní pro správu pro provádění běžných úloh souvisejících s uživatelským účtem a rolemi v budoucím kurzu.</span><span class="sxs-lookup"><span data-stu-id="b712a-165">We will examine creating administrative interfaces for accomplishing common user account- and role-related tasks in a future tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="b712a-166">Jednou z Nevýhodou `ValidateUser` metody je, že pokud jsou zadané přihlašovací údaje neplatné, neposkytuje žádné vysvětlení k tomu, proč.</span><span class="sxs-lookup"><span data-stu-id="b712a-166">One downside of the `ValidateUser` method is that when the supplied credentials are invalid, it does not provide any explanation as to why.</span></span> <span data-ttu-id="b712a-167">Přihlašovací údaje mohou být neplatné, protože v úložišti uživatele není žádné párování uživatelského jména a hesla, nebo protože uživatel nebyl dosud schválen, nebo protože byl uživatel uzamčen. V kroku 4 se dozvíte, jak zobrazit uživateli podrobnější zprávu, když se jejich pokus o přihlášení nezdaří.</span><span class="sxs-lookup"><span data-stu-id="b712a-167">The credentials may be invalid because there is no matching username/password pair in the user store, or because the user has not yet been approved, or because the user has been locked out. In Step 4 we will see how to show a more detailed message to the user when their login attempt fails.</span></span>

## <a name="step-2-collecting-credentials-through-the-login-web-control"></a><span data-ttu-id="b712a-168">Krok 2: shromažďování přihlašovacích údajů prostřednictvím přihlašovacího webového ovládacího prvku</span><span class="sxs-lookup"><span data-stu-id="b712a-168">Step 2: Collecting Credentials through the Login Web Control</span></span>

<span data-ttu-id="b712a-169">[Přihlašovací webový ovládací prvek](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) vykresluje výchozí uživatelské rozhraní velmi podobné jako ten, který jsme vytvořili zpátky v <a id="SKM5"></a> [*přehledu kurzu ověřování pomocí formulářů*](../introduction/an-overview-of-forms-authentication-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="b712a-169">The [Login Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) renders a default user interface very similar to the one we created back in the <a id="SKM5"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial.</span></span> <span data-ttu-id="b712a-170">Použití přihlašovacího ovládacího prvku uloží nám práci s vytvořením rozhraní ke shromáždění přihlašovacích údajů návštěvníka.</span><span class="sxs-lookup"><span data-stu-id="b712a-170">Using the Login control saves us the work of having to create the interface to collect the visitor's credentials.</span></span> <span data-ttu-id="b712a-171">Kromě toho přihlašovací ovládací prvek automaticky přihlašuje uživatele (za předpokladu, že odeslaná pověření jsou platná), a tím šetříme, že je potřeba psát jakýkoliv kód.</span><span class="sxs-lookup"><span data-stu-id="b712a-171">Moreover, the Login control automatically signs in the user (assuming the submitted credentials are valid), thereby saving us from having to write any code.</span></span>

<span data-ttu-id="b712a-172">Pojďme aktualizovat a `Login.aspx` nahradit ručně vytvořené rozhraní a kód ovládacím prvkem pro přihlášení.</span><span class="sxs-lookup"><span data-stu-id="b712a-172">Let's update `Login.aspx`, replacing the manually created interface and code with a Login control.</span></span> <span data-ttu-id="b712a-173">Začněte odebráním stávajících značek a kódu v `Login.aspx` .</span><span class="sxs-lookup"><span data-stu-id="b712a-173">Start by removing the existing markup and code in `Login.aspx`.</span></span> <span data-ttu-id="b712a-174">Můžete ho odstranit hned nebo jednoduše komentovat. Chcete-li komentovat deklarativní označení, uzavřete ho pomocí `<%--` `--%>` oddělovačů a.</span><span class="sxs-lookup"><span data-stu-id="b712a-174">You may delete it outright, or simply comment it out. To comment out declarative markup, surround it with the `<%--` and `--%>` delimiters.</span></span> <span data-ttu-id="b712a-175">Tyto oddělovače můžete zadat ručně, nebo jak vidíte na obrázku 2, můžete vybrat text, který chcete komentovat, a pak na panelu nástrojů kliknout na ikonu odkomentovat vybrané řádky.</span><span class="sxs-lookup"><span data-stu-id="b712a-175">You can enter these delimiters manually, or, as Figure 2 shows, you may select the text to comment out and then click the Comment out the selected lines icon in the Toolbar.</span></span> <span data-ttu-id="b712a-176">Podobně můžete použít ikonu odkomentovat vybrané řádky a komentovat vybraný kód v třídě Code-na pozadí.</span><span class="sxs-lookup"><span data-stu-id="b712a-176">Similarly, you can use the Comment out the selected lines icon to comment out the selected code in the code-behind class.</span></span>

<span data-ttu-id="b712a-177">[![Odkomentovat existující deklarativní značky a zdrojový kód v Login. aspx](validating-user-credentials-against-the-membership-user-store-cs/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-177">[![Comment Out the Existing Declarative Markup and Source Code in Login.aspx](validating-user-credentials-against-the-membership-user-store-cs/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image4.png)</span></span>

<span data-ttu-id="b712a-178">**Obrázek 2**: Odkomentujte existující deklarativní označení a zdrojový kód v `Login.aspx` ([kliknutím zobrazíte obrázek v plné velikosti).](validating-user-credentials-against-the-membership-user-store-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-178">**Figure 2**: Comment Out the Existing Declarative Markup and Source Code in `Login.aspx` ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="b712a-179">Při zobrazení deklarativních značek v aplikaci Visual Studio 2005 není k dispozici ikona komentovat vybrané řádky.</span><span class="sxs-lookup"><span data-stu-id="b712a-179">The Comment out the selected lines icon is not available when viewing the declarative markup in Visual Studio 2005.</span></span> <span data-ttu-id="b712a-180">Pokud nepoužíváte Visual Studio 2008, budete muset ručně přidat `<%--` `--%>` oddělovače a.</span><span class="sxs-lookup"><span data-stu-id="b712a-180">If you are not using Visual Studio 2008 you will need to manually add the `<%--` and `--%>` delimiters.</span></span>

<span data-ttu-id="b712a-181">Dále přetáhněte ovládací prvek Login ze sady nástrojů na stránku a nastavte jeho `ID` vlastnost na `myLogin` .</span><span class="sxs-lookup"><span data-stu-id="b712a-181">Next, drag a Login control from the Toolbox on to the page and set its `ID` property to `myLogin`.</span></span> <span data-ttu-id="b712a-182">V tuto chvíli by vaše obrazovka měla vypadat podobně jako na obrázku 3.</span><span class="sxs-lookup"><span data-stu-id="b712a-182">At this point your screen should look similar to Figure 3.</span></span> <span data-ttu-id="b712a-183">Všimněte si, že výchozí rozhraní ovládacího prvku pro přihlášení obsahuje ovládací prvky TextBox pro uživatelské jméno a heslo, zaškrtávací políčko Zapamatovat mě v dalším čase a tlačítko přihlásit.</span><span class="sxs-lookup"><span data-stu-id="b712a-183">Note that the Login control's default interface includes TextBox controls for the username and password, a Remember me next time CheckBox, and a Log In Button.</span></span> <span data-ttu-id="b712a-184">K dispozici jsou také `RequiredFieldValidator` ovládací prvky pro dvě textová pole.</span><span class="sxs-lookup"><span data-stu-id="b712a-184">There are also `RequiredFieldValidator` controls for the two TextBoxes.</span></span>

<span data-ttu-id="b712a-185">[![Přidání ovládacího prvku pro přihlášení na stránku](validating-user-credentials-against-the-membership-user-store-cs/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-185">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-cs/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image7.png)</span></span>

<span data-ttu-id="b712a-186">**Obrázek 3**: Přidání ovládacího prvku pro přihlášení na stránku ([kliknutím zobrazíte obrázek v plné velikosti](validating-user-credentials-against-the-membership-user-store-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="b712a-186">**Figure 3**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image9.png))</span></span>

<span data-ttu-id="b712a-187">A hotovi!</span><span class="sxs-lookup"><span data-stu-id="b712a-187">And we're done!</span></span> <span data-ttu-id="b712a-188">Po kliknutí na tlačítko Přihlásit se k ovládacímu prvku přihlašování dojde k postbacku a přihlašovací ovládací prvek zavolá `Membership.ValidateUser` metodu, která předá zadané uživatelské jméno a heslo.</span><span class="sxs-lookup"><span data-stu-id="b712a-188">When the Login control's Log In button is clicked, a postback will occur and the Login control will call the `Membership.ValidateUser` method, passing in the entered username and password.</span></span> <span data-ttu-id="b712a-189">Pokud jsou přihlašovací údaje neplatné, ovládací prvek přihlášení zobrazí zprávu s oznámením, že.</span><span class="sxs-lookup"><span data-stu-id="b712a-189">If the credentials are invalid, the Login control displays a message stating such.</span></span> <span data-ttu-id="b712a-190">Pokud jsou však přihlašovací údaje platné, ovládací prvek přihlášení vytvoří lístek ověřování formuláře a přesměruje uživatele na příslušnou stránku.</span><span class="sxs-lookup"><span data-stu-id="b712a-190">If, however, the credentials are valid, then the Login control creates the forms authentication ticket and redirects the user to the appropriate page.</span></span>

<span data-ttu-id="b712a-191">Řízení přihlášení používá ke zjištění vhodné stránky pro přesměrování uživatele na základě úspěšného přihlášení čtyři faktory:</span><span class="sxs-lookup"><span data-stu-id="b712a-191">The Login control uses four factors to determine the appropriate page to redirect the user to upon a successful login:</span></span>

- <span data-ttu-id="b712a-192">Určuje, zda je ovládací prvek přihlášení na přihlašovací stránce definovaný `loginUrl` nastavením v konfiguraci ověřování pomocí formulářů; výchozí hodnota tohoto nastavení je `Login.aspx`</span><span class="sxs-lookup"><span data-stu-id="b712a-192">Whether the Login control is on the login page as defined by `loginUrl` setting in the forms authentication configuration; this setting's default value is `Login.aspx`</span></span>
- <span data-ttu-id="b712a-193">Přítomnost `ReturnUrl` parametru QueryString</span><span class="sxs-lookup"><span data-stu-id="b712a-193">The presence of a `ReturnUrl` querystring parameter</span></span>
- <span data-ttu-id="b712a-194">Hodnota [ `DestinationUrl` vlastnosti](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx) ovládacího prvku přihlašovacího jména</span><span class="sxs-lookup"><span data-stu-id="b712a-194">The value of the Login control's [`DestinationUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span></span>
- <span data-ttu-id="b712a-195">`defaultUrl`Hodnota zadaná v nastaveních konfigurace ověřování formulářů; výchozí hodnota tohoto nastavení je`Default.aspx`</span><span class="sxs-lookup"><span data-stu-id="b712a-195">The `defaultUrl` value specified in the forms authentication configuration settings; this setting's default value is `Default.aspx`</span></span>

<span data-ttu-id="b712a-196">Obrázek 4 znázorňuje, jak ovládací prvek Login používá tyto čtyři parametry k přijetí na příslušné stránce rozhodnutí.</span><span class="sxs-lookup"><span data-stu-id="b712a-196">Figure 4 depicts the how the Login control uses these four parameters to arrive at its appropriate page decision.</span></span>

<span data-ttu-id="b712a-197">[![Přidání ovládacího prvku pro přihlášení na stránku](validating-user-credentials-against-the-membership-user-store-cs/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-197">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-cs/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image10.png)</span></span>

<span data-ttu-id="b712a-198">**Obrázek 4**: Přidání ovládacího prvku pro přihlášení na stránku ([kliknutím zobrazíte obrázek v plné velikosti](validating-user-credentials-against-the-membership-user-store-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b712a-198">**Figure 4**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image12.png))</span></span>

<span data-ttu-id="b712a-199">Chvíli počkejte, než se otestuje přihlašovací řízení, a to tak, že navštívíte web prostřednictvím prohlížeče a přihlásíte se jako stávající uživatel v rámci systému členství.</span><span class="sxs-lookup"><span data-stu-id="b712a-199">Take a moment to test out the Login control by visiting the site through a browser and logging in as an existing user in the Membership framework.</span></span>

<span data-ttu-id="b712a-200">Vykreslené rozhraní ovládacího prvku přihlášení je vysoce konfigurovatelné.</span><span class="sxs-lookup"><span data-stu-id="b712a-200">The Login control's rendered interface is highly configurable.</span></span> <span data-ttu-id="b712a-201">Existuje mnoho vlastností, které ovlivňují jeho vzhled. a co víc, ovládací prvek pro přihlášení se dá převést na šablonu, aby se přes rozložení prvky uživatelského rozhraní poskytovala přesnou kontrolu.</span><span class="sxs-lookup"><span data-stu-id="b712a-201">There are a number of properties that influence its appearance; what's more, the Login control can be converted into a template for precise control over the layout the user interface elements.</span></span> <span data-ttu-id="b712a-202">Zbývající část tohoto kroku zjistí, jak přizpůsobit vzhled a rozložení.</span><span class="sxs-lookup"><span data-stu-id="b712a-202">The remainder of this step examines how to customize the appearance and layout.</span></span>

### <a name="customizing-the-login-controls-appearance"></a><span data-ttu-id="b712a-203">Přizpůsobení vzhledu přihlašovacího ovládacího prvku</span><span class="sxs-lookup"><span data-stu-id="b712a-203">Customizing the Login Control's Appearance</span></span>

<span data-ttu-id="b712a-204">Nastavení výchozí vlastnosti ovládacího prvku pro přihlášení vykreslí uživatelské rozhraní s nadpisem (přihlásit se), textovým polem a popiskem pro zadání uživatelského jména a hesla, zaškrtávací políčko Zapamatovat mě Next Time a přihlašovací tlačítko.</span><span class="sxs-lookup"><span data-stu-id="b712a-204">The Login control's default property settings render a user interface with a title ( Log In ), TextBox and Label controls for the username and password inputs, a Remember me next time CheckBox, and a Log In button.</span></span> <span data-ttu-id="b712a-205">Vzhled těchto prvků je možné konfigurovat prostřednictvím mnoha vlastností ovládacího prvku přihlašovacího jména.</span><span class="sxs-lookup"><span data-stu-id="b712a-205">The appearances of these elements are all configurable through the Login control's numerous properties.</span></span> <span data-ttu-id="b712a-206">Kromě toho je možné přidat další prvky uživatelského rozhraní, například odkaz na stránku pro vytvoření nového uživatelského účtu, a to nastavením vlastnosti nebo dvou.</span><span class="sxs-lookup"><span data-stu-id="b712a-206">Furthermore, additional user interface elements - such as a link to a page to create a new user account - can be added by setting a property or two.</span></span>

<span data-ttu-id="b712a-207">Pojďme si za chvíli Gussy vzhled našeho přihlašovacího řízení.</span><span class="sxs-lookup"><span data-stu-id="b712a-207">Let's spend a few moments to gussy up the appearance of our Login control.</span></span> <span data-ttu-id="b712a-208">Vzhledem k tomu, že `Login.aspx` stránka již obsahuje text v horní části stránky, která říká přihlášení, je název ovládacího prvku přihlašovacího jména nadbytečný.</span><span class="sxs-lookup"><span data-stu-id="b712a-208">Since the `Login.aspx` page already has text at the top of the page that says Login, the Login control's title is superfluous.</span></span> <span data-ttu-id="b712a-209">Proto vymažte hodnotu [ `TitleText` vlastnosti](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) , aby se odstranil název ovládacího prvku přihlašovacího jména.</span><span class="sxs-lookup"><span data-stu-id="b712a-209">Therefore, clear out the [`TitleText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) value in order to remove the Login control's title.</span></span>

<span data-ttu-id="b712a-210">Uživatelské jméno: a heslo: popisky vlevo od dvou ovládacích prvků TextBox lze přizpůsobit pomocí [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) [ `PasswordLabelText` vlastností](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx)a v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="b712a-210">The User Name: and Password: Labels to the left of the two TextBox controls can be customized through the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) and [`PasswordLabelText` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), respectively.</span></span> <span data-ttu-id="b712a-211">Pojďme změnit uživatelské jméno: popisek pro čtení uživatelského jména:.</span><span class="sxs-lookup"><span data-stu-id="b712a-211">Let's change the User Name: Label to read Username:.</span></span> <span data-ttu-id="b712a-212">Styly popisku a TextBox lze konfigurovat prostřednictvím [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) [ `TextBoxStyle` vlastností](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx)a v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="b712a-212">The Label and TextBox styles are configurable through the [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) and [`TextBoxStyle` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), respectively.</span></span>

<span data-ttu-id="b712a-213">Vlastnost text v poli zapamatovat mě v dalším čase se dá nastavit prostřednictvím ovládacího prvku pro přihlášení [`RememberMeText property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx) a její výchozí stav zaškrtnutí se dá nakonfigurovat přes [`RememberMeSet property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (což je výchozí hodnota false).</span><span class="sxs-lookup"><span data-stu-id="b712a-213">The Remember me next time CheckBox's Text property can be set through the Login control's [`RememberMeText property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), and its default checked state is configurable through the [`RememberMeSet property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (which defaults to False).</span></span> <span data-ttu-id="b712a-214">Pokračujte a nastavte `RememberMeSet` vlastnost na hodnotu true, aby se ve výchozím nastavení kontrolovalo zaškrtávací políčko Zapamatovat mě v dalším čase.</span><span class="sxs-lookup"><span data-stu-id="b712a-214">Go ahead and set the `RememberMeSet` property to True so that the Remember me next time CheckBox will be checked by default.</span></span>

<span data-ttu-id="b712a-215">Ovládací prvek Login nabízí dvě vlastnosti pro úpravu rozložení ovládacích prvků uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="b712a-215">The Login control offers two properties for adjusting the layout of its user interface controls.</span></span> <span data-ttu-id="b712a-216">[`TextLayout property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx)Určuje, zda jsou popisky zobrazeny vlevo od jejich odpovídajících textových polí (výchozí nastavení), nebo nad nimi.</span><span class="sxs-lookup"><span data-stu-id="b712a-216">The [`TextLayout property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indicates whether the Username: and Password: Labels appear to the left of their corresponding TextBoxes (the default), or above them.</span></span> <span data-ttu-id="b712a-217">[`Orientation property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx)Určuje, zda jsou vstupy uživatelského jména a hesla umístěny svisle (jedna nad druhou) nebo horizontálně.</span><span class="sxs-lookup"><span data-stu-id="b712a-217">The [`Orientation property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indicates whether the username and password inputs are situated vertically (one above the other) or horizontally.</span></span> <span data-ttu-id="b712a-218">Nechám tyto dvě vlastnosti nastavené na výchozí hodnoty, ale doporučujeme, abyste si vyzkoušeli nastavení těchto dvou vlastností na jiné než výchozí hodnoty, aby se zobrazil výsledný efekt.</span><span class="sxs-lookup"><span data-stu-id="b712a-218">I am going to leave these two properties set to their defaults, but I encourage you to try setting these two properties to their non-default values to see the resulting effect.</span></span>

> [!NOTE]
> <span data-ttu-id="b712a-219">V další části Konfigurace rozložení přihlašovacího ovládacího prvku se podíváme na použití šablon k definování přesného rozložení prvků uživatelského rozhraní ovládacího prvku rozložení.</span><span class="sxs-lookup"><span data-stu-id="b712a-219">In the next section, Configuring the Login Control's Layout, we will look at using templates to define the precise layout of the Layout control's user interface elements.</span></span>

<span data-ttu-id="b712a-220">Zabalte nastavení vlastností ovládacího prvku pro přihlášení nastavením [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) [ `CreateUserUrl` vlastností](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) a, které ještě nejsou zaregistrované?</span><span class="sxs-lookup"><span data-stu-id="b712a-220">Wrap up the Login control's property settings by setting the [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) and [`CreateUserUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) to Not registered yet?</span></span> <span data-ttu-id="b712a-221">Vytvořte si účet!</span><span class="sxs-lookup"><span data-stu-id="b712a-221">Create an account!</span></span> <span data-ttu-id="b712a-222">a `~/Membership/CreatingUserAccounts.aspx` v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="b712a-222">and `~/Membership/CreatingUserAccounts.aspx`, respectively.</span></span> <span data-ttu-id="b712a-223">Tím se přidá hypertextový odkaz na rozhraní ovládacího prvku pro přihlášení ukazující na stránku, kterou jsme vytvořili v <a id="SKM6"></a> [předchozím kurzu](creating-user-accounts-cs.md).</span><span class="sxs-lookup"><span data-stu-id="b712a-223">This adds a hyperlink to the Login control's interface pointing to the page we created in the <a id="SKM6"></a>[preceding tutorial](creating-user-accounts-cs.md).</span></span> <span data-ttu-id="b712a-224">Ovládací prvky pro přihlášení [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) a [ `HelpPageUrl` vlastnosti](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) a [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) [ `PasswordRecoveryUrl` vlastnosti](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) fungují stejným způsobem, vykreslování odkazů na stránku s usnadněním a stránku pro obnovení hesla.</span><span class="sxs-lookup"><span data-stu-id="b712a-224">The Login control's [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) and [`HelpPageUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) and [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) and [`PasswordRecoveryUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) work in the same manner, rendering links to a help page and a password recovery page.</span></span>

<span data-ttu-id="b712a-225">Po provedení změn těchto vlastností by deklarativní značení a vzhled ovládacího prvku přihlašovacího jména měly vypadat podobně jako na obrázku 5.</span><span class="sxs-lookup"><span data-stu-id="b712a-225">After making these property changes, your Login control's declarative markup and appearance should look similar to that shown in Figure 5.</span></span>

<span data-ttu-id="b712a-226">[![Hodnoty vlastností ovládacího prvku přihlašovacího jména určují jeho vzhled.](validating-user-credentials-against-the-membership-user-store-cs/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-226">[![The Login Control's Properties' Values Dictate Its Appearance](validating-user-credentials-against-the-membership-user-store-cs/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image13.png)</span></span>

<span data-ttu-id="b712a-227">**Obrázek 5**: hodnoty vlastností ovládacího prvku pro přihlašovací údaje určují jeho vzhled ([kliknutím zobrazíte obrázek v plné velikosti](validating-user-credentials-against-the-membership-user-store-cs/_static/image15.png)).</span><span class="sxs-lookup"><span data-stu-id="b712a-227">**Figure 5**: The Login Control's Properties' Values Dictate Its Appearance  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image15.png))</span></span>

### <a name="configuring-the-login-controls-layout"></a><span data-ttu-id="b712a-228">Konfigurace rozložení ovládacího prvku přihlašovacího jména</span><span class="sxs-lookup"><span data-stu-id="b712a-228">Configuring the Login Control's Layout</span></span>

<span data-ttu-id="b712a-229">Výchozí uživatelské rozhraní pro přihlašovací webové ovládací prvky rozloží rozhraní v HTML `<table>` .</span><span class="sxs-lookup"><span data-stu-id="b712a-229">The Login Web control's default user interface lays out the interface in an HTML `<table>`.</span></span> <span data-ttu-id="b712a-230">Ale co když potřebujeme lepší kontrolu nad vykresleným výstupem?</span><span class="sxs-lookup"><span data-stu-id="b712a-230">But what if we need finer control over the rendered output?</span></span> <span data-ttu-id="b712a-231">Možná chceme nahradit `<table>` řadu `<div>` značek.</span><span class="sxs-lookup"><span data-stu-id="b712a-231">Maybe we want to replace the `<table>` with a series of `<div>` tags.</span></span> <span data-ttu-id="b712a-232">Nebo co když naše aplikace vyžaduje pro ověřování další přihlašovací údaje?</span><span class="sxs-lookup"><span data-stu-id="b712a-232">Or what if our application requires additional credentials for authentication?</span></span> <span data-ttu-id="b712a-233">Mnoho finančních webů vyžaduje, aby uživatelé zadali nejen uživatelské jméno a heslo, ale také osobní identifikační číslo (PIN) nebo jiné identifikační údaje.</span><span class="sxs-lookup"><span data-stu-id="b712a-233">Many financial websites, for instance, require users to supply not only a username and password, but also a Personal Identification Number (PIN), or other identifying information.</span></span> <span data-ttu-id="b712a-234">Bez ohledu na to, jak je možné, lze ovládací prvek přihlášení převést na šablonu, ze které můžeme explicitně definovat deklarativní označení rozhraní.</span><span class="sxs-lookup"><span data-stu-id="b712a-234">Whatever the reasons may be, it is possible to convert the Login control into a template, from which we can explicitly define the interface's declarative markup.</span></span>

<span data-ttu-id="b712a-235">Abychom mohli aktualizovat přihlašovací ovládací prvek pro shromažďování dalších přihlašovacích údajů, musíme udělat dvě věci:</span><span class="sxs-lookup"><span data-stu-id="b712a-235">We need to do two things in order to update the Login control to collect additional credentials:</span></span>

1. <span data-ttu-id="b712a-236">Aktualizujte rozhraní ovládacího prvku přihlášení tak, aby zahrnovalo webové ovládací prvky, aby se shromáždily další přihlašovací údaje.</span><span class="sxs-lookup"><span data-stu-id="b712a-236">Update the Login control's interface to include Web control(s) to collect the additional credentials.</span></span>
2. <span data-ttu-id="b712a-237">Přepište logiku interního ověřování ovládacího prvku přihlášení tak, aby byl uživatel ověřen pouze v případě, že jsou jeho uživatelské jméno a heslo platné a že jsou také platné jejich další přihlašovací údaje.</span><span class="sxs-lookup"><span data-stu-id="b712a-237">Override the Login control's internal authentication logic so that a user is only authenticated if their username and password is valid and their additional credentials are valid, too.</span></span>

<span data-ttu-id="b712a-238">Abychom mohli dosáhnout prvního úkolu, musíme převést ovládací prvek Login na šablonu a přidat potřebné webové ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="b712a-238">To accomplish the first task, we need to convert the Login control into a template and add the necessary Web controls.</span></span> <span data-ttu-id="b712a-239">Jako u druhé úlohy lze logiku ověřování ovládacího prvku přihlášení nahradit vytvořením obslužné rutiny události pro [ `Authenticate` událost](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="b712a-239">As for the second task, the Login control's authentication logic can be superseded by creating an event handler for the control's [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span>

<span data-ttu-id="b712a-240">Pojďme aktualizovat přihlašovací ovládací prvek tak, aby vyzvat uživatele k zadání uživatelského jména, hesla a e-mailové adresy a ověří uživatele jenom v případě, že zadaná e-mailová adresa odpovídá své e-mailové adrese v souboru.</span><span class="sxs-lookup"><span data-stu-id="b712a-240">Let's update the Login control so that it prompts users for their username, password, and email address and only authenticates the user if the email address supplied matches their email address on file.</span></span> <span data-ttu-id="b712a-241">Nejdřív je potřeba převést rozhraní ovládacího prvku Login na šablonu.</span><span class="sxs-lookup"><span data-stu-id="b712a-241">We first need to convert the Login control's interface to a template.</span></span> <span data-ttu-id="b712a-242">V inteligentní značce ovládacího prvku přihlašovací jméno vyberte možnost převést na šablonu.</span><span class="sxs-lookup"><span data-stu-id="b712a-242">From the Login control's Smart Tag, choose the Convert to template option.</span></span>

<span data-ttu-id="b712a-243">[![Převod ovládacího prvku pro přihlášení na šablonu](validating-user-credentials-against-the-membership-user-store-cs/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-243">[![Convert the Login Control to a Template](validating-user-credentials-against-the-membership-user-store-cs/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image16.png)</span></span>

<span data-ttu-id="b712a-244">**Obrázek 6**: převod ovládacího prvku pro přihlášení na šablonu ([kliknutím zobrazíte obrázek v plné velikosti](validating-user-credentials-against-the-membership-user-store-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="b712a-244">**Figure 6**: Convert the Login Control to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="b712a-245">Chcete-li vrátit ovládací prvek přihlášení ke své předběžné verzi šablony, klikněte na odkaz Obnovit z inteligentní značky ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="b712a-245">To revert the Login control to its pre-template version, click the Reset link from the control's Smart Tag.</span></span>

<span data-ttu-id="b712a-246">Převedení přihlašovacího ovládacího prvku na šablonu přidá `LayoutTemplate` k deklarativní značce ovládacího prvku ovládací prvky HTML a webové ovládací prvky definující uživatelské rozhraní.</span><span class="sxs-lookup"><span data-stu-id="b712a-246">Converting the Login control to a template adds a `LayoutTemplate` to the control's declarative markup with HTML elements and Web controls defining the user interface.</span></span> <span data-ttu-id="b712a-247">Jak ukazuje obrázek 7, převod ovládacího prvku na šablonu odebere z okno Vlastnosti několik vlastností, například `TitleText` , `CreateUserUrl` a tak dále, protože tyto hodnoty vlastností jsou při použití šablony ignorovány.</span><span class="sxs-lookup"><span data-stu-id="b712a-247">As Figure 7 shows, converting the control to a template removes a number of properties from the Properties window, such as `TitleText`, `CreateUserUrl`, and so forth, since these property values are ignored when using a template.</span></span>

<span data-ttu-id="b712a-248">[![V případě, že je ovládací prvek přihlášení převeden na šablonu, je k dispozici méně vlastností.](validating-user-credentials-against-the-membership-user-store-cs/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-248">[![Fewer Properties are Available When the Login Control is Converted to a Template](validating-user-credentials-against-the-membership-user-store-cs/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image19.png)</span></span>

<span data-ttu-id="b712a-249">**Obrázek 7**: k dispozici je méně vlastností, pokud je ovládací prvek přihlášení převeden na šablonu ([kliknutím zobrazíte obrázek v plné velikosti).](validating-user-credentials-against-the-membership-user-store-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-249">**Figure 7**: Fewer Properties are Available When the Login Control is Converted to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image21.png))</span></span>

<span data-ttu-id="b712a-250">Značky HTML v lze podle `LayoutTemplate` potřeby upravit.</span><span class="sxs-lookup"><span data-stu-id="b712a-250">The HTML markup in the `LayoutTemplate` may be modified as needed.</span></span> <span data-ttu-id="b712a-251">Stejně tak můžete do šablony přidat jakékoli nové webové ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="b712a-251">Likewise, feel free to add any new Web controls to the template.</span></span> <span data-ttu-id="b712a-252">Je ale důležité, aby hlavní webové ovládací prvky přihlašovacího ovládacího prvku zůstaly v šabloně a zůstaly přiřazené `ID` hodnoty.</span><span class="sxs-lookup"><span data-stu-id="b712a-252">However, it is important that Login control's core Web controls remain in the template and keep their assigned `ID` values.</span></span> <span data-ttu-id="b712a-253">Konkrétně neodstraňujte ani neměňte pole `UserName` ani `Password` textová pole, `RememberMe` zaškrtávací políčko, `LoginButton` tlačítko, `FailureText` popisek ani `RequiredFieldValidator` ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="b712a-253">In particular, do not remove or rename the `UserName` or `Password` TextBoxes, the `RememberMe` CheckBox, the `LoginButton` Button, the `FailureText` Label, or the `RequiredFieldValidator` controls.</span></span>

<span data-ttu-id="b712a-254">Abychom mohli shromažďovat e-mailovou adresu návštěvníka, musíme do šablony přidat textové pole.</span><span class="sxs-lookup"><span data-stu-id="b712a-254">To collect the visitor's email address, we need to add a TextBox to the template.</span></span> <span data-ttu-id="b712a-255">Přidejte následující deklarativní značku mezi řádek tabulky ( `<tr>` ), který obsahuje `Password` textové pole a řádek tabulky, který má zaškrtávací políčko Zapamatovat mě v dalším čase:</span><span class="sxs-lookup"><span data-stu-id="b712a-255">Add the following declarative markup between the table row (`<tr>`) that contains the `Password` TextBox and the table row that holds the Remember me next time CheckBox:</span></span>

[!code-aspx[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample2.aspx)]

<span data-ttu-id="b712a-256">Po přidání `Email` textového pole navštivte stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="b712a-256">After adding the `Email` TextBox, visit the page through a browser.</span></span> <span data-ttu-id="b712a-257">Jak ukazuje obrázek 8, uživatelské rozhraní ovládacího prvku Login nyní obsahuje třetí textové pole.</span><span class="sxs-lookup"><span data-stu-id="b712a-257">As Figure 8 shows, the Login control's user interface now includes a third textbox.</span></span>

<span data-ttu-id="b712a-258">[![Přihlašovací ovládací prvek teď obsahuje textové pole pro e-mailovou adresu uživatele.](validating-user-credentials-against-the-membership-user-store-cs/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-258">[![The Login Control Now Includes a Textbox for the User's Email Address](validating-user-credentials-against-the-membership-user-store-cs/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image22.png)</span></span>

<span data-ttu-id="b712a-259">**Obrázek 8**: přihlašovací ovládací prvek teď obsahuje textové pole pro e-mailovou adresu uživatele ([kliknutím zobrazíte obrázek v plné velikosti).](validating-user-credentials-against-the-membership-user-store-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-259">**Figure 8**: The Login Control Now Includes a Textbox for the User's Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image24.png))</span></span>

<span data-ttu-id="b712a-260">V tomto okamžiku přihlašovací ovládací prvek stále používá `Membership.ValidateUser` metodu k ověření zadaných přihlašovacích údajů.</span><span class="sxs-lookup"><span data-stu-id="b712a-260">At this point, the Login control is still using the `Membership.ValidateUser` method to validate the supplied credentials.</span></span> <span data-ttu-id="b712a-261">Odpovídající hodnota, která se zadává do `Email` textového pole, nemá žádný vliv na to, jestli se uživatel může přihlásit.</span><span class="sxs-lookup"><span data-stu-id="b712a-261">Correspondingly, the value entered into the `Email` TextBox has no bearing on whether the user can log in.</span></span> <span data-ttu-id="b712a-262">V kroku 3 se podíváme na to, jak přepsat logiku ověřování ovládacího prvku přihlášení, aby se přihlašovací údaje považovaly jenom za platné, pokud jsou uživatelské jméno a heslo platné a zadaná e-mailová adresa se shoduje s e-mailovou adresou v souboru.</span><span class="sxs-lookup"><span data-stu-id="b712a-262">In Step 3 we will look at how to override the Login control's authentication logic so that the credentials are only considered valid if the username and password are valid and the supplied email address matches up with the email address on file.</span></span>

## <a name="step-3-modifying-the-login-controls-authentication-logic"></a><span data-ttu-id="b712a-263">Krok 3: změna logiky ověřování ovládacího prvku přihlášení</span><span class="sxs-lookup"><span data-stu-id="b712a-263">Step 3: Modifying the Login Control's Authentication Logic</span></span>

<span data-ttu-id="b712a-264">Když návštěvník poskytne své přihlašovací údaje a klikne na tlačítko Přihlásit se, vystavení se provede a přihlašovací řízení pokračuje prostřednictvím pracovního postupu ověřování.</span><span class="sxs-lookup"><span data-stu-id="b712a-264">When a visitor supplies her credentials and clicks the Log In button, a postback ensues and the Login control progresses through its authentication workflow.</span></span> <span data-ttu-id="b712a-265">Pracovní postup se spustí vyvoláním [ `LoggingIn` události](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span><span class="sxs-lookup"><span data-stu-id="b712a-265">The workflow starts by raising the [`LoggingIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span></span> <span data-ttu-id="b712a-266">Jakékoli obslužné rutiny události přidružené k této události mohou zrušit operaci přihlášení nastavením `e.Cancel` vlastnosti na hodnotu `true` .</span><span class="sxs-lookup"><span data-stu-id="b712a-266">Any event handlers associated with this event may cancel the log in operation by setting the `e.Cancel` property to `true`.</span></span>

<span data-ttu-id="b712a-267">Pokud není operace přihlášení zrušena, pracovní postup se doplní tím, že [ `Authenticate` událost](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)vyvyvolává.</span><span class="sxs-lookup"><span data-stu-id="b712a-267">If the log in operation is not cancelled, the workflow progresses by raising the [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span> <span data-ttu-id="b712a-268">Pokud pro událost dojde k obslužné rutině události `Authenticate` , zodpovídá za určení, zda jsou zadaná pověření platná nebo nikoli.</span><span class="sxs-lookup"><span data-stu-id="b712a-268">If there is an event handler for the `Authenticate` event, then it is responsible for determining whether the supplied credentials are valid or not.</span></span> <span data-ttu-id="b712a-269">Pokud není zadána žádná obslužná rutina události, ovládací prvek Login používá `Membership.ValidateUser` metodu k určení platnosti přihlašovacích údajů.</span><span class="sxs-lookup"><span data-stu-id="b712a-269">If no event handler is specified, the Login control uses the `Membership.ValidateUser` method to determine the validity of the credentials.</span></span>

<span data-ttu-id="b712a-270">Pokud jsou zadané přihlašovací údaje platné, vytvoří se lístek ověřování formulářů, [ `LoggedIn` událost](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) se vyvolá a uživatel se přesměruje na příslušnou stránku.</span><span class="sxs-lookup"><span data-stu-id="b712a-270">If the supplied credentials are valid, then the forms authentication ticket is created, the [`LoggedIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) is raised, and the user is redirected to the appropriate page.</span></span> <span data-ttu-id="b712a-271">Pokud se však přihlašovací údaje považují za neplatné, vyvolá se [ `LoginError` událost](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) a zobrazí se zpráva informující o tom, že jejich přihlašovací údaje byly neplatné.</span><span class="sxs-lookup"><span data-stu-id="b712a-271">If, however, the credentials are deemed invalid, then the [`LoginError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) is raised and a message is displayed informing the user that their credentials were invalid.</span></span> <span data-ttu-id="b712a-272">Ve výchozím nastavení při selhání ovládací prvek pro přihlášení jednoduše nastaví `FailureText` vlastnost text ovládacího prvku popisek na zprávu o selhání (váš pokus o přihlášení nebyl úspěšný.</span><span class="sxs-lookup"><span data-stu-id="b712a-272">By default, on failure the Login control simply sets its `FailureText` Label control's Text property to a failure message ( Your login attempt was not successful.</span></span> <span data-ttu-id="b712a-273">Zkuste to prosím znovu.</span><span class="sxs-lookup"><span data-stu-id="b712a-273">Please try again ).</span></span> <span data-ttu-id="b712a-274">Pokud je však [ `FailureAction` vlastnost](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) ovládacího prvku přihlašovacího ovládacího prvku nastavena na `RedirectToLoginPage` , pak řízení přihlášení vydá `Response.Redirect` přihlašovací stránku, která připojuje parametr QueryString `loginfailure=1` (což způsobí, že ovládacímu prvku pro přihlášení dojde k zobrazení zprávy o selhání).</span><span class="sxs-lookup"><span data-stu-id="b712a-274">However, if the Login control's [`FailureAction` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) is set to `RedirectToLoginPage`, then the Login control issues a `Response.Redirect` to the login page appending the querystring parameter `loginfailure=1` (which causes the Login control to display the failure message).</span></span>

<span data-ttu-id="b712a-275">Obrázek 9 nabízí vývojový diagram pracovního postupu ověřování.</span><span class="sxs-lookup"><span data-stu-id="b712a-275">Figure 9 offers a flow chart of the authentication workflow.</span></span>

<span data-ttu-id="b712a-276">[![Pracovní postup ověřování ovládacího prvku přihlášení](validating-user-credentials-against-the-membership-user-store-cs/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-276">[![The Login Control's Authentication Workflow](validating-user-credentials-against-the-membership-user-store-cs/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image25.png)</span></span>

<span data-ttu-id="b712a-277">**Obrázek 9**: pracovní postup ověření přihlašovacího ovládacího prvku ([kliknutím zobrazíte obrázek v plné velikosti](validating-user-credentials-against-the-membership-user-store-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="b712a-277">**Figure 9**: The Login Control's Authentication Workflow  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="b712a-278">Pokud vás zajímá, kdy byste použili `FailureAction` `RedirectToLogin` možnost stránky, zvažte následující scénář.</span><span class="sxs-lookup"><span data-stu-id="b712a-278">If you are wondering when you would use the `FailureAction`'s `RedirectToLogin` page option, consider the following scenario.</span></span> <span data-ttu-id="b712a-279">Nyní naše `Site.master` Hlavní stránka má v současné době text, Hello, v levém sloupci, když je navštíven anonymní uživatel, ale Představme si, že jsme chtěli tento text nahradit ovládacím prvkem pro přihlášení.</span><span class="sxs-lookup"><span data-stu-id="b712a-279">Right now our `Site.master` master page currently has the text, Hello, stranger displayed in the left column when visited by an anonymous user, but imagine that we wanted to replace that text with a Login control.</span></span> <span data-ttu-id="b712a-280">To umožňuje anonymnímu uživateli přihlásit se ze všech stránek na webu, aniž by musel navštěvovat přihlašovací stránku přímo.</span><span class="sxs-lookup"><span data-stu-id="b712a-280">This would allow an anonymous user to log in from any page on the site, instead of requiring them to visit the login page directly.</span></span> <span data-ttu-id="b712a-281">Pokud se ale uživatel nemůže přihlásit prostřednictvím ovládacího prvku pro přihlášení, který vygenerovala stránka předlohy, může to mít smysl ho přesměrovat na přihlašovací stránku ( `Login.aspx` ), protože tato stránka pravděpodobně obsahuje další pokyny, odkazy a další nápovědě – například odkazy k vytvoření nového účtu nebo načtení ztraceného hesla – které nebyly přidány do hlavní stránky.</span><span class="sxs-lookup"><span data-stu-id="b712a-281">However, if a user was unable to log in via the Login control rendered by the master page, it might make sense to redirect them to the login page (`Login.aspx`) because that page likely includes additional instructions, links, and other help - such as links to create a new account or retrieve a lost password - that were not added to the master page.</span></span>

### <a name="creating-theauthenticateevent-handler"></a><span data-ttu-id="b712a-282">Vytvoření `Authenticate` obslužné rutiny události</span><span class="sxs-lookup"><span data-stu-id="b712a-282">Creating the`Authenticate`Event Handler</span></span>

<span data-ttu-id="b712a-283">Aby bylo možné připojit vlastní logiku ověřování, musíme vytvořit obslužnou rutinu události pro událost ovládacího prvku Login `Authenticate` .</span><span class="sxs-lookup"><span data-stu-id="b712a-283">In order to plug in our custom authentication logic, we need to create an event handler for the Login control's `Authenticate` event.</span></span> <span data-ttu-id="b712a-284">Vytvořením obslužné rutiny události pro `Authenticate` událost dojde k vygenerování následující definice obslužné rutiny události:</span><span class="sxs-lookup"><span data-stu-id="b712a-284">Creating an event handler for the `Authenticate` event will generate the following event handler definition:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample3.cs)]

<span data-ttu-id="b712a-285">Jak vidíte, `Authenticate` obslužná rutina události je předána objektu typu [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) jako jeho druhý vstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="b712a-285">As you can see, the `Authenticate` event handler is passed an object of type [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) as its second input parameter.</span></span> <span data-ttu-id="b712a-286">`AuthenticateEventArgs`Třída obsahuje logickou vlastnost s názvem `Authenticated` , která se používá k určení, zda jsou zadaná pověření platná.</span><span class="sxs-lookup"><span data-stu-id="b712a-286">The `AuthenticateEventArgs` class contains a Boolean property named `Authenticated` that is used to specify whether the supplied credentials are valid.</span></span> <span data-ttu-id="b712a-287">Náš úkol, pak je zde napsat kód, který určuje, zda jsou dodané přihlašovací údaje platné, nebo nikoli a nastavte `e.Authenticate` vlastnost odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="b712a-287">Our task, then, is to write code here that determines whether the supplied credentials are valid or not, and to set the `e.Authenticate` property accordingly.</span></span>

### <a name="determining-and-validating-the-supplied-credentials"></a><span data-ttu-id="b712a-288">Určení a ověření zadaných přihlašovacích údajů</span><span class="sxs-lookup"><span data-stu-id="b712a-288">Determining and Validating the Supplied Credentials</span></span>

<span data-ttu-id="b712a-289">Pomocí vlastností ovládacího prvku [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) a [ `Password` vlastnosti](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) přihlášení Určete přihlašovací údaje uživatele a hesla zadané uživatelem.</span><span class="sxs-lookup"><span data-stu-id="b712a-289">Use the Login control's [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) to determine the username and password credentials entered by the user.</span></span> <span data-ttu-id="b712a-290">Aby bylo možné určit hodnoty zadané do jakýchkoli dalších webových ovládacích prvků (například `Email` textové pole, které jsme přidali v předchozím kroku), použijte *`LoginControlID`* `.FindControl` (" *`controlID`* ") k získání programového odkazu na webový ovládací prvek v šabloně, jejíž `ID` vlastnost je rovna *`controlID`* .</span><span class="sxs-lookup"><span data-stu-id="b712a-290">In order to determine the values entered into any additional Web controls (such as the `Email` TextBox we added in the previous step), use *`LoginControlID`*`.FindControl`("*`controlID`*") to obtain a programmatic reference to the Web control in the template whose `ID` property is equal to *`controlID`*.</span></span> <span data-ttu-id="b712a-291">Chcete-li například získat odkaz na `Email` textové pole, použijte následující kód:</span><span class="sxs-lookup"><span data-stu-id="b712a-291">For example, to get a reference to the `Email` TextBox, use the following code:</span></span>

`TextBox EmailTextBox = myLogin.FindControl("Email") as TextBox;`

<span data-ttu-id="b712a-292">Aby bylo možné ověřit přihlašovací údaje uživatele, musíme udělat dvě věci:</span><span class="sxs-lookup"><span data-stu-id="b712a-292">In order to validate the user's credentials we need to do two things:</span></span>

1. <span data-ttu-id="b712a-293">Ujistěte se, že zadané uživatelské jméno a heslo jsou platné.</span><span class="sxs-lookup"><span data-stu-id="b712a-293">Ensure that the provided username and password are valid</span></span>
2. <span data-ttu-id="b712a-294">Zajistěte, aby zadaná e-mailová adresa odpovídala e-mailové adrese v souboru, aby se uživatel pokusil přihlásit.</span><span class="sxs-lookup"><span data-stu-id="b712a-294">Ensure that email address entered matches the email address on file for the user attempting to log in</span></span>

<span data-ttu-id="b712a-295">Pro provedení první kontroly můžeme jednoduše použít `Membership.ValidateUser` metodu, jako bychom viděli v kroku 1.</span><span class="sxs-lookup"><span data-stu-id="b712a-295">To accomplish the first check we can simply use the `Membership.ValidateUser` method like we saw in Step 1.</span></span> <span data-ttu-id="b712a-296">Pro druhou kontrolu musíme určit e-mailovou adresu uživatele, abychom ji mohli porovnat s e-mailovou adresou, kterou zadal do ovládacího prvku TextBox.</span><span class="sxs-lookup"><span data-stu-id="b712a-296">For the second check, we need to determine the user's email address so that we can compare it to the email address they entered into the TextBox control.</span></span> <span data-ttu-id="b712a-297">Chcete-li získat informace o konkrétním uživateli, použijte `Membership` [ `GetUser` metodu](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx)třídy.</span><span class="sxs-lookup"><span data-stu-id="b712a-297">To get information about a particular user, use the `Membership` class's [`GetUser` method](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span></span>

<span data-ttu-id="b712a-298">`GetUser`Metoda má počet přetížení.</span><span class="sxs-lookup"><span data-stu-id="b712a-298">The `GetUser` method has a number of overloads.</span></span> <span data-ttu-id="b712a-299">Pokud se tato funkce použije bez předání jakýchkoli parametrů, vrátí informace o aktuálně přihlášeném uživateli.</span><span class="sxs-lookup"><span data-stu-id="b712a-299">If used without passing in any parameters, it returns information about the currently logged in user.</span></span> <span data-ttu-id="b712a-300">Chcete-li získat informace o konkrétním uživateli, zavolejte `GetUser` na své uživatelské jméno.</span><span class="sxs-lookup"><span data-stu-id="b712a-300">To get information about a particular user, call `GetUser` passing in their username.</span></span> <span data-ttu-id="b712a-301">V obou případech `GetUser` vrátí [ `MembershipUser` objekt](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), který má vlastnosti jako `UserName` , `Email` , `IsApproved` , `IsOnline` a tak dále.</span><span class="sxs-lookup"><span data-stu-id="b712a-301">Either way, `GetUser` returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which has properties like `UserName`, `Email`, `IsApproved`, `IsOnline`, and so on.</span></span>

<span data-ttu-id="b712a-302">Následující kód implementuje tyto dvě kontroly.</span><span class="sxs-lookup"><span data-stu-id="b712a-302">The following code implements these two checks.</span></span> <span data-ttu-id="b712a-303">Pokud `e.Authenticate` je nastaveno na `true` , v opačném případě je přiřazeno `false` .</span><span class="sxs-lookup"><span data-stu-id="b712a-303">If both pass, then `e.Authenticate` is set to `true`, otherwise it is assigned `false`.</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample4.cs)]

<span data-ttu-id="b712a-304">V případě tohoto kódu se pokuste přihlásit jako platný uživatel a zadat správné uživatelské jméno, heslo a e-mailovou adresu.</span><span class="sxs-lookup"><span data-stu-id="b712a-304">With this code in place, attempt to log in as a valid user, entering the correct username, password, and email address.</span></span> <span data-ttu-id="b712a-305">Zkuste to znovu, ale tentokrát záměrně použít nesprávnou e-mailovou adresu (viz obrázek 10).</span><span class="sxs-lookup"><span data-stu-id="b712a-305">Try it again, but this time purposefully use an incorrect email address (see Figure 10).</span></span> <span data-ttu-id="b712a-306">Nakonec se pomocí neexistujícího uživatelského jména pokuste použít jiný čas.</span><span class="sxs-lookup"><span data-stu-id="b712a-306">Finally, try it a third time using a non-existent username.</span></span> <span data-ttu-id="b712a-307">V prvním případě byste měli být úspěšně přihlášení k lokalitě, ale v posledních dvou případech byste měli vidět zprávu neplatných přihlašovacích údajů ovládacího prvku přihlašovací jméno.</span><span class="sxs-lookup"><span data-stu-id="b712a-307">In the first case you should be successfully logged on to the site, but in the last two cases you should see the Login control's invalid credentials message.</span></span>

<span data-ttu-id="b712a-308">[![Tito se nemůže přihlásit, když se zadává nesprávná e-mailová adresa.](validating-user-credentials-against-the-membership-user-store-cs/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-308">[![Tito Cannot Log In When Supplying an Incorrect Email Address](validating-user-credentials-against-the-membership-user-store-cs/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image28.png)</span></span>

<span data-ttu-id="b712a-309">**Obrázek 10**: Tito se nemůže přihlásit při zadání nesprávné e-mailové adresy ([kliknutím zobrazíte obrázek v plné velikosti).](validating-user-credentials-against-the-membership-user-store-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-309">**Figure 10**: Tito Cannot Log In When Supplying an Incorrect Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="b712a-310">Jak je popsáno v části jak rozhraní členství zpracovává neúspěšné pokusy o přihlášení v kroku 1, pokud `Membership.ValidateUser` je metoda volána a prošla neplatnými přihlašovacími údaji, sleduje Neplatný pokus o přihlášení a zamkne uživatele, pokud překročí určitou prahovou hodnotu neplatných pokusů v zadaném časovém intervalu.</span><span class="sxs-lookup"><span data-stu-id="b712a-310">As discussed in the How the Membership Framework Handles Invalid Login Attempts section in Step 1, when the `Membership.ValidateUser` method is called and passed invalid credentials, it keeps track of the invalid login attempt and locks out the user if they exceed a certain threshold of invalid attempts within a specified time window.</span></span> <span data-ttu-id="b712a-311">Vzhledem k tomu, že naše vlastní logika ověřování volá `ValidateUser` metodu, nesprávným heslem pro platné uživatelské jméno se zvýší neplatný čítač pokusů o přihlášení, ale tento čítač se nezvýší v případě, že uživatelské jméno a heslo jsou platné, ale e-mailová adresa není správná.</span><span class="sxs-lookup"><span data-stu-id="b712a-311">Since our custom authentication logic calls the `ValidateUser` method, an incorrect password for a valid username will increment the invalid login attempt counter, but this counter is not incremented in the case where the username and password are valid, but the email address is incorrect.</span></span> <span data-ttu-id="b712a-312">Důvodem je to, že toto chování je vhodné, protože je pravděpodobné, že hacker bude znát uživatelské jméno a heslo, ale musí použít techniky hrubou silou k určení e-mailové adresy uživatele.</span><span class="sxs-lookup"><span data-stu-id="b712a-312">Chances are, this behavior is suitable, since it's unlikely that a hacker will know the username and password, but have to use brute force techniques to determine the user's email address.</span></span>

## <a name="step-4-improving-the-login-controls-invalid-credentials-message"></a><span data-ttu-id="b712a-313">Krok 4: vylepšení zprávy s neplatnými přihlašovacími údaji ovládacího prvku pro přihlášení</span><span class="sxs-lookup"><span data-stu-id="b712a-313">Step 4: Improving the Login Control's Invalid Credentials Message</span></span>

<span data-ttu-id="b712a-314">Když se uživatel pokusí přihlásit pomocí neplatných přihlašovacích údajů, zobrazí ovládací prvek přihlášení zprávu s vysvětlením, že se pokus o přihlášení nezdařil.</span><span class="sxs-lookup"><span data-stu-id="b712a-314">When a user attempts to log on with invalid credentials, the Login control displays a message explaining that the login attempt was unsuccessful.</span></span> <span data-ttu-id="b712a-315">Konkrétně ovládací prvek zobrazuje zprávu určenou [ `FailureText` vlastností](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), která má výchozí hodnotu pokusu o přihlášení nebylo úspěšné.</span><span class="sxs-lookup"><span data-stu-id="b712a-315">In particular, the control displays the message specified by its [`FailureText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), which has a default value of Your login attempt was not successful.</span></span> <span data-ttu-id="b712a-316">Zkuste to prosím znovu.</span><span class="sxs-lookup"><span data-stu-id="b712a-316">Please try again.</span></span>

<span data-ttu-id="b712a-317">Odvolat, že existuje mnoho důvodů, proč přihlašovací údaje uživatele mohou být neplatné:</span><span class="sxs-lookup"><span data-stu-id="b712a-317">Recall that there are many reasons why a user's credentials may be invalid:</span></span>

- <span data-ttu-id="b712a-318">Uživatelské jméno možná neexistuje.</span><span class="sxs-lookup"><span data-stu-id="b712a-318">The username may not exist</span></span>
- <span data-ttu-id="b712a-319">Uživatelské jméno existuje, ale heslo je neplatné.</span><span class="sxs-lookup"><span data-stu-id="b712a-319">The username exists, but the password is invalid</span></span>
- <span data-ttu-id="b712a-320">Uživatelské jméno a heslo jsou platné, ale uživatel se ještě neschválil.</span><span class="sxs-lookup"><span data-stu-id="b712a-320">The username and password are valid, but the user is not yet approved</span></span>
- <span data-ttu-id="b712a-321">Uživatelské jméno a heslo jsou platné, ale uživatel je uzamčený (pravděpodobně proto, že překročil počet neplatných pokusů o přihlášení v rámci zadaného časového rámce).</span><span class="sxs-lookup"><span data-stu-id="b712a-321">The username and password are valid, but the user is locked out (most likely because they exceeded the number of invalid login attempts within the specified time frame)</span></span>

<span data-ttu-id="b712a-322">A při použití vlastní logiky ověřování mohou nastat jiné důvody.</span><span class="sxs-lookup"><span data-stu-id="b712a-322">And there may be other reasons when using custom authentication logic.</span></span> <span data-ttu-id="b712a-323">Například s kódem, který jsme napsali v kroku 3, může být uživatelské jméno a heslo platné, ale e-mailová adresa může být nesprávná.</span><span class="sxs-lookup"><span data-stu-id="b712a-323">For example, with the code we wrote in Step 3, the username and password may be valid, but the email address may be incorrect.</span></span>

<span data-ttu-id="b712a-324">Bez ohledu na to, proč jsou přihlašovací údaje neplatné, zobrazí ovládací prvek přihlášení stejnou chybovou zprávu.</span><span class="sxs-lookup"><span data-stu-id="b712a-324">Regardless of why the credentials are invalid, the Login control displays the same error message.</span></span> <span data-ttu-id="b712a-325">Tato nedostatečná zpětná vazba může být matoucí pro uživatele, jehož účet ještě nebyl schválen nebo byl uzamčen. I když máme trochu práci, můžeme ovládacímu prvku přihlášení zobrazit vhodnější zprávu.</span><span class="sxs-lookup"><span data-stu-id="b712a-325">This lack of feedback can be confusing for a user whose account has not yet been approved or who has been locked out. With a little bit of work, though, we can have the Login control display a more appropriate message.</span></span>

<span data-ttu-id="b712a-326">Pokaždé, když se uživatel pokusí přihlásit s neplatnými přihlašovacími údaji, vyvolá řízení přihlášení jeho `LoginError` událost.</span><span class="sxs-lookup"><span data-stu-id="b712a-326">Whenever a user attempts to login with invalid credentials the Login control raises its `LoginError` event.</span></span> <span data-ttu-id="b712a-327">Pokračujte a vytvořte obslužnou rutinu události pro tuto událost a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="b712a-327">Go ahead and create an event handler for this event, and add the following code:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample5.cs)]

<span data-ttu-id="b712a-328">Výše uvedený kód začíná nastavením vlastnosti přihlašovacího ovládacího prvku `FailureText` na výchozí hodnotu (váš pokus o přihlášení nebyl úspěšný.</span><span class="sxs-lookup"><span data-stu-id="b712a-328">The above code starts by setting the Login control's `FailureText` property to the default value ( Your login attempt was not successful.</span></span> <span data-ttu-id="b712a-329">Zkuste to prosím znovu.</span><span class="sxs-lookup"><span data-stu-id="b712a-329">Please try again ).</span></span> <span data-ttu-id="b712a-330">Pak zkontroluje, jestli je zadané uživatelské jméno namapováno na existující uživatelský účet.</span><span class="sxs-lookup"><span data-stu-id="b712a-330">It then checks to see if the username supplied maps to an existing user account.</span></span> <span data-ttu-id="b712a-331">V takovém případě se poraďte se výsledným `MembershipUser` objektem `IsLockedOut` a `IsApproved` vlastnostmi a určí, zda byl účet uzamčen nebo dosud nebyl schválen.</span><span class="sxs-lookup"><span data-stu-id="b712a-331">If so, it consults the resulting `MembershipUser` object's `IsLockedOut` and `IsApproved` properties to determine if the account has been locked out or has not yet been approved.</span></span> <span data-ttu-id="b712a-332">V obou případech `FailureText` je vlastnost aktualizována na odpovídající hodnotu.</span><span class="sxs-lookup"><span data-stu-id="b712a-332">In either case, the `FailureText` property is updated to a corresponding value.</span></span>

<span data-ttu-id="b712a-333">K otestování tohoto kódu se záměrně pokus o přihlášení jako stávající uživatel, ale použijte nesprávné heslo.</span><span class="sxs-lookup"><span data-stu-id="b712a-333">To test this code, purposefully attempt to log in as an existing user, but use an incorrect password.</span></span> <span data-ttu-id="b712a-334">Udělejte to pětkrát za řádek během 10 minut a účet se zablokuje. Jak ukazuje obrázek 11, následné pokusy o přihlášení vždy selžou (i se správným heslem), ale teď se zobrazí podrobnější popis, který váš účet byl uzamčen z důvodu příliš velkého počtu neplatných pokusů o přihlášení.</span><span class="sxs-lookup"><span data-stu-id="b712a-334">Do this five times in a row within a 10 minute time frame and the account will be locked out. As Figure 11 shows, subsequent login attempts will always fail (even with the correct password), but will now display the more descriptive Your account has been locked out because of too many invalid login attempts.</span></span> <span data-ttu-id="b712a-335">Kontaktujte prosím správce, aby se Váš účet odemkl.</span><span class="sxs-lookup"><span data-stu-id="b712a-335">Please contact the administrator to have your account unlocked message.</span></span>

<span data-ttu-id="b712a-336">[![Tito provedl příliš mnoho neplatných pokusů o přihlášení a byl uzamčen.](validating-user-credentials-against-the-membership-user-store-cs/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-336">[![Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out](validating-user-credentials-against-the-membership-user-store-cs/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image31.png)</span></span>

<span data-ttu-id="b712a-337">**Obrázek 11**: tito provedl příliš mnoho neplatných pokusů o přihlášení a byl uzamčen ([kliknutím zobrazíte obrázek v plné velikosti).](validating-user-credentials-against-the-membership-user-store-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="b712a-337">**Figure 11**: Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image33.png))</span></span>

## <a name="summary"></a><span data-ttu-id="b712a-338">Souhrn</span><span class="sxs-lookup"><span data-stu-id="b712a-338">Summary</span></span>

<span data-ttu-id="b712a-339">Před tímto kurzem přihlašovací stránka ověřila zadané přihlašovací údaje proti pevně zakódovanému seznamu párů uživatelských jmen a hesel.</span><span class="sxs-lookup"><span data-stu-id="b712a-339">Prior this tutorial, our login page validated the supplied credentials against a hard-coded list of username/password pairs.</span></span> <span data-ttu-id="b712a-340">V tomto kurzu jsme aktualizovali stránku, aby ověřila přihlašovací údaje proti členskému rozhraní.</span><span class="sxs-lookup"><span data-stu-id="b712a-340">In this tutorial, we updated the page to validate credentials against the Membership framework.</span></span> <span data-ttu-id="b712a-341">V kroku 1 jsme si vyhledali použití `Membership.ValidateUser` metody programově.</span><span class="sxs-lookup"><span data-stu-id="b712a-341">In Step 1 we looked at using the `Membership.ValidateUser` method programmatically.</span></span> <span data-ttu-id="b712a-342">V kroku 2 jsme nahradili naše ručně vytvořené uživatelské rozhraní a kód pomocí přihlašovacího ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="b712a-342">In Step 2 we replaced our manually created user interface and code with the Login control.</span></span>

<span data-ttu-id="b712a-343">Přihlašovací ovládací prvek vykreslí standardní přihlašovací uživatelské rozhraní a automaticky ověří přihlašovací údaje uživatele v rámci architektury členství.</span><span class="sxs-lookup"><span data-stu-id="b712a-343">The Login control renders a standard login user interface and automatically validates the user's credentials against the Membership framework.</span></span> <span data-ttu-id="b712a-344">V případě platných přihlašovacích údajů navíc přihlašovací ovládací prvek podepisuje uživatele prostřednictvím ověřování pomocí formulářů.</span><span class="sxs-lookup"><span data-stu-id="b712a-344">Moreover, in the event of valid credentials, the Login control signs the user in via forms authentication.</span></span> <span data-ttu-id="b712a-345">V krátkém případě je k dispozici plně funkční uživatelské prostředí přihlášení pouhým přetažením ovládacího prvku pro přihlášení na stránku bez nutnosti dalšího deklarativního kódu.</span><span class="sxs-lookup"><span data-stu-id="b712a-345">In short, a fully functional login user experience is available by simply dragging the Login control onto a page, no extra declarative markup or code necessary.</span></span> <span data-ttu-id="b712a-346">A co více, ovládací prvek přihlašování je vysoce přizpůsobitelný, což umožňuje jemný stupeň kontroly nad vykresleným uživatelským rozhraním a logikou ověřování.</span><span class="sxs-lookup"><span data-stu-id="b712a-346">What's more, the Login control is highly customizable, allowing for a fine degree of control over both the rendered user interface and authentication logic.</span></span>

<span data-ttu-id="b712a-347">V tomto okamžiku můžou Návštěvníci na našem webu vytvořit nový uživatelský účet a přihlásit se k webu, ale ještě jsme si vyhledali omezení přístupu k stránkám na základě ověřeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="b712a-347">At this point visitors to our website can create a new user account and log into the site, but we have yet to look at restricting access to pages based on the authenticated user.</span></span> <span data-ttu-id="b712a-348">V současné době může libovolný uživatel, ověřený nebo anonymní zobrazit jakoukoli stránku na našem webu.</span><span class="sxs-lookup"><span data-stu-id="b712a-348">Currently, any user, authenticated or anonymous, can view any page on our site.</span></span> <span data-ttu-id="b712a-349">Společně s řízením přístupu na stránky našeho webu na základě uživatele můžeme mít určité stránky, jejichž funkce závisí na uživateli.</span><span class="sxs-lookup"><span data-stu-id="b712a-349">Along with controlling access to our site's pages on a user-by-user basis, we might have certain pages whose functionality depends on the user.</span></span> <span data-ttu-id="b712a-350">V dalším kurzu se podíváme na to, jak omezit přístup a funkce na stránce na základě přihlášeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="b712a-350">The next tutorial looks at how to limit access and in-page functionality based on the logged in user.</span></span>

<span data-ttu-id="b712a-351">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="b712a-351">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="b712a-352">Další materiály</span><span class="sxs-lookup"><span data-stu-id="b712a-352">Further Reading</span></span>

<span data-ttu-id="b712a-353">Další informace o tématech popsaných v tomto kurzu najdete v následujících zdrojích informací:</span><span class="sxs-lookup"><span data-stu-id="b712a-353">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="b712a-354">Zobrazení vlastních zpráv pro zamčené a neschválené uživatele</span><span class="sxs-lookup"><span data-stu-id="b712a-354">Displaying Custom Messages to Locked Out and Non-Approved Users</span></span>](http://aspnet.4guysfromrolla.com/articles/050306-1.aspx)
- [<span data-ttu-id="b712a-355">Zkoumání členství, rolí a profilů v ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="b712a-355">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="b712a-356">Postupy: vytvoření přihlašovací stránky ASP.NET</span><span class="sxs-lookup"><span data-stu-id="b712a-356">How To: Create an ASP.NET Login Page</span></span>](https://msdn.microsoft.com/library/ms178331.aspx)
- [<span data-ttu-id="b712a-357">Technická dokumentace k řízení přihlašování</span><span class="sxs-lookup"><span data-stu-id="b712a-357">Login Control Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)
- [<span data-ttu-id="b712a-358">Používání ovládacích prvků přihlášení</span><span class="sxs-lookup"><span data-stu-id="b712a-358">Using the Login Controls</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/login.aspx)

### <a name="about-the-author"></a><span data-ttu-id="b712a-359">O autorovi</span><span class="sxs-lookup"><span data-stu-id="b712a-359">About the Author</span></span>

<span data-ttu-id="b712a-360">Scott Mitchell, autor několika stránek ASP/ASP. NET Books a zakladatel of 4GuysFromRolla.com, pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="b712a-360">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b712a-361">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="b712a-361">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b712a-362">Nejnovější kniha je *[Sams naučit se ASP.NET 2,0 za 24 hodin](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="b712a-362">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="b712a-363">Scott se dá kontaktovat na [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) blogu nebo přes jeho blog na adrese [http://ScottOnWriting.NET](http://scottonwriting.net/) .</span><span class="sxs-lookup"><span data-stu-id="b712a-363">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="b712a-364">Zvláštní díky</span><span class="sxs-lookup"><span data-stu-id="b712a-364">Special Thanks To</span></span>

<span data-ttu-id="b712a-365">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="b712a-365">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b712a-366">Kontroloři vedoucích k tomuto kurzu byli Teresa Murphy a Michael Olivero.</span><span class="sxs-lookup"><span data-stu-id="b712a-366">Lead reviewers for this tutorial were Teresa Murphy and Michael Olivero.</span></span> <span data-ttu-id="b712a-367">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="b712a-367">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b712a-368">Pokud ano, umístěte mi čáru na [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com) .</span><span class="sxs-lookup"><span data-stu-id="b712a-368">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b712a-369">[Předchozí](creating-user-accounts-cs.md) 
>  [Další](user-based-authorization-cs.md)</span><span class="sxs-lookup"><span data-stu-id="b712a-369">[Previous](creating-user-accounts-cs.md)
[Next](user-based-authorization-cs.md)</span></span>
