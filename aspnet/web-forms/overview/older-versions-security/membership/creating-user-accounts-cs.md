---
uid: web-forms/overview/older-versions-security/membership/creating-user-accounts-cs
title: Vytváření uživatelských účtů (C#) | Microsoft Docs
author: rick-anderson
description: V tomto kurzu se podíváme na použití rozhraní členství (přes SqlMembershipProvider) k vytvoření nových uživatelských účtů. Uvidíme, jak vytvořit nové...
ms.author: riande
ms.date: 01/18/2008
ms.assetid: f175278c-6079-4d91-b9b4-2493ed43d9ec
msc.legacyurl: /web-forms/overview/older-versions-security/membership/creating-user-accounts-cs
msc.type: authoredcontent
ms.openlocfilehash: 955592320e7d36c7ae3b9c03a361bee2183f1776
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78631976"
---
# <a name="creating-user-accounts-c"></a><span data-ttu-id="b9c0a-104">Vytváření uživatelských účtů (C#)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-104">Creating User Accounts (C#)</span></span>

<span data-ttu-id="b9c0a-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b9c0a-106">[Stažení kódu](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_CS.zip) nebo [stažení PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-106">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_CS.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_cs.pdf)</span></span>

> <span data-ttu-id="b9c0a-107">V tomto kurzu se podíváme na použití rozhraní členství (přes SqlMembershipProvider) k vytvoření nových uživatelských účtů.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-107">In this tutorial we will explore using the Membership framework (via the SqlMembershipProvider) to create new user accounts.</span></span> <span data-ttu-id="b9c0a-108">Uvidíme, jak vytvořit nové uživatele programově a prostřednictvím ASP. Zabudovaný ovládacím CreateUserWizard ovládací prvek sítě.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-108">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>

## <a name="introduction"></a><span data-ttu-id="b9c0a-109">Úvod</span><span class="sxs-lookup"><span data-stu-id="b9c0a-109">Introduction</span></span>

<span data-ttu-id="b9c0a-110"><a id="_msoanchor_1"> </a>V [předchozím kurzu](creating-the-membership-schema-in-sql-server-cs.md) jsme nainstalovali schéma služby Application Services do databáze, která přidala tabulky, zobrazení a uložené procedury vyžadované `SqlMembershipProvider` a `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-110">In the <a id="_msoanchor_1"></a>[preceding tutorial](creating-the-membership-schema-in-sql-server-cs.md) we installed the application services schema in a database, which added the tables, views, and stored procedures needed by the `SqlMembershipProvider` and `SqlRoleProvider`.</span></span> <span data-ttu-id="b9c0a-111">Tím se vytvoří infrastruktura, kterou budeme potřebovat pro zbývající kurzy v této sérii.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-111">This created the infrastructure we will need for the remainder of the tutorials in this series.</span></span> <span data-ttu-id="b9c0a-112">V tomto kurzu se podíváme na použití rozhraní členství (prostřednictvím `SqlMembershipProvider`) k vytvoření nových uživatelských účtů.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-112">In this tutorial we will explore using the Membership framework (via the `SqlMembershipProvider`) to create new user accounts.</span></span> <span data-ttu-id="b9c0a-113">Uvidíme, jak vytvořit nové uživatele programově a prostřednictvím ASP. Zabudovaný ovládacím CreateUserWizard ovládací prvek sítě.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-113">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>

<span data-ttu-id="b9c0a-114">Kromě toho, jak se naučíte vytvářet nové uživatelské účty, budeme také muset aktualizovat ukázkový web, který jsme vytvořili poprvé v  *<a id="_msoanchor_2">[ ](../introduction/an-overview-of-forms-authentication-cs.md)</a>kurzu Přehled ověřování prostřednictvím formulářů* , a pak ho rozšířit v kurzu  *<a id="https://www.asp.net/learn/security/tutorial-03-cs.aspx"></a> konfigurace ověřování formulářů a Pokročilá témata* .</span><span class="sxs-lookup"><span data-stu-id="b9c0a-114">In addition to learning how to create new user accounts, we will also need to update the demo website we first created in the *<a id="_msoanchor_2"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-cs.md)* tutorial and then enhanced in the *<a id="https://www.asp.net/learn/security/tutorial-03-cs.aspx"></a> Forms Authentication Configuration and Advanced Topics* tutorial.</span></span> <span data-ttu-id="b9c0a-115">Naše Ukázková webová aplikace má přihlašovací stránku, která ověřuje přihlašovací údaje uživatelů proti pevně zakódované dvojici uživatelského jména a hesla.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-115">Our demo web application has a login page that validates users' credentials against hard-coded username/password pairs.</span></span> <span data-ttu-id="b9c0a-116">Kromě toho `Global.asax` obsahuje kód, který vytváří vlastní `IPrincipal` a objekty `IIdentity` pro ověřené uživatele.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-116">Moreover, `Global.asax` includes code that creates custom `IPrincipal` and `IIdentity` objects for authenticated users.</span></span> <span data-ttu-id="b9c0a-117">Aktualizujeme přihlašovací stránku, aby ověřovala přihlašovací údaje uživatelů vůči rozhraní členství a odebrala vlastní objekt zabezpečení a logiku identity.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-117">We will update the login page to validate users' credentials against the Membership framework and remove the custom principal and identity logic.</span></span>

<span data-ttu-id="b9c0a-118">Pojďme začít!</span><span class="sxs-lookup"><span data-stu-id="b9c0a-118">Let's get started!</span></span>

## <a name="the-forms-authentication-and-membership-checklist"></a><span data-ttu-id="b9c0a-119">Ověřování formulářů a kontrolní seznam členství</span><span class="sxs-lookup"><span data-stu-id="b9c0a-119">The Forms Authentication and Membership Checklist</span></span>

<span data-ttu-id="b9c0a-120">Než začneme s rozhraním pro členství začít pracovat, Podívejme se, abychom si prohlédli důležité kroky, které jsme provedli pro dosažení tohoto bodu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-120">Before we begin working with the Membership framework, let's take a moment to review the important steps we have taken to reach this point.</span></span> <span data-ttu-id="b9c0a-121">Při použití architektury členství v `SqlMembershipProvider` ve scénáři ověřování založeném na formulářích, je nutné provést následující kroky před implementací funkce členství ve webové aplikaci:</span><span class="sxs-lookup"><span data-stu-id="b9c0a-121">When using the Membership framework with the `SqlMembershipProvider` in a forms-based authentication scenario, the following steps need to be performed prior to implementing Membership functionality in your web application:</span></span>

1. <span data-ttu-id="b9c0a-122">**Povolte ověřování pomocí formulářů.**</span><span class="sxs-lookup"><span data-stu-id="b9c0a-122">**Enable forms-based authentication.**</span></span> <span data-ttu-id="b9c0a-123">Jak jsme probrali v  *<a id="_msoanchor_4">[ ](../introduction/an-overview-of-forms-authentication-cs.md)</a>přehledu ověřování pomocí formulářů*, ověřování pomocí formulářů je povolené úpravou `Web.config` a nastavením atributu `mode` elementu `<authentication>` na `Forms`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-123">As we discussed in *<a id="_msoanchor_4"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-cs.md)*, forms authentication is enabled by editing `Web.config` and setting the `<authentication>` element's `mode` attribute to `Forms`.</span></span> <span data-ttu-id="b9c0a-124">Když je povoleno ověřování pomocí formulářů, je každý příchozí požadavek prověřen pro *lístek ověřování pomocí formulářů*, který Pokud je přítomen, identifikuje žadatele.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-124">With forms authentication enabled, each incoming request is examined for a *forms authentication ticket*, which, if present, identifies the requestor.</span></span>
2. <span data-ttu-id="b9c0a-125">**Přidejte schéma služby Application Services do příslušné databáze.**</span><span class="sxs-lookup"><span data-stu-id="b9c0a-125">**Add the application services schema to the appropriate database.**</span></span> <span data-ttu-id="b9c0a-126">Při použití `SqlMembershipProvider` potřebujeme nainstalovat schéma služby Application Services do databáze.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-126">When using the `SqlMembershipProvider` we need to install the application services schema to a database.</span></span> <span data-ttu-id="b9c0a-127">Toto schéma je obvykle přidáno do stejné databáze, která obsahuje datový model aplikace.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-127">Usually this schema is added to the same database that holds the application's data model.</span></span> <span data-ttu-id="b9c0a-128">*Vytvoření schématu členství v SQL Server kurzu, které jste prohlédli pomocí nástroje `aspnet_regsql.exe` k tomuto účelu. <a id="_msoanchor_5">[ ](creating-the-membership-schema-in-sql-server-cs.md)</a>*</span><span class="sxs-lookup"><span data-stu-id="b9c0a-128">The *<a id="_msoanchor_5"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* tutorial looked at using the `aspnet_regsql.exe` tool to accomplish this.</span></span>
3. <span data-ttu-id="b9c0a-129">**Upravte nastavení webové aplikace tak, aby odkazovalo na databázi z kroku 2.**</span><span class="sxs-lookup"><span data-stu-id="b9c0a-129">**Customize the Web Application's Settings to reference the database from step 2.**</span></span> <span data-ttu-id="b9c0a-130">*Vytvoření schématu členství v SQL Server* kurzu ukázalo dva způsoby, jak nakonfigurovat webovou aplikaci tak, aby `SqlMembershipProvider` používala databázi vybranou v kroku 2: úpravou `LocalSqlServer` název připojovacího řetězce; nebo přidáním nového registrovaného poskytovatele do seznamu zprostředkovatelů rozhraní pro členství a přizpůsobením tohoto nového poskytovatele pro použití databáze z kroku 2.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-130">The *Creating the Membership Schema in SQL Server* tutorial showed two ways to configure the web application so that the `SqlMembershipProvider` would use the database selected in step 2: by modifying the `LocalSqlServer` connection string name; or by adding a new registered provider to the list of Membership framework providers and customizing that new provider to use the database from step 2.</span></span>

<span data-ttu-id="b9c0a-131">Při sestavování webové aplikace, která používá ověřování pomocí `SqlMembershipProvider` a formulářů, je nutné provést tyto tři kroky předtím, než použijete třídu `Membership` nebo webové ovládací prvky přihlášení ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-131">When building a web application that uses the `SqlMembershipProvider` and forms-based authentication, you will need to perform these three steps before using the `Membership` class or the ASP.NET Login Web controls.</span></span> <span data-ttu-id="b9c0a-132">Vzhledem k tomu, že jsme už provedli tyto kroky v předchozích kurzech, jsme připraveni začít používat rámec členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-132">Since we already performed these steps in previous tutorials, we are ready to start using the Membership framework!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="b9c0a-133">Krok 1: přidání nových stránek ASP.NET</span><span class="sxs-lookup"><span data-stu-id="b9c0a-133">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="b9c0a-134">V tomto kurzu a dalších třech prozkoumáme různé funkce a možnosti související s členstvím.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-134">In this tutorial and the next three we will be examining various Membership-related functions and capabilities.</span></span> <span data-ttu-id="b9c0a-135">K implementaci témat prověřených v rámci těchto kurzů budeme potřebovat řadu ASP.NET stránek.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-135">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="b9c0a-136">Pojďme vytvořit tyto stránky a potom soubor mapy webu `(Web.sitemap)`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-136">Let's create those pages and then a site map file `(Web.sitemap)`.</span></span>

<span data-ttu-id="b9c0a-137">Začněte vytvořením nové složky v projektu s názvem `Membership`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-137">Start by creating a new folder in the project named `Membership`.</span></span> <span data-ttu-id="b9c0a-138">Dále přidejte pět nových ASP.NET stránek do složky `Membership` a propojíte jednotlivé stránky pomocí `Site.master` stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-138">Next, add five new ASP.NET pages to the `Membership` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="b9c0a-139">Pojmenujte stránky:</span><span class="sxs-lookup"><span data-stu-id="b9c0a-139">Name the pages:</span></span>

- `CreatingUserAccounts.aspx`
- `UserBasedAuthorization.aspx`
- `EnhancedCreateUserWizard.aspx`
- `AdditionalUserInfo.aspx`
- `Guestbook.aspx`

<span data-ttu-id="b9c0a-140">V tomto okamžiku by Průzkumník řešení projektu vypadala podobně jako snímek obrazovky, který ukazuje obrázek 1.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>

<span data-ttu-id="b9c0a-141">[do složky členství bylo přidáno ![pět nových stránek.](creating-user-accounts-cs/_static/image2.png)](creating-user-accounts-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-141">[![Five New Pages Have Been Added to the Membership Folder](creating-user-accounts-cs/_static/image2.png)](creating-user-accounts-cs/_static/image1.png)</span></span>

<span data-ttu-id="b9c0a-142">**Obrázek 1**: do složky `Membership` bylo přidáno pět nových stránek ([kliknutím zobrazíte obrázek v plné velikosti).](creating-user-accounts-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-142">**Figure 1**: Five New Pages Have Been Added to the `Membership` Folder  ([Click to view full-size image](creating-user-accounts-cs/_static/image3.png))</span></span>

<span data-ttu-id="b9c0a-143">Každá stránka by měla v tomto okamžiku obsahovat dva ovládací prvky obsahu, jednu pro každý prvek prvků hlavní stránky: `MainContent` a `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-143">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample1.aspx)]

<span data-ttu-id="b9c0a-144">Odvolat, že výchozí kód `LoginContent` ContentPlaceHolder zobrazuje odkaz na přihlášení nebo odhlášení od webu v závislosti na tom, jestli je uživatel ověřený.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-144">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="b9c0a-145">Přítomnost ovládacího prvku `Content2` obsahu však přepisuje výchozí značku stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-145">The presence of the `Content2` Content control, however, overrides the master page's default markup.</span></span> <span data-ttu-id="b9c0a-146">Jak jsme probrali v  *<a id="_msoanchor_6">[ ](../introduction/an-overview-of-forms-authentication-cs.md)</a>kurzu Přehled ověřování* založeného na formulářích, to je užitečné na stránkách, kde nechcete zobrazovat možnosti související s přihlášením v levém sloupci.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-146">As we discussed in *<a id="_msoanchor_6"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-cs.md)* tutorial, this is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="b9c0a-147">Pro tyto pět stran ale chceme pro `LoginContent` ContentPlaceHolder zobrazit výchozí označení stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-147">For these five pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="b9c0a-148">Proto odeberte deklarativní označení pro ovládací prvek obsahu `Content2`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-148">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="b9c0a-149">Po tom by každý z pěti značek stránky měl obsahovat pouze jeden ovládací prvek obsahu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-149">After doing so, each of the five page's markup should contain just one Content control.</span></span>

## <a name="step-2-creating-the-site-map"></a><span data-ttu-id="b9c0a-150">Krok 2: vytvoření mapy webu</span><span class="sxs-lookup"><span data-stu-id="b9c0a-150">Step 2: Creating the Site Map</span></span>

<span data-ttu-id="b9c0a-151">Všechny kromě triviálních webů potřebují implementovat nějaký formulář pro navigační uživatelské rozhraní.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-151">All but the most trivial websites need to implement some form of a navigational user interface.</span></span> <span data-ttu-id="b9c0a-152">Navigační uživatelské rozhraní může být jednoduchý seznam odkazů na různé části webu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-152">The navigation user interface may be a simple list of links to the various sections of the site.</span></span> <span data-ttu-id="b9c0a-153">Alternativně mohou být tyto odkazy uspořádány do nabídek nebo zobrazení stromové struktury.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-153">Alternatively, these links may be arranged into menus or tree views.</span></span> <span data-ttu-id="b9c0a-154">Jako vývojáři stránky tvoří navigační uživatelské rozhraní pouze polovinu tohoto článku.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-154">As page developers, creating the navigational user interface is only half of the story.</span></span> <span data-ttu-id="b9c0a-155">Pro definování logických struktur webu potřebujeme taky nějaký způsob, který lze udržovat udržovatelně a aktualizovatelný způsobem.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-155">We also need some means to define the site's logical structure in a maintainable and updateable fashion.</span></span> <span data-ttu-id="b9c0a-156">Když se přidají nové stránky nebo odeberou stávající stránky, chceme mít schopnost aktualizovat jeden zdroj – mapu webu a tyto změny se projeví v navigačním uživatelském rozhraní lokality.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-156">As new pages are added or existing pages removed, we want to be able to update a single source – the site map – and have those modifications reflected across the site's navigational user interface.</span></span>

<span data-ttu-id="b9c0a-157">Tyto dvě úlohy – definice mapy lokality a implementace navigačního uživatelského rozhraní založeného na mapě webu – je snadné dosáhnout v důsledku rozhraní mapy webu a webových ovládacích prvků navigace přidaných v ASP.NET verze 2,0.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-157">These two tasks – defining the site map and implementing a navigational user interface based on the site map – are easy to accomplish thanks to the Site Map framework and the Navigation Web controls added in ASP.NET version 2.0.</span></span> <span data-ttu-id="b9c0a-158">Rozhraní mapy webu umožňuje vývojářům definovat mapu webu a následně k nim přistupovat prostřednictvím programového rozhraní API ( [`SiteMap` třídy](https://msdn.microsoft.com/library/system.web.sitemap.aspx)).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-158">The Site Map framework allows for a developer to define a site map and then to access it through a programmatic API (the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx)).</span></span> <span data-ttu-id="b9c0a-159">Vestavěné navigační webové ovládací prvky obsahují [ovládací prvek nabídky](https://msdn.microsoft.com/library/bz09dy46.aspx), [ovládací prvek TreeView](https://msdn.microsoft.com/library/3eafky27.aspx)a [ovládací prvek SiteMapPath](https://msdn.microsoft.com/library/3eafky27.aspx).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-159">The built-in Navigation Web controls include a [Menu control](https://msdn.microsoft.com/library/bz09dy46.aspx), the [TreeView control](https://msdn.microsoft.com/library/3eafky27.aspx), and the [SiteMapPath control](https://msdn.microsoft.com/library/3eafky27.aspx).</span></span>

<span data-ttu-id="b9c0a-160">Podobně jako v případě členství a rolí jsou rozhraní mapy webu sestavena základem [modelem poskytovatele](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-160">Like the Membership and Roles frameworks, the Site Map framework is built atop the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx).</span></span> <span data-ttu-id="b9c0a-161">Úkolem třídy poskytovatele mapy webu je vygenerovat strukturu v paměti, kterou používá `SiteMap` třídy z trvalého úložiště dat, jako je například soubor XML nebo databázová tabulka.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-161">The job of the Site Map provider class is to generate the in-memory structure used by the `SiteMap` class from a persistent data store, such as an XML file or a database table.</span></span> <span data-ttu-id="b9c0a-162">.NET Framework se dodává s výchozím poskytovatelem mapy webu, který čte data mapy webu ze souboru XML ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)) a toto je zprostředkovatel, který v tomto kurzu použijeme.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-162">The .NET Framework ships with a default Site Map provider that reads the site map data from an XML file ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)), and this is the provider we will be using in this tutorial.</span></span> <span data-ttu-id="b9c0a-163">U některých alternativních implementací poskytovatele mapy webu najdete další části věnované čtení na konci tohoto kurzu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-163">For some alternate Site Map provider implementations, refer to the Further Readings section at the end of this tutorial.</span></span>

<span data-ttu-id="b9c0a-164">Výchozí zprostředkovatel mapy webu očekává v kořenovém adresáři správně formátovaný soubor XML s názvem `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-164">The default Site Map provider expects a properly-formatted XML file named `Web.sitemap` to exist the root directory.</span></span> <span data-ttu-id="b9c0a-165">Vzhledem k tomu, že používáme tohoto výchozího zprostředkovatele, musíme tento soubor přidat a definovat strukturu mapy webu v příslušném formátu XML.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-165">Since we are using this default provider, we need to add such a file and define the site map's structure in the appropriate XML format.</span></span> <span data-ttu-id="b9c0a-166">Chcete-li přidat soubor, klikněte pravým tlačítkem myši na název projektu v Průzkumník řešení a vyberte možnost Přidat novou položku.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-166">To add the file, right-click on the project name in Solution Explorer and choose Add New Item.</span></span> <span data-ttu-id="b9c0a-167">Z dialogového okna se můžete rozhodnout přidat soubor typu mapa webu s názvem `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-167">From the dialog box, opt to add a file of type Site Map named `Web.sitemap`.</span></span>

<span data-ttu-id="b9c0a-168">[![přidat soubor s názvem Web. sitemap do kořenového adresáře projektu](creating-user-accounts-cs/_static/image5.png)](creating-user-accounts-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-168">[![Add a File Named Web.sitemap to the Project's Root Directory](creating-user-accounts-cs/_static/image5.png)](creating-user-accounts-cs/_static/image4.png)</span></span>

<span data-ttu-id="b9c0a-169">**Obrázek 2**: přidejte soubor s názvem `Web.sitemap` do kořenového adresáře projektu ([kliknutím zobrazíte obrázek v plné velikosti).](creating-user-accounts-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-169">**Figure 2**: Add a File Named `Web.sitemap` to the Project's Root Directory  ([Click to view full-size image](creating-user-accounts-cs/_static/image6.png))</span></span>

<span data-ttu-id="b9c0a-170">Soubor mapování webu XML definuje strukturu webu jako hierarchii.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-170">The XML site map file defines the website's structure as a hierarchy.</span></span> <span data-ttu-id="b9c0a-171">Tento hierarchický vztah je modelován v souboru XML pomocí původ prvků `<siteMapNode>`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-171">This hierarchical relationship is modeled in the XML file via the ancestry of the `<siteMapNode>` elements.</span></span> <span data-ttu-id="b9c0a-172">`Web.sitemap` musí začínat `<siteMap>` nadřazeným uzlem, který má přesně jednu `<siteMapNode>` podřízenou položku.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-172">The `Web.sitemap` must start with a `<siteMap>` parent node that has precisely one `<siteMapNode>` child.</span></span> <span data-ttu-id="b9c0a-173">Tento element `<siteMapNode>` nejvyšší úrovně představuje kořen hierarchie a může mít libovolný počet podřízených uzlů.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-173">This top-level `<siteMapNode>` element represents the root of the hierarchy, and may have an arbitrary number of descendent nodes.</span></span> <span data-ttu-id="b9c0a-174">Každý prvek `<siteMapNode>` musí zahrnovat atribut `title` a může volitelně zahrnovat atributy `url` a `description`, a to mimo jiné. Každý neprázdný `url` atribut musí být jedinečný.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-174">Each `<siteMapNode>` element must include a `title` attribute and may optionally include `url` and `description` attributes, among others; each non-empty `url` attribute must be unique.</span></span>

<span data-ttu-id="b9c0a-175">Do souboru `Web.sitemap` zadejte následující kód XML:</span><span class="sxs-lookup"><span data-stu-id="b9c0a-175">Enter the following XML into the `Web.sitemap` file:</span></span>

[!code-xml[Main](creating-user-accounts-cs/samples/sample2.xml)]

<span data-ttu-id="b9c0a-176">Výše uvedené označení mapy webu definuje hierarchii zobrazenou na obrázku 3.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-176">The above site map markup defines the hierarchy shown in Figure 3.</span></span>

<span data-ttu-id="b9c0a-177">[![mapa webu představuje hierarchickou navigační strukturu.](creating-user-accounts-cs/_static/image8.png)](creating-user-accounts-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-177">[![The Site Map Represents a Hierarchical Navigational Structure](creating-user-accounts-cs/_static/image8.png)](creating-user-accounts-cs/_static/image7.png)</span></span>

<span data-ttu-id="b9c0a-178">**Obrázek 3**: Mapa webu představuje hierarchickou navigační strukturu ([kliknutím zobrazíte obrázek v plné velikosti).](creating-user-accounts-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-178">**Figure 3**: The Site Map Represents a Hierarchical Navigational Structure  ([Click to view full-size image](creating-user-accounts-cs/_static/image9.png))</span></span>

## <a name="step-3-updating-the-master-page-to-include-a-navigational-user-interface"></a><span data-ttu-id="b9c0a-179">Krok 3: aktualizace stránky předlohy tak, aby zahrnovala navigační uživatelské rozhraní</span><span class="sxs-lookup"><span data-stu-id="b9c0a-179">Step 3: Updating the Master Page to Include a Navigational User Interface</span></span>

<span data-ttu-id="b9c0a-180">ASP.NET zahrnuje řadu webových ovládacích prvků souvisejících s navigací pro návrh uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-180">ASP.NET includes a number of navigation-related Web controls for designing a user interface.</span></span> <span data-ttu-id="b9c0a-181">Mezi ně patří nabídka, TreeView a ovládací prvky SiteMapPath.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-181">These include the Menu, TreeView, and the SiteMapPath controls.</span></span> <span data-ttu-id="b9c0a-182">Ovládací prvky menu a TreeView vykreslují strukturu mapy webu v nabídce nebo stromu, v uvedeném pořadí, zatímco SiteMapPath zobrazí popis cesty, který ukazuje navštívený aktuální uzel i jeho předchůdce.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-182">The Menu and TreeView controls render the site map structure in a menu or a tree, respectively, whereas the SiteMapPath displays a breadcrumb that shows the current node being visited as well as its ancestors.</span></span> <span data-ttu-id="b9c0a-183">Data mapy webu mohou být svázána s jinými datovými ovládacími prvky dat pomocí ovládacího prvku SiteMapDataSource a lze k němu přistupovat programově prostřednictvím třídy `SiteMap`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-183">The site map data can be bound to other data Web controls using the SiteMapDataSource and can be accessed programmatically via the `SiteMap` class.</span></span>

<span data-ttu-id="b9c0a-184">Vzhledem k tomu, že důkladná diskuze nad rámec architektury mapy webu a navigační ovládací prvky přesahují rozsah této série kurzů, nemusíte místo útraty vytvořit vlastní navigační rozhraní pro navigaci, které se používá v *[rámci práce s daty v řadě kurzů ASP.NET 2,0](../../data-access/index.md)* , která používá ovládací prvek Repeater k zobrazení seznamu odkazů s odrážkami, jak je znázorněno na obrázku 4.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-184">Since a thorough discussion of the Site Map framework and the Navigation controls is beyond the scope of this tutorial series, rather than spend time crafting our own navigational user interface let's instead borrow the one used in my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series, which uses a Repeater control to display a two-deep bulleted list of navigation links, as shown in Figure 4.</span></span>

### <a name="adding-a-two-level-list-of-links-in-the-left-column"></a><span data-ttu-id="b9c0a-185">Přidání seznamu odkazů ze dvou úrovní do levého sloupce</span><span class="sxs-lookup"><span data-stu-id="b9c0a-185">Adding a Two-Level List of Links in the Left Column</span></span>

<span data-ttu-id="b9c0a-186">Chcete-li vytvořit toto rozhraní, přidejte následující deklarativní označení do levého sloupce `Site.master` hlavní stránky, kde text "TODO: menu" bude jít... " v současné době se nachází.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-186">To create this interface, add the following declarative markup to the `Site.master` master page's left column where the text "TODO: Menu will go here..." currently resides.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample3.aspx)]

<span data-ttu-id="b9c0a-187">Výše uvedený kód váže ovládací prvek Repeater s názvem `menu` k prvku SiteMapDataSource, který vrací hierarchii mapy webu definovanou v `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-187">The above markup binds a Repeater control named `menu` to a SiteMapDataSource, which returns the site map hierarchy defined in `Web.sitemap`.</span></span> <span data-ttu-id="b9c0a-188">Vzhledem k tomu, že [vlastnost`ShowStartingNode`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) ovládacího prvku SiteMapDataSource je nastavená na hodnotu false, začne vracet hierarchii mapy lokality počínaje podřízenými uzly domovského uzlu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-188">Since the SiteMapDataSource control's [`ShowStartingNode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) is set to False it starts returning the site map's hierarchy starting with the descendents of the "Home" node.</span></span> <span data-ttu-id="b9c0a-189">Repeater zobrazí každý z těchto uzlů (v současné době pouze "členství") v elementu `<li>`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-189">The Repeater displays each of these nodes (currently just "Membership") in an `<li>` element.</span></span> <span data-ttu-id="b9c0a-190">Další vnitřní opakovač pak zobrazí podřízené objekty aktuálního uzlu ve vnořeném neuspořádaném seznamu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-190">Another, inner Repeater then displays the current node's children in a nested unordered list.</span></span>

<span data-ttu-id="b9c0a-191">Obrázek 4 znázorňuje Vykreslený výstup výše uvedeného kódu se strukturou mapy webu, kterou jsme vytvořili v kroku 2.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-191">Figure 4 shows the above markup's rendered output with the site map structure we created in Step 2.</span></span> <span data-ttu-id="b9c0a-192">Repeater vykresluje Vanilla neuspořádaný seznam značek. pro rozložení aesthetically-přitažlivé jsou odpovědni pravidla šablony kaskádových stylů definovaná v `Styles.css`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-192">The Repeater renders vanilla unordered list markup; the cascading style sheet rules defined in `Styles.css` are responsible for the aesthetically-pleasing layout.</span></span> <span data-ttu-id="b9c0a-193">Podrobnější popis toho, jak výše uvedený kód funguje, najdete v kurzu [hlavní stránky a navigace na webu](https://asp.net/learn/data-access/tutorial-03-cs.aspx) .</span><span class="sxs-lookup"><span data-stu-id="b9c0a-193">For a more detailed description of how the above markup works, refer to the [Master Pages and Site Navigation](https://asp.net/learn/data-access/tutorial-03-cs.aspx) tutorial.</span></span>

<span data-ttu-id="b9c0a-194">[![se navigační uživatelské rozhraní vykresluje pomocí vnořených neuspořádaných seznamů.](creating-user-accounts-cs/_static/image11.png)](creating-user-accounts-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-194">[![The Navigational User Interface is Rendered Using Nested Unordered Lists](creating-user-accounts-cs/_static/image11.png)](creating-user-accounts-cs/_static/image10.png)</span></span>

<span data-ttu-id="b9c0a-195">**Obrázek 4**: navigační uživatelské rozhraní se vykresluje pomocí vnořených neuspořádaných seznamů ([kliknutím zobrazíte obrázek v plné velikosti).](creating-user-accounts-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-195">**Figure 4**: The Navigational User Interface is Rendered Using Nested Unordered Lists  ([Click to view full-size image](creating-user-accounts-cs/_static/image12.png))</span></span>

### <a name="adding-breadcrumb-navigation"></a><span data-ttu-id="b9c0a-196">Přidávání navigace s popisem cesty</span><span class="sxs-lookup"><span data-stu-id="b9c0a-196">Adding Breadcrumb Navigation</span></span>

<span data-ttu-id="b9c0a-197">Kromě seznamu odkazů v levém sloupci máme také každou stránku, kde se zobrazí [Popis cesty](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-197">In addition to the list of links in the left column, let's also have each page display a [breadcrumb](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29).</span></span> <span data-ttu-id="b9c0a-198">Navigace s popisem cesty je navigační prvek uživatelského rozhraní, který rychle zobrazuje uživatele na aktuální pozici v rámci hierarchie lokality.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-198">A breadcrumb is a navigational user interface element that quickly shows users their current position within the site hierarchy.</span></span> <span data-ttu-id="b9c0a-199">Ovládací prvek SiteMapPath používá rozhraní mapy webu k určení umístění aktuální stránky v mapě webu a následně zobrazí popis cesty na základě těchto informací.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-199">The SiteMapPath control uses the Site Map framework to determine the current page's location in the site map and then displays a breadcrumb based on this information.</span></span>

<span data-ttu-id="b9c0a-200">Konkrétně přidejte `<span>` element do záhlaví `<div>` prvku hlavní stránky a nastavte nový atribut `class` elementu `<span>` na možnost "navigace".</span><span class="sxs-lookup"><span data-stu-id="b9c0a-200">Specifically, add a `<span>` element to the master page's header `<div>` element, and set the new `<span>` element's `class` attribute to "breadcrumb".</span></span> <span data-ttu-id="b9c0a-201">(Třída `Styles.css` obsahuje pravidlo pro třídu "s popisem".) Dále do tohoto nového prvku `<span>` přidejte SiteMapPath.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-201">(The `Styles.css` class contains a rule for a "breadcrumb" class.) Next, add a SiteMapPath to this new `<span>` element.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample4.aspx)]

<span data-ttu-id="b9c0a-202">Obrázek 5 ukazuje výstup SiteMapPath při návštěvě `~/Membership/CreatingUserAccounts.aspx`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-202">Figure 5 shows the output of the SiteMapPath when visiting `~/Membership/CreatingUserAccounts.aspx`.</span></span>

<span data-ttu-id="b9c0a-203">[![zobrazení navigace zobrazuje aktuální stránku a její předchůdce v mapě webu](creating-user-accounts-cs/_static/image14.png)](creating-user-accounts-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-203">[![The Breadcrumb Displays the Current Page and its Ancestors in the Site Map](creating-user-accounts-cs/_static/image14.png)](creating-user-accounts-cs/_static/image13.png)</span></span>

<span data-ttu-id="b9c0a-204">**Obrázek 5**: navigace s popisem cesty zobrazuje aktuální stránku a její předchůdce v mapě webu ([kliknutím zobrazíte obrázek v plné velikosti).](creating-user-accounts-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-204">**Figure 5**: The Breadcrumb Displays the Current Page and its Ancestors in the Site Map  ([Click to view full-size image](creating-user-accounts-cs/_static/image15.png))</span></span>

## <a name="step-4-removing-the-custom-principal-and-identity-logic"></a><span data-ttu-id="b9c0a-205">Krok 4: Odebrání vlastního objektu zabezpečení a logiky identity</span><span class="sxs-lookup"><span data-stu-id="b9c0a-205">Step 4: Removing the Custom Principal and Identity Logic</span></span>

<span data-ttu-id="b9c0a-206">V kurzu *Konfigurace ověřování a Pokročilá témata jsme zjistili, jak přidružit k ověřenému uživateli vlastní objekty zabezpečení a identity. <a id="_msoanchor_7">[ ](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md)</a>*</span><span class="sxs-lookup"><span data-stu-id="b9c0a-206">In the *<a id="_msoanchor_7"></a>[Forms Authentication Configuration and Advanced Topics](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md)* tutorial we saw how to associate custom principal and identity objects to the authenticated user.</span></span> <span data-ttu-id="b9c0a-207">Provedli jsme to vytvořením obslužné rutiny události v `Global.asax` pro událost `PostAuthenticateRequest` aplikace, která se aktivuje po ověření uživatele `FormsAuthenticationModule`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-207">We accomplished this by creating an event handler in `Global.asax` for the application's `PostAuthenticateRequest` event, which fires after the `FormsAuthenticationModule` has authenticated the user.</span></span> <span data-ttu-id="b9c0a-208">V této obslužné rutině události nahradili `GenericPrincipal` a objekty `FormsIdentity` přidané `FormsAuthenticationModule` s objekty `CustomPrincipal` a `CustomIdentity`, které jsme vytvořili v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-208">In this event handler we replaced the `GenericPrincipal` and `FormsIdentity` objects added by the `FormsAuthenticationModule` with the `CustomPrincipal` and `CustomIdentity` objects we created in that tutorial.</span></span>

<span data-ttu-id="b9c0a-209">Zatímco vlastní objekty zabezpečení a identity jsou užitečné v některých scénářích, ve většině případů jsou objekty `GenericPrincipal` a `FormsIdentity` dostatečné.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-209">While custom principal and identity objects are useful in certain scenarios, in most cases the `GenericPrincipal` and `FormsIdentity` objects are sufficient.</span></span> <span data-ttu-id="b9c0a-210">V důsledku toho se domníváme, že by bylo vhodné se vrátit k výchozímu chování.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-210">Consequently, I think it would be worthwhile to return to the default behavior.</span></span> <span data-ttu-id="b9c0a-211">Tuto změnu udělejte buď odebráním nebo zadáním komentáře obslužné rutiny události `PostAuthenticateRequest`, nebo odstraněním `Global.asax` souboru zcela.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-211">Make this change by either removing or commenting out the `PostAuthenticateRequest` event handler or by deleting the `Global.asax` file entirely.</span></span>

## <a name="step-5-programmatically-creating-a-new-user"></a><span data-ttu-id="b9c0a-212">Krok 5: Programové vytvoření nového uživatele</span><span class="sxs-lookup"><span data-stu-id="b9c0a-212">Step 5: Programmatically Creating a New User</span></span>

<span data-ttu-id="b9c0a-213">Chcete-li vytvořit nový uživatelský účet prostřednictvím rozhraní členství, použijte [metodu`CreateUser`](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx)třídy `Membership`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-213">To create a new user account through the Membership framework use the `Membership` class's [`CreateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx).</span></span> <span data-ttu-id="b9c0a-214">Tato metoda má vstupní parametry pro uživatelské jméno, heslo a další pole související s uživatelem.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-214">This method has input parameters for the username, password, and other user-related fields.</span></span> <span data-ttu-id="b9c0a-215">Při vyvolání IT deleguje vytvoření nového uživatelského účtu nakonfigurovanému zprostředkovateli členství a vrátí [objekt`MembershipUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) reprezentující právě vytvořený uživatelský účet.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-215">On invocation, it delegates the creation of the new user account to the configured Membership provider and then returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) representing the just-created user account.</span></span>

<span data-ttu-id="b9c0a-216">Metoda `CreateUser` má čtyři přetížení, přičemž každý z nich přijímá jiný počet vstupních parametrů:</span><span class="sxs-lookup"><span data-stu-id="b9c0a-216">The `CreateUser` method has four overloads, each accepting a different number of input parameters:</span></span>

- [`CreateUser(username, password)`](https://msdn.microsoft.com/library/d8t4h2es.aspx)
- [`CreateUser(username, password, email)`](https://msdn.microsoft.com/library/t8yy6w3h.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, MembershipCreateStatus)`](https://msdn.microsoft.com/library/82xx2e62.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, providerUserKey, MembershipCreateStatus)`](https://msdn.microsoft.com/library/ms152012.aspx)

<span data-ttu-id="b9c0a-217">Tato čtyři přetížení se liší od množství shromažďovaných informací.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-217">These four overloads differ on the amount of information that is collected.</span></span> <span data-ttu-id="b9c0a-218">První přetížení například vyžaduje pouze uživatelské jméno a heslo pro nový uživatelský účet, zatímco druhý z nich také vyžaduje e-mailovou adresu uživatele.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-218">The first overload, for example, requires just the username and password for the new user account, whereas the second one also requires the user's email address.</span></span>

<span data-ttu-id="b9c0a-219">Tato přetížení existují, protože informace potřebné k vytvoření nového uživatelského účtu závisí na nastavení konfigurace poskytovatele členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-219">These overloads exist because the information needed to create a new user account depends on the Membership provider's configuration settings.</span></span> <span data-ttu-id="b9c0a-220">V kurzu  *<a id="_msoanchor_8">[ ](creating-the-membership-schema-in-sql-server-cs.md)</a>vytváření schématu členství v SQL Server* jsme prozkoumali určení nastavení konfigurace zprostředkovatele členství v `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-220">In the *<a id="_msoanchor_8"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* tutorial we examined specifying Membership provider configuration settings in `Web.config`.</span></span> <span data-ttu-id="b9c0a-221">Tabulka 2 obsahuje úplný seznam nastavení konfigurace.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-221">Table 2 included a complete list of the configuration settings.</span></span>

<span data-ttu-id="b9c0a-222">Toto nastavení konfigurace zprostředkovatele členství, které ovlivňuje `CreateUser` přetížení, je možné použít jako `requiresQuestionAndAnswer` nastavení.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-222">One such Membership provider configuration setting that impacts what `CreateUser` overloads may be used is the `requiresQuestionAndAnswer` setting.</span></span> <span data-ttu-id="b9c0a-223">Pokud je `requiresQuestionAndAnswer` nastavená na `true` (výchozí nastavení), pak při vytváření nového uživatelského účtu musíte zadat bezpečnostní otázku a odpověď.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-223">If `requiresQuestionAndAnswer` is set to `true` (the default), then when creating a new user account we must specify a security question and answer.</span></span> <span data-ttu-id="b9c0a-224">Tyto informace se později použijí, pokud uživatel potřebuje resetovat nebo změnit heslo.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-224">This information is later used if the user needs to reset or change their password.</span></span> <span data-ttu-id="b9c0a-225">Konkrétně v takovém případě se zobrazí bezpečnostní otázka a musí zadat správnou odpověď, aby bylo možné resetovat nebo změnit heslo.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-225">Specifically, at that time they are shown the security question and they must enter the correct answer in order to reset or change their password.</span></span> <span data-ttu-id="b9c0a-226">V důsledku toho, pokud je `requiresQuestionAndAnswer` nastavena na `true` pak volání jednoho z prvních dvou `CreateUser` přetížení má za následek výjimku, protože bezpečnostní otázka a odpověď chybí.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-226">Consequently, if the `requiresQuestionAndAnswer` is set to `true` then calling either of the first two `CreateUser` overloads results in an exception because the security question and answer are missing.</span></span> <span data-ttu-id="b9c0a-227">Vzhledem k tomu, že je naše aplikace momentálně nakonfigurovaná tak, aby vyžadovala bezpečnostní otázku a odpověď, budeme při vytváření uživatelského kódu programově potřebovat jedno z těchto dvou přetížení.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-227">Since our application is currently configured to require a security question and answer, we will need to use one of the latter two overloads when creating user's programmatically.</span></span>

<span data-ttu-id="b9c0a-228">K ilustraci pomocí `CreateUser` metody vytvoříme uživatelské rozhraní, ve kterém se uživateli zobrazí výzva k zadání jména, hesla, e-mailu a odpovědi na předem definovanou bezpečnostní otázku.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-228">To illustrate using the `CreateUser` method, let's create a user interface where we prompt the user for their name, password, email, and an answer to a pre-defined security question.</span></span> <span data-ttu-id="b9c0a-229">Ve složce `Membership` otevřete stránku `CreatingUserAccounts.aspx` a přidejte do ovládacího prvku obsahu následující webové ovládací prvky:</span><span class="sxs-lookup"><span data-stu-id="b9c0a-229">Open the `CreatingUserAccounts.aspx` page in the `Membership` folder and add the following Web controls to the Content control:</span></span>

- <span data-ttu-id="b9c0a-230">Textové pole s názvem `Username`</span><span class="sxs-lookup"><span data-stu-id="b9c0a-230">A TextBox named `Username`</span></span>
- <span data-ttu-id="b9c0a-231">Textové pole s názvem `Password`, jehož vlastnost `TextMode` je nastavena na `Password`</span><span class="sxs-lookup"><span data-stu-id="b9c0a-231">A TextBox named `Password`, whose `TextMode` property is set to `Password`</span></span>
- <span data-ttu-id="b9c0a-232">Textové pole s názvem `Email`</span><span class="sxs-lookup"><span data-stu-id="b9c0a-232">A TextBox named `Email`</span></span>
- <span data-ttu-id="b9c0a-233">Popisek s názvem `SecurityQuestion` s jeho vlastností `Text` se vymazal.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-233">A Label named `SecurityQuestion` with its `Text` property cleared out</span></span>
- <span data-ttu-id="b9c0a-234">Textové pole s názvem `SecurityAnswer`</span><span class="sxs-lookup"><span data-stu-id="b9c0a-234">A TextBox named `SecurityAnswer`</span></span>
- <span data-ttu-id="b9c0a-235">Tlačítko s názvem `CreateAccountButton`, jehož vlastnost text je nastavena na možnost vytvořit uživatelský účet.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-235">A Button named `CreateAccountButton` whose Text property is set to "Create the User Account"</span></span>
- <span data-ttu-id="b9c0a-236">Ovládací prvek popisek s názvem `CreateAccountResults` s jeho vlastností `Text` vymazal.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-236">A Label control named `CreateAccountResults` with its `Text` property cleared out</span></span>

<span data-ttu-id="b9c0a-237">V tuto chvíli by vaše obrazovka měla vypadat podobně jako snímek obrazovky, který je znázorněn na obrázku 6.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-237">At this point your screen should look similar to the screen shot shown in Figure 6.</span></span>

<span data-ttu-id="b9c0a-238">[![přidat různé webové ovládací prvky na stránku CreatingUserAccounts. aspx](creating-user-accounts-cs/_static/image17.png)](creating-user-accounts-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-238">[![Add the Various Web Controls to the CreatingUserAccounts.aspx Page](creating-user-accounts-cs/_static/image17.png)](creating-user-accounts-cs/_static/image16.png)</span></span>

<span data-ttu-id="b9c0a-239">**Obrázek 6**: Přidání různých webových ovládacích prvků na stránku `CreatingUserAccounts.aspx` ([kliknutím zobrazíte obrázek v plné velikosti](creating-user-accounts-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="b9c0a-239">**Figure 6**: Add the Various Web Controls to the `CreatingUserAccounts.aspx` Page  ([Click to view full-size image](creating-user-accounts-cs/_static/image18.png))</span></span>

<span data-ttu-id="b9c0a-240">Popisek `SecurityQuestion` a textové pole `SecurityAnswer` mají za cíl zobrazit předem definovanou bezpečnostní otázku a shromažďovat odpověď uživatele.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-240">The `SecurityQuestion` Label and `SecurityAnswer` TextBox are intended to display a pre-defined security question and collect the user's answer.</span></span> <span data-ttu-id="b9c0a-241">Všimněte si, že bezpečnostní otázka a odpověď jsou uloženy na základě uživatele, takže je možné umožnit každému uživateli definovat vlastní bezpečnostní otázku.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-241">Note that both the security question and answer are stored on a user-by-user basis, so it is possible to allow each user to define their own security question.</span></span> <span data-ttu-id="b9c0a-242">V tomto příkladu se ale rozhodl použít univerzální bezpečnostní otázku, konkrétně: "Co je vaše oblíbená barva?"</span><span class="sxs-lookup"><span data-stu-id="b9c0a-242">However, for this example I have decided to use a universal security question, namely: "What is your favorite color?"</span></span>

<span data-ttu-id="b9c0a-243">Chcete-li implementovat tuto předem definovanou bezpečnostní otázku, přidejte konstantu do třídy kódu na pozadí stránky s názvem `passwordQuestion`a přiřaďte jí bezpečnostní otázku.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-243">To implement this pre-defined security question, add a constant to the page's code-behind class named `passwordQuestion`, assigning it the security question.</span></span> <span data-ttu-id="b9c0a-244">Potom v obslužné rutině události `Page_Load` přiřaďte tuto konstantu k vlastnosti `Text` popisku `SecurityQuestion`:</span><span class="sxs-lookup"><span data-stu-id="b9c0a-244">Then, in the `Page_Load` event handler, assign this constant to the `SecurityQuestion` Label's `Text` property:</span></span>

[!code-csharp[Main](creating-user-accounts-cs/samples/sample5.cs)]

<span data-ttu-id="b9c0a-245">Dále vytvořte obslužnou rutinu události pro událost `Click` `CreateAccountButton`a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="b9c0a-245">Next, create an event handler for the `CreateAccountButton`'s `Click` event and add the following code:</span></span>

[!code-csharp[Main](creating-user-accounts-cs/samples/sample6.cs)]

<span data-ttu-id="b9c0a-246">Obslužná rutina události `Click` začíná definováním proměnné pojmenované `createStatus` typu [`MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-246">The `Click` event handler starts by defining a variable named `createStatus` of type [`MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx).</span></span> <span data-ttu-id="b9c0a-247">`MembershipCreateStatus` je výčet, který označuje stav operace `CreateUser`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-247">`MembershipCreateStatus` is an enumeration that indicates the status of the `CreateUser` operation.</span></span> <span data-ttu-id="b9c0a-248">Pokud se například uživatelský účet úspěšně vytvoří, výsledná instance `MembershipCreateStatus` se nastaví na hodnotu `Success`; na druhé straně, pokud se operace nezdaří, protože již existuje uživatel se stejným uživatelským jménem, bude nastaven na hodnotu `DuplicateUserName`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-248">For example, if the user account is created successfully, the resulting `MembershipCreateStatus` instance will be set to a value of `Success`; on the other hand, if the operation fails because there already exists a user with the same username, it will be set to a value of `DuplicateUserName`.</span></span> <span data-ttu-id="b9c0a-249">V `CreateUser` přetížení potřebujeme předat instanci `MembershipCreateStatus` do metody jako parametr `out`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-249">In the `CreateUser` overload we use, we need to pass a `MembershipCreateStatus` instance into the method as an `out` parameter.</span></span> <span data-ttu-id="b9c0a-250">Tento parametr je nastaven na odpovídající hodnotu v rámci metody `CreateUser` a můžeme zjistit jeho hodnotu po volání metody, abyste zjistili, zda byl uživatelský účet úspěšně vytvořen.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-250">This parameter is set to the appropriate value within the `CreateUser` method, and we can examine its value after the method call to determine whether the user account was successfully created.</span></span>

<span data-ttu-id="b9c0a-251">Po volání `CreateUser`, který se předává do `createStatus`, se pro výstup příslušné zprávy v závislosti na hodnotě přiřazené k `createStatus`používá příkaz `switch`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-251">After calling `CreateUser`, passing in `createStatus`, a `switch` statement is used to output an appropriate message depending on the value assigned to `createStatus`.</span></span> <span data-ttu-id="b9c0a-252">Obrázky 7 ukazují výstup nově úspěšně vytvořeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-252">Figures 7 shows the output when a new user has successfully been created.</span></span> <span data-ttu-id="b9c0a-253">Na obrázcích 8 a 9 se zobrazí výstup, když se uživatelský účet nevytvoří.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-253">Figures 8 and 9 show the output when the user account is not created.</span></span> <span data-ttu-id="b9c0a-254">Na obrázku 8 návštěvník zadal heslo s pěti písmeny, které nesplňuje požadavky na sílu hesla napsané v nastavení konfigurace poskytovatele členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-254">In Figure 8, the visitor entered a five-letter password, which does not meet the password strength requirements spelled out in the Membership provider's configuration settings.</span></span> <span data-ttu-id="b9c0a-255">Na obrázku 9 se návštěvník pokouší vytvořit uživatelský účet s existujícím uživatelským jménem (ten vytvořený na obrázku 7).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-255">In Figure 9, the visitor is attempting to create a user account with an existing username (the one created in Figure 7).</span></span>

<span data-ttu-id="b9c0a-256">[![se úspěšně vytvořil nový uživatelský účet.](creating-user-accounts-cs/_static/image20.png)](creating-user-accounts-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-256">[![A New User Account is Successfully Created](creating-user-accounts-cs/_static/image20.png)](creating-user-accounts-cs/_static/image19.png)</span></span>

<span data-ttu-id="b9c0a-257">**Obrázek 7**: byl úspěšně vytvořen nový uživatelský účet ([kliknutím zobrazíte obrázek v plné velikosti](creating-user-accounts-cs/_static/image21.png)).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-257">**Figure 7**: A New User Account is Successfully Created  ([Click to view full-size image](creating-user-accounts-cs/_static/image21.png))</span></span>

<span data-ttu-id="b9c0a-258">[![uživatelský účet není vytvořen, protože zadané heslo je příliš slabé.](creating-user-accounts-cs/_static/image23.png)](creating-user-accounts-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-258">[![The User Account is Not Created Because the Supplied Password is Too Weak](creating-user-accounts-cs/_static/image23.png)](creating-user-accounts-cs/_static/image22.png)</span></span>

<span data-ttu-id="b9c0a-259">**Obrázek 8**: uživatelský účet není vytvořen, protože zadané heslo je příliš slabé ([kliknutím zobrazíte obrázek v plné velikosti).](creating-user-accounts-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-259">**Figure 8**: The User Account is Not Created Because the Supplied Password is Too Weak  ([Click to view full-size image](creating-user-accounts-cs/_static/image24.png))</span></span>

<span data-ttu-id="b9c0a-260">[![uživatelský účet není vytvořen, protože uživatelské jméno je již používáno.](creating-user-accounts-cs/_static/image26.png)](creating-user-accounts-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-260">[![The User Account is Not Created Because the Username is Already in Use](creating-user-accounts-cs/_static/image26.png)](creating-user-accounts-cs/_static/image25.png)</span></span>

<span data-ttu-id="b9c0a-261">**Obrázek 9**: uživatelský účet není vytvořen, protože uživatelské jméno je již používáno ([kliknutím zobrazíte obrázek v plné velikosti).](creating-user-accounts-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-261">**Figure 9**: The User Account is Not Created Because the Username is Already in Use  ([Click to view full-size image](creating-user-accounts-cs/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="b9c0a-262">Může se zajímat, jak určit úspěch nebo neúspěch při použití jednoho z prvních dvou přetížení metod `CreateUser`, ani z toho, který má parametr typu `MembershipCreateStatus`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-262">You may be wondering how to determine success or failure when using one of the first two `CreateUser` method overloads, neither of which has a parameter of type `MembershipCreateStatus`.</span></span> <span data-ttu-id="b9c0a-263">Tyto první dvě přetížení vyvolávají [výjimku`MembershipCreateUserException`](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx) v tváři selhání, která zahrnuje [vlastnost`StatusCode`](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx) typu `MembershipCreateStatus`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-263">These first two overloads throw a [`MembershipCreateUserException` exception](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx) in the face of a failure, which includes a [`StatusCode` property](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx) of type `MembershipCreateStatus`.</span></span>

<span data-ttu-id="b9c0a-264">Po vytvoření několika uživatelských účtů ověřte, že byly vytvořeny účty pomocí výpisu obsahu `aspnet_Users` a `aspnet_Membership` tabulek v databázi `SecurityTutorials.mdf`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-264">After creating a few user accounts, verify that the accounts have been created by listing the contents of the `aspnet_Users` and `aspnet_Membership` tables in the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="b9c0a-265">Jak ukazuje obrázek 10, Přidali jsme dva uživatele prostřednictvím stránky `CreatingUserAccounts.aspx`: tito a Bruce.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-265">As Figure 10 shows, I have added two users via the `CreatingUserAccounts.aspx` page: Tito and Bruce.</span></span>

<span data-ttu-id="b9c0a-266">[![v úložišti uživatelů členství jsou dva uživatelé: tito a Bruce](creating-user-accounts-cs/_static/image29.png)](creating-user-accounts-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-266">[![There are Two Users in the Membership User Store: Tito and Bruce](creating-user-accounts-cs/_static/image29.png)](creating-user-accounts-cs/_static/image28.png)</span></span>

<span data-ttu-id="b9c0a-267">**Obrázek 10**: v úložišti uživatelů členství jsou dva uživatelé: tito a Bruce ([kliknutím zobrazíte obrázek v plné velikosti](creating-user-accounts-cs/_static/image30.png)).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-267">**Figure 10**: There are Two Users in the Membership User Store: Tito and Bruce  ([Click to view full-size image](creating-user-accounts-cs/_static/image30.png))</span></span>

<span data-ttu-id="b9c0a-268">I když úložiště uživatele členství teď obsahuje informace o účtu Bruce a tito, zatím jsme implementovali funkce, které umožní přihlašovat se k webu Bruce nebo tito.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-268">While the Membership user store now includes Bruce and Tito's account information, we have yet to implement functionality that allows for Bruce or Tito to log on to the site.</span></span> <span data-ttu-id="b9c0a-269">V současné době `Login.aspx` ověřuje přihlašovací údaje uživatele proti pevně zakódované sadě párů uživatelských jmen a hesel – *neověřuje zadané* přihlašovací údaje v rámci rozhraní členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-269">Currently, `Login.aspx` validates the user's credentials against a hard-coded set of username/password pairs – it does *not* validate the supplied credentials against the Membership framework.</span></span> <span data-ttu-id="b9c0a-270">Nyní se zobrazí nové uživatelské účty v `aspnet_Users` a `aspnet_Membership` tabulky budou stačit.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-270">For now seeing the new user accounts in the `aspnet_Users` and `aspnet_Membership` tables will have to suffice.</span></span> <span data-ttu-id="b9c0a-271">V dalším kurzu  *<a id="_msoanchor_9">[ ](validating-user-credentials-against-the-membership-user-store-cs.md)</a>ověříte přihlašovací údaje uživatele proti uživatelskému úložišti členství*, aktualizujeme přihlašovací stránku, aby se ověřilo v úložišti členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-271">In the next tutorial, *<a id="_msoanchor_9"></a>[Validating User Credentials Against the Membership User Store](validating-user-credentials-against-the-membership-user-store-cs.md)*, we will update the login page to validate against the Membership store.</span></span>

> [!NOTE]
> <span data-ttu-id="b9c0a-272">Pokud nevidíte žádné uživatele v databázi `SecurityTutorials.mdf`, může to být tím, že vaše webová aplikace používá výchozího poskytovatele členství, `AspNetSqlMembershipProvider`, který jako své uživatelské úložiště používá databázi `ASPNETDB.mdf`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-272">If you do not see any users in your `SecurityTutorials.mdf` database, it may be because your web application is using the default Membership provider, `AspNetSqlMembershipProvider`, which uses the `ASPNETDB.mdf` database as its user store.</span></span> <span data-ttu-id="b9c0a-273">Chcete-li zjistit, zda se jedná o problém, klikněte na tlačítko Aktualizovat v Průzkumník řešení.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-273">To determine if this is the problem, click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="b9c0a-274">Pokud byla do složky `App_Data` přidána databáze s názvem `ASPNETDB.mdf`, jedná se o problém.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-274">If a database named `ASPNETDB.mdf` has been added to the `App_Data` folder, this is the problem.</span></span> <span data-ttu-id="b9c0a-275">Vraťte se ke kroku 4  *<a id="_msoanchor_10">[ ](creating-the-membership-schema-in-sql-server-cs.md)</a>v tématu vytvoření schématu členství v SQL Server* kurzu, kde najdete pokyny, jak správně nakonfigurovat poskytovatele členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-275">Return to Step 4 of the *<a id="_msoanchor_10"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* tutorial for instructions on how to properly configure the Membership provider.</span></span>

<span data-ttu-id="b9c0a-276">Ve většině scénářů vytváření uživatelských účtů se návštěvník zobrazuje s nějakým rozhraním, které umožňuje zadat své uživatelské jméno, heslo, e-mail a další důležité informace. tím se vytvoří nový účet.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-276">In most create user account scenarios, the visitor is presented with some interface to enter their username, password, email, and other essential information, at which point a new account is created.</span></span> <span data-ttu-id="b9c0a-277">V tomto kroku jsme se prohlédli vytvořením takového rozhraní a pak viděli, jak pomocí metody `Membership.CreateUser` programově přidat nový uživatelský účet na základě vstupů uživatele.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-277">In this step we looked at building such an interface by hand and then saw how to use the `Membership.CreateUser` method to programmatically add the new user account based on the user's inputs.</span></span> <span data-ttu-id="b9c0a-278">Náš kód ale právě vytvořil nový uživatelský účet.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-278">Our code, however, just created the new user account.</span></span> <span data-ttu-id="b9c0a-279">Neprováděly se žádné následné akce, třeba přihlášení uživatele k webu v rámci právě vytvořeného uživatelského účtu nebo odeslání e-mailu s potvrzením uživateli.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-279">It did not perform any follow up actions, like logging in the user to the site under the just-created user account, or sending a confirmation email to the user.</span></span> <span data-ttu-id="b9c0a-280">Tyto další kroky by vyžadovaly další kód v obslužné rutině události `Click` tlačítka.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-280">These additional steps would require additional code in the Button's `Click` event handler.</span></span>

<span data-ttu-id="b9c0a-281">ASP.NET se dodává s ovládacím prvkem ovládacím CreateUserWizard, který je navržený tak, aby zpracovával proces vytváření uživatelských účtů, vygenerování uživatelského rozhraní pro vytváření nových uživatelských účtů, vytvoření účtu v rámci členství v architektuře a provádění post-Account. úlohy vytváření, jako je například odeslání potvrzovacího e-mailu a přihlášení právě vytvořeného uživatele do lokality.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-281">ASP.NET ships with the CreateUserWizard control, which is designed to handle the user account creation process, from rendering a user interface for creating new user accounts, to creating the account in the Membership framework and performing post-account creation tasks, such as sending a confirmation email and logging the just-created user into the site.</span></span> <span data-ttu-id="b9c0a-282">Použití ovládacího prvku ovládacím CreateUserWizard je jednoduché jako přetahování ovládacího prvku ovládacím CreateUserWizard ze sady nástrojů na stránku a nastavení několika vlastností.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-282">Using the CreateUserWizard control is as simple as dragging the CreateUserWizard control from the Toolbox onto a page, and then setting a few properties.</span></span> <span data-ttu-id="b9c0a-283">Ve většině případů nemusíte psát jediný řádek kódu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-283">In most cases, you won't need to write a single line of code.</span></span> <span data-ttu-id="b9c0a-284">Tento ovládací prvek Nifty si podrobněji prozkoumáme v kroku 6.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-284">We will explore this nifty control in detail in Step 6.</span></span>

<span data-ttu-id="b9c0a-285">Pokud jsou nové uživatelské účty vytvořeny pouze pomocí typické webové stránky pro vytvoření účtu, je pravděpodobné, že někdy budete muset napsat kód, který používá metodu `CreateUser`, protože ovládací prvek ovládacím CreateUserWizard pravděpodobně bude vyhovovat vašim potřebám.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-285">If new user accounts are only created through a typical Create Account web page, it is unlikely that you will ever need to write code that uses the `CreateUser` method, as the CreateUserWizard control will likely meet your needs.</span></span> <span data-ttu-id="b9c0a-286">Nicméně metoda `CreateUser` je užitečná ve scénářích, kdy potřebujete vysoce přizpůsobené uživatelské prostředí pro vytváření účtů nebo když potřebujete programově vytvořit nové uživatelské účty pomocí alternativního rozhraní.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-286">However, the `CreateUser` method is handy in scenarios where you need a highly customized Create Account user experience or when you need to programmatically create new user accounts through an alternative interface.</span></span> <span data-ttu-id="b9c0a-287">Můžete mít například stránku, která umožňuje uživateli odeslat soubor XML, který obsahuje informace o uživateli z jiné aplikace.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-287">For example, you might have a page that allows a user to upload an XML file that contains user information from some other application.</span></span> <span data-ttu-id="b9c0a-288">Stránka může analyzovat obsah nahraného souboru XML a vytvořit nový účet pro každého uživatele reprezentovaného v XML voláním metody `CreateUser`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-288">The page might parses the contents of the uploaded XML file and create a new account for each user represented in the XML by calling the `CreateUser` method.</span></span>

## <a name="step-6-creating-a-new-user-with-the-createuserwizard-control"></a><span data-ttu-id="b9c0a-289">Krok 6: vytvoření nového uživatele pomocí ovládacího prvku ovládacím CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="b9c0a-289">Step 6: Creating a New User with the CreateUserWizard Control</span></span>

<span data-ttu-id="b9c0a-290">ASP.NET se dodává s řadou přihlašovacích webových ovládacích prvků.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-290">ASP.NET ships with a number of Login Web controls.</span></span> <span data-ttu-id="b9c0a-291">Tyto ovládací prvky pomáhají v mnoha běžných scénářích souvisejících s uživatelským účtem a přihlašovacími údaji.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-291">These controls aid in many common user account- and login-related scenarios.</span></span> <span data-ttu-id="b9c0a-292">[Ovládací prvek ovládacím CreateUserWizard](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx) je jedním z těchto ovládacích prvků, který je navržen pro zobrazení uživatelského rozhraní pro přidání nového uživatelského účtu do architektury členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-292">The [CreateUserWizard control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx) is one such control that is designed to present a user interface for adding a new user account to the Membership framework.</span></span>

<span data-ttu-id="b9c0a-293">Stejně jako mnoho dalších webových ovládacích prvků souvisejících s přihlášením, lze ovládacím CreateUserWizard použít bez nutnosti psát jediný řádek kódu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-293">Like many of the other Login-related Web controls, the CreateUserWizard can be used without writing a single line of code.</span></span> <span data-ttu-id="b9c0a-294">Intuitivní poskytuje uživatelské rozhraní na základě nastavení konfigurace poskytovatele členství a interně volá metodu `CreateUser` `Membership` třídy poté, co uživatel zadá potřebné informace a klikne na tlačítko vytvořit uživatele.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-294">It intuitively provides a user interface based on the Membership provider's configuration settings and internally calls the `Membership` class's `CreateUser` method after the user enters the necessary information and clicks the "Create User" button.</span></span> <span data-ttu-id="b9c0a-295">Ovládací prvek ovládacím CreateUserWizard je velice přizpůsobitelný.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-295">The CreateUserWizard control is extremely customizable.</span></span> <span data-ttu-id="b9c0a-296">V různých fázích procesu vytváření účtů je hostitel událostí, které se aktivují.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-296">There are a host of events that fire during various stages of the account creation process.</span></span> <span data-ttu-id="b9c0a-297">V případě potřeby můžeme vytvářet obslužné rutiny událostí pro vložení vlastní logiky do pracovního postupu vytváření účtů.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-297">We can create event handlers, as needed, to inject custom logic into the account creation workflow.</span></span> <span data-ttu-id="b9c0a-298">Kromě toho je vzhled ovládacím CreateUserWizard velmi flexibilní.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-298">Furthermore, the CreateUserWizard's appearance is very flexible.</span></span> <span data-ttu-id="b9c0a-299">Existuje mnoho vlastností, které definují vzhled výchozího rozhraní. v případě potřeby je možné ovládací prvek převést na šablonu nebo na další registraci uživatele "kroky".</span><span class="sxs-lookup"><span data-stu-id="b9c0a-299">There are a number of properties that define the appearance of the default interface; if necessary, the control can be converted into a template or additional user registration "steps" may be added.</span></span>

<span data-ttu-id="b9c0a-300">Pojďme se podívat na použití výchozího rozhraní a chování ovládacího prvku ovládacím CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-300">Let's start with a look at using the CreateUserWizard control's default interface and behavior.</span></span> <span data-ttu-id="b9c0a-301">Podíváme se na to, jak přizpůsobit vzhled prostřednictvím vlastností a událostí ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-301">We'll then explore how to customize the appearance via the control's properties and events.</span></span>

### <a name="examining-the-createuserwizards-default-interface-and-behavior"></a><span data-ttu-id="b9c0a-302">Prověřování výchozího rozhraní a chování ovládacím CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="b9c0a-302">Examining the CreateUserWizard's Default Interface and Behavior</span></span>

<span data-ttu-id="b9c0a-303">Vraťte se na stránku `CreatingUserAccounts.aspx` ve složce `Membership`, přepněte do režimu návrhu nebo rozdělení a pak přidejte ovládací prvek ovládacím CreateUserWizard do horní části stránky.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-303">Return to the `CreatingUserAccounts.aspx` page in the `Membership` folder, switch to the Design or Split mode, and then add a CreateUserWizard control to the top of the page.</span></span> <span data-ttu-id="b9c0a-304">Ovládací prvek ovládacím CreateUserWizard je uložen v části ovládací prvky přihlášení sady nástrojů.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-304">The CreateUserWizard control is filed under the Toolbox's Login controls section.</span></span> <span data-ttu-id="b9c0a-305">Po přidání ovládacího prvku nastavte jeho vlastnost `ID` na hodnotu `RegisterUser`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-305">After adding the control, set its `ID` property to `RegisterUser`.</span></span> <span data-ttu-id="b9c0a-306">Vzhledem k zobrazení snímku obrazovky na obrázku 11 ovládacím CreateUserWizard vykreslí rozhraní s textovým polem pro uživatelské jméno, heslo, e-mailovou adresu a otázku a odpověď zabezpečení nového uživatele.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-306">As the screen shot in Figure 11 shows, the CreateUserWizard renders an interface with textboxes for the new user's username, password, email address, and security question and answer.</span></span>

<span data-ttu-id="b9c0a-307">[![ovládacího prvku ovládacím CreateUserWizard vykreslí obecné uživatelské rozhraní pro vytvoření.](creating-user-accounts-cs/_static/image32.png)](creating-user-accounts-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-307">[![The CreateUserWizard Control Renders a Generic Create User Interface](creating-user-accounts-cs/_static/image32.png)](creating-user-accounts-cs/_static/image31.png)</span></span>

<span data-ttu-id="b9c0a-308">**Obrázek 11**: ovládací prvek ovládacím CreateUserWizard vykreslí obecné vytvoření uživatelského rozhraní ([kliknutím zobrazíte obrázek v plné velikosti).](creating-user-accounts-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-308">**Figure 11**: The CreateUserWizard Control Renders a Generic Create User Interface  ([Click to view full-size image](creating-user-accounts-cs/_static/image33.png))</span></span>

<span data-ttu-id="b9c0a-309">Pojďme chvíli porovnávat výchozí uživatelské rozhraní generované ovládacím prvkem ovládacím CreateUserWizard s rozhraním, které jsme vytvořili v kroku 5.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-309">Let's take a moment to compare the default user interface generated by the CreateUserWizard control with the interface we created in Step 5.</span></span> <span data-ttu-id="b9c0a-310">Pro Starter umožňuje ovládacímu prvku ovládacím CreateUserWizard návštěvník zadat bezpečnostní otázku a odpověď, zatímco naše ručně vytvořené rozhraní používalo předem definovanou bezpečnostní otázku.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-310">For starters, the CreateUserWizard control allows the visitor to specify both the security question and answer, whereas our manually-created interface used a pre-defined security question.</span></span> <span data-ttu-id="b9c0a-311">Rozhraní ovládacího prvku ovládacím CreateUserWizard obsahuje také ověřovací ovládací prvky, zatímco jsme ještě v našem rozhraních pole formuláře implementovali ověřování.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-311">The CreateUserWizard control's interface also includes validation controls, whereas we had yet to implement validation on our interface's form fields.</span></span> <span data-ttu-id="b9c0a-312">A rozhraní ovládacího prvku ovládacím CreateUserWizard obsahuje textové pole Potvrdit heslo (spolu s CompareValidator, aby se zajistilo, že se text zadal jako textové pole "heslo" a "porovnat heslo").</span><span class="sxs-lookup"><span data-stu-id="b9c0a-312">And the CreateUserWizard control interface includes a "Confirm Password" textbox (along with a CompareValidator to ensure that the text entered the "Password" and "Compare Password" textboxes are equal).</span></span>

<span data-ttu-id="b9c0a-313">Zajímavou je, že ovládací prvek ovládacím CreateUserWizard při vykreslování svého uživatelského rozhraní konzultuje nastavení konfigurace poskytovatele členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-313">What's interesting is that the CreateUserWizard control consults the Membership provider's configuration settings when rendering its user interface.</span></span> <span data-ttu-id="b9c0a-314">Například pokud je `requiresQuestionAndAnswer` nastavena na hodnotu true, budou se zobrazovat pouze textová pole otázka zabezpečení a odpověď.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-314">For example, the security question and answer textboxes are only displayed if `requiresQuestionAndAnswer` is set to True.</span></span> <span data-ttu-id="b9c0a-315">Podobně ovládacím CreateUserWizard automaticky přidá ovládací prvek RegularExpressionValidator, aby se zajistilo splnění požadavků na sílu hesla, a nastaví jeho `ErrorMessage` a `ValidationExpression` vlastností na základě nastavení konfigurace `minRequiredPasswordLength`, `minRequiredNonalphanumericCharacters`a `passwordStrengthRegularExpression`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-315">Likewise, CreateUserWizard automatically adds a RegularExpressionValidator control to ensure that the password strength requirements are met, and sets its `ErrorMessage` and `ValidationExpression` properties based on the `minRequiredPasswordLength`, `minRequiredNonalphanumericCharacters`, and `passwordStrengthRegularExpression` configuration settings.</span></span>

<span data-ttu-id="b9c0a-316">Ovládací prvek ovládacím CreateUserWizard, jak má název, je odvozen od [ovládacího prvku Průvodce](https://msdn.microsoft.com/library/s2etd1ek.aspx).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-316">The CreateUserWizard control, as its name implies, is derived from the [Wizard control](https://msdn.microsoft.com/library/s2etd1ek.aspx).</span></span> <span data-ttu-id="b9c0a-317">Ovládací prvky průvodce jsou navržené tak, aby poskytovaly rozhraní pro provádění úloh s více kroky.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-317">Wizard controls are designed to provide an interface for completing multi-step tasks.</span></span> <span data-ttu-id="b9c0a-318">Ovládací prvek Průvodce může mít libovolný počet `WizardSteps`, z nichž každá představuje šablonu, která definuje HTML a webové ovládací prvky pro daný krok.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-318">A Wizard control may have an arbitrary number of `WizardSteps`, each of which is a template that defines the HTML and Web controls for that step.</span></span> <span data-ttu-id="b9c0a-319">V ovládacím prvku průvodce se zpočátku zobrazí první `WizardStep`společně s ovládacími prvky navigace, které uživateli umožňují pokračovat z jednoho kroku na další, nebo pro návrat k předchozím krokům.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-319">The Wizard control initially displays the first `WizardStep`, along with navigation controls that permit the user to proceed from one step to the next, or to return to previous steps.</span></span>

<span data-ttu-id="b9c0a-320">Jak ukazuje deklarativní označení na obrázku 11, výchozí rozhraní ovládacího prvku ovládacím CreateUserWizard zahrnuje dva `WizardSteps:`</span><span class="sxs-lookup"><span data-stu-id="b9c0a-320">As the declarative markup in Figure 11 shows, the CreateUserWizard control's default interface includes two `WizardSteps:`</span></span>

- <span data-ttu-id="b9c0a-321">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) – vykreslí rozhraní, aby se shromáždily informace pro vytvoření nového uživatelského účtu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-321">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) – renders the interface to collect information for creating the new user account.</span></span> <span data-ttu-id="b9c0a-322">Toto je krok znázorněný na obrázku 11.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-322">This is the step shown in Figure 11.</span></span>
- <span data-ttu-id="b9c0a-323">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) – vykreslí zprávu oznamující, že účet byl úspěšně vytvořen.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-323">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) – renders a message indicating that the account has successfully been created.</span></span>

<span data-ttu-id="b9c0a-324">Vzhled a chování ovládacím CreateUserWizard můžete upravit tak, že některý z těchto kroků převedete na šablony nebo přidáte vlastní `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-324">The CreateUserWizard's appearance and behavior can be modified by converting either of these steps to templates, or by adding your own `WizardSteps`.</span></span> <span data-ttu-id="b9c0a-325">Podíváme se na přidání `WizardStep` do registračního rozhraní v kurzu *ukládání dalších informací o uživateli* .</span><span class="sxs-lookup"><span data-stu-id="b9c0a-325">We will look at adding a `WizardStep` to the registration interface in the *Storing Additional User Information* tutorial.</span></span>

<span data-ttu-id="b9c0a-326">Pojďme se podívat na ovládací prvek ovládacím CreateUserWizard v akci.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-326">Let's see the CreateUserWizard control in action.</span></span> <span data-ttu-id="b9c0a-327">Navštivte stránku `CreatingUserAccounts.aspx` v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-327">Visit the `CreatingUserAccounts.aspx` page through a browser.</span></span> <span data-ttu-id="b9c0a-328">Začněte zadáním některých neplatných hodnot do rozhraní ovládacím CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-328">Start by entering some invalid values into the CreateUserWizard's interface.</span></span> <span data-ttu-id="b9c0a-329">Zkuste zadat heslo, které není v souladu s požadavky na sílu hesla, nebo nechte textové pole "uživatelské jméno" prázdné.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-329">Try entering a password that doesn't conform to the password strength requirements, or leaving the "User Name" textbox empty.</span></span> <span data-ttu-id="b9c0a-330">V ovládacím CreateUserWizard se zobrazí příslušná chybová zpráva.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-330">The CreateUserWizard will display an appropriate error message.</span></span> <span data-ttu-id="b9c0a-331">Obrázek 12 ukazuje výstup při pokusu o vytvoření uživatele s nedostatečným silným heslem.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-331">Figure 12 shows the output when attempting to create a user with an insufficiently strong password.</span></span>

<span data-ttu-id="b9c0a-332">[![ovládacím CreateUserWizard automaticky vloží ovládací prvky ověřování.](creating-user-accounts-cs/_static/image35.png)](creating-user-accounts-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-332">[![The CreateUserWizard Automatically Injects Validation Controls](creating-user-accounts-cs/_static/image35.png)](creating-user-accounts-cs/_static/image34.png)</span></span>

<span data-ttu-id="b9c0a-333">**Obrázek 12**: ovládacím CreateUserWizard automaticky vloží ovládací prvky ověřování ([kliknutím zobrazíte obrázek v plné velikosti](creating-user-accounts-cs/_static/image36.png)).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-333">**Figure 12**: The CreateUserWizard Automatically Injects Validation Controls  ([Click to view full-size image](creating-user-accounts-cs/_static/image36.png))</span></span>

<span data-ttu-id="b9c0a-334">V dalším kroku zadejte do ovládacím CreateUserWizard příslušné hodnoty a klikněte na tlačítko vytvořit uživatele.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-334">Next, enter appropriate values into the CreateUserWizard and click the "Create User" button.</span></span> <span data-ttu-id="b9c0a-335">Za předpokladu, že jsou povinná pole Zadaná a síla hesla postačuje, vytvoří ovládacím CreateUserWizard nový uživatelský účet prostřednictvím architektury členství a pak zobrazí rozhraní `CompleteWizardStep`(viz obrázek 13).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-335">Assuming the required fields have been entered and the password's strength is sufficient, the CreateUserWizard will create a new user account through the Membership framework and then display the `CompleteWizardStep`'s interface (see Figure 13).</span></span> <span data-ttu-id="b9c0a-336">Na pozadí ovládacím CreateUserWizard volá metodu `Membership.CreateUser` stejným způsobem jako v kroku 5.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-336">Behind the scenes, the CreateUserWizard calls the `Membership.CreateUser` method, just like we did in Step 5.</span></span>

<span data-ttu-id="b9c0a-337">[![byl úspěšně vytvořen nový uživatelský účet.](creating-user-accounts-cs/_static/image38.png)](creating-user-accounts-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-337">[![A New User Account has Successfully Been Created](creating-user-accounts-cs/_static/image38.png)](creating-user-accounts-cs/_static/image37.png)</span></span>

<span data-ttu-id="b9c0a-338">**Obrázek 13**: byl vytvořen nový uživatelský účet ([kliknutím zobrazíte obrázek v plné velikosti](creating-user-accounts-cs/_static/image39.png)).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-338">**Figure 13**: A New User Account has Successfully Been Created  ([Click to view full-size image](creating-user-accounts-cs/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="b9c0a-339">Jak ukazuje obrázek 13, rozhraní `CompleteWizardStep`obsahuje tlačítko pro pokračování.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-339">As Figure 13 shows, the `CompleteWizardStep`'s interface includes a Continue button.</span></span> <span data-ttu-id="b9c0a-340">V tomto okamžiku, kdy na ni klikneme pouze k provedení postbacku, ale návštěvník na stejné stránce zůstane.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-340">However, at this point clicking it just performs a postback, leaving the visitor on the same page.</span></span> <span data-ttu-id="b9c0a-341">V části Přizpůsobení vzhledu a chování ovládacím CreateUserWizard prostřednictvím jeho vlastností se podíváme na to, jak toto tlačítko umožňuje odeslat návštěvníka do `Default.aspx` (nebo na jinou stránku).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-341">In the "Customizing the CreateUserWizard's Appearance and Behavior Through Its Properties" section we will look at how you can have this button send the visitor to `Default.aspx` (or some other page).</span></span>

<span data-ttu-id="b9c0a-342">Po vytvoření nového uživatelského účtu se vraťte do sady Visual Studio a Projděte si tabulky `aspnet_Users` a `aspnet_Membership`, jako jsme na obrázku 10, abyste ověřili, že byl účet úspěšně vytvořen.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-342">After creating a new user account, return to Visual Studio and examine the `aspnet_Users` and `aspnet_Membership` tables like we did in Figure 10 to verify that the account was successfully created.</span></span>

### <a name="customizing-the-createuserwizards-behavior-and-appearance-through-its-properties"></a><span data-ttu-id="b9c0a-343">Přizpůsobení chování a vzhledu ovládacím CreateUserWizard prostřednictvím vlastností</span><span class="sxs-lookup"><span data-stu-id="b9c0a-343">Customizing the CreateUserWizard's Behavior and Appearance Through Its Properties</span></span>

<span data-ttu-id="b9c0a-344">Ovládacím CreateUserWizard lze přizpůsobit různými způsoby, prostřednictvím vlastností, `WizardSteps`a obslužných rutin událostí.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-344">The CreateUserWizard can be customized in a variety of ways, through properties, `WizardSteps`, and event handlers.</span></span> <span data-ttu-id="b9c0a-345">V této části se podíváme na to, jak přizpůsobit vzhled ovládacího prvku prostřednictvím jeho vlastností. v další části se podíváme na rozšíření chování ovládacího prvku prostřednictvím obslužných rutin událostí.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-345">In this section we will look at how to customize the control's appearance through its properties; the next section looks at extending the control's behavior through event handlers.</span></span>

<span data-ttu-id="b9c0a-346">Prakticky všechen text zobrazený ve výchozím uživatelském rozhraní ovládacího prvku ovládacím CreateUserWizard se dá přizpůsobit pomocí jeho spoustu vlastností.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-346">Virtually all of the text displayed in the CreateUserWizard control's default user interface can be customized through its plethora of properties.</span></span> <span data-ttu-id="b9c0a-347">Například popisky "uživatelské jméno", "heslo", "potvrzení hesla", "E-mail", "bezpečnostní otázka" a "odpověď zabezpečení" mohou být upraveny pomocí [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx), [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx), [`ConfirmPasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx), [`EmailLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx), [`QuestionLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx)a [`AnswerLabelText`ch](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx) vlastností v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-347">For example, the "User Name", "Password", "Confirm Password", "E-mail", "Security Question", and "Security Answer" labels displayed to the left of the textboxes can be customized by the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx), [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx), [`ConfirmPasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx), [`EmailLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx), [`QuestionLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx), and [`AnswerLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx) properties, respectively.</span></span> <span data-ttu-id="b9c0a-348">Podobně existují vlastnosti pro určení textu pro tlačítka "vytvořit uživatele" a "pokračovat" v `CreateUserWizardStep` a `CompleteWizardStep`a také v případě, že jsou tato tlačítka vykreslena jako tlačítka, LinkButtons nebo ImageButtons.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-348">Likewise, there are properties for specifying the text for the "Create User" and "Continue" buttons in the `CreateUserWizardStep` and `CompleteWizardStep`, as well as if these buttons are rendered as Buttons, LinkButtons, or ImageButtons.</span></span>

<span data-ttu-id="b9c0a-349">Barvy, ohraničení, písma a další vizuální prvky lze konfigurovat prostřednictvím hostitele vlastností stylu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-349">The colors, borders, fonts, and other visual elements are configurable through a host of style properties.</span></span> <span data-ttu-id="b9c0a-350">Vlastní ovládací prvek ovládacím CreateUserWizard má společné vlastnosti stylu webového ovládacího prvku – `BackColor`, `BorderStyle`, `CssClass`, `Font`a tak dále – a existuje mnoho vlastností stylu pro definování vzhledu pro konkrétní oddíly rozhraní ovládacím CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-350">The CreateUserWizard control itself has the common Web control style properties – `BackColor`, `BorderStyle`, `CssClass`, `Font`, and so on – and there are a number of style properties for defining the appearance for particular sections of the CreateUserWizard's interface.</span></span> <span data-ttu-id="b9c0a-351">[Vlastnost`TextBoxStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx)například definuje styly pro textová pole v `CreateUserWizardStep`, zatímco [vlastnost`TitleTextStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx) definuje styl nadpisu ("Registrace nového účtu").</span><span class="sxs-lookup"><span data-stu-id="b9c0a-351">The [`TextBoxStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx), for instance, defines the styles for the textboxes in the `CreateUserWizardStep`, while the [`TitleTextStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx) defines the style for the title ("Sign Up for Your New Account").</span></span>

<span data-ttu-id="b9c0a-352">Kromě vlastností souvisejících s vzhledy existuje mnoho vlastností, které mají vliv na chování ovládacího prvku ovládacím CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-352">In addition to the appearance-related properties, there are a number of properties that affect the CreateUserWizard control's behavior.</span></span> <span data-ttu-id="b9c0a-353">[Vlastnost`DisplayCancelButton`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx), pokud je nastavena na hodnotu true, zobrazuje tlačítko Storno vedle tlačítka "vytvořit uživatele" (výchozí hodnota je false).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-353">The [`DisplayCancelButton` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx), if set to True, displays a Cancel button next to the "Create User" button (the default value is False).</span></span> <span data-ttu-id="b9c0a-354">Pokud zobrazíte tlačítko zrušit, nezapomeňte také nastavit [vlastnost`CancelDestinationPageUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx), která určuje stránku, na kterou se uživatel pošle po kliknutí na zrušit.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-354">If you display the Cancel button, be sure to also set the [`CancelDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx), which specifies the page the user is sent to after clicking Cancel.</span></span> <span data-ttu-id="b9c0a-355">Jak je uvedeno v předchozí části, tlačítko pokračovat v rozhraní `CompleteWizardStep`způsobí postback, ale návštěvníka zůstane na stejné stránce.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-355">As noted in the previous section, the Continue button in the `CompleteWizardStep`'s interface causes a postback, but leaves the visitor on the same page.</span></span> <span data-ttu-id="b9c0a-356">Chcete-li poslat návštěvníka na jinou stránku po kliknutí na tlačítko pokračovat, stačí zadat adresu URL ve [vlastnosti`ContinueDestinationPageUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-356">To send the visitor to some other page after clicking the Continue button, simply specify the URL in the [`ContinueDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span></span>

<span data-ttu-id="b9c0a-357">Pojďme aktualizovat ovládací prvek `RegisterUser` ovládacím CreateUserWizard a zobrazit tak tlačítko Storno a odeslat návštěvníka do `Default.aspx` při kliknutí na tlačítka pro zrušení nebo pokračování.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-357">Let's update the `RegisterUser` CreateUserWizard control to show a Cancel button and to send the visitor to `Default.aspx` when the Cancel or Continue buttons are clicked.</span></span> <span data-ttu-id="b9c0a-358">Chcete-li to provést, nastavte vlastnost `DisplayCancelButton` na hodnotu true a vlastnosti `CancelDestinationPageUrl` a `ContinueDestinationPageUrl` na ~/Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-358">To accomplish this, set the `DisplayCancelButton` property to True and both the `CancelDestinationPageUrl` and `ContinueDestinationPageUrl` properties to "~/Default.aspx".</span></span> <span data-ttu-id="b9c0a-359">Obrázek 14 zobrazuje aktualizovaný ovládacím CreateUserWizard při prohlížení v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-359">Figure 14 shows the updated CreateUserWizard when viewed through a browser.</span></span>

<span data-ttu-id="b9c0a-360">[![vlastnost CreateUserWizardStep obsahuje tlačítko Storno.](creating-user-accounts-cs/_static/image41.png)](creating-user-accounts-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-360">[![The CreateUserWizardStep Includes a Cancel Button](creating-user-accounts-cs/_static/image41.png)](creating-user-accounts-cs/_static/image40.png)</span></span>

<span data-ttu-id="b9c0a-361">**Obrázek 14**: `CreateUserWizardStep` obsahuje tlačítko Storno ([kliknutím zobrazíte obrázek v plné velikosti](creating-user-accounts-cs/_static/image42.png)).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-361">**Figure 14**: The `CreateUserWizardStep` Includes a Cancel Button  ([Click to view full-size image](creating-user-accounts-cs/_static/image42.png))</span></span>

<span data-ttu-id="b9c0a-362">Když návštěvník zadá uživatelské jméno, heslo, e-mailovou adresu a bezpečnostní otázku a odpověď a klikne na tlačítko vytvořit uživatele, vytvoří se nový uživatelský účet a návštěvník se přihlásí jako nově vytvořený uživatel.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-362">When a visitor enters a username, password, email address, and security question and answer and clicks "Create User," a new user account is created and the visitor is logged in as that newly created user.</span></span> <span data-ttu-id="b9c0a-363">Za předpokladu, že osoba, která navštíví stránku, vytváří nový účet pro sebe sama, bude to zřejmě požadovaným chováním.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-363">Assuming that the person visiting the page is creating a new account for themselves, this is likely the desired behavior.</span></span> <span data-ttu-id="b9c0a-364">Můžete ale chtít správcům dovolit přidávat nové uživatelské účty.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-364">However, you may want to allow Administrators to add new user accounts.</span></span> <span data-ttu-id="b9c0a-365">V takovém případě se vytvoří uživatelský účet, ale správce zůstane přihlášený jako správce (a ne jako nově vytvořený účet).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-365">In doing so, the user account would be created, but the Administrator would remain logged in as an Administrator (and not as the newly created account).</span></span> <span data-ttu-id="b9c0a-366">Toto chování lze upravit pomocí [vlastnosti Boolean`LoginCreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-366">This behavior can be modified through the Boolean [`LoginCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span></span>

<span data-ttu-id="b9c0a-367">Uživatelské účty v rámci systému členství obsahují příznak schválené; neschválení uživatelé se nemohou přihlásit k webu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-367">User accounts in the Membership framework contain an approved flag; users who are not approved are unable to log into the site.</span></span> <span data-ttu-id="b9c0a-368">Ve výchozím nastavení je nově vytvořený účet označený jako schválený a umožňuje uživateli, aby se k webu přihlásil hned.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-368">By default, a newly created account is marked as approved, allowing the user to log into the site immediately.</span></span> <span data-ttu-id="b9c0a-369">Je ale možné, že budou nové uživatelské účty označené jako neschválené.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-369">It is possible, however, to have new user accounts marked as unapproved.</span></span> <span data-ttu-id="b9c0a-370">Možná budete chtít, aby správce ručně schválil nové uživatele předtím, než se může přihlásit. nebo možná budete chtít ověřit, jestli je e-mailová adresa zadaná v zápisu platná, než uživatel povolí přihlášení.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-370">Perhaps you want an Administrator to manually approve new users before they can log in; or maybe you want to verify that the email address entered at signup is valid before permitting a user to log on.</span></span> <span data-ttu-id="b9c0a-371">Bez ohledu na to, že je to možné, můžete mít nově vytvořený uživatelský účet označený jako Neschválený nastavením [vlastnosti`DisableCreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx) ovládacího prvku ovládacím CreateUserWizard na hodnotu true (výchozí hodnota je false).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-371">Whatever the case may be, you can have the newly created user account marked as unapproved by setting the CreateUserWizard control's [`DisableCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx) to True (the default is False).</span></span>

<span data-ttu-id="b9c0a-372">K dalším vlastnostem souvisejícím s chováním patří `AutoGeneratePassword` a `MailDefinition`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-372">Other behavior-related properties of note include `AutoGeneratePassword` and `MailDefinition`.</span></span> <span data-ttu-id="b9c0a-373">Pokud je [vlastnost`AutoGeneratePassword`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx) nastavena na hodnotu true, v `CreateUserWizardStep` se nezobrazují textová pole Password a Confirm password; místo toho je automaticky vygenerováno heslo nově vytvořeného uživatele pomocí [metody`GeneratePassword`](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx)`Membership` třídy.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-373">If the [`AutoGeneratePassword` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx) is set to True, the `CreateUserWizardStep` does not display the "Password" and "Confirm Password" textboxes; instead, the newly-created user's password is automatically generated using the `Membership` class's [`GeneratePassword` method](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx).</span></span> <span data-ttu-id="b9c0a-374">Metoda `GeneratePassword` sestaví heslo zadané délky a s dostatečným počtem nealfanumerických znaků pro splnění nakonfigurovaných požadavků na sílu hesla.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-374">The `GeneratePassword` method constructs a password of a specified length and with a sufficient number of non-alphanumeric characters to satisfy the configured password strength requirements.</span></span>

<span data-ttu-id="b9c0a-375">[Vlastnost`MailDefinition`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) je užitečná, pokud chcete odeslat e-mail na e-mailovou adresu zadanou během procesu vytváření účtu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-375">The [`MailDefinition` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) is useful if you want to send an email to the email address specified during the account creation process.</span></span> <span data-ttu-id="b9c0a-376">Vlastnost `MailDefinition` zahrnuje řadu podvlastností pro definování informací o vytvořené e-mailové zprávě.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-376">The `MailDefinition` property includes a series of subproperties for defining information about the constructed email message.</span></span> <span data-ttu-id="b9c0a-377">Mezi tyto podvlastnosti patří možnosti jako `Subject`, `Priority`, `IsBodyHtml`, `From`, `CC`a `BodyFileName`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-377">These subproperties include options like `Subject`, `Priority`, `IsBodyHtml`, `From`, `CC`, and `BodyFileName`.</span></span> <span data-ttu-id="b9c0a-378">[Vlastnost`BodyFileName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx) odkazuje na text nebo soubor HTML, který obsahuje tělo e-mailové zprávy.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-378">The [`BodyFileName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx) points to a text or HTML file that contains the body for the email message.</span></span> <span data-ttu-id="b9c0a-379">Tělo podporuje dvě předem definované zástupné symboly: `<%UserName%>` a `<%Password%>`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-379">The body supports two pre-defined placeholders: `<%UserName%>` and `<%Password%>`.</span></span> <span data-ttu-id="b9c0a-380">Tyto zástupné symboly, pokud jsou k dispozici v souboru `BodyFileName`, budou nahrazeny jménem a heslem právě vytvořeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-380">These placeholders, if present in the `BodyFileName` file, will be replaced with the just-created user's name and password.</span></span>

> [!NOTE]
> <span data-ttu-id="b9c0a-381">Vlastnost `MailDefinition` ovládacího prvku obsahuje pouze podrobnosti o e-mailové zprávě, která je odeslána při vytvoření nového účtu. `CreateUserWizard`</span><span class="sxs-lookup"><span data-stu-id="b9c0a-381">The `CreateUserWizard` control's `MailDefinition` property just specifies details about the email message that is sent when a new account is created.</span></span> <span data-ttu-id="b9c0a-382">Neobsahuje žádné podrobnosti o tom, jak je e-mailová zpráva odeslána (tj. zda se používá server SMTP nebo odesílající poštovní schránka, všechny informace o ověřování atd.).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-382">It does not include any details on how the email message is actually sent (that is, whether an SMTP server or mail drop directory is used, any authentication information, and so on).</span></span> <span data-ttu-id="b9c0a-383">Tyto podrobnosti nízké úrovně musí být definovány v části `<system.net>` v `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-383">These low-level details need to be defined in the `<system.net>` section in `Web.config`.</span></span> <span data-ttu-id="b9c0a-384">Další informace o těchto nastaveních konfigurace a o posílání e-mailů ze ASP.NET 2,0 najdete v tématu [Nejčastější dotazy na adrese SystemNetMail.com](http://www.systemnetmail.com/) a v článku o [posílání e-mailů v ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-384">For more information on these configuration settings and on sending email from ASP.NET 2.0 in general, refer to the [FAQs at SystemNetMail.com](http://www.systemnetmail.com/) and my article, [Sending Email in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span></span>

### <a name="extending-the-createuserwizards-behavior-using-event-handlers"></a><span data-ttu-id="b9c0a-385">Rozšíření chování ovládacím CreateUserWizard pomocí obslužných rutin událostí</span><span class="sxs-lookup"><span data-stu-id="b9c0a-385">Extending the CreateUserWizard's Behavior Using Event Handlers</span></span>

<span data-ttu-id="b9c0a-386">Ovládací prvek ovládacím CreateUserWizard vyvolává během svého pracovního postupu několik událostí.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-386">The CreateUserWizard control raises a number of events during its workflow.</span></span> <span data-ttu-id="b9c0a-387">Například když návštěvník zadá své uživatelské jméno, heslo a další relevantní informace a klikne na tlačítko vytvořit uživatele, vyvolá ovládací prvek ovládacím CreateUserWizard [událost`CreatingUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-387">For example, after a visitor enters their username, password, and other pertinent information and clicks the "Create User" button, the CreateUserWizard control raises its [`CreatingUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span></span> <span data-ttu-id="b9c0a-388">Pokud během procesu vytváření dojde k problému, je vyvolána [událost`CreateUserError`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) ; Pokud je však uživatel úspěšně vytvořen, je vyvolána [událost`CreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) .</span><span class="sxs-lookup"><span data-stu-id="b9c0a-388">If there is a problem during the create process, the [`CreateUserError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) is fired; however, if the user is successfully created, then the [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) is raised.</span></span> <span data-ttu-id="b9c0a-389">K dispozici jsou další události ovládacího prvku ovládacím CreateUserWizard, které jsou vyvolány, ale jedná se o tři nejvíc německých.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-389">There are additional CreateUserWizard control events that get raised, but these are the three most germane ones.</span></span>

<span data-ttu-id="b9c0a-390">V některých scénářích můžeme chtít klepnout do pracovního postupu ovládacím CreateUserWizard, který můžeme udělat vytvořením obslužné rutiny události pro příslušnou událost.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-390">In certain scenarios we may want to tap into the CreateUserWizard workflow, which we can do by creating an event handler for the appropriate event.</span></span> <span data-ttu-id="b9c0a-391">Pro ilustraci si Vylepšete `RegisterUser` ovládací prvek ovládacím CreateUserWizard, aby zahrnoval nějaké vlastní ověření uživatelského jména a hesla.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-391">To illustrate this, let's enhance the `RegisterUser` CreateUserWizard control to include some custom validation on the username and password.</span></span> <span data-ttu-id="b9c0a-392">Konkrétně Vylepšete naše ovládacím CreateUserWizard, aby uživatelská jména neobsahovala mezery na začátku nebo na konci a uživatelské jméno se nemůže objevit kdekoli v hesle.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-392">In particular, let's enhance our CreateUserWizard so that usernames cannot contain leading or trailing spaces and the username cannot appear anywhere in the password.</span></span> <span data-ttu-id="b9c0a-393">V krátkém případě chceme uživatelům zabránit v vytváření uživatelského jména, jako je "Scott", nebo mít kombinaci uživatelského jména a hesla jako "Scott" a "Scott. 1234".</span><span class="sxs-lookup"><span data-stu-id="b9c0a-393">In short, we want to prevent someone from creating a username like "Scott ", or having a username/password combination like "Scott" and "Scott.1234".</span></span>

<span data-ttu-id="b9c0a-394">K tomuto účelu vytvoříme obslužnou rutinu události pro událost `CreatingUser`, která provede dodatečné ověřovací kontroly.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-394">To accomplish this we will create an event handler for the `CreatingUser` event to perform our extra validation checks.</span></span> <span data-ttu-id="b9c0a-395">Pokud nejsou zadaná data platná, musíme proces vytváření zrušit.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-395">If the supplied data is not valid we need to cancel the creation process.</span></span> <span data-ttu-id="b9c0a-396">Pro zobrazení zprávy s vysvětlením, že uživatelské jméno nebo heslo je neplatné, musíme také na stránku přidat webový ovládací prvek popisek.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-396">We also need to add a Label Web control to the page to display a message explaining that the username or password is invalid.</span></span> <span data-ttu-id="b9c0a-397">Začněte přidáním ovládacího prvku popisek pod ovládacím prvkem ovládacím CreateUserWizard, nastavením jeho vlastnosti `ID` na `InvalidUserNameOrPasswordMessage` a jeho vlastnost `ForeColor` na `Red`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-397">Start by adding a Label control beneath the CreateUserWizard control, setting its `ID` property to `InvalidUserNameOrPasswordMessage` and its `ForeColor` property to `Red`.</span></span> <span data-ttu-id="b9c0a-398">Vymažte vlastnost `Text` a nastavte její `EnableViewState` a `Visible` vlastnosti na false.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-398">Clear out its `Text` property and set its `EnableViewState` and `Visible` properties to False.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample7.aspx)]

<span data-ttu-id="b9c0a-399">Dále vytvořte obslužnou rutinu události pro událost `CreatingUser` ovládacího prvku ovládacím CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-399">Next, create an event handler for the CreateUserWizard control's `CreatingUser` event.</span></span> <span data-ttu-id="b9c0a-400">Chcete-li vytvořit obslužnou rutinu události, vyberte ovládací prvek v návrháři a pak přejít na okno Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-400">To create an event handler, select the control in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="b9c0a-401">Odtud klikněte na ikonu blesku a potom dvakrát klikněte na příslušnou událost a vytvořte obslužnou rutinu události.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-401">From there, click on the lightning bolt icon and then double-click the appropriate event to create the event handler.</span></span>

<span data-ttu-id="b9c0a-402">Do obslužné rutiny události `CreatingUser` přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="b9c0a-402">Add the following code to the `CreatingUser` event handler:</span></span>

[!code-csharp[Main](creating-user-accounts-cs/samples/sample8.cs)]

<span data-ttu-id="b9c0a-403">Všimněte si, že uživatelské jméno a heslo zadané do ovládacího prvku ovládacím CreateUserWizard jsou k dispozici prostřednictvím vlastností [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx) a [`Password`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx)v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-403">Note that the username and password entered into the CreateUserWizard control are available through its [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx), respectively.</span></span> <span data-ttu-id="b9c0a-404">Tyto vlastnosti používáme ve výše uvedené obslužné rutině události k určení, jestli zadané uživatelské jméno obsahuje mezery na začátku nebo na konci a zda se uživatelské jméno nachází v hesle.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-404">We use these properties in the above event handler to determine whether the supplied username contains leading or trailing spaces and whether the username is found within the password.</span></span> <span data-ttu-id="b9c0a-405">Pokud je splněna jedna z těchto podmínek, zobrazí se chybová zpráva v popisku `InvalidUserNameOrPasswordMessage` a vlastnost `e.Cancel` obslužné rutiny události je nastavena na `true`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-405">If either of these conditions is met, an error message is displayed in the `InvalidUserNameOrPasswordMessage` Label and the event handler's `e.Cancel` property is set to `true`.</span></span> <span data-ttu-id="b9c0a-406">Pokud je `e.Cancel` nastavená na `true`, ovládacím CreateUserWizard krátkodobé okruhy svého pracovního postupu, což efektivně zruší proces vytváření uživatelských účtů.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-406">If `e.Cancel` is set to `true`, the CreateUserWizard short-circuits its workflow, effectively cancelling the user account creation process.</span></span>

<span data-ttu-id="b9c0a-407">Obrázek 15 znázorňuje snímek obrazovky `CreatingUserAccounts.aspx`, když uživatel zadá uživatelské jméno s úvodními mezerami.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-407">Figure 15 shows a screen shot of `CreatingUserAccounts.aspx` when the user enters a username with leading spaces.</span></span>

<span data-ttu-id="b9c0a-408">[![uživatelská jména s počátečními nebo koncovými mezerami nejsou povolené.](creating-user-accounts-cs/_static/image44.png)](creating-user-accounts-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-408">[![Usernames with Leading or Trailing Spaces are not Permitted](creating-user-accounts-cs/_static/image44.png)](creating-user-accounts-cs/_static/image43.png)</span></span>

<span data-ttu-id="b9c0a-409">**Obrázek 15**: uživatelská jména s úvodními nebo koncovými mezerami nejsou povolena ([kliknutím zobrazíte obrázek v plné velikosti).](creating-user-accounts-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-409">**Figure 15**: Usernames with Leading or Trailing Spaces are not Permitted  ([Click to view full-size image](creating-user-accounts-cs/_static/image45.png))</span></span>

> [!NOTE]
> <span data-ttu-id="b9c0a-410">V kurzu  *<a id="_msoanchor_11">[ ](storing-additional-user-information-cs.md)</a>ukládání dalších informací o uživatelích* se zobrazí příklad použití události `CreatedUser` ovládacího prvku ovládacím CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-410">We will see an example of using the CreateUserWizard control's `CreatedUser` event in the *<a id="_msoanchor_11"></a>[Storing Additional User Information](storing-additional-user-information-cs.md)* tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="b9c0a-411">Souhrn</span><span class="sxs-lookup"><span data-stu-id="b9c0a-411">Summary</span></span>

<span data-ttu-id="b9c0a-412">Metoda `CreateUser` třídy `Membership` vytvoří nový uživatelský účet v rámci rozhraní členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-412">The `Membership` class's `CreateUser` method creates a new user account in the Membership framework.</span></span> <span data-ttu-id="b9c0a-413">Provede tak delegováním volání nakonfigurovanému zprostředkovateli členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-413">It does so by delegating the call to the configured Membership provider.</span></span> <span data-ttu-id="b9c0a-414">V případě `SqlMembershipProvider`přidá metoda `CreateUser` záznam do tabulek databáze `aspnet_Users` a `aspnet_Membership`.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-414">In the case of the `SqlMembershipProvider`, the `CreateUser` method adds a record to the `aspnet_Users` and `aspnet_Membership` database tables.</span></span>

<span data-ttu-id="b9c0a-415">Zatímco nové uživatelské účty je možné vytvářet programově (jak jsme viděli v kroku 5), je rychlejší a jednodušší přístup k použití ovládacího prvku ovládacím CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-415">While new user accounts can be created programmatically (as we saw in Step 5), a faster and easier approach is to use the CreateUserWizard control.</span></span> <span data-ttu-id="b9c0a-416">Tento ovládací prvek vykreslí uživatelské rozhraní s více kroky pro shromažďování uživatelských informací a vytvoření nového uživatele v rámci systému členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-416">This control renders a multi-step user interface for collecting user information and creating a new user in the Membership framework.</span></span> <span data-ttu-id="b9c0a-417">Pod sebou tento ovládací prvek používá stejnou metodu `Membership.CreateUser`, jak je vyhodnoceno v kroku 5, ale ovládací prvek vytvoří uživatelské rozhraní, ovládací prvky ověřování a reaguje na chyby při vytváření uživatelského účtu, aniž by musel psát Lick kódu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-417">Underneath the covers, this control uses the same `Membership.CreateUser` method as examined in Step 5, but the control creates the user interface, validation controls, and responds to user account creation errors without having to write a lick of code.</span></span>

<span data-ttu-id="b9c0a-418">V tuto chvíli máme funkci pro vytváření nových uživatelských účtů.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-418">At this point we have the functionality in place to create new user accounts.</span></span> <span data-ttu-id="b9c0a-419">Přihlašovací stránka se ale pořád ověřuje na základě pevně zakódovaných přihlašovacích údajů, které jsme zadali zpátky v druhém kurzu.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-419">However, the login page still is validating against those hard-coded credentials we specified back in the second tutorial.</span></span> <span data-ttu-id="b9c0a-420"><a id="_msoanchor_12"> </a>V [dalším kurzu](validating-user-credentials-against-the-membership-user-store-cs.md) aktualizujeme `Login.aspx`, aby se ověřilo zadání přihlašovacích údajů uživatele k rozhraní členství.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-420">In the <a id="_msoanchor_12"></a>[next tutorial](validating-user-credentials-against-the-membership-user-store-cs.md) we will update `Login.aspx` to validate the user's supplied credentials against the Membership framework.</span></span>

<span data-ttu-id="b9c0a-421">Šťastné programování!</span><span class="sxs-lookup"><span data-stu-id="b9c0a-421">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="b9c0a-422">Další čtení</span><span class="sxs-lookup"><span data-stu-id="b9c0a-422">Further Reading</span></span>

<span data-ttu-id="b9c0a-423">Další informace o tématech popsaných v tomto kurzu najdete v následujících zdrojích informací:</span><span class="sxs-lookup"><span data-stu-id="b9c0a-423">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="b9c0a-424">`CreateUser` technickou dokumentaci</span><span class="sxs-lookup"><span data-stu-id="b9c0a-424">`CreateUser` Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.security.membershipprovider.createuser.aspx)
- [<span data-ttu-id="b9c0a-425">Přehled ovládacího prvku ovládacím CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="b9c0a-425">CreateUserWizard Control Overview</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx)
- [<span data-ttu-id="b9c0a-426">Vytvoření poskytovatele mapy webu založeného na systému souborů</span><span class="sxs-lookup"><span data-stu-id="b9c0a-426">Creating a File System-Based Site Map Provider</span></span>](http://aspnet.4guysfromrolla.com/articles/020106-1.aspx)
- [<span data-ttu-id="b9c0a-427">Vytvoření podrobného uživatelského rozhraní pomocí ovládacího prvku Průvodce ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="b9c0a-427">Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)
- [<span data-ttu-id="b9c0a-428">Prověřování navigace na webu ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="b9c0a-428">Examining ASP.NET 2.0's Site Navigation</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [<span data-ttu-id="b9c0a-429">Stránky předlohy a navigace na webu</span><span class="sxs-lookup"><span data-stu-id="b9c0a-429">Master Pages and Site Navigation</span></span>](https://asp.net/learn/data-access/tutorial-03-vb.aspx)
- [<span data-ttu-id="b9c0a-430">Poskytovatel mapy webu SQL, na který jste čekali</span><span class="sxs-lookup"><span data-stu-id="b9c0a-430">The SQL Site Map Provider You've Been Waiting For</span></span>](https://msdn.microsoft.com/msdnmag/issues/06/02/WickedCode/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="b9c0a-431">O autorovi</span><span class="sxs-lookup"><span data-stu-id="b9c0a-431">About the Author</span></span>

<span data-ttu-id="b9c0a-432">Scott Mitchell, autor několika stránek ASP/ASP. NET Books a zakladatel of 4GuysFromRolla.com, pracoval s webovými technologiemi Microsoftu od 1998.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-432">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b9c0a-433">Scott funguje jako nezávislý konzultant, Trainer a zapisovač.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-433">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b9c0a-434">Nejnovější kniha je *[Sams naučit se ASP.NET 2,0 za 24 hodin](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="b9c0a-434">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="b9c0a-435">Scott se dá kontaktovat [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) nebo prostřednictvím svého blogu na [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-435">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="b9c0a-436">Zvláštní díky...</span><span class="sxs-lookup"><span data-stu-id="b9c0a-436">Special Thanks To…</span></span>

<span data-ttu-id="b9c0a-437">Tato řada kurzů byla přezkoumána mnoha užitečnými kontrolory.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-437">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b9c0a-438">Kontrolor pro tento kurz byl Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="b9c0a-438">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="b9c0a-439">Uvažujete o přezkoumání mých nadcházejících článků na webu MSDN?</span><span class="sxs-lookup"><span data-stu-id="b9c0a-439">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b9c0a-440">Pokud ano, vyřaďte mi řádek na [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="b9c0a-440">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b9c0a-441">[Předchozí](creating-the-membership-schema-in-sql-server-cs.md)
> [Další](validating-user-credentials-against-the-membership-user-store-cs.md)</span><span class="sxs-lookup"><span data-stu-id="b9c0a-441">[Previous](creating-the-membership-schema-in-sql-server-cs.md)
[Next](validating-user-credentials-against-the-membership-user-store-cs.md)</span></span>
