---
uid: web-forms/overview/older-versions-security/roles/creating-and-managing-roles-cs
title: Vytváření a Správa rolí (C#) | Dokumentace Microsoftu
author: rick-anderson
description: Tento kurz zkoumá kroky potřebné ke konfiguraci rozhraní role. Pod vytváříme webové stránky, vytvářet a odstraňovat role.
ms.author: riande
ms.date: 03/24/2008
ms.assetid: 113f10b3-a19a-471b-8ff6-db3c79ce8a91
msc.legacyurl: /web-forms/overview/older-versions-security/roles/creating-and-managing-roles-cs
msc.type: authoredcontent
ms.openlocfilehash: 3ee858cba449b0a8c8e693970a10ce0182e8c3da
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/09/2019
ms.locfileid: "59412395"
---
# <a name="creating-and-managing-roles-c"></a><span data-ttu-id="0df7d-104">Vytváření a správa rolí (C#)</span><span class="sxs-lookup"><span data-stu-id="0df7d-104">Creating and Managing Roles (C#)</span></span>

<span data-ttu-id="0df7d-105">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0df7d-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0df7d-106">[Stáhněte si kód](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.09.zip) nebo [stahovat PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="0df7d-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.09.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_cs.pdf)</span></span>

> <span data-ttu-id="0df7d-107">Tento kurz zkoumá kroky potřebné ke konfiguraci rozhraní role.</span><span class="sxs-lookup"><span data-stu-id="0df7d-107">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="0df7d-108">Pod vytváříme webové stránky, vytvářet a odstraňovat role.</span><span class="sxs-lookup"><span data-stu-id="0df7d-108">Following that, we will build web pages to create and delete roles.</span></span>


## <a name="introduction"></a><span data-ttu-id="0df7d-109">Úvod</span><span class="sxs-lookup"><span data-stu-id="0df7d-109">Introduction</span></span>

<span data-ttu-id="0df7d-110">V <a id="_msoanchor_1"> </a> [ *autorizace na základě uživatele* ](../membership/user-based-authorization-cs.md) kurzu jsme zvažovali omezit určitým uživatelům sadu stránek pomocí autorizace adres URL a prozkoumali jste ji deklarativní a programové techniky pro úpravu funkcí stránky technologie ASP.NET na základě hostujícími uživatele.</span><span class="sxs-lookup"><span data-stu-id="0df7d-110">In the <a id="_msoanchor_1"></a>[*User-Based Authorization*](../membership/user-based-authorization-cs.md) tutorial we looked at using URL authorization to restrict certain users from a set of pages and explored declarative and programmatic techniques for adjusting an ASP.NET page's functionality based on the visiting user.</span></span> <span data-ttu-id="0df7d-111">Udělení oprávnění pro přístup stránky nebo funkce na základě uživatele uživatelů, ale může být připomínající údržby ve scénářích tam, kde existuje mnoho uživatelské účty nebo při změně oprávnění uživatelů často.</span><span class="sxs-lookup"><span data-stu-id="0df7d-111">Granting permission for page access or functionality on a user-by-user basis, however, can become a maintenance nightmare in scenarios where there are many user accounts or when users' privileges change often.</span></span> <span data-ttu-id="0df7d-112">Kdykoli uživatel získá nebo ztratí oprávnění k provedení určitého úkolu, správce je potřeba aktualizovat příslušné autorizačních pravidel adres URL, deklarativní značek a kódu.</span><span class="sxs-lookup"><span data-stu-id="0df7d-112">Any time a user gains or loses authorization to perform a particular task, the administrator needs to update the appropriate URL authorization rules, declarative markup, and code.</span></span>

<span data-ttu-id="0df7d-113">Obvykle pomáhá klasifikovat uživatele do skupin nebo *role* a pak použít oprávnění na základě rolí role.</span><span class="sxs-lookup"><span data-stu-id="0df7d-113">It usually helps to classify users into groups or *roles* and then to apply permissions on a role-by-role basis.</span></span> <span data-ttu-id="0df7d-114">Například většiny webových aplikací mají určité sady stránek neboli úlohy, které jsou vyhrazené jenom pro správce.</span><span class="sxs-lookup"><span data-stu-id="0df7d-114">For example, most web applications have a certain set of pages or tasks that are reserved only for administrative users.</span></span> <span data-ttu-id="0df7d-115">Pomocí technik získané v *autorizace na základě uživatele* kurz, doporučujeme přidat odpovídající autorizačních pravidel adres URL, deklarativní značek a kódu tak, aby zadané uživatelské účty k provádění úloh správy.</span><span class="sxs-lookup"><span data-stu-id="0df7d-115">Using the techniques learned in the *User-Based Authorization* tutorial, we would add the appropriate URL authorization rules, declarative markup, and code to allow the specified user accounts to perform administrative tasks.</span></span> <span data-ttu-id="0df7d-116">Ale pokud byl přidán nový správce nebo správce existující potřeba pro její administrativní oprávnění odvolat, musíme se vraťte a aktualizovat konfigurační soubory a webové stránky.</span><span class="sxs-lookup"><span data-stu-id="0df7d-116">But if a new administrator was added or if an existing administrator needed to have her administration rights revoked, we would have to return and update the configuration files and web pages.</span></span> <span data-ttu-id="0df7d-117">S rolemi ale jsme může vytvořit roli s názvem Správci a přiřaďte důvěryhodného uživatele k roli Administrators.</span><span class="sxs-lookup"><span data-stu-id="0df7d-117">With roles, however, we could create a role called Administrators and assign those trusted users to the Administrators role.</span></span> <span data-ttu-id="0df7d-118">Dále doporučujeme přidat odpovídající autorizačních pravidel adres URL, deklarativní a kód umožňující role Správci nástroje k provádění různých administrativních úloh.</span><span class="sxs-lookup"><span data-stu-id="0df7d-118">Next, we would add the appropriate URL authorization rules, declarative markup, and code to allow the Administrators role to perform the various administrative tasks.</span></span> <span data-ttu-id="0df7d-119">Pomocí této infrastruktury na místě je snadné – stačí včetně nebo odebrání uživatele z role správce přidávání nových správců k webu nebo odstranění existující aplikace.</span><span class="sxs-lookup"><span data-stu-id="0df7d-119">With this infrastructure in place, adding new administrators to the site or removing existing ones is as simple as including or removing the user from the Administrators role.</span></span> <span data-ttu-id="0df7d-120">Žádné konfigurace, deklarativní nebo změny kódu jsou nezbytné.</span><span class="sxs-lookup"><span data-stu-id="0df7d-120">No configuration, declarative markup, or code changes are necessary.</span></span>

<span data-ttu-id="0df7d-121">Technologie ASP.NET nabízí rozhraní role pro definování rolí a jejich přidružení k uživatelské účty.</span><span class="sxs-lookup"><span data-stu-id="0df7d-121">ASP.NET offers a Roles framework for defining roles and associating them with user accounts.</span></span> <span data-ttu-id="0df7d-122">S použitím rozhraní framework role můžeme vytvářet a odstraňovat rolí, přidejte uživatele nebo odebrat uživatele z role, určit sadu uživatelů, kteří patří do určité role a zjistit, zda uživatel patří do určité role.</span><span class="sxs-lookup"><span data-stu-id="0df7d-122">With the Roles framework we can create and delete roles, add users to or remove users from a role, determine the set of users that belong to a particular role, and tell whether a user belongs to a particular role.</span></span> <span data-ttu-id="0df7d-123">Jakmile rozhraní role není nakonfigurovaná, můžeme omezit přístup ke stránkám na základě rolí role pomocí autorizačních pravidel adres URL a zobrazit nebo skrýt další informace nebo funkce na stránku na základě rolí pro aktuálně přihlášeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="0df7d-123">Once the Roles framework has been configured, we can limit access to pages on a role-by-role basis through URL authorization rules and show or hide additional information or functionality on a page based on the currently logged on user's roles.</span></span>

<span data-ttu-id="0df7d-124">Tento kurz zkoumá kroky potřebné ke konfiguraci rozhraní role.</span><span class="sxs-lookup"><span data-stu-id="0df7d-124">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="0df7d-125">Pod vytváříme webové stránky, vytvářet a odstraňovat role.</span><span class="sxs-lookup"><span data-stu-id="0df7d-125">Following that, we will build web pages to create and delete roles.</span></span> <span data-ttu-id="0df7d-126">V <a id="_msoanchor_2"> </a> [ *přiřazení rolí uživatelům* ](assigning-roles-to-users-cs.md) kurzu se podíváme na tom, jak přidávat a odebírat uživatele z role.</span><span class="sxs-lookup"><span data-stu-id="0df7d-126">In the <a id="_msoanchor_2"></a>[*Assigning Roles to Users*](assigning-roles-to-users-cs.md) tutorial we will look at how to add and remove users from roles.</span></span> <span data-ttu-id="0df7d-127">A <a id="_msoanchor_3"> </a> [ *autorizace na základě rolí* ](role-based-authorization-cs.md) kurzu uvidíme, jak omezit přístup ke stránkám na základě rolí role spolu s jak upravit v závislosti funkce stránky hostujícími uživatelské role.</span><span class="sxs-lookup"><span data-stu-id="0df7d-127">And in the <a id="_msoanchor_3"></a>[*Role-Based Authorization*](role-based-authorization-cs.md) tutorial we will see how to limit access to pages on a role-by-role basis along with how to adjust page functionality depending on the visiting user's role.</span></span> <span data-ttu-id="0df7d-128">Pusťme se do práce!</span><span class="sxs-lookup"><span data-stu-id="0df7d-128">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="0df7d-129">Krok 1: Přidání nové stránky ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0df7d-129">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="0df7d-130">V tomto kurzu a další dvě jsme se zkoumání různých funkcí souvisejících s rolí a funkcí.</span><span class="sxs-lookup"><span data-stu-id="0df7d-130">In this tutorial and the next two we will be examining various roles-related functions and capabilities.</span></span> <span data-ttu-id="0df7d-131">Potřebujeme sérii stránek ASP.NET k implementaci témata prozkoumat v rámci těchto kurzů.</span><span class="sxs-lookup"><span data-stu-id="0df7d-131">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="0df7d-132">Pojďme vytvořit tyto stránky a aktualizaci mapy webu.</span><span class="sxs-lookup"><span data-stu-id="0df7d-132">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="0df7d-133">Začněte tím, že vytvoříte novou složku v projektu s názvem `Roles`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-133">Start by creating a new folder in the project named `Roles`.</span></span> <span data-ttu-id="0df7d-134">V dalším kroku přidejte čtyři nové stránky ASP.NET do `Roles` složky propojení s každou stránku `Site.master` stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="0df7d-134">Next, add four new ASP.NET pages to the `Roles` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="0df7d-135">Název stránky:</span><span class="sxs-lookup"><span data-stu-id="0df7d-135">Name the pages:</span></span>

- `ManageRoles.aspx`
- `UsersAndRoles.aspx`
- `CreateUserWizardWithRoles.aspx`
- `RoleBasedAuthorization.aspx`

<span data-ttu-id="0df7d-136">Průzkumník řešení vašeho projektu v tomto okamžiku by měl vypadat podobně jako obrazovky je vidět na obrázku 1.</span><span class="sxs-lookup"><span data-stu-id="0df7d-136">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>


[![F<span data-ttu-id="0df7d-137">Naše nové stránky byly přidány do složky role]</span><span class="sxs-lookup"><span data-stu-id="0df7d-137">our New Pages Have Been Added to the Roles Folder]</span></span>(creating-and-managing-roles-cs/_static/image2.png)](creating-and-managing-roles-cs/_static/image1.png)

<span data-ttu-id="0df7d-138">**Obrázek 1**: Čtyři nové stránky byly přidány do `Roles` složky ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-and-managing-roles-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0df7d-138">**Figure 1**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image3.png))</span></span>


<span data-ttu-id="0df7d-139">Jednotlivé stránky, v tomto okamžiku má dva ovládací prvky obsahu, jeden pro každou z prvků ContentPlaceHolder na hlavní stránce: `MainContent` a `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-139">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample1.aspx)]

<span data-ttu-id="0df7d-140">Vzpomeňte si, že `LoginContent` ContentPlaceHolder jeho výchozí značky zobrazí odkaz na přihlášení nebo odhlášení uživatele na webu, v závislosti na tom, jestli je uživatel ověřený.</span><span class="sxs-lookup"><span data-stu-id="0df7d-140">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="0df7d-141">Přítomnost `Content2` obsahu ovládacího prvku do stránky ASP.NET, ale přepíše kódu výchozí hlavní stránky.</span><span class="sxs-lookup"><span data-stu-id="0df7d-141">The presence of the `Content2` Content control in the ASP.NET page, however, overrides the master page's default markup.</span></span> <span data-ttu-id="0df7d-142">Jak jsme probírali v <a id="_msoanchor_4"> </a> [ *Přehled ověřování založené na formulářích* ](../introduction/an-overview-of-forms-authentication-cs.md) kurzu přepisuje výchozí značky jsou užitečné v stránky, kde jsme nechcete zobrazit související s přihlášením Možnosti v levém sloupci.</span><span class="sxs-lookup"><span data-stu-id="0df7d-142">As we discussed in <a id="_msoanchor_4"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, overriding the default markup is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="0df7d-143">Pro tyto čtyři stránky, ale má být zobrazena na hlavní stránce výchozí značky `LoginContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="0df7d-143">For these four pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="0df7d-144">Proto odebrat deklarativní `Content2` ovládacího prvku obsahu.</span><span class="sxs-lookup"><span data-stu-id="0df7d-144">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="0df7d-145">Až to uděláte, všechny čtyři stránky značek by měl obsahovat pouze jeden ovládací prvek obsahu.</span><span class="sxs-lookup"><span data-stu-id="0df7d-145">After doing so, each of the four page's markup should contain just one Content control.</span></span>

<span data-ttu-id="0df7d-146">A konečně, můžeme aktualizovat mapy webu (`Web.sitemap`) zahrnout tyto nové webové stránky.</span><span class="sxs-lookup"><span data-stu-id="0df7d-146">Finally, let's update the site map (`Web.sitemap`) to include these new web pages.</span></span> <span data-ttu-id="0df7d-147">Přidejte následující kód XML po `<siteMapNode>` jsme přidali kurzy členství.</span><span class="sxs-lookup"><span data-stu-id="0df7d-147">Add the following XML after the `<siteMapNode>` we added for the Membership tutorials.</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample2.xml)]

<span data-ttu-id="0df7d-148">Pomocí mapy webu, aktualizovat přejděte na web prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="0df7d-148">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="0df7d-149">Jak je vidět na obrázku 2, navigaci na levé straně teď obsahuje položky pro role kurzy.</span><span class="sxs-lookup"><span data-stu-id="0df7d-149">As Figure 2 shows, the navigation on the left now includes items for the Roles tutorials.</span></span>


[![F<span data-ttu-id="0df7d-150">Naše nové stránky byly přidány do složky role]</span><span class="sxs-lookup"><span data-stu-id="0df7d-150">our New Pages Have Been Added to the Roles Folder]</span></span>(creating-and-managing-roles-cs/_static/image5.png)](creating-and-managing-roles-cs/_static/image4.png)

<span data-ttu-id="0df7d-151">**Obrázek 2**: Čtyři nové stránky byly přidány do `Roles` složky ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-and-managing-roles-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0df7d-151">**Figure 2**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image6.png))</span></span>


## <a name="step-2-specifying-and-configuring-the-roles-framework-provider"></a><span data-ttu-id="0df7d-152">Krok 2: Určení a konfigurace poskytovatele rozhraní Framework role</span><span class="sxs-lookup"><span data-stu-id="0df7d-152">Step 2: Specifying and Configuring the Roles Framework Provider</span></span>

<span data-ttu-id="0df7d-153">Jako jsou členství v rámci rozhraní role propojitelnosti podle modelu poskytovatele.</span><span class="sxs-lookup"><span data-stu-id="0df7d-153">Like the Membership framework, the Roles framework is built atop the provider model.</span></span> <span data-ttu-id="0df7d-154">Jak je popsáno v <a id="_msoanchor_5"> </a> [ *Základy zabezpečení a podpora ASP.NET* ](../introduction/security-basics-and-asp-net-support-cs.md) kurzu rozhraní .NET Framework se dodává s tři předdefinované role zprostředkovatele: [ `AuthorizationStoreRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx) , [ `WindowsTokenRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx), a [ `SqlRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span><span class="sxs-lookup"><span data-stu-id="0df7d-154">As discussed in the <a id="_msoanchor_5"></a>[*Security Basics and ASP.NET Support*](../introduction/security-basics-and-asp-net-support-cs.md) tutorial, the .NET Framework ships with three built-in Roles providers: [`AuthorizationStoreRoleProvider`](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx), [`WindowsTokenRoleProvider`](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx), and [`SqlRoleProvider`](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span></span> <span data-ttu-id="0df7d-155">V této sérii kurzů se zaměřuje na `SqlRoleProvider`, který používá databázi serveru Microsoft SQL Server jako úložiště rolí.</span><span class="sxs-lookup"><span data-stu-id="0df7d-155">This tutorial series focuses on the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span>

<span data-ttu-id="0df7d-156">Na pozadí rozhraní role a `SqlRoleProvider` pracovat stejně jako rozhraní členství a `SqlMembershipProvider`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-156">Underneath the covers the Roles framework and `SqlRoleProvider` work just like the Membership framework and `SqlMembershipProvider`.</span></span> <span data-ttu-id="0df7d-157">Rozhraní .NET Framework obsahuje `Roles` třída, která slouží jako rozhraní API pro role rozhraní framework.</span><span class="sxs-lookup"><span data-stu-id="0df7d-157">The .NET Framework contains a `Roles` class that serves as the API to the Roles framework.</span></span> <span data-ttu-id="0df7d-158">`Roles` Třída má statické metody, jako je `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`a tak dále.</span><span class="sxs-lookup"><span data-stu-id="0df7d-158">The `Roles` class has static methods like `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`, and so forth.</span></span> <span data-ttu-id="0df7d-159">Při vyvolání jedné z těchto metod `Roles` deleguje třída volání konfigurovaný poskytovatel.</span><span class="sxs-lookup"><span data-stu-id="0df7d-159">When one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="0df7d-160">`SqlRoleProvider` Pracuje s tabulkami konkrétní role (`aspnet_Roles` a `aspnet_UsersInRoles`) v odpovědi.</span><span class="sxs-lookup"><span data-stu-id="0df7d-160">The `SqlRoleProvider` works with the role-specific tables (`aspnet_Roles` and `aspnet_UsersInRoles`) in response.</span></span>

<span data-ttu-id="0df7d-161">Chcete-li použít `SqlRoleProvider` zprostředkovatele v naší aplikaci, potřebujeme k určení, co Pokud chcete použít jako úložiště databáze.</span><span class="sxs-lookup"><span data-stu-id="0df7d-161">In order to use the `SqlRoleProvider` provider in our application, we need to specify what database to use as the store.</span></span> <span data-ttu-id="0df7d-162">`SqlRoleProvider` Očekává, že úložiště Zadaná role má určitá databázových tabulek, zobrazení a uložených procedur.</span><span class="sxs-lookup"><span data-stu-id="0df7d-162">The `SqlRoleProvider` expects the specified role store to have certain database tables, views, and stored procedures.</span></span> <span data-ttu-id="0df7d-163">Tyto objekty požadované databáze můžete přidat pomocí [ `aspnet_regsql.exe` nástroj](https://msdn.microsoft.com/library/ms229862.aspx).</span><span class="sxs-lookup"><span data-stu-id="0df7d-163">These requisite database objects can be added using the [`aspnet_regsql.exe` tool](https://msdn.microsoft.com/library/ms229862.aspx).</span></span> <span data-ttu-id="0df7d-164">V tuto chvíli jsme už máte databázi se schématem, které jsou nezbytné pro `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-164">At this point we already have a database with the schema necessary for the `SqlRoleProvider`.</span></span> <span data-ttu-id="0df7d-165">Zpátky <a id="_msoanchor_6"> </a> [ *vytvoření schématu členství v SQL serveru* ](../membership/creating-the-membership-schema-in-sql-server-cs.md) kurzu jsme vytvořili databázi s názvem `SecurityTutorials.mdf` a použít `aspnet_regsql.exe` pro přidání aplikace služby, které zahrnuty databázové objekty nezbytné podle `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-165">Back in the <a id="_msoanchor_6"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-cs.md) tutorial we created a database named `SecurityTutorials.mdf` and used `aspnet_regsql.exe` to add the application services, which included the database objects required by the `SqlRoleProvider`.</span></span> <span data-ttu-id="0df7d-166">Proto potřebujeme k informování rozhraní framework role povolit podporu role a použít `SqlRoleProvider` s `SecurityTutorials.mdf` databáze jako úložiště rolí.</span><span class="sxs-lookup"><span data-stu-id="0df7d-166">Therefore we just need to tell the Roles framework to enable role support and to use the `SqlRoleProvider` with the `SecurityTutorials.mdf` database as the role store.</span></span>

<span data-ttu-id="0df7d-167">Role rozhraní se konfiguruje prostřednictvím &lt; `roleManager` &gt; elementu v aplikaci prvku `Web.config` souboru.</span><span class="sxs-lookup"><span data-stu-id="0df7d-167">The Roles framework is configured via the &lt;`roleManager`&gt; element in the application's `Web.config` file.</span></span> <span data-ttu-id="0df7d-168">Podpora role je ve výchozím nastavení zakázána.</span><span class="sxs-lookup"><span data-stu-id="0df7d-168">By default, role support is disabled.</span></span> <span data-ttu-id="0df7d-169">Ho Pokud chcete povolit, je nutné nastavit [ &lt; `roleManager` &gt; ](https://msdn.microsoft.com/library/ms164660.aspx) elementu `enabled` atribut `true` takto:</span><span class="sxs-lookup"><span data-stu-id="0df7d-169">To enable it, you must set the [&lt;`roleManager`&gt;](https://msdn.microsoft.com/library/ms164660.aspx) element's `enabled` attribute to `true` like so:</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample3.xml)]

<span data-ttu-id="0df7d-170">Ve výchozím nastavení, mají všechny webové aplikace zprostředkovatele rolí s názvem `AspNetSqlRoleProvider` typu `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-170">By default, all web applications have a Roles provider named `AspNetSqlRoleProvider` of type `SqlRoleProvider`.</span></span> <span data-ttu-id="0df7d-171">Tento výchozí zprostředkovatel je registrován v `machine.config` (umístěný ve `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span><span class="sxs-lookup"><span data-stu-id="0df7d-171">This default provider is registered in `machine.config` (located at `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample4.xml)]

<span data-ttu-id="0df7d-172">Poskytovatele `connectionStringName` atribut určuje, který se používá úložiště rolí.</span><span class="sxs-lookup"><span data-stu-id="0df7d-172">The provider's `connectionStringName` attribute specifies the role store that is used.</span></span> <span data-ttu-id="0df7d-173">`AspNetSqlRoleProvider` Poskytovatele nastaví tento atribut na `LocalSqlServer`, který je definován také v `machine.config` a body, ve výchozím nastavení se k databázi SQL Server 2005 Express Edition `App_Data` složku s názvem `aspnet.mdf`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-173">The `AspNetSqlRoleProvider` provider sets this attribute to `LocalSqlServer`, which is also defined in `machine.config` and points, by default, to a SQL Server 2005 Express Edition database in the `App_Data` folder named `aspnet.mdf`.</span></span>

<span data-ttu-id="0df7d-174">V důsledku toho pokud jsme bez zadání jakékoli informace o poskytovateli v naší aplikaci jednoduše povolit rozhraní framework role `Web.config` soubor, aplikace používá zprostředkovatel rolí výchozí registrované `AspNetSqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-174">Consequently, if we simply enable the Roles framework without specifying any provider information in our application's `Web.config` file, the application uses the default registered Roles provider, `AspNetSqlRoleProvider`.</span></span> <span data-ttu-id="0df7d-175">Pokud `~/App_Data/aspnet.mdf` databáze buď neexistuje, automaticky ji vytvoříte a přidáte schématu aplikací služby modulu runtime ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0df7d-175">If the `~/App_Data/aspnet.mdf` database does not exist, the ASP.NET runtime will automatically create it and add the application services schema.</span></span> <span data-ttu-id="0df7d-176">Nechceme však použít `aspnet.mdf` databáze; místo toho chceme použít `SecurityTutorials.mdf` databáze, který jsme už vytvořili a přidali schématu služby aplikace.</span><span class="sxs-lookup"><span data-stu-id="0df7d-176">However, we don't want to use the `aspnet.mdf` database; rather, we want to use the `SecurityTutorials.mdf` database that we have already created and added the application services schema to.</span></span> <span data-ttu-id="0df7d-177">Tato změna lze provést jedním ze dvou způsobů:</span><span class="sxs-lookup"><span data-stu-id="0df7d-177">This modification can be accomplished in one of two ways:</span></span>

- <span data-ttu-id="0df7d-178"><strong>Zadejte hodnotu</strong><strong>`LocalSqlServer`</strong><strong>název připojovacího řetězce v</strong><strong>`Web.config`</strong><strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="0df7d-178"><strong>Specify a value for the</strong><strong>`LocalSqlServer`</strong><strong>connection string name in</strong><strong>`Web.config`</strong><strong>.</strong></span></span> <span data-ttu-id="0df7d-179">Přepsáním `LocalSqlServer` hodnotu název připojovacího řetězce v `Web.config`, můžeme použít výchozí zaregistrovaný zprostředkovatel rolí (`AspNetSqlRoleProvider`) a jeho správně pracovat `SecurityTutorials.mdf` databáze.</span><span class="sxs-lookup"><span data-stu-id="0df7d-179">By overwriting the `LocalSqlServer` connection string name value in `Web.config`, we can use the default registered Roles provider (`AspNetSqlRoleProvider`) and have it correctly work with the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="0df7d-180">Další informace o této techniky najdete v tématu [Scott Guthrie](https://weblogs.asp.net/scottgu/)pro blogový příspěvek [konfigurace technologie ASP.NET 2.0 aplikačními službami, abyste pomocí SQL Server 2000 nebo SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span><span class="sxs-lookup"><span data-stu-id="0df7d-180">For more information on this technique, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Configuring ASP.NET 2.0 Application Services to Use SQL Server 2000 or SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span></span>
- <span data-ttu-id="0df7d-181"><strong>Přidat nového poskytovatele registrovaného typu</strong><strong>`SqlRoleProvider`</strong><strong>a nakonfigurovat jeho</strong><strong>`connectionStringName`</strong><strong>nastavení tak, aby odkazoval</strong> <strong>`SecurityTutorials.mdf`</strong> <strong>databáze.</strong></span><span class="sxs-lookup"><span data-stu-id="0df7d-181"><strong>Add a new registered provider of type</strong><strong>`SqlRoleProvider`</strong><strong>and configure its</strong><strong>`connectionStringName`</strong><strong>setting to point to the</strong><strong>`SecurityTutorials.mdf`</strong><strong>database.</strong></span></span> <span data-ttu-id="0df7d-182">Jedná se o postup I doporučené a použít v <a id="_msoanchor_7"> </a> [ *vytvoření schématu členství v SQL serveru* ](../membership/creating-the-membership-schema-in-sql-server-cs.md) kurzu a je využívána v tomto kurzu také přístup.</span><span class="sxs-lookup"><span data-stu-id="0df7d-182">This is the approach I recommended and used in the <a id="_msoanchor_7"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-cs.md) tutorial, and it is the approach I will use in this tutorial as well.</span></span>

<span data-ttu-id="0df7d-183">Přidejte následující kód konfigurace rolí k `Web.config` souboru.</span><span class="sxs-lookup"><span data-stu-id="0df7d-183">Add the following Roles configuration markup to the `Web.config` file.</span></span> <span data-ttu-id="0df7d-184">Tento kód zaregistruje nový zprostředkovatel s názvem `SecurityTutorialsSqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-184">This markup registers a new provider named `SecurityTutorialsSqlRoleProvider`.</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample5.xml)]

<span data-ttu-id="0df7d-185">Výše uvedené značky definují `SecurityTutorialsSqlRoleProvider` jako výchozího zprostředkovatele (prostřednictvím `defaultProvider` atribut `<roleManager>` element).</span><span class="sxs-lookup"><span data-stu-id="0df7d-185">The above markup defines the `SecurityTutorialsSqlRoleProvider` as the default provider (via the `defaultProvider` attribute in the `<roleManager>` element).</span></span> <span data-ttu-id="0df7d-186">Také nastaví `SecurityTutorialsSqlRoleProvider`společnosti `applicationName` nastavení `SecurityTutorials`, což je stejná `applicationName` nastavení používá zprostředkovatel členství (`SecurityTutorialsSqlMembershipProvider`).</span><span class="sxs-lookup"><span data-stu-id="0df7d-186">It also sets the `SecurityTutorialsSqlRoleProvider`'s `applicationName` setting to `SecurityTutorials`, which is the same `applicationName` setting used by the Membership provider (`SecurityTutorialsSqlMembershipProvider`).</span></span> <span data-ttu-id="0df7d-187">Zatímco není tady, zobrazené [ `<add>` element](https://msdn.microsoft.com/library/ms164662.aspx) pro `SqlRoleProvider` může také obsahovat `commandTimeout` atribut určit dobu trvání časového limitu databáze během několika sekund.</span><span class="sxs-lookup"><span data-stu-id="0df7d-187">While not shown here, the [`<add>` element](https://msdn.microsoft.com/library/ms164662.aspx) for the `SqlRoleProvider` may also contain a `commandTimeout` attribute to specify the database timeout duration, in seconds.</span></span> <span data-ttu-id="0df7d-188">Výchozí hodnota je 30.</span><span class="sxs-lookup"><span data-stu-id="0df7d-188">The default value is 30.</span></span>

<span data-ttu-id="0df7d-189">Pomocí této konfigurace značek na místě budeme připravení začít používat funkce role v rámci naší aplikace.</span><span class="sxs-lookup"><span data-stu-id="0df7d-189">With this configuration markup in place, we are ready to start using role functionality within our application.</span></span>

> [!NOTE]
> <span data-ttu-id="0df7d-190">Výše uvedené značek konfigurace znázorňuje použití &lt; `roleManager` &gt; elementu `enabled` a `defaultProvider` atributy.</span><span class="sxs-lookup"><span data-stu-id="0df7d-190">The above configuration markup illustrates using the &lt;`roleManager`&gt; element's `enabled` and `defaultProvider` attributes.</span></span> <span data-ttu-id="0df7d-191">Existuje mnoho dalších atributů, které ovlivňují, jak rozhraní role přidruží informace o rolích na základě uživatele uživatelů.</span><span class="sxs-lookup"><span data-stu-id="0df7d-191">There are a number of other attributes that affect how the Roles framework associates role information on a user-by-user basis.</span></span> <span data-ttu-id="0df7d-192">Prozkoumáme tohoto nastavení <a id="_msoanchor_8"> </a> [ *autorizace na základě rolí* ](role-based-authorization-cs.md) kurzu.</span><span class="sxs-lookup"><span data-stu-id="0df7d-192">We will examine these settings in the <a id="_msoanchor_8"></a>[*Role-Based Authorization*](role-based-authorization-cs.md) tutorial.</span></span>


## <a name="step-3-examining-the-roles-api"></a><span data-ttu-id="0df7d-193">Krok 3: Zkoumání rozhraní API rolí</span><span class="sxs-lookup"><span data-stu-id="0df7d-193">Step 3: Examining the Roles API</span></span>

<span data-ttu-id="0df7d-194">Funkce rolí rozhraní jsou dostupné prostřednictvím [ `Roles` třída](https://msdn.microsoft.com/library/system.web.security.roles.aspx), který obsahuje třináct statické metody pro provádění operací na základě rolí.</span><span class="sxs-lookup"><span data-stu-id="0df7d-194">The Roles framework's functionality is exposed via the [`Roles` class](https://msdn.microsoft.com/library/system.web.security.roles.aspx), which contains thirteen static methods for performing role-based operations.</span></span> <span data-ttu-id="0df7d-195">Když podíváme na vytváření a odstraňování role v krocích 4 a 6 budeme používat [ `CreateRole` ](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) a [ `DeleteRole` ](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) metody, které přidat nebo odebrat roli ze systému.</span><span class="sxs-lookup"><span data-stu-id="0df7d-195">When we look at creating and deleting roles in Steps 4 and 6 we will use the [`CreateRole`](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) and [`DeleteRole`](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) methods, which add or remove a role from the system.</span></span>

<span data-ttu-id="0df7d-196">Chcete-li získat seznam všech rolí v systému, použijte [ `GetAllRoles` metoda](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (viz krok 5).</span><span class="sxs-lookup"><span data-stu-id="0df7d-196">To get a list of all of the roles in the system, use the [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (see Step 5).</span></span> <span data-ttu-id="0df7d-197">[ `RoleExists` Metoda](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) vrátí logickou hodnotu označující, zda zadaná role existuje.</span><span class="sxs-lookup"><span data-stu-id="0df7d-197">The [`RoleExists` method](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) returns a Boolean value indicating whether a specified role exists.</span></span>

<span data-ttu-id="0df7d-198">V dalším kurzu prozkoumáme spojení uživatelů s rolemi.</span><span class="sxs-lookup"><span data-stu-id="0df7d-198">In the next tutorial we will examine how to associate users with roles.</span></span> <span data-ttu-id="0df7d-199">`Roles` Třídy [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [ `AddUserToRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [ `AddUsersToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx), a [ `AddUsersToRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) metody přidat jeden nebo více uživatelů k jedné nebo více rolím.</span><span class="sxs-lookup"><span data-stu-id="0df7d-199">The `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [`AddUserToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [`AddUsersToRole`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx), and [`AddUsersToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) methods add one or more users to one or more roles.</span></span> <span data-ttu-id="0df7d-200">Chcete-li odebrat uživatele z role, použijte [ `RemoveUserFromRole` ](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [ `RemoveUserFromRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [ `RemoveUsersFromRole` ](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx), nebo [ `RemoveUsersFromRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) metody.</span><span class="sxs-lookup"><span data-stu-id="0df7d-200">To remove users from roles, use the [`RemoveUserFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [`RemoveUserFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [`RemoveUsersFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx), or [`RemoveUsersFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) methods.</span></span>

<span data-ttu-id="0df7d-201">V <a id="_msoanchor_9"> </a> [ *autorizace na základě rolí* ](role-based-authorization-cs.md) kurzu se podíváme na způsoby, jak programově zobrazit nebo skrýt funkce na základě role aktuálně přihlášeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="0df7d-201">In the <a id="_msoanchor_9"></a>[*Role-Based Authorization*](role-based-authorization-cs.md) tutorial we will look at ways to programmatically show or hide functionality based on the currently logged in user's role.</span></span> <span data-ttu-id="0df7d-202">K tomu můžeme použít `Role` třídy [ `FindUsersInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [ `GetRolesForUser` ](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [ `GetUsersInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx), nebo [ `IsUserInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) metody.</span><span class="sxs-lookup"><span data-stu-id="0df7d-202">To accomplish this, we can use the `Role` class's [`FindUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [`GetRolesForUser`](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [`GetUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx), or [`IsUserInRole`](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) methods.</span></span>

> [!NOTE]
> <span data-ttu-id="0df7d-203">Mějte na paměti, která je vyvolána vždy jeden z těchto metod, `Roles` deleguje třída volání konfigurovaný poskytovatel.</span><span class="sxs-lookup"><span data-stu-id="0df7d-203">Keep in mind that any time one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="0df7d-204">V našem případě to znamená, že volání se posílá `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-204">In our case, this means that the call is being sent to the `SqlRoleProvider`.</span></span> <span data-ttu-id="0df7d-205">`SqlRoleProvider` Pak provede operaci příslušnou databázi podle volanou metodu.</span><span class="sxs-lookup"><span data-stu-id="0df7d-205">The `SqlRoleProvider` then performs the appropriate database operation based on the invoked method.</span></span> <span data-ttu-id="0df7d-206">Například kód `Roles.CreateRole("Administrators")` vede `SqlRoleProvider` provádění `aspnet_Roles_CreateRole` uloženou proceduru, která vloží nový záznam do `aspnet_Roles` tabulku s názvem Správci.</span><span class="sxs-lookup"><span data-stu-id="0df7d-206">For example, the code `Roles.CreateRole("Administrators")` results in the `SqlRoleProvider` executing the `aspnet_Roles_CreateRole` stored procedure, which inserts a new record into the `aspnet_Roles` table named Administrators .</span></span>


<span data-ttu-id="0df7d-207">Zbývající část tohoto kurzu zkoumá pomocí `Roles` třídy `CreateRole`, `GetAllRoles`, a `DeleteRole` metody pro správu role v systému.</span><span class="sxs-lookup"><span data-stu-id="0df7d-207">The remainder of this tutorial looks at using the `Roles` class's `CreateRole`, `GetAllRoles`, and `DeleteRole` methods to manage the roles in the system.</span></span>

## <a name="step-4-creating-new-roles"></a><span data-ttu-id="0df7d-208">Krok 4: Vytvoření nové role</span><span class="sxs-lookup"><span data-stu-id="0df7d-208">Step 4: Creating New Roles</span></span>

<span data-ttu-id="0df7d-209">Role nabízí způsob, jak libovolně skupiny uživatelů a většinou je toto seskupení používá pro pohodlnější způsob, jak aplikovat autorizační pravidla.</span><span class="sxs-lookup"><span data-stu-id="0df7d-209">Roles offer a way to arbitrarily group users, and most commonly this grouping is used for a more convenient way to apply authorization rules.</span></span> <span data-ttu-id="0df7d-210">Ale pokud chcete používat role jako mechanismus ověřování, musíme nejprve definovat, jaké role existovat v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="0df7d-210">But in order to use roles as an authorization mechanism we first need to define what roles exist in the application.</span></span> <span data-ttu-id="0df7d-211">ASP.NET bohužel neobsahuje CreateRoleWizard ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="0df7d-211">Unfortunately, ASP.NET does not include a CreateRoleWizard control.</span></span> <span data-ttu-id="0df7d-212">Chcete-li přidat nové role potřebné k vytvoření vhodného uživatelského rozhraní a volat rozhraní API rolí sami.</span><span class="sxs-lookup"><span data-stu-id="0df7d-212">In order to add new roles we need to create a suitable user interface and invoke the Roles API ourselves.</span></span> <span data-ttu-id="0df7d-213">Dobrou zprávou je, že to je velmi snadné.</span><span class="sxs-lookup"><span data-stu-id="0df7d-213">The good news is that this is very easy to accomplish.</span></span>

> [!NOTE]
> <span data-ttu-id="0df7d-214">Neplatí žádné CreateRoleWizard webový ovládací prvek, je [nástroje pro správu webu technologie ASP.NET](https://msdn.microsoft.com/library/ms228053.aspx), což je místní aplikace v ASP.NET navržené tak, aby vám pomůže s zobrazení a správa konfigurace webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="0df7d-214">While there is no CreateRoleWizard Web control, there is the [ASP.NET Web Site Administration Tool](https://msdn.microsoft.com/library/ms228053.aspx), which is a local ASP.NET application designed to assist with viewing and managing your web application's configuration.</span></span> <span data-ttu-id="0df7d-215">Ale nejsem velký fanda nástroje pro správu webu technologie ASP.NET pro dva důvody.</span><span class="sxs-lookup"><span data-stu-id="0df7d-215">However, I am not a big fan of the ASP.NET Web Site Administration Tool for two reasons.</span></span> <span data-ttu-id="0df7d-216">Nejprve je o něco obsahujícím chyby a činnost koncového uživatele ponechá být požadovaného mnoho dalších.</span><span class="sxs-lookup"><span data-stu-id="0df7d-216">First, it is a bit buggy and the user experience leaves a lot to be desired.</span></span> <span data-ttu-id="0df7d-217">Za druhé nástroje pro správu webu technologie ASP.NET slouží pouze pracovat místně, to znamená, že budete muset sestavit vlastní role správu webových stránek, když potřebujete vzdáleně spravovat role na živý web.</span><span class="sxs-lookup"><span data-stu-id="0df7d-217">Second, the ASP.NET Web Site Administration Tool is designed to only work locally, meaning that you will have to build your own role management web pages if you need to manage roles on a live site remotely.</span></span> <span data-ttu-id="0df7d-218">Dva z těchto důvodů v tomto kurzu, kdy se soustředí na vytváření roli potřebné nástroje pro správu na webové stránce, spíše než spoléhání se na nástroje pro správu webu technologie ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0df7d-218">For these two reasons, this tutorial and the next will focus on building the necessary role management tools in a web page rather than relying on the ASP.NET Web Site Administration Tool.</span></span>


<span data-ttu-id="0df7d-219">Otevřít `ManageRoles.aspx` stránku `Roles` složky a přidat textové pole a tlačítko webový ovládací prvek na stránce.</span><span class="sxs-lookup"><span data-stu-id="0df7d-219">Open the `ManageRoles.aspx` page in the `Roles` folder and add a TextBox and a Button Web control to the page.</span></span> <span data-ttu-id="0df7d-220">Nastavení ovládacího prvku textového pole `ID` vlastnost `RoleName` a na tlačítko `ID` a `Text` vlastností `CreateRoleButton` a vytvořit roli, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="0df7d-220">Set the TextBox control's `ID` property to `RoleName` and the Button's `ID` and `Text` properties to `CreateRoleButton` and Create Role, respectively.</span></span> <span data-ttu-id="0df7d-221">Na stránce deklarativní v tomto okamžiku by měl vypadat nějak takto:</span><span class="sxs-lookup"><span data-stu-id="0df7d-221">At this point, your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample6.aspx)]

<span data-ttu-id="0df7d-222">Potom dvakrát klikněte na panel `CreateRoleButton` tlačítko ovládacího prvku do návrháře k vytvoření `Click` obslužné rutiny události a potom přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="0df7d-222">Next, double-click the `CreateRoleButton` Button control in the Designer to create a `Click` event handler and then add the following code:</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample7.cs)]

<span data-ttu-id="0df7d-223">Výše uvedený kód spustí přiřazením zadaný v název oříznutý role `RoleName` textového pole `newRoleName` proměnné.</span><span class="sxs-lookup"><span data-stu-id="0df7d-223">The above code starts by assigning the trimmed role name entered in the `RoleName` TextBox to the `newRoleName` variable.</span></span> <span data-ttu-id="0df7d-224">Dále `Roles` třídy `RoleExists` metoda je volána k určení, zda role `newRoleName` v systému již existuje.</span><span class="sxs-lookup"><span data-stu-id="0df7d-224">Next, the `Roles` class's `RoleExists` method is called to determine if the role `newRoleName` already exists in the system.</span></span> <span data-ttu-id="0df7d-225">Pokud roli buď neexistuje, vytvoří se prostřednictvím volání `CreateRole` metody.</span><span class="sxs-lookup"><span data-stu-id="0df7d-225">If the role does not exist, it is created via a call to the `CreateRole` method.</span></span> <span data-ttu-id="0df7d-226">Pokud `CreateRole` metodě se předává název role, která již existuje v systému, `ProviderException` je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="0df7d-226">If the `CreateRole` method is passed a role name that already exists in the system, a `ProviderException` exception is thrown.</span></span> <span data-ttu-id="0df7d-227">To je důvod, proč kód nejprve zkontroluje, ujistěte se, že role již neexistuje v systému před voláním `CreateRole`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-227">This is why the code first checks to ensure that the role does not already exist in the system before calling `CreateRole`.</span></span> <span data-ttu-id="0df7d-228">`Click` Obslužná rutina události dojde k závěru zrušením navýšení kapacity `RoleName` textového `Text` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="0df7d-228">The `Click` event handler concludes by clearing out the `RoleName` TextBox's `Text` property.</span></span>

> [!NOTE]
> <span data-ttu-id="0df7d-229">Asi vás zajímá co se stane, pokud uživatel nemá zadejte libovolnou hodnotu do `RoleName` textového pole.</span><span class="sxs-lookup"><span data-stu-id="0df7d-229">You may be wondering what will happen if the user doesn't enter any value into the `RoleName` TextBox.</span></span> <span data-ttu-id="0df7d-230">Pokud hodnota předaná do `CreateRole` je metoda `null` nebo prázdný řetězec, výjimka je vyvolána.</span><span class="sxs-lookup"><span data-stu-id="0df7d-230">If the value passed into the `CreateRole` method is `null` or an empty string, an exception is raised.</span></span> <span data-ttu-id="0df7d-231">Podobně pokud je název role obsahuje čárku je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="0df7d-231">Likewise, if the role name contains a comma an exception is raised.</span></span> <span data-ttu-id="0df7d-232">Na stránce v důsledku toho by měl obsahovat validačních ovládacích prvků k zajištění, aby uživatel zadal roli a zda neobsahuje žádné čárkami.</span><span class="sxs-lookup"><span data-stu-id="0df7d-232">Consequently, the page should contain validation controls to ensure that the user enters a role and that it does not contain any commas.</span></span> <span data-ttu-id="0df7d-233">Opuštění jako cvičení pro čtečku.</span><span class="sxs-lookup"><span data-stu-id="0df7d-233">I leave as an exercise for the reader.</span></span>


<span data-ttu-id="0df7d-234">Umožňuje vytvořit roli s názvem Správci.</span><span class="sxs-lookup"><span data-stu-id="0df7d-234">Let's create a role named Administrators.</span></span> <span data-ttu-id="0df7d-235">Přejděte `ManageRoles.aspx` stránce prostřednictvím prohlížeče, do textového pole zadejte správce (viz obrázek 3) a potom klikněte na tlačítko Vytvořit roli.</span><span class="sxs-lookup"><span data-stu-id="0df7d-235">Visit the `ManageRoles.aspx` page through a browser, type in Administrators into the textbox (see Figure 3), and then click the Create Role button.</span></span>


[![C<span data-ttu-id="0df7d-236">Vytvořit roli správce]</span><span class="sxs-lookup"><span data-stu-id="0df7d-236">reate an Administrators Role]</span></span>(creating-and-managing-roles-cs/_static/image8.png)](creating-and-managing-roles-cs/_static/image7.png)

<span data-ttu-id="0df7d-237">**Obrázek 3**: Umožňuje vytvořit roli Administrators ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-and-managing-roles-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="0df7d-237">**Figure 3**: Create an Administrators Role  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image9.png))</span></span>


<span data-ttu-id="0df7d-238">Co se stane?</span><span class="sxs-lookup"><span data-stu-id="0df7d-238">What happens?</span></span> <span data-ttu-id="0df7d-239">Vyvolá zpětné volání, ale neexistuje vizuální upozornění, která ve skutečnosti role byla přidána do systému.</span><span class="sxs-lookup"><span data-stu-id="0df7d-239">A postback occurs, but there's no visual cue that the role has actually been added to the system.</span></span> <span data-ttu-id="0df7d-240">Aktualizujeme tuto stránku v kroku 5 a zahrnují vizuální zpětnou vazbu.</span><span class="sxs-lookup"><span data-stu-id="0df7d-240">We will update this page in Step 5 to include visual feedback.</span></span> <span data-ttu-id="0df7d-241">Prozatím se však můžete ověřit, že role byla vytvořena tak, že přejdete `SecurityTutorials.mdf` databáze a zobrazení dat z `aspnet_Roles` tabulky.</span><span class="sxs-lookup"><span data-stu-id="0df7d-241">For now, however, you can verify that the role was created by going to the `SecurityTutorials.mdf` database and displaying the data from the `aspnet_Roles` table.</span></span> <span data-ttu-id="0df7d-242">Jak ukazuje obrázek 4 `aspnet_Roles` tabulka obsahuje záznam pro roli správce právě přidali.</span><span class="sxs-lookup"><span data-stu-id="0df7d-242">As Figure 4 shows, the `aspnet_Roles` table contains a record for the just-added Administrators roles.</span></span>


[![T<span data-ttu-id="0df7d-243">aspnet_Roles tabulka má řádek pro správce]</span><span class="sxs-lookup"><span data-stu-id="0df7d-243">he aspnet_Roles Table has a Row for the Administrators]</span></span>(creating-and-managing-roles-cs/_static/image11.png)](creating-and-managing-roles-cs/_static/image10.png)

<span data-ttu-id="0df7d-244">**Obrázek 4**: `aspnet_Roles` Tabulka obsahuje řádek pro správce ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-and-managing-roles-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="0df7d-244">**Figure 4**: The `aspnet_Roles` Table has a Row for the Administrators  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image12.png))</span></span>


## <a name="step-5-displaying-the-roles-in-the-system"></a><span data-ttu-id="0df7d-245">Krok 5: Role zobrazení v systému</span><span class="sxs-lookup"><span data-stu-id="0df7d-245">Step 5: Displaying the Roles in the System</span></span>

<span data-ttu-id="0df7d-246">Můžeme rozšířit `ManageRoles.aspx` stránky, aby zahrnovala seznam aktuální role v systému.</span><span class="sxs-lookup"><span data-stu-id="0df7d-246">Let's augment the `ManageRoles.aspx` page to include a list of the current roles in the system.</span></span> <span data-ttu-id="0df7d-247">K tomu přidat ovládací prvek GridView na stránku a nastavit jeho `ID` vlastnost `RoleList`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-247">To accomplish this, add a GridView control to the page and set its `ID` property to `RoleList`.</span></span> <span data-ttu-id="0df7d-248">V dalším kroku přidejte metodu do třídy modelu code-behind na stránce s názvem `DisplayRolesInGrid` pomocí následujícího kódu:</span><span class="sxs-lookup"><span data-stu-id="0df7d-248">Next, add a method to the page's code-behind class named `DisplayRolesInGrid` using the following code:</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample8.cs)]

<span data-ttu-id="0df7d-249">`Roles` Třídy `GetAllRoles` metoda vrátí všechny role v systému jako pole řetězců.</span><span class="sxs-lookup"><span data-stu-id="0df7d-249">The `Roles` class's `GetAllRoles` method returns all of the roles in the system as an array of strings.</span></span> <span data-ttu-id="0df7d-250">Tato pole řetězců je pak vázán na prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="0df7d-250">This string array is then bound to the GridView.</span></span> <span data-ttu-id="0df7d-251">Aby bylo možné vytvořit vazbu seznamu rolí do prvku GridView, při prvním načtení stránky, musíme volání `DisplayRolesInGrid` metodu na stránce `Page_Load` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="0df7d-251">In order to bind the list of roles to the GridView when the page is first loaded, we need to call the `DisplayRolesInGrid` method from the page's `Page_Load` event handler.</span></span> <span data-ttu-id="0df7d-252">Následující kód volá tuto metodu při první návštěvě stránky, ale ne na následné zpětného odeslání.</span><span class="sxs-lookup"><span data-stu-id="0df7d-252">The following code calls this method when the page is first visited, but not on subsequent postbacks.</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample9.cs)]

<span data-ttu-id="0df7d-253">S tímto kódem na místě navštivte stránku prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="0df7d-253">With this code in place, visit the page through a browser.</span></span> <span data-ttu-id="0df7d-254">Jak je vidět na obrázku 5, měli byste vidět mřížku s jedním sloupcem označené položky.</span><span class="sxs-lookup"><span data-stu-id="0df7d-254">As Figure 5 shows, you should see a grid with a single column labeled Item.</span></span> <span data-ttu-id="0df7d-255">Mřížka obsahuje řádek pro roli správce, kterou jsme přidali v kroku 4.</span><span class="sxs-lookup"><span data-stu-id="0df7d-255">The grid includes a row for the Administrators role we added in Step 4.</span></span>


[![T<span data-ttu-id="0df7d-256">má GridView v jednom sloupci zobrazí role]</span><span class="sxs-lookup"><span data-stu-id="0df7d-256">he GridView Displays the Roles in a Single Column]</span></span>(creating-and-managing-roles-cs/_static/image14.png)](creating-and-managing-roles-cs/_static/image13.png)

<span data-ttu-id="0df7d-257">**Obrázek 5**: GridView zobrazí role v jednom sloupci ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-and-managing-roles-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="0df7d-257">**Figure 5**: The GridView Displays the Roles in a Single Column  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image15.png))</span></span>


<span data-ttu-id="0df7d-258">GridView zobrazí jedinou sloupec s názvem položky, protože prvku GridView `AutoGenerateColumns` je nastavena na hodnotu True (výchozí), což způsobí, že prvku GridView. Chcete-li automaticky vytvořit sloupec pro každou vlastnost v jeho `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-258">The GridView displays a lone column labeled Item because the GridView's `AutoGenerateColumns` property is set to True (the default), which causes the GridView to automatically create a column for each property in its `DataSource`.</span></span> <span data-ttu-id="0df7d-259">Pole má jednu vlastnost, která představuje prvků v poli, takže jeden sloupec v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="0df7d-259">An array has a single property that represents the elements in the array, hence the single column in the GridView.</span></span>

<span data-ttu-id="0df7d-260">Při zobrazení dat ovládacím prvkem GridView, raději chcete explicitně definovat sloupce a nenechat je implicitně generovaný prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="0df7d-260">When displaying data with a GridView, I prefer to explicitly define my columns rather than have them implicitly generated by the GridView.</span></span> <span data-ttu-id="0df7d-261">Explicitně definovat sloupce je mnohem jednodušší zobrazení dat, změnit uspořádání sloupců a provádět další běžné úlohy.</span><span class="sxs-lookup"><span data-stu-id="0df7d-261">By explicitly defining the columns it is much easier to format the data, rearrange the columns, and perform other common tasks.</span></span> <span data-ttu-id="0df7d-262">Proto můžeme aktualizovat prvku GridView deklarativní tak, aby její sloupce nejsou explicitně definovány.</span><span class="sxs-lookup"><span data-stu-id="0df7d-262">Therefore, let's update the GridView's declarative markup so that its columns are explicitly defined.</span></span>

<span data-ttu-id="0df7d-263">Začněte tím, že nastavení prvku GridView `AutoGenerateColumns` vlastnost na hodnotu False.</span><span class="sxs-lookup"><span data-stu-id="0df7d-263">Start by setting the GridView's `AutoGenerateColumns` property to False.</span></span> <span data-ttu-id="0df7d-264">Dále přidejte TemplateField do mřížky, nastavte jeho `HeaderText` vlastnost k rolím a nakonfigurovat jeho `ItemTemplate` tak, aby zobrazil obsah pole.</span><span class="sxs-lookup"><span data-stu-id="0df7d-264">Next, add a TemplateField to the grid, set its `HeaderText` property to Roles, and configure its `ItemTemplate` so that it displays the contents of the array.</span></span> <span data-ttu-id="0df7d-265">K tomu přidat ovládací prvek webového popisek s názvem `RoleNameLabel` k `ItemTemplate` a vytvořit vazbu jeho `Text` vlastnost `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-265">To accomplish this, add a Label Web control named `RoleNameLabel` to the `ItemTemplate` and bind its `Text` property to `Container.DataItem`.</span></span>

<span data-ttu-id="0df7d-266">Tyto vlastnosti a `ItemTemplate`jeho obsah lze nastavit pomocí deklarace nebo přes dialogové okno pole prvku GridView a interface upravit šablony.</span><span class="sxs-lookup"><span data-stu-id="0df7d-266">These properties and the `ItemTemplate`'s contents can be set declaratively or through the GridView's Fields dialog box and Edit Templates interface.</span></span> <span data-ttu-id="0df7d-267">Pole dialogové okno, klikněte na odkaz Upravit sloupce v prvku GridView inteligentních značek.</span><span class="sxs-lookup"><span data-stu-id="0df7d-267">To reach the Fields dialog box, click the Edit Columns link in the GridView's Smart Tag.</span></span> <span data-ttu-id="0df7d-268">V dalším kroku, zrušte zaškrtnutí políčka automaticky generovat pole nastavit `AutoGenerateColumns` vlastnost na hodnotu False a přidejte do prvku GridView, TemplateField nastavení jeho `HeaderText` vlastnost do Role.</span><span class="sxs-lookup"><span data-stu-id="0df7d-268">Next, uncheck the Auto-generate fields checkbox to set the `AutoGenerateColumns` property to False, and add a TemplateField to the GridView, setting its `HeaderText` property to Role.</span></span> <span data-ttu-id="0df7d-269">Chcete-li definovat `ItemTemplate`na obsah, zvolte možnost Upravit šablony z inteligentních značek v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="0df7d-269">To define the `ItemTemplate`'s contents, choose the Edit Templates option from the GridView's Smart Tag.</span></span> <span data-ttu-id="0df7d-270">Přetáhněte ovládací prvek popisek Web na `ItemTemplate`, nastavte jeho `ID` vlastnost `RoleNameLabel`a nastavení jeho vázání dat tak, aby jeho `Text` vlastnost je vázána na `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-270">Drag a Label Web control onto the `ItemTemplate`, set its `ID` property to `RoleNameLabel`, and configure its databinding settings so that its `Text` property is bound to `Container.DataItem`.</span></span>

<span data-ttu-id="0df7d-271">Bez ohledu na to, jaký přístup je použít, prvku GridView výsledný deklarativní značka by měla vypadat podobně jako následujícím po dokončení.</span><span class="sxs-lookup"><span data-stu-id="0df7d-271">Regardless of what approach you use, the GridView's resulting declarative markup should look similar to the following when you are done.</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample10.aspx)]

> [!NOTE]
> <span data-ttu-id="0df7d-272">Obsah tohoto pole se zobrazí pomocí syntaxe databinding `<%# Container.DataItem %>`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-272">The array's contents are displayed using the databinding syntax `<%# Container.DataItem %>`.</span></span> <span data-ttu-id="0df7d-273">Nad rámec tohoto kurzu je důkladné popis Proč tato syntaxe je použita při zobrazení obsahu pole vázána na prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="0df7d-273">A thorough description of why this syntax is used when displaying the contents of an array bound to the GridView is beyond the scope of this tutorial.</span></span> <span data-ttu-id="0df7d-274">Další informace o této věci, předložit [skalární pole vazby na ovládací prvek webových dat](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="0df7d-274">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>


<span data-ttu-id="0df7d-275">V současné době `RoleList` GridView je vázaný jenom na seznamu rolí, při první návštěvě stránky.</span><span class="sxs-lookup"><span data-stu-id="0df7d-275">Currently, the `RoleList` GridView is only bound to the list of roles when the page is first visited.</span></span> <span data-ttu-id="0df7d-276">Potřebujeme aktualizovat mřížky pokaždé, když se přidá novou roli.</span><span class="sxs-lookup"><span data-stu-id="0df7d-276">We need to refresh the grid whenever a new role is added.</span></span> <span data-ttu-id="0df7d-277">Jak toho dosáhnout, aktualizujte `CreateRoleButton` tlačítka `Click` tak, že volá obslužná rutina události `DisplayRolesInGrid` metodu, pokud se vytvoří novou roli.</span><span class="sxs-lookup"><span data-stu-id="0df7d-277">To accomplish this, update the `CreateRoleButton` Button's `Click` event handler so that it calls the `DisplayRolesInGrid` method if a new role is created.</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample11.cs)]

<span data-ttu-id="0df7d-278">Teď, když uživatel přidá novou roli `RoleList` GridView ukazuje roli právě přidané na zpětné volání, poskytuje vizuální zpětnou vazbu, že role se úspěšně vytvořil.</span><span class="sxs-lookup"><span data-stu-id="0df7d-278">Now when the user adds a new role the `RoleList` GridView shows the just-added role on postback, providing visual feedback that the role was successfully created.</span></span> <span data-ttu-id="0df7d-279">Pro znázornění, přejděte `ManageRoles.aspx` stránce prostřednictvím prohlížeče a přidejte roli s názvem správců.</span><span class="sxs-lookup"><span data-stu-id="0df7d-279">To illustrate this, visit the `ManageRoles.aspx` page through a browser and add a role named Supervisors.</span></span> <span data-ttu-id="0df7d-280">Po kliknutí na tlačítko Vytvořit roli, bude následovat zpětné volání a mřížce se aktualizuje a zahrnují správcích a také novou roli vedoucí.</span><span class="sxs-lookup"><span data-stu-id="0df7d-280">Upon clicking the Create Role button, a postback will ensue and the grid will update to include Administrators as well as the new role, Supervisors.</span></span>


[![T<span data-ttu-id="0df7d-281">Role správců má byla přidána]</span><span class="sxs-lookup"><span data-stu-id="0df7d-281">he Supervisors Role has Been Added]</span></span>(creating-and-managing-roles-cs/_static/image17.png)](creating-and-managing-roles-cs/_static/image16.png)

<span data-ttu-id="0df7d-282">**Obrázek 6**: Byla přidána má Role správců ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-and-managing-roles-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="0df7d-282">**Figure 6**: The Supervisors Role has Been Added  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image18.png))</span></span>


## <a name="step-6-deleting-roles"></a><span data-ttu-id="0df7d-283">Krok 6: Odstranění role</span><span class="sxs-lookup"><span data-stu-id="0df7d-283">Step 6: Deleting Roles</span></span>

<span data-ttu-id="0df7d-284">V tomto okamžiku můžete uživatele vytvořit novou roli a zobrazit všechny existující role z `ManageRoles.aspx` stránky.</span><span class="sxs-lookup"><span data-stu-id="0df7d-284">At this point a user can create a new role and view all existing roles from the `ManageRoles.aspx` page.</span></span> <span data-ttu-id="0df7d-285">Můžeme povolit uživatelům také odstranění rolí.</span><span class="sxs-lookup"><span data-stu-id="0df7d-285">Let's allow users to also delete roles.</span></span> <span data-ttu-id="0df7d-286">`Roles.DeleteRole` Metoda má dvě přetížení:</span><span class="sxs-lookup"><span data-stu-id="0df7d-286">The `Roles.DeleteRole` method has two overloads:</span></span>

- <span data-ttu-id="0df7d-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx) -Odstraní roli *roleName*.</span><span class="sxs-lookup"><span data-stu-id="0df7d-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="0df7d-288">Pokud role obsahuje jeden nebo více členů, je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="0df7d-288">An exception is thrown if the role contains one or more members.</span></span>
- <span data-ttu-id="0df7d-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx) -Odstraní roli *roleName*.</span><span class="sxs-lookup"><span data-stu-id="0df7d-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="0df7d-290">Pokud *throwOnPopulateRole* je `true`, pak je vyvolána výjimka, pokud role obsahuje jeden nebo více členů.</span><span class="sxs-lookup"><span data-stu-id="0df7d-290">If *throwOnPopulateRole* is `true`, then an exception is thrown if the role contains one or more members.</span></span> <span data-ttu-id="0df7d-291">Pokud *throwOnPopulateRole* je `false`, role je odstraněna, zda obsahuje všechny členy, nebo ne.</span><span class="sxs-lookup"><span data-stu-id="0df7d-291">If *throwOnPopulateRole* is `false`, then the role is deleted whether it contains any members or not.</span></span> <span data-ttu-id="0df7d-292">Interně `DeleteRole(roleName)` volání metody `DeleteRole(roleName, true)`.</span><span class="sxs-lookup"><span data-stu-id="0df7d-292">Internally, the `DeleteRole(roleName)` method calls `DeleteRole(roleName, true)`.</span></span>

<span data-ttu-id="0df7d-293">`DeleteRole` Metoda také vyvolá výjimku, pokud *roleName* je `null` nebo prázdný řetězec nebo, pokud *roleName* obsahuje čárku.</span><span class="sxs-lookup"><span data-stu-id="0df7d-293">The `DeleteRole` method will also throw an exception if *roleName* is `null` or an empty string or if *roleName* contains a comma.</span></span> <span data-ttu-id="0df7d-294">Pokud *roleName* neexistuje v systému, `DeleteRole` selže tiše, bez vyvolání výjimky.</span><span class="sxs-lookup"><span data-stu-id="0df7d-294">If *roleName* does not exist in the system, `DeleteRole` fails silently, without raising an exception.</span></span>

<span data-ttu-id="0df7d-295">Můžeme rozšířit v prvku GridView `ManageRoles.aspx` zahrnout odstranění tlačítka, který po kliknutí na odstraní vybranou roli.</span><span class="sxs-lookup"><span data-stu-id="0df7d-295">Let's augment the GridView in `ManageRoles.aspx` to include a Delete button that, when clicked, deletes the selected role.</span></span> <span data-ttu-id="0df7d-296">Začněte přidáním tlačítko pro odstranění k prvku GridView. dialogové okno pole a tlačítko pro odstranění, které se nachází v rámci CommandField možnost přidání.</span><span class="sxs-lookup"><span data-stu-id="0df7d-296">Start by adding a Delete button to the GridView by going to the Fields dialog box and adding a Delete button, which is located under the CommandField option.</span></span> <span data-ttu-id="0df7d-297">Ujistěte se, odstraňte sloupec úplně vlevo tlačítko a nastavte jeho `DeleteText` vlastnost odstranit roli.</span><span class="sxs-lookup"><span data-stu-id="0df7d-297">Make the Delete button the far left column and set its `DeleteText` property to Delete Role .</span></span>


[![A<span data-ttu-id="0df7d-298">dd Odstranit tlačítko RoleList GridView]</span><span class="sxs-lookup"><span data-stu-id="0df7d-298">dd a Delete Button to the RoleList GridView]</span></span>(creating-and-managing-roles-cs/_static/image20.png)](creating-and-managing-roles-cs/_static/image19.png)

<span data-ttu-id="0df7d-299">**Obrázek 7**: Přidejte tlačítko Odstranit `RoleList` ovládacího prvku GridView ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-and-managing-roles-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="0df7d-299">**Figure 7**: Add a Delete Button to the `RoleList` GridView  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image21.png))</span></span>


<span data-ttu-id="0df7d-300">Po přidání tlačítko pro odstranění, deklarativní prvku GridView by měl vypadat nějak takto:</span><span class="sxs-lookup"><span data-stu-id="0df7d-300">After adding the Delete button, your GridView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample12.aspx)]

<span data-ttu-id="0df7d-301">Dále vytvořte obslužnou rutinu události pro prvku GridView `RowDeleting` událostí.</span><span class="sxs-lookup"><span data-stu-id="0df7d-301">Next, create an event handler for the GridView's `RowDeleting` event.</span></span> <span data-ttu-id="0df7d-302">Toto je událost, která je vyvolána na zpětné volání, když dojde ke kliknutí na tlačítko odstranit roli.</span><span class="sxs-lookup"><span data-stu-id="0df7d-302">This is the event that is raised on postback when the Delete Role button is clicked.</span></span> <span data-ttu-id="0df7d-303">Přidejte následující kód do obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="0df7d-303">Add the following code to the event handler.</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample13.cs)]

<span data-ttu-id="0df7d-304">Kód spustí programově odkazováním `RoleNameLabel` ovládací prvek v řádku, jehož tlačítko odstranit roli došlo ke kliknutí na webu.</span><span class="sxs-lookup"><span data-stu-id="0df7d-304">The code starts by programmatically referencing the `RoleNameLabel` Web control in the row whose Delete Role button was clicked.</span></span> <span data-ttu-id="0df7d-305">`Roles.DeleteRole` Potom je volána metoda, předejte `Text` z `RoleNameLabel` a `false`, a tím odstranění role bez ohledu na to, zda jsou všechny uživatele přidružené k roli.</span><span class="sxs-lookup"><span data-stu-id="0df7d-305">The `Roles.DeleteRole` method is then invoked, passing in the `Text` of the `RoleNameLabel` and `false`, thereby deleting the role regardless of whether there are any users associated with the role.</span></span> <span data-ttu-id="0df7d-306">Nakonec `RoleList` GridView se aktualizují tak, aby role právě odstraněné již nebude zobrazovat v mřížce.</span><span class="sxs-lookup"><span data-stu-id="0df7d-306">Finally, the `RoleList` GridView is refreshed so that the just-deleted role no longer appears in the grid.</span></span>

> [!NOTE]
> <span data-ttu-id="0df7d-307">Tlačítko odstranit roli nevyžaduje, aby jakýkoli druh potvrzení od uživatele před odstraněním role.</span><span class="sxs-lookup"><span data-stu-id="0df7d-307">The Delete Role button does not require any sort of confirmation from the user before deleting the role.</span></span> <span data-ttu-id="0df7d-308">Jedním z nejjednodušších způsobů k potvrzení akce je prostřednictvím dialogového okna potvrdit na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="0df7d-308">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="0df7d-309">Další informace o této techniky najdete v tématu [přidání Client-Side potvrzení při odstraňování](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span><span class="sxs-lookup"><span data-stu-id="0df7d-309">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span></span>


## <a name="summary"></a><span data-ttu-id="0df7d-310">Souhrn</span><span class="sxs-lookup"><span data-stu-id="0df7d-310">Summary</span></span>

<span data-ttu-id="0df7d-311">Mnoho webových aplikací mají určité autorizační pravidla nebo funkci úrovni stránky, která je dostupná jenom pro určité třídy uživatelů.</span><span class="sxs-lookup"><span data-stu-id="0df7d-311">Many web applications have certain authorization rules or page-level functionality that is only available to certain classes of users.</span></span> <span data-ttu-id="0df7d-312">Například může být sada webových stránek, ke kterým přístup jenom správci.</span><span class="sxs-lookup"><span data-stu-id="0df7d-312">For example, there may be a set of web pages that only administrators can access.</span></span> <span data-ttu-id="0df7d-313">Místo definování tato pravidla autorizace na základě uživatele podle uživatelů, je často další užitečné k definování pravidel založený na roli.</span><span class="sxs-lookup"><span data-stu-id="0df7d-313">Rather than defining these authorization rules on a user-by-user basis, oftentimes it is more useful to define the rules based on a role.</span></span> <span data-ttu-id="0df7d-314">To znamená, nikoli explicitně umožnit uživatelům Scott a Jisun přístup pro správu webových stránek, snadněji spravovatelné přístup je tak, aby povolovala členy rolí správce pro přístup k tyto stránky a pak k označení Scott a Jisun jako uživatelé, kteří patří do Role správce.</span><span class="sxs-lookup"><span data-stu-id="0df7d-314">That is, rather than explicitly allowing users Scott and Jisun to access the administrative web pages, a more maintainable approach is to permit members of the Administrators role to access these pages, and then to denote Scott and Jisun as users belonging to the Administrators role.</span></span>

<span data-ttu-id="0df7d-315">Rozhraní rolí umožňuje snadno vytvořit a spravovat role.</span><span class="sxs-lookup"><span data-stu-id="0df7d-315">The Roles framework makes it easy to create and manage roles.</span></span> <span data-ttu-id="0df7d-316">V tomto kurzu jsme se zaměřili na tom, jak nakonfigurovat rozhraní role používat `SqlRoleProvider`, který používá databázi serveru Microsoft SQL Server jako úložiště rolí.</span><span class="sxs-lookup"><span data-stu-id="0df7d-316">In this tutorial we examined how to configure the Roles framework to use the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span> <span data-ttu-id="0df7d-317">Jsme také vytvořili webovou stránku, která obsahuje seznam existujících rolí v systému a umožňuje nové role, který se má vytvořit a odstranit existující.</span><span class="sxs-lookup"><span data-stu-id="0df7d-317">We also created a web page that lists the existing roles in the system and allows for new roles to be created and existing ones to be deleted.</span></span> <span data-ttu-id="0df7d-318">V následujících kurzech uvidíme, jak přiřadit uživatele k rolím a jak se autorizace na základě rolí.</span><span class="sxs-lookup"><span data-stu-id="0df7d-318">In subsequent tutorials we will see how to assign users to roles and how to apply role-based authorization.</span></span>

<span data-ttu-id="0df7d-319">Všechno nejlepší programování!</span><span class="sxs-lookup"><span data-stu-id="0df7d-319">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="0df7d-320">Další čtení</span><span class="sxs-lookup"><span data-stu-id="0df7d-320">Further Reading</span></span>

<span data-ttu-id="0df7d-321">Další informace o tématech, které jsou popsané v tomto kurzu najdete na následujících odkazech:</span><span class="sxs-lookup"><span data-stu-id="0df7d-321">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="0df7d-322">Zkoumání ASP.NET 2.0 pro členství, role a profilu</span><span class="sxs-lookup"><span data-stu-id="0df7d-322">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="0df7d-323">Postupy: Pomocí Správce rolí technologie ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="0df7d-323">How To: Use Role Manager in ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/ms998314.aspx)
- [<span data-ttu-id="0df7d-324">Role zprostředkovatele</span><span class="sxs-lookup"><span data-stu-id="0df7d-324">Role Providers</span></span>](https://msdn.microsoft.com/library/aa478950.aspx)
- [<span data-ttu-id="0df7d-325">Vlastní nástroj pro správu webu se zajištěním provozu</span><span class="sxs-lookup"><span data-stu-id="0df7d-325">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="0df7d-326">Technická dokumentace ke službě `<roleManager>` – Element</span><span class="sxs-lookup"><span data-stu-id="0df7d-326">Technical documentation for the `<roleManager>` Element</span></span>](https://msdn.microsoft.com/library/ms164660.aspx)
- [<span data-ttu-id="0df7d-327">Pomocí členství a Role Správce rozhraní API</span><span class="sxs-lookup"><span data-stu-id="0df7d-327">Using the Membership and Role Manager APIs</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/membership.aspx)

### <a name="about-the-author"></a><span data-ttu-id="0df7d-328">O autorovi</span><span class="sxs-lookup"><span data-stu-id="0df7d-328">About the Author</span></span>

<span data-ttu-id="0df7d-329">Scott Meisnerová, Autor více ASP/ASP.NET knih a zakladatelem 4GuysFromRolla.com, má pracovali Microsoft webových technologiích od roku 1998.</span><span class="sxs-lookup"><span data-stu-id="0df7d-329">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0df7d-330">Scott funguje jako nezávislý konzultant, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="0df7d-330">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0df7d-331">Jeho nejnovější knihy  *[Edice nakladatelství Sams naučit sami ASP.NET 2.0 za 24 hodin](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="0df7d-331">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="0df7d-332">Scott může být dostupný na adrese [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) nebo prostřednictvím na svém blogu [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="0df7d-332">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="0df7d-333">Speciální k</span><span class="sxs-lookup"><span data-stu-id="0df7d-333">Special Thanks To</span></span>

<span data-ttu-id="0df7d-334">V této sérii kurzů byl recenzován uživatelem mnoho užitečných revidující.</span><span class="sxs-lookup"><span data-stu-id="0df7d-334">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0df7d-335">Vedoucí revidující pro účely tohoto kurzu zahrnují Alicja Maziarz, Suchi Banerjee a Teresy Murphy.</span><span class="sxs-lookup"><span data-stu-id="0df7d-335">Lead reviewers for this tutorial include Alicja Maziarz, Suchi Banerjee, and Teresa Murphy.</span></span> <span data-ttu-id="0df7d-336">Zajímat téma Moje nadcházejících článcích MSDN?</span><span class="sxs-lookup"><span data-stu-id="0df7d-336">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0df7d-337">Pokud ano, vyřaďte mě řádek na [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0df7d-337">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="0df7d-338">Next</span><span class="sxs-lookup"><span data-stu-id="0df7d-338">Next</span></span>](assigning-roles-to-users-cs.md)
