---
title: Ověření modelu v ASP.NET Core MVC
author: tdykstra
description: Další informace o ověření modelu v ASP.NET Core MVC.
ms.author: riande
ms.custom: mvc
ms.date: 01/14/2019
uid: mvc/models/validation
ms.openlocfilehash: ca7ee54b8e6b6ae5091b0cb133e448ad9c04da8f
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/01/2019
ms.locfileid: "57073363"
---
# <a name="model-validation-in-aspnet-core-mvc"></a><span data-ttu-id="8c0f3-103">Ověření modelu v ASP.NET Core MVC</span><span class="sxs-lookup"><span data-stu-id="8c0f3-103">Model validation in ASP.NET Core MVC</span></span>

<span data-ttu-id="8c0f3-104">Podle [Rachel Appel](https://github.com/rachelappel)</span><span class="sxs-lookup"><span data-stu-id="8c0f3-104">By [Rachel Appel](https://github.com/rachelappel)</span></span>

## <a name="introduction-to-model-validation"></a><span data-ttu-id="8c0f3-105">Úvod k ověření modelu</span><span class="sxs-lookup"><span data-stu-id="8c0f3-105">Introduction to model validation</span></span>

<span data-ttu-id="8c0f3-106">Předtím, než aplikace ukládá data do databáze, aplikace musí ověřit data.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-106">Before an app stores data in a database, the app must validate the data.</span></span> <span data-ttu-id="8c0f3-107">Data musí být kontrolované potenciálních bezpečnostních hrozeb, ověřit, že je správně naformátovaný podle typu a velikosti a musí odpovídat pravidla.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-107">Data must be checked for potential security threats, verified that it's appropriately formatted by type and size, and it must conform to your rules.</span></span> <span data-ttu-id="8c0f3-108">Ověření je nezbytné, i když může být redundantní chybám a únavná implementovat.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-108">Validation is necessary although it can be redundant and tedious to implement.</span></span> <span data-ttu-id="8c0f3-109">V aplikaci MVC se stane ověření klienta i serveru.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-109">In MVC, validation happens on both the client and server.</span></span>

<span data-ttu-id="8c0f3-110">Naštěstí má .NET abstrahovaná ověření do atributů ověření.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-110">Fortunately, .NET has abstracted validation into validation attributes.</span></span> <span data-ttu-id="8c0f3-111">Tyto atributy obsahují kód pro ověření, a tím snižuje množství kódu, který musíte napsat.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-111">These attributes contain validation code, thereby reducing the amount of code you must write.</span></span>

<span data-ttu-id="8c0f3-112">V ASP.NET Core 2.2 a novější modul runtime ASP.NET Core zkratům ověření (přeskočí), pokud můžete určit, že daný model grafu nevyžaduje ověření.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-112">In ASP.NET Core 2.2 and later, the ASP.NET Core runtime short-circuits (skips) validation if it can determine that a given model graph doesn't require validation.</span></span> <span data-ttu-id="8c0f3-113">Přeskočení ověření může poskytnout výrazné zlepšení výkonu při ověřování modelů, které nelze nebo nemáte žádné přidružené validátorů.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-113">Skipping validation can provide significant performance improvements when validating models that cannot or do not have any associated validators.</span></span> <span data-ttu-id="8c0f3-114">Bylo přeskočeno ověření zahrnuje objekty, jako jsou kolekcí primitivních elementů (`byte[]`, `string[]`, `Dictionary<string, string>`atd), nebo komplexního objektu grafy bez žádné validátory.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-114">The skipped validation includes objects such as collections of primitives (`byte[]`, `string[]`, `Dictionary<string, string>`, etc.), or complex object graphs without any validators.</span></span>

<span data-ttu-id="8c0f3-115">[Zobrazit nebo stáhnout ukázky z Githubu](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/models/validation/sample).</span><span class="sxs-lookup"><span data-stu-id="8c0f3-115">[View or download sample from GitHub](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/models/validation/sample).</span></span>

## <a name="validation-attributes"></a><span data-ttu-id="8c0f3-116">Ověřování atributů</span><span class="sxs-lookup"><span data-stu-id="8c0f3-116">Validation Attributes</span></span>

<span data-ttu-id="8c0f3-117">Ověřování atributů představují způsob, jak nakonfigurovat ověřování modelu, tak, aby se koncepčně podobá ověření na pole v databázové tabulky.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-117">Validation attributes are a way to configure model validation so it's similar conceptually to validation on fields in database tables.</span></span> <span data-ttu-id="8c0f3-118">To zahrnuje omezení, jako je například přiřazení datových typů nebo povinná pole.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-118">This includes constraints such as assigning data types or required fields.</span></span> <span data-ttu-id="8c0f3-119">Jiné typy ověření, které zahrnuje použití vzorců k datům a vynucování obchodních pravidel, jako je například platební kartu, telefonní číslo nebo e-mailovou adresu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-119">Other types of validation include applying patterns to data to enforce business rules, such as a credit card, phone number, or email address.</span></span> <span data-ttu-id="8c0f3-120">Atributy ověření provést vynucují požadavky pro tyto mnohem jednodušší a usnadňuje používání.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-120">Validation attributes make enforcing these requirements much simpler and easier to use.</span></span>

<span data-ttu-id="8c0f3-121">Jsou zadané atributy ověření na úrovni vlastnost:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-121">Validation attributes are specified at the property level:</span></span> 

```csharp
[Required]
public string MyProperty { get; set; }
```

<span data-ttu-id="8c0f3-122">Níže je s poznámkami `Movie` modelů z aplikace, která uchovává informace o filmů a televizních pořadů.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-122">Below is an annotated `Movie` model from an app that stores information about movies and TV shows.</span></span> <span data-ttu-id="8c0f3-123">Většina vlastností jsou povinné a několik vlastností řetězce mají požadavky na délku.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-123">Most of the properties are required and several string properties have length requirements.</span></span> <span data-ttu-id="8c0f3-124">Kromě toho je omezení číselného rozsahu v místě `Price` vlastnost od 0 do $999,99, spolu s vlastní ověřovací atribut.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-124">Additionally, there's a numeric range restriction in place for the `Price` property from 0 to $999.99, along with a custom validation attribute.</span></span>

[!code-csharp[](validation/sample/Movie.cs?range=6-29)]

<span data-ttu-id="8c0f3-125">Pouze pro čtení přes model odhalí pravidla týkající se data pro tuto aplikaci, což usnadňuje údržbu kódu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-125">Simply reading through the model reveals the rules about data for this app, making it easier to maintain the code.</span></span> <span data-ttu-id="8c0f3-126">Níže jsou uvedeny několik oblíbených ověření integrované atributy:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-126">Below are several popular built-in validation attributes:</span></span>

* <span data-ttu-id="8c0f3-127">`[CreditCard]`: Ověří vlastnost má formát platební karty.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-127">`[CreditCard]`: Validates the property has a credit card format.</span></span>

* <span data-ttu-id="8c0f3-128">`[Compare]`: Ověří dvě vlastnosti v modelu shoda.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-128">`[Compare]`: Validates two properties in a model match.</span></span>

* <span data-ttu-id="8c0f3-129">`[EmailAddress]`: Ověří vlastnost má formát e-mailu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-129">`[EmailAddress]`: Validates the property has an email format.</span></span>

* <span data-ttu-id="8c0f3-130">`[Phone]`: Ověří vlastnost má formát telefonu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-130">`[Phone]`: Validates the property has a telephone format.</span></span>

* <span data-ttu-id="8c0f3-131">`[Range]`: Ověří spadá hodnotu vlastnosti v daném rozsahu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-131">`[Range]`: Validates the property value falls within the given range.</span></span>

* <span data-ttu-id="8c0f3-132">`[RegularExpression]`: Ověřuje, že data odpovídá zadanému regulárnímu výrazu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-132">`[RegularExpression]`: Validates that the data matches the specified regular expression.</span></span>

* <span data-ttu-id="8c0f3-133">`[Required]`: Díky požadované vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-133">`[Required]`: Makes a property required.</span></span>

* <span data-ttu-id="8c0f3-134">`[StringLength]`: Ověřuje, že řetězcovou vlastnost má nejvíce dané maximální délky.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-134">`[StringLength]`: Validates that a string property has at most the given maximum length.</span></span>

* <span data-ttu-id="8c0f3-135">`[Url]`: Ověří vlastnost má formát adresy URL.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-135">`[Url]`: Validates the property has a URL format.</span></span>

<span data-ttu-id="8c0f3-136">MVC podporuje všechny atributy, které je odvozena z `ValidationAttribute` pro účely ověření.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-136">MVC supports any attribute that derives from `ValidationAttribute` for validation purposes.</span></span> <span data-ttu-id="8c0f3-137">Mnoho užitečných ověřování atributů najdete v [System.ComponentModel.DataAnnotations](/dotnet/api/system.componentmodel.dataannotations) oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-137">Many useful validation attributes can be found in the [System.ComponentModel.DataAnnotations](/dotnet/api/system.componentmodel.dataannotations) namespace.</span></span>

<span data-ttu-id="8c0f3-138">Může existovat instance, kdy potřebujete víc funkcí než vestavěné atributy.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-138">There may be instances where you need more features than built-in attributes provide.</span></span> <span data-ttu-id="8c0f3-139">Pro situace, můžete vytvořit vlastní ověřovací atributy odvozený od `ValidationAttribute` nebo změna modelu k implementaci `IValidatableObject`.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-139">For those times, you can create custom validation attributes by deriving from `ValidationAttribute` or changing your model to implement `IValidatableObject`.</span></span>

## <a name="notes-on-the-use-of-the-required-attribute"></a><span data-ttu-id="8c0f3-140">Poznámky k použití požadovaný atribut</span><span class="sxs-lookup"><span data-stu-id="8c0f3-140">Notes on the use of the Required attribute</span></span>

<span data-ttu-id="8c0f3-141">Neumožňující [typů hodnot](/dotnet/csharp/language-reference/keywords/value-types) (například `decimal`, `int`, `float`, a `DateTime`) jsou ze své podstaty povinné a nemusíte `Required` atribut.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-141">Non-nullable [value types](/dotnet/csharp/language-reference/keywords/value-types) (such as `decimal`, `int`, `float`, and `DateTime`) are inherently required and don't need the `Required` attribute.</span></span> <span data-ttu-id="8c0f3-142">Aplikace provádí žádné kontroly ověřování na straně serveru pro typy neumožňující, které jsou označeny `Required`.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-142">The app performs no server-side validation checks for non-nullable types that are marked `Required`.</span></span>

<span data-ttu-id="8c0f3-143">Vazby modelu MVC, která se týká ověření a atributů ověření, zamítne formuláře pole obsahující chybí hodnota nebo prázdné znaky Null typu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-143">MVC model binding, which isn't concerned with validation and validation attributes, rejects a form field submission containing a missing value or whitespace for a non-nullable type.</span></span> <span data-ttu-id="8c0f3-144">Chybí `BindRequired` atribut na cílovou vlastnost vazby modelu přeskočí chybějící data pro typy neumožňující, ve kterém chybí pole formuláře z příchozí data formuláře.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-144">In the absence of a `BindRequired` attribute on the target property, model binding ignores missing data for non-nullable types, where the form field is absent from the incoming form data.</span></span>

<span data-ttu-id="8c0f3-145">[BindRequired atribut](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.bindrequiredattribute) (viz také <xref:mvc/models/model-binding#customize-model-binding-behavior-with-attributes>) je užitečný k zajištění toho, dokončení data formuláře.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-145">The [BindRequired attribute](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.bindrequiredattribute) (also see <xref:mvc/models/model-binding#customize-model-binding-behavior-with-attributes>) is useful to ensure form data is complete.</span></span> <span data-ttu-id="8c0f3-146">Při použití na vlastnost, systém vazby modelu vyžaduje hodnotu pro tuto vlastnost.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-146">When applied to a property, the model binding system requires a value for that property.</span></span> <span data-ttu-id="8c0f3-147">Při použití na typ, systém vazby modelu vyžaduje hodnoty pro všechny vlastnosti tohoto typu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-147">When applied to a type, the model binding system requires values for all of the properties of that type.</span></span>

<span data-ttu-id="8c0f3-148">Při použití [Nullable\<T > typ](/dotnet/csharp/programming-guide/nullable-types/) (například `decimal?` nebo `System.Nullable<decimal>`) a označte ji `Required`, se provádí kontroly ověřování na straně serveru, jako kdyby byly standardní typ připouštějící hodnotu Null (pro vlastnost například `string`).</span><span class="sxs-lookup"><span data-stu-id="8c0f3-148">When you use a [Nullable\<T> type](/dotnet/csharp/programming-guide/nullable-types/) (for example, `decimal?` or `System.Nullable<decimal>`) and mark it `Required`, a server-side validation check is performed as if the property were a standard nullable type (for example, a `string`).</span></span>

<span data-ttu-id="8c0f3-149">Ověřování na straně klienta vyžaduje hodnotu pro pole formuláře, který odpovídá vlastnosti modelu, který jste označili `Required` a Null typu vlastnosti, která nejsou označena `Required`.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-149">Client-side validation requires a value for a form field that corresponds to a model property that you've marked `Required` and for a non-nullable type property that you haven't marked `Required`.</span></span> <span data-ttu-id="8c0f3-150">`Required` můžete použít k řízení chybovou zprávu ověření na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-150">`Required` can be used to control the client-side validation error message.</span></span>

::: moniker range=">= aspnetcore-2.1"

## <a name="top-level-node-validation"></a><span data-ttu-id="8c0f3-151">Uzel nejvyšší úrovně ověření</span><span class="sxs-lookup"><span data-stu-id="8c0f3-151">Top-level node validation</span></span>

<span data-ttu-id="8c0f3-152">Uzly nejvyšší úrovně patří:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-152">Top-level nodes include:</span></span>

* <span data-ttu-id="8c0f3-153">Parametry akce</span><span class="sxs-lookup"><span data-stu-id="8c0f3-153">Action parameters</span></span>
* <span data-ttu-id="8c0f3-154">Vlastnosti kontroleru</span><span class="sxs-lookup"><span data-stu-id="8c0f3-154">Controller properties</span></span>
* <span data-ttu-id="8c0f3-155">Parametry rutiny stránky</span><span class="sxs-lookup"><span data-stu-id="8c0f3-155">Page handler parameters</span></span>
* <span data-ttu-id="8c0f3-156">Vlastnosti modelu stránky</span><span class="sxs-lookup"><span data-stu-id="8c0f3-156">Page model properties</span></span>

<span data-ttu-id="8c0f3-157">Model vázaný uzly nejvyšší úrovně se ověří kromě ověřování vlastnosti modelu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-157">Model-bound top-level nodes are validated in addition to validating model properties.</span></span> <span data-ttu-id="8c0f3-158">V následujícím příkladu z ukázkové aplikace `VerifyPhone` metoda používá <xref:System.ComponentModel.DataAnnotations.RegularExpressionAttribute> ověřit data uživatele do pole Telefon formuláře:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-158">In the following example from the sample app, the `VerifyPhone` method uses the <xref:System.ComponentModel.DataAnnotations.RegularExpressionAttribute> to validate the user data in the Phone field of a form:</span></span>

[!code-csharp[](validation/sample/UsersController.cs?name=snippet_VerifyPhone)]

<span data-ttu-id="8c0f3-159">Uzly nejvyšší úrovně můžete použít <xref:Microsoft.AspNetCore.Mvc.ModelBinding.BindRequiredAttribute> s atributy ověření.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-159">Top-level nodes can use <xref:Microsoft.AspNetCore.Mvc.ModelBinding.BindRequiredAttribute> with validation attributes.</span></span> <span data-ttu-id="8c0f3-160">V následujícím příkladu z ukázkové aplikace `CheckAge` metody Určuje, že `age` parametr musí být vázán z řetězce dotazu, když se odešle formulář:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-160">In the following example from the sample app, the `CheckAge` method specifies that the `age` parameter must be bound from the query string when the form is submitted:</span></span>

[!code-csharp[](validation/sample/UsersController.cs?name=snippet_CheckAge)]

<span data-ttu-id="8c0f3-161">Na stránce Zkontrolovat stáří (*CheckAge.cshtml*), existují dva typy.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-161">In the Check Age page (*CheckAge.cshtml*), there are two forms.</span></span> <span data-ttu-id="8c0f3-162">První formulář odešle `Age` hodnotu `99` jako řetězec dotazu: `https://localhost:5001/Users/CheckAge?Age=99`.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-162">The first form submits an `Age` value of `99` as a query string: `https://localhost:5001/Users/CheckAge?Age=99`.</span></span>

<span data-ttu-id="8c0f3-163">Když správně formátovaná `age` parametr z řetězce dotazu se odešle, ověří formuláře.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-163">When a properly formatted `age` parameter from the query string is submitted, the form validates.</span></span>

<span data-ttu-id="8c0f3-164">Druhý formulář na stránce Zkontrolovat stáří odešle `Age` hodnoty v těle žádosti a ověření selže.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-164">The second form on the Check Age page submits the `Age` value in the body of the request, and validation fails.</span></span> <span data-ttu-id="8c0f3-165">Vazba se nezdaří, protože `age` parametr musí pocházet z řetězce dotazu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-165">Binding fails because the `age` parameter must come from a query string.</span></span>

<span data-ttu-id="8c0f3-166">Ověření je ve výchozím nastavení povolené a řídí <xref:Microsoft.AspNetCore.Mvc.MvcOptions.AllowValidatingTopLevelNodes*> vlastnost <xref:Microsoft.AspNetCore.Mvc.MvcOptions>.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-166">Validation is enabled by default and controlled by the <xref:Microsoft.AspNetCore.Mvc.MvcOptions.AllowValidatingTopLevelNodes*> property of <xref:Microsoft.AspNetCore.Mvc.MvcOptions>.</span></span> <span data-ttu-id="8c0f3-167">Chcete-li zakázat ověřování uzel nejvyšší úrovně, nastavte `AllowValidatingTopLevelNodes` k `false` v možnostech MVC (`Startup.ConfigureServices`):</span><span class="sxs-lookup"><span data-stu-id="8c0f3-167">To disable top-level node validation, set `AllowValidatingTopLevelNodes` to `false` in MVC options (`Startup.ConfigureServices`):</span></span>

[!code-csharp[](validation/sample_snapshot/Startup.cs?name=snippet_AddMvc&highlight=4)]

::: moniker-end

## <a name="model-state"></a><span data-ttu-id="8c0f3-168">Stav modelu</span><span class="sxs-lookup"><span data-stu-id="8c0f3-168">Model State</span></span>

<span data-ttu-id="8c0f3-169">Stav modelu představuje chyb při ověřování v zadané hodnoty formuláře HTML.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-169">Model state represents validation errors in submitted HTML form values.</span></span>

<span data-ttu-id="8c0f3-170">MVC bude pokračovat v ověřování polí, dokud nedosáhne maximální počet chyb (200 ve výchozím nastavení).</span><span class="sxs-lookup"><span data-stu-id="8c0f3-170">MVC will continue validating fields until it reaches the maximum number of errors (200 by default).</span></span> <span data-ttu-id="8c0f3-171">Toto číslo můžete nakonfigurovat pomocí následujícího kódu v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-171">You can configure this number with the following code in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](validation/sample/Startup.cs?name=snippet_MaxModelValidationErrors)]

## <a name="handle-model-state-errors"></a><span data-ttu-id="8c0f3-172">Chyby stavu modelu popisovač</span><span class="sxs-lookup"><span data-stu-id="8c0f3-172">Handle Model State errors</span></span>

<span data-ttu-id="8c0f3-173">Vyvolá se před spuštěním akce kontroleru ověření modelu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-173">Model validation occurs before the execution of a controller action.</span></span> <span data-ttu-id="8c0f3-174">Je zodpovědností akce ke kontrole `ModelState.IsValid` a reagují odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-174">It's the action's responsibility to inspect `ModelState.IsValid` and react appropriately.</span></span> <span data-ttu-id="8c0f3-175">V mnoha případech odpovídající reakce je reakce na chybu, ideálně s podrobnostmi o příčině selhání ověření modelu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-175">In many cases, the appropriate reaction is to return an error response, ideally detailing the reason why model validation failed.</span></span>

::: moniker range=">= aspnetcore-2.1"

<span data-ttu-id="8c0f3-176">Když `ModelState.IsValid` vyhodnotí jako `false` v kontrolerů webového rozhraní API pomocí `[ApiController]` atribut, je vrácena automatické odpovědi HTTP 400 obsahující podrobnosti o problému.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-176">When `ModelState.IsValid` evaluates to `false` in web API controllers using the `[ApiController]` attribute, an automatic HTTP 400 response containing issue details is returned.</span></span> <span data-ttu-id="8c0f3-177">Další informace najdete v tématu [odpovědi HTTP 400 automatické](xref:web-api/index#automatic-http-400-responses).</span><span class="sxs-lookup"><span data-stu-id="8c0f3-177">For more information, see [Automatic HTTP 400 responses](xref:web-api/index#automatic-http-400-responses).</span></span>

::: moniker-end

<span data-ttu-id="8c0f3-178">Některé aplikace zvolí dodržovat standardní konvence týkající se chyby ověření modelu, ve kterých může být případ filtr příslušné místo k implementaci těchto zásad.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-178">Some apps will choose to follow a standard convention for dealing with model validation errors, in which case a filter may be an appropriate place to implement such a policy.</span></span> <span data-ttu-id="8c0f3-179">Měli byste otestovat chování vaše akce se stavy model platný nebo neplatný.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-179">You should test how your actions behave with valid and invalid model states.</span></span>

## <a name="manual-validation"></a><span data-ttu-id="8c0f3-180">Ruční ověření</span><span class="sxs-lookup"><span data-stu-id="8c0f3-180">Manual validation</span></span>

<span data-ttu-id="8c0f3-181">Po dokončení vazby modelu a ověření můžete opakovat jeho části.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-181">After model binding and validation are complete, you may want to repeat parts of it.</span></span> <span data-ttu-id="8c0f3-182">Například uživatel může zadat text v poli, očekává se celé číslo, nebo možná budete muset výpočtu hodnoty pro vlastnosti modelu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-182">For example, a user may have entered text in a field expecting an integer, or you may need to compute a value for a model's property.</span></span>

<span data-ttu-id="8c0f3-183">Budete muset ručně spusťte ověření.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-183">You may need to run validation manually.</span></span> <span data-ttu-id="8c0f3-184">Chcete-li tak učinit, zavolejte `TryValidateModel` způsob, jak je znázorněno zde:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-184">To do so, call the `TryValidateModel` method, as shown here:</span></span>

[!code-csharp[](validation/sample/MoviesController.cs?name=snippet_TryValidateModel)]

## <a name="custom-validation"></a><span data-ttu-id="8c0f3-185">Vlastní ověřování</span><span class="sxs-lookup"><span data-stu-id="8c0f3-185">Custom validation</span></span>

<span data-ttu-id="8c0f3-186">Atributy ověření fungovat pro většinu ověření potřeb.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-186">Validation attributes work for most validation needs.</span></span> <span data-ttu-id="8c0f3-187">Některá pravidla ověřování jsou však specifické pro vaše podnikání.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-187">However, some validation rules are specific to your business.</span></span> <span data-ttu-id="8c0f3-188">Pravidla nemusí být běžná technika ověření dat, jako je zajištění pole je povinné nebo, který odpovídá rozsahu hodnot.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-188">Your rules might not be common data validation techniques such as ensuring a field is required or that it conforms to a range of values.</span></span> <span data-ttu-id="8c0f3-189">Vlastní ověřovací atributy pro tyto scénáře jsou vynikající řešení.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-189">For these scenarios, custom validation attributes are a great solution.</span></span> <span data-ttu-id="8c0f3-190">Vytvoření vlastní ověřovací atributy v aplikaci MVC je jednoduché.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-190">Creating your own custom validation attributes in MVC is easy.</span></span> <span data-ttu-id="8c0f3-191">Dědit pouze z `ValidationAttribute`a přepsat `IsValid` metody.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-191">Just inherit from the `ValidationAttribute`, and override the `IsValid` method.</span></span> <span data-ttu-id="8c0f3-192">`IsValid` Metoda přijímá dva parametry, první je objekt s názvem *hodnotu* a druhá `ValidationContext` objekt s názvem *parametr validationContext*.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-192">The `IsValid` method accepts two parameters, the first is an object named *value* and the second is a `ValidationContext` object named *validationContext*.</span></span> <span data-ttu-id="8c0f3-193">*Hodnota* odkazuje na skutečnou hodnotu z pole, která ověřuje svůj vlastní validátor.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-193">*Value* refers to the actual value from the field that your custom validator is validating.</span></span>

<span data-ttu-id="8c0f3-194">V následujícím příkladu obchodní pravidlo uvádí, zda uživatelé nemusí nastaveno žánr *Classic* filmu vydanou po 1960.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-194">In the following sample, a business rule states that users may not set the genre to *Classic* for a movie released after 1960.</span></span> <span data-ttu-id="8c0f3-195">`[ClassicMovie]` Atribut žánr nejprve zkontroluje, a pokud jde o klasický, pak zkontroluje, že je novější než 1960 datum vydání.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-195">The `[ClassicMovie]` attribute checks the genre first, and if it's a classic, then it checks the release date to see that it's later than 1960.</span></span> <span data-ttu-id="8c0f3-196">Pokud se uvolní po 1960, ověření se nezdaří.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-196">If it's released after 1960, validation fails.</span></span> <span data-ttu-id="8c0f3-197">Atribut přijímá jako parametr celé číslo představující rok, který vám pomůže ověřit data.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-197">The attribute accepts an integer parameter representing the year that you can use to validate data.</span></span> <span data-ttu-id="8c0f3-198">Hodnota parametru v konstruktoru atributu, můžete zachytit, jak je znázorněno zde:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-198">You can capture the value of the parameter in the attribute's constructor, as shown here:</span></span>

[!code-csharp[](validation/sample/ClassicMovieAttribute.cs?name=snippet_ClassicMovieAttribute)]

<span data-ttu-id="8c0f3-199">`movie` Proměnné výše představuje `Movie` objekt, který obsahuje data z odeslání formuláře k ověření.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-199">The `movie` variable above represents a `Movie` object that contains the data from the form submission to validate.</span></span> <span data-ttu-id="8c0f3-200">V takovém případě ověřovací kód kontroluje data a rozšířením podle tematických v `IsValid` metodu `ClassicMovieAttribute` třídy podle pravidla.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-200">In this case, the validation code checks the date and genre in the `IsValid` method of the `ClassicMovieAttribute` class as per the rules.</span></span> <span data-ttu-id="8c0f3-201">Po úspěšném ověření`IsValid` vrátí `ValidationResult.Success` kódu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-201">Upon successful validation ,`IsValid` returns a `ValidationResult.Success` code.</span></span> <span data-ttu-id="8c0f3-202">Když se ověřování nezdaří, `ValidationResult` s chybou je vrácená zpráva:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-202">When validation fails, a `ValidationResult` with an error message is returned:</span></span>

[!code-csharp[](validation/sample/ClassicMovieAttribute.cs?name=snippet_GetErrorMessage)]

<span data-ttu-id="8c0f3-203">Když uživatel změní `Genre` pole a odešle formulář, `IsValid` metodu `ClassicMovieAttribute` ověří, zda je tento film klasický.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-203">When a user modifies the `Genre` field and submits the form, the `IsValid` method of the `ClassicMovieAttribute` will verify whether the movie is a classic.</span></span> <span data-ttu-id="8c0f3-204">Stejně jako všechny vestavěné atributy, použije `ClassicMovieAttribute` na vlastnost, jako `ReleaseDate` k zajištění ověření dojde, jak je znázorněno v předchozí ukázce kódu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-204">Like any built-in attribute, apply the `ClassicMovieAttribute` to a property such as `ReleaseDate` to ensure validation happens, as shown in the previous code sample.</span></span> <span data-ttu-id="8c0f3-205">Protože příklad funguje pouze s `Movie` typy, je vhodnější použít `IValidatableObject` jak je znázorněno v následujícím odstavci.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-205">Since the example works only with `Movie` types, a better option is to use `IValidatableObject` as shown in the following paragraph.</span></span>

<span data-ttu-id="8c0f3-206">Alternativně může umístit tento stejný kód v modelu implementací `Validate` metodu na `IValidatableObject` rozhraní.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-206">Alternatively, this same code could be placed in the model by implementing the `Validate` method on the `IValidatableObject` interface.</span></span> <span data-ttu-id="8c0f3-207">Při vlastní ověřovací atributy fungovat dobře pro jednotlivé vlastnosti ověřování, implementace `IValidatableObject` je možné provádět ověřování na úrovni třídy:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-207">While custom validation attributes work well for validating individual properties, implementing `IValidatableObject` can be used to implement class-level validation:</span></span>

[!code-csharp[](validation/sample/MovieIValidatable.cs?name=snippet&highlight=1,26-34)]

## <a name="client-side-validation"></a><span data-ttu-id="8c0f3-208">Ověřování na straně klienta</span><span class="sxs-lookup"><span data-stu-id="8c0f3-208">Client side validation</span></span>

<span data-ttu-id="8c0f3-209">Ověřování na straně klienta je skvělé usnadnění práce pro uživatele.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-209">Client side validation is a great convenience for users.</span></span> <span data-ttu-id="8c0f3-210">To šetří čas, který byste jinak strávili čekání na odezvu na server.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-210">It saves time they would otherwise spend waiting for a round trip to the server.</span></span> <span data-ttu-id="8c0f3-211">V obchodní termíny dokonce i pár zlomky sekund vynásobené opakovaném každý den přidá až hodně času a výdajů, frustrace.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-211">In business terms, even a few fractions of seconds multiplied hundreds of times each day adds up to be a lot of time, expense, and frustration.</span></span> <span data-ttu-id="8c0f3-212">Jednoduché a okamžité ověřování umožňuje uživatelům vyšší efektivity práce a vytvářet lepší kvalitu vstupu a výstupu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-212">Straightforward and immediate validation enables users to work more efficiently and produce better quality input and output.</span></span>

<span data-ttu-id="8c0f3-213">Zobrazení s správné odkazy skriptu JavaScript musí mít nastavené pro ověřování na straně klienta fungovat jako tady vidíte.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-213">You must have a view with the proper JavaScript script references in place for client-side validation to work as you see here.</span></span>

[!code-cshtml[](validation/sample/Views/Shared/_Layout.cshtml?name=snippet_ScriptTag)]

[!code-cshtml[](validation/sample/Views/Shared/_ValidationScriptsPartial.cshtml)]

<span data-ttu-id="8c0f3-214">[JQuery Nerušivý ověření](https://github.com/aspnet/jquery-validation-unobtrusive) skript je vlastní Microsoft front-endu knihovnu, která staví na oblíbené [jQuery ověřit](https://jqueryvalidation.org/) modulu plug-in.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-214">The [jQuery Unobtrusive Validation](https://github.com/aspnet/jquery-validation-unobtrusive) script is a custom Microsoft front-end library that builds on the popular [jQuery Validate](https://jqueryvalidation.org/) plugin.</span></span> <span data-ttu-id="8c0f3-215">Bez jQuery Nerušivý ověřování, bude muset kód stejnou logiku ověřování na dvou místech: jednou v atributů ověření na straně serveru na vlastnosti projektu a poté znovu v skripty na straně klienta (příklady pro architekturu jQuery ověřením vaší [ `validate()` ](https://jqueryvalidation.org/validate/) metoda ukazuje, jak komplexní to může být).</span><span class="sxs-lookup"><span data-stu-id="8c0f3-215">Without jQuery Unobtrusive Validation, you would have to code the same validation logic in two places: once in the server side validation attributes on model properties, and then again in client side scripts (the examples for jQuery Validate's [`validate()`](https://jqueryvalidation.org/validate/) method shows how complex this could become).</span></span> <span data-ttu-id="8c0f3-216">Místo toho MVC [pomocných rutin značek](xref:mvc/views/tag-helpers/intro) a [pomocných rutin HTML](xref:mvc/views/overview) budou moct používat atributy ověření a metadata z vlastnosti modelu k vykreslení HTML 5 typu [datové atributy](http://w3c.github.io/html/dom.html#embedding-custom-non-visible-data-with-the-data-attributes) v elementy formuláře, které vyžadují ověřování.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-216">Instead, MVC's [Tag Helpers](xref:mvc/views/tag-helpers/intro) and [HTML helpers](xref:mvc/views/overview) are able to use the validation attributes and type metadata from model properties to render HTML 5 [data- attributes](http://w3c.github.io/html/dom.html#embedding-custom-non-visible-data-with-the-data-attributes) in the form elements that need validation.</span></span> <span data-ttu-id="8c0f3-217">MVC vygeneruje `data-` atributy pro předdefinované a vlastní atributy.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-217">MVC generates the `data-` attributes for both built-in and custom attributes.</span></span> <span data-ttu-id="8c0f3-218">pak analyzuje jQuery Nerušivý ověření `data-` atributy a předá logiku jQuery ověřit efektivně "kopírování" logiku ověřování na straně serveru do klienta.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-218">jQuery Unobtrusive Validation then parses the `data-` attributes and passes the logic to jQuery Validate, effectively "copying" the server side validation logic to the client.</span></span> <span data-ttu-id="8c0f3-219">Zobrazení chyb ověřování na straně klienta, použití pomocných rutin značek relevantní, jak je znázorněno zde:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-219">You can display validation errors on the client using the relevant tag helpers as shown here:</span></span>

[!code-cshtml[](validation/sample/Views/Movies/Create.cshtml?name=snippet_ReleaseDate&highlight=4-5)]

<span data-ttu-id="8c0f3-220">Výše uvedené pomocných rutin značek vykreslení HTML níže.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-220">The tag helpers above render the HTML below.</span></span> <span data-ttu-id="8c0f3-221">Všimněte si, že `data-` atributů v kódu HTML výstup odpovídají atributů ověření pro `ReleaseDate` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-221">Notice that the `data-` attributes in the HTML output correspond to the validation attributes for the `ReleaseDate` property.</span></span> <span data-ttu-id="8c0f3-222">`data-val-required` Atribut obsahuje chybovou zprávu se zobrazí, pokud uživatel nemá vyplnit pole Datum vydání verze.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-222">The `data-val-required` attribute below contains an error message to display if the user doesn't fill in the release date field.</span></span> <span data-ttu-id="8c0f3-223">jQuery Nerušivý ověření tuto hodnotu předá jQuery ověřit [ `required()` ](https://jqueryvalidation.org/required-method/) metodu, která se zobrazí zpráva v souvisejícím  **\<span >** elementu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-223">jQuery Unobtrusive Validation passes this value to the jQuery Validate [`required()`](https://jqueryvalidation.org/required-method/) method, which then displays that message in the accompanying **\<span>** element.</span></span>

```html
<form action="/Movies/Create" method="post">
    <div class="form-horizontal">
        <h4>Movie</h4>
        <div class="text-danger"></div>
        <div class="form-group">
            <label class="col-md-2 control-label" for="ReleaseDate">ReleaseDate</label>
            <div class="col-md-10">
                <input class="form-control" type="datetime"
                data-val="true" data-val-required="The ReleaseDate field is required."
                id="ReleaseDate" name="ReleaseDate" value="" />
                <span class="text-danger field-validation-valid"
                data-valmsg-for="ReleaseDate" data-valmsg-replace="true"></span>
            </div>
        </div>
    </div>
</form>
```

<span data-ttu-id="8c0f3-224">Ověřování na straně klienta zabrání odeslání dokud formulář není platný.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-224">Client-side validation prevents submission until the form is valid.</span></span> <span data-ttu-id="8c0f3-225">Tlačítka pro odeslání spustí jazyka JavaScript, který se odešle formulář nebo zobrazí chybové zprávy.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-225">The Submit button runs JavaScript that either submits the form or displays error messages.</span></span>

<span data-ttu-id="8c0f3-226">Určuje typ hodnoty atributů na základě .NET datového typu vlastnosti, případně přepsat pomocí MVC `[DataType]` atributy.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-226">MVC determines type attribute values based on the .NET data type of a property, possibly overridden using `[DataType]` attributes.</span></span> <span data-ttu-id="8c0f3-227">Základní `[DataType]` atribut nemá žádné reálné serverové ověření.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-227">The base `[DataType]` attribute does no real server-side validation.</span></span> <span data-ttu-id="8c0f3-228">Prohlížeče zvolte vlastní chybové zprávy a zobrazit opravu těchto chyb, jak si přejí, ale můžete balíček ověření Nerušivého jQuery přepsat zprávy a zobrazí je konzistentní s ostatními.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-228">Browsers choose their own error messages and display those errors as they wish, however the jQuery Validation Unobtrusive package can override the messages and display them consistently with others.</span></span> <span data-ttu-id="8c0f3-229">To se stane, když uživatelé nejvíce samozřejmě používat `[DataType]` podtřídy jako `[EmailAddress]`.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-229">This happens most obviously when users apply `[DataType]` subclasses such as `[EmailAddress]`.</span></span>

### <a name="add-validation-to-dynamic-forms"></a><span data-ttu-id="8c0f3-230">Přidání ověřování pro dynamické formuláře</span><span class="sxs-lookup"><span data-stu-id="8c0f3-230">Add Validation to Dynamic Forms</span></span>

<span data-ttu-id="8c0f3-231">Protože jQuery Nerušivý ověření předá logiku ověřování a parametry jQuery ověřit při prvním načtení stránky, dynamicky generované formulářů neprojevuje automaticky ověření.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-231">Because jQuery Unobtrusive Validation passes validation logic and parameters to jQuery Validate when the page first loads, dynamically generated forms won't automatically exhibit validation.</span></span> <span data-ttu-id="8c0f3-232">Místo toho je zapotřebí sdělit jQuery Nerušivý ověření analyzovat dynamická podoba ihned po jeho vytvoření.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-232">Instead, you must tell jQuery Unobtrusive Validation to parse the dynamic form immediately after creating it.</span></span> <span data-ttu-id="8c0f3-233">Například následující kód ukazuje, jak můžete nastavit ověřování na straně klienta ve formuláři přidány prostřednictvím AJAX.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-233">For example, the code below shows how you might set up client side validation on a form added via AJAX.</span></span>

```js
$.get({
    url: "https://url/that/returns/a/form",
    dataType: "html",
    error: function(jqXHR, textStatus, errorThrown) {
        alert(textStatus + ": Couldn't add form. " + errorThrown);
    },
    success: function(newFormHTML) {
        var container = document.getElementById("form-container");
        container.insertAdjacentHTML("beforeend", newFormHTML);
        var forms = container.getElementsByTagName("form");
        var newForm = forms[forms.length - 1];
        $.validator.unobtrusive.parse(newForm);
    }
})
```

<span data-ttu-id="8c0f3-234">`$.validator.unobtrusive.parse()` Metoda přijímá selektor jQuery pro svůj argument.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-234">The `$.validator.unobtrusive.parse()` method accepts a jQuery selector for its one argument.</span></span> <span data-ttu-id="8c0f3-235">Tato metoda říká jQuery Nerušivý ověření analyzovat `data-` atributy formulářů v rámci tohoto selektoru.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-235">This method tells jQuery Unobtrusive Validation to parse the `data-` attributes of forms within that selector.</span></span> <span data-ttu-id="8c0f3-236">Hodnoty tyto atributy jsou potom předány do modulu plug-in jQuery ověřit tak, aby formuláře je třeba požadovanou na straně ověřovacích pravidel klienta atributu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-236">The values of those attributes are then passed to the jQuery Validate plugin so that the form exhibits the desired client side validation rules.</span></span>

### <a name="add-validation-to-dynamic-controls"></a><span data-ttu-id="8c0f3-237">Přidání ověřování pro dynamické ovládací prvky</span><span class="sxs-lookup"><span data-stu-id="8c0f3-237">Add Validation to Dynamic Controls</span></span>

<span data-ttu-id="8c0f3-238">Můžete také aktualizovat ověřovací pravidla ve formuláři, pokud jednotlivé ovládací prvky, jako `<input/>`s a `<select/>`s, generuje dynamicky.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-238">You can also update the validation rules on a form when individual controls, such as `<input/>`s and `<select/>`s, are dynamically generated.</span></span> <span data-ttu-id="8c0f3-239">Nelze předat selektory pro tyto prvky, aby `parse()` metoda přímo protože okolní formulář již byl analyzován a nebude aktualizovat.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-239">You cannot pass selectors for these elements to the `parse()` method directly because the surrounding form has already been parsed and won't update.</span></span> <span data-ttu-id="8c0f3-240">Místo toho je nejprve odeberte stávající ověřovací data, potom rozboru celý formulář, jak je znázorněno níže:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-240">Instead, you first remove the existing validation data, then reparse the entire form, as shown below:</span></span>

```js
$.get({
    url: "https://url/that/returns/a/control",
    dataType: "html",
    error: function(jqXHR, textStatus, errorThrown) {
        alert(textStatus + ": Couldn't add control. " + errorThrown);
    },
    success: function(newInputHTML) {
        var form = document.getElementById("my-form");
        form.insertAdjacentHTML("beforeend", newInputHTML);
        $(form).removeData("validator")    // Added by jQuery Validate
               .removeData("unobtrusiveValidation");   // Added by jQuery Unobtrusive Validation
        $.validator.unobtrusive.parse(form);
    }
})
```

## <a name="iclientmodelvalidator"></a><span data-ttu-id="8c0f3-241">IClientModelValidator</span><span class="sxs-lookup"><span data-stu-id="8c0f3-241">IClientModelValidator</span></span>

<span data-ttu-id="8c0f3-242">Můžete vytvořit logiku na straně klienta pro vaše vlastní atribut a [nerušivý ověření](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html) která vytvoří adaptér pro [k ověřování jquery](http://jqueryvalidation.org/documentation/) se spustí na straně klienta za vás automaticky jako součást ověření.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-242">You may create client side logic for your custom attribute, and [unobtrusive validation](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html) which creates an adapter to [jquery validation](http://jqueryvalidation.org/documentation/) will execute it on the client for you automatically as part of validation.</span></span> <span data-ttu-id="8c0f3-243">Prvním krokem je řídit, jaké atributy dat. přidá implementace `IClientModelValidator` rozhraní, jak je znázorněno zde:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-243">The first step is to control what data- attributes are added by implementing the `IClientModelValidator` interface as shown here:</span></span>

[!code-csharp[](validation/sample/ClassicMovieAttribute.cs?name=snippet_AddValidation)]

<span data-ttu-id="8c0f3-244">Atributy, které toto rozhraní implementují můžete přidat do generované pole atributů HTML.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-244">Attributes that implement this interface can add HTML attributes to generated fields.</span></span> <span data-ttu-id="8c0f3-245">Zkoumání výstup `ReleaseDate` element odhalí kód HTML, který je podobný jako předchozí příklad, s tím rozdílem, nyní je `data-val-classicmovie` atribut, který byl definován v `AddValidation` metodu `IClientModelValidator`.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-245">Examining the output for the `ReleaseDate` element reveals HTML that's similar to the previous example, except now there's a `data-val-classicmovie` attribute that was defined in the `AddValidation` method of `IClientModelValidator`.</span></span>

```html
<input class="form-control" type="datetime"
    data-val="true"
    data-val-classicmovie="Classic movies must have a release year earlier than 1960."
    data-val-classicmovie-year="1960"
    data-val-required="The ReleaseDate field is required."
    id="ReleaseDate" name="ReleaseDate" value="" />
```

<span data-ttu-id="8c0f3-246">Ověření nerušivého používá data v `data-` atributy se mají zobrazit chybové zprávy.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-246">Unobtrusive validation uses the data in the `data-` attributes to display error messages.</span></span> <span data-ttu-id="8c0f3-247">Nicméně jQuery nebude vědět o pravidlech nebo zprávy, dokud je nepřidáte do prvku jQuery `validator` objektu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-247">However, jQuery doesn't know about rules or messages until you add them to jQuery's `validator` object.</span></span> <span data-ttu-id="8c0f3-248">To je ukázáno v následujícím příkladu, který přidá vlastní `classicmovie` způsob ověření klienta jQuery `validator` objektu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-248">This is shown in the following example, which adds a custom `classicmovie` client validation method to the jQuery `validator` object.</span></span> <span data-ttu-id="8c0f3-249">Vysvětlení `unobtrusive.adapters.add` metodu, najdete v článku [Nerušivý ověření klienta v architektuře ASP.NET MVC](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html).</span><span class="sxs-lookup"><span data-stu-id="8c0f3-249">For an explanation of the `unobtrusive.adapters.add` method, see [Unobtrusive Client Validation in ASP.NET MVC](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html).</span></span>

[!code-javascript[](validation/sample/Views/Movies/Create.cshtml?name=snippet_UnobtrusiveValidation)]

<span data-ttu-id="8c0f3-250">S předchozím kódu `classicmovie` metoda provádí ověřování na straně klienta na film datum vydání.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-250">With the preceding code, the `classicmovie` method performs client-side validation on the movie release date.</span></span> <span data-ttu-id="8c0f3-251">Chybová zpráva se zobrazí, pokud metoda vrátí `false`.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-251">The error message displays if the method returns `false`.</span></span>

## <a name="remote-validation"></a><span data-ttu-id="8c0f3-252">Vzdálené ověření</span><span class="sxs-lookup"><span data-stu-id="8c0f3-252">Remote validation</span></span>

<span data-ttu-id="8c0f3-253">Vzdálené ověření je skvělé funkce, která použijte, pokud je potřeba ověřit data na straně klienta s daty na serveru.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-253">Remote validation is a great feature to use when you need to validate data on the client against data on the server.</span></span> <span data-ttu-id="8c0f3-254">Vaše aplikace může například potřebovat a ověřte, jestli e-mail nebo uživatelské jméno je již používán a dotáže velké množství dat k tomu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-254">For example, your app may need to verify whether an email or user name is already in use, and it must query a large amount of data to do so.</span></span> <span data-ttu-id="8c0f3-255">Stahování velkých sad dat pro ověření jednu nebo několik polí spotřebovává příliš mnoho prostředků.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-255">Downloading large sets of data for validating one or a few fields consumes too many resources.</span></span> <span data-ttu-id="8c0f3-256">Také to může zveřejnit citlivé informace.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-256">It may also expose sensitive information.</span></span> <span data-ttu-id="8c0f3-257">Další možností je vytvořit round-trip žádost o ověření pole.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-257">An alternative is to make a round-trip request to validate a field.</span></span>

<span data-ttu-id="8c0f3-258">Implementace vzdáleného ověřování ve dvou krocích.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-258">You can implement remote validation in a two step process.</span></span> <span data-ttu-id="8c0f3-259">Nejprve musíte označit modelu pomocí `[Remote]` atribut.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-259">First, you must annotate your model with the `[Remote]` attribute.</span></span> <span data-ttu-id="8c0f3-260">`[Remote]` Atribut je možné zadat více přetížení, můžete použít ke směrování JavaScript na straně klienta na odpovídající kód pro volání.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-260">The `[Remote]` attribute accepts multiple overloads you can use to direct client side JavaScript to the appropriate code to call.</span></span> <span data-ttu-id="8c0f3-261">Následující příklad ukazuje na `VerifyEmail` metody akce `Users` kontroleru.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-261">The example below points to the `VerifyEmail` action method of the `Users` controller.</span></span>

[!code-csharp[](validation/sample/User.cs?name=snippet_UserEmailProperty)]

<span data-ttu-id="8c0f3-262">Druhý krok je uvedení kód pro ověření v odpovídající metody akce, jak jsou definovány v `[Remote]` atribut.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-262">The second step is putting the validation code in the corresponding action method as defined in the `[Remote]` attribute.</span></span> <span data-ttu-id="8c0f3-263">Podle jQuery ověřit [vzdálené](https://jqueryvalidation.org/remote-method/) metoda dokumentaci odpovědi serveru musí být řetězec formátu JSON, který je buď:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-263">According to the jQuery Validate [remote](https://jqueryvalidation.org/remote-method/) method documentation, the server response must be a JSON string that's either:</span></span>

* <span data-ttu-id="8c0f3-264">`"true"` pro platné prvky.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-264">`"true"` for valid elements.</span></span>
* <span data-ttu-id="8c0f3-265">`"false"`, `undefined`, nebo `null` neplatné elementy pomocí výchozí chybovou zprávu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-265">`"false"`, `undefined`, or `null` for invalid elements, using the default error message.</span></span>

<span data-ttu-id="8c0f3-266">Pokud odpověď serveru je řetězec (například `"That name is already taken, try peter123 instead"`), řetězec se zobrazí jako vlastní chybovou zprávu místo výchozí řetězec.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-266">If the server response is a string (for example, `"That name is already taken, try peter123 instead"`), the string is displayed as a custom error message in place of the default string.</span></span>

<span data-ttu-id="8c0f3-267">Definice `VerifyEmail` metoda řídí následujícími pravidly, jak je znázorněno níže.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-267">The definition of the `VerifyEmail` method follows these rules, as shown below.</span></span> <span data-ttu-id="8c0f3-268">Vrátí Chyba ověřování zpráv, pokud se používá e-mailu, nebo `true` Pokud e-mailu je zdarma a zabalí výsledek `JsonResult` objektu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-268">It returns a validation error message if the email is taken, or `true` if the email is free, and wraps the result in a `JsonResult` object.</span></span> <span data-ttu-id="8c0f3-269">Na straně klienta můžete použít vrácené hodnoty pak pokračujte v případě potřeby zobrazí chybu.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-269">The client side can then use the returned value to proceed or display the error if needed.</span></span>

[!code-csharp[](validation/sample/UsersController.cs?name=snippet_VerifyEmail)]

<span data-ttu-id="8c0f3-270">Nyní když uživatelé zadají e-mailu, JavaScript v zobrazení zavolá vzdálené zobrazíte-li tuto e-mailu je už zabraný a pokud ano, zobrazí se chybová zpráva.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-270">Now when users enter an email, JavaScript in the view makes a remote call to see if that email has been taken and, if so, displays the error message.</span></span> <span data-ttu-id="8c0f3-271">V opačném případě uživatel odešle formulář jako obvykle.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-271">Otherwise, the user can submit the form as usual.</span></span>

<span data-ttu-id="8c0f3-272">`AdditionalFields` Vlastnost `[Remote]` atribut je užitečné pro ověření kombinace různých typů polí s daty na serveru.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-272">The `AdditionalFields` property of the `[Remote]` attribute is useful for validating combinations of fields against data on the server.</span></span> <span data-ttu-id="8c0f3-273">Například pokud `User` modelu výše má dvě další vlastnosti volá `FirstName` a `LastName`, můžete chtít ověřit, že stávající uživatelé už nemají tohoto páru názvy.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-273">For example, if the `User` model from above had two additional properties called `FirstName` and `LastName`, you might want to verify that no existing users already have that pair of names.</span></span> <span data-ttu-id="8c0f3-274">Můžete definovat nové vlastnosti, jak je znázorněno v následujícím kódu:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-274">You define the new properties as shown in the following code:</span></span>

[!code-csharp[](validation/sample/User.cs?name=snippet_UserNameProperties)]

<span data-ttu-id="8c0f3-275">`AdditionalFields` mohli jste explicitně nastavena na řetězce `"FirstName"` a `"LastName"`, ale pomocí [ `nameof` ](/dotnet/csharp/language-reference/keywords/nameof) operátor takto zjednodušuje později refaktoring.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-275">`AdditionalFields` could've been set explicitly to the strings `"FirstName"` and `"LastName"`, but using the [`nameof`](/dotnet/csharp/language-reference/keywords/nameof) operator like this simplifies later refactoring.</span></span> <span data-ttu-id="8c0f3-276">Metody akce k provedení ověření pak musí přijmout dva argumenty, jeden pro hodnotu vlastnosti `FirstName` a jeden pro hodnotu `LastName`.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-276">The action method to perform the validation must then accept two arguments, one for the value of `FirstName` and one for the value of `LastName`.</span></span>

[!code-csharp[](validation/sample/UsersController.cs?name=snippet_VerifyName)]

<span data-ttu-id="8c0f3-277">Nyní když uživatelé zadat křestní jméno a příjmení, JavaScript:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-277">Now when users enter a first and last name, JavaScript:</span></span>

* <span data-ttu-id="8c0f3-278">Díky vzdálené volání zobrazíte, pokud je už zabraný tohoto dvojice názvů.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-278">Makes a remote call to see if that pair of names has been taken.</span></span>
* <span data-ttu-id="8c0f3-279">Pokud je už zabraný dvojici, zobrazí se chybová zpráva.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-279">If the pair has been taken, an error message is displayed.</span></span>
* <span data-ttu-id="8c0f3-280">Pokud ne, uživatel odešle formulář.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-280">If not taken, the user can submit the form.</span></span>

<span data-ttu-id="8c0f3-281">Pokud je potřeba ověřit dvě nebo více polí s `[Remote]` atribut, je uvádíte jako seznam oddělený čárkami.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-281">If you need to validate two or more additional fields with the `[Remote]` attribute, you provide them as a comma-delimited list.</span></span> <span data-ttu-id="8c0f3-282">Například, chcete-li přidat `MiddleName` nastavena vlastnost modelu, `[Remote]` atributu, jak je znázorněno v následujícím kódu:</span><span class="sxs-lookup"><span data-stu-id="8c0f3-282">For example, to add a `MiddleName` property to the model, set the `[Remote]` attribute as shown in the following code:</span></span>

```cs
[Remote(action: "VerifyName", controller: "Users", AdditionalFields = nameof(FirstName) + "," + nameof(LastName))]
public string MiddleName { get; set; }
```

<span data-ttu-id="8c0f3-283">`AdditionalFields`, jako jsou všechny argumenty atributu musí být konstantní výraz.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-283">`AdditionalFields`, like all attribute arguments, must be a constant expression.</span></span> <span data-ttu-id="8c0f3-284">Proto se nesmí používat [interpolovaný řetězec](/dotnet/csharp/language-reference/keywords/interpolated-strings) nebo volání <xref:System.String.Join*> inicializovat `AdditionalFields`.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-284">Therefore, you must not use an [interpolated string](/dotnet/csharp/language-reference/keywords/interpolated-strings) or call <xref:System.String.Join*> to initialize `AdditionalFields`.</span></span> <span data-ttu-id="8c0f3-285">Pro každé další pole, které přidáte do `[Remote]` atribut, je nutné přidat další argument na odpovídající metodu akce kontroleru.</span><span class="sxs-lookup"><span data-stu-id="8c0f3-285">For every additional field that you add to the `[Remote]` attribute, you must add another argument to the corresponding controller action method.</span></span>
