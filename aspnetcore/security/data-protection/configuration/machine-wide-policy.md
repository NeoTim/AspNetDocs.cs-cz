---
title: Zásady pro celý počítač ochrany dat podpory v ASP.NET Core
author: rick-anderson
description: Další informace o podpoře pro nastavení zásady pro celý počítač výchozí pro všechny aplikace, které využívají ochranu dat ASP.NET Core.
ms.author: riande
ms.date: 10/14/2016
uid: security/data-protection/configuration/machine-wide-policy
ms.openlocfilehash: 70aaca7afcd3df22cebb4466fbd9845a2277688c
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/01/2019
ms.locfileid: "57075337"
---
# <a name="data-protection-machine-wide-policy-support-in-aspnet-core"></a><span data-ttu-id="cb0a6-103">Zásady pro celý počítač ochrany dat podpory v ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="cb0a6-103">Data Protection machine-wide policy support in ASP.NET Core</span></span>

<span data-ttu-id="cb0a6-104">Podle [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="cb0a6-104">By [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="cb0a6-105">Pokud používáte Windows, ochrana dat systému má omezenou podporu pro nastavení zásady pro celý počítač výchozí pro všechny aplikace, které využívají ochranu dat ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-105">When running on Windows, the Data Protection system has limited support for setting a default machine-wide policy for all apps that consume ASP.NET Core Data Protection.</span></span> <span data-ttu-id="cb0a6-106">Obecnou myšlenku je, že možná budete chtít změnit výchozí nastavení, jako například používá algoritmy nebo životnosti klíče, aniž byste museli ručně aktualizovat všechny aplikace na počítači správcem.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-106">The general idea is that an administrator might wish to change a default setting, such as the algorithms used or key lifetime, without the need to manually update every app on the machine.</span></span>

> [!WARNING]
> <span data-ttu-id="cb0a6-107">Správce systému může nastavit výchozí zásady, ale nemůže vynutit.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-107">The system administrator can set default policy, but they can't enforce it.</span></span> <span data-ttu-id="cb0a6-108">Vývojář aplikace můžete vždy přepíší libovolnou hodnotu s jedním z jejich vlastního výběru.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-108">The app developer can always override any value with one of their own choosing.</span></span> <span data-ttu-id="cb0a6-109">Výchozí zásady ovlivní pouze aplikace tam, kde vývojáři nebyl zadán explicitní hodnotu pro třídu setting.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-109">The default policy only affects apps where the developer hasn't specified an explicit value for a setting.</span></span>

## <a name="setting-default-policy"></a><span data-ttu-id="cb0a6-110">Nastavení výchozích zásad</span><span class="sxs-lookup"><span data-stu-id="cb0a6-110">Setting default policy</span></span>

<span data-ttu-id="cb0a6-111">Pokud chcete nastavit výchozí zásady, Správce může nastavit známé hodnoty v systémovém registru v následujícím klíči registru:</span><span class="sxs-lookup"><span data-stu-id="cb0a6-111">To set default policy, an administrator can set known values in the system registry under the following registry key:</span></span>

<span data-ttu-id="cb0a6-112">**HKLM\SOFTWARE\Microsoft\DotNetPackages\Microsoft.AspNetCore.DataProtection**</span><span class="sxs-lookup"><span data-stu-id="cb0a6-112">**HKLM\SOFTWARE\Microsoft\DotNetPackages\Microsoft.AspNetCore.DataProtection**</span></span>

<span data-ttu-id="cb0a6-113">Pokud jste na 64bitový operační systém a ovlivnit chování 32bitových aplikací, nezapomeňte nakonfigurovat Wow6432Node ekvivalent výše uvedený klíč.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-113">If you're on a 64-bit operating system and want to affect the behavior of 32-bit apps, remember to configure the Wow6432Node equivalent of the above key.</span></span>

<span data-ttu-id="cb0a6-114">Podporované hodnoty jsou uvedeny níže.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-114">The supported values are shown below.</span></span>

| <span data-ttu-id="cb0a6-115">Hodnota</span><span class="sxs-lookup"><span data-stu-id="cb0a6-115">Value</span></span>              | <span data-ttu-id="cb0a6-116">Typ</span><span class="sxs-lookup"><span data-stu-id="cb0a6-116">Type</span></span>   | <span data-ttu-id="cb0a6-117">Popis</span><span class="sxs-lookup"><span data-stu-id="cb0a6-117">Description</span></span> |
| ------------------ | :----: | ----------- |
| <span data-ttu-id="cb0a6-118">EncryptionType</span><span class="sxs-lookup"><span data-stu-id="cb0a6-118">EncryptionType</span></span>     | <span data-ttu-id="cb0a6-119">odkazy řetězců</span><span class="sxs-lookup"><span data-stu-id="cb0a6-119">string</span></span> | <span data-ttu-id="cb0a6-120">Určuje, které algoritmy má být použito k ochraně dat.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-120">Specifies which algorithms should be used for data protection.</span></span> <span data-ttu-id="cb0a6-121">Hodnota musí být CNG-CBC, CNG GCM nebo spravované a je podrobněji popsaný níže.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-121">The value must be CNG-CBC, CNG-GCM, or Managed and is described in more detail below.</span></span> |
| <span data-ttu-id="cb0a6-122">DefaultKeyLifetime</span><span class="sxs-lookup"><span data-stu-id="cb0a6-122">DefaultKeyLifetime</span></span> | <span data-ttu-id="cb0a6-123">DWORD</span><span class="sxs-lookup"><span data-stu-id="cb0a6-123">DWORD</span></span>  | <span data-ttu-id="cb0a6-124">Určuje dobu životnosti pro nově vygenerovat klíče.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-124">Specifies the lifetime for newly-generated keys.</span></span> <span data-ttu-id="cb0a6-125">Hodnota zadaná ve dnech a musí být > = 7.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-125">The value is specified in days and must be >= 7.</span></span> |
| <span data-ttu-id="cb0a6-126">KeyEscrowSinks</span><span class="sxs-lookup"><span data-stu-id="cb0a6-126">KeyEscrowSinks</span></span>     | <span data-ttu-id="cb0a6-127">odkazy řetězců</span><span class="sxs-lookup"><span data-stu-id="cb0a6-127">string</span></span> | <span data-ttu-id="cb0a6-128">Určuje typy, které se používají pro klíčů v úschově.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-128">Specifies the types that are used for key escrow.</span></span> <span data-ttu-id="cb0a6-129">Středníkem oddělený seznam klíčů v úschově jímky, kde každý prvek v seznamu je název kvalifikovaný pro sestavení typu, který implementuje hodnotu [IKeyEscrowSink](/dotnet/api/microsoft.aspnetcore.dataprotection.keymanagement.ikeyescrowsink).</span><span class="sxs-lookup"><span data-stu-id="cb0a6-129">The value is a semicolon-delimited list of key escrow sinks, where each element in the list is the assembly-qualified name of a type that implements [IKeyEscrowSink](/dotnet/api/microsoft.aspnetcore.dataprotection.keymanagement.ikeyescrowsink).</span></span> |

## <a name="encryption-types"></a><span data-ttu-id="cb0a6-130">Typy šifrování</span><span class="sxs-lookup"><span data-stu-id="cb0a6-130">Encryption types</span></span>

<span data-ttu-id="cb0a6-131">Pokud EncryptionType CNG-CBC, systém konfigurován pro použití režimu CBC symetrický blokových šifrách důvěrnost a HMAC pravosti pomocí služby poskytované Windows CNG (viz [zadání vlastní algoritmů Windows CNG](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) pro Další podrobnosti).</span><span class="sxs-lookup"><span data-stu-id="cb0a6-131">If EncryptionType is CNG-CBC, the system is configured to use a CBC-mode symmetric block cipher for confidentiality and HMAC for authenticity with services provided by Windows CNG (see [Specifying custom Windows CNG algorithms](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) for more details).</span></span> <span data-ttu-id="cb0a6-132">Jsou podporovány následující další hodnoty, z nichž každá vlastnost v typu CngCbcAuthenticatedEncryptionSettings odpovídá.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-132">The following additional values are supported, each of which corresponds to a property on the CngCbcAuthenticatedEncryptionSettings type.</span></span>

| <span data-ttu-id="cb0a6-133">Hodnota</span><span class="sxs-lookup"><span data-stu-id="cb0a6-133">Value</span></span>                       | <span data-ttu-id="cb0a6-134">Typ</span><span class="sxs-lookup"><span data-stu-id="cb0a6-134">Type</span></span>   | <span data-ttu-id="cb0a6-135">Popis</span><span class="sxs-lookup"><span data-stu-id="cb0a6-135">Description</span></span> |
| --------------------------- | :----: | ----------- |
| <span data-ttu-id="cb0a6-136">EncryptionAlgorithm</span><span class="sxs-lookup"><span data-stu-id="cb0a6-136">EncryptionAlgorithm</span></span>         | <span data-ttu-id="cb0a6-137">odkazy řetězců</span><span class="sxs-lookup"><span data-stu-id="cb0a6-137">string</span></span> | <span data-ttu-id="cb0a6-138">Název algoritmu symetrického bloku šifer podporovaných službou CNG.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-138">The name of a symmetric block cipher algorithm understood by CNG.</span></span> <span data-ttu-id="cb0a6-139">Tento algoritmus je otevřen v režimu CBC.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-139">This algorithm is opened in CBC mode.</span></span> |
| <span data-ttu-id="cb0a6-140">EncryptionAlgorithmProvider</span><span class="sxs-lookup"><span data-stu-id="cb0a6-140">EncryptionAlgorithmProvider</span></span> | <span data-ttu-id="cb0a6-141">odkazy řetězců</span><span class="sxs-lookup"><span data-stu-id="cb0a6-141">string</span></span> | <span data-ttu-id="cb0a6-142">Název implementace poskytovatele CNG, který může vytvořit algoritmus načtou algoritmy EncryptionAlgorithm.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-142">The name of the CNG provider implementation that can produce the algorithm EncryptionAlgorithm.</span></span> |
| <span data-ttu-id="cb0a6-143">EncryptionAlgorithmKeySize</span><span class="sxs-lookup"><span data-stu-id="cb0a6-143">EncryptionAlgorithmKeySize</span></span>  | <span data-ttu-id="cb0a6-144">DWORD</span><span class="sxs-lookup"><span data-stu-id="cb0a6-144">DWORD</span></span>  | <span data-ttu-id="cb0a6-145">Délka klíče k odvození pro šifrovací algoritmus symetrického bloku (v bitech).</span><span class="sxs-lookup"><span data-stu-id="cb0a6-145">The length (in bits) of the key to derive for the symmetric block cipher algorithm.</span></span> |
| <span data-ttu-id="cb0a6-146">HashAlgorithm</span><span class="sxs-lookup"><span data-stu-id="cb0a6-146">HashAlgorithm</span></span>               | <span data-ttu-id="cb0a6-147">odkazy řetězců</span><span class="sxs-lookup"><span data-stu-id="cb0a6-147">string</span></span> | <span data-ttu-id="cb0a6-148">Název algoritmu hash rozumí CNG.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-148">The name of a hash algorithm understood by CNG.</span></span> <span data-ttu-id="cb0a6-149">Tento algoritmus je otevřen v režimu HMAC.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-149">This algorithm is opened in HMAC mode.</span></span> |
| <span data-ttu-id="cb0a6-150">HashAlgorithmProvider</span><span class="sxs-lookup"><span data-stu-id="cb0a6-150">HashAlgorithmProvider</span></span>       | <span data-ttu-id="cb0a6-151">odkazy řetězců</span><span class="sxs-lookup"><span data-stu-id="cb0a6-151">string</span></span> | <span data-ttu-id="cb0a6-152">Název implementace poskytovatele CNG, které mohou způsobit algoritmus HashAlgorithm.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-152">The name of the CNG provider implementation that can produce the algorithm HashAlgorithm.</span></span> |

<span data-ttu-id="cb0a6-153">Pokud EncryptionType CNG GCM, systém je nakonfigurován pro účely symetrický blokových šifrách Galois/čítač režim utajení a pravosti pomocí služby poskytované Windows CNG (viz [zadání vlastní algoritmů Windows CNG](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) Další podrobnosti).</span><span class="sxs-lookup"><span data-stu-id="cb0a6-153">If EncryptionType is CNG-GCM, the system is configured to use a Galois/Counter Mode symmetric block cipher for confidentiality and authenticity with services provided by Windows CNG (see [Specifying custom Windows CNG algorithms](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) for more details).</span></span> <span data-ttu-id="cb0a6-154">Jsou podporovány následující další hodnoty, z nichž každá vlastnost v typu CngGcmAuthenticatedEncryptionSettings odpovídá.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-154">The following additional values are supported, each of which corresponds to a property on the CngGcmAuthenticatedEncryptionSettings type.</span></span>

| <span data-ttu-id="cb0a6-155">Hodnota</span><span class="sxs-lookup"><span data-stu-id="cb0a6-155">Value</span></span>                       | <span data-ttu-id="cb0a6-156">Typ</span><span class="sxs-lookup"><span data-stu-id="cb0a6-156">Type</span></span>   | <span data-ttu-id="cb0a6-157">Popis</span><span class="sxs-lookup"><span data-stu-id="cb0a6-157">Description</span></span> |
| --------------------------- | :----: | ----------- |
| <span data-ttu-id="cb0a6-158">EncryptionAlgorithm</span><span class="sxs-lookup"><span data-stu-id="cb0a6-158">EncryptionAlgorithm</span></span>         | <span data-ttu-id="cb0a6-159">odkazy řetězců</span><span class="sxs-lookup"><span data-stu-id="cb0a6-159">string</span></span> | <span data-ttu-id="cb0a6-160">Název algoritmu symetrického bloku šifer podporovaných službou CNG.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-160">The name of a symmetric block cipher algorithm understood by CNG.</span></span> <span data-ttu-id="cb0a6-161">Tento algoritmus je otevřen v režimu Galois/čítač.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-161">This algorithm is opened in Galois/Counter Mode.</span></span> |
| <span data-ttu-id="cb0a6-162">EncryptionAlgorithmProvider</span><span class="sxs-lookup"><span data-stu-id="cb0a6-162">EncryptionAlgorithmProvider</span></span> | <span data-ttu-id="cb0a6-163">odkazy řetězců</span><span class="sxs-lookup"><span data-stu-id="cb0a6-163">string</span></span> | <span data-ttu-id="cb0a6-164">Název implementace poskytovatele CNG, který může vytvořit algoritmus načtou algoritmy EncryptionAlgorithm.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-164">The name of the CNG provider implementation that can produce the algorithm EncryptionAlgorithm.</span></span> |
| <span data-ttu-id="cb0a6-165">EncryptionAlgorithmKeySize</span><span class="sxs-lookup"><span data-stu-id="cb0a6-165">EncryptionAlgorithmKeySize</span></span>  | <span data-ttu-id="cb0a6-166">DWORD</span><span class="sxs-lookup"><span data-stu-id="cb0a6-166">DWORD</span></span>  | <span data-ttu-id="cb0a6-167">Délka klíče k odvození pro šifrovací algoritmus symetrického bloku (v bitech).</span><span class="sxs-lookup"><span data-stu-id="cb0a6-167">The length (in bits) of the key to derive for the symmetric block cipher algorithm.</span></span> |

<span data-ttu-id="cb0a6-168">Pokud je spravováno EncryptionType, systém je nakonfigurován pro účely spravované SymmetricAlgorithm důvěrnost a KeyedHashAlgorithm pravosti (naleznete v tématu [zadání vlastní spravované algoritmy](xref:security/data-protection/configuration/overview#specifying-custom-managed-algorithms) další podrobnosti).</span><span class="sxs-lookup"><span data-stu-id="cb0a6-168">If EncryptionType is Managed, the system is configured to use a managed SymmetricAlgorithm for confidentiality and KeyedHashAlgorithm for authenticity (see [Specifying custom managed algorithms](xref:security/data-protection/configuration/overview#specifying-custom-managed-algorithms) for more details).</span></span> <span data-ttu-id="cb0a6-169">Jsou podporovány následující další hodnoty, z nichž každá vlastnost v typu ManagedAuthenticatedEncryptionSettings odpovídá.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-169">The following additional values are supported, each of which corresponds to a property on the ManagedAuthenticatedEncryptionSettings type.</span></span>

| <span data-ttu-id="cb0a6-170">Hodnota</span><span class="sxs-lookup"><span data-stu-id="cb0a6-170">Value</span></span>                      | <span data-ttu-id="cb0a6-171">Typ</span><span class="sxs-lookup"><span data-stu-id="cb0a6-171">Type</span></span>   | <span data-ttu-id="cb0a6-172">Popis</span><span class="sxs-lookup"><span data-stu-id="cb0a6-172">Description</span></span> |
| -------------------------- | :----: | ----------- |
| <span data-ttu-id="cb0a6-173">EncryptionAlgorithmType</span><span class="sxs-lookup"><span data-stu-id="cb0a6-173">EncryptionAlgorithmType</span></span>    | <span data-ttu-id="cb0a6-174">odkazy řetězců</span><span class="sxs-lookup"><span data-stu-id="cb0a6-174">string</span></span> | <span data-ttu-id="cb0a6-175">Název kvalifikovaný pro sestavení typu, který implementuje SymmetricAlgorithm.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-175">The assembly-qualified name of a type that implements SymmetricAlgorithm.</span></span> |
| <span data-ttu-id="cb0a6-176">EncryptionAlgorithmKeySize</span><span class="sxs-lookup"><span data-stu-id="cb0a6-176">EncryptionAlgorithmKeySize</span></span> | <span data-ttu-id="cb0a6-177">DWORD</span><span class="sxs-lookup"><span data-stu-id="cb0a6-177">DWORD</span></span>  | <span data-ttu-id="cb0a6-178">Délka klíče k odvození pro algoritmus symetrického šifrování (v bitech).</span><span class="sxs-lookup"><span data-stu-id="cb0a6-178">The length (in bits) of the key to derive for the symmetric encryption algorithm.</span></span> |
| <span data-ttu-id="cb0a6-179">ValidationAlgorithmType</span><span class="sxs-lookup"><span data-stu-id="cb0a6-179">ValidationAlgorithmType</span></span>    | <span data-ttu-id="cb0a6-180">odkazy řetězců</span><span class="sxs-lookup"><span data-stu-id="cb0a6-180">string</span></span> | <span data-ttu-id="cb0a6-181">Název kvalifikovaný pro sestavení typu, který implementuje KeyedHashAlgorithm.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-181">The assembly-qualified name of a type that implements KeyedHashAlgorithm.</span></span> |

<span data-ttu-id="cb0a6-182">Pokud EncryptionType má jakoukoli jinou hodnotu než null nebo je prázdný, ochrana dat systému dojde k výjimce při spuštění.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-182">If EncryptionType has any other value other than null or empty, the Data Protection system throws an exception at startup.</span></span>

> [!WARNING]
> <span data-ttu-id="cb0a6-183">Při konfiguraci výchozí nastavení zásad, která zahrnuje názvy typů (EncryptionAlgorithmType, ValidationAlgorithmType, KeyEscrowSinks), typy musí být k dispozici pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-183">When configuring a default policy setting that involves type names (EncryptionAlgorithmType, ValidationAlgorithmType, KeyEscrowSinks), the types must be available to the app.</span></span> <span data-ttu-id="cb0a6-184">To znamená, že pro aplikace běžící na modul Desktop CLR, sestavení, které obsahují tyto typy by měly být k dispozici v globální mezipaměti sestavení (GAC).</span><span class="sxs-lookup"><span data-stu-id="cb0a6-184">This means that for apps running on Desktop CLR, the assemblies that contain these types should be present in the Global Assembly Cache (GAC).</span></span> <span data-ttu-id="cb0a6-185">Pro aplikace ASP.NET Core spuštěné v .NET Core musí být nainstalován balíčky, které obsahují tyto typy.</span><span class="sxs-lookup"><span data-stu-id="cb0a6-185">For ASP.NET Core apps running on .NET Core, the packages that contain these types should be installed.</span></span>
